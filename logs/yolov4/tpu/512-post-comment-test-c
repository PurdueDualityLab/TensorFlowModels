cat: .experiment_zone: No such file or directory
Request issued for: [node-7]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-25T05:33:53.001067773Z'
  endTime: '2021-05-25T05:34:31.528559035Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621920832988-5c320df1aa5dd-8a563e58-1b7642db
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.124.160.48/29
  createTime: '2021-03-18T03:10:27.166064884Z'
  health: HEALTHY
  ipAddress: 10.124.160.50
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.124.160.50
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621920832988-5c320df1aa5dd-8a563e58-1b7642db] to complete...
.....................................................................................................................................................................................................................................................................................done.
europe-west4-a
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 115, in main
    params = train_utils.parse_configuration(FLAGS)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_utils.py", line 249, in parse_configuration
    params, config_file, is_strict=True)
  File "/home/cam2tensorflow/TensorFlowModels/official/modeling/hyperparams/params_dict.py", line 441, in override_params_dict
    params.override(yaml.load(f, Loader=yaml.FullLoader), is_strict)
  File "/home/cam2tensorflow/TensorFlowModels/official/modeling/hyperparams/params_dict.py", line 161, in override
    self._override(override_params, is_strict)  # pylint: disable=protected-access
  File "/home/cam2tensorflow/TensorFlowModels/official/modeling/hyperparams/base_config.py", line 220, in _override
    self.__dict__[k]._override(v, is_strict)  # pylint: disable=protected-access
  File "/home/cam2tensorflow/TensorFlowModels/official/modeling/hyperparams/base_config.py", line 220, in _override
    self.__dict__[k]._override(v, is_strict)  # pylint: disable=protected-access
  File "/home/cam2tensorflow/TensorFlowModels/official/modeling/hyperparams/base_config.py", line 220, in _override
    self.__dict__[k]._override(v, is_strict)  # pylint: disable=protected-access
  File "/home/cam2tensorflow/TensorFlowModels/official/modeling/hyperparams/base_config.py", line 215, in _override
    k, type(self)))
KeyError: "The key 'use_scaled_loss' does not exist in <class 'yolo.configs.yolo.YoloLossLayer'>. To extend the existing keys, use `override` with `is_strict` = False."
yolo_custom
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   200    0     2  100   198     11   1171 --:--:-- --:--:-- --:--:--  1176100   200    0     2  100   198     11   1171 --:--:-- --:--:-- --:--:--  1176
okRequest issued for: [node-7]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621920893183-5c320e2b12634-eff41881-333aa024] to complete...
...........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................aborted by ctrl-c.
ERROR: (gcloud.compute.tpus.stop) Aborting wait for operation https://tpu.googleapis.com/v1alpha1/projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621920893183-5c320e2b12634-eff41881-333aa024.

cat: .experiment_zone: No such file or directory
Request issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-25T05:37:28.576310277Z'
  endTime: '2021-05-25T05:38:04.427463414Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621921048563-5c320ebf40ee9-0c6fefc4-913fd26a
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-04-28T09:49:15.232857330Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-28T09:48:54.136196+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621921048563-5c320ebf40ee9-0c6fefc4-913fd26a] to complete...
.......................................................................................................................................................................................................done.
europe-west4-a
I0525 05:31:29.368217 140683405055808 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[12.0, 16.0]',
                              '[19.0, 36.0]',
                              '[40.0, 28.0]',
                              '[36.0, 75.0]',
                              '[76.0, 55.0]',
                              '[72.0, 146.0]',
                              '[142.0, 110.0]',
                              '[192.0, 243.0]',
                              '[459.0, 401.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'input_size': [512, 512, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.1,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.3,
                                    'aug_scale_max': 2.0,
                                    'aug_scale_min': 0.1,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'random_pad': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.213,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.5,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.5,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'random_pad': False,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [240000,
                                                                                260000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00131,
                                                                            0.0009825,
                                                                            0.000655]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0525 05:31:29.369120 140683405055808 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/params.yaml
I0525 05:31:31.187519 140683405055808 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0525 05:31:31.334179 140683405055808 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0525 05:31:31.334597 140683405055808 transport.py:157] Attempting refresh to obtain initial access_token
I0525 05:31:31.392492 140683405055808 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0525 05:31:32.013189 140683405055808 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0525 05:31:32.013460 140683405055808 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-25 05:31:32.072127: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0525 05:31:32.072767 140683405055808 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0525 05:31:32.688527 140683405055808 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0525 05:31:32.688826 140683405055808 transport.py:157] Attempting refresh to obtain initial access_token
I0525 05:31:32.747003 140683405055808 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0525 05:31:32.891988 140683405055808 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0525 05:31:32.892253 140683405055808 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-25 05:31:32.946886: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-25 05:31:32.962921: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-05-25 05:31:32.963009: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:30563}
2021-05-25 05:32:07.657149: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-05-25 05:32:07.657259: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:30563}
2021-05-25 05:32:07.658128: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:30563
I0525 05:32:07.658884 140683405055808 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-6
I0525 05:32:07.659644 140683405055808 tpu_strategy_util.py:74] Initializing the TPU system: node-6
INFO:tensorflow:Clearing out eager caches
I0525 05:32:15.615401 140683405055808 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0525 05:32:15.630420 140683405055808 tpu_strategy_util.py:133] Finished initializing TPU system.
I0525 05:32:15.632143 140683405055808 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0525 05:32:15.780832 140683405055808 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0525 05:32:15.781106 140683405055808 transport.py:157] Attempting refresh to obtain initial access_token
I0525 05:32:15.840003 140683405055808 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0525 05:32:15.980703 140683405055808 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0525 05:32:15.980973 140683405055808 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0525 05:32:16.029874 140683405055808 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0525 05:32:16.030179 140683405055808 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0525 05:32:16.030559 140683405055808 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0525 05:32:16.030689 140683405055808 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0525 05:32:16.030805 140683405055808 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0525 05:32:16.031069 140683405055808 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0525 05:32:16.031186 140683405055808 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0525 05:32:16.031298 140683405055808 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0525 05:32:16.031486 140683405055808 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0525 05:32:16.031609 140683405055808 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0525 05:32:16.031709 140683405055808 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0525 05:32:16.031805 140683405055808 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0525 05:32:16.031948 140683405055808 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0525 05:32:16.032049 140683405055808 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0525 05:32:16.032132 140683405055808 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0525 05:32:16.032221 140683405055808 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0525 05:32:16.033558 140683405055808 train_utils.py:214] Running default trainer.
2021-05-25 05:32:16.046876: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, 'input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': False, 'random_flip': True, 'aug_rand_crop': 0.1, 'aug_scale_aspect': 0.3, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'random_pad': True, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': False, 'random_flip': True, 'aug_rand_crop': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.5, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'random_pad': False, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [240000, 260000], 'values': [0.00131, 0.0009825, 0.000655]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05} 0.00025
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
heheheeheheheheheheheh:  [[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, 'input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7ff3007a07b8>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            I0525 05:33:03.086596 140683405055808 controller.py:362] restoring or initializing model...
I0525 05:33:13.855185 140683405055808 yolo.py:538] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0525 05:33:13.857296 140683405055808 controller.py:368] initialized model.
I0525 05:33:13.857713 140683405055808 train_lib.py:96] Starts to execute mode: train_and_eval
I0525 05:33:13.862657 140683405055808 controller.py:211] train | step:      0 | training until step 20000...
I0525 05:33:27.043998 140683405055808 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0525 05:34:22.037978 140683405055808 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0525 06:37:45.455686 140683405055808 controller.py:425] train | step:  10000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.5541612,
           'avg_obj': 0.1288823,
           'box_loss': 6.0972824,
           'class_loss': 15.309881,
           'conf_loss': 39.75364,
           'precision50': 0.17333737,
           'recall50': 0.0527273},
     '4': {'avg_iou': 0.63900864,
           'avg_obj': 0.22030771,
           'box_loss': 4.6469483,
           'class_loss': 13.864377,
           'conf_loss': 16.095898,
           'precision50': 0.3111966,
           'recall50': 0.15690683},
     '5': {'avg_iou': 0.6735872,
           'avg_obj': 0.3040673,
           'box_loss': 2.1699433,
           'class_loss': 7.184904,
           'conf_loss': 6.9829946,
           'precision50': 0.38714004,
           'recall50': 0.2684704},
     'global': {'total_loss': 112.105576},
     'learning_rate': 0.00131,
     'training_loss': 112.105576}
I0525 06:38:38.337289 140683405055808 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-10000.
I0525 07:39:52.727341 140683405055808 controller.py:425] train | step:  20000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.61878777,
           'avg_obj': 0.18958528,
           'box_loss': 5.227045,
           'class_loss': 5.8621726,
           'conf_loss': 10.610133,
           'precision50': 0.26732874,
           'recall50': 0.103645205},
     '4': {'avg_iou': 0.7153389,
           'avg_obj': 0.31737342,
           'box_loss': 3.6655679,
           'class_loss': 4.6560807,
           'conf_loss': 8.672599,
           'precision50': 0.39707258,
           'recall50': 0.2679051},
     '5': {'avg_iou': 0.74752086,
           'avg_obj': 0.41979882,
           'box_loss': 1.6826307,
           'class_loss': 2.4691846,
           'conf_loss': 3.8482888,
           'precision50': 0.47452432,
           'recall50': 0.40975752},
     'global': {'total_loss': 46.69368},
     'learning_rate': 0.00131,
     'training_loss': 46.69368}
I0525 07:40:35.011222 140683405055808 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-20000.
I0525 07:40:35.017617 140683405055808 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0525 07:40:35.780904 140683405055808 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0525 07:40:56.501445 140683405055808 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
WARNING:tensorflow:AutoGraph could not transform <bound method YoloTask.validation_step of <yolo.tasks.yolo.YoloTask object at 0x7ff30074dd30>> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: Unknown node type <gast.gast.Assign object at 0x7ff23c301a20>
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
W0525 07:40:56.690168 140683405055808 ag_logging.py:146] AutoGraph could not transform <bound method YoloTask.validation_step of <yolo.tasks.yolo.YoloTask object at 0x7ff30074dd30>> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: Unknown node type <gast.gast.Assign object at 0x7ff23c301a20>
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'5': (None, 16, 16, 20923392    input_2[0][0]                    
                                                                 input_3[0][0]                    
                                                                 input_4[0][0]                    
==================================================================================================
Total params: 20,923,392
Trainable params: 20,906,496
Non-trainable params: 16,896
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'5': (None, 16, 16, 1024 20923392  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 48,092,864
Trainable params: 48,040,640
Non-trainable params: 52,224
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 200, 8), 4: (8, 200, 8), 5: (8, 200, 8)}, inds: {3: (8, 200, 3), 4: (8, 200, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
train | step:  10000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.5541612,
           'avg_obj': 0.1288823,
           'box_loss': 6.0972824,
           'class_loss': 15.309881,
           'conf_loss': 39.75364,
           'precision50': 0.17333737,
           'recall50': 0.0527273},
     '4': {'avg_iou': 0.63900864,
           'avg_obj': 0.22030771,
           'box_loss': 4.6469483,
           'class_loss': 13.864377,
           'conf_loss': 16.095898,
           'precision50': 0.3111966,
           'recall50': 0.15690683},
     '5': {'avg_iou': 0.6735872,
           'avg_obj': 0.3040673,
           'box_loss': 2.1699433,
           'class_loss': 7.184904,
           'conf_loss': 6.9829946,
           'precision50': 0.38714004,
           'recall50': 0.2684704},
     'global': {'total_loss': 112.105576},
     'learning_rate': 0.00131,
     'training_loss': 112.105576}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-10000.
train | step:  20000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.61878777,
           'avg_obj': 0.18958528,
           'box_loss': 5.227045,
           'class_loss': 5.8621726,
           'conf_loss': 10.610133,
           'precision50': 0.26732874,
           'recall50': 0.103645205},
     '4': {'avg_iou': 0.7153389,
           'avg_obj': 0.31737342,
           'box_loss': 3.6655679,
           'class_loss': 4.6560807,
           'conf_loss': 8.672599,
           'precision50': 0.39707258,
           'recall50': 0.2679051},
     '5': {'avg_iou': 0.74752086,
           'avg_obj': 0.41979882,
           'box_loss': 1.6826307,
           'class_loss': 2.4691846,
           'conf_loss': 3.8482888,
           'precision50': 0.47452432,
           'recall50': 0.40975752},
     'global': {'total_loss': 46.69368},
     'learning_rate': 0.00131,
     'training_loss': 46.69368}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-20000.
 eval | step:  20000 | running 625 steps of evaluation...
I0525 07:45:29.442634 140683405055808 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0525 07:49:48.127214 140683405055808 controller.py:261]  eval | step:  20000 | eval time:  553.1 sec | output: 
    {'3': {'avg_iou': 0.4626047,
           'avg_obj': 0.15487906,
           'box_loss': 2.4951317,
           'class_loss': 2.1785314,
           'conf_loss': 6.394603,
           'precision50': 0.21043238,
           'recall50': 0.12881477},
     '4': {'avg_iou': 0.6552441,
           'avg_obj': 0.32673204,
           'box_loss': 2.4949663,
           'class_loss': 2.2672067,
           'conf_loss': 6.319243,
           'precision50': 0.35778,
           'recall50': 0.315463},
     '5': {'avg_iou': 0.74396586,
           'avg_obj': 0.48091236,
           'box_loss': 1.5008844,
           'class_loss': 1.5089968,
           'conf_loss': 3.4468026,
           'precision50': 0.4575583,
           'recall50': 0.48617485},
     'AP': 0.2610338,
     'AP50': 0.46398014,
     'AP75': 0.26385668,
     'APl': 0.34029087,
     'APm': 0.25326747,
     'APs': 0.10947109,
     'ARl': 0.55434746,
     'ARm': 0.4775168,
     'ARmax1': 0.24430726,
     'ARmax10': 0.42000595,
     'ARmax100': 0.46628845,
     'ARs': 0.28084338,
     'global': {'total_loss': 28.606379},
     'validation_loss': 28.606379}
I0525 07:50:11.614927 140683405055808 controller.py:211] train | step:  20000 | training until step 40000...
I0525 08:51:19.575655 140683405055808 controller.py:425] train | step:  30000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.63529176,
           'avg_obj': 0.21553391,
           'box_loss': 5.0106254,
           'class_loss': 5.2523155,
           'conf_loss': 10.278265,
           'precision50': 0.28883407,
           'recall50': 0.12795316},
     '4': {'avg_iou': 0.7336095,
           'avg_obj': 0.35396087,
           'box_loss': 3.4376578,
           'class_loss': 4.0569797,
           'conf_loss': 8.222934,
           'precision50': 0.40841877,
           'recall50': 0.30894658},
     '5': {'avg_iou': 0.7649809,
           'avg_obj': 0.46065703,
           'box_loss': 1.5658044,
           'class_loss': 2.139728,
           'conf_loss': 3.5785208,
           'precision50': 0.4835642,
           'recall50': 0.45503742},
     'global': {'total_loss': 43.542744},
     'learning_rate': 0.00131,
     'training_loss': 43.542744}
I0525 08:52:01.883205 140683405055808 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-30000.
I0525 09:54:06.599120 140683405055808 controller.py:425] train | step:  40000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6448097,
           'avg_obj': 0.23186453,
           'box_loss': 4.8852854,
           'class_loss': 4.8917823,
           'conf_loss': 10.064479,
           'precision50': 0.29964587,
           'recall50': 0.14371015},
     '4': {'avg_iou': 0.74412006,
           'avg_obj': 0.37707728,
           'box_loss': 3.3054304,
           'class_loss': 3.7099457,
           'conf_loss': 7.935849,
           'precision50': 0.4131961,
           'recall50': 0.33446696},
     '5': {'avg_iou': 0.77534807,
           'avg_obj': 0.48527807,
           'box_loss': 1.4984431,
           'class_loss': 1.9577688,
           'conf_loss': 3.4191418,
           'precision50': 0.48712876,
           'recall50': 0.48253387},
     'global': {'total_loss': 41.66821},
     'learning_rate': 0.00131,
     'training_loss': 41.66821}
I0525 09:54:49.597083 140683405055808 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-40000.
I0525 09:54:49.603767 140683405055808 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0525 09:59:01.623878 140683405055808 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0525 10:03:14.009963 140683405055808 controller.py:261]  eval | step:  40000 | eval time:  504.4 sec | output: 
    {'3': {'avg_iou': 0.4716082,
           'avg_obj': 0.17694229,
           'box_loss': 2.3801296,
           'class_loss': 1.8531681,
           'conf_loss': 6.150635,
           'precision50': 0.22897144,
           'recall50': 0.15573208},
     '4': {'avg_iou': 0.66923773,
           'avg_obj': 0.36877197,
           'box_loss': 2.3427439,
           'class_loss': 1.8885523,
           'conf_loss': 5.9229198,
           'precision50': 0.3709561,
           'recall50': 0.36551744},
     '5': {'avg_iou': 0.7621748,
           'avg_obj': 0.53214073,
           'box_loss': 1.3847282,
           'class_loss': 1.2495587,
           'conf_loss': 3.1671743,
           'precision50': 0.45836586,
           'recall50': 0.54278773},
     'AP': 0.306872,
     'AP50': 0.52309364,
     'AP75': 0.31870228,
     'APl': 0.40267447,
     'APm': 0.30164918,
     'APs': 0.13266289,
     'ARl': 0.5969531,
     'ARm': 0.51711625,
     'ARmax1': 0.2681297,
     'ARmax10': 0.45458624,
     'ARmax100': 0.50262314,
     'ARs': 0.3112775,
     'global': {'total_loss': 26.339615},
     'validation_loss': 26.339615}
I0525 10:03:30.541229 140683405055808 controller.py:211] train | step:  40000 | training until step 60000...
I0525 11:06:17.445719 140683405055808 controller.py:425] train | step:  50000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6517011,
           'avg_obj': 0.2441994,
           'box_loss': 4.796469,
           'class_loss': 4.6395288,
           'conf_loss': 9.904282,
           'precision50': 0.3066874,
           'recall50': 0.15515405},
     '4': {'avg_iou': 0.75160223,
           'avg_obj': 0.39400387,
           'box_loss': 3.206671,
           'class_loss': 3.4627988,
           'conf_loss': 7.7146187,
           'precision50': 0.41587743,
           'recall50': 0.35281143},
     '5': {'avg_iou': 0.78250414,
           'avg_obj': 0.50346786,
           'box_loss': 1.4483634,
           'class_loss': 1.8288635,
           'conf_loss': 3.2947457,
           'precision50': 0.48960206,
           'recall50': 0.502045},
     'global': {'total_loss': 40.29627},
     'learning_rate': 0.00131,
     'training_loss': 40.29627}
I0525 11:07:02.796092 140683405055808 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-50000.
I0525 12:08:49.173384 140683405055808 controller.py:425] train | step:  60000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.65638787,
           'avg_obj': 0.2538419,
           'box_loss': 4.7323394,
           'class_loss': 4.458661,
           'conf_loss': 9.780373,
           'precision50': 0.3118456,
           'recall50': 0.16413288},
     '4': {'avg_iou': 0.757168,
           'avg_obj': 0.4069087,
           'box_loss': 3.137102,
           'class_loss': 3.2848547,
           'conf_loss': 7.5555916,
           'precision50': 0.41747406,
           'recall50': 0.36657023},
     '5': {'avg_iou': 0.78754747,
           'avg_obj': 0.5174991,
           'box_loss': 1.4160342,
           'class_loss': 1.7281162,
           'conf_loss': 3.2043226,
           'precision50': 0.49099535,
           'recall50': 0.51690745},
     'global': {'total_loss': 39.297455},
     'learning_rate': 0.00131,
     'training_loss': 39.297455}
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=185.20s).
Accumulating evaluation results...
DONE (t=17.99s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.261
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.464
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.264
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.109
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.253
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.340
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.244
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.420
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.466
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.281
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.478
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.554
 eval | step:  20000 | eval time:  553.1 sec | output: 
    {'3': {'avg_iou': 0.4626047,
           'avg_obj': 0.15487906,
           'box_loss': 2.4951317,
           'class_loss': 2.1785314,
           'conf_loss': 6.394603,
           'precision50': 0.21043238,
           'recall50': 0.12881477},
     '4': {'avg_iou': 0.6552441,
           'avg_obj': 0.32673204,
           'box_loss': 2.4949663,
           'class_loss': 2.2672067,
           'conf_loss': 6.319243,
           'precision50': 0.35778,
           'recall50': 0.315463},
     '5': {'avg_iou': 0.74396586,
           'avg_obj': 0.48091236,
           'box_loss': 1.5008844,
           'class_loss': 1.5089968,
           'conf_loss': 3.4468026,
           'precision50': 0.4575583,
           'recall50': 0.48617485},
     'AP': 0.2610338,
     'AP50': 0.46398014,
     'AP75': 0.26385668,
     'APl': 0.34029087,
     'APm': 0.25326747,
     'APs': 0.10947109,
     'ARl': 0.55434746,
     'ARm': 0.4775168,
     'ARmax1': 0.24430726,
     'ARmax10': 0.42000595,
     'ARmax100': 0.46628845,
     'ARs': 0.28084338,
     'global': {'total_loss': 28.606379},
     'validation_loss': 28.606379}
train | step:  20000 | training until step 40000...
train | step:  30000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.63529176,
           'avg_obj': 0.21553391,
           'box_loss': 5.0106254,
           'class_loss': 5.2523155,
           'conf_loss': 10.278265,
           'precision50': 0.28883407,
           'recall50': 0.12795316},
     '4': {'avg_iou': 0.7336095,
           'avg_obj': 0.35396087,
           'box_loss': 3.4376578,
           'class_loss': 4.0569797,
           'conf_loss': 8.222934,
           'precision50': 0.40841877,
           'recall50': 0.30894658},
     '5': {'avg_iou': 0.7649809,
           'avg_obj': 0.46065703,
           'box_loss': 1.5658044,
           'class_loss': 2.139728,
           'conf_loss': 3.5785208,
           'precision50': 0.4835642,
           'recall50': 0.45503742},
     'global': {'total_loss': 43.542744},
     'learning_rate': 0.00131,
     'training_loss': 43.542744}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-30000.
train | step:  40000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6448097,
           'avg_obj': 0.23186453,
           'box_loss': 4.8852854,
           'class_loss': 4.8917823,
           'conf_loss': 10.064479,
           'precision50': 0.29964587,
           'recall50': 0.14371015},
     '4': {'avg_iou': 0.74412006,
           'avg_obj': 0.37707728,
           'box_loss': 3.3054304,
           'class_loss': 3.7099457,
           'conf_loss': 7.935849,
           'precision50': 0.4131961,
           'recall50': 0.33446696},
     '5': {'avg_iou': 0.77534807,
           'avg_obj': 0.48527807,
           'box_loss': 1.4984431,
           'class_loss': 1.9577688,
           'conf_loss': 3.4191418,
           'precision50': 0.48712876,
           'recall50': 0.48253387},
     'global': {'total_loss': 41.66821},
     'learning_rate': 0.00131,
     'training_loss': 41.66821}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-40000.
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=181.81s).
Accumulating evaluation results...
DONE (t=16.56s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.307
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.523
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.319
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.133
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.302
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.403
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.268
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.455
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.503
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.311
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.517
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.597
 eval | step:  40000 | eval time:  504.4 sec | output: 
    {'3': {'avg_iou': 0.4716082,
           'avg_obj': 0.17694229,
           'box_loss': 2.3801296,
           'class_loss': 1.8531681,
           'conf_loss': 6.150635,
           'precision50': 0.22897144,
           'recall50': 0.15573208},
     '4': {'avg_iou': 0.66923773,
           'avg_obj': 0.36877197,
           'box_loss': 2.3427439,
           'class_loss': 1.8885523,
           'conf_loss': 5.9229198,
           'precision50': 0.3709561,
           'recall50': 0.36551744},
     '5': {'avg_iou': 0.7621748,
           'avg_obj': 0.53214073,
           'box_loss': 1.3847282,
           'class_loss': 1.2495587,
           'conf_loss': 3.1671743,
           'precision50': 0.45836586,
           'recall50': 0.54278773},
     'AP': 0.306872,
     'AP50': 0.52309364,
     'AP75': 0.31870228,
     'APl': 0.40267447,
     'APm': 0.30164918,
     'APs': 0.13266289,
     'ARl': 0.5969531,
     'ARm': 0.51711625,
     'ARmax1': 0.2681297,
     'ARmax10': 0.45458624,
     'ARmax100': 0.50262314,
     'ARs': 0.3112775,
     'global': {'total_loss': 26.339615},
     'validation_loss': 26.339615}
train | step:  40000 | training until step 60000...
train | step:  50000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6517011,
           'avg_obj': 0.2441994,
           'box_loss': 4.796469,
           'class_loss': 4.6395288,
           'conf_loss': 9.904282,
           'precision50': 0.3066874,
           'recall50': 0.15515405},
     '4': {'avg_iou': 0.75160223,
           'avg_obj': 0.39400387,
           'box_loss': 3.206671,
           'class_loss': 3.4627988,
           'conf_loss': 7.7146187,
           'precision50': 0.41587743,
           'recall50': 0.35281143},
     '5': {'avg_iou': 0.78250414,
           'avg_obj': 0.50346786,
           'box_loss': 1.4483634,
           'class_loss': 1.8288635,
           'conf_loss': 3.2947457,
           'precision50': 0.48960206,
           'recall50': 0.502045},
     'global': {'total_loss': 40.29627},
     'learning_rate': 0.00131,
     'training_loss': 40.29627}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-50000.
train | step:  60000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.65638787,
           'avg_obj': 0.2538419,
           'box_loss': 4.7323394,
           'class_loss': 4.458661,
           'conf_loss': 9.780373,
           'precision50': 0.3118456,
           'recall50': 0.16413288},
     '4': {'avg_iou': 0.757168,
           'avg_obj': 0.4069087,
           'box_loss': 3.137102,
           'class_loss': 3.2848547,
           'conf_loss': 7.5555916,
           'precision50': 0.41747406,
           'recall50': 0.36657023},
     '5': {'avg_iou': 0.78754747,
           'avg_obj': 0.5174991,
           'box_loss': 1.4160342,
           'class_loss': 1.7281162,
           'conf_loss': 3.2043226,
           'precision50': 0.49099535,
           'recall50': 0.51690745},
     'global': {'total_loss': 39.297455},
     'learning_rate': 0.00131,
     'training_loss': 39.297455}I0525 12:09:35.305698 140683405055808 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-60000.
I0525 12:09:35.311583 140683405055808 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0525 12:13:35.484597 140683405055808 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0525 12:17:54.276767 140683405055808 controller.py:261]  eval | step:  60000 | eval time:  499.0 sec | output: 
    {'3': {'avg_iou': 0.4765728,
           'avg_obj': 0.18907936,
           'box_loss': 2.320649,
           'class_loss': 1.7023066,
           'conf_loss': 6.028262,
           'precision50': 0.23694783,
           'recall50': 0.17046872},
     '4': {'avg_iou': 0.6772885,
           'avg_obj': 0.39004332,
           'box_loss': 2.2541592,
           'class_loss': 1.7152145,
           'conf_loss': 5.7545676,
           'precision50': 0.36849517,
           'recall50': 0.38734552},
     '5': {'avg_iou': 0.7707671,
           'avg_obj': 0.55697906,
           'box_loss': 1.3260199,
           'class_loss': 1.130627,
           'conf_loss': 3.0428407,
           'precision50': 0.45654482,
           'recall50': 0.56930125},
     'AP': 0.3306649,
     'AP50': 0.5531321,
     'AP75': 0.3473976,
     'APl': 0.43598178,
     'APm': 0.32608706,
     'APs': 0.14118631,
     'ARl': 0.6194422,
     'ARm': 0.54069716,
     'ARmax1': 0.28285736,
     'ARmax10': 0.47432488,
     'ARmax100': 0.52328086,
     'ARs': 0.33064756,
     'global': {'total_loss': 25.274645},
     'validation_loss': 25.274645}
I0525 12:18:15.159695 140683405055808 controller.py:211] train | step:  60000 | training until step 80000...
I0525 13:20:45.775805 140683405055808 controller.py:425] train | step:  70000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.66064566,
           'avg_obj': 0.26213998,
           'box_loss': 4.669461,
           'class_loss': 4.2855644,
           'conf_loss': 9.660269,
           'precision50': 0.3152211,
           'recall50': 0.17161614},
     '4': {'avg_iou': 0.76169676,
           'avg_obj': 0.4176241,
           'box_loss': 3.0743284,
           'class_loss': 3.1284707,
           'conf_loss': 7.408646,
           'precision50': 0.41822308,
           'recall50': 0.37797904},
     '5': {'avg_iou': 0.7918201,
           'avg_obj': 0.52840847,
           'box_loss': 1.3889072,
           'class_loss': 1.6562189,
           'conf_loss': 3.1360373,
           'precision50': 0.49185395,
           'recall50': 0.5279933},
     'global': {'total_loss': 38.40783},
     'learning_rate': 0.00131,
     'training_loss': 38.40783}
I0525 13:21:30.541010 140683405055808 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-70000.
I0525 14:23:39.131543 140683405055808 controller.py:425] train | step:  80000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.66384363,
           'avg_obj': 0.26885352,
           'box_loss': 4.6288204,
           'class_loss': 4.1620216,
           'conf_loss': 9.576165,
           'precision50': 0.3193496,
           'recall50': 0.17802967},
     '4': {'avg_iou': 0.76515126,
           'avg_obj': 0.42672354,
           'box_loss': 3.0313401,
           'class_loss': 3.0107255,
           'conf_loss': 7.2979507,
           'precision50': 0.4196095,
           'recall50': 0.38734022},
     '5': {'avg_iou': 0.7953662,
           'avg_obj': 0.5374602,
           'box_loss': 1.3633533,
           'class_loss': 1.592227,
           'conf_loss': 3.072776,
           'precision50': 0.49201074,
           'recall50': 0.5369319},
     'global': {'total_loss': 37.73526},
     'learning_rate': 0.00131,
     'training_loss': 37.73526}
I0525 14:24:28.375325 140683405055808 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-80000.
I0525 14:24:28.381615 140683405055808 controller.py:252]  eval | step:  80000 | running 625 steps of evaluation...
I0525 14:28:40.786143 140683405055808 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0525 14:33:00.721205 140683405055808 controller.py:261]  eval | step:  80000 | eval time:  512.3 sec | output: 
    {'3': {'avg_iou': 0.4804916,
           'avg_obj': 0.19784783,
           'box_loss': 2.2770405,
           'class_loss': 1.6230808,
           'conf_loss': 5.946252,
           'precision50': 0.24143155,
           'recall50': 0.18186793},
     '4': {'avg_iou': 0.6811767,
           'avg_obj': 0.40379587,
           'box_loss': 2.2052915,
           'class_loss': 1.6273956,
           'conf_loss': 5.648449,
           'precision50': 0.36539575,
           'recall50': 0.40115553},
     '5': {'avg_iou': 0.7763183,
           'avg_obj': 0.5710343,
           'box_loss': 1.290414,
           'class_loss': 1.0657616,
           'conf_loss': 2.9836555,
           'precision50': 0.45131934,
           'recall50': 0.58322203},
     'AP': 0.34405035,
     'AP50': 0.5687314,
     'AP75': 0.36328122,
     'APl': 0.45377967,
     'APm': 0.3376516,
     'APs': 0.1520813,
     'ARl': 0.6316161,
     'ARm': 0.54906553,
     'ARmax1': 0.2911545,
     'ARmax10': 0.484532,
     'ARmax100': 0.5343284,
     'ARs': 0.3377157,
     'global': {'total_loss': 24.667341},
     'validation_loss': 24.667341}
I0525 14:33:17.616481 140683405055808 controller.py:211] train | step:  80000 | training until step 100000...
I0525 15:34:47.839810 140683405055808 controller.py:425] train | step:  90000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.66654027,
           'avg_obj': 0.27484345,
           'box_loss': 4.5900197,
           'class_loss': 4.0478196,
           'conf_loss': 9.493245,
           'precision50': 0.32128325,
           'recall50': 0.18318939},
     '4': {'avg_iou': 0.76801693,
           'avg_obj': 0.43400404,
           'box_loss': 2.992601,
           'class_loss': 2.913338,
           'conf_loss': 7.2002196,
           'precision50': 0.41947296,
           'recall50': 0.394177},
     '5': {'avg_iou': 0.7979775,
           'avg_obj': 0.5448859,
           'box_loss': 1.3450776,
           'class_loss': 1.5374771,
           'conf_loss': 3.02124,
           'precision50': 0.49239677,
           'recall50': 0.5444216},
     'global': {'total_loss': 37.141087},
     'learning_rate': 0.00131,
     'training_loss': 37.141087}
I0525 15:35:33.098136 140683405055808 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-90000.
I0525 16:35:54.217895 140683405055808 controller.py:425] train | step:  100000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.669791,
           'avg_obj': 0.2802843,
           'box_loss': 4.5468407,
           'class_loss': 3.943641,
           'conf_loss': 9.424039,
           'precision50': 0.3237523,
           'recall50': 0.18839477},
     '4': {'avg_iou': 0.7707511,
           'avg_obj': 0.44103155,
           'box_loss': 2.9626567,
           'class_loss': 2.8254702,
           'conf_loss': 7.121272,
           'precision50': 0.42167845,
           'recall50': 0.4026301},
     '5': {'avg_iou': 0.80034405,
           'avg_obj': 0.5524171,
           'box_loss': 1.3308946,
           'class_loss': 1.4894319,
           'conf_loss': 2.9758863,
           'precision50': 0.49354517,
           'recall50': 0.55264133},
     'global': {'total_loss': 36.620113},
     'learning_rate': 0.00131,
     'training_loss': 36.620113}

saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-60000.
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=181.28s).
Accumulating evaluation results...
DONE (t=16.72s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.331
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.553
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.347
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.141
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.326
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.436
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.283
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.474
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.523
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.331
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.541
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.619
 eval | step:  60000 | eval time:  499.0 sec | output: 
    {'3': {'avg_iou': 0.4765728,
           'avg_obj': 0.18907936,
           'box_loss': 2.320649,
           'class_loss': 1.7023066,
           'conf_loss': 6.028262,
           'precision50': 0.23694783,
           'recall50': 0.17046872},
     '4': {'avg_iou': 0.6772885,
           'avg_obj': 0.39004332,
           'box_loss': 2.2541592,
           'class_loss': 1.7152145,
           'conf_loss': 5.7545676,
           'precision50': 0.36849517,
           'recall50': 0.38734552},
     '5': {'avg_iou': 0.7707671,
           'avg_obj': 0.55697906,
           'box_loss': 1.3260199,
           'class_loss': 1.130627,
           'conf_loss': 3.0428407,
           'precision50': 0.45654482,
           'recall50': 0.56930125},
     'AP': 0.3306649,
     'AP50': 0.5531321,
     'AP75': 0.3473976,
     'APl': 0.43598178,
     'APm': 0.32608706,
     'APs': 0.14118631,
     'ARl': 0.6194422,
     'ARm': 0.54069716,
     'ARmax1': 0.28285736,
     'ARmax10': 0.47432488,
     'ARmax100': 0.52328086,
     'ARs': 0.33064756,
     'global': {'total_loss': 25.274645},
     'validation_loss': 25.274645}
train | step:  60000 | training until step 80000...
train | step:  70000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.66064566,
           'avg_obj': 0.26213998,
           'box_loss': 4.669461,
           'class_loss': 4.2855644,
           'conf_loss': 9.660269,
           'precision50': 0.3152211,
           'recall50': 0.17161614},
     '4': {'avg_iou': 0.76169676,
           'avg_obj': 0.4176241,
           'box_loss': 3.0743284,
           'class_loss': 3.1284707,
           'conf_loss': 7.408646,
           'precision50': 0.41822308,
           'recall50': 0.37797904},
     '5': {'avg_iou': 0.7918201,
           'avg_obj': 0.52840847,
           'box_loss': 1.3889072,
           'class_loss': 1.6562189,
           'conf_loss': 3.1360373,
           'precision50': 0.49185395,
           'recall50': 0.5279933},
     'global': {'total_loss': 38.40783},
     'learning_rate': 0.00131,
     'training_loss': 38.40783}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-70000.
train | step:  80000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.66384363,
           'avg_obj': 0.26885352,
           'box_loss': 4.6288204,
           'class_loss': 4.1620216,
           'conf_loss': 9.576165,
           'precision50': 0.3193496,
           'recall50': 0.17802967},
     '4': {'avg_iou': 0.76515126,
           'avg_obj': 0.42672354,
           'box_loss': 3.0313401,
           'class_loss': 3.0107255,
           'conf_loss': 7.2979507,
           'precision50': 0.4196095,
           'recall50': 0.38734022},
     '5': {'avg_iou': 0.7953662,
           'avg_obj': 0.5374602,
           'box_loss': 1.3633533,
           'class_loss': 1.592227,
           'conf_loss': 3.072776,
           'precision50': 0.49201074,
           'recall50': 0.5369319},
     'global': {'total_loss': 37.73526},
     'learning_rate': 0.00131,
     'training_loss': 37.73526}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-80000.
 eval | step:  80000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=185.74s).
Accumulating evaluation results...
DONE (t=15.54s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.344
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.569
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.363
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.152
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.338
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.454
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.291
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.534
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.338
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.549
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.632
 eval | step:  80000 | eval time:  512.3 sec | output: 
    {'3': {'avg_iou': 0.4804916,
           'avg_obj': 0.19784783,
           'box_loss': 2.2770405,
           'class_loss': 1.6230808,
           'conf_loss': 5.946252,
           'precision50': 0.24143155,
           'recall50': 0.18186793},
     '4': {'avg_iou': 0.6811767,
           'avg_obj': 0.40379587,
           'box_loss': 2.2052915,
           'class_loss': 1.6273956,
           'conf_loss': 5.648449,
           'precision50': 0.36539575,
           'recall50': 0.40115553},
     '5': {'avg_iou': 0.7763183,
           'avg_obj': 0.5710343,
           'box_loss': 1.290414,
           'class_loss': 1.0657616,
           'conf_loss': 2.9836555,
           'precision50': 0.45131934,
           'recall50': 0.58322203},
     'AP': 0.34405035,
     'AP50': 0.5687314,
     'AP75': 0.36328122,
     'APl': 0.45377967,
     'APm': 0.3376516,
     'APs': 0.1520813,
     'ARl': 0.6316161,
     'ARm': 0.54906553,
     'ARmax1': 0.2911545,
     'ARmax10': 0.484532,
     'ARmax100': 0.5343284,
     'ARs': 0.3377157,
     'global': {'total_loss': 24.667341},
     'validation_loss': 24.667341}
train | step:  80000 | training until step 100000...
train | step:  90000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.66654027,
           'avg_obj': 0.27484345,
           'box_loss': 4.5900197,
           'class_loss': 4.0478196,
           'conf_loss': 9.493245,
           'precision50': 0.32128325,
           'recall50': 0.18318939},
     '4': {'avg_iou': 0.76801693,
           'avg_obj': 0.43400404,
           'box_loss': 2.992601,
           'class_loss': 2.913338,
           'conf_loss': 7.2002196,
           'precision50': 0.41947296,
           'recall50': 0.394177},
     '5': {'avg_iou': 0.7979775,
           'avg_obj': 0.5448859,
           'box_loss': 1.3450776,
           'class_loss': 1.5374771,
           'conf_loss': 3.02124,
           'precision50': 0.49239677,
           'recall50': 0.5444216},
     'global': {'total_loss': 37.141087},
     'learning_rate': 0.00131,
     'training_loss': 37.141087}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-90000.
train | step:  100000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.669791,
           'avg_obj': 0.2802843,
           'box_loss': 4.5468407,
           'class_loss': 3.943641,
           'conf_loss': 9.424039,
           'precision50': 0.3237523,
           'recall50': 0.18839477},
     '4': {'avg_iou': 0.7707511,
           'avg_obj': 0.44103155,
           'box_loss': 2.9626567,
           'class_loss': 2.8254702,
           'conf_loss': 7.121272,
           'precision50': 0.42167845,
           'recall50': 0.4026301},
     '5': {'avg_iou': 0.80034405,
           'avg_obj': 0.5524171,
           'box_loss': 1.3308946,
           'class_loss': 1.4894319,
           'conf_loss': 2.9758863,
           'precision50': 0.49354517,
           'recall50': 0.55264133},
     'global': {'total_loss': 36.620113},
     'learning_rate': 0.00131,
     'training_loss': 36.620113}I0525 16:36:46.981993 140683405055808 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-100000.
I0525 16:36:46.987405 140683405055808 controller.py:252]  eval | step:  100000 | running 625 steps of evaluation...
I0525 16:40:58.242415 140683405055808 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0525 16:45:20.084623 140683405055808 controller.py:261]  eval | step:  100000 | eval time:  513.1 sec | output: 
    {'3': {'avg_iou': 0.4825019,
           'avg_obj': 0.2030746,
           'box_loss': 2.2506883,
           'class_loss': 1.5762243,
           'conf_loss': 5.900146,
           'precision50': 0.24061753,
           'recall50': 0.18639918},
     '4': {'avg_iou': 0.68433523,
           'avg_obj': 0.4135392,
           'box_loss': 2.1743083,
           'class_loss': 1.5822735,
           'conf_loss': 5.5870585,
           'precision50': 0.36321157,
           'recall50': 0.41212857},
     '5': {'avg_iou': 0.7793227,
           'avg_obj': 0.58117104,
           'box_loss': 1.2692255,
           'class_loss': 1.0413378,
           'conf_loss': 2.931021,
           'precision50': 0.44874606,
           'recall50': 0.59076834},
     'AP': 0.35282558,
     'AP50': 0.579659,
     'AP75': 0.37387753,
     'APl': 0.4625497,
     'APm': 0.34774515,
     'APs': 0.16258538,
     'ARl': 0.635486,
     'ARm': 0.55332243,
     'ARmax1': 0.29253906,
     'ARmax10': 0.49220473,
     'ARmax100': 0.5397316,
     'ARs': 0.34783944,
     'global': {'total_loss': 24.312273},
     'validation_loss': 24.312273}
I0525 16:45:40.953659 140683405055808 controller.py:211] train | step:  100000 | training until step 120000...
I0525 17:45:32.121259 140683405055808 controller.py:425] train | step:  110000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.67127126,
           'avg_obj': 0.28500554,
           'box_loss': 4.5278807,
           'class_loss': 3.8583477,
           'conf_loss': 9.358367,
           'precision50': 0.32552785,
           'recall50': 0.19265878},
     '4': {'avg_iou': 0.7731556,
           'avg_obj': 0.44785517,
           'box_loss': 2.9265976,
           'class_loss': 2.7422094,
           'conf_loss': 7.0226765,
           'precision50': 0.42203265,
           'recall50': 0.40968046},
     '5': {'avg_iou': 0.80244005,
           'avg_obj': 0.558935,
           'box_loss': 1.3161224,
           'class_loss': 1.4491595,
           'conf_loss': 2.9325702,
           'precision50': 0.49356967,
           'recall50': 0.55930746},
     'global': {'total_loss': 36.133976},
     'learning_rate': 0.00131,
     'training_loss': 36.133976}
I0525 17:46:18.292438 140683405055808 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-110000.
I0525 18:47:34.413161 140683405055808 controller.py:425] train | step:  120000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.67352444,
           'avg_obj': 0.28958443,
           'box_loss': 4.5015078,
           'class_loss': 3.782822,
           'conf_loss': 9.30717,
           'precision50': 0.3278714,
           'recall50': 0.19720377},
     '4': {'avg_iou': 0.77505404,
           'avg_obj': 0.45303896,
           'box_loss': 2.9038265,
           'class_loss': 2.676163,
           'conf_loss': 6.9642344,
           'precision50': 0.42190748,
           'recall50': 0.41481483},
     '5': {'avg_iou': 0.8041188,
           'avg_obj': 0.5637276,
           'box_loss': 1.3062788,
           'class_loss': 1.4124775,
           'conf_loss': 2.9020915,
           'precision50': 0.49338266,
           'recall50': 0.5636481},
     'global': {'total_loss': 35.756577},
     'learning_rate': 0.00131,
     'training_loss': 35.756577}
I0525 18:48:23.132669 140683405055808 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-120000.
I0525 18:48:23.138784 140683405055808 controller.py:252]  eval | step:  120000 | running 625 steps of evaluation...
I0525 18:52:26.175468 140683405055808 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0525 18:56:40.043565 140683405055808 controller.py:261]  eval | step:  120000 | eval time:  496.9 sec | output: 
    {'3': {'avg_iou': 0.48437393,
           'avg_obj': 0.20798601,
           'box_loss': 2.2304516,
           'class_loss': 1.5350215,
           'conf_loss': 5.8656178,
           'precision50': 0.2430722,
           'recall50': 0.19176392},
     '4': {'avg_iou': 0.68669623,
           'avg_obj': 0.42212772,
           'box_loss': 2.1456206,
           'class_loss': 1.5322343,
           'conf_loss': 5.544965,
           'precision50': 0.3643479,
           'recall50': 0.42249537},
     '5': {'avg_iou': 0.7815696,
           'avg_obj': 0.58985656,
           'box_loss': 1.2539119,
           'class_loss': 1.0073048,
           'conf_loss': 2.898692,
           'precision50': 0.44670224,
           'recall50': 0.60245556},
     'AP': 0.36217803,
     'AP50': 0.58887357,
     'AP75': 0.38659805,
     'APl': 0.47497344,
     'APm': 0.3578627,
     'APs': 0.16550666,
     'ARl': 0.6435527,
     'ARm': 0.560058,
     'ARmax1': 0.2997778,
     'ARmax10': 0.49752873,
     'ARmax100': 0.54575706,
     'ARs': 0.35152054,
     'global': {'total_loss': 24.013824},
     'validation_loss': 24.013824}
I0525 18:56:56.646899 140683405055808 controller.py:211] train | step:  120000 | training until step 140000...
I0525 19:55:32.186791 140683405055808 controller.py:425] train | step:  130000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6748529,
           'avg_obj': 0.2941093,
           'box_loss': 4.4925537,
           'class_loss': 3.7225757,
           'conf_loss': 9.265169,
           'precision50': 0.33086553,
           'recall50': 0.20221059},
     '4': {'avg_iou': 0.7768438,
           'avg_obj': 0.45853272,
           'box_loss': 2.885989,
           'class_loss': 2.620411,
           'conf_loss': 6.904242,
           'precision50': 0.4230981,
           'recall50': 0.42062622},
     '5': {'avg_iou': 0.80592024,
           'avg_obj': 0.5696496,
           'box_loss': 1.2938036,
           'class_loss': 1.3848786,
           'conf_loss': 2.863386,
           'precision50': 0.49346894,
           'recall50': 0.56885815},
     'global': {'total_loss': 35.433014},
     'learning_rate': 0.00131,
     'training_loss': 35.433014}
I0525 19:56:14.446999 140683405055808 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-130000.
I0525 20:57:22.628810 140683405055808 controller.py:425] train | step:  140000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6769433,
           'avg_obj': 0.2979471,
           'box_loss': 4.44655,
           'class_loss': 3.6353831,
           'conf_loss': 9.177481,
           'precision50': 0.3313033,
           'recall50': 0.20501775},
     '4': {'avg_iou': 0.77869505,
           'avg_obj': 0.46336958,
           'box_loss': 2.857085,
           'class_loss': 2.5531375,
           'conf_loss': 6.829767,
           'precision50': 0.42301503,
           'recall50': 0.42580903},
     '5': {'avg_iou': 0.80732685,
           'avg_obj': 0.5743665,
           'box_loss': 1.2838486,
           'class_loss': 1.3519447,
           'conf_loss': 2.8325214,
           'precision50': 0.4933933,
           'recall50': 0.574096},
     'global': {'total_loss': 34.96772},
     'learning_rate': 0.00131,
     'training_loss': 34.96772}

saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-100000.
 eval | step:  100000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=188.59s).
Accumulating evaluation results...
DONE (t=17.01s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.353
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.580
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.374
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.163
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.348
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.463
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.293
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.492
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.540
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.348
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.553
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.635
 eval | step:  100000 | eval time:  513.1 sec | output: 
    {'3': {'avg_iou': 0.4825019,
           'avg_obj': 0.2030746,
           'box_loss': 2.2506883,
           'class_loss': 1.5762243,
           'conf_loss': 5.900146,
           'precision50': 0.24061753,
           'recall50': 0.18639918},
     '4': {'avg_iou': 0.68433523,
           'avg_obj': 0.4135392,
           'box_loss': 2.1743083,
           'class_loss': 1.5822735,
           'conf_loss': 5.5870585,
           'precision50': 0.36321157,
           'recall50': 0.41212857},
     '5': {'avg_iou': 0.7793227,
           'avg_obj': 0.58117104,
           'box_loss': 1.2692255,
           'class_loss': 1.0413378,
           'conf_loss': 2.931021,
           'precision50': 0.44874606,
           'recall50': 0.59076834},
     'AP': 0.35282558,
     'AP50': 0.579659,
     'AP75': 0.37387753,
     'APl': 0.4625497,
     'APm': 0.34774515,
     'APs': 0.16258538,
     'ARl': 0.635486,
     'ARm': 0.55332243,
     'ARmax1': 0.29253906,
     'ARmax10': 0.49220473,
     'ARmax100': 0.5397316,
     'ARs': 0.34783944,
     'global': {'total_loss': 24.312273},
     'validation_loss': 24.312273}
train | step:  100000 | training until step 120000...
train | step:  110000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.67127126,
           'avg_obj': 0.28500554,
           'box_loss': 4.5278807,
           'class_loss': 3.8583477,
           'conf_loss': 9.358367,
           'precision50': 0.32552785,
           'recall50': 0.19265878},
     '4': {'avg_iou': 0.7731556,
           'avg_obj': 0.44785517,
           'box_loss': 2.9265976,
           'class_loss': 2.7422094,
           'conf_loss': 7.0226765,
           'precision50': 0.42203265,
           'recall50': 0.40968046},
     '5': {'avg_iou': 0.80244005,
           'avg_obj': 0.558935,
           'box_loss': 1.3161224,
           'class_loss': 1.4491595,
           'conf_loss': 2.9325702,
           'precision50': 0.49356967,
           'recall50': 0.55930746},
     'global': {'total_loss': 36.133976},
     'learning_rate': 0.00131,
     'training_loss': 36.133976}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-110000.
train | step:  120000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.67352444,
           'avg_obj': 0.28958443,
           'box_loss': 4.5015078,
           'class_loss': 3.782822,
           'conf_loss': 9.30717,
           'precision50': 0.3278714,
           'recall50': 0.19720377},
     '4': {'avg_iou': 0.77505404,
           'avg_obj': 0.45303896,
           'box_loss': 2.9038265,
           'class_loss': 2.676163,
           'conf_loss': 6.9642344,
           'precision50': 0.42190748,
           'recall50': 0.41481483},
     '5': {'avg_iou': 0.8041188,
           'avg_obj': 0.5637276,
           'box_loss': 1.3062788,
           'class_loss': 1.4124775,
           'conf_loss': 2.9020915,
           'precision50': 0.49338266,
           'recall50': 0.5636481},
     'global': {'total_loss': 35.756577},
     'learning_rate': 0.00131,
     'training_loss': 35.756577}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-120000.
 eval | step:  120000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=181.09s).
Accumulating evaluation results...
DONE (t=13.89s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.362
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.589
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.387
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.166
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.358
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.475
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.300
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.498
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.546
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.352
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.560
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.644
 eval | step:  120000 | eval time:  496.9 sec | output: 
    {'3': {'avg_iou': 0.48437393,
           'avg_obj': 0.20798601,
           'box_loss': 2.2304516,
           'class_loss': 1.5350215,
           'conf_loss': 5.8656178,
           'precision50': 0.2430722,
           'recall50': 0.19176392},
     '4': {'avg_iou': 0.68669623,
           'avg_obj': 0.42212772,
           'box_loss': 2.1456206,
           'class_loss': 1.5322343,
           'conf_loss': 5.544965,
           'precision50': 0.3643479,
           'recall50': 0.42249537},
     '5': {'avg_iou': 0.7815696,
           'avg_obj': 0.58985656,
           'box_loss': 1.2539119,
           'class_loss': 1.0073048,
           'conf_loss': 2.898692,
           'precision50': 0.44670224,
           'recall50': 0.60245556},
     'AP': 0.36217803,
     'AP50': 0.58887357,
     'AP75': 0.38659805,
     'APl': 0.47497344,
     'APm': 0.3578627,
     'APs': 0.16550666,
     'ARl': 0.6435527,
     'ARm': 0.560058,
     'ARmax1': 0.2997778,
     'ARmax10': 0.49752873,
     'ARmax100': 0.54575706,
     'ARs': 0.35152054,
     'global': {'total_loss': 24.013824},
     'validation_loss': 24.013824}
train | step:  120000 | training until step 140000...
train | step:  130000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6748529,
           'avg_obj': 0.2941093,
           'box_loss': 4.4925537,
           'class_loss': 3.7225757,
           'conf_loss': 9.265169,
           'precision50': 0.33086553,
           'recall50': 0.20221059},
     '4': {'avg_iou': 0.7768438,
           'avg_obj': 0.45853272,
           'box_loss': 2.885989,
           'class_loss': 2.620411,
           'conf_loss': 6.904242,
           'precision50': 0.4230981,
           'recall50': 0.42062622},
     '5': {'avg_iou': 0.80592024,
           'avg_obj': 0.5696496,
           'box_loss': 1.2938036,
           'class_loss': 1.3848786,
           'conf_loss': 2.863386,
           'precision50': 0.49346894,
           'recall50': 0.56885815},
     'global': {'total_loss': 35.433014},
     'learning_rate': 0.00131,
     'training_loss': 35.433014}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-130000.
train | step:  140000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6769433,
           'avg_obj': 0.2979471,
           'box_loss': 4.44655,
           'class_loss': 3.6353831,
           'conf_loss': 9.177481,
           'precision50': 0.3313033,
           'recall50': 0.20501775},
     '4': {'avg_iou': 0.77869505,
           'avg_obj': 0.46336958,
           'box_loss': 2.857085,
           'class_loss': 2.5531375,
           'conf_loss': 6.829767,
           'precision50': 0.42301503,
           'recall50': 0.42580903},
     '5': {'avg_iou': 0.80732685,
           'avg_obj': 0.5743665,
           'box_loss': 1.2838486,
           'class_loss': 1.3519447,
           'conf_loss': 2.8325214,
           'precision50': 0.4933933,
           'recall50': 0.574096},
     'global': {'total_loss': 34.96772},
     'learning_rate': 0.00131,
     'training_loss': 34.96772}I0525 20:58:08.588448 140683405055808 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-140000.
I0525 20:58:08.596270 140683405055808 controller.py:252]  eval | step:  140000 | running 625 steps of evaluation...
I0525 21:02:09.256941 140683405055808 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0525 21:06:27.343458 140683405055808 controller.py:261]  eval | step:  140000 | eval time:  498.7 sec | output: 
    {'3': {'avg_iou': 0.48570004,
           'avg_obj': 0.21339515,
           'box_loss': 2.2146938,
           'class_loss': 1.5171702,
           'conf_loss': 5.840685,
           'precision50': 0.2447602,
           'recall50': 0.19810018},
     '4': {'avg_iou': 0.688922,
           'avg_obj': 0.429086,
           'box_loss': 2.1199293,
           'class_loss': 1.5243003,
           'conf_loss': 5.516051,
           'precision50': 0.36394447,
           'recall50': 0.42904654},
     '5': {'avg_iou': 0.7838117,
           'avg_obj': 0.5970263,
           'box_loss': 1.2400876,
           'class_loss': 0.9927585,
           'conf_loss': 2.8807592,
           'precision50': 0.44083408,
           'recall50': 0.6085311},
     'AP': 0.36600655,
     'AP50': 0.59244704,
     'AP75': 0.38996822,
     'APl': 0.48080435,
     'APm': 0.36281025,
     'APs': 0.1681902,
     'ARl': 0.64724445,
     'ARm': 0.5663506,
     'ARmax1': 0.2994252,
     'ARmax10': 0.5005397,
     'ARmax100': 0.54812276,
     'ARs': 0.34950644,
     'global': {'total_loss': 23.84645},
     'validation_loss': 23.84645}
I0525 21:06:48.675569 140683405055808 controller.py:211] train | step:  140000 | training until step 160000...
I0525 22:04:32.658096 140683405055808 controller.py:425] train | step:  150000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6778959,
           'avg_obj': 0.30144572,
           'box_loss': 4.436287,
           'class_loss': 3.5805745,
           'conf_loss': 9.136283,
           'precision50': 0.3324654,
           'recall50': 0.20818758},
     '4': {'avg_iou': 0.78029096,
           'avg_obj': 0.4679561,
           'box_loss': 2.8322287,
           'class_loss': 2.4959474,
           'conf_loss': 6.7626944,
           'precision50': 0.42404526,
           'recall50': 0.43044594},
     '5': {'avg_iou': 0.8085822,
           'avg_obj': 0.578474,
           'box_loss': 1.273452,
           'class_loss': 1.3264169,
           'conf_loss': 2.8000062,
           'precision50': 0.49288872,
           'recall50': 0.5777798},
     'global': {'total_loss': 34.64391},
     'learning_rate': 0.00131,
     'training_loss': 34.64391}
I0525 22:05:19.185235 140683405055808 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-150000.
I0525 23:06:53.014043 140683405055808 controller.py:425] train | step:  160000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.67956877,
           'avg_obj': 0.30488932,
           'box_loss': 4.427324,
           'class_loss': 3.5368774,
           'conf_loss': 9.123601,
           'precision50': 0.3332914,
           'recall50': 0.210938},
     '4': {'avg_iou': 0.7817022,
           'avg_obj': 0.4728018,
           'box_loss': 2.82404,
           'class_loss': 2.4597714,
           'conf_loss': 6.7258563,
           'precision50': 0.42429844,
           'recall50': 0.43534902},
     '5': {'avg_iou': 0.8100363,
           'avg_obj': 0.58325845,
           'box_loss': 1.2670836,
           'class_loss': 1.303698,
           'conf_loss': 2.7756708,
           'precision50': 0.49411798,
           'recall50': 0.58319503},
     'global': {'total_loss': 34.44404},
     'learning_rate': 0.00131,
     'training_loss': 34.44404}
I0525 23:07:46.373111 140683405055808 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-160000.
I0525 23:07:46.379147 140683405055808 controller.py:252]  eval | step:  160000 | running 625 steps of evaluation...
I0525 23:11:51.897205 140683405055808 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0525 23:15:59.821237 140683405055808 controller.py:261]  eval | step:  160000 | eval time:  493.4 sec | output: 
    {'3': {'avg_iou': 0.48624825,
           'avg_obj': 0.2155621,
           'box_loss': 2.202886,
           'class_loss': 1.5009735,
           'conf_loss': 5.820755,
           'precision50': 0.24441788,
           'recall50': 0.20175833},
     '4': {'avg_iou': 0.69030595,
           'avg_obj': 0.4347558,
           'box_loss': 2.1030557,
           'class_loss': 1.505716,
           'conf_loss': 5.4869967,
           'precision50': 0.3618795,
           'recall50': 0.4347424},
     '5': {'avg_iou': 0.7849091,
           'avg_obj': 0.6019807,
           'box_loss': 1.2312391,
           'class_loss': 0.9885872,
           'conf_loss': 2.8685207,
           'precision50': 0.43947485,
           'recall50': 0.6146603},
     'AP': 0.3681913,
     'AP50': 0.5940858,
     'AP75': 0.394422,
     'APl': 0.4829201,
     'APm': 0.3658811,
     'APs': 0.17313498,
     'ARl': 0.6468069,
     'ARm': 0.5642225,
     'ARmax1': 0.30071872,
     'ARmax10': 0.5004232,
     'ARmax100': 0.54784495,
     'ARs': 0.34777305,
     'global': {'total_loss': 23.708721},
     'validation_loss': 23.708721}
I0525 23:16:22.654900 140683405055808 controller.py:211] train | step:  160000 | training until step 180000...
I0526 00:12:17.838938 140683405055808 controller.py:425] train | step:  170000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6808341,
           'avg_obj': 0.3086635,
           'box_loss': 4.3965325,
           'class_loss': 3.4682903,
           'conf_loss': 9.046317,
           'precision50': 0.33507553,
           'recall50': 0.21501143},
     '4': {'avg_iou': 0.7829849,
           'avg_obj': 0.47713605,
           'box_loss': 2.7992675,
           'class_loss': 2.4003148,
           'conf_loss': 6.652725,
           'precision50': 0.42345372,
           'recall50': 0.43892238},
     '5': {'avg_iou': 0.81097794,
           'avg_obj': 0.5871081,
           'box_loss': 1.2572826,
           'class_loss': 1.2722499,
           'conf_loss': 2.742315,
           'precision50': 0.4933051,
           'recall50': 0.58601433},
     'global': {'total_loss': 34.035248},
     'learning_rate': 0.00131,
     'training_loss': 34.035248}
I0526 00:13:03.598146 140683405055808 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-170000.
I0526 01:15:08.500236 140683405055808 controller.py:425] train | step:  180000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.68165755,
           'avg_obj': 0.3106834,
           'box_loss': 4.3906183,
           'class_loss': 3.4384062,
           'conf_loss': 9.026958,
           'precision50': 0.33520192,
           'recall50': 0.21603863},
     '4': {'avg_iou': 0.7840483,
           'avg_obj': 0.48035547,
           'box_loss': 2.7874506,
           'class_loss': 2.3692417,
           'conf_loss': 6.6144643,
           'precision50': 0.42364657,
           'recall50': 0.4424662},
     '5': {'avg_iou': 0.8120008,
           'avg_obj': 0.59092,
           'box_loss': 1.2515812,
           'class_loss': 1.253724,
           'conf_loss': 2.7197704,
           'precision50': 0.49409503,
           'recall50': 0.5904965},
     'global': {'total_loss': 33.852215},
     'learning_rate': 0.00131,
     'training_loss': 33.852215}

saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-140000.
 eval | step:  140000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=184.19s).
Accumulating evaluation results...
DONE (t=13.53s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.366
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.592
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.390
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.168
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.363
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.481
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.299
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.501
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.548
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.350
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.566
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.647
 eval | step:  140000 | eval time:  498.7 sec | output: 
    {'3': {'avg_iou': 0.48570004,
           'avg_obj': 0.21339515,
           'box_loss': 2.2146938,
           'class_loss': 1.5171702,
           'conf_loss': 5.840685,
           'precision50': 0.2447602,
           'recall50': 0.19810018},
     '4': {'avg_iou': 0.688922,
           'avg_obj': 0.429086,
           'box_loss': 2.1199293,
           'class_loss': 1.5243003,
           'conf_loss': 5.516051,
           'precision50': 0.36394447,
           'recall50': 0.42904654},
     '5': {'avg_iou': 0.7838117,
           'avg_obj': 0.5970263,
           'box_loss': 1.2400876,
           'class_loss': 0.9927585,
           'conf_loss': 2.8807592,
           'precision50': 0.44083408,
           'recall50': 0.6085311},
     'AP': 0.36600655,
     'AP50': 0.59244704,
     'AP75': 0.38996822,
     'APl': 0.48080435,
     'APm': 0.36281025,
     'APs': 0.1681902,
     'ARl': 0.64724445,
     'ARm': 0.5663506,
     'ARmax1': 0.2994252,
     'ARmax10': 0.5005397,
     'ARmax100': 0.54812276,
     'ARs': 0.34950644,
     'global': {'total_loss': 23.84645},
     'validation_loss': 23.84645}
train | step:  140000 | training until step 160000...
train | step:  150000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6778959,
           'avg_obj': 0.30144572,
           'box_loss': 4.436287,
           'class_loss': 3.5805745,
           'conf_loss': 9.136283,
           'precision50': 0.3324654,
           'recall50': 0.20818758},
     '4': {'avg_iou': 0.78029096,
           'avg_obj': 0.4679561,
           'box_loss': 2.8322287,
           'class_loss': 2.4959474,
           'conf_loss': 6.7626944,
           'precision50': 0.42404526,
           'recall50': 0.43044594},
     '5': {'avg_iou': 0.8085822,
           'avg_obj': 0.578474,
           'box_loss': 1.273452,
           'class_loss': 1.3264169,
           'conf_loss': 2.8000062,
           'precision50': 0.49288872,
           'recall50': 0.5777798},
     'global': {'total_loss': 34.64391},
     'learning_rate': 0.00131,
     'training_loss': 34.64391}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-150000.
train | step:  160000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.67956877,
           'avg_obj': 0.30488932,
           'box_loss': 4.427324,
           'class_loss': 3.5368774,
           'conf_loss': 9.123601,
           'precision50': 0.3332914,
           'recall50': 0.210938},
     '4': {'avg_iou': 0.7817022,
           'avg_obj': 0.4728018,
           'box_loss': 2.82404,
           'class_loss': 2.4597714,
           'conf_loss': 6.7258563,
           'precision50': 0.42429844,
           'recall50': 0.43534902},
     '5': {'avg_iou': 0.8100363,
           'avg_obj': 0.58325845,
           'box_loss': 1.2670836,
           'class_loss': 1.303698,
           'conf_loss': 2.7756708,
           'precision50': 0.49411798,
           'recall50': 0.58319503},
     'global': {'total_loss': 34.44404},
     'learning_rate': 0.00131,
     'training_loss': 34.44404}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-160000.
 eval | step:  160000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=182.60s).
Accumulating evaluation results...
DONE (t=13.74s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.368
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.594
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.394
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.173
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.366
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.483
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.301
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.500
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.548
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.348
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.564
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.647
 eval | step:  160000 | eval time:  493.4 sec | output: 
    {'3': {'avg_iou': 0.48624825,
           'avg_obj': 0.2155621,
           'box_loss': 2.202886,
           'class_loss': 1.5009735,
           'conf_loss': 5.820755,
           'precision50': 0.24441788,
           'recall50': 0.20175833},
     '4': {'avg_iou': 0.69030595,
           'avg_obj': 0.4347558,
           'box_loss': 2.1030557,
           'class_loss': 1.505716,
           'conf_loss': 5.4869967,
           'precision50': 0.3618795,
           'recall50': 0.4347424},
     '5': {'avg_iou': 0.7849091,
           'avg_obj': 0.6019807,
           'box_loss': 1.2312391,
           'class_loss': 0.9885872,
           'conf_loss': 2.8685207,
           'precision50': 0.43947485,
           'recall50': 0.6146603},
     'AP': 0.3681913,
     'AP50': 0.5940858,
     'AP75': 0.394422,
     'APl': 0.4829201,
     'APm': 0.3658811,
     'APs': 0.17313498,
     'ARl': 0.6468069,
     'ARm': 0.5642225,
     'ARmax1': 0.30071872,
     'ARmax10': 0.5004232,
     'ARmax100': 0.54784495,
     'ARs': 0.34777305,
     'global': {'total_loss': 23.708721},
     'validation_loss': 23.708721}
train | step:  160000 | training until step 180000...
train | step:  170000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6808341,
           'avg_obj': 0.3086635,
           'box_loss': 4.3965325,
           'class_loss': 3.4682903,
           'conf_loss': 9.046317,
           'precision50': 0.33507553,
           'recall50': 0.21501143},
     '4': {'avg_iou': 0.7829849,
           'avg_obj': 0.47713605,
           'box_loss': 2.7992675,
           'class_loss': 2.4003148,
           'conf_loss': 6.652725,
           'precision50': 0.42345372,
           'recall50': 0.43892238},
     '5': {'avg_iou': 0.81097794,
           'avg_obj': 0.5871081,
           'box_loss': 1.2572826,
           'class_loss': 1.2722499,
           'conf_loss': 2.742315,
           'precision50': 0.4933051,
           'recall50': 0.58601433},
     'global': {'total_loss': 34.035248},
     'learning_rate': 0.00131,
     'training_loss': 34.035248}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-170000.
train | step:  180000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.68165755,
           'avg_obj': 0.3106834,
           'box_loss': 4.3906183,
           'class_loss': 3.4384062,
           'conf_loss': 9.026958,
           'precision50': 0.33520192,
           'recall50': 0.21603863},
     '4': {'avg_iou': 0.7840483,
           'avg_obj': 0.48035547,
           'box_loss': 2.7874506,
           'class_loss': 2.3692417,
           'conf_loss': 6.6144643,
           'precision50': 0.42364657,
           'recall50': 0.4424662},
     '5': {'avg_iou': 0.8120008,
           'avg_obj': 0.59092,
           'box_loss': 1.2515812,
           'class_loss': 1.253724,
           'conf_loss': 2.7197704,
           'precision50': 0.49409503,
           'recall50': 0.5904965},
     'global': {'total_loss': 33.852215},
     'learning_rate': 0.00131,
     'training_loss': 33.852215}I0526 01:15:53.126237 140683405055808 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-180000.
I0526 01:15:53.132742 140683405055808 controller.py:252]  eval | step:  180000 | running 625 steps of evaluation...
I0526 01:20:05.401524 140683405055808 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0526 01:24:25.984031 140683405055808 controller.py:261]  eval | step:  180000 | eval time:  512.9 sec | output: 
    {'3': {'avg_iou': 0.48657143,
           'avg_obj': 0.217884,
           'box_loss': 2.1981914,
           'class_loss': 1.476897,
           'conf_loss': 5.810232,
           'precision50': 0.24442764,
           'recall50': 0.20393465},
     '4': {'avg_iou': 0.691678,
           'avg_obj': 0.43823037,
           'box_loss': 2.0886073,
           'class_loss': 1.4876568,
           'conf_loss': 5.4544325,
           'precision50': 0.3594096,
           'recall50': 0.43876046},
     '5': {'avg_iou': 0.7864765,
           'avg_obj': 0.6060466,
           'box_loss': 1.2235816,
           'class_loss': 0.97059005,
           'conf_loss': 2.8479679,
           'precision50': 0.43556693,
           'recall50': 0.61678445},
     'AP': 0.37166545,
     'AP50': 0.59859866,
     'AP75': 0.3951091,
     'APl': 0.4848059,
     'APm': 0.36736014,
     'APs': 0.17265205,
     'ARl': 0.6507598,
     'ARm': 0.56578636,
     'ARmax1': 0.3027979,
     'ARmax10': 0.5048921,
     'ARmax100': 0.55254424,
     'ARs': 0.36445147,
     'global': {'total_loss': 23.558157},
     'validation_loss': 23.558157}
I0526 01:24:48.162183 140683405055808 controller.py:211] train | step:  180000 | training until step 200000...
I0526 02:18:55.134295 140683405055808 controller.py:425] train | step:  190000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6829507,
           'avg_obj': 0.3135238,
           'box_loss': 4.378484,
           'class_loss': 3.40203,
           'conf_loss': 9.002111,
           'precision50': 0.33662057,
           'recall50': 0.21909128},
     '4': {'avg_iou': 0.7850196,
           'avg_obj': 0.48335078,
           'box_loss': 2.7744255,
           'class_loss': 2.337754,
           'conf_loss': 6.5764303,
           'precision50': 0.42422652,
           'recall50': 0.44576982},
     '5': {'avg_iou': 0.8126394,
           'avg_obj': 0.59355116,
           'box_loss': 1.247096,
           'class_loss': 1.2371773,
           'conf_loss': 2.701947,
           'precision50': 0.49262026,
           'recall50': 0.59283996},
     'global': {'total_loss': 33.657467},
     'learning_rate': 0.00131,
     'training_loss': 33.657467}
I0526 02:19:38.170599 140683405055808 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-190000.
I0526 03:21:49.582786 140683405055808 controller.py:425] train | step:  200000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.68358916,
           'avg_obj': 0.31639418,
           'box_loss': 4.368398,
           'class_loss': 3.3552165,
           'conf_loss': 8.963294,
           'precision50': 0.33696887,
           'recall50': 0.22113086},
     '4': {'avg_iou': 0.7861258,
           'avg_obj': 0.48743945,
           'box_loss': 2.7638407,
           'class_loss': 2.3059137,
           'conf_loss': 6.5334234,
           'precision50': 0.4240296,
           'recall50': 0.44987613},
     '5': {'avg_iou': 0.81355447,
           'avg_obj': 0.5968921,
           'box_loss': 1.2437038,
           'class_loss': 1.2204684,
           'conf_loss': 2.6865025,
           'precision50': 0.49397472,
           'recall50': 0.596025},
     'global': {'total_loss': 33.44077},
     'learning_rate': 0.00131,
     'training_loss': 33.44077}
I0526 03:22:33.983176 140683405055808 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-post-comment-test-c/ckpt-200000.
I0526 03:22:33.990761 140683405055808 controller.py:252]  eval | step:  200000 | running 625 steps of evaluation...
I0526 03:26:44.980294 140683405055808 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0526 03:30:56.909448 140683405055808 controller.py:261]  eval | step:  200000 | eval time:  502.9 sec | output: 
    {'3': {'avg_iou': 0.48728153,
           'avg_obj': 0.21962613,
           'box_loss': 2.1875684,
           'class_loss': 1.4781282,
           'conf_loss': 5.7946973,
           'precision50': 0.24582781,
           'recall50': 0.20754287},
     '4': {'avg_iou': 0.6921031,
           'avg_obj': 0.44172865,
           'box_loss': 2.0822573,
           'class_loss': 1.4895658,
           'conf_loss': 5.4602613,
           'precision50': 0.35710132,
           'recall50': 0.44345626},
     '5': {'avg_iou': 0.78671205,
           'avg_obj': 0.60827297,
           'box_loss': 1.2221376,
           'class_loss': 0.97631204,
           'conf_loss': 2.8522062,
           'precision50': 0.43522266,
           'recall50': 0.6196953},
     'AP': 0.37489486,
     'AP50': 0.6010166,
     'AP75': 0.40428263,
     'APl': 0.48524648,
     'APm': 0.3737326,
     'APs': 0.17583318,
     'ARl': 0.65243065,
     'ARm': 0.5726117,
     'ARmax1': 0.3052314,
     'ARmax10': 0.5059645,
     'ARmax100': 0.5557468,
     'ARs': 0.36733395,
     'global': {'total_loss': 23.543127},
     'validation_loss': 23.543127}
I0526 03:31:18.667620 140683405055808 controller.py:211] train | step:  200000 | training until step 220000...
