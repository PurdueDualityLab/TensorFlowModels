cat: .experiment_zone: No such file or directory
Request issued for: [node-7]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-03T06:07:04.153014159Z'
  endTime: '2021-05-03T06:07:39.172718879Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620022024138-5c166c546ed5f-1a792eef-125601ab
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.124.160.48/29
  createTime: '2021-03-18T03:10:27.166064884Z'
  health: HEALTHY
  ipAddress: 10.124.160.50
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.124.160.50
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620022024138-5c166c546ed5f-1a792eef-125601ab] to complete...
..................................................................................................................................................................................................done.
europe-west4-a
I0503 06:04:02.111701 140283933239104 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': True},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.3,
                                    'aug_scale_max': 2.0,
                                    'aug_scale_min': 0.1,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.3,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.213,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [240000,
                                                                                260000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00131,
                                                                            0.000655,
                                                                            0.000325]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0503 06:04:02.113062 140283933239104 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4/tpu/512-sam/params.yaml
I0503 06:04:03.643208 140283933239104 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0503 06:04:04.264549 140283933239104 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0503 06:04:04.264823 140283933239104 transport.py:157] Attempting refresh to obtain initial access_token
I0503 06:04:04.326297 140283933239104 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0503 06:04:04.940820 140283933239104 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0503 06:04:04.941101 140283933239104 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-03 06:04:05.028687: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0503 06:04:05.029362 140283933239104 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0503 06:04:05.652929 140283933239104 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0503 06:04:05.653180 140283933239104 transport.py:157] Attempting refresh to obtain initial access_token
I0503 06:04:05.701757 140283933239104 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0503 06:04:06.321359 140283933239104 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0503 06:04:06.321889 140283933239104 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-03 06:04:06.370856: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-03 06:04:06.399157: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.124.160.50:8470}
2021-05-03 06:04:06.399252: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:62394}
2021-05-03 06:04:39.080835: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.124.160.50:8470}
2021-05-03 06:04:39.081203: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:62394}
2021-05-03 06:04:39.082451: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:62394
I0503 06:04:39.083192 140283933239104 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-7
I0503 06:04:39.083607 140283933239104 tpu_strategy_util.py:74] Initializing the TPU system: node-7
INFO:tensorflow:Clearing out eager caches
I0503 06:04:47.528118 140283933239104 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0503 06:04:47.530563 140283933239104 tpu_strategy_util.py:133] Finished initializing TPU system.
I0503 06:04:47.532258 140283933239104 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0503 06:04:48.159321 140283933239104 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0503 06:04:48.159630 140283933239104 transport.py:157] Attempting refresh to obtain initial access_token
I0503 06:04:48.229224 140283933239104 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0503 06:04:48.374627 140283933239104 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0503 06:04:48.374878 140283933239104 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0503 06:04:48.426895 140283933239104 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0503 06:04:48.427423 140283933239104 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0503 06:04:48.427923 140283933239104 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0503 06:04:48.428066 140283933239104 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0503 06:04:48.428188 140283933239104 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0503 06:04:48.428495 140283933239104 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0503 06:04:48.428612 140283933239104 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0503 06:04:48.428706 140283933239104 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0503 06:04:48.428776 140283933239104 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0503 06:04:48.428878 140283933239104 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0503 06:04:48.428983 140283933239104 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0503 06:04:48.429137 140283933239104 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0503 06:04:48.429252 140283933239104 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0503 06:04:48.429349 140283933239104 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0503 06:04:48.429447 140283933239104 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0503 06:04:48.429545 140283933239104 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0503 06:04:48.431131 140283933239104 train_utils.py:214] Running default trainer.
2021-05-03 06:04:48.453708: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': True, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'aug_scale_aspect': 0.3, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [240000, 260000], 'values': [0.00131, 0.000655, 0.000325]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05} 0.00025
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': True, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f96002f8390>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________
yolo_fpn (YoloFPN)              {'5': (None, 16, 16, 15165440    input_2[0][0]                    
                                                                 input_3[0][0]                    I0503 06:05:39.071223 140283933239104 controller.py:362] restoring or initializing model...
I0503 06:05:48.304269 140283933239104 yolo.py:542] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0503 06:05:48.306440 140283933239104 controller.py:368] initialized model.
I0503 06:05:48.306697 140283933239104 train_lib.py:96] Starts to execute mode: train_and_eval
I0503 06:05:48.311786 140283933239104 controller.py:211] train | step:      0 | training until step 20000...
I0503 06:05:56.090275 140283933239104 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0503 06:07:03.924115 140283933239104 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0503 07:22:50.221690 140283933239104 controller.py:425] train | step:  10000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.55229557,
           'avg_obj': 0.11892047,
           'box_loss': 5.7482486,
           'class_loss': 14.592727,
           'conf_loss': 37.211327,
           'precision50': 0.15101707,
           'recall50': 0.04489131},
     '4': {'avg_iou': 0.6400133,
           'avg_obj': 0.20623271,
           'box_loss': 4.4375296,
           'class_loss': 13.739835,
           'conf_loss': 17.59741,
           'precision50': 0.29198125,
           'recall50': 0.14050552},
     '5': {'avg_iou': 0.68087435,
           'avg_obj': 0.28948742,
           'box_loss': 2.0651681,
           'class_loss': 7.420835,
           'conf_loss': 7.622757,
           'precision50': 0.3796226,
           'recall50': 0.25329942},
     'global': {'total_loss': 110.43603},
     'learning_rate': 0.00131,
     'training_loss': 110.43603}
I0503 07:23:48.388283 140283933239104 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-10000.
I0503 08:26:24.834244 140283933239104 controller.py:425] train | step:  20000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.61610144,
           'avg_obj': 0.17622642,
           'box_loss': 4.938199,
           'class_loss': 5.818104,
           'conf_loss': 10.1217575,
           'precision50': 0.24359456,
           'recall50': 0.08881363},
     '4': {'avg_iou': 0.7199329,
           'avg_obj': 0.30133554,
           'box_loss': 3.4531062,
           'class_loss': 4.842202,
           'conf_loss': 8.499164,
           'precision50': 0.3890368,
           'recall50': 0.24581401},
     '5': {'avg_iou': 0.75679,
           'avg_obj': 0.40615222,
           'box_loss': 1.5761272,
           'class_loss': 2.5384483,
           'conf_loss': 3.829184,
           'precision50': 0.4840062,
           'recall50': 0.39651644},
     'global': {'total_loss': 45.61625},
     'learning_rate': 0.00131,
     'training_loss': 45.61625}
I0503 08:27:16.345196 140283933239104 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-20000.
I0503 08:27:16.351654 140283933239104 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0503 08:27:17.022662 140283933239104 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0503 08:27:33.759742 140283933239104 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0503 08:32:31.228914 140283933239104 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0503 08:36:45.982796 140283933239104 controller.py:261]  eval | step:  20000 | eval time:  569.6 sec | output: 
    {'3': {'avg_iou': 0.48426786,
           'avg_obj': 0.1668442,
           'box_loss': 2.8258407,
           'class_loss': 2.5876937,
           'conf_loss': 6.953411,
           'precision50': 0.2348702,
           'recall50': 0.13702686},
     '4': {'avg_iou': 0.6872511,
           'avg_obj': 0.3618258,
           'box_loss': 2.3018155,
           'class_loss': 2.3122957,
           'conf_loss': 5.8917885,
           'precision50': 0.38993758,
           'recall50': 0.35168868},
     '5': {'avg_iou': 0.748444,
           'avg_obj': 0.51215893,
           'box_loss': 1.2362226,
           'class_loss': 1.3181479,
           'conf_loss': 2.851725,
           'precision50': 0.49242848,
           'recall50': 0.52460104},
     'AP': 0.26233637,
     'AP50': 0.45449945,
     'AP75': 0.26991725,
     'APl': 0.36191463,
     'APm': 0.272546,
     'APs': 0.09807064,
     'ARl': 0.5751352,
     'ARm': 0.49362034,
     'ARmax1': 0.24401008,
     'ARmax10': 0.41676456,
     'ARmax100': 0.461309,
     'ARs': 0.26430297,
     'global': {'total_loss': 28.278934},
     'validation_loss': 28.278934}

                                                                 input_4[0][0]                    
__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'3': (None, 64, 64, 23537152    yolo_fpn[0][0]                   
                                                                 yolo_fpn[0][1]                   
                                                                 yolo_fpn[0][2]                   
==================================================================================================
Total params: 38,702,592
Trainable params: 38,668,032
Non-trainable params: 34,560
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 38702592  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 65,872,064
Trainable params: 65,802,176
Non-trainable params: 69,888
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 200, 8), 4: (8, 200, 8), 5: (8, 200, 8)}, inds: {3: (8, 200, 3), 4: (8, 200, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
train | step:  10000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.55229557,
           'avg_obj': 0.11892047,
           'box_loss': 5.7482486,
           'class_loss': 14.592727,
           'conf_loss': 37.211327,
           'precision50': 0.15101707,
           'recall50': 0.04489131},
     '4': {'avg_iou': 0.6400133,
           'avg_obj': 0.20623271,
           'box_loss': 4.4375296,
           'class_loss': 13.739835,
           'conf_loss': 17.59741,
           'precision50': 0.29198125,
           'recall50': 0.14050552},
     '5': {'avg_iou': 0.68087435,
           'avg_obj': 0.28948742,
           'box_loss': 2.0651681,
           'class_loss': 7.420835,
           'conf_loss': 7.622757,
           'precision50': 0.3796226,
           'recall50': 0.25329942},
     'global': {'total_loss': 110.43603},
     'learning_rate': 0.00131,
     'training_loss': 110.43603}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-10000.
train | step:  20000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.61610144,
           'avg_obj': 0.17622642,
           'box_loss': 4.938199,
           'class_loss': 5.818104,
           'conf_loss': 10.1217575,
           'precision50': 0.24359456,
           'recall50': 0.08881363},
     '4': {'avg_iou': 0.7199329,
           'avg_obj': 0.30133554,
           'box_loss': 3.4531062,
           'class_loss': 4.842202,
           'conf_loss': 8.499164,
           'precision50': 0.3890368,
           'recall50': 0.24581401},
     '5': {'avg_iou': 0.75679,
           'avg_obj': 0.40615222,
           'box_loss': 1.5761272,
           'class_loss': 2.5384483,
           'conf_loss': 3.829184,
           'precision50': 0.4840062,
           'recall50': 0.39651644},
     'global': {'total_loss': 45.61625},
     'learning_rate': 0.00131,
     'training_loss': 45.61625}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-20000.
 eval | step:  20000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=177.39s).
Accumulating evaluation results...
DONE (t=19.80s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.262
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.454
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.270
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.098
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.273
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.362
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.244
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.417
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.461
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.264
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.494
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.575
 eval | step:  20000 | eval time:  569.6 sec | output: 
    {'3': {'avg_iou': 0.48426786,
           'avg_obj': 0.1668442,
           'box_loss': 2.8258407,
           'class_loss': 2.5876937,
           'conf_loss': 6.953411,
           'precision50': 0.2348702,
           'recall50': 0.13702686},
     '4': {'avg_iou': 0.6872511,
           'avg_obj': 0.3618258,
           'box_loss': 2.3018155,
           'class_loss': 2.3122957,
           'conf_loss': 5.8917885,
           'precision50': 0.38993758,
           'recall50': 0.35168868},
     '5': {'avg_iou': 0.748444,
           'avg_obj': 0.51215893,
           'box_loss': 1.2362226,
           'class_loss': 1.3181479,
           'conf_loss': 2.851725,
           'precision50': 0.49242848,
           'recall50': 0.52460104},
     'AP': 0.26233637,
     'AP50': 0.45449945,
     'AP75': 0.26991725,
     'APl': 0.36191463,
     'APm': 0.272546,
     'APs': 0.09807064,
     'ARl': 0.5751352,
     'ARm': 0.49362034,
     'ARmax1': 0.24401008,
     'ARmax10': 0.41676456,
     'ARmax100': 0.461309,
     'ARs': 0.26430297,
     'global': {'total_loss': 28.278934},
     'validation_loss': 28.278934}I0503 08:37:10.044054 140283933239104 controller.py:211] train | step:  20000 | training until step 40000...
I0503 09:47:33.822088 140283933239104 controller.py:425] train | step:  30000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.63249445,
           'avg_obj': 0.20215155,
           'box_loss': 4.7394204,
           'class_loss': 5.199381,
           'conf_loss': 9.816748,
           'precision50': 0.2684902,
           'recall50': 0.11227972},
     '4': {'avg_iou': 0.74050164,
           'avg_obj': 0.34058475,
           'box_loss': 3.1947181,
           'class_loss': 4.1951303,
           'conf_loss': 8.004004,
           'precision50': 0.4035361,
           'recall50': 0.28992233},
     '5': {'avg_iou': 0.77736497,
           'avg_obj': 0.45171997,
           'box_loss': 1.4396806,
           'class_loss': 2.1861765,
           'conf_loss': 3.528028,
           'precision50': 0.4968388,
           'recall50': 0.447829},
     'global': {'total_loss': 42.30339},
     'learning_rate': 0.00131,
     'training_loss': 42.30339}
I0503 09:48:25.217507 140283933239104 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-30000.
I0503 10:48:25.356138 140283933239104 controller.py:425] train | step:  40000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.64259005,
           'avg_obj': 0.21859822,
           'box_loss': 4.60947,
           'class_loss': 4.8279557,
           'conf_loss': 9.601225,
           'precision50': 0.28218946,
           'recall50': 0.12818143},
     '4': {'avg_iou': 0.75243664,
           'avg_obj': 0.36487773,
           'box_loss': 3.050617,
           'class_loss': 3.8188558,
           'conf_loss': 7.7137647,
           'precision50': 0.4114965,
           'recall50': 0.3171397},
     '5': {'avg_iou': 0.7886726,
           'avg_obj': 0.47762284,
           'box_loss': 1.3684314,
           'class_loss': 1.986132,
           'conf_loss': 3.3677769,
           'precision50': 0.50088024,
           'recall50': 0.47697842},
     'global': {'total_loss': 40.344276},
     'learning_rate': 0.00131,
     'training_loss': 40.344276}
I0503 10:49:15.625648 140283933239104 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-40000.
I0503 10:49:15.631537 140283933239104 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0503 10:53:34.164150 140283933239104 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0503 10:58:20.869199 140283933239104 controller.py:261]  eval | step:  40000 | eval time:  545.2 sec | output: 
    {'3': {'avg_iou': 0.49509364,
           'avg_obj': 0.19394214,
           'box_loss': 2.6810024,
           'class_loss': 2.1616173,
           'conf_loss': 6.640414,
           'precision50': 0.25369176,
           'recall50': 0.17120361},
     '4': {'avg_iou': 0.70321155,
           'avg_obj': 0.4086801,
           'box_loss': 2.1248477,
           'class_loss': 1.8952254,
           'conf_loss': 5.4773545,
           'precision50': 0.40041068,
           'recall50': 0.40628296},
     '5': {'avg_iou': 0.76768357,
           'avg_obj': 0.5648995,
           'box_loss': 1.120069,
           'class_loss': 1.0684093,
           'conf_loss': 2.6042147,
           'precision50': 0.48602432,
           'recall50': 0.5811055},
     'AP': 0.31505764,
     'AP50': 0.51961315,
     'AP75': 0.33338493,
     'APl': 0.43560266,
     'APm': 0.3293677,
     'APs': 0.12382079,
     'ARl': 0.62040186,
     'ARm': 0.5368081,
     'ARmax1': 0.27289826,
     'ARmax10': 0.45599174,
     'ARmax100': 0.50107425,
     'ARs': 0.29923835,
     'global': {'total_loss': 25.773142},
     'validation_loss': 25.773142}
I0503 10:58:40.967133 140283933239104 controller.py:211] train | step:  40000 | training until step 60000...
I0503 12:01:45.996655 140283933239104 controller.py:425] train | step:  50000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6495256,
           'avg_obj': 0.23091087,
           'box_loss': 4.532647,
           'class_loss': 4.5914345,
           'conf_loss': 9.469877,
           'precision50': 0.28926757,
           'recall50': 0.13880588},
     '4': {'avg_iou': 0.76088727,
           'avg_obj': 0.3827743,
           'box_loss': 2.952108,
           'class_loss': 3.56867,
           'conf_loss': 7.507568,
           'precision50': 0.41561002,
           'recall50': 0.3361692},
     '5': {'avg_iou': 0.7966583,
           'avg_obj': 0.49741578,
           'box_loss': 1.3184611,
           'class_loss': 1.85321,
           'conf_loss': 3.2450452,
           'precision50': 0.5039771,
           'recall50': 0.49820858},
     'global': {'total_loss': 39.039036},
     'learning_rate': 0.00131,
     'training_loss': 39.039036}
I0503 12:02:36.072521 140283933239104 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-50000.
I0503 13:08:58.694876 140283933239104 controller.py:425] train | step:  60000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.65467304,
           'avg_obj': 0.2409793,
           'box_loss': 4.4671445,
           'class_loss': 4.3998613,
           'conf_loss': 9.344951,
           'precision50': 0.29589295,
           'recall50': 0.14807206},
     '4': {'avg_iou': 0.76678586,
           'avg_obj': 0.39696795,
           'box_loss': 2.8752267,
           'class_loss': 3.3777199,
           'conf_loss': 7.3298836,
           'precision50': 0.41861948,
           'recall50': 0.35113978},
     '5': {'avg_iou': 0.80273795,
           'avg_obj': 0.51234543,
           'box_loss': 1.2746333,
           'class_loss': 1.7463712,
           'conf_loss': 3.1406558,
           'precision50': 0.50664234,
           'recall50': 0.51411813},
     'global': {'total_loss': 37.95647},
     'learning_rate': 0.00131,
     'training_loss': 37.95647}
I0503 13:09:50.207715 140283933239104 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-60000.
I0503 13:09:50.213175 140283933239104 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0503 13:14:06.782807 140283933239104 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0503 13:18:27.704703 140283933239104 controller.py:261]  eval | step:  60000 | eval time:  517.5 sec | output: 
    {'3': {'avg_iou': 0.50114805,
           'avg_obj': 0.20969053,
           'box_loss': 2.607083,
           'class_loss': 1.9729035,
           'conf_loss': 6.4878087,
           'precision50': 0.26284426,
           'recall50': 0.1890415},
     '4': {'avg_iou': 0.7121532,
           'avg_obj': 0.43555316,
           'box_loss': 2.0287082,
           'class_loss': 1.6936346,
           'conf_loss': 5.2596784,
           'precision50': 0.40329245,
           'recall50': 0.43512008},
     '5': {'avg_iou': 0.7778977,
           'avg_obj': 0.5928333,
           'box_loss': 1.0608433,
           'class_loss': 0.964426,
           'conf_loss': 2.4640424,
           'precision50': 0.48322773,
           'recall50': 0.60801667},
     'AP': 0.33934256,
     'AP50': 0.5501934,
     'AP75': 0.36233273,
     'APl': 0.4664802,
     'APm': 0.35604602,
     'APs': 0.14438446,
     'ARl': 0.6385103,
     'ARm': 0.5609381,
     'ARmax1': 0.28617802,
     'ARmax10': 0.474647,
     'ARmax100': 0.51968193,
     'ARs': 0.31661275,
     'global': {'total_loss': 24.539118},
     'validation_loss': 24.539118}

train | step:  20000 | training until step 40000...
train | step:  30000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.63249445,
           'avg_obj': 0.20215155,
           'box_loss': 4.7394204,
           'class_loss': 5.199381,
           'conf_loss': 9.816748,
           'precision50': 0.2684902,
           'recall50': 0.11227972},
     '4': {'avg_iou': 0.74050164,
           'avg_obj': 0.34058475,
           'box_loss': 3.1947181,
           'class_loss': 4.1951303,
           'conf_loss': 8.004004,
           'precision50': 0.4035361,
           'recall50': 0.28992233},
     '5': {'avg_iou': 0.77736497,
           'avg_obj': 0.45171997,
           'box_loss': 1.4396806,
           'class_loss': 2.1861765,
           'conf_loss': 3.528028,
           'precision50': 0.4968388,
           'recall50': 0.447829},
     'global': {'total_loss': 42.30339},
     'learning_rate': 0.00131,
     'training_loss': 42.30339}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-30000.
train | step:  40000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.64259005,
           'avg_obj': 0.21859822,
           'box_loss': 4.60947,
           'class_loss': 4.8279557,
           'conf_loss': 9.601225,
           'precision50': 0.28218946,
           'recall50': 0.12818143},
     '4': {'avg_iou': 0.75243664,
           'avg_obj': 0.36487773,
           'box_loss': 3.050617,
           'class_loss': 3.8188558,
           'conf_loss': 7.7137647,
           'precision50': 0.4114965,
           'recall50': 0.3171397},
     '5': {'avg_iou': 0.7886726,
           'avg_obj': 0.47762284,
           'box_loss': 1.3684314,
           'class_loss': 1.986132,
           'conf_loss': 3.3677769,
           'precision50': 0.50088024,
           'recall50': 0.47697842},
     'global': {'total_loss': 40.344276},
     'learning_rate': 0.00131,
     'training_loss': 40.344276}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-40000.
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=197.51s).
Accumulating evaluation results...
DONE (t=21.02s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.315
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.520
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.333
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.124
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.329
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.436
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.273
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.456
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.501
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.299
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.537
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.620
 eval | step:  40000 | eval time:  545.2 sec | output: 
    {'3': {'avg_iou': 0.49509364,
           'avg_obj': 0.19394214,
           'box_loss': 2.6810024,
           'class_loss': 2.1616173,
           'conf_loss': 6.640414,
           'precision50': 0.25369176,
           'recall50': 0.17120361},
     '4': {'avg_iou': 0.70321155,
           'avg_obj': 0.4086801,
           'box_loss': 2.1248477,
           'class_loss': 1.8952254,
           'conf_loss': 5.4773545,
           'precision50': 0.40041068,
           'recall50': 0.40628296},
     '5': {'avg_iou': 0.76768357,
           'avg_obj': 0.5648995,
           'box_loss': 1.120069,
           'class_loss': 1.0684093,
           'conf_loss': 2.6042147,
           'precision50': 0.48602432,
           'recall50': 0.5811055},
     'AP': 0.31505764,
     'AP50': 0.51961315,
     'AP75': 0.33338493,
     'APl': 0.43560266,
     'APm': 0.3293677,
     'APs': 0.12382079,
     'ARl': 0.62040186,
     'ARm': 0.5368081,
     'ARmax1': 0.27289826,
     'ARmax10': 0.45599174,
     'ARmax100': 0.50107425,
     'ARs': 0.29923835,
     'global': {'total_loss': 25.773142},
     'validation_loss': 25.773142}
train | step:  40000 | training until step 60000...
train | step:  50000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6495256,
           'avg_obj': 0.23091087,
           'box_loss': 4.532647,
           'class_loss': 4.5914345,
           'conf_loss': 9.469877,
           'precision50': 0.28926757,
           'recall50': 0.13880588},
     '4': {'avg_iou': 0.76088727,
           'avg_obj': 0.3827743,
           'box_loss': 2.952108,
           'class_loss': 3.56867,
           'conf_loss': 7.507568,
           'precision50': 0.41561002,
           'recall50': 0.3361692},
     '5': {'avg_iou': 0.7966583,
           'avg_obj': 0.49741578,
           'box_loss': 1.3184611,
           'class_loss': 1.85321,
           'conf_loss': 3.2450452,
           'precision50': 0.5039771,
           'recall50': 0.49820858},
     'global': {'total_loss': 39.039036},
     'learning_rate': 0.00131,
     'training_loss': 39.039036}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-50000.
train | step:  60000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.65467304,
           'avg_obj': 0.2409793,
           'box_loss': 4.4671445,
           'class_loss': 4.3998613,
           'conf_loss': 9.344951,
           'precision50': 0.29589295,
           'recall50': 0.14807206},
     '4': {'avg_iou': 0.76678586,
           'avg_obj': 0.39696795,
           'box_loss': 2.8752267,
           'class_loss': 3.3777199,
           'conf_loss': 7.3298836,
           'precision50': 0.41861948,
           'recall50': 0.35113978},
     '5': {'avg_iou': 0.80273795,
           'avg_obj': 0.51234543,
           'box_loss': 1.2746333,
           'class_loss': 1.7463712,
           'conf_loss': 3.1406558,
           'precision50': 0.50664234,
           'recall50': 0.51411813},
     'global': {'total_loss': 37.95647},
     'learning_rate': 0.00131,
     'training_loss': 37.95647}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-60000.
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=183.65s).
Accumulating evaluation results...
DONE (t=16.03s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.339
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.550
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.362
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.144
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.356
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.466
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.286
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.475
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.520
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.317
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.561
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.639
 eval | step:  60000 | eval time:  517.5 sec | output: 
    {'3': {'avg_iou': 0.50114805,
           'avg_obj': 0.20969053,
           'box_loss': 2.607083,
           'class_loss': 1.9729035,
           'conf_loss': 6.4878087,
           'precision50': 0.26284426,
           'recall50': 0.1890415},
     '4': {'avg_iou': 0.7121532,
           'avg_obj': 0.43555316,
           'box_loss': 2.0287082,
           'class_loss': 1.6936346,
           'conf_loss': 5.2596784,
           'precision50': 0.40329245,
           'recall50': 0.43512008},
     '5': {'avg_iou': 0.7778977,
           'avg_obj': 0.5928333,
           'box_loss': 1.0608433,
           'class_loss': 0.964426,
           'conf_loss': 2.4640424,
           'precision50': 0.48322773,
           'recall50': 0.60801667},
     'AP': 0.33934256,
     'AP50': 0.5501934,
     'AP75': 0.36233273,
     'APl': 0.4664802,
     'APm': 0.35604602,
     'APs': 0.14438446,
     'ARl': 0.6385103,
     'ARm': 0.5609381,
     'ARmax1': 0.28617802,
     'ARmax10': 0.474647,
     'ARmax100': 0.51968193,
     'ARs': 0.31661275,
     'global': {'total_loss': 24.539118},
     'validation_loss': 24.539118}I0503 13:18:44.983713 140283933239104 controller.py:211] train | step:  60000 | training until step 80000...
I0503 14:24:00.462005 140283933239104 controller.py:425] train | step:  70000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.658882,
           'avg_obj': 0.24829839,
           'box_loss': 4.404695,
           'class_loss': 4.233186,
           'conf_loss': 9.2358465,
           'precision50': 0.2998064,
           'recall50': 0.15498254},
     '4': {'avg_iou': 0.7715949,
           'avg_obj': 0.40746367,
           'box_loss': 2.816687,
           'class_loss': 3.2289732,
           'conf_loss': 7.2033553,
           'precision50': 0.42049032,
           'recall50': 0.36185592},
     '5': {'avg_iou': 0.807499,
           'avg_obj': 0.5239413,
           'box_loss': 1.2468778,
           'class_loss': 1.673383,
           'conf_loss': 3.0741522,
           'precision50': 0.50714064,
           'recall50': 0.52544415},
     'global': {'total_loss': 37.117115},
     'learning_rate': 0.00131,
     'training_loss': 37.117115}
I0503 14:24:51.379736 140283933239104 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-70000.
cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is READY
europe-west4-a
I0503 14:40:44.292060 139967860012864 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': True},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.3,
                                    'aug_scale_max': 2.0,
                                    'aug_scale_min': 0.1,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.3,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.213,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [240000,
                                                                                260000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00131,
                                                                            0.000655,
                                                                            0.000325]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0503 14:40:44.292990 139967860012864 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4/tpu/512-sam/params.yaml
I0503 14:40:45.169021 139967860012864 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0503 14:40:45.314989 139967860012864 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0503 14:40:45.315263 139967860012864 transport.py:157] Attempting refresh to obtain initial access_token
I0503 14:40:45.393419 139967860012864 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0503 14:40:46.019624 139967860012864 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0503 14:40:46.019902 139967860012864 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-03 14:40:46.065829: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0503 14:40:46.066436 139967860012864 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0503 14:40:46.685117 139967860012864 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0503 14:40:46.685351 139967860012864 transport.py:157] Attempting refresh to obtain initial access_token
I0503 14:40:46.765999 139967860012864 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0503 14:40:47.384338 139967860012864 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0503 14:40:47.384578 139967860012864 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-03 14:40:47.433287: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-03 14:40:47.457188: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.124.160.50:8470}
2021-05-03 14:40:47.457258: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:37569}
2021-05-03 14:40:47.479997: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.124.160.50:8470}
2021-05-03 14:40:47.480067: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:37569}
2021-05-03 14:40:47.480845: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:37569
I0503 14:40:47.481390 139967860012864 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-7
I0503 14:40:47.481865 139967860012864 tpu_strategy_util.py:74] Initializing the TPU system: node-7
/home/cam2tensorflow/.experiment_start.sh: line 22:  7569 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   204    0     2  100   202     12   1246 --:--:-- --:--:-- --:--:--  1259
okRequest issued for: [node-7]
2021-05-03 14:41:12.522203: W tensorflow/core/distributed_runtime/eager/remote_tensor_handle_data.cc:76] Unable to destroy remote tensor handles. If you are running a tf.function, it usually indicates some op in the graph gets an error: Socket closed
Additional GRPC error information from remote target /job:worker/replica:0/task:0:
:{"created":"@1620052872.518274918","description":"Error received from peer ipv4:10.124.160.50:8470","file":"external/com_github_grpc_grpc/src/core/lib/surface/call.cc","file_line":1056,"grpc_message":"Socket closed","grpc_status":14}
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-03T14:44:47.243329806Z'
  endTime: '2021-05-03T14:45:24.683643836Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620053087226-5c16e00c80bc7-e8c6be5c-59f3bc21
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.124.160.48/29
  createTime: '2021-03-18T03:10:27.166064884Z'
  health: HEALTHY
  ipAddress: 10.124.160.50
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.124.160.50
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620053087226-5c16e00c80bc7-e8c6be5c-59f3bc21] to complete...
...................................................................................................................................................................................................done.
/home/cam2tensorflow/.experiment_start.sh: line 22: 32394 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   204    0     2  100   202     12   1239 --:--:-- --:--:-- --:--:--  1251
okRequest issued for: [node-7]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-03T15:11:43.243475603Z'
  endTime: '2021-05-03T15:11:54.369289158Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620054703230-5c16e611a4fc6-d004ffc3-dbda943b
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.124.160.48/29
  createTime: '2021-03-18T03:10:27.166064884Z'
  health: HEALTHY
  ipAddress: 10.124.160.50
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.124.160.50
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620054703230-5c16e611a4fc6-d004ffc3-dbda943b] to complete...
............................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-2]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-03T15:22:35.304160732Z'
  endTime: '2021-05-03T15:23:10.344239749Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620055355290-5c16e87f7f49a-3046d152-0b180fcf
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.73.142.64/29
  createTime: '2021-03-13T00:10:24.868252445Z'
  health: HEALTHY
  ipAddress: 10.73.142.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.73.142.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-25T19:28:21.704126002Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T19:28:19Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-03-28T21:10:24.483577115Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:10:19Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T02:18:59.164603377Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T02:18:30.044758+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-30T05:32:54.575339610Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-30T05:32:31.628489+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620055355290-5c16e87f7f49a-3046d152-0b180fcf] to complete...
..............................................................................................................................................................................................done.
europe-west4-a
I0503 15:19:27.999304 140519251994432 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': True},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.3,
                                    'aug_scale_max': 2.0,
                                    'aug_scale_min': 0.1,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.3,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.213,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [240000,
                                                                                260000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00131,
                                                                            0.000655,
                                                                            0.000325]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0503 15:19:28.000503 140519251994432 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4/tpu/512-sam/params.yaml
I0503 15:19:28.927318 140519251994432 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0503 15:19:29.542850 140519251994432 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2?alt=json
I0503 15:19:29.543144 140519251994432 transport.py:157] Attempting refresh to obtain initial access_token
I0503 15:19:29.605165 140519251994432 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0503 15:19:29.754846 140519251994432 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2?alt=json
I0503 15:19:29.755310 140519251994432 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-03 15:19:29.798588: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0503 15:19:29.799603 140519251994432 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0503 15:19:30.419621 140519251994432 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2?alt=json
I0503 15:19:30.420152 140519251994432 transport.py:157] Attempting refresh to obtain initial access_token
I0503 15:19:30.473476 140519251994432 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0503 15:19:31.098800 140519251994432 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2?alt=json
I0503 15:19:31.099081 140519251994432 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-03 15:19:31.155173: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-03 15:19:31.175428: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.73.142.66:8470}
2021-05-03 15:19:31.175527: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:38491}
2021-05-03 15:20:08.949577: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.73.142.66:8470}
2021-05-03 15:20:08.949664: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:38491}
2021-05-03 15:20:08.950159: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:38491
I0503 15:20:08.951335 140519251994432 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-2
I0503 15:20:08.952077 140519251994432 tpu_strategy_util.py:74] Initializing the TPU system: node-2
INFO:tensorflow:Clearing out eager caches
I0503 15:20:17.146763 140519251994432 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0503 15:20:17.148668 140519251994432 tpu_strategy_util.py:133] Finished initializing TPU system.
I0503 15:20:17.149849 140519251994432 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0503 15:20:17.294542 140519251994432 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2?alt=json
I0503 15:20:17.294770 140519251994432 transport.py:157] Attempting refresh to obtain initial access_token
I0503 15:20:17.349864 140519251994432 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0503 15:20:17.979437 140519251994432 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2?alt=json
I0503 15:20:17.979653 140519251994432 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0503 15:20:18.022107 140519251994432 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0503 15:20:18.022317 140519251994432 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0503 15:20:18.022550 140519251994432 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0503 15:20:18.022599 140519251994432 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0503 15:20:18.022643 140519251994432 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0503 15:20:18.022766 140519251994432 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0503 15:20:18.022824 140519251994432 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0503 15:20:18.022867 140519251994432 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0503 15:20:18.022909 140519251994432 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0503 15:20:18.022950 140519251994432 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0503 15:20:18.022991 140519251994432 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0503 15:20:18.023046 140519251994432 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0503 15:20:18.023088 140519251994432 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0503 15:20:18.023138 140519251994432 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0503 15:20:18.023185 140519251994432 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0503 15:20:18.023227 140519251994432 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0503 15:20:18.024485 140519251994432 train_utils.py:214] Running default trainer.
2021-05-03 15:20:18.045585: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': True, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'aug_scale_aspect': 0.3, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [240000, 260000], 'values': [0.00131, 0.000655, 0.000325]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05} 0.00025
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': True, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7fccc840db38>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________
yolo_fpn (YoloFPN)              {'5': (None, 16, 16, 15165440    input_2[0][0]                    
                                                                 input_3[0][0]                    I0503 15:21:05.399420 140519251994432 controller.py:362] restoring or initializing model...
I0503 15:21:21.590984 140519251994432 controller.py:366] restored model from gs://tensorflow2/yolov4/tpu/512-sam/ckpt-70000.
I0503 15:21:21.591214 140519251994432 controller.py:192] restored from checkpoint: gs://tensorflow2/yolov4/tpu/512-sam/ckpt-70000
I0503 15:21:21.591297 140519251994432 train_lib.py:96] Starts to execute mode: train_and_eval
I0503 15:21:21.595450 140519251994432 controller.py:211] train | step:  70000 | training until step 90000...
I0503 15:21:27.492851 140519251994432 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0503 15:22:35.213201 140519251994432 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0503 16:29:07.827187 140519251994432 controller.py:425] train | step:  80000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6623438,
           'avg_obj': 0.25542173,
           'box_loss': 4.357974,
           'class_loss': 4.1165304,
           'conf_loss': 9.14251,
           'precision50': 0.30339476,
           'recall50': 0.1613829},
     '4': {'avg_iou': 0.77592725,
           'avg_obj': 0.41699463,
           'box_loss': 2.760976,
           'class_loss': 3.103327,
           'conf_loss': 7.080493,
           'precision50': 0.42132008,
           'recall50': 0.37265715},
     '5': {'avg_iou': 0.81139123,
           'avg_obj': 0.53430665,
           'box_loss': 1.2203159,
           'class_loss': 1.6012025,
           'conf_loss': 3.0035255,
           'precision50': 0.5078007,
           'recall50': 0.53696907},
     'global': {'total_loss': 36.386852},
     'learning_rate': 0.00131,
     'training_loss': 36.386852}
I0503 16:30:03.410843 140519251994432 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-80000.
I0503 17:36:48.365387 140519251994432 controller.py:425] train | step:  90000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6649562,
           'avg_obj': 0.26103774,
           'box_loss': 4.320659,
           'class_loss': 3.9931324,
           'conf_loss': 9.065176,
           'precision50': 0.30605018,
           'recall50': 0.16637294},
     '4': {'avg_iou': 0.77919537,
           'avg_obj': 0.42493075,
           'box_loss': 2.7221675,
           'class_loss': 2.9937196,
           'conf_loss': 6.9866,
           'precision50': 0.423309,
           'recall50': 0.38097888},
     '5': {'avg_iou': 0.8147594,
           'avg_obj': 0.54254496,
           'box_loss': 1.1989291,
           'class_loss': 1.5464941,
           'conf_loss': 2.9524553,
           'precision50': 0.508038,
           'recall50': 0.54477394},
     'global': {'total_loss': 35.779346},
     'learning_rate': 0.00131,
     'training_loss': 35.779346}
I0503 17:37:38.746750 140519251994432 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-90000.
I0503 17:37:38.753739 140519251994432 controller.py:252]  eval | step:  90000 | running 625 steps of evaluation...
I0503 17:37:41.425739 140519251994432 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0503 17:37:58.686373 140519251994432 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0503 17:42:52.235121 140519251994432 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0503 17:47:01.072947 140519251994432 controller.py:261]  eval | step:  90000 | eval time:  562.3 sec | output: 
    {'3': {'avg_iou': 0.479806,
           'avg_obj': 0.19356841,
           'box_loss': 2.2752292,
           'class_loss': 1.5954965,
           'conf_loss': 5.9416966,
           'precision50': 0.24265976,
           'recall50': 0.1764061},
     '4': {'avg_iou': 0.69242847,
           'avg_obj': 0.4032243,
           'box_loss': 2.057254,
           'class_loss': 1.5994062,
           'conf_loss': 5.5718694,
           'precision50': 0.37506285,
           'recall50': 0.40159947},
     '5': {'avg_iou': 0.79472303,
           'avg_obj': 0.5878094,
           'box_loss': 1.1678486,
           'class_loss': 0.9869527,
           'conf_loss': 2.877369,
           'precision50': 0.45863676,
           'recall50': 0.5997508},
     'AP': 0.36923355,
     'AP50': 0.58469856,
     'AP75': 0.39661777,
     'APl': 0.4872707,
     'APm': 0.36623052,
     'APs': 0.15990917,
     'ARl': 0.6614039,
     'ARm': 0.56853807,
     'ARmax1': 0.30501112,
     'ARmax10': 0.5082156,
     'ARmax100': 0.5550903,
     'ARs': 0.3537424,
     'global': {'total_loss': 24.073124},
     'validation_loss': 24.073124}

                                                                 input_4[0][0]                    
__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'3': (None, 64, 64, 23537152    yolo_fpn[0][0]                   
                                                                 yolo_fpn[0][1]                   
                                                                 yolo_fpn[0][2]                   
==================================================================================================
Total params: 38,702,592
Trainable params: 38,668,032
Non-trainable params: 34,560
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 38702592  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 65,872,064
Trainable params: 65,802,176
Non-trainable params: 69,888
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 200, 8), 4: (8, 200, 8), 5: (8, 200, 8)}, inds: {3: (8, 200, 3), 4: (8, 200, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
restored model from gs://tensorflow2/yolov4/tpu/512-sam/ckpt-70000.
restored from checkpoint: gs://tensorflow2/yolov4/tpu/512-sam/ckpt-70000
train | step:  70000 | training until step 90000...
train | step:  80000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6623438,
           'avg_obj': 0.25542173,
           'box_loss': 4.357974,
           'class_loss': 4.1165304,
           'conf_loss': 9.14251,
           'precision50': 0.30339476,
           'recall50': 0.1613829},
     '4': {'avg_iou': 0.77592725,
           'avg_obj': 0.41699463,
           'box_loss': 2.760976,
           'class_loss': 3.103327,
           'conf_loss': 7.080493,
           'precision50': 0.42132008,
           'recall50': 0.37265715},
     '5': {'avg_iou': 0.81139123,
           'avg_obj': 0.53430665,
           'box_loss': 1.2203159,
           'class_loss': 1.6012025,
           'conf_loss': 3.0035255,
           'precision50': 0.5078007,
           'recall50': 0.53696907},
     'global': {'total_loss': 36.386852},
     'learning_rate': 0.00131,
     'training_loss': 36.386852}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-80000.
train | step:  90000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6649562,
           'avg_obj': 0.26103774,
           'box_loss': 4.320659,
           'class_loss': 3.9931324,
           'conf_loss': 9.065176,
           'precision50': 0.30605018,
           'recall50': 0.16637294},
     '4': {'avg_iou': 0.77919537,
           'avg_obj': 0.42493075,
           'box_loss': 2.7221675,
           'class_loss': 2.9937196,
           'conf_loss': 6.9866,
           'precision50': 0.423309,
           'recall50': 0.38097888},
     '5': {'avg_iou': 0.8147594,
           'avg_obj': 0.54254496,
           'box_loss': 1.1989291,
           'class_loss': 1.5464941,
           'conf_loss': 2.9524553,
           'precision50': 0.508038,
           'recall50': 0.54477394},
     'global': {'total_loss': 35.779346},
     'learning_rate': 0.00131,
     'training_loss': 35.779346}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-90000.
 eval | step:  90000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.78s).
Accumulating evaluation results...
DONE (t=15.19s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.369
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.585
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.397
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.160
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.366
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.487
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.305
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.508
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.555
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.354
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.569
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.661
 eval | step:  90000 | eval time:  562.3 sec | output: 
    {'3': {'avg_iou': 0.479806,
           'avg_obj': 0.19356841,
           'box_loss': 2.2752292,
           'class_loss': 1.5954965,
           'conf_loss': 5.9416966,
           'precision50': 0.24265976,
           'recall50': 0.1764061},
     '4': {'avg_iou': 0.69242847,
           'avg_obj': 0.4032243,
           'box_loss': 2.057254,
           'class_loss': 1.5994062,
           'conf_loss': 5.5718694,
           'precision50': 0.37506285,
           'recall50': 0.40159947},
     '5': {'avg_iou': 0.79472303,
           'avg_obj': 0.5878094,
           'box_loss': 1.1678486,
           'class_loss': 0.9869527,
           'conf_loss': 2.877369,
           'precision50': 0.45863676,
           'recall50': 0.5997508},
     'AP': 0.36923355,
     'AP50': 0.58469856,
     'AP75': 0.39661777,
     'APl': 0.4872707,
     'APm': 0.36623052,
     'APs': 0.15990917,
     'ARl': 0.6614039,
     'ARm': 0.56853807,
     'ARmax1': 0.30501112,
     'ARmax10': 0.5082156,
     'ARmax100': 0.5550903,
     'ARs': 0.3537424,
     'global': {'total_loss': 24.073124},
     'validation_loss': 24.073124}I0503 17:47:27.636544 140519251994432 controller.py:211] train | step:  90000 | training until step 110000...
I0503 18:54:20.160526 140519251994432 controller.py:425] train | step:  100000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.66756,
           'avg_obj': 0.26656947,
           'box_loss': 4.298813,
           'class_loss': 3.9154944,
           'conf_loss': 9.0164795,
           'precision50': 0.3082759,
           'recall50': 0.17084661},
     '4': {'avg_iou': 0.78216976,
           'avg_obj': 0.4321767,
           'box_loss': 2.685368,
           'class_loss': 2.907037,
           'conf_loss': 6.9003267,
           'precision50': 0.42409676,
           'recall50': 0.3879348},
     '5': {'avg_iou': 0.81751174,
           'avg_obj': 0.54964197,
           'box_loss': 1.1812718,
           'class_loss': 1.4970198,
           'conf_loss': 2.9078782,
           'precision50': 0.5086832,
           'recall50': 0.5528439},
     'global': {'total_loss': 35.30969},
     'learning_rate': 0.00131,
     'training_loss': 35.30969}
I0503 18:55:11.535137 140519251994432 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-100000.
I0503 19:59:57.705304 140519251994432 controller.py:425] train | step:  110000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.669905,
           'avg_obj': 0.27153075,
           'box_loss': 4.274237,
           'class_loss': 3.8324769,
           'conf_loss': 8.968703,
           'precision50': 0.31117955,
           'recall50': 0.1754553},
     '4': {'avg_iou': 0.7848411,
           'avg_obj': 0.4386085,
           'box_loss': 2.657479,
           'class_loss': 2.8409986,
           'conf_loss': 6.835158,
           'precision50': 0.42564,
           'recall50': 0.3952416},
     '5': {'avg_iou': 0.8201632,
           'avg_obj': 0.55722016,
           'box_loss': 1.1664032,
           'class_loss': 1.4570583,
           'conf_loss': 2.8639987,
           'precision50': 0.5094936,
           'recall50': 0.5601768},
     'global': {'total_loss': 34.89652},
     'learning_rate': 0.00131,
     'training_loss': 34.89652}
I0503 20:00:49.902467 140519251994432 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-110000.
I0503 20:00:49.909187 140519251994432 controller.py:252]  eval | step:  110000 | running 625 steps of evaluation...
I0503 20:05:06.464573 140519251994432 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0503 20:09:29.431480 140519251994432 controller.py:261]  eval | step:  110000 | eval time:  519.5 sec | output: 
    {'3': {'avg_iou': 0.48204342,
           'avg_obj': 0.19937354,
           'box_loss': 2.24419,
           'class_loss': 1.5467379,
           'conf_loss': 5.886874,
           'precision50': 0.24518664,
           'recall50': 0.18273632},
     '4': {'avg_iou': 0.69632167,
           'avg_obj': 0.4152429,
           'box_loss': 2.0176415,
           'class_loss': 1.5332173,
           'conf_loss': 5.488129,
           'precision50': 0.37606224,
           'recall50': 0.41445547},
     '5': {'avg_iou': 0.79819584,
           'avg_obj': 0.5975183,
           'box_loss': 1.1464355,
           'class_loss': 0.9340124,
           'conf_loss': 2.8253558,
           'precision50': 0.45600083,
           'recall50': 0.6098789},
     'AP': 0.38072824,
     'AP50': 0.59671956,
     'AP75': 0.41184363,
     'APl': 0.50085396,
     'APm': 0.38149324,
     'APs': 0.16558251,
     'ARl': 0.66913766,
     'ARm': 0.5807449,
     'ARmax1': 0.31170908,
     'ARmax10': 0.51688206,
     'ARmax100': 0.5640519,
     'ARs': 0.36016715,
     'global': {'total_loss': 23.622585},
     'validation_loss': 23.622585}
I0503 20:09:51.367927 140519251994432 controller.py:211] train | step:  110000 | training until step 130000...
I0503 21:09:44.606648 140519251994432 controller.py:425] train | step:  120000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6719084,
           'avg_obj': 0.2754936,
           'box_loss': 4.251254,
           'class_loss': 3.7668586,
           'conf_loss': 8.92095,
           'precision50': 0.3143919,
           'recall50': 0.18007894},
     '4': {'avg_iou': 0.78703684,
           'avg_obj': 0.44494057,
           'box_loss': 2.6306024,
           'class_loss': 2.7643929,
           'conf_loss': 6.7578936,
           'precision50': 0.4264481,
           'recall50': 0.4013515},
     '5': {'avg_iou': 0.82255334,
           'avg_obj': 0.563868,
           'box_loss': 1.1497474,
           'class_loss': 1.41639,
           'conf_loss': 2.8199139,
           'precision50': 0.5090002,
           'recall50': 0.565751},
     'global': {'total_loss': 34.477955},
     'learning_rate': 0.00131,
     'training_loss': 34.477955}
I0503 21:10:38.831980 140519251994432 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-120000.
I0503 22:15:28.821367 140519251994432 controller.py:425] train | step:  130000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6733673,
           'avg_obj': 0.27992803,
           'box_loss': 4.2342415,
           'class_loss': 3.6975305,
           'conf_loss': 8.873798,
           'precision50': 0.31600225,
           'recall50': 0.18368927},
     '4': {'avg_iou': 0.78903735,
           'avg_obj': 0.45061305,
           'box_loss': 2.6048217,
           'class_loss': 2.6974177,
           'conf_loss': 6.685986,
           'precision50': 0.42728555,
           'recall50': 0.407449},
     '5': {'avg_iou': 0.8244217,
           'avg_obj': 0.56923485,
           'box_loss': 1.1358354,
           'class_loss': 1.3830479,
           'conf_loss': 2.7818394,
           'precision50': 0.50924414,
           'recall50': 0.5722493},
     'global': {'total_loss': 34.09449},
     'learning_rate': 0.00131,
     'training_loss': 34.09449}
I0503 22:16:20.301540 140519251994432 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-130000.
I0503 22:16:20.308068 140519251994432 controller.py:252]  eval | step:  130000 | running 625 steps of evaluation...
I0503 22:20:34.230198 140519251994432 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0503 22:24:52.100471 140519251994432 controller.py:261]  eval | step:  130000 | eval time:  511.8 sec | output: 
    {'3': {'avg_iou': 0.4835024,
           'avg_obj': 0.20309733,
           'box_loss': 2.229148,
           'class_loss': 1.5102097,
           'conf_loss': 5.8578553,
           'precision50': 0.24821965,
           'recall50': 0.18701965},
     '4': {'avg_iou': 0.6987348,
           'avg_obj': 0.42224443,
           'box_loss': 1.9917822,
           'class_loss': 1.490773,
           'conf_loss': 5.4393015,
           'precision50': 0.37543705,
           'recall50': 0.42204955},
     '5': {'avg_iou': 0.80104405,
           'avg_obj': 0.6038827,
           'box_loss': 1.1232966,
           'class_loss': 0.90400547,
           'conf_loss': 2.789991,
           'precision50': 0.45287916,
           'recall50': 0.616108},
     'AP': 0.38806182,
     'AP50': 0.6045874,
     'AP75': 0.42153695,
     'APl': 0.5090532,
     'APm': 0.38963574,
     'APs': 0.17481364,
     'ARl': 0.6771119,
     'ARm': 0.58648866,
     'ARmax1': 0.31585672,
     'ARmax10': 0.5233225,
     'ARmax100': 0.56941926,
     'ARs': 0.3609312,
     'global': {'total_loss': 23.336353},
     'validation_loss': 23.336353}

train | step:  90000 | training until step 110000...
train | step:  100000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.66756,
           'avg_obj': 0.26656947,
           'box_loss': 4.298813,
           'class_loss': 3.9154944,
           'conf_loss': 9.0164795,
           'precision50': 0.3082759,
           'recall50': 0.17084661},
     '4': {'avg_iou': 0.78216976,
           'avg_obj': 0.4321767,
           'box_loss': 2.685368,
           'class_loss': 2.907037,
           'conf_loss': 6.9003267,
           'precision50': 0.42409676,
           'recall50': 0.3879348},
     '5': {'avg_iou': 0.81751174,
           'avg_obj': 0.54964197,
           'box_loss': 1.1812718,
           'class_loss': 1.4970198,
           'conf_loss': 2.9078782,
           'precision50': 0.5086832,
           'recall50': 0.5528439},
     'global': {'total_loss': 35.30969},
     'learning_rate': 0.00131,
     'training_loss': 35.30969}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-100000.
train | step:  110000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.669905,
           'avg_obj': 0.27153075,
           'box_loss': 4.274237,
           'class_loss': 3.8324769,
           'conf_loss': 8.968703,
           'precision50': 0.31117955,
           'recall50': 0.1754553},
     '4': {'avg_iou': 0.7848411,
           'avg_obj': 0.4386085,
           'box_loss': 2.657479,
           'class_loss': 2.8409986,
           'conf_loss': 6.835158,
           'precision50': 0.42564,
           'recall50': 0.3952416},
     '5': {'avg_iou': 0.8201632,
           'avg_obj': 0.55722016,
           'box_loss': 1.1664032,
           'class_loss': 1.4570583,
           'conf_loss': 2.8639987,
           'precision50': 0.5094936,
           'recall50': 0.5601768},
     'global': {'total_loss': 34.89652},
     'learning_rate': 0.00131,
     'training_loss': 34.89652}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-110000.
 eval | step:  110000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=191.57s).
Accumulating evaluation results...
DONE (t=16.91s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.381
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.597
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.412
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.166
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.381
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.501
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.312
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.517
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.564
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.360
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.581
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.669
 eval | step:  110000 | eval time:  519.5 sec | output: 
    {'3': {'avg_iou': 0.48204342,
           'avg_obj': 0.19937354,
           'box_loss': 2.24419,
           'class_loss': 1.5467379,
           'conf_loss': 5.886874,
           'precision50': 0.24518664,
           'recall50': 0.18273632},
     '4': {'avg_iou': 0.69632167,
           'avg_obj': 0.4152429,
           'box_loss': 2.0176415,
           'class_loss': 1.5332173,
           'conf_loss': 5.488129,
           'precision50': 0.37606224,
           'recall50': 0.41445547},
     '5': {'avg_iou': 0.79819584,
           'avg_obj': 0.5975183,
           'box_loss': 1.1464355,
           'class_loss': 0.9340124,
           'conf_loss': 2.8253558,
           'precision50': 0.45600083,
           'recall50': 0.6098789},
     'AP': 0.38072824,
     'AP50': 0.59671956,
     'AP75': 0.41184363,
     'APl': 0.50085396,
     'APm': 0.38149324,
     'APs': 0.16558251,
     'ARl': 0.66913766,
     'ARm': 0.5807449,
     'ARmax1': 0.31170908,
     'ARmax10': 0.51688206,
     'ARmax100': 0.5640519,
     'ARs': 0.36016715,
     'global': {'total_loss': 23.622585},
     'validation_loss': 23.622585}
train | step:  110000 | training until step 130000...
train | step:  120000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6719084,
           'avg_obj': 0.2754936,
           'box_loss': 4.251254,
           'class_loss': 3.7668586,
           'conf_loss': 8.92095,
           'precision50': 0.3143919,
           'recall50': 0.18007894},
     '4': {'avg_iou': 0.78703684,
           'avg_obj': 0.44494057,
           'box_loss': 2.6306024,
           'class_loss': 2.7643929,
           'conf_loss': 6.7578936,
           'precision50': 0.4264481,
           'recall50': 0.4013515},
     '5': {'avg_iou': 0.82255334,
           'avg_obj': 0.563868,
           'box_loss': 1.1497474,
           'class_loss': 1.41639,
           'conf_loss': 2.8199139,
           'precision50': 0.5090002,
           'recall50': 0.565751},
     'global': {'total_loss': 34.477955},
     'learning_rate': 0.00131,
     'training_loss': 34.477955}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-120000.
train | step:  130000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6733673,
           'avg_obj': 0.27992803,
           'box_loss': 4.2342415,
           'class_loss': 3.6975305,
           'conf_loss': 8.873798,
           'precision50': 0.31600225,
           'recall50': 0.18368927},
     '4': {'avg_iou': 0.78903735,
           'avg_obj': 0.45061305,
           'box_loss': 2.6048217,
           'class_loss': 2.6974177,
           'conf_loss': 6.685986,
           'precision50': 0.42728555,
           'recall50': 0.407449},
     '5': {'avg_iou': 0.8244217,
           'avg_obj': 0.56923485,
           'box_loss': 1.1358354,
           'class_loss': 1.3830479,
           'conf_loss': 2.7818394,
           'precision50': 0.50924414,
           'recall50': 0.5722493},
     'global': {'total_loss': 34.09449},
     'learning_rate': 0.00131,
     'training_loss': 34.09449}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-130000.
 eval | step:  130000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=179.17s).
Accumulating evaluation results...
DONE (t=18.31s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.388
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.605
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.422
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.175
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.390
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.509
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.316
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.523
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.569
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.361
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.586
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.677
 eval | step:  130000 | eval time:  511.8 sec | output: 
    {'3': {'avg_iou': 0.4835024,
           'avg_obj': 0.20309733,
           'box_loss': 2.229148,
           'class_loss': 1.5102097,
           'conf_loss': 5.8578553,
           'precision50': 0.24821965,
           'recall50': 0.18701965},
     '4': {'avg_iou': 0.6987348,
           'avg_obj': 0.42224443,
           'box_loss': 1.9917822,
           'class_loss': 1.490773,
           'conf_loss': 5.4393015,
           'precision50': 0.37543705,
           'recall50': 0.42204955},
     '5': {'avg_iou': 0.80104405,
           'avg_obj': 0.6038827,
           'box_loss': 1.1232966,
           'class_loss': 0.90400547,
           'conf_loss': 2.789991,
           'precision50': 0.45287916,
           'recall50': 0.616108},
     'AP': 0.38806182,
     'AP50': 0.6045874,
     'AP75': 0.42153695,
     'APl': 0.5090532,
     'APm': 0.38963574,
     'APs': 0.17481364,
     'ARl': 0.6771119,
     'ARm': 0.58648866,
     'ARmax1': 0.31585672,
     'ARmax10': 0.5233225,
     'ARmax100': 0.56941926,
     'ARs': 0.3609312,
     'global': {'total_loss': 23.336353},
     'validation_loss': 23.336353}I0503 22:25:14.168328 140519251994432 controller.py:211] train | step:  130000 | training until step 150000...
I0503 23:30:37.810565 140519251994432 controller.py:425] train | step:  140000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6751832,
           'avg_obj': 0.2831385,
           'box_loss': 4.2105584,
           'class_loss': 3.6369603,
           'conf_loss': 8.830967,
           'precision50': 0.3168585,
           'recall50': 0.18663742},
     '4': {'avg_iou': 0.79087144,
           'avg_obj': 0.45498908,
           'box_loss': 2.585664,
           'class_loss': 2.6469836,
           'conf_loss': 6.6405287,
           'precision50': 0.42772606,
           'recall50': 0.4121165},
     '5': {'avg_iou': 0.8264749,
           'avg_obj': 0.5741095,
           'box_loss': 1.1255269,
           'class_loss': 1.3560287,
           'conf_loss': 2.757036,
           'precision50': 0.5090169,
           'recall50': 0.57647395},
     'global': {'total_loss': 33.79028},
     'learning_rate': 0.00131,
     'training_loss': 33.79028}
I0503 23:31:30.055531 140519251994432 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-140000.
I0504 00:30:23.704153 140519251994432 controller.py:425] train | step:  150000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6767239,
           'avg_obj': 0.2866506,
           'box_loss': 4.1870017,
           'class_loss': 3.5737462,
           'conf_loss': 8.779231,
           'precision50': 0.31807506,
           'recall50': 0.1895012},
     '4': {'avg_iou': 0.79247236,
           'avg_obj': 0.45908687,
           'box_loss': 2.5606961,
           'class_loss': 2.5864549,
           'conf_loss': 6.5762305,
           'precision50': 0.42725858,
           'recall50': 0.41640484},
     '5': {'avg_iou': 0.82788074,
           'avg_obj': 0.57843786,
           'box_loss': 1.1126873,
           'class_loss': 1.3205321,
           'conf_loss': 2.7209332,
           'precision50': 0.50813836,
           'recall50': 0.5804273},
     'global': {'total_loss': 33.417515},
     'learning_rate': 0.00131,
     'training_loss': 33.417515}
I0504 00:31:16.132594 140519251994432 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-150000.
I0504 00:31:16.138675 140519251994432 controller.py:252]  eval | step:  150000 | running 625 steps of evaluation...
I0504 00:35:33.454550 140519251994432 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0504 00:39:44.517957 140519251994432 controller.py:261]  eval | step:  150000 | eval time:  508.4 sec | output: 
    {'3': {'avg_iou': 0.48489013,
           'avg_obj': 0.20619492,
           'box_loss': 2.2099628,
           'class_loss': 1.4708246,
           'conf_loss': 5.822687,
           'precision50': 0.24827136,
           'recall50': 0.19146219},
     '4': {'avg_iou': 0.70086956,
           'avg_obj': 0.42879966,
           'box_loss': 1.9664578,
           'class_loss': 1.4630796,
           'conf_loss': 5.4003983,
           'precision50': 0.37327433,
           'recall50': 0.4286354},
     '5': {'avg_iou': 0.80294895,
           'avg_obj': 0.6130481,
           'box_loss': 1.1102635,
           'class_loss': 0.8932832,
           'conf_loss': 2.7663949,
           'precision50': 0.44757453,
           'recall50': 0.6227383},
     'AP': 0.39304286,
     'AP50': 0.6109069,
     'AP75': 0.4254354,
     'APl': 0.5153845,
     'APm': 0.3939866,
     'APs': 0.18053125,
     'ARl': 0.6812459,
     'ARm': 0.5905054,
     'ARmax1': 0.31679308,
     'ARmax10': 0.52676916,
     'ARmax100': 0.57405734,
     'ARs': 0.36930612,
     'global': {'total_loss': 23.103365},
     'validation_loss': 23.103365}
I0504 00:40:01.290074 140519251994432 controller.py:211] train | step:  150000 | training until step 170000...
I0504 01:38:25.227144 140519251994432 controller.py:425] train | step:  160000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6778565,
           'avg_obj': 0.28994742,
           'box_loss': 4.1763453,
           'class_loss': 3.5342133,
           'conf_loss': 8.747172,
           'precision50': 0.3198875,
           'recall50': 0.19259472},
     '4': {'avg_iou': 0.79417443,
           'avg_obj': 0.46388415,
           'box_loss': 2.5384235,
           'class_loss': 2.5463793,
           'conf_loss': 6.5174956,
           'precision50': 0.4283335,
           'recall50': 0.42055786},
     '5': {'avg_iou': 0.8296293,
           'avg_obj': 0.58361316,
           'box_loss': 1.1025044,
           'class_loss': 1.2976863,
           'conf_loss': 2.6909785,
           'precision50': 0.5106564,
           'recall50': 0.5860721},
     'global': {'total_loss': 33.15121},
     'learning_rate': 0.00131,
     'training_loss': 33.15121}
I0504 01:39:27.592914 140519251994432 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-160000.
I0504 02:38:34.539679 140519251994432 controller.py:425] train | step:  170000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.67939514,
           'avg_obj': 0.29277992,
           'box_loss': 4.1564417,
           'class_loss': 3.4797719,
           'conf_loss': 8.712845,
           'precision50': 0.32103163,
           'recall50': 0.19516586},
     '4': {'avg_iou': 0.7956516,
           'avg_obj': 0.4678285,
           'box_loss': 2.529162,
           'class_loss': 2.5037155,
           'conf_loss': 6.489985,
           'precision50': 0.42829835,
           'recall50': 0.42437857},
     '5': {'avg_iou': 0.8309831,
           'avg_obj': 0.5881955,
           'box_loss': 1.0969399,
           'class_loss': 1.2774407,
           'conf_loss': 2.6693943,
           'precision50': 0.5102073,
           'recall50': 0.59056455},
     'global': {'total_loss': 32.915646},
     'learning_rate': 0.00131,
     'training_loss': 32.915646}
I0504 02:39:28.396376 140519251994432 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-170000.
I0504 02:39:28.402188 140519251994432 controller.py:252]  eval | step:  170000 | running 625 steps of evaluation...
I0504 02:43:44.721866 140519251994432 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0504 02:47:54.405099 140519251994432 controller.py:261]  eval | step:  170000 | eval time:  506.0 sec | output: 
    {'3': {'avg_iou': 0.48556328,
           'avg_obj': 0.20897532,
           'box_loss': 2.1991045,
           'class_loss': 1.4452927,
           'conf_loss': 5.815358,
           'precision50': 0.24659641,
           'recall50': 0.19397368},
     '4': {'avg_iou': 0.70254296,
           'avg_obj': 0.43407252,
           'box_loss': 1.947351,
           'class_loss': 1.428884,
           'conf_loss': 5.370813,
           'precision50': 0.3727837,
           'recall50': 0.43471283},
     '5': {'avg_iou': 0.8051749,
           'avg_obj': 0.6178004,
           'box_loss': 1.0953671,
           'class_loss': 0.8741975,
           'conf_loss': 2.7440617,
           'precision50': 0.44586134,
           'recall50': 0.6276224},
     'AP': 0.39737976,
     'AP50': 0.6132358,
     'AP75': 0.43259808,
     'APl': 0.5224787,
     'APm': 0.39843053,
     'APs': 0.17588565,
     'ARl': 0.6870254,
     'ARm': 0.59647095,
     'ARmax1': 0.32025707,
     'ARmax10': 0.5319578,
     'ARmax100': 0.5788566,
     'ARs': 0.37280023,
     'global': {'total_loss': 22.92042},
     'validation_loss': 22.92042}

train | step:  130000 | training until step 150000...
train | step:  140000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6751832,
           'avg_obj': 0.2831385,
           'box_loss': 4.2105584,
           'class_loss': 3.6369603,
           'conf_loss': 8.830967,
           'precision50': 0.3168585,
           'recall50': 0.18663742},
     '4': {'avg_iou': 0.79087144,
           'avg_obj': 0.45498908,
           'box_loss': 2.585664,
           'class_loss': 2.6469836,
           'conf_loss': 6.6405287,
           'precision50': 0.42772606,
           'recall50': 0.4121165},
     '5': {'avg_iou': 0.8264749,
           'avg_obj': 0.5741095,
           'box_loss': 1.1255269,
           'class_loss': 1.3560287,
           'conf_loss': 2.757036,
           'precision50': 0.5090169,
           'recall50': 0.57647395},
     'global': {'total_loss': 33.79028},
     'learning_rate': 0.00131,
     'training_loss': 33.79028}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-140000.
train | step:  150000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6767239,
           'avg_obj': 0.2866506,
           'box_loss': 4.1870017,
           'class_loss': 3.5737462,
           'conf_loss': 8.779231,
           'precision50': 0.31807506,
           'recall50': 0.1895012},
     '4': {'avg_iou': 0.79247236,
           'avg_obj': 0.45908687,
           'box_loss': 2.5606961,
           'class_loss': 2.5864549,
           'conf_loss': 6.5762305,
           'precision50': 0.42725858,
           'recall50': 0.41640484},
     '5': {'avg_iou': 0.82788074,
           'avg_obj': 0.57843786,
           'box_loss': 1.1126873,
           'class_loss': 1.3205321,
           'conf_loss': 2.7209332,
           'precision50': 0.50813836,
           'recall50': 0.5804273},
     'global': {'total_loss': 33.417515},
     'learning_rate': 0.00131,
     'training_loss': 33.417515}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-150000.
 eval | step:  150000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=180.89s).
Accumulating evaluation results...
DONE (t=14.21s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.393
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.611
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.425
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.181
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.394
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.515
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.317
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.527
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.574
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.369
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.591
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.681
 eval | step:  150000 | eval time:  508.4 sec | output: 
    {'3': {'avg_iou': 0.48489013,
           'avg_obj': 0.20619492,
           'box_loss': 2.2099628,
           'class_loss': 1.4708246,
           'conf_loss': 5.822687,
           'precision50': 0.24827136,
           'recall50': 0.19146219},
     '4': {'avg_iou': 0.70086956,
           'avg_obj': 0.42879966,
           'box_loss': 1.9664578,
           'class_loss': 1.4630796,
           'conf_loss': 5.4003983,
           'precision50': 0.37327433,
           'recall50': 0.4286354},
     '5': {'avg_iou': 0.80294895,
           'avg_obj': 0.6130481,
           'box_loss': 1.1102635,
           'class_loss': 0.8932832,
           'conf_loss': 2.7663949,
           'precision50': 0.44757453,
           'recall50': 0.6227383},
     'AP': 0.39304286,
     'AP50': 0.6109069,
     'AP75': 0.4254354,
     'APl': 0.5153845,
     'APm': 0.3939866,
     'APs': 0.18053125,
     'ARl': 0.6812459,
     'ARm': 0.5905054,
     'ARmax1': 0.31679308,
     'ARmax10': 0.52676916,
     'ARmax100': 0.57405734,
     'ARs': 0.36930612,
     'global': {'total_loss': 23.103365},
     'validation_loss': 23.103365}
train | step:  150000 | training until step 170000...
train | step:  160000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6778565,
           'avg_obj': 0.28994742,
           'box_loss': 4.1763453,
           'class_loss': 3.5342133,
           'conf_loss': 8.747172,
           'precision50': 0.3198875,
           'recall50': 0.19259472},
     '4': {'avg_iou': 0.79417443,
           'avg_obj': 0.46388415,
           'box_loss': 2.5384235,
           'class_loss': 2.5463793,
           'conf_loss': 6.5174956,
           'precision50': 0.4283335,
           'recall50': 0.42055786},
     '5': {'avg_iou': 0.8296293,
           'avg_obj': 0.58361316,
           'box_loss': 1.1025044,
           'class_loss': 1.2976863,
           'conf_loss': 2.6909785,
           'precision50': 0.5106564,
           'recall50': 0.5860721},
     'global': {'total_loss': 33.15121},
     'learning_rate': 0.00131,
     'training_loss': 33.15121}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-160000.
train | step:  170000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.67939514,
           'avg_obj': 0.29277992,
           'box_loss': 4.1564417,
           'class_loss': 3.4797719,
           'conf_loss': 8.712845,
           'precision50': 0.32103163,
           'recall50': 0.19516586},
     '4': {'avg_iou': 0.7956516,
           'avg_obj': 0.4678285,
           'box_loss': 2.529162,
           'class_loss': 2.5037155,
           'conf_loss': 6.489985,
           'precision50': 0.42829835,
           'recall50': 0.42437857},
     '5': {'avg_iou': 0.8309831,
           'avg_obj': 0.5881955,
           'box_loss': 1.0969399,
           'class_loss': 1.2774407,
           'conf_loss': 2.6693943,
           'precision50': 0.5102073,
           'recall50': 0.59056455},
     'global': {'total_loss': 32.915646},
     'learning_rate': 0.00131,
     'training_loss': 32.915646}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-170000.
 eval | step:  170000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=178.80s).
Accumulating evaluation results...
DONE (t=13.70s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.397
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.613
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.433
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.176
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.398
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.522
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.320
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.532
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.579
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.373
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.596
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.687
 eval | step:  170000 | eval time:  506.0 sec | output: 
    {'3': {'avg_iou': 0.48556328,
           'avg_obj': 0.20897532,
           'box_loss': 2.1991045,
           'class_loss': 1.4452927,
           'conf_loss': 5.815358,
           'precision50': 0.24659641,
           'recall50': 0.19397368},
     '4': {'avg_iou': 0.70254296,
           'avg_obj': 0.43407252,
           'box_loss': 1.947351,
           'class_loss': 1.428884,
           'conf_loss': 5.370813,
           'precision50': 0.3727837,
           'recall50': 0.43471283},
     '5': {'avg_iou': 0.8051749,
           'avg_obj': 0.6178004,
           'box_loss': 1.0953671,
           'class_loss': 0.8741975,
           'conf_loss': 2.7440617,
           'precision50': 0.44586134,
           'recall50': 0.6276224},
     'AP': 0.39737976,
     'AP50': 0.6132358,
     'AP75': 0.43259808,
     'APl': 0.5224787,
     'APm': 0.39843053,
     'APs': 0.17588565,
     'ARl': 0.6870254,
     'ARm': 0.59647095,
     'ARmax1': 0.32025707,
     'ARmax10': 0.5319578,
     'ARmax100': 0.5788566,
     'ARs': 0.37280023,
     'global': {'total_loss': 22.92042},
     'validation_loss': 22.92042}I0504 02:48:11.886433 140519251994432 controller.py:211] train | step:  170000 | training until step 190000...
I0504 03:44:51.387646 140519251994432 controller.py:425] train | step:  180000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.68032414,
           'avg_obj': 0.295604,
           'box_loss': 4.1509285,
           'class_loss': 3.4434175,
           'conf_loss': 8.68549,
           'precision50': 0.3214556,
           'recall50': 0.19771475},
     '4': {'avg_iou': 0.79715335,
           'avg_obj': 0.47188574,
           'box_loss': 2.5076485,
           'class_loss': 2.4618435,
           'conf_loss': 6.433984,
           'precision50': 0.4286281,
           'recall50': 0.42900634},
     '5': {'avg_iou': 0.8321247,
           'avg_obj': 0.5919361,
           'box_loss': 1.088115,
           'class_loss': 1.2520789,
           'conf_loss': 2.6422307,
           'precision50': 0.510095,
           'recall50': 0.59419274},
     'global': {'total_loss': 32.66576},
     'learning_rate': 0.00131,
     'training_loss': 32.66576}
I0504 03:45:46.578254 140519251994432 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-180000.
I0504 04:45:03.693307 140519251994432 controller.py:425] train | step:  190000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6813328,
           'avg_obj': 0.29852873,
           'box_loss': 4.131808,
           'class_loss': 3.4007816,
           'conf_loss': 8.640389,
           'precision50': 0.32255477,
           'recall50': 0.20010573},
     '4': {'avg_iou': 0.79826134,
           'avg_obj': 0.47574794,
           'box_loss': 2.4922824,
           'class_loss': 2.4229746,
           'conf_loss': 6.383987,
           'precision50': 0.4287497,
           'recall50': 0.4325823},
     '5': {'avg_iou': 0.8333788,
           'avg_obj': 0.5953535,
           'box_loss': 1.0786136,
           'class_loss': 1.23284,
           'conf_loss': 2.6180859,
           'precision50': 0.50899094,
           'recall50': 0.5967434},
     'global': {'total_loss': 32.40184},
     'learning_rate': 0.00131,
     'training_loss': 32.40184}
I0504 04:45:56.789407 140519251994432 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-190000.
I0504 04:45:56.795982 140519251994432 controller.py:252]  eval | step:  190000 | running 625 steps of evaluation...
I0504 04:50:15.238109 140519251994432 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0504 04:54:27.100172 140519251994432 controller.py:261]  eval | step:  190000 | eval time:  510.3 sec | output: 
    {'3': {'avg_iou': 0.48627037,
           'avg_obj': 0.21083558,
           'box_loss': 2.1885753,
           'class_loss': 1.4320226,
           'conf_loss': 5.780998,
           'precision50': 0.24770029,
           'recall50': 0.1957281},
     '4': {'avg_iou': 0.70386446,
           'avg_obj': 0.43892926,
           'box_loss': 1.9304053,
           'class_loss': 1.4185965,
           'conf_loss': 5.351971,
           'precision50': 0.37313324,
           'recall50': 0.44244123},
     '5': {'avg_iou': 0.80617815,
           'avg_obj': 0.62184596,
           'box_loss': 1.087826,
           'class_loss': 0.8627289,
           'conf_loss': 2.7475688,
           'precision50': 0.44151455,
           'recall50': 0.633086},
     'AP': 0.4011273,
     'AP50': 0.61917627,
     'AP75': 0.43584132,
     'APl': 0.5262815,
     'APm': 0.4035676,
     'APs': 0.17742619,
     'ARl': 0.6884222,
     'ARm': 0.6016855,
     'ARmax1': 0.32315597,
     'ARmax10': 0.53377086,
     'ARmax100': 0.5806154,
     'ARs': 0.37302074,
     'global': {'total_loss': 22.80069},
     'validation_loss': 22.80069}
I0504 04:54:52.237816 140519251994432 controller.py:211] train | step:  190000 | training until step 210000...
I0504 05:54:44.810058 140519251994432 controller.py:425] train | step:  200000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.68248516,
           'avg_obj': 0.30078578,
           'box_loss': 4.121756,
           'class_loss': 3.3621418,
           'conf_loss': 8.619237,
           'precision50': 0.32392517,
           'recall50': 0.20204538},
     '4': {'avg_iou': 0.79946536,
           'avg_obj': 0.47874984,
           'box_loss': 2.4800484,
           'class_loss': 2.3896513,
           'conf_loss': 6.35203,
           'precision50': 0.42961162,
           'recall50': 0.43637857},
     '5': {'avg_iou': 0.83482695,
           'avg_obj': 0.599327,
           'box_loss': 1.070267,
           'class_loss': 1.2148768,
           'conf_loss': 2.594655,
           'precision50': 0.50897247,
           'recall50': 0.60106975},
     'global': {'total_loss': 32.204628},
     'learning_rate': 0.00131,
     'training_loss': 32.204628}
I0504 05:55:38.524698 140519251994432 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-200000.
I0504 06:55:21.469685 140519251994432 controller.py:425] train | step:  210000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.68352175,
           'avg_obj': 0.3029721,
           'box_loss': 4.103328,
           'class_loss': 3.3188996,
           'conf_loss': 8.577077,
           'precision50': 0.32431024,
           'recall50': 0.20431678},
     '4': {'avg_iou': 0.8005558,
           'avg_obj': 0.48183623,
           'box_loss': 2.4639282,
           'class_loss': 2.3590147,
           'conf_loss': 6.308413,
           'precision50': 0.42976987,
           'recall50': 0.43968946},
     '5': {'avg_iou': 0.83573484,
           'avg_obj': 0.60264933,
           'box_loss': 1.063863,
           'class_loss': 1.1968063,
           'conf_loss': 2.5722144,
           'precision50': 0.5090789,
           'recall50': 0.60471594},
     'global': {'total_loss': 31.96345},
     'learning_rate': 0.00131,
     'training_loss': 31.96345}
I0504 06:56:13.157623 140519251994432 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-210000.
I0504 06:56:13.163936 140519251994432 controller.py:252]  eval | step:  210000 | running 625 steps of evaluation...
I0504 07:00:39.699934 140519251994432 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0504 07:05:10.090895 140519251994432 controller.py:261]  eval | step:  210000 | eval time:  536.9 sec | output: 
    {'3': {'avg_iou': 0.48723602,
           'avg_obj': 0.21424073,
           'box_loss': 2.176317,
           'class_loss': 1.4264826,
           'conf_loss': 5.781143,
           'precision50': 0.24878806,
           'recall50': 0.20008366},
     '4': {'avg_iou': 0.7048632,
           'avg_obj': 0.44335157,
           'box_loss': 1.9191622,
           'class_loss': 1.4101257,
           'conf_loss': 5.3415923,
           'precision50': 0.3704048,
           'recall50': 0.4461078},
     '5': {'avg_iou': 0.8071796,
           'avg_obj': 0.62533253,
           'box_loss': 1.0811371,
           'class_loss': 0.85240674,
           'conf_loss': 2.7375393,
           'precision50': 0.43624657,
           'recall50': 0.6354126},
     'AP': 0.4031828,
     'AP50': 0.61878514,
     'AP75': 0.43984288,
     'APl': 0.5280472,
     'APm': 0.40500033,
     'APs': 0.17910142,
     'ARl': 0.69169885,
     'ARm': 0.6038557,
     'ARmax1': 0.32342932,
     'ARmax10': 0.5368352,
     'ARmax100': 0.5841187,
     'ARs': 0.37604716,
     'global': {'total_loss': 22.7259},
     'validation_loss': 22.7259}

train | step:  170000 | training until step 190000...
train | step:  180000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.68032414,
           'avg_obj': 0.295604,
           'box_loss': 4.1509285,
           'class_loss': 3.4434175,
           'conf_loss': 8.68549,
           'precision50': 0.3214556,
           'recall50': 0.19771475},
     '4': {'avg_iou': 0.79715335,
           'avg_obj': 0.47188574,
           'box_loss': 2.5076485,
           'class_loss': 2.4618435,
           'conf_loss': 6.433984,
           'precision50': 0.4286281,
           'recall50': 0.42900634},
     '5': {'avg_iou': 0.8321247,
           'avg_obj': 0.5919361,
           'box_loss': 1.088115,
           'class_loss': 1.2520789,
           'conf_loss': 2.6422307,
           'precision50': 0.510095,
           'recall50': 0.59419274},
     'global': {'total_loss': 32.66576},
     'learning_rate': 0.00131,
     'training_loss': 32.66576}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-180000.
train | step:  190000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6813328,
           'avg_obj': 0.29852873,
           'box_loss': 4.131808,
           'class_loss': 3.4007816,
           'conf_loss': 8.640389,
           'precision50': 0.32255477,
           'recall50': 0.20010573},
     '4': {'avg_iou': 0.79826134,
           'avg_obj': 0.47574794,
           'box_loss': 2.4922824,
           'class_loss': 2.4229746,
           'conf_loss': 6.383987,
           'precision50': 0.4287497,
           'recall50': 0.4325823},
     '5': {'avg_iou': 0.8333788,
           'avg_obj': 0.5953535,
           'box_loss': 1.0786136,
           'class_loss': 1.23284,
           'conf_loss': 2.6180859,
           'precision50': 0.50899094,
           'recall50': 0.5967434},
     'global': {'total_loss': 32.40184},
     'learning_rate': 0.00131,
     'training_loss': 32.40184}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-190000.
 eval | step:  190000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=181.73s).
Accumulating evaluation results...
DONE (t=13.72s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.401
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.619
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.436
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.177
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.404
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.526
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.323
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.534
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.581
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.373
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.602
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.688
 eval | step:  190000 | eval time:  510.3 sec | output: 
    {'3': {'avg_iou': 0.48627037,
           'avg_obj': 0.21083558,
           'box_loss': 2.1885753,
           'class_loss': 1.4320226,
           'conf_loss': 5.780998,
           'precision50': 0.24770029,
           'recall50': 0.1957281},
     '4': {'avg_iou': 0.70386446,
           'avg_obj': 0.43892926,
           'box_loss': 1.9304053,
           'class_loss': 1.4185965,
           'conf_loss': 5.351971,
           'precision50': 0.37313324,
           'recall50': 0.44244123},
     '5': {'avg_iou': 0.80617815,
           'avg_obj': 0.62184596,
           'box_loss': 1.087826,
           'class_loss': 0.8627289,
           'conf_loss': 2.7475688,
           'precision50': 0.44151455,
           'recall50': 0.633086},
     'AP': 0.4011273,
     'AP50': 0.61917627,
     'AP75': 0.43584132,
     'APl': 0.5262815,
     'APm': 0.4035676,
     'APs': 0.17742619,
     'ARl': 0.6884222,
     'ARm': 0.6016855,
     'ARmax1': 0.32315597,
     'ARmax10': 0.53377086,
     'ARmax100': 0.5806154,
     'ARs': 0.37302074,
     'global': {'total_loss': 22.80069},
     'validation_loss': 22.80069}
train | step:  190000 | training until step 210000...
train | step:  200000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.68248516,
           'avg_obj': 0.30078578,
           'box_loss': 4.121756,
           'class_loss': 3.3621418,
           'conf_loss': 8.619237,
           'precision50': 0.32392517,
           'recall50': 0.20204538},
     '4': {'avg_iou': 0.79946536,
           'avg_obj': 0.47874984,
           'box_loss': 2.4800484,
           'class_loss': 2.3896513,
           'conf_loss': 6.35203,
           'precision50': 0.42961162,
           'recall50': 0.43637857},
     '5': {'avg_iou': 0.83482695,
           'avg_obj': 0.599327,
           'box_loss': 1.070267,
           'class_loss': 1.2148768,
           'conf_loss': 2.594655,
           'precision50': 0.50897247,
           'recall50': 0.60106975},
     'global': {'total_loss': 32.204628},
     'learning_rate': 0.00131,
     'training_loss': 32.204628}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-200000.
train | step:  210000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.68352175,
           'avg_obj': 0.3029721,
           'box_loss': 4.103328,
           'class_loss': 3.3188996,
           'conf_loss': 8.577077,
           'precision50': 0.32431024,
           'recall50': 0.20431678},
     '4': {'avg_iou': 0.8005558,
           'avg_obj': 0.48183623,
           'box_loss': 2.4639282,
           'class_loss': 2.3590147,
           'conf_loss': 6.308413,
           'precision50': 0.42976987,
           'recall50': 0.43968946},
     '5': {'avg_iou': 0.83573484,
           'avg_obj': 0.60264933,
           'box_loss': 1.063863,
           'class_loss': 1.1968063,
           'conf_loss': 2.5722144,
           'precision50': 0.5090789,
           'recall50': 0.60471594},
     'global': {'total_loss': 31.96345},
     'learning_rate': 0.00131,
     'training_loss': 31.96345}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-210000.
 eval | step:  210000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=190.78s).
Accumulating evaluation results...
DONE (t=14.88s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.403
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.619
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.440
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.179
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.405
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.528
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.323
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.537
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.584
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.376
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.604
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.692
 eval | step:  210000 | eval time:  536.9 sec | output: 
    {'3': {'avg_iou': 0.48723602,
           'avg_obj': 0.21424073,
           'box_loss': 2.176317,
           'class_loss': 1.4264826,
           'conf_loss': 5.781143,
           'precision50': 0.24878806,
           'recall50': 0.20008366},
     '4': {'avg_iou': 0.7048632,
           'avg_obj': 0.44335157,
           'box_loss': 1.9191622,
           'class_loss': 1.4101257,
           'conf_loss': 5.3415923,
           'precision50': 0.3704048,
           'recall50': 0.4461078},
     '5': {'avg_iou': 0.8071796,
           'avg_obj': 0.62533253,
           'box_loss': 1.0811371,
           'class_loss': 0.85240674,
           'conf_loss': 2.7375393,
           'precision50': 0.43624657,
           'recall50': 0.6354126},
     'AP': 0.4031828,
     'AP50': 0.61878514,
     'AP75': 0.43984288,
     'APl': 0.5280472,
     'APm': 0.40500033,
     'APs': 0.17910142,
     'ARl': 0.69169885,
     'ARm': 0.6038557,
     'ARmax1': 0.32342932,
     'ARmax10': 0.5368352,
     'ARmax100': 0.5841187,
     'ARs': 0.37604716,
     'global': {'total_loss': 22.7259},
     'validation_loss': 22.7259}I0504 07:05:33.420698 140519251994432 controller.py:211] train | step:  210000 | training until step 230000...
I0504 07:59:44.681700 140519251994432 controller.py:425] train | step:  220000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6840824,
           'avg_obj': 0.30497122,
           'box_loss': 4.093048,
           'class_loss': 3.28707,
           'conf_loss': 8.548762,
           'precision50': 0.32518804,
           'recall50': 0.20585708},
     '4': {'avg_iou': 0.80136687,
           'avg_obj': 0.48462212,
           'box_loss': 2.4518933,
           'class_loss': 2.3257551,
           'conf_loss': 6.2695427,
           'precision50': 0.42907938,
           'recall50': 0.44237396},
     '5': {'avg_iou': 0.83689666,
           'avg_obj': 0.60645133,
           'box_loss': 1.056741,
           'class_loss': 1.1771625,
           'conf_loss': 2.5499763,
           'precision50': 0.5085583,
           'recall50': 0.6081582},
     'global': {'total_loss': 31.759985},
     'learning_rate': 0.00131,
     'training_loss': 31.759985}
I0504 08:00:38.770021 140519251994432 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-220000.
I0504 08:59:31.725821 140519251994432 controller.py:425] train | step:  230000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6850493,
           'avg_obj': 0.30766344,
           'box_loss': 4.083642,
           'class_loss': 3.2564929,
           'conf_loss': 8.522328,
           'precision50': 0.3262461,
           'recall50': 0.20885134},
     '4': {'avg_iou': 0.8025538,
           'avg_obj': 0.48830062,
           'box_loss': 2.440789,
           'class_loss': 2.2929351,
           'conf_loss': 6.2331,
           'precision50': 0.42999947,
           'recall50': 0.44605902},
     '5': {'avg_iou': 0.8376064,
           'avg_obj': 0.6094753,
           'box_loss': 1.0517664,
           'class_loss': 1.1608875,
           'conf_loss': 2.5293202,
           'precision50': 0.5085179,
           'recall50': 0.61081016},
     'global': {'total_loss': 31.5713},
     'learning_rate': 0.00131,
     'training_loss': 31.5713}
I0504 09:00:25.703530 140519251994432 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-230000.
I0504 09:00:25.710177 140519251994432 controller.py:252]  eval | step:  230000 | running 625 steps of evaluation...
I0504 09:04:47.290972 140519251994432 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0504 09:09:24.891415 140519251994432 controller.py:261]  eval | step:  230000 | eval time:  539.2 sec | output: 
    {'3': {'avg_iou': 0.48719555,
           'avg_obj': 0.21589558,
           'box_loss': 2.1731186,
           'class_loss': 1.4196898,
           'conf_loss': 5.766408,
           'precision50': 0.24931665,
           'recall50': 0.20219766},
     '4': {'avg_iou': 0.70575166,
           'avg_obj': 0.4475831,
           'box_loss': 1.9083405,
           'class_loss': 1.3917735,
           'conf_loss': 5.3308735,
           'precision50': 0.37088647,
           'recall50': 0.45074922},
     '5': {'avg_iou': 0.80873024,
           'avg_obj': 0.6303345,
           'box_loss': 1.0714972,
           'class_loss': 0.8489996,
           'conf_loss': 2.7300103,
           'precision50': 0.43465966,
           'recall50': 0.64098895},
     'AP': 0.40545887,
     'AP50': 0.62109953,
     'AP75': 0.4410218,
     'APl': 0.53037703,
     'APm': 0.40766066,
     'APs': 0.1772409,
     'ARl': 0.6897103,
     'ARm': 0.60642534,
     'ARmax1': 0.32342225,
     'ARmax10': 0.5382982,
     'ARmax100': 0.58434874,
     'ARs': 0.36681443,
     'global': {'total_loss': 22.640701},
     'validation_loss': 22.640701}
I0504 09:09:41.629749 140519251994432 controller.py:211] train | step:  230000 | training until step 250000...
I0504 10:02:16.954734 140519251994432 controller.py:425] train | step:  240000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.68565696,
           'avg_obj': 0.30942026,
           'box_loss': 4.0759244,
           'class_loss': 3.2276614,
           'conf_loss': 8.4988575,
           'precision50': 0.32658526,
           'recall50': 0.20985137},
     '4': {'avg_iou': 0.80345565,
           'avg_obj': 0.49117133,
           'box_loss': 2.42323,
           'class_loss': 2.263337,
           'conf_loss': 6.1815176,
           'precision50': 0.42973834,
           'recall50': 0.44844723},
     '5': {'avg_iou': 0.8386642,
           'avg_obj': 0.6119502,
           'box_loss': 1.0415123,
           'class_loss': 1.1439317,
           'conf_loss': 2.5049968,
           'precision50': 0.50786805,
           'recall50': 0.6128893},
     'global': {'total_loss': 31.36101},
     'learning_rate': 0.00131,
     'training_loss': 31.36101}
I0504 10:03:16.951406 140519251994432 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-240000.
I0504 11:02:47.052948 140519251994432 controller.py:425] train | step:  250000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.69205564,
           'avg_obj': 0.3234972,
           'box_loss': 3.994963,
           'class_loss': 3.0339663,
           'conf_loss': 8.325445,
           'precision50': 0.33089495,
           'recall50': 0.22250539},
     '4': {'avg_iou': 0.81072253,
           'avg_obj': 0.5090471,
           'box_loss': 2.3352432,
           'class_loss': 2.0894253,
           'conf_loss': 5.9670734,
           'precision50': 0.43016762,
           'recall50': 0.4664663},
     '5': {'avg_iou': 0.8458254,
           'avg_obj': 0.6313075,
           'box_loss': 0.9965687,
           'class_loss': 1.0399144,
           'conf_loss': 2.3811886,
           'precision50': 0.50882244,
           'recall50': 0.6313917},
     'global': {'total_loss': 30.16371},
     'learning_rate': 0.000655,
     'training_loss': 30.16371}
I0504 11:03:53.662461 140519251994432 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-250000.
I0504 11:03:53.668089 140519251994432 controller.py:252]  eval | step:  250000 | running 625 steps of evaluation...
I0504 11:08:11.651929 140519251994432 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0504 11:12:35.317919 140519251994432 controller.py:261]  eval | step:  250000 | eval time:  521.6 sec | output: 
    {'3': {'avg_iou': 0.48798662,
           'avg_obj': 0.21664666,
           'box_loss': 2.1689367,
           'class_loss': 1.4253986,
           'conf_loss': 5.763379,
           'precision50': 0.2475044,
           'recall50': 0.20387387},
     '4': {'avg_iou': 0.70635206,
           'avg_obj': 0.44985503,
           'box_loss': 1.9042494,
           'class_loss': 1.4139403,
           'conf_loss': 5.340724,
           'precision50': 0.36568454,
           'recall50': 0.4522669},
     '5': {'avg_iou': 0.80916375,
           'avg_obj': 0.6341743,
           'box_loss': 1.0698769,
           'class_loss': 0.8551859,
           'conf_loss': 2.7331054,
           'precision50': 0.43355665,
           'recall50': 0.6434708},
     'AP': 0.40704975,
     'AP50': 0.62301654,
     'AP75': 0.44310507,
     'APl': 0.5321736,
     'APm': 0.40956265,
     'APs': 0.17920779,
     'ARl': 0.6893366,
     'ARm': 0.60947746,
     'ARmax1': 0.32432535,
     'ARmax10': 0.5385641,
     'ARmax100': 0.5862045,
     'ARs': 0.378237,
     'global': {'total_loss': 22.674807},
     'validation_loss': 22.674807}

train | step:  210000 | training until step 230000...
train | step:  220000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6840824,
           'avg_obj': 0.30497122,
           'box_loss': 4.093048,
           'class_loss': 3.28707,
           'conf_loss': 8.548762,
           'precision50': 0.32518804,
           'recall50': 0.20585708},
     '4': {'avg_iou': 0.80136687,
           'avg_obj': 0.48462212,
           'box_loss': 2.4518933,
           'class_loss': 2.3257551,
           'conf_loss': 6.2695427,
           'precision50': 0.42907938,
           'recall50': 0.44237396},
     '5': {'avg_iou': 0.83689666,
           'avg_obj': 0.60645133,
           'box_loss': 1.056741,
           'class_loss': 1.1771625,
           'conf_loss': 2.5499763,
           'precision50': 0.5085583,
           'recall50': 0.6081582},
     'global': {'total_loss': 31.759985},
     'learning_rate': 0.00131,
     'training_loss': 31.759985}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-220000.
train | step:  230000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6850493,
           'avg_obj': 0.30766344,
           'box_loss': 4.083642,
           'class_loss': 3.2564929,
           'conf_loss': 8.522328,
           'precision50': 0.3262461,
           'recall50': 0.20885134},
     '4': {'avg_iou': 0.8025538,
           'avg_obj': 0.48830062,
           'box_loss': 2.440789,
           'class_loss': 2.2929351,
           'conf_loss': 6.2331,
           'precision50': 0.42999947,
           'recall50': 0.44605902},
     '5': {'avg_iou': 0.8376064,
           'avg_obj': 0.6094753,
           'box_loss': 1.0517664,
           'class_loss': 1.1608875,
           'conf_loss': 2.5293202,
           'precision50': 0.5085179,
           'recall50': 0.61081016},
     'global': {'total_loss': 31.5713},
     'learning_rate': 0.00131,
     'training_loss': 31.5713}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-230000.
 eval | step:  230000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=197.06s).
Accumulating evaluation results...
DONE (t=13.73s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.405
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.621
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.441
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.177
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.408
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.530
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.323
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.538
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.584
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.367
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.606
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.690
 eval | step:  230000 | eval time:  539.2 sec | output: 
    {'3': {'avg_iou': 0.48719555,
           'avg_obj': 0.21589558,
           'box_loss': 2.1731186,
           'class_loss': 1.4196898,
           'conf_loss': 5.766408,
           'precision50': 0.24931665,
           'recall50': 0.20219766},
     '4': {'avg_iou': 0.70575166,
           'avg_obj': 0.4475831,
           'box_loss': 1.9083405,
           'class_loss': 1.3917735,
           'conf_loss': 5.3308735,
           'precision50': 0.37088647,
           'recall50': 0.45074922},
     '5': {'avg_iou': 0.80873024,
           'avg_obj': 0.6303345,
           'box_loss': 1.0714972,
           'class_loss': 0.8489996,
           'conf_loss': 2.7300103,
           'precision50': 0.43465966,
           'recall50': 0.64098895},
     'AP': 0.40545887,
     'AP50': 0.62109953,
     'AP75': 0.4410218,
     'APl': 0.53037703,
     'APm': 0.40766066,
     'APs': 0.1772409,
     'ARl': 0.6897103,
     'ARm': 0.60642534,
     'ARmax1': 0.32342225,
     'ARmax10': 0.5382982,
     'ARmax100': 0.58434874,
     'ARs': 0.36681443,
     'global': {'total_loss': 22.640701},
     'validation_loss': 22.640701}
train | step:  230000 | training until step 250000...
train | step:  240000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.68565696,
           'avg_obj': 0.30942026,
           'box_loss': 4.0759244,
           'class_loss': 3.2276614,
           'conf_loss': 8.4988575,
           'precision50': 0.32658526,
           'recall50': 0.20985137},
     '4': {'avg_iou': 0.80345565,
           'avg_obj': 0.49117133,
           'box_loss': 2.42323,
           'class_loss': 2.263337,
           'conf_loss': 6.1815176,
           'precision50': 0.42973834,
           'recall50': 0.44844723},
     '5': {'avg_iou': 0.8386642,
           'avg_obj': 0.6119502,
           'box_loss': 1.0415123,
           'class_loss': 1.1439317,
           'conf_loss': 2.5049968,
           'precision50': 0.50786805,
           'recall50': 0.6128893},
     'global': {'total_loss': 31.36101},
     'learning_rate': 0.00131,
     'training_loss': 31.36101}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-240000.
train | step:  250000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.69205564,
           'avg_obj': 0.3234972,
           'box_loss': 3.994963,
           'class_loss': 3.0339663,
           'conf_loss': 8.325445,
           'precision50': 0.33089495,
           'recall50': 0.22250539},
     '4': {'avg_iou': 0.81072253,
           'avg_obj': 0.5090471,
           'box_loss': 2.3352432,
           'class_loss': 2.0894253,
           'conf_loss': 5.9670734,
           'precision50': 0.43016762,
           'recall50': 0.4664663},
     '5': {'avg_iou': 0.8458254,
           'avg_obj': 0.6313075,
           'box_loss': 0.9965687,
           'class_loss': 1.0399144,
           'conf_loss': 2.3811886,
           'precision50': 0.50882244,
           'recall50': 0.6313917},
     'global': {'total_loss': 30.16371},
     'learning_rate': 0.000655,
     'training_loss': 30.16371}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-250000.
 eval | step:  250000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=190.47s).
Accumulating evaluation results...
DONE (t=14.36s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.407
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.623
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.443
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.179
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.410
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.532
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.324
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.539
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.586
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.378
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.609
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.689
 eval | step:  250000 | eval time:  521.6 sec | output: 
    {'3': {'avg_iou': 0.48798662,
           'avg_obj': 0.21664666,
           'box_loss': 2.1689367,
           'class_loss': 1.4253986,
           'conf_loss': 5.763379,
           'precision50': 0.2475044,
           'recall50': 0.20387387},
     '4': {'avg_iou': 0.70635206,
           'avg_obj': 0.44985503,
           'box_loss': 1.9042494,
           'class_loss': 1.4139403,
           'conf_loss': 5.340724,
           'precision50': 0.36568454,
           'recall50': 0.4522669},
     '5': {'avg_iou': 0.80916375,
           'avg_obj': 0.6341743,
           'box_loss': 1.0698769,
           'class_loss': 0.8551859,
           'conf_loss': 2.7331054,
           'precision50': 0.43355665,
           'recall50': 0.6434708},
     'AP': 0.40704975,
     'AP50': 0.62301654,
     'AP75': 0.44310507,
     'APl': 0.5321736,
     'APm': 0.40956265,
     'APs': 0.17920779,
     'ARl': 0.6893366,
     'ARm': 0.60947746,
     'ARmax1': 0.32432535,
     'ARmax10': 0.5385641,
     'ARmax100': 0.5862045,
     'ARs': 0.378237,
     'global': {'total_loss': 22.674807},
     'validation_loss': 22.674807}I0504 11:13:02.860510 140519251994432 controller.py:211] train | step:  250000 | training until step 270000...
I0504 12:04:13.687153 140519251994432 controller.py:425] train | step:  260000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6930025,
           'avg_obj': 0.32676554,
           'box_loss': 3.9814343,
           'class_loss': 2.9845805,
           'conf_loss': 8.280968,
           'precision50': 0.331826,
           'recall50': 0.2251175},
     '4': {'avg_iou': 0.8118703,
           'avg_obj': 0.51343435,
           'box_loss': 2.3226078,
           'class_loss': 2.0467334,
           'conf_loss': 5.9184165,
           'precision50': 0.43021744,
           'recall50': 0.47122866},
     '5': {'avg_iou': 0.84702766,
           'avg_obj': 0.6358107,
           'box_loss': 0.9886497,
           'class_loss': 1.019457,
           'conf_loss': 2.3535938,
           'precision50': 0.5078504,
           'recall50': 0.6358331},
     'global': {'total_loss': 29.896475},
     'learning_rate': 0.000655,
     'training_loss': 29.896475}
I0504 12:05:05.157730 140519251994432 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-260000.
I0504 13:05:22.501389 140519251994432 controller.py:425] train | step:  270000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6963076,
           'avg_obj': 0.33424005,
           'box_loss': 3.9423878,
           'class_loss': 2.8980858,
           'conf_loss': 8.197542,
           'precision50': 0.33369774,
           'recall50': 0.23187818},
     '4': {'avg_iou': 0.8153656,
           'avg_obj': 0.52379537,
           'box_loss': 2.2841496,
           'class_loss': 1.9611412,
           'conf_loss': 5.7990675,
           'precision50': 0.42978975,
           'recall50': 0.48086098},
     '5': {'avg_iou': 0.85075283,
           'avg_obj': 0.64717805,
           'box_loss': 0.9669876,
           'class_loss': 0.9684563,
           'conf_loss': 2.2840862,
           'precision50': 0.5072247,
           'recall50': 0.64594775},
     'global': {'total_loss': 29.301884},
     'learning_rate': 0.000325,
     'training_loss': 29.301884}
I0504 13:06:19.792293 140519251994432 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-270000.
I0504 13:06:19.798177 140519251994432 controller.py:252]  eval | step:  270000 | running 625 steps of evaluation...
I0504 13:10:39.788802 140519251994432 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0504 13:15:06.948600 140519251994432 controller.py:261]  eval | step:  270000 | eval time:  527.1 sec | output: 
    {'3': {'avg_iou': 0.48828897,
           'avg_obj': 0.2185308,
           'box_loss': 2.1646693,
           'class_loss': 1.414227,
           'conf_loss': 5.7625656,
           'precision50': 0.2483647,
           'recall50': 0.20623852},
     '4': {'avg_iou': 0.7071569,
           'avg_obj': 0.45229056,
           'box_loss': 1.8972563,
           'class_loss': 1.4025217,
           'conf_loss': 5.3484697,
           'precision50': 0.36046377,
           'recall50': 0.45385113},
     '5': {'avg_iou': 0.8098771,
           'avg_obj': 0.6380889,
           'box_loss': 1.065719,
           'class_loss': 0.8537625,
           'conf_loss': 2.746134,
           'precision50': 0.42770186,
           'recall50': 0.6473996},
     'AP': 0.40690714,
     'AP50': 0.62193555,
     'AP75': 0.4424607,
     'APl': 0.52863026,
     'APm': 0.41152963,
     'APs': 0.1795772,
     'ARl': 0.69065624,
     'ARm': 0.6081499,
     'ARmax1': 0.32622746,
     'ARmax10': 0.53847885,
     'ARmax100': 0.58645934,
     'ARs': 0.37645778,
     'global': {'total_loss': 22.655329},
     'validation_loss': 22.655329}
I0504 13:15:29.578224 140519251994432 controller.py:211] train | step:  270000 | training until step 290000...
I0504 14:05:37.040951 140519251994432 controller.py:425] train | step:  280000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.69721264,
           'avg_obj': 0.3365876,
           'box_loss': 3.9187133,
           'class_loss': 2.8529544,
           'conf_loss': 8.1415615,
           'precision50': 0.33472192,
           'recall50': 0.23468548},
     '4': {'avg_iou': 0.8160166,
           'avg_obj': 0.52632076,
           'box_loss': 2.2686784,
           'class_loss': 1.9291087,
           'conf_loss': 5.7516994,
           'precision50': 0.42948472,
           'recall50': 0.48374838},
     '5': {'avg_iou': 0.8515677,
           'avg_obj': 0.650886,
           'box_loss': 0.95996594,
           'class_loss': 0.95047843,
           'conf_loss': 2.2587345,
           'precision50': 0.5068532,
           'recall50': 0.64964783},
     'global': {'total_loss': 29.031963},
     'learning_rate': 0.000325,
     'training_loss': 29.031963}
I0504 14:06:30.117482 140519251994432 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-280000.
I0504 15:06:23.379937 140519251994432 controller.py:425] train | step:  290000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6975691,
           'avg_obj': 0.33832663,
           'box_loss': 3.9142148,
           'class_loss': 2.8328228,
           'conf_loss': 8.122834,
           'precision50': 0.33529443,
           'recall50': 0.2364408},
     '4': {'avg_iou': 0.8165816,
           'avg_obj': 0.52881765,
           'box_loss': 2.2611477,
           'class_loss': 1.9135121,
           'conf_loss': 5.7209163,
           'precision50': 0.43037686,
           'recall50': 0.4863706},
     '5': {'avg_iou': 0.85208493,
           'avg_obj': 0.65292,
           'box_loss': 0.9568648,
           'class_loss': 0.94100744,
           'conf_loss': 2.24644,
           'precision50': 0.5066003,
           'recall50': 0.650896},
     'global': {'total_loss': 28.909729},
     'learning_rate': 0.000325,
     'training_loss': 28.909729}
I0504 15:07:15.586909 140519251994432 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-290000.
I0504 15:07:15.593336 140519251994432 controller.py:252]  eval | step:  290000 | running 625 steps of evaluation...
I0504 15:11:35.486478 140519251994432 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0504 15:16:03.495812 140519251994432 controller.py:261]  eval | step:  290000 | eval time:  527.9 sec | output: 
    {'3': {'avg_iou': 0.48851615,
           'avg_obj': 0.21979263,
           'box_loss': 2.1608636,
           'class_loss': 1.4212725,
           'conf_loss': 5.7614045,
           'precision50': 0.24607658,
           'recall50': 0.2069005},
     '4': {'avg_iou': 0.7071724,
           'avg_obj': 0.4556764,
           'box_loss': 1.8954234,
           'class_loss': 1.4195106,
           'conf_loss': 5.354973,
           'precision50': 0.36143753,
           'recall50': 0.4573114},
     '5': {'avg_iou': 0.810164,
           'avg_obj': 0.6402349,
           'box_loss': 1.0639913,
           'class_loss': 0.86345315,
           'conf_loss': 2.7552884,
           'precision50': 0.42444098,
           'recall50': 0.6481759},
     'AP': 0.4073298,
     'AP50': 0.6218864,
     'AP75': 0.44380385,
     'APl': 0.5316747,
     'APm': 0.4110808,
     'APs': 0.18075186,
     'ARl': 0.68979335,
     'ARm': 0.6073086,
     'ARmax1': 0.32492527,
     'ARmax10': 0.5388382,
     'ARmax100': 0.587467,
     'ARs': 0.37982512,
     'global': {'total_loss': 22.696169},
     'validation_loss': 22.696169}

train | step:  250000 | training until step 270000...
train | step:  260000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6930025,
           'avg_obj': 0.32676554,
           'box_loss': 3.9814343,
           'class_loss': 2.9845805,
           'conf_loss': 8.280968,
           'precision50': 0.331826,
           'recall50': 0.2251175},
     '4': {'avg_iou': 0.8118703,
           'avg_obj': 0.51343435,
           'box_loss': 2.3226078,
           'class_loss': 2.0467334,
           'conf_loss': 5.9184165,
           'precision50': 0.43021744,
           'recall50': 0.47122866},
     '5': {'avg_iou': 0.84702766,
           'avg_obj': 0.6358107,
           'box_loss': 0.9886497,
           'class_loss': 1.019457,
           'conf_loss': 2.3535938,
           'precision50': 0.5078504,
           'recall50': 0.6358331},
     'global': {'total_loss': 29.896475},
     'learning_rate': 0.000655,
     'training_loss': 29.896475}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-260000.
train | step:  270000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6963076,
           'avg_obj': 0.33424005,
           'box_loss': 3.9423878,
           'class_loss': 2.8980858,
           'conf_loss': 8.197542,
           'precision50': 0.33369774,
           'recall50': 0.23187818},
     '4': {'avg_iou': 0.8153656,
           'avg_obj': 0.52379537,
           'box_loss': 2.2841496,
           'class_loss': 1.9611412,
           'conf_loss': 5.7990675,
           'precision50': 0.42978975,
           'recall50': 0.48086098},
     '5': {'avg_iou': 0.85075283,
           'avg_obj': 0.64717805,
           'box_loss': 0.9669876,
           'class_loss': 0.9684563,
           'conf_loss': 2.2840862,
           'precision50': 0.5072247,
           'recall50': 0.64594775},
     'global': {'total_loss': 29.301884},
     'learning_rate': 0.000325,
     'training_loss': 29.301884}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-270000.
 eval | step:  270000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=197.00s).
Accumulating evaluation results...
DONE (t=12.55s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.407
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.622
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.442
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.180
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.412
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.529
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.326
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.538
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.586
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.376
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.608
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.691
 eval | step:  270000 | eval time:  527.1 sec | output: 
    {'3': {'avg_iou': 0.48828897,
           'avg_obj': 0.2185308,
           'box_loss': 2.1646693,
           'class_loss': 1.414227,
           'conf_loss': 5.7625656,
           'precision50': 0.2483647,
           'recall50': 0.20623852},
     '4': {'avg_iou': 0.7071569,
           'avg_obj': 0.45229056,
           'box_loss': 1.8972563,
           'class_loss': 1.4025217,
           'conf_loss': 5.3484697,
           'precision50': 0.36046377,
           'recall50': 0.45385113},
     '5': {'avg_iou': 0.8098771,
           'avg_obj': 0.6380889,
           'box_loss': 1.065719,
           'class_loss': 0.8537625,
           'conf_loss': 2.746134,
           'precision50': 0.42770186,
           'recall50': 0.6473996},
     'AP': 0.40690714,
     'AP50': 0.62193555,
     'AP75': 0.4424607,
     'APl': 0.52863026,
     'APm': 0.41152963,
     'APs': 0.1795772,
     'ARl': 0.69065624,
     'ARm': 0.6081499,
     'ARmax1': 0.32622746,
     'ARmax10': 0.53847885,
     'ARmax100': 0.58645934,
     'ARs': 0.37645778,
     'global': {'total_loss': 22.655329},
     'validation_loss': 22.655329}
train | step:  270000 | training until step 290000...
train | step:  280000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.69721264,
           'avg_obj': 0.3365876,
           'box_loss': 3.9187133,
           'class_loss': 2.8529544,
           'conf_loss': 8.1415615,
           'precision50': 0.33472192,
           'recall50': 0.23468548},
     '4': {'avg_iou': 0.8160166,
           'avg_obj': 0.52632076,
           'box_loss': 2.2686784,
           'class_loss': 1.9291087,
           'conf_loss': 5.7516994,
           'precision50': 0.42948472,
           'recall50': 0.48374838},
     '5': {'avg_iou': 0.8515677,
           'avg_obj': 0.650886,
           'box_loss': 0.95996594,
           'class_loss': 0.95047843,
           'conf_loss': 2.2587345,
           'precision50': 0.5068532,
           'recall50': 0.64964783},
     'global': {'total_loss': 29.031963},
     'learning_rate': 0.000325,
     'training_loss': 29.031963}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-280000.
train | step:  290000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6975691,
           'avg_obj': 0.33832663,
           'box_loss': 3.9142148,
           'class_loss': 2.8328228,
           'conf_loss': 8.122834,
           'precision50': 0.33529443,
           'recall50': 0.2364408},
     '4': {'avg_iou': 0.8165816,
           'avg_obj': 0.52881765,
           'box_loss': 2.2611477,
           'class_loss': 1.9135121,
           'conf_loss': 5.7209163,
           'precision50': 0.43037686,
           'recall50': 0.4863706},
     '5': {'avg_iou': 0.85208493,
           'avg_obj': 0.65292,
           'box_loss': 0.9568648,
           'class_loss': 0.94100744,
           'conf_loss': 2.24644,
           'precision50': 0.5066003,
           'recall50': 0.650896},
     'global': {'total_loss': 28.909729},
     'learning_rate': 0.000325,
     'training_loss': 28.909729}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-290000.
 eval | step:  290000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=192.42s).
Accumulating evaluation results...
DONE (t=12.45s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.407
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.622
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.444
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.181
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.411
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.532
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.325
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.539
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.587
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.380
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.607
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.690
 eval | step:  290000 | eval time:  527.9 sec | output: 
    {'3': {'avg_iou': 0.48851615,
           'avg_obj': 0.21979263,
           'box_loss': 2.1608636,
           'class_loss': 1.4212725,
           'conf_loss': 5.7614045,
           'precision50': 0.24607658,
           'recall50': 0.2069005},
     '4': {'avg_iou': 0.7071724,
           'avg_obj': 0.4556764,
           'box_loss': 1.8954234,
           'class_loss': 1.4195106,
           'conf_loss': 5.354973,
           'precision50': 0.36143753,
           'recall50': 0.4573114},
     '5': {'avg_iou': 0.810164,
           'avg_obj': 0.6402349,
           'box_loss': 1.0639913,
           'class_loss': 0.86345315,
           'conf_loss': 2.7552884,
           'precision50': 0.42444098,
           'recall50': 0.6481759},
     'AP': 0.4073298,
     'AP50': 0.6218864,
     'AP75': 0.44380385,
     'APl': 0.5316747,
     'APm': 0.4110808,
     'APs': 0.18075186,
     'ARl': 0.68979335,
     'ARm': 0.6073086,
     'ARmax1': 0.32492527,
     'ARmax10': 0.5388382,
     'ARmax100': 0.587467,
     'ARs': 0.37982512,
     'global': {'total_loss': 22.696169},
     'validation_loss': 22.696169}I0504 15:16:26.509566 140519251994432 controller.py:211] train | step:  290000 | training until step 300000...
I0504 16:06:41.721216 140519251994432 controller.py:425] train | step:  300000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.69828796,
           'avg_obj': 0.33973604,
           'box_loss': 3.91998,
           'class_loss': 2.8354297,
           'conf_loss': 8.129942,
           'precision50': 0.33542967,
           'recall50': 0.23683403},
     '4': {'avg_iou': 0.8170756,
           'avg_obj': 0.53096384,
           'box_loss': 2.2580323,
           'class_loss': 1.9026139,
           'conf_loss': 5.7028513,
           'precision50': 0.4293809,
           'recall50': 0.48785853},
     '5': {'avg_iou': 0.85249424,
           'avg_obj': 0.6545182,
           'box_loss': 0.95391953,
           'class_loss': 0.93629855,
           'conf_loss': 2.2350416,
           'precision50': 0.50672424,
           'recall50': 0.6526137},
     'global': {'total_loss': 28.874182},
     'learning_rate': 0.000325,
     'training_loss': 28.874182}
I0504 16:07:50.636472 140519251994432 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-300000.
I0504 16:07:50.644089 140519251994432 controller.py:252]  eval | step:  300000 | running 625 steps of evaluation...
I0504 16:12:13.037544 140519251994432 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0504 16:16:21.588477 140519251994432 controller.py:261]  eval | step:  300000 | eval time:  510.9 sec | output: 
    {'3': {'avg_iou': 0.48848632,
           'avg_obj': 0.21935464,
           'box_loss': 2.1593022,
           'class_loss': 1.4181957,
           'conf_loss': 5.7649455,
           'precision50': 0.24545622,
           'recall50': 0.20525654},
     '4': {'avg_iou': 0.7074275,
           'avg_obj': 0.45726177,
           'box_loss': 1.8928003,
           'class_loss': 1.4177718,
           'conf_loss': 5.356247,
           'precision50': 0.35975233,
           'recall50': 0.46088955},
     '5': {'avg_iou': 0.8106768,
           'avg_obj': 0.64288425,
           'box_loss': 1.0609291,
           'class_loss': 0.8591206,
           'conf_loss': 2.7536283,
           'precision50': 0.4247325,
           'recall50': 0.65206635},
     'AP': 0.40757108,
     'AP50': 0.6212943,
     'AP75': 0.4439655,
     'APl': 0.5337994,
     'APm': 0.41166294,
     'APs': 0.17962475,
     'ARl': 0.6912521,
     'ARm': 0.6060181,
     'ARmax1': 0.3258324,
     'ARmax10': 0.5375812,
     'ARmax100': 0.5862439,
     'ARs': 0.36935478,
     'global': {'total_loss': 22.682953},
     'validation_loss': 22.682953}
I0504 16:16:54.779999 140519251994432 train_lib.py:123] Number of trainable params in model: 65.872064 Millions.

train | step:  290000 | training until step 300000...
train | step:  300000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.69828796,
           'avg_obj': 0.33973604,
           'box_loss': 3.91998,
           'class_loss': 2.8354297,
           'conf_loss': 8.129942,
           'precision50': 0.33542967,
           'recall50': 0.23683403},
     '4': {'avg_iou': 0.8170756,
           'avg_obj': 0.53096384,
           'box_loss': 2.2580323,
           'class_loss': 1.9026139,
           'conf_loss': 5.7028513,
           'precision50': 0.4293809,
           'recall50': 0.48785853},
     '5': {'avg_iou': 0.85249424,
           'avg_obj': 0.6545182,
           'box_loss': 0.95391953,
           'class_loss': 0.93629855,
           'conf_loss': 2.2350416,
           'precision50': 0.50672424,
           'recall50': 0.6526137},
     'global': {'total_loss': 28.874182},
     'learning_rate': 0.000325,
     'training_loss': 28.874182}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-sam/ckpt-300000.
 eval | step:  300000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=179.67s).
Accumulating evaluation results...
DONE (t=12.44s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.408
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.621
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.444
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.180
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.412
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.534
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.326
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.538
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.586
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.369
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.606
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.691
 eval | step:  300000 | eval time:  510.9 sec | output: 
    {'3': {'avg_iou': 0.48848632,
           'avg_obj': 0.21935464,
           'box_loss': 2.1593022,
           'class_loss': 1.4181957,
           'conf_loss': 5.7649455,
           'precision50': 0.24545622,
           'recall50': 0.20525654},
     '4': {'avg_iou': 0.7074275,
           'avg_obj': 0.45726177,
           'box_loss': 1.8928003,
           'class_loss': 1.4177718,
           'conf_loss': 5.356247,
           'precision50': 0.35975233,
           'recall50': 0.46088955},
     '5': {'avg_iou': 0.8106768,
           'avg_obj': 0.64288425,
           'box_loss': 1.0609291,
           'class_loss': 0.8591206,
           'conf_loss': 2.7536283,
           'precision50': 0.4247325,
           'recall50': 0.65206635},
     'AP': 0.40757108,
     'AP50': 0.6212943,
     'AP75': 0.4439655,
     'APl': 0.5337994,
     'APm': 0.41166294,
     'APs': 0.17962475,
     'ARl': 0.6912521,
     'ARm': 0.6060181,
     'ARmax1': 0.3258324,
     'ARmax10': 0.5375812,
     'ARmax100': 0.5862439,
     'ARs': 0.36935478,
     'global': {'total_loss': 22.682953},
     'validation_loss': 22.682953}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   204    0     2  100   202      7    742 --:--:-- --:--:-- --:--:--   750
okRequest issued for: [node-2]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-04T16:21:12.027244521Z'
  endTime: '2021-05-04T16:22:00.225369716Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620145272011-5c183776c3a1d-e83cd347-5c23014c
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.73.142.64/29
  createTime: '2021-03-13T00:10:24.868252445Z'
  health: HEALTHY
  ipAddress: 10.73.142.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.73.142.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-25T19:28:21.704126002Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T19:28:19Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-03-28T21:10:24.483577115Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:10:19Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T02:18:59.164603377Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T02:18:30.044758+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-30T05:32:54.575339610Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-30T05:32:31.628489+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620145272011-5c183776c3a1d-e83cd347-5c23014c] to complete...
.............................................................................................................................................................................................................................................................................done.
