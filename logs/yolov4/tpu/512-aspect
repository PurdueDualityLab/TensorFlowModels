cat: .experiment_zone: No such file or directory
Request issued for: [node-8]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619500551158-5c0ed5b10bafd-c5cfb266-4c1a85d9] to complete...
...............aborted by ctrl-c.
ERROR: (gcloud.compute.tpus.start) Aborting wait for operation https://tpu.googleapis.com/v1alpha1/projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619500551158-5c0ed5b10bafd-c5cfb266-4c1a85d9.

europe-west4-a
I0427 05:13:01.617961 139903414228800 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.3,
                                    'aug_scale_max': 2.0,
                                    'aug_scale_min': 0.1,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.1,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.213,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.3,
                                         'aug_scale_max': 2.0,
                                         'aug_scale_min': 0.1,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [240000,
                                                                                260000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.0013,
                                                                            0.000975,
                                                                            0.000655]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0427 05:13:01.619006 139903414228800 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4/tpu/512-aspect/params.yaml
I0427 05:13:03.185333 139903414228800 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0427 05:13:03.330718 139903414228800 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-8?alt=json
I0427 05:13:03.330966 139903414228800 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-8" is not yet ready; state: "STARTING"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.3, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.3, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [240000, 260000], 'values': [0.0013, 0.000975, 0.000655]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   200    0     2  100   198     11   1137 --:--:-- --:--:-- --:--:--  1149
okRequest issued for: [node-8]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-27T05:16:01.719653001Z'
  endTime: '2021-04-27T05:19:01.519203259Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-8
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619500561705-5c0ed5bb1aa96-e1f0eaf3-5f85e5a2
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.114.90.40/29
  createTime: '2021-04-13T15:27:07.102452480Z'
  health: HEALTHY
  ipAddress: 10.114.90.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-8
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.114.90.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619500561705-5c0ed5bb1aa96-e1f0eaf3-5f85e5a2] to complete...
..................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-7]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-27T05:22:47.751856732Z'
  endTime: '2021-04-27T05:23:24.054692419Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619500967736-5c0ed73e534f4-670c18b6-0bdc2240
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.124.160.48/29
  createTime: '2021-03-18T03:10:27.166064884Z'
  health: HEALTHY
  ipAddress: 10.124.160.50
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.124.160.50
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619500967736-5c0ed73e534f4-670c18b6-0bdc2240] to complete...
..............................................................................................................................................................................................done.
europe-west4-a
I0427 05:20:31.724136 140104730670912 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.3,
                                    'aug_scale_max': 2.0,
                                    'aug_scale_min': 0.1,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.1,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.213,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.3,
                                         'aug_scale_max': 2.0,
                                         'aug_scale_min': 0.1,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [240000,
                                                                                260000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.0013,
                                                                            0.000975,
                                                                            0.000655]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0427 05:20:31.726905 140104730670912 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4/tpu/512-aspect/params.yaml
I0427 05:20:32.640484 140104730670912 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0427 05:20:33.259305 140104730670912 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0427 05:20:33.259685 140104730670912 transport.py:157] Attempting refresh to obtain initial access_token
I0427 05:20:33.326601 140104730670912 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0427 05:20:33.939812 140104730670912 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0427 05:20:33.940172 140104730670912 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-27 05:20:33.994038: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0427 05:20:33.995048 140104730670912 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0427 05:20:34.139884 140104730670912 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0427 05:20:34.140165 140104730670912 transport.py:157] Attempting refresh to obtain initial access_token
I0427 05:20:34.186318 140104730670912 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0427 05:20:34.801395 140104730670912 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0427 05:20:34.801676 140104730670912 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-27 05:20:34.849283: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-27 05:20:34.860555: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.124.160.50:8470}
2021-04-27 05:20:34.860629: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:40588}
2021-04-27 05:21:06.651167: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.124.160.50:8470}
2021-04-27 05:21:06.651319: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:40588}
2021-04-27 05:21:06.651954: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:40588
I0427 05:21:06.652690 140104730670912 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-7
I0427 05:21:06.653347 140104730670912 tpu_strategy_util.py:74] Initializing the TPU system: node-7
INFO:tensorflow:Clearing out eager caches
I0427 05:21:14.537520 140104730670912 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0427 05:21:14.539805 140104730670912 tpu_strategy_util.py:133] Finished initializing TPU system.
I0427 05:21:14.541335 140104730670912 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0427 05:21:15.165001 140104730670912 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0427 05:21:15.165282 140104730670912 transport.py:157] Attempting refresh to obtain initial access_token
I0427 05:21:15.230542 140104730670912 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0427 05:21:15.847633 140104730670912 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0427 05:21:15.847945 140104730670912 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0427 05:21:15.909607 140104730670912 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0427 05:21:15.909950 140104730670912 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0427 05:21:15.910282 140104730670912 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0427 05:21:15.910351 140104730670912 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0427 05:21:15.910404 140104730670912 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0427 05:21:15.910545 140104730670912 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0427 05:21:15.910596 140104730670912 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0427 05:21:15.910643 140104730670912 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0427 05:21:15.910691 140104730670912 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0427 05:21:15.910743 140104730670912 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0427 05:21:15.910786 140104730670912 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0427 05:21:15.910827 140104730670912 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0427 05:21:15.910871 140104730670912 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0427 05:21:15.910912 140104730670912 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0427 05:21:15.910957 140104730670912 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0427 05:21:15.911001 140104730670912 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0427 05:21:15.912321 140104730670912 train_utils.py:214] Running default trainer.
2021-04-27 05:21:15.932624: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.3, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.3, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [240000, 260000], 'values': [0.0013, 0.000975, 0.000655]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05} 0.00025
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f6c445c72b0>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________
yolo_fpn (YoloFPN)              {'5': (None, 16, 16, 15165440    input_2[0][0]                    
                                                                 input_3[0][0]                    I0427 05:22:02.211312 140104730670912 controller.py:362] restoring or initializing model...
I0427 05:22:08.976252 140104730670912 yolo.py:542] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0427 05:22:08.978629 140104730670912 controller.py:368] initialized model.
I0427 05:22:08.979050 140104730670912 train_lib.py:96] Starts to execute mode: train_and_eval
I0427 05:22:08.984670 140104730670912 controller.py:211] train | step:      0 | training until step 20000...
I0427 05:22:16.456696 140104730670912 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0427 05:23:16.644619 140104730670912 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0427 06:40:37.953007 140104730670912 controller.py:425] train | step:  10000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.5546322,
           'avg_obj': 0.12836173,
           'box_loss': 6.07573,
           'class_loss': 15.569055,
           'conf_loss': 41.010284,
           'precision50': 0.17112328,
           'recall50': 0.05193781},
     '4': {'avg_iou': 0.64328486,
           'avg_obj': 0.21700364,
           'box_loss': 4.582769,
           'class_loss': 13.849636,
           'conf_loss': 17.357876,
           'precision50': 0.31026816,
           'recall50': 0.15338475},
     '5': {'avg_iou': 0.68079615,
           'avg_obj': 0.2994398,
           'box_loss': 2.1218486,
           'class_loss': 7.284657,
           'conf_loss': 6.6895385,
           'precision50': 0.39248183,
           'recall50': 0.2637354},
     'global': {'total_loss': 114.54122},
     'learning_rate': 0.0013,
     'training_loss': 114.54122}
I0427 06:41:39.209577 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-10000.
I0427 07:50:37.937031 140104730670912 controller.py:425] train | step:  20000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.61784685,
           'avg_obj': 0.18646187,
           'box_loss': 5.2512913,
           'class_loss': 5.947821,
           'conf_loss': 10.67661,
           'precision50': 0.26442996,
           'recall50': 0.09930307},
     '4': {'avg_iou': 0.7224683,
           'avg_obj': 0.3154358,
           'box_loss': 3.585787,
           'class_loss': 4.8088408,
           'conf_loss': 8.726874,
           'precision50': 0.40285602,
           'recall50': 0.26435047},
     '5': {'avg_iou': 0.75685173,
           'avg_obj': 0.41865733,
           'box_loss': 1.6206115,
           'class_loss': 2.502053,
           'conf_loss': 3.858322,
           'precision50': 0.49203852,
           'recall50': 0.41012236},
     'global': {'total_loss': 46.9782},
     'learning_rate': 0.0013,
     'training_loss': 46.9782}
I0427 07:51:30.807804 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-20000.
I0427 07:51:30.813864 140104730670912 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0427 07:51:31.439259 140104730670912 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0427 07:51:48.444429 140104730670912 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0427 07:56:45.004163 140104730670912 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0427 08:01:33.655199 140104730670912 controller.py:261]  eval | step:  20000 | eval time:  602.8 sec | output: 
    {'3': {'avg_iou': 0.46088925,
           'avg_obj': 0.14864197,
           'box_loss': 2.5072136,
           'class_loss': 2.1945207,
           'conf_loss': 6.4101324,
           'precision50': 0.21359432,
           'recall50': 0.12276935},
     '4': {'avg_iou': 0.6638513,
           'avg_obj': 0.32274944,
           'box_loss': 2.3885179,
           'class_loss': 2.2977214,
           'conf_loss': 6.2779636,
           'precision50': 0.3630971,
           'recall50': 0.31087244},
     '5': {'avg_iou': 0.7579208,
           'avg_obj': 0.48545817,
           'box_loss': 1.4088501,
           'class_loss': 1.4722366,
           'conf_loss': 3.3947446,
           'precision50': 0.47195077,
           'recall50': 0.49045104},
     'AP': 0.27344057,
     'AP50': 0.4723498,
     'AP75': 0.28226337,
     'APl': 0.35436827,
     'APm': 0.26944485,
     'APs': 0.1010169,
     'ARl': 0.5718095,
     'ARm': 0.49551442,
     'ARmax1': 0.25195998,
     'ARmax10': 0.43325785,
     'ARmax100': 0.4788201,
     'ARs': 0.27404577,
     'global': {'total_loss': 28.351906},
     'validation_loss': 28.351906}

                                                                 input_4[0][0]                    
__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'3': (None, 64, 64, 22153728    yolo_fpn[0][0]                   
                                                                 yolo_fpn[0][1]                   
                                                                 yolo_fpn[0][2]                   
==================================================================================================
Total params: 37,319,168
Trainable params: 37,288,192
Non-trainable params: 30,976
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 37319168  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 64,488,640
Trainable params: 64,422,336
Non-trainable params: 66,304
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 200, 8), 4: (8, 200, 8), 5: (8, 200, 8)}, inds: {3: (8, 200, 3), 4: (8, 200, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
train | step:  10000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.5546322,
           'avg_obj': 0.12836173,
           'box_loss': 6.07573,
           'class_loss': 15.569055,
           'conf_loss': 41.010284,
           'precision50': 0.17112328,
           'recall50': 0.05193781},
     '4': {'avg_iou': 0.64328486,
           'avg_obj': 0.21700364,
           'box_loss': 4.582769,
           'class_loss': 13.849636,
           'conf_loss': 17.357876,
           'precision50': 0.31026816,
           'recall50': 0.15338475},
     '5': {'avg_iou': 0.68079615,
           'avg_obj': 0.2994398,
           'box_loss': 2.1218486,
           'class_loss': 7.284657,
           'conf_loss': 6.6895385,
           'precision50': 0.39248183,
           'recall50': 0.2637354},
     'global': {'total_loss': 114.54122},
     'learning_rate': 0.0013,
     'training_loss': 114.54122}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-10000.
train | step:  20000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.61784685,
           'avg_obj': 0.18646187,
           'box_loss': 5.2512913,
           'class_loss': 5.947821,
           'conf_loss': 10.67661,
           'precision50': 0.26442996,
           'recall50': 0.09930307},
     '4': {'avg_iou': 0.7224683,
           'avg_obj': 0.3154358,
           'box_loss': 3.585787,
           'class_loss': 4.8088408,
           'conf_loss': 8.726874,
           'precision50': 0.40285602,
           'recall50': 0.26435047},
     '5': {'avg_iou': 0.75685173,
           'avg_obj': 0.41865733,
           'box_loss': 1.6206115,
           'class_loss': 2.502053,
           'conf_loss': 3.858322,
           'precision50': 0.49203852,
           'recall50': 0.41012236},
     'global': {'total_loss': 46.9782},
     'learning_rate': 0.0013,
     'training_loss': 46.9782}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-20000.
 eval | step:  20000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=208.78s).
Accumulating evaluation results...
DONE (t=22.74s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.273
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.472
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.282
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.101
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.269
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.354
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.252
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.433
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.479
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.274
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.496
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.572
 eval | step:  20000 | eval time:  602.8 sec | output: 
    {'3': {'avg_iou': 0.46088925,
           'avg_obj': 0.14864197,
           'box_loss': 2.5072136,
           'class_loss': 2.1945207,
           'conf_loss': 6.4101324,
           'precision50': 0.21359432,
           'recall50': 0.12276935},
     '4': {'avg_iou': 0.6638513,
           'avg_obj': 0.32274944,
           'box_loss': 2.3885179,
           'class_loss': 2.2977214,
           'conf_loss': 6.2779636,
           'precision50': 0.3630971,
           'recall50': 0.31087244},
     '5': {'avg_iou': 0.7579208,
           'avg_obj': 0.48545817,
           'box_loss': 1.4088501,
           'class_loss': 1.4722366,
           'conf_loss': 3.3947446,
           'precision50': 0.47195077,
           'recall50': 0.49045104},
     'AP': 0.27344057,
     'AP50': 0.4723498,
     'AP75': 0.28226337,
     'APl': 0.35436827,
     'APm': 0.26944485,
     'APs': 0.1010169,
     'ARl': 0.5718095,
     'ARm': 0.49551442,
     'ARmax1': 0.25195998,
     'ARmax10': 0.43325785,
     'ARmax100': 0.4788201,
     'ARs': 0.27404577,
     'global': {'total_loss': 28.351906},
     'validation_loss': 28.351906}I0427 08:01:59.108810 140104730670912 controller.py:211] train | step:  20000 | training until step 40000...
I0427 09:01:36.501530 140104730670912 controller.py:425] train | step:  30000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6341127,
           'avg_obj': 0.21227317,
           'box_loss': 5.0310802,
           'class_loss': 5.317466,
           'conf_loss': 10.323832,
           'precision50': 0.2878428,
           'recall50': 0.123217836},
     '4': {'avg_iou': 0.7428317,
           'avg_obj': 0.3536151,
           'box_loss': 3.3227944,
           'class_loss': 4.170156,
           'conf_loss': 8.237339,
           'precision50': 0.4156619,
           'recall50': 0.30748636},
     '5': {'avg_iou': 0.77702457,
           'avg_obj': 0.46262577,
           'box_loss': 1.486476,
           'class_loss': 2.1607974,
           'conf_loss': 3.570068,
           'precision50': 0.5025331,
           'recall50': 0.45938155},
     'global': {'total_loss': 43.620003},
     'learning_rate': 0.0013,
     'training_loss': 43.620003}
I0427 09:02:26.268623 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-30000.
I0427 10:04:13.203073 140104730670912 controller.py:425] train | step:  40000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.643835,
           'avg_obj': 0.22869073,
           'box_loss': 4.89796,
           'class_loss': 4.9497223,
           'conf_loss': 10.105184,
           'precision50': 0.298825,
           'recall50': 0.13889025},
     '4': {'avg_iou': 0.7545117,
           'avg_obj': 0.37842998,
           'box_loss': 3.1703103,
           'class_loss': 3.8020992,
           'conf_loss': 7.917985,
           'precision50': 0.42095307,
           'recall50': 0.3340478},
     '5': {'avg_iou': 0.78866184,
           'avg_obj': 0.48920053,
           'box_loss': 1.4076757,
           'class_loss': 1.9684426,
           'conf_loss': 3.3920343,
           'precision50': 0.5061632,
           'recall50': 0.48799995},
     'global': {'total_loss': 41.611423},
     'learning_rate': 0.0013,
     'training_loss': 41.611423}
I0427 10:05:04.126301 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-40000.
I0427 10:05:04.132602 140104730670912 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0427 10:09:22.825619 140104730670912 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0427 10:13:39.072034 140104730670912 controller.py:261]  eval | step:  40000 | eval time:  514.9 sec | output: 
    {'3': {'avg_iou': 0.4709355,
           'avg_obj': 0.17119315,
           'box_loss': 2.382575,
           'class_loss': 1.8445145,
           'conf_loss': 6.1561494,
           'precision50': 0.2310612,
           'recall50': 0.15033266},
     '4': {'avg_iou': 0.67959756,
           'avg_obj': 0.36599797,
           'box_loss': 2.211234,
           'class_loss': 1.8859067,
           'conf_loss': 5.898115,
           'precision50': 0.36570445,
           'recall50': 0.35606837},
     '5': {'avg_iou': 0.777537,
           'avg_obj': 0.5401863,
           'box_loss': 1.2799395,
           'class_loss': 1.1953348,
           'conf_loss': 3.1189094,
           'precision50': 0.46944848,
           'recall50': 0.5519098},
     'AP': 0.32541806,
     'AP50': 0.5339107,
     'AP75': 0.34631366,
     'APl': 0.42738494,
     'APm': 0.32489035,
     'APs': 0.12847711,
     'ARl': 0.6158995,
     'ARm': 0.5389589,
     'ARmax1': 0.28028506,
     'ARmax10': 0.47146785,
     'ARmax100': 0.5188679,
     'ARs': 0.3092523,
     'global': {'total_loss': 25.97267},
     'validation_loss': 25.97267}
I0427 10:13:55.422466 140104730670912 controller.py:211] train | step:  40000 | training until step 60000...
I0427 11:18:46.626324 140104730670912 controller.py:425] train | step:  50000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6503084,
           'avg_obj': 0.2405375,
           'box_loss': 4.8040037,
           'class_loss': 4.7036877,
           'conf_loss': 9.929179,
           'precision50': 0.30648524,
           'recall50': 0.15030028},
     '4': {'avg_iou': 0.762622,
           'avg_obj': 0.3951381,
           'box_loss': 3.0602794,
           'class_loss': 3.5543156,
           'conf_loss': 7.6908555,
           'precision50': 0.424426,
           'recall50': 0.3520083},
     '5': {'avg_iou': 0.7969215,
           'avg_obj': 0.5075648,
           'box_loss': 1.3515806,
           'class_loss': 1.8302201,
           'conf_loss': 3.2671108,
           'precision50': 0.507088,
           'recall50': 0.507875},
     'global': {'total_loss': 40.191265},
     'learning_rate': 0.0013,
     'training_loss': 40.191265}
I0427 11:19:36.784993 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-50000.
I0427 12:21:57.454121 140104730670912 controller.py:425] train | step:  60000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.65546995,
           'avg_obj': 0.25062153,
           'box_loss': 4.740288,
           'class_loss': 4.499652,
           'conf_loss': 9.811292,
           'precision50': 0.31238636,
           'recall50': 0.15960357},
     '4': {'avg_iou': 0.7685675,
           'avg_obj': 0.40862113,
           'box_loss': 2.987011,
           'class_loss': 3.3617754,
           'conf_loss': 7.5260296,
           'precision50': 0.42723754,
           'recall50': 0.3664405},
     '5': {'avg_iou': 0.8027815,
           'avg_obj': 0.5221077,
           'box_loss': 1.3129778,
           'class_loss': 1.7294158,
           'conf_loss': 3.1742861,
           'precision50': 0.51014787,
           'recall50': 0.52370995},
     'global': {'total_loss': 39.142754},
     'learning_rate': 0.0013,
     'training_loss': 39.142754}
I0427 12:22:48.417500 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-60000.
I0427 12:22:48.424578 140104730670912 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0427 12:27:02.497109 140104730670912 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0427 12:31:15.335192 140104730670912 controller.py:261]  eval | step:  60000 | eval time:  506.9 sec | output: 
    {'3': {'avg_iou': 0.4759409,
           'avg_obj': 0.18402998,
           'box_loss': 2.3199852,
           'class_loss': 1.6639949,
           'conf_loss': 6.0218678,
           'precision50': 0.2360242,
           'recall50': 0.16383986},
     '4': {'avg_iou': 0.68735033,
           'avg_obj': 0.38869828,
           'box_loss': 2.1194534,
           'class_loss': 1.6860178,
           'conf_loss': 5.6982827,
           'precision50': 0.37294364,
           'recall50': 0.38524795},
     '5': {'avg_iou': 0.7868913,
           'avg_obj': 0.56721795,
           'box_loss': 1.2182615,
           'class_loss': 1.0753782,
           'conf_loss': 2.97928,
           'precision50': 0.4666497,
           'recall50': 0.5808799},
     'AP': 0.3526828,
     'AP50': 0.56688714,
     'AP75': 0.37474748,
     'APl': 0.45799693,
     'APm': 0.35391042,
     'APs': 0.14598471,
     'ARl': 0.6406507,
     'ARm': 0.5594312,
     'ARmax1': 0.29295358,
     'ARmax10': 0.4915609,
     'ARmax100': 0.53913283,
     'ARs': 0.32411212,
     'global': {'total_loss': 24.782516},
     'validation_loss': 24.782516}

train | step:  20000 | training until step 40000...
train | step:  30000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6341127,
           'avg_obj': 0.21227317,
           'box_loss': 5.0310802,
           'class_loss': 5.317466,
           'conf_loss': 10.323832,
           'precision50': 0.2878428,
           'recall50': 0.123217836},
     '4': {'avg_iou': 0.7428317,
           'avg_obj': 0.3536151,
           'box_loss': 3.3227944,
           'class_loss': 4.170156,
           'conf_loss': 8.237339,
           'precision50': 0.4156619,
           'recall50': 0.30748636},
     '5': {'avg_iou': 0.77702457,
           'avg_obj': 0.46262577,
           'box_loss': 1.486476,
           'class_loss': 2.1607974,
           'conf_loss': 3.570068,
           'precision50': 0.5025331,
           'recall50': 0.45938155},
     'global': {'total_loss': 43.620003},
     'learning_rate': 0.0013,
     'training_loss': 43.620003}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-30000.
train | step:  40000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.643835,
           'avg_obj': 0.22869073,
           'box_loss': 4.89796,
           'class_loss': 4.9497223,
           'conf_loss': 10.105184,
           'precision50': 0.298825,
           'recall50': 0.13889025},
     '4': {'avg_iou': 0.7545117,
           'avg_obj': 0.37842998,
           'box_loss': 3.1703103,
           'class_loss': 3.8020992,
           'conf_loss': 7.917985,
           'precision50': 0.42095307,
           'recall50': 0.3340478},
     '5': {'avg_iou': 0.78866184,
           'avg_obj': 0.48920053,
           'box_loss': 1.4076757,
           'class_loss': 1.9684426,
           'conf_loss': 3.3920343,
           'precision50': 0.5061632,
           'recall50': 0.48799995},
     'global': {'total_loss': 41.611423},
     'learning_rate': 0.0013,
     'training_loss': 41.611423}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-40000.
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=181.77s).
Accumulating evaluation results...
DONE (t=18.35s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.325
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.534
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.346
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.128
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.325
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.427
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.280
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.471
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.519
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.309
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.539
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.616
 eval | step:  40000 | eval time:  514.9 sec | output: 
    {'3': {'avg_iou': 0.4709355,
           'avg_obj': 0.17119315,
           'box_loss': 2.382575,
           'class_loss': 1.8445145,
           'conf_loss': 6.1561494,
           'precision50': 0.2310612,
           'recall50': 0.15033266},
     '4': {'avg_iou': 0.67959756,
           'avg_obj': 0.36599797,
           'box_loss': 2.211234,
           'class_loss': 1.8859067,
           'conf_loss': 5.898115,
           'precision50': 0.36570445,
           'recall50': 0.35606837},
     '5': {'avg_iou': 0.777537,
           'avg_obj': 0.5401863,
           'box_loss': 1.2799395,
           'class_loss': 1.1953348,
           'conf_loss': 3.1189094,
           'precision50': 0.46944848,
           'recall50': 0.5519098},
     'AP': 0.32541806,
     'AP50': 0.5339107,
     'AP75': 0.34631366,
     'APl': 0.42738494,
     'APm': 0.32489035,
     'APs': 0.12847711,
     'ARl': 0.6158995,
     'ARm': 0.5389589,
     'ARmax1': 0.28028506,
     'ARmax10': 0.47146785,
     'ARmax100': 0.5188679,
     'ARs': 0.3092523,
     'global': {'total_loss': 25.97267},
     'validation_loss': 25.97267}
train | step:  40000 | training until step 60000...
train | step:  50000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6503084,
           'avg_obj': 0.2405375,
           'box_loss': 4.8040037,
           'class_loss': 4.7036877,
           'conf_loss': 9.929179,
           'precision50': 0.30648524,
           'recall50': 0.15030028},
     '4': {'avg_iou': 0.762622,
           'avg_obj': 0.3951381,
           'box_loss': 3.0602794,
           'class_loss': 3.5543156,
           'conf_loss': 7.6908555,
           'precision50': 0.424426,
           'recall50': 0.3520083},
     '5': {'avg_iou': 0.7969215,
           'avg_obj': 0.5075648,
           'box_loss': 1.3515806,
           'class_loss': 1.8302201,
           'conf_loss': 3.2671108,
           'precision50': 0.507088,
           'recall50': 0.507875},
     'global': {'total_loss': 40.191265},
     'learning_rate': 0.0013,
     'training_loss': 40.191265}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-50000.
train | step:  60000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.65546995,
           'avg_obj': 0.25062153,
           'box_loss': 4.740288,
           'class_loss': 4.499652,
           'conf_loss': 9.811292,
           'precision50': 0.31238636,
           'recall50': 0.15960357},
     '4': {'avg_iou': 0.7685675,
           'avg_obj': 0.40862113,
           'box_loss': 2.987011,
           'class_loss': 3.3617754,
           'conf_loss': 7.5260296,
           'precision50': 0.42723754,
           'recall50': 0.3664405},
     '5': {'avg_iou': 0.8027815,
           'avg_obj': 0.5221077,
           'box_loss': 1.3129778,
           'class_loss': 1.7294158,
           'conf_loss': 3.1742861,
           'precision50': 0.51014787,
           'recall50': 0.52370995},
     'global': {'total_loss': 39.142754},
     'learning_rate': 0.0013,
     'training_loss': 39.142754}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-60000.
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=178.64s).
Accumulating evaluation results...
DONE (t=15.23s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.353
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.567
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.375
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.146
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.354
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.458
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.293
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.492
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.539
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.324
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.559
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.641
 eval | step:  60000 | eval time:  506.9 sec | output: 
    {'3': {'avg_iou': 0.4759409,
           'avg_obj': 0.18402998,
           'box_loss': 2.3199852,
           'class_loss': 1.6639949,
           'conf_loss': 6.0218678,
           'precision50': 0.2360242,
           'recall50': 0.16383986},
     '4': {'avg_iou': 0.68735033,
           'avg_obj': 0.38869828,
           'box_loss': 2.1194534,
           'class_loss': 1.6860178,
           'conf_loss': 5.6982827,
           'precision50': 0.37294364,
           'recall50': 0.38524795},
     '5': {'avg_iou': 0.7868913,
           'avg_obj': 0.56721795,
           'box_loss': 1.2182615,
           'class_loss': 1.0753782,
           'conf_loss': 2.97928,
           'precision50': 0.4666497,
           'recall50': 0.5808799},
     'AP': 0.3526828,
     'AP50': 0.56688714,
     'AP75': 0.37474748,
     'APl': 0.45799693,
     'APm': 0.35391042,
     'APs': 0.14598471,
     'ARl': 0.6406507,
     'ARm': 0.5594312,
     'ARmax1': 0.29295358,
     'ARmax10': 0.4915609,
     'ARmax100': 0.53913283,
     'ARs': 0.32411212,
     'global': {'total_loss': 24.782516},
     'validation_loss': 24.782516}I0427 12:31:32.159681 140104730670912 controller.py:211] train | step:  60000 | training until step 80000...
I0427 13:36:31.263778 140104730670912 controller.py:425] train | step:  70000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6594301,
           'avg_obj': 0.25811893,
           'box_loss': 4.673189,
           'class_loss': 4.343537,
           'conf_loss': 9.684031,
           'precision50': 0.31549317,
           'recall50': 0.16666813},
     '4': {'avg_iou': 0.7733699,
           'avg_obj': 0.41893214,
           'box_loss': 2.9184127,
           'class_loss': 3.2116933,
           'conf_loss': 7.378275,
           'precision50': 0.42818776,
           'recall50': 0.37788805},
     '5': {'avg_iou': 0.80762094,
           'avg_obj': 0.5335201,
           'box_loss': 1.2798,
           'class_loss': 1.6523529,
           'conf_loss': 3.097203,
           'precision50': 0.5093607,
           'recall50': 0.535167},
     'global': {'total_loss': 38.23843},
     'learning_rate': 0.0013,
     'training_loss': 38.23843}
I0427 13:37:29.858148 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-70000.
I0427 14:39:11.814831 140104730670912 controller.py:425] train | step:  80000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.66244787,
           'avg_obj': 0.265177,
           'box_loss': 4.6470404,
           'class_loss': 4.228267,
           'conf_loss': 9.622751,
           'precision50': 0.31927156,
           'recall50': 0.17358726},
     '4': {'avg_iou': 0.7772264,
           'avg_obj': 0.42885765,
           'box_loss': 2.870225,
           'class_loss': 3.0826347,
           'conf_loss': 7.2543874,
           'precision50': 0.42973092,
           'recall50': 0.3880936},
     '5': {'avg_iou': 0.81162375,
           'avg_obj': 0.54399407,
           'box_loss': 1.2530615,
           'class_loss': 1.5810193,
           'conf_loss': 3.0272958,
           'precision50': 0.50933915,
           'recall50': 0.54500735},
     'global': {'total_loss': 37.566616},
     'learning_rate': 0.0013,
     'training_loss': 37.566616}
I0427 14:40:07.791706 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-80000.
I0427 14:40:07.797421 140104730670912 controller.py:252]  eval | step:  80000 | running 625 steps of evaluation...
I0427 14:44:26.290622 140104730670912 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0427 14:48:47.653931 140104730670912 controller.py:261]  eval | step:  80000 | eval time:  519.9 sec | output: 
    {'3': {'avg_iou': 0.47930416,
           'avg_obj': 0.19164273,
           'box_loss': 2.279712,
           'class_loss': 1.5958402,
           'conf_loss': 5.94595,
           'precision50': 0.23911074,
           'recall50': 0.1721714},
     '4': {'avg_iou': 0.6916262,
           'avg_obj': 0.40267232,
           'box_loss': 2.0633562,
           'class_loss': 1.5929999,
           'conf_loss': 5.5841365,
           'precision50': 0.3756969,
           'recall50': 0.40184233},
     '5': {'avg_iou': 0.7932876,
           'avg_obj': 0.58303094,
           'box_loss': 1.1761075,
           'class_loss': 1.0043191,
           'conf_loss': 2.8899412,
           'precision50': 0.45951846,
           'recall50': 0.5965498},
     'AP': 0.36638612,
     'AP50': 0.5821804,
     'AP75': 0.39460117,
     'APl': 0.479385,
     'APm': 0.3660331,
     'APs': 0.15344135,
     'ARl': 0.65118873,
     'ARm': 0.57145005,
     'ARmax1': 0.30068225,
     'ARmax10': 0.50495493,
     'ARmax100': 0.5515194,
     'ARs': 0.33632627,
     'global': {'total_loss': 24.132359},
     'validation_loss': 24.132359}
I0427 14:49:04.264409 140104730670912 controller.py:211] train | step:  80000 | training until step 100000...
I0427 15:56:08.236286 140104730670912 controller.py:425] train | step:  90000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.66550964,
           'avg_obj': 0.27112368,
           'box_loss': 4.6048717,
           'class_loss': 4.1149874,
           'conf_loss': 9.541716,
           'precision50': 0.3223531,
           'recall50': 0.17887004},
     '4': {'avg_iou': 0.7804362,
           'avg_obj': 0.43647936,
           'box_loss': 2.8311138,
           'class_loss': 2.9865832,
           'conf_loss': 7.1645627,
           'precision50': 0.4317275,
           'recall50': 0.39667928},
     '5': {'avg_iou': 0.8149969,
           'avg_obj': 0.5525621,
           'box_loss': 1.2305572,
           'class_loss': 1.527037,
           'conf_loss': 2.9713695,
           'precision50': 0.51043975,
           'recall50': 0.5542653},
     'global': {'total_loss': 36.972843},
     'learning_rate': 0.0013,
     'training_loss': 36.972843}
I0427 15:56:59.169944 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-90000.
I0427 16:58:42.373461 140104730670912 controller.py:425] train | step:  100000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6680547,
           'avg_obj': 0.27604458,
           'box_loss': 4.5739655,
           'class_loss': 4.022468,
           'conf_loss': 9.4850855,
           'precision50': 0.32506996,
           'recall50': 0.18355729},
     '4': {'avg_iou': 0.7834749,
           'avg_obj': 0.4439835,
           'box_loss': 2.7946868,
           'class_loss': 2.905186,
           'conf_loss': 7.078131,
           'precision50': 0.43236473,
           'recall50': 0.4041533},
     '5': {'avg_iou': 0.81798404,
           'avg_obj': 0.5606887,
           'box_loss': 1.2113698,
           'class_loss': 1.4799842,
           'conf_loss': 2.9199634,
           'precision50': 0.51084816,
           'recall50': 0.56219876},
     'global': {'total_loss': 36.47079},
     'learning_rate': 0.0013,
     'training_loss': 36.47079}
I0427 16:59:33.135356 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-100000.
I0427 16:59:33.140986 140104730670912 controller.py:252]  eval | step:  100000 | running 625 steps of evaluation...
I0427 17:03:49.107133 140104730670912 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0427 17:08:05.663740 140104730670912 controller.py:261]  eval | step:  100000 | eval time:  512.5 sec | output: 
    {'3': {'avg_iou': 0.48153585,
           'avg_obj': 0.19813818,
           'box_loss': 2.2503138,
           'class_loss': 1.5189868,
           'conf_loss': 5.8978014,
           'precision50': 0.24201179,
           'recall50': 0.18050858},
     '4': {'avg_iou': 0.695371,
           'avg_obj': 0.41450846,
           'box_loss': 2.0268905,
           'class_loss': 1.5238974,
           'conf_loss': 5.5047193,
           'precision50': 0.37564927,
           'recall50': 0.4161002},
     '5': {'avg_iou': 0.7972988,
           'avg_obj': 0.5958672,
           'box_loss': 1.1485704,
           'class_loss': 0.95559365,
           'conf_loss': 2.8325756,
           'precision50': 0.45583034,
           'recall50': 0.60930884},
     'AP': 0.37890404,
     'AP50': 0.59604186,
     'AP75': 0.40707365,
     'APl': 0.49593166,
     'APm': 0.37681374,
     'APs': 0.16778901,
     'ARl': 0.6693578,
     'ARm': 0.58057505,
     'ARmax1': 0.30879232,
     'ARmax10': 0.5141625,
     'ARmax100': 0.5614679,
     'ARs': 0.34342024,
     'global': {'total_loss': 23.65935},
     'validation_loss': 23.65935}

train | step:  60000 | training until step 80000...
train | step:  70000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6594301,
           'avg_obj': 0.25811893,
           'box_loss': 4.673189,
           'class_loss': 4.343537,
           'conf_loss': 9.684031,
           'precision50': 0.31549317,
           'recall50': 0.16666813},
     '4': {'avg_iou': 0.7733699,
           'avg_obj': 0.41893214,
           'box_loss': 2.9184127,
           'class_loss': 3.2116933,
           'conf_loss': 7.378275,
           'precision50': 0.42818776,
           'recall50': 0.37788805},
     '5': {'avg_iou': 0.80762094,
           'avg_obj': 0.5335201,
           'box_loss': 1.2798,
           'class_loss': 1.6523529,
           'conf_loss': 3.097203,
           'precision50': 0.5093607,
           'recall50': 0.535167},
     'global': {'total_loss': 38.23843},
     'learning_rate': 0.0013,
     'training_loss': 38.23843}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-70000.
train | step:  80000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.66244787,
           'avg_obj': 0.265177,
           'box_loss': 4.6470404,
           'class_loss': 4.228267,
           'conf_loss': 9.622751,
           'precision50': 0.31927156,
           'recall50': 0.17358726},
     '4': {'avg_iou': 0.7772264,
           'avg_obj': 0.42885765,
           'box_loss': 2.870225,
           'class_loss': 3.0826347,
           'conf_loss': 7.2543874,
           'precision50': 0.42973092,
           'recall50': 0.3880936},
     '5': {'avg_iou': 0.81162375,
           'avg_obj': 0.54399407,
           'box_loss': 1.2530615,
           'class_loss': 1.5810193,
           'conf_loss': 3.0272958,
           'precision50': 0.50933915,
           'recall50': 0.54500735},
     'global': {'total_loss': 37.566616},
     'learning_rate': 0.0013,
     'training_loss': 37.566616}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-80000.
 eval | step:  80000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=185.57s).
Accumulating evaluation results...
DONE (t=15.56s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.366
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.582
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.395
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.153
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.366
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.479
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.301
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.505
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.552
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.336
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.571
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.651
 eval | step:  80000 | eval time:  519.9 sec | output: 
    {'3': {'avg_iou': 0.47930416,
           'avg_obj': 0.19164273,
           'box_loss': 2.279712,
           'class_loss': 1.5958402,
           'conf_loss': 5.94595,
           'precision50': 0.23911074,
           'recall50': 0.1721714},
     '4': {'avg_iou': 0.6916262,
           'avg_obj': 0.40267232,
           'box_loss': 2.0633562,
           'class_loss': 1.5929999,
           'conf_loss': 5.5841365,
           'precision50': 0.3756969,
           'recall50': 0.40184233},
     '5': {'avg_iou': 0.7932876,
           'avg_obj': 0.58303094,
           'box_loss': 1.1761075,
           'class_loss': 1.0043191,
           'conf_loss': 2.8899412,
           'precision50': 0.45951846,
           'recall50': 0.5965498},
     'AP': 0.36638612,
     'AP50': 0.5821804,
     'AP75': 0.39460117,
     'APl': 0.479385,
     'APm': 0.3660331,
     'APs': 0.15344135,
     'ARl': 0.65118873,
     'ARm': 0.57145005,
     'ARmax1': 0.30068225,
     'ARmax10': 0.50495493,
     'ARmax100': 0.5515194,
     'ARs': 0.33632627,
     'global': {'total_loss': 24.132359},
     'validation_loss': 24.132359}
train | step:  80000 | training until step 100000...
train | step:  90000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.66550964,
           'avg_obj': 0.27112368,
           'box_loss': 4.6048717,
           'class_loss': 4.1149874,
           'conf_loss': 9.541716,
           'precision50': 0.3223531,
           'recall50': 0.17887004},
     '4': {'avg_iou': 0.7804362,
           'avg_obj': 0.43647936,
           'box_loss': 2.8311138,
           'class_loss': 2.9865832,
           'conf_loss': 7.1645627,
           'precision50': 0.4317275,
           'recall50': 0.39667928},
     '5': {'avg_iou': 0.8149969,
           'avg_obj': 0.5525621,
           'box_loss': 1.2305572,
           'class_loss': 1.527037,
           'conf_loss': 2.9713695,
           'precision50': 0.51043975,
           'recall50': 0.5542653},
     'global': {'total_loss': 36.972843},
     'learning_rate': 0.0013,
     'training_loss': 36.972843}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-90000.
train | step:  100000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6680547,
           'avg_obj': 0.27604458,
           'box_loss': 4.5739655,
           'class_loss': 4.022468,
           'conf_loss': 9.4850855,
           'precision50': 0.32506996,
           'recall50': 0.18355729},
     '4': {'avg_iou': 0.7834749,
           'avg_obj': 0.4439835,
           'box_loss': 2.7946868,
           'class_loss': 2.905186,
           'conf_loss': 7.078131,
           'precision50': 0.43236473,
           'recall50': 0.4041533},
     '5': {'avg_iou': 0.81798404,
           'avg_obj': 0.5606887,
           'box_loss': 1.2113698,
           'class_loss': 1.4799842,
           'conf_loss': 2.9199634,
           'precision50': 0.51084816,
           'recall50': 0.56219876},
     'global': {'total_loss': 36.47079},
     'learning_rate': 0.0013,
     'training_loss': 36.47079}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-100000.
 eval | step:  100000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=185.17s).
Accumulating evaluation results...
DONE (t=14.67s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.379
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.596
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.407
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.168
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.377
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.496
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.309
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.514
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.561
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.343
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.581
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.669
 eval | step:  100000 | eval time:  512.5 sec | output: 
    {'3': {'avg_iou': 0.48153585,
           'avg_obj': 0.19813818,
           'box_loss': 2.2503138,
           'class_loss': 1.5189868,
           'conf_loss': 5.8978014,
           'precision50': 0.24201179,
           'recall50': 0.18050858},
     '4': {'avg_iou': 0.695371,
           'avg_obj': 0.41450846,
           'box_loss': 2.0268905,
           'class_loss': 1.5238974,
           'conf_loss': 5.5047193,
           'precision50': 0.37564927,
           'recall50': 0.4161002},
     '5': {'avg_iou': 0.7972988,
           'avg_obj': 0.5958672,
           'box_loss': 1.1485704,
           'class_loss': 0.95559365,
           'conf_loss': 2.8325756,
           'precision50': 0.45583034,
           'recall50': 0.60930884},
     'AP': 0.37890404,
     'AP50': 0.59604186,
     'AP75': 0.40707365,
     'APl': 0.49593166,
     'APm': 0.37681374,
     'APs': 0.16778901,
     'ARl': 0.6693578,
     'ARm': 0.58057505,
     'ARmax1': 0.30879232,
     'ARmax10': 0.5141625,
     'ARmax100': 0.5614679,
     'ARs': 0.34342024,
     'global': {'total_loss': 23.65935},
     'validation_loss': 23.65935}I0427 17:08:22.737769 140104730670912 controller.py:211] train | step:  100000 | training until step 120000...
I0427 18:05:58.734686 140104730670912 controller.py:425] train | step:  110000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6703449,
           'avg_obj': 0.28089708,
           'box_loss': 4.5483413,
           'class_loss': 3.9399495,
           'conf_loss': 9.428167,
           'precision50': 0.32665431,
           'recall50': 0.18760994},
     '4': {'avg_iou': 0.7861992,
           'avg_obj': 0.45020106,
           'box_loss': 2.7649946,
           'class_loss': 2.8260958,
           'conf_loss': 7.010441,
           'precision50': 0.4333464,
           'recall50': 0.41067362},
     '5': {'avg_iou': 0.8205623,
           'avg_obj': 0.56710315,
           'box_loss': 1.1951,
           'class_loss': 1.4399166,
           'conf_loss': 2.8805363,
           'precision50': 0.5108479,
           'recall50': 0.5690309},
     'global': {'total_loss': 36.03347},
     'learning_rate': 0.0013,
     'training_loss': 36.03347}
I0427 18:06:49.593146 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-110000.
I0427 19:06:08.856177 140104730670912 controller.py:425] train | step:  120000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6720442,
           'avg_obj': 0.2850244,
           'box_loss': 4.514995,
           'class_loss': 3.8598812,
           'conf_loss': 9.352179,
           'precision50': 0.32797286,
           'recall50': 0.19204149},
     '4': {'avg_iou': 0.7880439,
           'avg_obj': 0.45670342,
           'box_loss': 2.734601,
           'class_loss': 2.74499,
           'conf_loss': 6.9122663,
           'precision50': 0.43339366,
           'recall50': 0.4173336},
     '5': {'avg_iou': 0.8226568,
           'avg_obj': 0.57363784,
           'box_loss': 1.1795175,
           'class_loss': 1.3982846,
           'conf_loss': 2.8340542,
           'precision50': 0.51107794,
           'recall50': 0.5755512},
     'global': {'total_loss': 35.530724},
     'learning_rate': 0.0013,
     'training_loss': 35.530724}
I0427 19:07:10.537305 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-120000.
I0427 19:07:10.543474 140104730670912 controller.py:252]  eval | step:  120000 | running 625 steps of evaluation...
I0427 19:11:30.021722 140104730670912 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0427 19:15:56.530328 140104730670912 controller.py:261]  eval | step:  120000 | eval time:  526.0 sec | output: 
    {'3': {'avg_iou': 0.4831664,
           'avg_obj': 0.2026716,
           'box_loss': 2.2315288,
           'class_loss': 1.4911637,
           'conf_loss': 5.8526764,
           'precision50': 0.24492131,
           'recall50': 0.18757719},
     '4': {'avg_iou': 0.69818383,
           'avg_obj': 0.42262936,
           'box_loss': 1.9988824,
           'class_loss': 1.492938,
           'conf_loss': 5.4592304,
           'precision50': 0.37260005,
           'recall50': 0.4235365},
     '5': {'avg_iou': 0.8005073,
           'avg_obj': 0.6031713,
           'box_loss': 1.1278203,
           'class_loss': 0.92541134,
           'conf_loss': 2.7870536,
           'precision50': 0.452887,
           'recall50': 0.61623144},
     'AP': 0.3875289,
     'AP50': 0.6047326,
     'AP75': 0.41872212,
     'APl': 0.5061997,
     'APm': 0.3862851,
     'APs': 0.17332834,
     'ARl': 0.6711909,
     'ARm': 0.58424556,
     'ARmax1': 0.31477144,
     'ARmax10': 0.51919836,
     'ARmax100': 0.56594574,
     'ARs': 0.35600442,
     'global': {'total_loss': 23.366693},
     'validation_loss': 23.366693}
I0427 19:16:13.391126 140104730670912 controller.py:211] train | step:  120000 | training until step 140000...
I0427 20:11:59.343065 140104730670912 controller.py:425] train | step:  130000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6735928,
           'avg_obj': 0.28891283,
           'box_loss': 4.4977756,
           'class_loss': 3.7869058,
           'conf_loss': 9.3058815,
           'precision50': 0.32990208,
           'recall50': 0.19499543},
     '4': {'avg_iou': 0.79022795,
           'avg_obj': 0.4613147,
           'box_loss': 2.70757,
           'class_loss': 2.688607,
           'conf_loss': 6.8536577,
           'precision50': 0.43360797,
           'recall50': 0.42201313},
     '5': {'avg_iou': 0.8248253,
           'avg_obj': 0.57841545,
           'box_loss': 1.1667508,
           'class_loss': 1.3688897,
           'conf_loss': 2.8066313,
           'precision50': 0.50953144,
           'recall50': 0.5796876},
     'global': {'total_loss': 35.1826},
     'learning_rate': 0.0013,
     'training_loss': 35.1826}
I0427 20:12:49.602130 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-130000.
I0427 21:12:08.936685 140104730670912 controller.py:425] train | step:  140000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6751272,
           'avg_obj': 0.2925813,
           'box_loss': 4.477701,
           'class_loss': 3.7267218,
           'conf_loss': 9.270132,
           'precision50': 0.3316134,
           'recall50': 0.19894554},
     '4': {'avg_iou': 0.7920267,
           'avg_obj': 0.46646369,
           'box_loss': 2.687839,
           'class_loss': 2.6329772,
           'conf_loss': 6.8000584,
           'precision50': 0.43480137,
           'recall50': 0.4277755},
     '5': {'avg_iou': 0.8265381,
           'avg_obj': 0.58354646,
           'box_loss': 1.155822,
           'class_loss': 1.340219,
           'conf_loss': 2.773816,
           'precision50': 0.51149714,
           'recall50': 0.58523077},
     'global': {'total_loss': 34.865242},
     'learning_rate': 0.0013,
     'training_loss': 34.865242}
I0427 21:13:00.853132 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-140000.
I0427 21:13:00.859284 140104730670912 controller.py:252]  eval | step:  140000 | running 625 steps of evaluation...
I0427 21:17:21.273707 140104730670912 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0427 21:21:42.972539 140104730670912 controller.py:261]  eval | step:  140000 | eval time:  522.1 sec | output: 
    {'3': {'avg_iou': 0.48426694,
           'avg_obj': 0.20729138,
           'box_loss': 2.2176583,
           'class_loss': 1.4653032,
           'conf_loss': 5.8350077,
           'precision50': 0.24493518,
           'recall50': 0.19302872},
     '4': {'avg_iou': 0.6997209,
           'avg_obj': 0.43022978,
           'box_loss': 1.9779842,
           'class_loss': 1.4628178,
           'conf_loss': 5.4135623,
           'precision50': 0.37368459,
           'recall50': 0.433567},
     '5': {'avg_iou': 0.8029271,
           'avg_obj': 0.6109466,
           'box_loss': 1.1106634,
           'class_loss': 0.9064586,
           'conf_loss': 2.7634685,
           'precision50': 0.44887143,
           'recall50': 0.62305075},
     'AP': 0.39277914,
     'AP50': 0.61177236,
     'AP75': 0.42750293,
     'APl': 0.5141289,
     'APm': 0.3934478,
     'APs': 0.18365932,
     'ARl': 0.6725149,
     'ARm': 0.5894054,
     'ARmax1': 0.3154828,
     'ARmax10': 0.5226732,
     'ARmax100': 0.5692969,
     'ARs': 0.37397417,
     'global': {'total_loss': 23.152933},
     'validation_loss': 23.152933}

train | step:  100000 | training until step 120000...
train | step:  110000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6703449,
           'avg_obj': 0.28089708,
           'box_loss': 4.5483413,
           'class_loss': 3.9399495,
           'conf_loss': 9.428167,
           'precision50': 0.32665431,
           'recall50': 0.18760994},
     '4': {'avg_iou': 0.7861992,
           'avg_obj': 0.45020106,
           'box_loss': 2.7649946,
           'class_loss': 2.8260958,
           'conf_loss': 7.010441,
           'precision50': 0.4333464,
           'recall50': 0.41067362},
     '5': {'avg_iou': 0.8205623,
           'avg_obj': 0.56710315,
           'box_loss': 1.1951,
           'class_loss': 1.4399166,
           'conf_loss': 2.8805363,
           'precision50': 0.5108479,
           'recall50': 0.5690309},
     'global': {'total_loss': 36.03347},
     'learning_rate': 0.0013,
     'training_loss': 36.03347}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-110000.
train | step:  120000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6720442,
           'avg_obj': 0.2850244,
           'box_loss': 4.514995,
           'class_loss': 3.8598812,
           'conf_loss': 9.352179,
           'precision50': 0.32797286,
           'recall50': 0.19204149},
     '4': {'avg_iou': 0.7880439,
           'avg_obj': 0.45670342,
           'box_loss': 2.734601,
           'class_loss': 2.74499,
           'conf_loss': 6.9122663,
           'precision50': 0.43339366,
           'recall50': 0.4173336},
     '5': {'avg_iou': 0.8226568,
           'avg_obj': 0.57363784,
           'box_loss': 1.1795175,
           'class_loss': 1.3982846,
           'conf_loss': 2.8340542,
           'precision50': 0.51107794,
           'recall50': 0.5755512},
     'global': {'total_loss': 35.530724},
     'learning_rate': 0.0013,
     'training_loss': 35.530724}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-120000.
 eval | step:  120000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=195.27s).
Accumulating evaluation results...
DONE (t=14.46s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.388
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.605
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.419
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.173
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.386
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.506
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.315
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.519
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.566
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.356
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.584
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.671
 eval | step:  120000 | eval time:  526.0 sec | output: 
    {'3': {'avg_iou': 0.4831664,
           'avg_obj': 0.2026716,
           'box_loss': 2.2315288,
           'class_loss': 1.4911637,
           'conf_loss': 5.8526764,
           'precision50': 0.24492131,
           'recall50': 0.18757719},
     '4': {'avg_iou': 0.69818383,
           'avg_obj': 0.42262936,
           'box_loss': 1.9988824,
           'class_loss': 1.492938,
           'conf_loss': 5.4592304,
           'precision50': 0.37260005,
           'recall50': 0.4235365},
     '5': {'avg_iou': 0.8005073,
           'avg_obj': 0.6031713,
           'box_loss': 1.1278203,
           'class_loss': 0.92541134,
           'conf_loss': 2.7870536,
           'precision50': 0.452887,
           'recall50': 0.61623144},
     'AP': 0.3875289,
     'AP50': 0.6047326,
     'AP75': 0.41872212,
     'APl': 0.5061997,
     'APm': 0.3862851,
     'APs': 0.17332834,
     'ARl': 0.6711909,
     'ARm': 0.58424556,
     'ARmax1': 0.31477144,
     'ARmax10': 0.51919836,
     'ARmax100': 0.56594574,
     'ARs': 0.35600442,
     'global': {'total_loss': 23.366693},
     'validation_loss': 23.366693}
train | step:  120000 | training until step 140000...
train | step:  130000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6735928,
           'avg_obj': 0.28891283,
           'box_loss': 4.4977756,
           'class_loss': 3.7869058,
           'conf_loss': 9.3058815,
           'precision50': 0.32990208,
           'recall50': 0.19499543},
     '4': {'avg_iou': 0.79022795,
           'avg_obj': 0.4613147,
           'box_loss': 2.70757,
           'class_loss': 2.688607,
           'conf_loss': 6.8536577,
           'precision50': 0.43360797,
           'recall50': 0.42201313},
     '5': {'avg_iou': 0.8248253,
           'avg_obj': 0.57841545,
           'box_loss': 1.1667508,
           'class_loss': 1.3688897,
           'conf_loss': 2.8066313,
           'precision50': 0.50953144,
           'recall50': 0.5796876},
     'global': {'total_loss': 35.1826},
     'learning_rate': 0.0013,
     'training_loss': 35.1826}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-130000.
train | step:  140000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6751272,
           'avg_obj': 0.2925813,
           'box_loss': 4.477701,
           'class_loss': 3.7267218,
           'conf_loss': 9.270132,
           'precision50': 0.3316134,
           'recall50': 0.19894554},
     '4': {'avg_iou': 0.7920267,
           'avg_obj': 0.46646369,
           'box_loss': 2.687839,
           'class_loss': 2.6329772,
           'conf_loss': 6.8000584,
           'precision50': 0.43480137,
           'recall50': 0.4277755},
     '5': {'avg_iou': 0.8265381,
           'avg_obj': 0.58354646,
           'box_loss': 1.155822,
           'class_loss': 1.340219,
           'conf_loss': 2.773816,
           'precision50': 0.51149714,
           'recall50': 0.58523077},
     'global': {'total_loss': 34.865242},
     'learning_rate': 0.0013,
     'training_loss': 34.865242}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-140000.
 eval | step:  140000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=191.31s).
Accumulating evaluation results...
DONE (t=14.06s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.393
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.612
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.428
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.184
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.393
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.514
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.315
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.523
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.569
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.374
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.589
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.673
 eval | step:  140000 | eval time:  522.1 sec | output: 
    {'3': {'avg_iou': 0.48426694,
           'avg_obj': 0.20729138,
           'box_loss': 2.2176583,
           'class_loss': 1.4653032,
           'conf_loss': 5.8350077,
           'precision50': 0.24493518,
           'recall50': 0.19302872},
     '4': {'avg_iou': 0.6997209,
           'avg_obj': 0.43022978,
           'box_loss': 1.9779842,
           'class_loss': 1.4628178,
           'conf_loss': 5.4135623,
           'precision50': 0.37368459,
           'recall50': 0.433567},
     '5': {'avg_iou': 0.8029271,
           'avg_obj': 0.6109466,
           'box_loss': 1.1106634,
           'class_loss': 0.9064586,
           'conf_loss': 2.7634685,
           'precision50': 0.44887143,
           'recall50': 0.62305075},
     'AP': 0.39277914,
     'AP50': 0.61177236,
     'AP75': 0.42750293,
     'APl': 0.5141289,
     'APm': 0.3934478,
     'APs': 0.18365932,
     'ARl': 0.6725149,
     'ARm': 0.5894054,
     'ARmax1': 0.3154828,
     'ARmax10': 0.5226732,
     'ARmax100': 0.5692969,
     'ARs': 0.37397417,
     'global': {'total_loss': 23.152933},
     'validation_loss': 23.152933}I0427 21:21:59.264611 140104730670912 controller.py:211] train | step:  140000 | training until step 160000...
I0427 22:16:08.951233 140104730670912 controller.py:425] train | step:  150000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6762037,
           'avg_obj': 0.29553202,
           'box_loss': 4.4655485,
           'class_loss': 3.6711965,
           'conf_loss': 9.2281065,
           'precision50': 0.3323475,
           'recall50': 0.20143192},
     '4': {'avg_iou': 0.7936512,
           'avg_obj': 0.471089,
           'box_loss': 2.664717,
           'class_loss': 2.5815542,
           'conf_loss': 6.735694,
           'precision50': 0.43396783,
           'recall50': 0.43217784},
     '5': {'avg_iou': 0.82827324,
           'avg_obj': 0.58893293,
           'box_loss': 1.1442572,
           'class_loss': 1.3137704,
           'conf_loss': 2.738496,
           'precision50': 0.51006204,
           'recall50': 0.5902379},
     'global': {'total_loss': 34.54323},
     'learning_rate': 0.0013,
     'training_loss': 34.54323}
I0427 22:17:01.666573 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-150000.
I0427 23:18:47.271460 140104730670912 controller.py:425] train | step:  160000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.67797875,
           'avg_obj': 0.2991634,
           'box_loss': 4.4425545,
           'class_loss': 3.618714,
           'conf_loss': 9.178933,
           'precision50': 0.3342239,
           'recall50': 0.20487069},
     '4': {'avg_iou': 0.7950731,
           'avg_obj': 0.475336,
           'box_loss': 2.6466591,
           'class_loss': 2.5308545,
           'conf_loss': 6.681943,
           'precision50': 0.43442538,
           'recall50': 0.4361271},
     '5': {'avg_iou': 0.8297529,
           'avg_obj': 0.59295624,
           'box_loss': 1.1324273,
           'class_loss': 1.287417,
           'conf_loss': 2.7074914,
           'precision50': 0.5107693,
           'recall50': 0.59443194},
     'global': {'total_loss': 34.226955},
     'learning_rate': 0.0013,
     'training_loss': 34.226955}
I0427 23:19:40.937340 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-160000.
I0427 23:19:40.943054 140104730670912 controller.py:252]  eval | step:  160000 | running 625 steps of evaluation...
I0427 23:23:59.199039 140104730670912 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0427 23:28:20.627012 140104730670912 controller.py:261]  eval | step:  160000 | eval time:  519.7 sec | output: 
    {'3': {'avg_iou': 0.4853853,
           'avg_obj': 0.20940603,
           'box_loss': 2.20451,
           'class_loss': 1.445704,
           'conf_loss': 5.8054585,
           'precision50': 0.24544764,
           'recall50': 0.19348262},
     '4': {'avg_iou': 0.7017753,
           'avg_obj': 0.4366631,
           'box_loss': 1.9563682,
           'class_loss': 1.4336599,
           'conf_loss': 5.377976,
           'precision50': 0.36959985,
           'recall50': 0.4382341},
     '5': {'avg_iou': 0.804703,
           'avg_obj': 0.6179414,
           'box_loss': 1.0998424,
           'class_loss': 0.8906074,
           'conf_loss': 2.7483187,
           'precision50': 0.4474797,
           'recall50': 0.6305481},
     'AP': 0.39864054,
     'AP50': 0.61490273,
     'AP75': 0.43137982,
     'APl': 0.5196822,
     'APm': 0.40332314,
     'APs': 0.18251513,
     'ARl': 0.6804193,
     'ARm': 0.5941919,
     'ARmax1': 0.32093883,
     'ARmax10': 0.52920413,
     'ARmax100': 0.57516015,
     'ARs': 0.37325364,
     'global': {'total_loss': 22.962425},
     'validation_loss': 22.962425}
I0427 23:28:36.938870 140104730670912 controller.py:211] train | step:  160000 | training until step 180000...
I0428 00:27:11.053458 140104730670912 controller.py:425] train | step:  170000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.67880416,
           'avg_obj': 0.3020708,
           'box_loss': 4.4262123,
           'class_loss': 3.5723548,
           'conf_loss': 9.13703,
           'precision50': 0.33448216,
           'recall50': 0.20689502},
     '4': {'avg_iou': 0.7964975,
           'avg_obj': 0.47931543,
           'box_loss': 2.624314,
           'class_loss': 2.4841373,
           'conf_loss': 6.6205,
           'precision50': 0.4351575,
           'recall50': 0.4407933},
     '5': {'avg_iou': 0.83126485,
           'avg_obj': 0.5972862,
           'box_loss': 1.1214888,
           'class_loss': 1.2588644,
           'conf_loss': 2.676524,
           'precision50': 0.5097029,
           'recall50': 0.59826916},
     'global': {'total_loss': 33.921486},
     'learning_rate': 0.0013,
     'training_loss': 33.921486}
I0428 00:28:02.287131 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-170000.
I0428 01:27:50.285166 140104730670912 controller.py:425] train | step:  180000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.68009734,
           'avg_obj': 0.30494678,
           'box_loss': 4.4081364,
           'class_loss': 3.5225704,
           'conf_loss': 9.095749,
           'precision50': 0.33579755,
           'recall50': 0.20976403},
     '4': {'avg_iou': 0.79781395,
           'avg_obj': 0.4831888,
           'box_loss': 2.6072042,
           'class_loss': 2.4488547,
           'conf_loss': 6.5725164,
           'precision50': 0.43482646,
           'recall50': 0.44517782},
     '5': {'avg_iou': 0.8327501,
           'avg_obj': 0.60155696,
           'box_loss': 1.1110111,
           'class_loss': 1.2377315,
           'conf_loss': 2.648304,
           'precision50': 0.5095492,
           'recall50': 0.6024126},
     'global': {'total_loss': 33.65199},
     'learning_rate': 0.0013,
     'training_loss': 33.65199}
I0428 01:28:41.565022 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-180000.
I0428 01:28:41.571309 140104730670912 controller.py:252]  eval | step:  180000 | running 625 steps of evaluation...
I0428 01:32:58.451321 140104730670912 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0428 01:37:06.598206 140104730670912 controller.py:261]  eval | step:  180000 | eval time:  505.0 sec | output: 
    {'3': {'avg_iou': 0.48565215,
           'avg_obj': 0.2123083,
           'box_loss': 2.1943667,
           'class_loss': 1.418621,
           'conf_loss': 5.799787,
           'precision50': 0.2450397,
           'recall50': 0.19843234},
     '4': {'avg_iou': 0.7035384,
           'avg_obj': 0.44147798,
           'box_loss': 1.9392291,
           'class_loss': 1.421208,
           'conf_loss': 5.356806,
           'precision50': 0.36747643,
           'recall50': 0.44379336},
     '5': {'avg_iou': 0.8062013,
           'avg_obj': 0.62419975,
           'box_loss': 1.0878594,
           'class_loss': 0.87124056,
           'conf_loss': 2.7337215,
           'precision50': 0.44222793,
           'recall50': 0.63566905},
     'AP': 0.40327865,
     'AP50': 0.61951274,
     'AP75': 0.43687057,
     'APl': 0.5262857,
     'APm': 0.40481895,
     'APs': 0.18503366,
     'ARl': 0.6843279,
     'ARm': 0.595477,
     'ARmax1': 0.32105443,
     'ARmax10': 0.5306168,
     'ARmax100': 0.57795435,
     'ARs': 0.38049594,
     'global': {'total_loss': 22.822832},
     'validation_loss': 22.822832}

train | step:  140000 | training until step 160000...
train | step:  150000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6762037,
           'avg_obj': 0.29553202,
           'box_loss': 4.4655485,
           'class_loss': 3.6711965,
           'conf_loss': 9.2281065,
           'precision50': 0.3323475,
           'recall50': 0.20143192},
     '4': {'avg_iou': 0.7936512,
           'avg_obj': 0.471089,
           'box_loss': 2.664717,
           'class_loss': 2.5815542,
           'conf_loss': 6.735694,
           'precision50': 0.43396783,
           'recall50': 0.43217784},
     '5': {'avg_iou': 0.82827324,
           'avg_obj': 0.58893293,
           'box_loss': 1.1442572,
           'class_loss': 1.3137704,
           'conf_loss': 2.738496,
           'precision50': 0.51006204,
           'recall50': 0.5902379},
     'global': {'total_loss': 34.54323},
     'learning_rate': 0.0013,
     'training_loss': 34.54323}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-150000.
train | step:  160000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.67797875,
           'avg_obj': 0.2991634,
           'box_loss': 4.4425545,
           'class_loss': 3.618714,
           'conf_loss': 9.178933,
           'precision50': 0.3342239,
           'recall50': 0.20487069},
     '4': {'avg_iou': 0.7950731,
           'avg_obj': 0.475336,
           'box_loss': 2.6466591,
           'class_loss': 2.5308545,
           'conf_loss': 6.681943,
           'precision50': 0.43442538,
           'recall50': 0.4361271},
     '5': {'avg_iou': 0.8297529,
           'avg_obj': 0.59295624,
           'box_loss': 1.1324273,
           'class_loss': 1.287417,
           'conf_loss': 2.7074914,
           'precision50': 0.5107693,
           'recall50': 0.59443194},
     'global': {'total_loss': 34.226955},
     'learning_rate': 0.0013,
     'training_loss': 34.226955}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-160000.
 eval | step:  160000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=187.80s).
Accumulating evaluation results...
DONE (t=13.48s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.399
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.615
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.431
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.183
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.403
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.520
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.321
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.529
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.575
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.373
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.594
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.680
 eval | step:  160000 | eval time:  519.7 sec | output: 
    {'3': {'avg_iou': 0.4853853,
           'avg_obj': 0.20940603,
           'box_loss': 2.20451,
           'class_loss': 1.445704,
           'conf_loss': 5.8054585,
           'precision50': 0.24544764,
           'recall50': 0.19348262},
     '4': {'avg_iou': 0.7017753,
           'avg_obj': 0.4366631,
           'box_loss': 1.9563682,
           'class_loss': 1.4336599,
           'conf_loss': 5.377976,
           'precision50': 0.36959985,
           'recall50': 0.4382341},
     '5': {'avg_iou': 0.804703,
           'avg_obj': 0.6179414,
           'box_loss': 1.0998424,
           'class_loss': 0.8906074,
           'conf_loss': 2.7483187,
           'precision50': 0.4474797,
           'recall50': 0.6305481},
     'AP': 0.39864054,
     'AP50': 0.61490273,
     'AP75': 0.43137982,
     'APl': 0.5196822,
     'APm': 0.40332314,
     'APs': 0.18251513,
     'ARl': 0.6804193,
     'ARm': 0.5941919,
     'ARmax1': 0.32093883,
     'ARmax10': 0.52920413,
     'ARmax100': 0.57516015,
     'ARs': 0.37325364,
     'global': {'total_loss': 22.962425},
     'validation_loss': 22.962425}
train | step:  160000 | training until step 180000...
train | step:  170000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.67880416,
           'avg_obj': 0.3020708,
           'box_loss': 4.4262123,
           'class_loss': 3.5723548,
           'conf_loss': 9.13703,
           'precision50': 0.33448216,
           'recall50': 0.20689502},
     '4': {'avg_iou': 0.7964975,
           'avg_obj': 0.47931543,
           'box_loss': 2.624314,
           'class_loss': 2.4841373,
           'conf_loss': 6.6205,
           'precision50': 0.4351575,
           'recall50': 0.4407933},
     '5': {'avg_iou': 0.83126485,
           'avg_obj': 0.5972862,
           'box_loss': 1.1214888,
           'class_loss': 1.2588644,
           'conf_loss': 2.676524,
           'precision50': 0.5097029,
           'recall50': 0.59826916},
     'global': {'total_loss': 33.921486},
     'learning_rate': 0.0013,
     'training_loss': 33.921486}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-170000.
train | step:  180000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.68009734,
           'avg_obj': 0.30494678,
           'box_loss': 4.4081364,
           'class_loss': 3.5225704,
           'conf_loss': 9.095749,
           'precision50': 0.33579755,
           'recall50': 0.20976403},
     '4': {'avg_iou': 0.79781395,
           'avg_obj': 0.4831888,
           'box_loss': 2.6072042,
           'class_loss': 2.4488547,
           'conf_loss': 6.5725164,
           'precision50': 0.43482646,
           'recall50': 0.44517782},
     '5': {'avg_iou': 0.8327501,
           'avg_obj': 0.60155696,
           'box_loss': 1.1110111,
           'class_loss': 1.2377315,
           'conf_loss': 2.648304,
           'precision50': 0.5095492,
           'recall50': 0.6024126},
     'global': {'total_loss': 33.65199},
     'learning_rate': 0.0013,
     'training_loss': 33.65199}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-180000.
 eval | step:  180000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=182.52s).
Accumulating evaluation results...
DONE (t=13.11s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.403
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.620
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.437
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.185
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.405
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.526
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.321
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.531
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.578
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.380
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.595
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.684
 eval | step:  180000 | eval time:  505.0 sec | output: 
    {'3': {'avg_iou': 0.48565215,
           'avg_obj': 0.2123083,
           'box_loss': 2.1943667,
           'class_loss': 1.418621,
           'conf_loss': 5.799787,
           'precision50': 0.2450397,
           'recall50': 0.19843234},
     '4': {'avg_iou': 0.7035384,
           'avg_obj': 0.44147798,
           'box_loss': 1.9392291,
           'class_loss': 1.421208,
           'conf_loss': 5.356806,
           'precision50': 0.36747643,
           'recall50': 0.44379336},
     '5': {'avg_iou': 0.8062013,
           'avg_obj': 0.62419975,
           'box_loss': 1.0878594,
           'class_loss': 0.87124056,
           'conf_loss': 2.7337215,
           'precision50': 0.44222793,
           'recall50': 0.63566905},
     'AP': 0.40327865,
     'AP50': 0.61951274,
     'AP75': 0.43687057,
     'APl': 0.5262857,
     'APm': 0.40481895,
     'APs': 0.18503366,
     'ARl': 0.6843279,
     'ARm': 0.595477,
     'ARmax1': 0.32105443,
     'ARmax10': 0.5306168,
     'ARmax100': 0.57795435,
     'ARs': 0.38049594,
     'global': {'total_loss': 22.822832},
     'validation_loss': 22.822832}I0428 01:37:30.342086 140104730670912 controller.py:211] train | step:  180000 | training until step 200000...
I0428 02:28:37.269659 140104730670912 controller.py:425] train | step:  190000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.68141705,
           'avg_obj': 0.30720392,
           'box_loss': 4.3897786,
           'class_loss': 3.4798996,
           'conf_loss': 9.065562,
           'precision50': 0.3372782,
           'recall50': 0.2119667},
     '4': {'avg_iou': 0.7991012,
           'avg_obj': 0.4871016,
           'box_loss': 2.5939286,
           'class_loss': 2.4111793,
           'conf_loss': 6.533295,
           'precision50': 0.43520868,
           'recall50': 0.44880435},
     '5': {'avg_iou': 0.8339813,
           'avg_obj': 0.6061388,
           'box_loss': 1.1044779,
           'class_loss': 1.2170889,
           'conf_loss': 2.6221313,
           'precision50': 0.51015085,
           'recall50': 0.60701185},
     'global': {'total_loss': 33.41735},
     'learning_rate': 0.0013,
     'training_loss': 33.41735}
I0428 02:29:28.897196 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-190000.
I0428 03:28:56.071423 140104730670912 controller.py:425] train | step:  200000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.68220973,
           'avg_obj': 0.3104239,
           'box_loss': 4.370924,
           'class_loss': 3.4311843,
           'conf_loss': 9.003644,
           'precision50': 0.33754846,
           'recall50': 0.2149506},
     '4': {'avg_iou': 0.80031,
           'avg_obj': 0.490326,
           'box_loss': 2.569646,
           'class_loss': 2.3629138,
           'conf_loss': 6.4670196,
           'precision50': 0.43445933,
           'recall50': 0.45154625},
     '5': {'avg_iou': 0.8351679,
           'avg_obj': 0.60941935,
           'box_loss': 1.0948364,
           'class_loss': 1.1955558,
           'conf_loss': 2.5956001,
           'precision50': 0.50903064,
           'recall50': 0.60938126},
     'global': {'total_loss': 33.091328},
     'learning_rate': 0.0013,
     'training_loss': 33.091328}
I0428 03:29:46.342364 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-200000.
I0428 03:29:46.348586 140104730670912 controller.py:252]  eval | step:  200000 | running 625 steps of evaluation...
I0428 03:33:59.727241 140104730670912 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0428 03:38:05.574343 140104730670912 controller.py:261]  eval | step:  200000 | eval time:  499.2 sec | output: 
    {'3': {'avg_iou': 0.48640484,
           'avg_obj': 0.21456262,
           'box_loss': 2.1870255,
           'class_loss': 1.4187222,
           'conf_loss': 5.7795963,
           'precision50': 0.24420433,
           'recall50': 0.19928072},
     '4': {'avg_iou': 0.7046626,
           'avg_obj': 0.4455201,
           'box_loss': 1.930192,
           'class_loss': 1.4162948,
           'conf_loss': 5.332841,
           'precision50': 0.366561,
           'recall50': 0.44873998},
     '5': {'avg_iou': 0.8077766,
           'avg_obj': 0.62712556,
           'box_loss': 1.0787736,
           'class_loss': 0.87635994,
           'conf_loss': 2.7272446,
           'precision50': 0.43916792,
           'recall50': 0.63874453},
     'AP': 0.40537217,
     'AP50': 0.62194514,
     'AP75': 0.43932012,
     'APl': 0.52765095,
     'APm': 0.40460733,
     'APs': 0.18567036,
     'ARl': 0.6890279,
     'ARm': 0.59657395,
     'ARmax1': 0.32372862,
     'ARmax10': 0.5335009,
     'ARmax100': 0.5803889,
     'ARs': 0.37821364,
     'global': {'total_loss': 22.747057},
     'validation_loss': 22.747057}
I0428 03:38:24.910549 140104730670912 controller.py:211] train | step:  200000 | training until step 220000...
I0428 04:29:43.328454 140104730670912 controller.py:425] train | step:  210000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.68259215,
           'avg_obj': 0.3122436,
           'box_loss': 4.3713737,
           'class_loss': 3.4049265,
           'conf_loss': 8.987835,
           'precision50': 0.3380498,
           'recall50': 0.21647517},
     '4': {'avg_iou': 0.80128723,
           'avg_obj': 0.49363935,
           'box_loss': 2.560464,
           'class_loss': 2.3283005,
           'conf_loss': 6.4352055,
           'precision50': 0.4346106,
           'recall50': 0.45453602},
     '5': {'avg_iou': 0.8361804,
           'avg_obj': 0.6129556,
           'box_loss': 1.0899787,
           'class_loss': 1.1799028,
           'conf_loss': 2.5761697,
           'precision50': 0.5086558,
           'recall50': 0.612986},
     'global': {'total_loss': 32.934277},
     'learning_rate': 0.0013,
     'training_loss': 32.934277}
I0428 04:30:39.690737 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-210000.
I0428 05:30:01.240188 140104730670912 controller.py:425] train | step:  220000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6840863,
           'avg_obj': 0.31514755,
           'box_loss': 4.3455286,
           'class_loss': 3.360029,
           'conf_loss': 8.940672,
           'precision50': 0.33919013,
           'recall50': 0.21899249},
     '4': {'avg_iou': 0.8025329,
           'avg_obj': 0.4972123,
           'box_loss': 2.547428,
           'class_loss': 2.302052,
           'conf_loss': 6.3967333,
           'precision50': 0.43524858,
           'recall50': 0.4580381},
     '5': {'avg_iou': 0.83727753,
           'avg_obj': 0.6159047,
           'box_loss': 1.0828555,
           'class_loss': 1.1622517,
           'conf_loss': 2.5570493,
           'precision50': 0.5095447,
           'recall50': 0.6156472},
     'global': {'total_loss': 32.694485},
     'learning_rate': 0.0013,
     'training_loss': 32.694485}
I0428 05:30:51.921774 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-220000.
I0428 05:30:51.927660 140104730670912 controller.py:252]  eval | step:  220000 | running 625 steps of evaluation...
I0428 05:35:13.234331 140104730670912 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0428 05:39:40.603411 140104730670912 controller.py:261]  eval | step:  220000 | eval time:  528.7 sec | output: 
    {'3': {'avg_iou': 0.48695484,
           'avg_obj': 0.21637766,
           'box_loss': 2.1803336,
           'class_loss': 1.4178847,
           'conf_loss': 5.7798066,
           'precision50': 0.24567749,
           'recall50': 0.20231369},
     '4': {'avg_iou': 0.7056162,
           'avg_obj': 0.44868234,
           'box_loss': 1.9180348,
           'class_loss': 1.4134383,
           'conf_loss': 5.332371,
           'precision50': 0.3655199,
           'recall50': 0.45364633},
     '5': {'avg_iou': 0.8086832,
           'avg_obj': 0.63055277,
           'box_loss': 1.0739027,
           'class_loss': 0.8770253,
           'conf_loss': 2.7183883,
           'precision50': 0.4403409,
           'recall50': 0.6445984},
     'AP': 0.40729037,
     'AP50': 0.6220712,
     'AP75': 0.44253322,
     'APl': 0.53026587,
     'APm': 0.40753683,
     'APs': 0.18849744,
     'ARl': 0.68412334,
     'ARm': 0.5997572,
     'ARmax1': 0.32450986,
     'ARmax10': 0.53472227,
     'ARmax100': 0.58148104,
     'ARs': 0.3890359,
     'global': {'total_loss': 22.711182},
     'validation_loss': 22.711182}

train | step:  180000 | training until step 200000...
train | step:  190000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.68141705,
           'avg_obj': 0.30720392,
           'box_loss': 4.3897786,
           'class_loss': 3.4798996,
           'conf_loss': 9.065562,
           'precision50': 0.3372782,
           'recall50': 0.2119667},
     '4': {'avg_iou': 0.7991012,
           'avg_obj': 0.4871016,
           'box_loss': 2.5939286,
           'class_loss': 2.4111793,
           'conf_loss': 6.533295,
           'precision50': 0.43520868,
           'recall50': 0.44880435},
     '5': {'avg_iou': 0.8339813,
           'avg_obj': 0.6061388,
           'box_loss': 1.1044779,
           'class_loss': 1.2170889,
           'conf_loss': 2.6221313,
           'precision50': 0.51015085,
           'recall50': 0.60701185},
     'global': {'total_loss': 33.41735},
     'learning_rate': 0.0013,
     'training_loss': 33.41735}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-190000.
train | step:  200000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.68220973,
           'avg_obj': 0.3104239,
           'box_loss': 4.370924,
           'class_loss': 3.4311843,
           'conf_loss': 9.003644,
           'precision50': 0.33754846,
           'recall50': 0.2149506},
     '4': {'avg_iou': 0.80031,
           'avg_obj': 0.490326,
           'box_loss': 2.569646,
           'class_loss': 2.3629138,
           'conf_loss': 6.4670196,
           'precision50': 0.43445933,
           'recall50': 0.45154625},
     '5': {'avg_iou': 0.8351679,
           'avg_obj': 0.60941935,
           'box_loss': 1.0948364,
           'class_loss': 1.1955558,
           'conf_loss': 2.5956001,
           'precision50': 0.50903064,
           'recall50': 0.60938126},
     'global': {'total_loss': 33.091328},
     'learning_rate': 0.0013,
     'training_loss': 33.091328}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-200000.
 eval | step:  200000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=180.21s).
Accumulating evaluation results...
DONE (t=12.87s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.405
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.622
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.439
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.186
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.405
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.528
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.324
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.534
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.580
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.378
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.597
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.689
 eval | step:  200000 | eval time:  499.2 sec | output: 
    {'3': {'avg_iou': 0.48640484,
           'avg_obj': 0.21456262,
           'box_loss': 2.1870255,
           'class_loss': 1.4187222,
           'conf_loss': 5.7795963,
           'precision50': 0.24420433,
           'recall50': 0.19928072},
     '4': {'avg_iou': 0.7046626,
           'avg_obj': 0.4455201,
           'box_loss': 1.930192,
           'class_loss': 1.4162948,
           'conf_loss': 5.332841,
           'precision50': 0.366561,
           'recall50': 0.44873998},
     '5': {'avg_iou': 0.8077766,
           'avg_obj': 0.62712556,
           'box_loss': 1.0787736,
           'class_loss': 0.87635994,
           'conf_loss': 2.7272446,
           'precision50': 0.43916792,
           'recall50': 0.63874453},
     'AP': 0.40537217,
     'AP50': 0.62194514,
     'AP75': 0.43932012,
     'APl': 0.52765095,
     'APm': 0.40460733,
     'APs': 0.18567036,
     'ARl': 0.6890279,
     'ARm': 0.59657395,
     'ARmax1': 0.32372862,
     'ARmax10': 0.5335009,
     'ARmax100': 0.5803889,
     'ARs': 0.37821364,
     'global': {'total_loss': 22.747057},
     'validation_loss': 22.747057}
train | step:  200000 | training until step 220000...
train | step:  210000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.68259215,
           'avg_obj': 0.3122436,
           'box_loss': 4.3713737,
           'class_loss': 3.4049265,
           'conf_loss': 8.987835,
           'precision50': 0.3380498,
           'recall50': 0.21647517},
     '4': {'avg_iou': 0.80128723,
           'avg_obj': 0.49363935,
           'box_loss': 2.560464,
           'class_loss': 2.3283005,
           'conf_loss': 6.4352055,
           'precision50': 0.4346106,
           'recall50': 0.45453602},
     '5': {'avg_iou': 0.8361804,
           'avg_obj': 0.6129556,
           'box_loss': 1.0899787,
           'class_loss': 1.1799028,
           'conf_loss': 2.5761697,
           'precision50': 0.5086558,
           'recall50': 0.612986},
     'global': {'total_loss': 32.934277},
     'learning_rate': 0.0013,
     'training_loss': 32.934277}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-210000.
train | step:  220000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6840863,
           'avg_obj': 0.31514755,
           'box_loss': 4.3455286,
           'class_loss': 3.360029,
           'conf_loss': 8.940672,
           'precision50': 0.33919013,
           'recall50': 0.21899249},
     '4': {'avg_iou': 0.8025329,
           'avg_obj': 0.4972123,
           'box_loss': 2.547428,
           'class_loss': 2.302052,
           'conf_loss': 6.3967333,
           'precision50': 0.43524858,
           'recall50': 0.4580381},
     '5': {'avg_iou': 0.83727753,
           'avg_obj': 0.6159047,
           'box_loss': 1.0828555,
           'class_loss': 1.1622517,
           'conf_loss': 2.5570493,
           'precision50': 0.5095447,
           'recall50': 0.6156472},
     'global': {'total_loss': 32.694485},
     'learning_rate': 0.0013,
     'training_loss': 32.694485}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-220000.
 eval | step:  220000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=194.68s).
Accumulating evaluation results...
DONE (t=13.06s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.407
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.622
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.443
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.188
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.408
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.530
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.325
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.535
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.581
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.389
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.600
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.684
 eval | step:  220000 | eval time:  528.7 sec | output: 
    {'3': {'avg_iou': 0.48695484,
           'avg_obj': 0.21637766,
           'box_loss': 2.1803336,
           'class_loss': 1.4178847,
           'conf_loss': 5.7798066,
           'precision50': 0.24567749,
           'recall50': 0.20231369},
     '4': {'avg_iou': 0.7056162,
           'avg_obj': 0.44868234,
           'box_loss': 1.9180348,
           'class_loss': 1.4134383,
           'conf_loss': 5.332371,
           'precision50': 0.3655199,
           'recall50': 0.45364633},
     '5': {'avg_iou': 0.8086832,
           'avg_obj': 0.63055277,
           'box_loss': 1.0739027,
           'class_loss': 0.8770253,
           'conf_loss': 2.7183883,
           'precision50': 0.4403409,
           'recall50': 0.6445984},
     'AP': 0.40729037,
     'AP50': 0.6220712,
     'AP75': 0.44253322,
     'APl': 0.53026587,
     'APm': 0.40753683,
     'APs': 0.18849744,
     'ARl': 0.68412334,
     'ARm': 0.5997572,
     'ARmax1': 0.32450986,
     'ARmax10': 0.53472227,
     'ARmax100': 0.58148104,
     'ARs': 0.3890359,
     'global': {'total_loss': 22.711182},
     'validation_loss': 22.711182}I0428 05:40:02.185030 140104730670912 controller.py:211] train | step:  220000 | training until step 240000...
I0428 06:30:56.125236 140104730670912 controller.py:425] train | step:  230000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6846833,
           'avg_obj': 0.3168258,
           'box_loss': 4.3501244,
           'class_loss': 3.3344343,
           'conf_loss': 8.945943,
           'precision50': 0.33983275,
           'recall50': 0.22062512},
     '4': {'avg_iou': 0.8033488,
           'avg_obj': 0.5003897,
           'box_loss': 2.5388448,
           'class_loss': 2.2745733,
           'conf_loss': 6.3612494,
           'precision50': 0.43470654,
           'recall50': 0.461362},
     '5': {'avg_iou': 0.83816445,
           'avg_obj': 0.6192723,
           'box_loss': 1.0765043,
           'class_loss': 1.1482029,
           'conf_loss': 2.53632,
           'precision50': 0.50843346,
           'recall50': 0.6189417},
     'global': {'total_loss': 32.566223},
     'learning_rate': 0.0013,
     'training_loss': 32.566223}
I0428 06:31:48.071365 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-230000.
I0428 07:31:11.564931 140104730670912 controller.py:425] train | step:  240000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.68549246,
           'avg_obj': 0.31936556,
           'box_loss': 4.3512316,
           'class_loss': 3.3170562,
           'conf_loss': 8.938065,
           'precision50': 0.34142962,
           'recall50': 0.22321723},
     '4': {'avg_iou': 0.80415833,
           'avg_obj': 0.5031273,
           'box_loss': 2.533921,
           'class_loss': 2.2603097,
           'conf_loss': 6.339057,
           'precision50': 0.43527052,
           'recall50': 0.4643727},
     '5': {'avg_iou': 0.839098,
           'avg_obj': 0.62259895,
           'box_loss': 1.0721782,
           'class_loss': 1.138564,
           'conf_loss': 2.5188522,
           'precision50': 0.5079105,
           'recall50': 0.6221289},
     'global': {'total_loss': 32.469177},
     'learning_rate': 0.0013,
     'training_loss': 32.469177}
I0428 07:32:04.772960 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-240000.
I0428 07:32:04.780020 140104730670912 controller.py:252]  eval | step:  240000 | running 625 steps of evaluation...
I0428 07:36:29.264142 140104730670912 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0428 07:41:00.639156 140104730670912 controller.py:261]  eval | step:  240000 | eval time:  535.9 sec | output: 
    {'3': {'avg_iou': 0.48734027,
           'avg_obj': 0.21735063,
           'box_loss': 2.1746247,
           'class_loss': 1.4128222,
           'conf_loss': 5.7652025,
           'precision50': 0.2500225,
           'recall50': 0.20509502},
     '4': {'avg_iou': 0.7066383,
           'avg_obj': 0.45243922,
           'box_loss': 1.9096931,
           'class_loss': 1.4221829,
           'conf_loss': 5.3267217,
           'precision50': 0.36451387,
           'recall50': 0.45597255},
     '5': {'avg_iou': 0.8097244,
           'avg_obj': 0.63500726,
           'box_loss': 1.0668262,
           'class_loss': 0.8793087,
           'conf_loss': 2.727015,
           'precision50': 0.43489185,
           'recall50': 0.6474449},
     'AP': 0.40907344,
     'AP50': 0.62411505,
     'AP75': 0.44586012,
     'APl': 0.53263587,
     'APm': 0.4099024,
     'APs': 0.18482625,
     'ARl': 0.6916276,
     'ARm': 0.60200167,
     'ARmax1': 0.32642365,
     'ARmax10': 0.5371178,
     'ARmax100': 0.58446455,
     'ARs': 0.38746223,
     'global': {'total_loss': 22.684387},
     'validation_loss': 22.684387}
I0428 07:41:18.470266 140104730670912 controller.py:211] train | step:  240000 | training until step 260000...
I0428 08:32:13.310782 140104730670912 controller.py:425] train | step:  250000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6892834,
           'avg_obj': 0.32742035,
           'box_loss': 4.2923036,
           'class_loss': 3.185081,
           'conf_loss': 8.804357,
           'precision50': 0.34333575,
           'recall50': 0.23084077},
     '4': {'avg_iou': 0.80865663,
           'avg_obj': 0.5143146,
           'box_loss': 2.4669209,
           'class_loss': 2.1379883,
           'conf_loss': 6.174809,
           'precision50': 0.43467948,
           'recall50': 0.47598878},
     '5': {'avg_iou': 0.8436956,
           'avg_obj': 0.63426113,
           'box_loss': 1.0396452,
           'class_loss': 1.0733252,
           'conf_loss': 2.4361405,
           'precision50': 0.5063643,
           'recall50': 0.6328193},
     'global': {'total_loss': 31.610573},
     'learning_rate': 0.000975,
     'training_loss': 31.610573}
I0428 08:33:04.848136 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-250000.
I0428 09:32:47.489650 140104730670912 controller.py:425] train | step:  260000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.68988323,
           'avg_obj': 0.32994068,
           'box_loss': 4.2809296,
           'class_loss': 3.1448882,
           'conf_loss': 8.777303,
           'precision50': 0.344047,
           'recall50': 0.23301302},
     '4': {'avg_iou': 0.8094598,
           'avg_obj': 0.5184336,
           'box_loss': 2.4612646,
           'class_loss': 2.1065068,
           'conf_loss': 6.136197,
           'precision50': 0.43503717,
           'recall50': 0.47992793},
     '5': {'avg_iou': 0.844537,
           'avg_obj': 0.63839793,
           'box_loss': 1.0343398,
           'class_loss': 1.0527271,
           'conf_loss': 2.409722,
           'precision50': 0.50733376,
           'recall50': 0.63721144},
     'global': {'total_loss': 31.403772},
     'learning_rate': 0.000975,
     'training_loss': 31.403772}
I0428 09:33:39.687271 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-260000.
I0428 09:33:39.693737 140104730670912 controller.py:252]  eval | step:  260000 | running 625 steps of evaluation...
I0428 09:38:11.653579 140104730670912 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0428 09:42:20.923442 140104730670912 controller.py:261]  eval | step:  260000 | eval time:  521.2 sec | output: 
    {'3': {'avg_iou': 0.4880873,
           'avg_obj': 0.21850967,
           'box_loss': 2.1683977,
           'class_loss': 1.4337263,
           'conf_loss': 5.7633295,
           'precision50': 0.24409443,
           'recall50': 0.20471409},
     '4': {'avg_iou': 0.7069027,
           'avg_obj': 0.4559077,
           'box_loss': 1.9066657,
           'class_loss': 1.4279513,
           'conf_loss': 5.319128,
           'precision50': 0.35711437,
           'recall50': 0.4591794},
     '5': {'avg_iou': 0.8099345,
           'avg_obj': 0.63928777,
           'box_loss': 1.0658416,
           'class_loss': 0.87994045,
           'conf_loss': 2.731529,
           'precision50': 0.43045166,
           'recall50': 0.6507632},
     'AP': 0.40997264,
     'AP50': 0.62567383,
     'AP75': 0.44602853,
     'APl': 0.53257823,
     'APm': 0.41143134,
     'APs': 0.1912729,
     'ARl': 0.6901864,
     'ARm': 0.5997086,
     'ARmax1': 0.32758835,
     'ARmax10': 0.5367779,
     'ARmax100': 0.58395725,
     'ARs': 0.3895914,
     'global': {'total_loss': 22.696518},
     'validation_loss': 22.696518}

train | step:  220000 | training until step 240000...
train | step:  230000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6846833,
           'avg_obj': 0.3168258,
           'box_loss': 4.3501244,
           'class_loss': 3.3344343,
           'conf_loss': 8.945943,
           'precision50': 0.33983275,
           'recall50': 0.22062512},
     '4': {'avg_iou': 0.8033488,
           'avg_obj': 0.5003897,
           'box_loss': 2.5388448,
           'class_loss': 2.2745733,
           'conf_loss': 6.3612494,
           'precision50': 0.43470654,
           'recall50': 0.461362},
     '5': {'avg_iou': 0.83816445,
           'avg_obj': 0.6192723,
           'box_loss': 1.0765043,
           'class_loss': 1.1482029,
           'conf_loss': 2.53632,
           'precision50': 0.50843346,
           'recall50': 0.6189417},
     'global': {'total_loss': 32.566223},
     'learning_rate': 0.0013,
     'training_loss': 32.566223}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-230000.
train | step:  240000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.68549246,
           'avg_obj': 0.31936556,
           'box_loss': 4.3512316,
           'class_loss': 3.3170562,
           'conf_loss': 8.938065,
           'precision50': 0.34142962,
           'recall50': 0.22321723},
     '4': {'avg_iou': 0.80415833,
           'avg_obj': 0.5031273,
           'box_loss': 2.533921,
           'class_loss': 2.2603097,
           'conf_loss': 6.339057,
           'precision50': 0.43527052,
           'recall50': 0.4643727},
     '5': {'avg_iou': 0.839098,
           'avg_obj': 0.62259895,
           'box_loss': 1.0721782,
           'class_loss': 1.138564,
           'conf_loss': 2.5188522,
           'precision50': 0.5079105,
           'recall50': 0.6221289},
     'global': {'total_loss': 32.469177},
     'learning_rate': 0.0013,
     'training_loss': 32.469177}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-240000.
 eval | step:  240000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=196.54s).
Accumulating evaluation results...
DONE (t=14.45s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.409
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.624
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.446
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.185
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.410
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.533
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.326
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.537
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.584
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.387
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.602
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.692
 eval | step:  240000 | eval time:  535.9 sec | output: 
    {'3': {'avg_iou': 0.48734027,
           'avg_obj': 0.21735063,
           'box_loss': 2.1746247,
           'class_loss': 1.4128222,
           'conf_loss': 5.7652025,
           'precision50': 0.2500225,
           'recall50': 0.20509502},
     '4': {'avg_iou': 0.7066383,
           'avg_obj': 0.45243922,
           'box_loss': 1.9096931,
           'class_loss': 1.4221829,
           'conf_loss': 5.3267217,
           'precision50': 0.36451387,
           'recall50': 0.45597255},
     '5': {'avg_iou': 0.8097244,
           'avg_obj': 0.63500726,
           'box_loss': 1.0668262,
           'class_loss': 0.8793087,
           'conf_loss': 2.727015,
           'precision50': 0.43489185,
           'recall50': 0.6474449},
     'AP': 0.40907344,
     'AP50': 0.62411505,
     'AP75': 0.44586012,
     'APl': 0.53263587,
     'APm': 0.4099024,
     'APs': 0.18482625,
     'ARl': 0.6916276,
     'ARm': 0.60200167,
     'ARmax1': 0.32642365,
     'ARmax10': 0.5371178,
     'ARmax100': 0.58446455,
     'ARs': 0.38746223,
     'global': {'total_loss': 22.684387},
     'validation_loss': 22.684387}
train | step:  240000 | training until step 260000...
train | step:  250000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6892834,
           'avg_obj': 0.32742035,
           'box_loss': 4.2923036,
           'class_loss': 3.185081,
           'conf_loss': 8.804357,
           'precision50': 0.34333575,
           'recall50': 0.23084077},
     '4': {'avg_iou': 0.80865663,
           'avg_obj': 0.5143146,
           'box_loss': 2.4669209,
           'class_loss': 2.1379883,
           'conf_loss': 6.174809,
           'precision50': 0.43467948,
           'recall50': 0.47598878},
     '5': {'avg_iou': 0.8436956,
           'avg_obj': 0.63426113,
           'box_loss': 1.0396452,
           'class_loss': 1.0733252,
           'conf_loss': 2.4361405,
           'precision50': 0.5063643,
           'recall50': 0.6328193},
     'global': {'total_loss': 31.610573},
     'learning_rate': 0.000975,
     'training_loss': 31.610573}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-250000.
train | step:  260000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.68988323,
           'avg_obj': 0.32994068,
           'box_loss': 4.2809296,
           'class_loss': 3.1448882,
           'conf_loss': 8.777303,
           'precision50': 0.344047,
           'recall50': 0.23301302},
     '4': {'avg_iou': 0.8094598,
           'avg_obj': 0.5184336,
           'box_loss': 2.4612646,
           'class_loss': 2.1065068,
           'conf_loss': 6.136197,
           'precision50': 0.43503717,
           'recall50': 0.47992793},
     '5': {'avg_iou': 0.844537,
           'avg_obj': 0.63839793,
           'box_loss': 1.0343398,
           'class_loss': 1.0527271,
           'conf_loss': 2.409722,
           'precision50': 0.50733376,
           'recall50': 0.63721144},
     'global': {'total_loss': 31.403772},
     'learning_rate': 0.000975,
     'training_loss': 31.403772}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-260000.
 eval | step:  260000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=183.22s).
Accumulating evaluation results...
DONE (t=13.17s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.410
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.626
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.446
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.191
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.411
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.533
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.328
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.537
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.584
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.390
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.600
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.690
 eval | step:  260000 | eval time:  521.2 sec | output: 
    {'3': {'avg_iou': 0.4880873,
           'avg_obj': 0.21850967,
           'box_loss': 2.1683977,
           'class_loss': 1.4337263,
           'conf_loss': 5.7633295,
           'precision50': 0.24409443,
           'recall50': 0.20471409},
     '4': {'avg_iou': 0.7069027,
           'avg_obj': 0.4559077,
           'box_loss': 1.9066657,
           'class_loss': 1.4279513,
           'conf_loss': 5.319128,
           'precision50': 0.35711437,
           'recall50': 0.4591794},
     '5': {'avg_iou': 0.8099345,
           'avg_obj': 0.63928777,
           'box_loss': 1.0658416,
           'class_loss': 0.87994045,
           'conf_loss': 2.731529,
           'precision50': 0.43045166,
           'recall50': 0.6507632},
     'AP': 0.40997264,
     'AP50': 0.62567383,
     'AP75': 0.44602853,
     'APl': 0.53257823,
     'APm': 0.41143134,
     'APs': 0.1912729,
     'ARl': 0.6901864,
     'ARm': 0.5997086,
     'ARmax1': 0.32758835,
     'ARmax10': 0.5367779,
     'ARmax100': 0.58395725,
     'ARs': 0.3895914,
     'global': {'total_loss': 22.696518},
     'validation_loss': 22.696518}I0428 09:42:41.121578 140104730670912 controller.py:211] train | step:  260000 | training until step 280000...
I0428 10:33:48.465685 140104730670912 controller.py:425] train | step:  270000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.69344896,
           'avg_obj': 0.33879143,
           'box_loss': 4.2370577,
           'class_loss': 3.034379,
           'conf_loss': 8.667273,
           'precision50': 0.3459417,
           'recall50': 0.24044296},
     '4': {'avg_iou': 0.8131668,
           'avg_obj': 0.52900296,
           'box_loss': 2.4122403,
           'class_loss': 2.0069556,
           'conf_loss': 5.992541,
           'precision50': 0.43487164,
           'recall50': 0.4905358},
     '5': {'avg_iou': 0.84838885,
           'avg_obj': 0.65002996,
           'box_loss': 1.0082101,
           'class_loss': 0.99702394,
           'conf_loss': 2.3312185,
           'precision50': 0.5057642,
           'recall50': 0.6475314},
     'global': {'total_loss': 30.686892},
     'learning_rate': 0.000655,
     'training_loss': 30.686892}
I0428 10:34:38.914186 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-270000.
I0428 11:34:17.050949 140104730670912 controller.py:425] train | step:  280000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6939566,
           'avg_obj': 0.34067953,
           'box_loss': 4.232119,
           'class_loss': 3.002132,
           'conf_loss': 8.642701,
           'precision50': 0.34637207,
           'recall50': 0.24276118},
     '4': {'avg_iou': 0.81405467,
           'avg_obj': 0.53265953,
           'box_loss': 2.4010673,
           'class_loss': 1.9776483,
           'conf_loss': 5.9491644,
           'precision50': 0.4344838,
           'recall50': 0.49368834},
     '5': {'avg_iou': 0.84916043,
           'avg_obj': 0.6537131,
           'box_loss': 1.0038137,
           'class_loss': 0.98331565,
           'conf_loss': 2.3081887,
           'precision50': 0.5061446,
           'recall50': 0.6512891},
     'global': {'total_loss': 30.500132},
     'learning_rate': 0.000655,
     'training_loss': 30.500132}
I0428 11:35:09.250919 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-280000.
I0428 11:35:09.256982 140104730670912 controller.py:252]  eval | step:  280000 | running 625 steps of evaluation...
I0428 11:39:27.806821 140104730670912 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0428 11:43:46.563945 140104730670912 controller.py:261]  eval | step:  280000 | eval time:  517.3 sec | output: 
    {'3': {'avg_iou': 0.48812452,
           'avg_obj': 0.22114241,
           'box_loss': 2.1660237,
           'class_loss': 1.4482878,
           'conf_loss': 5.7771387,
           'precision50': 0.24391931,
           'recall50': 0.20776807},
     '4': {'avg_iou': 0.7072483,
           'avg_obj': 0.45948398,
           'box_loss': 1.9022293,
           'class_loss': 1.444252,
           'conf_loss': 5.34816,
           'precision50': 0.35699835,
           'recall50': 0.46282026},
     '5': {'avg_iou': 0.8103577,
           'avg_obj': 0.64456016,
           'box_loss': 1.0617583,
           'class_loss': 0.88288635,
           'conf_loss': 2.7520165,
           'precision50': 0.42723754,
           'recall50': 0.65675396},
     'AP': 0.4088483,
     'AP50': 0.62465596,
     'AP75': 0.4471667,
     'APl': 0.53048587,
     'APm': 0.40977046,
     'APs': 0.18707125,
     'ARl': 0.68539363,
     'ARm': 0.59543544,
     'ARmax1': 0.32529593,
     'ARmax10': 0.5338254,
     'ARmax100': 0.57998693,
     'ARs': 0.38344112,
     'global': {'total_loss': 22.782755},
     'validation_loss': 22.782755}
I0428 11:44:04.302079 140104730670912 controller.py:211] train | step:  280000 | training until step 300000...
I0428 12:35:24.894261 140104730670912 controller.py:425] train | step:  290000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.69423807,
           'avg_obj': 0.34248435,
           'box_loss': 4.2096844,
           'class_loss': 2.9759915,
           'conf_loss': 8.590347,
           'precision50': 0.34689617,
           'recall50': 0.24424319},
     '4': {'avg_iou': 0.8145478,
           'avg_obj': 0.53418005,
           'box_loss': 2.3921578,
           'class_loss': 1.9625669,
           'conf_loss': 5.923679,
           'precision50': 0.43448734,
           'recall50': 0.49558222},
     '5': {'avg_iou': 0.84973204,
           'avg_obj': 0.65541375,
           'box_loss': 0.99992716,
           'class_loss': 0.97348565,
           'conf_loss': 2.2970157,
           'precision50': 0.50501364,
           'recall50': 0.65220696},
     'global': {'total_loss': 30.324793},
     'learning_rate': 0.000655,
     'training_loss': 30.324793}
I0428 12:36:16.908435 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-290000.
I0428 13:35:55.415978 140104730670912 controller.py:425] train | step:  300000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6945974,
           'avg_obj': 0.34438652,
           'box_loss': 4.2227783,
           'class_loss': 2.9625227,
           'conf_loss': 8.600135,
           'precision50': 0.3478711,
           'recall50': 0.24587806},
     '4': {'avg_iou': 0.8149459,
           'avg_obj': 0.5372564,
           'box_loss': 2.389305,
           'class_loss': 1.9451988,
           'conf_loss': 5.8914127,
           'precision50': 0.43372372,
           'recall50': 0.4983315},
     '5': {'avg_iou': 0.8502496,
           'avg_obj': 0.6582598,
           'box_loss': 0.99564856,
           'class_loss': 0.9651595,
           'conf_loss': 2.2770486,
           'precision50': 0.50415444,
           'recall50': 0.65490335},
     'global': {'total_loss': 30.249182},
     'learning_rate': 0.000655,
     'training_loss': 30.249182}
I0428 13:36:46.676786 140104730670912 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-300000.
I0428 13:36:46.684310 140104730670912 controller.py:252]  eval | step:  300000 | running 625 steps of evaluation...
I0428 13:41:14.949714 140104730670912 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0428 13:45:28.092417 140104730670912 controller.py:261]  eval | step:  300000 | eval time:  521.4 sec | output: 
    {'3': {'avg_iou': 0.48848173,
           'avg_obj': 0.22156914,
           'box_loss': 2.1614947,
           'class_loss': 1.4465173,
           'conf_loss': 5.7660103,
           'precision50': 0.24387133,
           'recall50': 0.20966694},
     '4': {'avg_iou': 0.70748556,
           'avg_obj': 0.4604782,
           'box_loss': 1.8979057,
           'class_loss': 1.4518915,
           'conf_loss': 5.347697,
           'precision50': 0.3518391,
           'recall50': 0.46221134},
     '5': {'avg_iou': 0.8108303,
           'avg_obj': 0.64655936,
           'box_loss': 1.0588936,
           'class_loss': 0.8807774,
           'conf_loss': 2.7605217,
           'precision50': 0.42017797,
           'recall50': 0.65674967},
     'AP': 0.4107571,
     'AP50': 0.6262757,
     'AP75': 0.44810233,
     'APl': 0.53099257,
     'APm': 0.41243488,
     'APs': 0.19045678,
     'ARl': 0.6879572,
     'ARm': 0.5965776,
     'ARmax1': 0.3271002,
     'ARmax10': 0.5355774,
     'ARmax100': 0.5820224,
     'ARs': 0.38842076,
     'global': {'total_loss': 22.771706},
     'validation_loss': 22.771706}

train | step:  260000 | training until step 280000...
train | step:  270000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.69344896,
           'avg_obj': 0.33879143,
           'box_loss': 4.2370577,
           'class_loss': 3.034379,
           'conf_loss': 8.667273,
           'precision50': 0.3459417,
           'recall50': 0.24044296},
     '4': {'avg_iou': 0.8131668,
           'avg_obj': 0.52900296,
           'box_loss': 2.4122403,
           'class_loss': 2.0069556,
           'conf_loss': 5.992541,
           'precision50': 0.43487164,
           'recall50': 0.4905358},
     '5': {'avg_iou': 0.84838885,
           'avg_obj': 0.65002996,
           'box_loss': 1.0082101,
           'class_loss': 0.99702394,
           'conf_loss': 2.3312185,
           'precision50': 0.5057642,
           'recall50': 0.6475314},
     'global': {'total_loss': 30.686892},
     'learning_rate': 0.000655,
     'training_loss': 30.686892}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-270000.
train | step:  280000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6939566,
           'avg_obj': 0.34067953,
           'box_loss': 4.232119,
           'class_loss': 3.002132,
           'conf_loss': 8.642701,
           'precision50': 0.34637207,
           'recall50': 0.24276118},
     '4': {'avg_iou': 0.81405467,
           'avg_obj': 0.53265953,
           'box_loss': 2.4010673,
           'class_loss': 1.9776483,
           'conf_loss': 5.9491644,
           'precision50': 0.4344838,
           'recall50': 0.49368834},
     '5': {'avg_iou': 0.84916043,
           'avg_obj': 0.6537131,
           'box_loss': 1.0038137,
           'class_loss': 0.98331565,
           'conf_loss': 2.3081887,
           'precision50': 0.5061446,
           'recall50': 0.6512891},
     'global': {'total_loss': 30.500132},
     'learning_rate': 0.000655,
     'training_loss': 30.500132}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-280000.
 eval | step:  280000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=183.24s).
Accumulating evaluation results...
DONE (t=12.13s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.409
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.625
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.447
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.187
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.410
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.530
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.325
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.534
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.580
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.383
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.595
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.685
 eval | step:  280000 | eval time:  517.3 sec | output: 
    {'3': {'avg_iou': 0.48812452,
           'avg_obj': 0.22114241,
           'box_loss': 2.1660237,
           'class_loss': 1.4482878,
           'conf_loss': 5.7771387,
           'precision50': 0.24391931,
           'recall50': 0.20776807},
     '4': {'avg_iou': 0.7072483,
           'avg_obj': 0.45948398,
           'box_loss': 1.9022293,
           'class_loss': 1.444252,
           'conf_loss': 5.34816,
           'precision50': 0.35699835,
           'recall50': 0.46282026},
     '5': {'avg_iou': 0.8103577,
           'avg_obj': 0.64456016,
           'box_loss': 1.0617583,
           'class_loss': 0.88288635,
           'conf_loss': 2.7520165,
           'precision50': 0.42723754,
           'recall50': 0.65675396},
     'AP': 0.4088483,
     'AP50': 0.62465596,
     'AP75': 0.4471667,
     'APl': 0.53048587,
     'APm': 0.40977046,
     'APs': 0.18707125,
     'ARl': 0.68539363,
     'ARm': 0.59543544,
     'ARmax1': 0.32529593,
     'ARmax10': 0.5338254,
     'ARmax100': 0.57998693,
     'ARs': 0.38344112,
     'global': {'total_loss': 22.782755},
     'validation_loss': 22.782755}
train | step:  280000 | training until step 300000...
train | step:  290000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.69423807,
           'avg_obj': 0.34248435,
           'box_loss': 4.2096844,
           'class_loss': 2.9759915,
           'conf_loss': 8.590347,
           'precision50': 0.34689617,
           'recall50': 0.24424319},
     '4': {'avg_iou': 0.8145478,
           'avg_obj': 0.53418005,
           'box_loss': 2.3921578,
           'class_loss': 1.9625669,
           'conf_loss': 5.923679,
           'precision50': 0.43448734,
           'recall50': 0.49558222},
     '5': {'avg_iou': 0.84973204,
           'avg_obj': 0.65541375,
           'box_loss': 0.99992716,
           'class_loss': 0.97348565,
           'conf_loss': 2.2970157,
           'precision50': 0.50501364,
           'recall50': 0.65220696},
     'global': {'total_loss': 30.324793},
     'learning_rate': 0.000655,
     'training_loss': 30.324793}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-290000.
train | step:  300000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6945974,
           'avg_obj': 0.34438652,
           'box_loss': 4.2227783,
           'class_loss': 2.9625227,
           'conf_loss': 8.600135,
           'precision50': 0.3478711,
           'recall50': 0.24587806},
     '4': {'avg_iou': 0.8149459,
           'avg_obj': 0.5372564,
           'box_loss': 2.389305,
           'class_loss': 1.9451988,
           'conf_loss': 5.8914127,
           'precision50': 0.43372372,
           'recall50': 0.4983315},
     '5': {'avg_iou': 0.8502496,
           'avg_obj': 0.6582598,
           'box_loss': 0.99564856,
           'class_loss': 0.9651595,
           'conf_loss': 2.2770486,
           'precision50': 0.50415444,
           'recall50': 0.65490335},
     'global': {'total_loss': 30.249182},
     'learning_rate': 0.000655,
     'training_loss': 30.249182}
saved checkpoint to gs://tensorflow2/yolov4/tpu/512-aspect/ckpt-300000.
 eval | step:  300000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=181.25s).
Accumulating evaluation results...
DONE (t=11.97s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.411
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.626
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.448
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.190
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.412
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.531
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.327
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.536
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.582
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.388
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.597
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.688
 eval | step:  300000 | eval time:  521.4 sec | output: 
    {'3': {'avg_iou': 0.48848173,
           'avg_obj': 0.22156914,
           'box_loss': 2.1614947,
           'class_loss': 1.4465173,
           'conf_loss': 5.7660103,
           'precision50': 0.24387133,
           'recall50': 0.20966694},
     '4': {'avg_iou': 0.70748556,
           'avg_obj': 0.4604782,
           'box_loss': 1.8979057,
           'class_loss': 1.4518915,
           'conf_loss': 5.347697,
           'precision50': 0.3518391,
           'recall50': 0.46221134},
     '5': {'avg_iou': 0.8108303,
           'avg_obj': 0.64655936,
           'box_loss': 1.0588936,
           'class_loss': 0.8807774,
           'conf_loss': 2.7605217,
           'precision50': 0.42017797,
           'recall50': 0.65674967},
     'AP': 0.4107571,
     'AP50': 0.6262757,
     'AP75': 0.44810233,
     'APl': 0.53099257,
     'APm': 0.41243488,
     'APs': 0.19045678,
     'ARl': 0.6879572,
     'ARm': 0.5965776,
     'ARmax1': 0.3271002,
     'ARmax10': 0.5355774,
     'ARmax100': 0.5820224,
     'ARs': 0.38842076,
     'global': {'total_loss': 22.771706},
     'validation_loss': 22.771706}I0428 13:45:46.042782 140104730670912 train_lib.py:123] Number of trainable params in model: 64.488640 Millions.

  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   200    0     2  100   198     11   1185 --:--:-- --:--:-- --:--:--  1197
okRequest issued for: [node-7]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-28T13:49:12.785167760Z'
  endTime: '2021-04-28T13:50:00.517715467Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619617752770-5c108a4d3690a-36bdb7bb-e5bc60f5
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.124.160.48/29
  createTime: '2021-03-18T03:10:27.166064884Z'
  health: HEALTHY
  ipAddress: 10.124.160.50
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.124.160.50
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619617752770-5c108a4d3690a-36bdb7bb-e5bc60f5] to complete...
................................................................................................................................................................................................................................................................................done.
