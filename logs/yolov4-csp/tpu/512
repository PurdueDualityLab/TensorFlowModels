cat: .experiment_zone: No such file or directory
Request issued for: [node-3]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-25T00:35:13.890052529Z'
  endTime: '2021-04-25T00:35:47.997535486Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619310913867-5c0c133cd4ddc-90a357f0-7058ce3d
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619310913867-5c0c133cd4ddc-90a357f0-7058ce3d] to complete...
..................................................................................................................................................................................................done.
europe-west4-a
I0425 00:33:17.754152 140588968929088 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.2,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.1,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.5,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.2,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 1.0,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [400000,
                                                                                450000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.001,
                                                                            0.0001,
                                                                            1e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 4000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 500000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0425 00:33:17.756765 140588968929088 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512/params.yaml
I0425 00:33:20.772896 140588968929088 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 00:33:20.912837 140588968929088 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0425 00:33:20.913359 140588968929088 transport.py:157] Attempting refresh to obtain initial access_token
I0425 00:33:20.967021 140588968929088 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 00:33:21.586531 140588968929088 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0425 00:33:21.586785 140588968929088 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-25 00:33:21.626403: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0425 00:33:21.627356 140588968929088 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 00:33:22.243125 140588968929088 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0425 00:33:22.243595 140588968929088 transport.py:157] Attempting refresh to obtain initial access_token
I0425 00:33:22.284786 140588968929088 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 00:33:22.427203 140588968929088 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0425 00:33:22.427706 140588968929088 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-25 00:33:22.468600: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-25 00:33:22.497115: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-04-25 00:33:22.497194: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:61786}
2021-04-25 00:33:58.472762: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-04-25 00:33:58.472858: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:61786}
2021-04-25 00:33:58.473706: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:61786
I0425 00:33:58.474701 140588968929088 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-3
I0425 00:33:58.475335 140588968929088 tpu_strategy_util.py:74] Initializing the TPU system: node-3
INFO:tensorflow:Clearing out eager caches
I0425 00:34:07.082089 140588968929088 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0425 00:34:07.084690 140588968929088 tpu_strategy_util.py:133] Finished initializing TPU system.
I0425 00:34:07.086747 140588968929088 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 00:34:07.227719 140588968929088 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0425 00:34:07.228060 140588968929088 transport.py:157] Attempting refresh to obtain initial access_token
I0425 00:34:07.292939 140588968929088 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 00:34:07.431246 140588968929088 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0425 00:34:07.431582 140588968929088 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0425 00:34:07.478493 140588968929088 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0425 00:34:07.478941 140588968929088 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0425 00:34:07.479242 140588968929088 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0425 00:34:07.479304 140588968929088 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0425 00:34:07.479359 140588968929088 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0425 00:34:07.479487 140588968929088 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0425 00:34:07.479542 140588968929088 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0425 00:34:07.479621 140588968929088 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0425 00:34:07.479676 140588968929088 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0425 00:34:07.479725 140588968929088 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0425 00:34:07.479768 140588968929088 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0425 00:34:07.479898 140588968929088 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0425 00:34:07.479964 140588968929088 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0425 00:34:07.480007 140588968929088 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0425 00:34:07.480055 140588968929088 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0425 00:34:07.480105 140588968929088 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0425 00:34:07.481615 140588968929088 train_utils.py:214] Running default trainer.
2021-04-25 00:34:07.503501: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.2, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.2, 'aug_scale_aspect': 0.1, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 1.0, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [400000, 450000], 'values': [0.001, 0.0001, 1e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 4000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 500000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7fdd043a9d68>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________
yolo_fpn (YoloFPN)              {'5': (None, 16, 16, 9626112     input_2[0][0]                    
                                                                 input_3[0][0]                    I0425 00:34:56.946115 140588968929088 controller.py:362] restoring or initializing model...
I0425 00:35:10.014394 140588968929088 yolo.py:539] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0425 00:35:10.016611 140588968929088 controller.py:368] initialized model.
I0425 00:35:10.016882 140588968929088 train_lib.py:96] Starts to execute mode: train_and_eval
I0425 00:35:10.022186 140588968929088 controller.py:211] train | step:      0 | training until step 20000...
I0425 00:35:17.823835 140588968929088 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0425 00:36:26.344124 140588968929088 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0425 01:41:24.045775 140588968929088 controller.py:425] train | step:  10000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.52590674,
           'avg_obj': 0.13468815,
           'box_loss': 7.012657,
           'class_loss': 19.807201,
           'conf_loss': 347.2289,
           'precision50': 0.12717097,
           'recall50': 0.058260683},
     '4': {'avg_iou': 0.5987541,
           'avg_obj': 0.22681196,
           'box_loss': 5.87181,
           'class_loss': 19.00285,
           'conf_loss': 45.26215,
           'precision50': 0.19269061,
           'recall50': 0.16092844},
     '5': {'avg_iou': 0.5925325,
           'avg_obj': 0.29256228,
           'box_loss': 3.0979195,
           'class_loss': 9.802208,
           'conf_loss': 6.6232305,
           'precision50': 0.2903648,
           'recall50': 0.2531291},
     'global': {'total_loss': 463.70615},
     'learning_rate': 0.001,
     'training_loss': 463.70615}
I0425 01:42:20.066161 140588968929088 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-10000.
I0425 02:49:11.650974 140588968929088 controller.py:425] train | step:  20000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.62442225,
           'avg_obj': 0.20767863,
           'box_loss': 5.574734,
           'class_loss': 3.6256497,
           'conf_loss': 59.19222,
           'precision50': 0.16620876,
           'recall50': 0.12465209},
     '4': {'avg_iou': 0.72631985,
           'avg_obj': 0.34506166,
           'box_loss': 4.01137,
           'class_loss': 2.9646187,
           'conf_loss': 15.5942,
           'precision50': 0.20241146,
           'recall50': 0.31377625},
     '5': {'avg_iou': 0.7492261,
           'avg_obj': 0.4333552,
           'box_loss': 1.9097453,
           'class_loss': 1.4720584,
           'conf_loss': 2.7890177,
           'precision50': 0.30901307,
           'recall50': 0.47181016},
     'global': {'total_loss': 97.13348},
     'learning_rate': 0.001,
     'training_loss': 97.13348}
I0425 02:49:58.203718 140588968929088 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-20000.
I0425 02:49:58.211248 140588968929088 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0425 02:49:58.981548 140588968929088 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0425 02:50:18.390207 140588968929088 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0425 02:55:15.335785 140588968929088 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0425 03:00:00.270464 140588968929088 controller.py:261]  eval | step:  20000 | eval time:  602.1 sec | output: 
    {'3': {'avg_iou': 0.4818563,
           'avg_obj': 0.20488672,
           'box_loss': 3.060456,
           'class_loss': 1.6318237,
           'conf_loss': 40.542572,
           'precision50': 0.14171591,
           'recall50': 0.19025242},
     '4': {'avg_iou': 0.6932545,
           'avg_obj': 0.41591468,
           'box_loss': 2.4332507,
           'class_loss': 1.318517,
           'conf_loss': 10.721496,
           'precision50': 0.1856528,
           'recall50': 0.45141694},
     '5': {'avg_iou': 0.74105906,
           'avg_obj': 0.52601945,
           'box_loss': 1.3462151,
           'class_loss': 0.716571,
           'conf_loss': 2.097027,
           'precision50': 0.27150592,
           'recall50': 0.5922853},
     'AP': 0.257528,
     'AP50': 0.4414836,
     'AP75': 0.27047548,
     'APl': 0.3629179,
     'APm': 0.27506995,
     'APs': 0.084532,
     'ARl': 0.579669,
     'ARm': 0.48258552,
     'ARmax1': 0.24138276,
     'ARmax10': 0.4058527,
     'ARmax100': 0.44427603,
     'ARs': 0.22004554,
     'global': {'total_loss': 63.867924},
     'validation_loss': 63.867924}

                                                                 input_4[0][0]                    
__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'3': (None, 64, 64, 16271360    yolo_fpn[0][0]                   
                                                                 yolo_fpn[0][1]                   
                                                                 yolo_fpn[0][2]                   
==================================================================================================
Total params: 25,897,472
Trainable params: 25,867,520
Non-trainable params: 29,952
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 200, 8), 4: (8, 200, 8), 5: (8, 200, 8)}, inds: {3: (8, 200, 3), 4: (8, 200, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
train | step:  10000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.52590674,
           'avg_obj': 0.13468815,
           'box_loss': 7.012657,
           'class_loss': 19.807201,
           'conf_loss': 347.2289,
           'precision50': 0.12717097,
           'recall50': 0.058260683},
     '4': {'avg_iou': 0.5987541,
           'avg_obj': 0.22681196,
           'box_loss': 5.87181,
           'class_loss': 19.00285,
           'conf_loss': 45.26215,
           'precision50': 0.19269061,
           'recall50': 0.16092844},
     '5': {'avg_iou': 0.5925325,
           'avg_obj': 0.29256228,
           'box_loss': 3.0979195,
           'class_loss': 9.802208,
           'conf_loss': 6.6232305,
           'precision50': 0.2903648,
           'recall50': 0.2531291},
     'global': {'total_loss': 463.70615},
     'learning_rate': 0.001,
     'training_loss': 463.70615}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-10000.
train | step:  20000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.62442225,
           'avg_obj': 0.20767863,
           'box_loss': 5.574734,
           'class_loss': 3.6256497,
           'conf_loss': 59.19222,
           'precision50': 0.16620876,
           'recall50': 0.12465209},
     '4': {'avg_iou': 0.72631985,
           'avg_obj': 0.34506166,
           'box_loss': 4.01137,
           'class_loss': 2.9646187,
           'conf_loss': 15.5942,
           'precision50': 0.20241146,
           'recall50': 0.31377625},
     '5': {'avg_iou': 0.7492261,
           'avg_obj': 0.4333552,
           'box_loss': 1.9097453,
           'class_loss': 1.4720584,
           'conf_loss': 2.7890177,
           'precision50': 0.30901307,
           'recall50': 0.47181016},
     'global': {'total_loss': 97.13348},
     'learning_rate': 0.001,
     'training_loss': 97.13348}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-20000.
 eval | step:  20000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=195.17s).
Accumulating evaluation results...
DONE (t=27.14s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.258
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.441
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.270
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.085
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.275
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.363
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.241
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.406
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.444
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.220
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.483
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.580
 eval | step:  20000 | eval time:  602.1 sec | output: 
    {'3': {'avg_iou': 0.4818563,
           'avg_obj': 0.20488672,
           'box_loss': 3.060456,
           'class_loss': 1.6318237,
           'conf_loss': 40.542572,
           'precision50': 0.14171591,
           'recall50': 0.19025242},
     '4': {'avg_iou': 0.6932545,
           'avg_obj': 0.41591468,
           'box_loss': 2.4332507,
           'class_loss': 1.318517,
           'conf_loss': 10.721496,
           'precision50': 0.1856528,
           'recall50': 0.45141694},
     '5': {'avg_iou': 0.74105906,
           'avg_obj': 0.52601945,
           'box_loss': 1.3462151,
           'class_loss': 0.716571,
           'conf_loss': 2.097027,
           'precision50': 0.27150592,
           'recall50': 0.5922853},
     'AP': 0.257528,
     'AP50': 0.4414836,
     'AP75': 0.27047548,
     'APl': 0.3629179,
     'APm': 0.27506995,
     'APs': 0.084532,
     'ARl': 0.579669,
     'ARm': 0.48258552,
     'ARmax1': 0.24138276,
     'ARmax10': 0.4058527,
     'ARmax100': 0.44427603,
     'ARs': 0.22004554,
     'global': {'total_loss': 63.867924},
     'validation_loss': 63.867924}I0425 03:00:25.005565 140588968929088 controller.py:211] train | step:  20000 | training until step 40000...
I0425 04:04:59.598617 140588968929088 controller.py:425] train | step:  30000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.64011717,
           'avg_obj': 0.23671396,
           'box_loss': 5.339214,
           'class_loss': 3.1750267,
           'conf_loss': 59.19873,
           'precision50': 0.16074048,
           'recall50': 0.15500335},
     '4': {'avg_iou': 0.7466834,
           'avg_obj': 0.3872311,
           'box_loss': 3.7092052,
           'class_loss': 2.5657341,
           'conf_loss': 15.407795,
           'precision50': 0.19622675,
           'recall50': 0.36738133},
     '5': {'avg_iou': 0.77381045,
           'avg_obj': 0.48284337,
           'box_loss': 1.720322,
           'class_loss': 1.2721246,
           'conf_loss': 2.7452555,
           'precision50': 0.28454313,
           'recall50': 0.53957963},
     'global': {'total_loss': 95.13352},
     'learning_rate': 0.001,
     'training_loss': 95.13352}
I0425 04:05:47.818185 140588968929088 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-30000.
I0425 05:06:55.591419 140588968929088 controller.py:425] train | step:  40000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6487824,
           'avg_obj': 0.2539822,
           'box_loss': 5.2241416,
           'class_loss': 2.9385796,
           'conf_loss': 58.92353,
           'precision50': 0.1626465,
           'recall50': 0.17223023},
     '4': {'avg_iou': 0.7573855,
           'avg_obj': 0.4115231,
           'box_loss': 3.5579848,
           'class_loss': 2.3519475,
           'conf_loss': 15.193433,
           'precision50': 0.19346571,
           'recall50': 0.39856175},
     '5': {'avg_iou': 0.78691345,
           'avg_obj': 0.5108876,
           'box_loss': 1.622123,
           'class_loss': 1.1614484,
           'conf_loss': 2.690713,
           'precision50': 0.2743551,
           'recall50': 0.5750039},
     'global': {'total_loss': 93.663925},
     'learning_rate': 0.001,
     'training_loss': 93.663925}
I0425 05:07:42.657099 140588968929088 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-40000.
I0425 05:07:42.663285 140588968929088 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0425 05:11:55.807513 140588968929088 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is READY
europe-west4-a
I0425 05:16:14.599825 140522388367168 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 2.0,
                                    'aug_scale_min': 0.1,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.6,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.1,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.5,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.9,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [400000,
                                                                                450000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.001,
                                                                            0.0001,
                                                                            1e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 4000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 500000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0425 05:16:14.601140 140522388367168 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512/params.yaml
I0425 05:16:15.445809 140522388367168 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 05:16:15.591762 140522388367168 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0425 05:16:15.592271 140522388367168 transport.py:157] Attempting refresh to obtain initial access_token
I0425 05:16:15.653017 140522388367168 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 05:16:16.269608 140522388367168 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0425 05:16:16.269927 140522388367168 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-25 05:16:16.328409: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0425 05:16:16.329228 140522388367168 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 05:16:16.953151 140522388367168 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0425 05:16:16.953413 140522388367168 transport.py:157] Attempting refresh to obtain initial access_token
I0425 05:16:16.992308 140522388367168 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 05:16:17.137647 140522388367168 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0425 05:16:17.137942 140522388367168 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-25 05:16:17.181190: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-25 05:16:17.197576: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-04-25 05:16:17.197887: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:33511}
2021-04-25 05:16:17.216620: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-04-25 05:16:17.216702: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:33511}
2021-04-25 05:16:17.217743: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:33511
I0425 05:16:17.218417 140522388367168 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-3
I0425 05:16:17.219158 140522388367168 tpu_strategy_util.py:74] Initializing the TPU system: node-3
INFO:tensorflow:Clearing out eager caches
I0425 05:16:22.914777 140522388367168 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0425 05:16:22.917368 140522388367168 tpu_strategy_util.py:133] Finished initializing TPU system.
I0425 05:16:22.918983 140522388367168 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 05:16:23.060417 140522388367168 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0425 05:16:23.060714 140522388367168 transport.py:157] Attempting refresh to obtain initial access_token
I0425 05:16:23.123265 140522388367168 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 05:16:23.263171 140522388367168 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0425 05:16:23.263638 140522388367168 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0425 05:16:23.302916 140522388367168 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0425 05:16:23.303313 140522388367168 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0425 05:16:23.303690 140522388367168 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0425 05:16:23.303802 140522388367168 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0425 05:16:23.303928 140522388367168 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0425 05:16:23.304177 140522388367168 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0425 05:16:23.304280 140522388367168 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0425 05:16:23.304376 140522388367168 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0425 05:16:23.304470 140522388367168 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0425 05:16:23.304579 140522388367168 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0425 05:16:23.304677 140522388367168 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0425 05:16:23.304767 140522388367168 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0425 05:16:23.304934 140522388367168 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0425 05:16:23.305050 140522388367168 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0425 05:16:23.305163 140522388367168 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0425 05:16:23.305258 140522388367168 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0425 05:16:23.306774 140522388367168 train_utils.py:214] Running default trainer.
2021-04-25 05:16:23.329006: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.9, 'aug_scale_aspect': 0.1, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [400000, 450000], 'values': [0.001, 0.0001, 1e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 4000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 500000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7fcd8437f0b8>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 2021-04-25 05:16:37.260969: W tensorflow/core/distributed_runtime/eager/remote_tensor_handle_data.cc:76] Unable to destroy remote tensor handles. If you are running a tf.function, it usually indicates some op in the graph gets an error: SharedMemoryAddress expired.
I0425 05:16:37.362186 140588968929088 controller.py:261]  eval | step:  40000 | eval time:  534.7 sec | output: 
    {'3': {'avg_iou': 0.49257207,
           'avg_obj': 0.23275767,
           'box_loss': 2.9119449,
           'class_loss': 1.3242444,
           'conf_loss': 40.611237,
           'precision50': 0.14234482,
           'recall50': 0.22981462},
     '4': {'avg_iou': 0.70964867,
           'avg_obj': 0.46343786,
           'box_loss': 2.2514606,
           'class_loss': 1.0904819,
           'conf_loss': 10.492991,
           'precision50': 0.17790353,
           'recall50': 0.50828356},
     '5': {'avg_iou': 0.76558787,
           'avg_obj': 0.5836885,
           'box_loss': 1.1971564,
           'class_loss': 0.59512043,
           'conf_loss': 2.03906,
           'precision50': 0.24043182,
           'recall50': 0.6619828},
     'AP': 0.31415612,
     'AP50': 0.5061938,
     'AP75': 0.34048238,
     'APl': 0.43967918,
     'APm': 0.33238652,
     'APs': 0.11933165,
     'ARl': 0.6311816,
     'ARm': 0.5296101,
     'ARmax1': 0.2732764,
     'ARmax10': 0.4496821,
     'ARmax100': 0.4910827,
     'ARs': 0.26569033,
     'global': {'total_loss': 62.513714},
     'validation_loss': 62.513714}
2021-04-25 05:16:37.371193: W tensorflow/core/distributed_runtime/eager/remote_tensor_handle_data.cc:76] Unable to destroy remote tensor handles. If you are running a tf.function, it usually indicates some op in the graph gets an error: stream did not block host until done; was already in an error state
2021-04-25 05:16:37.372014: W ./tensorflow/core/distributed_runtime/eager/destroy_tensor_handle_node.h:57] Ignoring an error encountered when deleting remote tensors handles: Invalid argument: Unable to find the relevant tensor remote_handle: Op ID: 345936, Output num: 0
Additional GRPC error information from remote target /job:worker/replica:0/task:0:
:{"created":"@1619327797.371713345","description":"Error received from peer ipv4:10.91.127.66:8470","file":"external/com_github_grpc_grpc/src/core/lib/surface/call.cc","file_line":1056,"grpc_message":"Unable to find the relevant tensor remote_handle: Op ID: 345936, Output num: 0","grpc_status":3}
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 149, in main
    model_dir=model_dir)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_lib.py", line 68, in run_experiment
    params, model_dir))
  File "/usr/local/lib/python3.7/dist-packages/gin/config.py", line 1069, in gin_wrapper
    utils.augment_exception_message_and_reraise(e, err_str)
  File "/usr/local/lib/python3.7/dist-packages/gin/utils.py", line 41, in augment_exception_message_and_reraise
    raise proxy.with_traceback(exception.__traceback__) from None
  File "/usr/local/lib/python3.7/dist-packages/gin/config.py", line 1046, in gin_wrapper
    return fn(*new_args, **new_kwargs)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_utils.py", line 215, in create_trainer
    model = task.build_model()
  File "/home/cam2tensorflow/TensorFlowModels/yolo/tasks/yolo.py", line 105, in build_model
    masks, xy_scales, path_scales)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/modeling/Yolo.py", line 238, in build_yolo
    l2_regularization)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/modeling/Yolo.py", line 143, in build_yolo_decoder
    kernel_regularizer=l2_regularization)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/modeling/decoders/yolo_decoder.py", line 436, in __init__
    outputs = YoloPAN(**self._decoder_config)(inter_outs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py", line 952, in __call__
    input_list)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py", line 1091, in _functional_construction_call
    inputs, input_masks, args, kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py", line 822, in _keras_tensor_symbolic_call
    return self._infer_output_signature(inputs, args, kwargs, input_masks)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py", line 863, in _infer_output_signature
    outputs = call_fn(inputs, *args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/autograph/impl/api.py", line 670, in wrapper
    raise e.ag_error_metadata.to_exception(e)
tensorflow.python.framework.errors_impl.InvalidArgumentError: in user code:

    /home/cam2tensorflow/TensorFlowModels/yolo/modeling/decoders/yolo_decoder.py:335 call  *
        x_route, x = self.preprocessors[str(level)](layer_in)
    /home/cam2tensorflow/TensorFlowModels/yolo/modeling/layers/nn_blocks.py:1645 call  *
        return self._call_csp(inputs, training=training)
    /home/cam2tensorflow/TensorFlowModels/yolo/modeling/layers/nn_blocks.py:1639 _call_csp  *
        x = layer(x)
    /home/cam2tensorflow/TensorFlowModels/yolo/modeling/layers/nn_blocks.py:177 call  *
        x = self.conv(x)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py:1008 __call__  **
        self._maybe_build(inputs)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py:2710 _maybe_build
        self.build(input_shapes)  # pylint:disable=not-callable
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/layers/convolutional.py:205 build
        dtype=self.dtype)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py:639 add_weight
        caching_device=caching_device)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/training/tracking/base.py:810 _add_variable_with_custom_getter
        **kwargs_for_getter)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py:613 getter
        variable = old_getter(*args, **kwargs)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer_utils.py:142 make_variable
        shape=variable_shape if variable_shape else None)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/variables.py:260 __call__
        return cls._variable_v1_call(*args, **kwargs)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/variables.py:221 _variable_v1_call
        shape=shape)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/variables.py:67 getter
        return captured_getter(captured_previous, **kwargs)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/distribute_lib.py:2083 creator_with_resource_vars
        created = self._create_variable(next_creator, **kwargs)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/tpu_strategy.py:1036 _create_variable
        distribute_utils.TPU_VARIABLE_POLICY_MAPPING, **kwargs)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/distribute_utils.py:311 create_mirrored_variable
        value_list = real_mirrored_creator(**kwargs)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/tpu_strategy.py:1027 _real_mirrored_creator
        v = next_creator(**kwargs)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/variables.py:199 <lambda>
        previous_getter = lambda **kwargs: default_variable_creator(None, **kwargs)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/variable_scope.py:2618 default_variable_creator
        shape=shape)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/variables.py:264 __call__
        return super(VariableMetaclass, cls).__call__(*args, **kwargs)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:1585 __init__
        distribute_strategy=distribute_strategy)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:1721 _init_from_args
        if not initial_value.shape.is_compatible_with(shape):
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py:1175 shape
        self._tensor_shape = tensor_shape.TensorShape(self._shape_tuple())

    InvalidArgumentError: stream is uninitialized or in an error state

  In call to configurable 'create_trainer' (<function create_trainer at 0x7fcd98f2e6a8>)
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/tpu_strategy.py", line 738, in async_wait
    context.async_wait()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/context.py", line 2330, in async_wait
    context().sync_executors()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/context.py", line 645, in sync_executors
    pywrap_tfe.TFE_ContextSyncExecutors(self._context_handle)
tensorflow.python.framework.errors_impl.InvalidArgumentError: stream is uninitialized or in an error state

__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 149, in main
    model_dir=model_dir)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_lib.py", line 104, in run_experiment
    eval_interval=params.trainer.validation_interval)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 304, in train_and_evaluate
    self.evaluate(steps=eval_steps)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 265, in evaluate
    self.eval_summary_manager.write_summaries(eval_output)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/utils/summary_manager.py", line 101, in write_summaries
    self._write_summaries(summary_dict)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/utils/summary_manager.py", line 107, in _write_summaries
    value, relative_path=os.path.join(relative_path, name))
  File "/home/cam2tensorflow/TensorFlowModels/orbit/utils/summary_manager.py", line 110, in _write_summaries
    self._summary_fn(name, value, step=self._global_step)
  File "/usr/local/lib/python3.7/dist-packages/tensorboard/plugins/scalar/summary_v2.py", line 68, in scalar
    metadata=summary_metadata,
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/summary_ops_v2.py", line 775, in write
    _should_record_summaries_v2(), record, _nothing, name="summary_cond")
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/smart_cond.py", line 54, in smart_cond
    return true_fn()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/summary_ops_v2.py", line 770, in record
    name=scope)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_summary_ops.py", line 701, in write_summary
    writer, step, tensor, tag, summary_metadata, name=name, ctx=_ctx)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_summary_ops.py", line 721, in write_summary_eager_fallback
    attrs=_attrs, ctx=ctx, name=name)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/execute.py", line 60, in quick_execute
    inputs, attrs, num_outputs)
tensorflow.python.framework.errors_impl.InternalError: stream did not block host until done; was already in an error state [Op:WriteSummary]
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/tpu_strategy.py", line 738, in async_wait
    context.async_wait()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/context.py", line 2330, in async_wait
    context().sync_executors()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/context.py", line 645, in sync_executors
    pywrap_tfe.TFE_ContextSyncExecutors(self._context_handle)
tensorflow.python.framework.errors_impl.InternalError: stream did not block host until done; was already in an error state

train | step:  20000 | training until step 40000...
train | step:  30000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.64011717,
           'avg_obj': 0.23671396,
           'box_loss': 5.339214,
           'class_loss': 3.1750267,
           'conf_loss': 59.19873,
           'precision50': 0.16074048,
           'recall50': 0.15500335},
     '4': {'avg_iou': 0.7466834,
           'avg_obj': 0.3872311,
           'box_loss': 3.7092052,
           'class_loss': 2.5657341,
           'conf_loss': 15.407795,
           'precision50': 0.19622675,
           'recall50': 0.36738133},
     '5': {'avg_iou': 0.77381045,
           'avg_obj': 0.48284337,
           'box_loss': 1.720322,
           'class_loss': 1.2721246,
           'conf_loss': 2.7452555,
           'precision50': 0.28454313,
           'recall50': 0.53957963},
     'global': {'total_loss': 95.13352},
     'learning_rate': 0.001,
     'training_loss': 95.13352}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-30000.
train | step:  40000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6487824,
           'avg_obj': 0.2539822,
           'box_loss': 5.2241416,
           'class_loss': 2.9385796,
           'conf_loss': 58.92353,
           'precision50': 0.1626465,
           'recall50': 0.17223023},
     '4': {'avg_iou': 0.7573855,
           'avg_obj': 0.4115231,
           'box_loss': 3.5579848,
           'class_loss': 2.3519475,
           'conf_loss': 15.193433,
           'precision50': 0.19346571,
           'recall50': 0.39856175},
     '5': {'avg_iou': 0.78691345,
           'avg_obj': 0.5108876,
           'box_loss': 1.622123,
           'class_loss': 1.1614484,
           'conf_loss': 2.690713,
           'precision50': 0.2743551,
           'recall50': 0.5750039},
     'global': {'total_loss': 93.663925},
     'learning_rate': 0.001,
     'training_loss': 93.663925}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-40000.
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=191.61s).
Accumulating evaluation results...
DONE (t=29.10s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.314
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.506
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.340
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.119
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.332
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.440
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.273
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.450
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.266
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.530
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.631
 eval | step:  40000 | eval time:  534.7 sec | output: 
    {'3': {'avg_iou': 0.49257207,
           'avg_obj': 0.23275767,
           'box_loss': 2.9119449,
           'class_loss': 1.3242444,
           'conf_loss': 40.611237,
           'precision50': 0.14234482,
           'recall50': 0.22981462},
     '4': {'avg_iou': 0.70964867,
           'avg_obj': 0.46343786,
           'box_loss': 2.2514606,
           'class_loss': 1.0904819,
           'conf_loss': 10.492991,
           'precision50': 0.17790353,
           'recall50': 0.50828356},
     '5': {'avg_iou': 0.76558787,
           'avg_obj': 0.5836885,
           'box_loss': 1.1971564,
           'class_loss': 0.59512043,
           'conf_loss': 2.03906,
           'precision50': 0.24043182,
           'recall50': 0.6619828},
     'AP': 0.31415612,
     'AP50': 0.5061938,
     'AP75': 0.34048238,
     'APl': 0.43967918,
     'APm': 0.33238652,
     'APs': 0.11933165,
     'ARl': 0.6311816,
     'ARm': 0.5296101,
     'ARmax1': 0.2732764,
     'ARmax10': 0.4496821,
     'ARmax100': 0.4910827,
     'ARs': 0.26569033,
     'global': {'total_loss': 62.513714},
     'validation_loss': 62.513714}
2021-04-25 05:16:38.373104: W ./tensorflow/core/distributed_runtime/eager/destroy_tensor_handle_node.h:57] Ignoring an error encountered when deleting remote tensors handles: Invalid argument: Unable to find the relevant tensor remote_handle: Op ID: 15902, Output num: 0
Additional GRPC error information from remote target /job:worker/replica:0/task:0:
:{"created":"@1619327798.372857358","description":"Error received from peer ipv4:10.91.127.66:8470","file":"external/com_github_grpc_grpc/src/core/lib/surface/call.cc","file_line":1056,"grpc_message":"Unable to find the relevant tensor remote_handle: Op ID: 15902, Output num: 0","grpc_status":3}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   204    0     2  100   202     12   1254 --:--:-- --:--:-- --:--:--  1267
okRequest issued for: [node-3]
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   204    0     2  100   202      6    649 --:--:-- --:--:-- --:--:--   655
okRequest issued for: [node-3]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-25T05:19:20.348960624Z'
  endTime: '2021-04-25T05:20:00.646687670Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619327960329-5c0c52bd9acdf-41d1f9f1-3391a1ac
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619327960329-5c0c52bd9acdf-41d1f9f1-3391a1ac] to complete...
..............................................................................................................................................................................................................................................................................done.
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-25T05:19:37.923569908Z'
  endTime: '2021-04-25T05:20:11.772041541Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619327977914-5c0c52ce5fec6-9270e5f6-c99fc22f
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619327977914-5c0c52ce5fec6-9270e5f6-c99fc22f] to complete...
...............................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-3]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-25T05:33:38.954889268Z'
  endTime: '2021-04-25T05:34:12.268472400Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619328818925-5c0c55f06d15c-b84d4e4d-e24bb958
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619328818925-5c0c55f06d15c-b84d4e4d-e24bb958] to complete...
.........................................................................................................................................................................................done.
europe-west4-a
I0425 05:31:37.892589 140388535805760 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 2.0,
                                    'aug_scale_min': 0.1,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.6,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.5,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.6,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [400000,
                                                                                450000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.001,
                                                                            0.0001,
                                                                            1e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 4000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 500000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0425 05:31:37.894248 140388535805760 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512/params.yaml
I0425 05:31:38.739436 140388535805760 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 05:31:39.355784 140388535805760 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0425 05:31:39.356122 140388535805760 transport.py:157] Attempting refresh to obtain initial access_token
I0425 05:31:39.419261 140388535805760 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 05:31:40.035022 140388535805760 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0425 05:31:40.035284 140388535805760 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-25 05:31:40.082848: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0425 05:31:40.083552 140388535805760 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 05:31:40.220972 140388535805760 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0425 05:31:40.221258 140388535805760 transport.py:157] Attempting refresh to obtain initial access_token
I0425 05:31:40.261136 140388535805760 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 05:31:40.876316 140388535805760 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0425 05:31:40.876803 140388535805760 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-25 05:31:40.917009: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-25 05:31:40.937137: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-04-25 05:31:40.937223: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:33866}
2021-04-25 05:32:20.470443: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-04-25 05:32:20.470589: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:33866}
2021-04-25 05:32:20.471271: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:33866
I0425 05:32:20.472545 140388535805760 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-3
I0425 05:32:20.473469 140388535805760 tpu_strategy_util.py:74] Initializing the TPU system: node-3
INFO:tensorflow:Clearing out eager caches
I0425 05:32:28.585230 140388535805760 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0425 05:32:28.587507 140388535805760 tpu_strategy_util.py:133] Finished initializing TPU system.
I0425 05:32:28.589142 140388535805760 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 05:32:28.730223 140388535805760 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0425 05:32:28.730561 140388535805760 transport.py:157] Attempting refresh to obtain initial access_token
I0425 05:32:28.790924 140388535805760 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 05:32:29.407666 140388535805760 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0425 05:32:29.407999 140388535805760 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0425 05:32:29.448698 140388535805760 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0425 05:32:29.448949 140388535805760 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0425 05:32:29.449233 140388535805760 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0425 05:32:29.449286 140388535805760 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0425 05:32:29.449343 140388535805760 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0425 05:32:29.449464 140388535805760 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0425 05:32:29.449537 140388535805760 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0425 05:32:29.449582 140388535805760 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0425 05:32:29.449625 140388535805760 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0425 05:32:29.449670 140388535805760 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0425 05:32:29.449714 140388535805760 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0425 05:32:29.449756 140388535805760 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0425 05:32:29.449806 140388535805760 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0425 05:32:29.449851 140388535805760 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0425 05:32:29.449895 140388535805760 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0425 05:32:29.449951 140388535805760 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0425 05:32:29.451278 140388535805760 train_utils.py:214] Running default trainer.
2021-04-25 05:32:29.471636: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [400000, 450000], 'values': [0.001, 0.0001, 1e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 4000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 500000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7fae5c801d68>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________
yolo_fpn (YoloFPN)              {'5': (None, 16, 16, 9626112     input_2[0][0]                    
                                                                 input_3[0][0]                    I0425 05:33:17.505250 140388535805760 controller.py:362] restoring or initializing model...
I0425 05:33:33.017679 140388535805760 controller.py:366] restored model from gs://tensorflow2/yolov4-csp/tpu/512/ckpt-40000.
I0425 05:33:33.017929 140388535805760 controller.py:192] restored from checkpoint: gs://tensorflow2/yolov4-csp/tpu/512/ckpt-40000
I0425 05:33:33.018069 140388535805760 train_lib.py:96] Starts to execute mode: train_and_eval
I0425 05:33:33.022967 140388535805760 controller.py:211] train | step:  40000 | training until step 60000...
I0425 05:33:38.778812 140388535805760 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0425 05:34:48.964506 140388535805760 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0425 06:46:22.980979 140388535805760 controller.py:425] train | step:  50000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6457704,
           'avg_obj': 0.25732782,
           'box_loss': 4.186753,
           'class_loss': 2.3527493,
           'conf_loss': 47.453003,
           'precision50': 0.15296143,
           'recall50': 0.16936703},
     '4': {'avg_iou': 0.7618621,
           'avg_obj': 0.41231808,
           'box_loss': 2.8010159,
           'class_loss': 1.8947023,
           'conf_loss': 12.591191,
           'precision50': 0.19336107,
           'recall50': 0.39226508},
     '5': {'avg_iou': 0.79326624,
           'avg_obj': 0.5050002,
           'box_loss': 1.328182,
           'class_loss': 1.0093364,
           'conf_loss': 2.4622273,
           'precision50': 0.25595653,
           'recall50': 0.54951936},
     'global': {'total_loss': 76.079216},
     'learning_rate': 0.001,
     'training_loss': 76.079216}
I0425 06:47:13.950527 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-50000.
I0425 07:57:32.571786 140388535805760 controller.py:425] train | step:  60000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.64952856,
           'avg_obj': 0.26539376,
           'box_loss': 4.140589,
           'class_loss': 2.2719345,
           'conf_loss': 47.307304,
           'precision50': 0.15448278,
           'recall50': 0.17783716},
     '4': {'avg_iou': 0.76672465,
           'avg_obj': 0.42342094,
           'box_loss': 2.7459874,
           'class_loss': 1.8214438,
           'conf_loss': 12.54708,
           'precision50': 0.19373143,
           'recall50': 0.40606767},
     '5': {'avg_iou': 0.7988466,
           'avg_obj': 0.51719236,
           'box_loss': 1.2941295,
           'class_loss': 0.9700076,
           'conf_loss': 2.4420989,
           'precision50': 0.25524792,
           'recall50': 0.56434083},
     'global': {'total_loss': 75.54045},
     'learning_rate': 0.001,
     'training_loss': 75.54045}
I0425 07:58:21.746799 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-60000.
I0425 07:58:21.753145 140388535805760 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0425 07:58:22.635044 140388535805760 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0425 07:58:41.717549 140388535805760 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0425 08:03:44.799545 140388535805760 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0425 08:08:35.834458 140388535805760 controller.py:261]  eval | step:  60000 | eval time:  614.1 sec | output: 
    {'3': {'avg_iou': 0.4966315,
           'avg_obj': 0.23660144,
           'box_loss': 2.8610547,
           'class_loss': 1.2288948,
           'conf_loss': 40.7834,
           'precision50': 0.14124848,
           'recall50': 0.23500639},
     '4': {'avg_iou': 0.71467054,
           'avg_obj': 0.47409257,
           'box_loss': 2.196289,
           'class_loss': 1.0082389,
           'conf_loss': 10.467234,
           'precision50': 0.17650087,
           'recall50': 0.5207303},
     '5': {'avg_iou': 0.7744232,
           'avg_obj': 0.5980183,
           'box_loss': 1.1451539,
           'class_loss': 0.55047756,
           'conf_loss': 2.028564,
           'precision50': 0.23816487,
           'recall50': 0.6781531},
     'AP': 0.33253145,
     'AP50': 0.5286488,
     'AP75': 0.3602672,
     'APl': 0.46425465,
     'APm': 0.35315174,
     'APs': 0.12859236,
     'ARl': 0.64235175,
     'ARm': 0.543426,
     'ARmax1': 0.2825231,
     'ARmax10': 0.46321997,
     'ARmax100': 0.50357085,
     'ARs': 0.27890915,
     'global': {'total_loss': 62.269375},
     'validation_loss': 62.269375}

                                                                 input_4[0][0]                    
__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'3': (None, 64, 64, 16271360    yolo_fpn[0][0]                   
                                                                 yolo_fpn[0][1]                   
                                                                 yolo_fpn[0][2]                   
==================================================================================================
Total params: 25,897,472
Trainable params: 25,867,520
Non-trainable params: 29,952
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 200, 8), 4: (8, 200, 8), 5: (8, 200, 8)}, inds: {3: (8, 200, 3), 4: (8, 200, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
restored model from gs://tensorflow2/yolov4-csp/tpu/512/ckpt-40000.
restored from checkpoint: gs://tensorflow2/yolov4-csp/tpu/512/ckpt-40000
train | step:  40000 | training until step 60000...
train | step:  50000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6457704,
           'avg_obj': 0.25732782,
           'box_loss': 4.186753,
           'class_loss': 2.3527493,
           'conf_loss': 47.453003,
           'precision50': 0.15296143,
           'recall50': 0.16936703},
     '4': {'avg_iou': 0.7618621,
           'avg_obj': 0.41231808,
           'box_loss': 2.8010159,
           'class_loss': 1.8947023,
           'conf_loss': 12.591191,
           'precision50': 0.19336107,
           'recall50': 0.39226508},
     '5': {'avg_iou': 0.79326624,
           'avg_obj': 0.5050002,
           'box_loss': 1.328182,
           'class_loss': 1.0093364,
           'conf_loss': 2.4622273,
           'precision50': 0.25595653,
           'recall50': 0.54951936},
     'global': {'total_loss': 76.079216},
     'learning_rate': 0.001,
     'training_loss': 76.079216}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-50000.
train | step:  60000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.64952856,
           'avg_obj': 0.26539376,
           'box_loss': 4.140589,
           'class_loss': 2.2719345,
           'conf_loss': 47.307304,
           'precision50': 0.15448278,
           'recall50': 0.17783716},
     '4': {'avg_iou': 0.76672465,
           'avg_obj': 0.42342094,
           'box_loss': 2.7459874,
           'class_loss': 1.8214438,
           'conf_loss': 12.54708,
           'precision50': 0.19373143,
           'recall50': 0.40606767},
     '5': {'avg_iou': 0.7988466,
           'avg_obj': 0.51719236,
           'box_loss': 1.2941295,
           'class_loss': 0.9700076,
           'conf_loss': 2.4420989,
           'precision50': 0.25524792,
           'recall50': 0.56434083},
     'global': {'total_loss': 75.54045},
     'learning_rate': 0.001,
     'training_loss': 75.54045}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-60000.
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=200.95s).
Accumulating evaluation results...
DONE (t=29.43s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.333
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.529
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.360
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.129
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.353
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.464
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.283
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.463
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.504
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.279
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.543
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.642
 eval | step:  60000 | eval time:  614.1 sec | output: 
    {'3': {'avg_iou': 0.4966315,
           'avg_obj': 0.23660144,
           'box_loss': 2.8610547,
           'class_loss': 1.2288948,
           'conf_loss': 40.7834,
           'precision50': 0.14124848,
           'recall50': 0.23500639},
     '4': {'avg_iou': 0.71467054,
           'avg_obj': 0.47409257,
           'box_loss': 2.196289,
           'class_loss': 1.0082389,
           'conf_loss': 10.467234,
           'precision50': 0.17650087,
           'recall50': 0.5207303},
     '5': {'avg_iou': 0.7744232,
           'avg_obj': 0.5980183,
           'box_loss': 1.1451539,
           'class_loss': 0.55047756,
           'conf_loss': 2.028564,
           'precision50': 0.23816487,
           'recall50': 0.6781531},
     'AP': 0.33253145,
     'AP50': 0.5286488,
     'AP75': 0.3602672,
     'APl': 0.46425465,
     'APm': 0.35315174,
     'APs': 0.12859236,
     'ARl': 0.64235175,
     'ARm': 0.543426,
     'ARmax1': 0.2825231,
     'ARmax10': 0.46321997,
     'ARmax100': 0.50357085,
     'ARs': 0.27890915,
     'global': {'total_loss': 62.269375},
     'validation_loss': 62.269375}I0425 08:08:56.100579 140388535805760 controller.py:211] train | step:  60000 | training until step 80000...
I0425 09:12:21.720884 140388535805760 controller.py:425] train | step:  70000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.65260786,
           'avg_obj': 0.2717491,
           'box_loss': 4.105751,
           'class_loss': 2.2153378,
           'conf_loss': 47.4974,
           'precision50': 0.15317208,
           'recall50': 0.18422368},
     '4': {'avg_iou': 0.770136,
           'avg_obj': 0.43185243,
           'box_loss': 2.702338,
           'class_loss': 1.7683756,
           'conf_loss': 12.549981,
           'precision50': 0.1920377,
           'recall50': 0.41628292},
     '5': {'avg_iou': 0.8029391,
           'avg_obj': 0.52664423,
           'box_loss': 1.266839,
           'class_loss': 0.93928015,
           'conf_loss': 2.4181416,
           'precision50': 0.25332204,
           'recall50': 0.5751262},
     'global': {'total_loss': 75.46339},
     'learning_rate': 0.001,
     'training_loss': 75.46339}
I0425 09:13:08.037235 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-70000.
I0425 10:13:09.944797 140388535805760 controller.py:425] train | step:  80000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6554828,
           'avg_obj': 0.2776719,
           'box_loss': 4.067641,
           'class_loss': 2.163885,
           'conf_loss': 47.310772,
           'precision50': 0.15410277,
           'recall50': 0.18968403},
     '4': {'avg_iou': 0.7732308,
           'avg_obj': 0.43952003,
           'box_loss': 2.660143,
           'class_loss': 1.715679,
           'conf_loss': 12.4367285,
           'precision50': 0.19248122,
           'recall50': 0.4248817},
     '5': {'avg_iou': 0.8063015,
           'avg_obj': 0.53417605,
           'box_loss': 1.2411404,
           'class_loss': 0.90781194,
           'conf_loss': 2.381652,
           'precision50': 0.25265032,
           'recall50': 0.5827498},
     'global': {'total_loss': 74.88515},
     'learning_rate': 0.001,
     'training_loss': 74.88515}
I0425 10:13:57.969507 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-80000.
I0425 10:13:57.975142 140388535805760 controller.py:252]  eval | step:  80000 | running 625 steps of evaluation...
I0425 10:18:13.234505 140388535805760 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0425 10:23:00.709007 140388535805760 controller.py:261]  eval | step:  80000 | eval time:  542.7 sec | output: 
    {'3': {'avg_iou': 0.4991019,
           'avg_obj': 0.2517922,
           'box_loss': 2.8253288,
           'class_loss': 1.1887437,
           'conf_loss': 41.396164,
           'precision50': 0.1417536,
           'recall50': 0.25591683},
     '4': {'avg_iou': 0.71924955,
           'avg_obj': 0.49140927,
           'box_loss': 2.1468112,
           'class_loss': 0.96152323,
           'conf_loss': 10.553808,
           'precision50': 0.1749321,
           'recall50': 0.54519826},
     '5': {'avg_iou': 0.77977085,
           'avg_obj': 0.6127927,
           'box_loss': 1.1101421,
           'class_loss': 0.5195214,
           'conf_loss': 1.985019,
           'precision50': 0.23233427,
           'recall50': 0.6934641},
     'AP': 0.34596863,
     'AP50': 0.5433493,
     'AP75': 0.37520987,
     'APl': 0.48286578,
     'APm': 0.3669193,
     'APs': 0.13546903,
     'ARl': 0.65591276,
     'ARm': 0.55754775,
     'ARmax1': 0.2890037,
     'ARmax10': 0.47437572,
     'ARmax100': 0.51564276,
     'ARs': 0.28400096,
     'global': {'total_loss': 62.687057},
     'validation_loss': 62.687057}
I0425 10:23:17.060001 140388535805760 controller.py:211] train | step:  80000 | training until step 100000...
I0425 11:23:02.183114 140388535805760 controller.py:425] train | step:  90000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6565041,
           'avg_obj': 0.28160432,
           'box_loss': 4.051962,
           'class_loss': 2.1222494,
           'conf_loss': 47.18447,
           'precision50': 0.15869226,
           'recall50': 0.19347255},
     '4': {'avg_iou': 0.7759171,
           'avg_obj': 0.44656098,
           'box_loss': 2.6329548,
           'class_loss': 1.6767975,
           'conf_loss': 12.360111,
           'precision50': 0.19298418,
           'recall50': 0.43227285},
     '5': {'avg_iou': 0.80939883,
           'avg_obj': 0.5420432,
           'box_loss': 1.2230783,
           'class_loss': 0.8849262,
           'conf_loss': 2.3601987,
           'precision50': 0.25222465,
           'recall50': 0.59139353},
     'global': {'total_loss': 74.49675},
     'learning_rate': 0.001,
     'training_loss': 74.49675}
I0425 11:23:48.381843 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-90000.
I0425 12:29:29.788986 140388535805760 controller.py:425] train | step:  100000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6591134,
           'avg_obj': 0.2877055,
           'box_loss': 4.035631,
           'class_loss': 2.090909,
           'conf_loss': 47.28715,
           'precision50': 0.15482092,
           'recall50': 0.20032491},
     '4': {'avg_iou': 0.77811664,
           'avg_obj': 0.45289618,
           'box_loss': 2.6127536,
           'class_loss': 1.6465138,
           'conf_loss': 12.370363,
           'precision50': 0.19237636,
           'recall50': 0.43993765},
     '5': {'avg_iou': 0.81184876,
           'avg_obj': 0.547991,
           'box_loss': 1.2083926,
           'class_loss': 0.8676554,
           'conf_loss': 2.3437116,
           'precision50': 0.25162613,
           'recall50': 0.5986791},
     'global': {'total_loss': 74.463165},
     'learning_rate': 0.001,
     'training_loss': 74.463165}
I0425 12:30:16.617102 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-100000.
I0425 12:30:16.623200 140388535805760 controller.py:252]  eval | step:  100000 | running 625 steps of evaluation...
I0425 12:34:25.844951 140388535805760 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0425 12:39:17.093532 140388535805760 controller.py:261]  eval | step:  100000 | eval time:  540.5 sec | output: 
    {'3': {'avg_iou': 0.50080913,
           'avg_obj': 0.24701697,
           'box_loss': 2.8003137,
           'class_loss': 1.1446693,
           'conf_loss': 41.59756,
           'precision50': 0.14002562,
           'recall50': 0.2495176},
     '4': {'avg_iou': 0.72095436,
           'avg_obj': 0.49127182,
           'box_loss': 2.1268876,
           'class_loss': 0.923828,
           'conf_loss': 10.5497265,
           'precision50': 0.17410694,
           'recall50': 0.5433193},
     '5': {'avg_iou': 0.7836798,
           'avg_obj': 0.61863494,
           'box_loss': 1.0887831,
           'class_loss': 0.5000882,
           'conf_loss': 1.975075,
           'precision50': 0.22931665,
           'recall50': 0.70037884},
     'AP': 0.35207254,
     'AP50': 0.5500765,
     'AP75': 0.38204926,
     'APl': 0.49478847,
     'APm': 0.37079668,
     'APs': 0.13924105,
     'ARl': 0.66819406,
     'ARm': 0.5575587,
     'ARmax1': 0.29345196,
     'ARmax10': 0.48019686,
     'ARmax100': 0.5210846,
     'ARs': 0.28926817,
     'global': {'total_loss': 62.706963},
     'validation_loss': 62.706963}

train | step:  60000 | training until step 80000...
train | step:  70000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.65260786,
           'avg_obj': 0.2717491,
           'box_loss': 4.105751,
           'class_loss': 2.2153378,
           'conf_loss': 47.4974,
           'precision50': 0.15317208,
           'recall50': 0.18422368},
     '4': {'avg_iou': 0.770136,
           'avg_obj': 0.43185243,
           'box_loss': 2.702338,
           'class_loss': 1.7683756,
           'conf_loss': 12.549981,
           'precision50': 0.1920377,
           'recall50': 0.41628292},
     '5': {'avg_iou': 0.8029391,
           'avg_obj': 0.52664423,
           'box_loss': 1.266839,
           'class_loss': 0.93928015,
           'conf_loss': 2.4181416,
           'precision50': 0.25332204,
           'recall50': 0.5751262},
     'global': {'total_loss': 75.46339},
     'learning_rate': 0.001,
     'training_loss': 75.46339}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-70000.
train | step:  80000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6554828,
           'avg_obj': 0.2776719,
           'box_loss': 4.067641,
           'class_loss': 2.163885,
           'conf_loss': 47.310772,
           'precision50': 0.15410277,
           'recall50': 0.18968403},
     '4': {'avg_iou': 0.7732308,
           'avg_obj': 0.43952003,
           'box_loss': 2.660143,
           'class_loss': 1.715679,
           'conf_loss': 12.4367285,
           'precision50': 0.19248122,
           'recall50': 0.4248817},
     '5': {'avg_iou': 0.8063015,
           'avg_obj': 0.53417605,
           'box_loss': 1.2411404,
           'class_loss': 0.90781194,
           'conf_loss': 2.381652,
           'precision50': 0.25265032,
           'recall50': 0.5827498},
     'global': {'total_loss': 74.88515},
     'learning_rate': 0.001,
     'training_loss': 74.88515}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-80000.
 eval | step:  80000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=196.75s).
Accumulating evaluation results...
DONE (t=30.68s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.346
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.543
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.375
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.135
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.367
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.483
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.289
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.474
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.516
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.284
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.558
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.656
 eval | step:  80000 | eval time:  542.7 sec | output: 
    {'3': {'avg_iou': 0.4991019,
           'avg_obj': 0.2517922,
           'box_loss': 2.8253288,
           'class_loss': 1.1887437,
           'conf_loss': 41.396164,
           'precision50': 0.1417536,
           'recall50': 0.25591683},
     '4': {'avg_iou': 0.71924955,
           'avg_obj': 0.49140927,
           'box_loss': 2.1468112,
           'class_loss': 0.96152323,
           'conf_loss': 10.553808,
           'precision50': 0.1749321,
           'recall50': 0.54519826},
     '5': {'avg_iou': 0.77977085,
           'avg_obj': 0.6127927,
           'box_loss': 1.1101421,
           'class_loss': 0.5195214,
           'conf_loss': 1.985019,
           'precision50': 0.23233427,
           'recall50': 0.6934641},
     'AP': 0.34596863,
     'AP50': 0.5433493,
     'AP75': 0.37520987,
     'APl': 0.48286578,
     'APm': 0.3669193,
     'APs': 0.13546903,
     'ARl': 0.65591276,
     'ARm': 0.55754775,
     'ARmax1': 0.2890037,
     'ARmax10': 0.47437572,
     'ARmax100': 0.51564276,
     'ARs': 0.28400096,
     'global': {'total_loss': 62.687057},
     'validation_loss': 62.687057}
train | step:  80000 | training until step 100000...
train | step:  90000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6565041,
           'avg_obj': 0.28160432,
           'box_loss': 4.051962,
           'class_loss': 2.1222494,
           'conf_loss': 47.18447,
           'precision50': 0.15869226,
           'recall50': 0.19347255},
     '4': {'avg_iou': 0.7759171,
           'avg_obj': 0.44656098,
           'box_loss': 2.6329548,
           'class_loss': 1.6767975,
           'conf_loss': 12.360111,
           'precision50': 0.19298418,
           'recall50': 0.43227285},
     '5': {'avg_iou': 0.80939883,
           'avg_obj': 0.5420432,
           'box_loss': 1.2230783,
           'class_loss': 0.8849262,
           'conf_loss': 2.3601987,
           'precision50': 0.25222465,
           'recall50': 0.59139353},
     'global': {'total_loss': 74.49675},
     'learning_rate': 0.001,
     'training_loss': 74.49675}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-90000.
train | step:  100000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6591134,
           'avg_obj': 0.2877055,
           'box_loss': 4.035631,
           'class_loss': 2.090909,
           'conf_loss': 47.28715,
           'precision50': 0.15482092,
           'recall50': 0.20032491},
     '4': {'avg_iou': 0.77811664,
           'avg_obj': 0.45289618,
           'box_loss': 2.6127536,
           'class_loss': 1.6465138,
           'conf_loss': 12.370363,
           'precision50': 0.19237636,
           'recall50': 0.43993765},
     '5': {'avg_iou': 0.81184876,
           'avg_obj': 0.547991,
           'box_loss': 1.2083926,
           'class_loss': 0.8676554,
           'conf_loss': 2.3437116,
           'precision50': 0.25162613,
           'recall50': 0.5986791},
     'global': {'total_loss': 74.463165},
     'learning_rate': 0.001,
     'training_loss': 74.463165}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-100000.
 eval | step:  100000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=191.64s).
Accumulating evaluation results...
DONE (t=32.87s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.352
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.550
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.382
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.139
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.371
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.495
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.293
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.480
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.521
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.289
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.558
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.668
 eval | step:  100000 | eval time:  540.5 sec | output: 
    {'3': {'avg_iou': 0.50080913,
           'avg_obj': 0.24701697,
           'box_loss': 2.8003137,
           'class_loss': 1.1446693,
           'conf_loss': 41.59756,
           'precision50': 0.14002562,
           'recall50': 0.2495176},
     '4': {'avg_iou': 0.72095436,
           'avg_obj': 0.49127182,
           'box_loss': 2.1268876,
           'class_loss': 0.923828,
           'conf_loss': 10.5497265,
           'precision50': 0.17410694,
           'recall50': 0.5433193},
     '5': {'avg_iou': 0.7836798,
           'avg_obj': 0.61863494,
           'box_loss': 1.0887831,
           'class_loss': 0.5000882,
           'conf_loss': 1.975075,
           'precision50': 0.22931665,
           'recall50': 0.70037884},
     'AP': 0.35207254,
     'AP50': 0.5500765,
     'AP75': 0.38204926,
     'APl': 0.49478847,
     'APm': 0.37079668,
     'APs': 0.13924105,
     'ARl': 0.66819406,
     'ARm': 0.5575587,
     'ARmax1': 0.29345196,
     'ARmax10': 0.48019686,
     'ARmax100': 0.5210846,
     'ARs': 0.28926817,
     'global': {'total_loss': 62.706963},
     'validation_loss': 62.706963}I0425 12:39:33.158516 140388535805760 controller.py:211] train | step:  100000 | training until step 120000...
I0425 13:43:38.326011 140388535805760 controller.py:425] train | step:  110000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.66111434,
           'avg_obj': 0.2917929,
           'box_loss': 3.9886687,
           'class_loss': 2.0423222,
           'conf_loss': 46.908012,
           'precision50': 0.15440029,
           'recall50': 0.20391706},
     '4': {'avg_iou': 0.7803108,
           'avg_obj': 0.4581336,
           'box_loss': 2.5782027,
           'class_loss': 1.6063956,
           'conf_loss': 12.273336,
           'precision50': 0.19222033,
           'recall50': 0.4462011},
     '5': {'avg_iou': 0.81405467,
           'avg_obj': 0.55328125,
           'box_loss': 1.1941723,
           'class_loss': 0.8479412,
           'conf_loss': 2.3271658,
           'precision50': 0.25178275,
           'recall50': 0.60432833},
     'global': {'total_loss': 73.766335},
     'learning_rate': 0.001,
     'training_loss': 73.766335}
I0425 13:44:23.539639 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-110000.
I0425 14:55:28.888546 140388535805760 controller.py:425] train | step:  120000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6624672,
           'avg_obj': 0.29646343,
           'box_loss': 3.9845788,
           'class_loss': 2.0175087,
           'conf_loss': 46.425632,
           'precision50': 0.15567526,
           'recall50': 0.2088057},
     '4': {'avg_iou': 0.78231424,
           'avg_obj': 0.46416295,
           'box_loss': 2.5584793,
           'class_loss': 1.5801393,
           'conf_loss': 12.218503,
           'precision50': 0.19287972,
           'recall50': 0.45293394},
     '5': {'avg_iou': 0.8161781,
           'avg_obj': 0.5583146,
           'box_loss': 1.1804674,
           'class_loss': 0.83353,
           'conf_loss': 2.3066468,
           'precision50': 0.2511546,
           'recall50': 0.6087746},
     'global': {'total_loss': 73.10545},
     'learning_rate': 0.001,
     'training_loss': 73.10545}
I0425 14:56:16.806383 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-120000.
I0425 14:56:16.812729 140388535805760 controller.py:252]  eval | step:  120000 | running 625 steps of evaluation...
I0425 15:00:21.078949 140388535805760 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0425 15:04:58.301723 140388535805760 controller.py:261]  eval | step:  120000 | eval time:  521.5 sec | output: 
    {'3': {'avg_iou': 0.50144595,
           'avg_obj': 0.26134828,
           'box_loss': 2.7891889,
           'class_loss': 1.1167752,
           'conf_loss': 41.256,
           'precision50': 0.14110772,
           'recall50': 0.27057895},
     '4': {'avg_iou': 0.7236501,
           'avg_obj': 0.5043231,
           'box_loss': 2.0990343,
           'class_loss': 0.90728563,
           'conf_loss': 10.563343,
           'precision50': 0.17254147,
           'recall50': 0.5606069},
     '5': {'avg_iou': 0.7857528,
           'avg_obj': 0.628097,
           'box_loss': 1.0734714,
           'class_loss': 0.49093866,
           'conf_loss': 1.9587152,
           'precision50': 0.22719629,
           'recall50': 0.7085764},
     'AP': 0.35943106,
     'AP50': 0.55743694,
     'AP75': 0.3948932,
     'APl': 0.5002036,
     'APm': 0.38056076,
     'APs': 0.14395896,
     'ARl': 0.6665437,
     'ARm': 0.5628047,
     'ARmax1': 0.2983148,
     'ARmax10': 0.48471698,
     'ARmax100': 0.52561855,
     'ARs': 0.30138388,
     'global': {'total_loss': 62.254776},
     'validation_loss': 62.254776}
I0425 15:05:14.548373 140388535805760 controller.py:211] train | step:  120000 | training until step 140000...
I0425 16:04:15.858546 140388535805760 controller.py:425] train | step:  130000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.66327304,
           'avg_obj': 0.29991522,
           'box_loss': 3.9861968,
           'class_loss': 1.997472,
           'conf_loss': 46.329292,
           'precision50': 0.15807325,
           'recall50': 0.21211894},
     '4': {'avg_iou': 0.7839808,
           'avg_obj': 0.46907514,
           'box_loss': 2.5404568,
           'class_loss': 1.5601996,
           'conf_loss': 12.137709,
           'precision50': 0.19414414,
           'recall50': 0.45815903},
     '5': {'avg_iou': 0.8179574,
           'avg_obj': 0.5631935,
           'box_loss': 1.1692694,
           'class_loss': 0.8228723,
           'conf_loss': 2.2906811,
           'precision50': 0.2517106,
           'recall50': 0.6144522},
     'global': {'total_loss': 72.83385},
     'learning_rate': 0.001,
     'training_loss': 72.83385}
I0425 16:05:01.515038 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-130000.
I0425 17:08:43.830245 140388535805760 controller.py:425] train | step:  140000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6646907,
           'avg_obj': 0.30370104,
           'box_loss': 3.9667747,
           'class_loss': 1.9712018,
           'conf_loss': 45.92597,
           'precision50': 0.15682736,
           'recall50': 0.2164045},
     '4': {'avg_iou': 0.7854129,
           'avg_obj': 0.4732734,
           'box_loss': 2.5212176,
           'class_loss': 1.5340719,
           'conf_loss': 12.1169815,
           'precision50': 0.19210756,
           'recall50': 0.46299922},
     '5': {'avg_iou': 0.8195794,
           'avg_obj': 0.56711406,
           'box_loss': 1.1584784,
           'class_loss': 0.80805725,
           'conf_loss': 2.2692373,
           'precision50': 0.25250342,
           'recall50': 0.61907053},
     'global': {'total_loss': 72.27214},
     'learning_rate': 0.001,
     'training_loss': 72.27214}
I0425 17:09:36.078424 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-140000.
I0425 17:09:36.086162 140388535805760 controller.py:252]  eval | step:  140000 | running 625 steps of evaluation...
I0425 17:13:46.349403 140388535805760 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0425 17:18:16.184171 140388535805760 controller.py:261]  eval | step:  140000 | eval time:  520.1 sec | output: 
    {'3': {'avg_iou': 0.5029618,
           'avg_obj': 0.25751403,
           'box_loss': 2.7733874,
           'class_loss': 1.095536,
           'conf_loss': 41.10239,
           'precision50': 0.14161834,
           'recall50': 0.266464},
     '4': {'avg_iou': 0.72457415,
           'avg_obj': 0.5041789,
           'box_loss': 2.0873241,
           'class_loss': 0.8800246,
           'conf_loss': 10.618635,
           'precision50': 0.17115289,
           'recall50': 0.56001335},
     '5': {'avg_iou': 0.7880849,
           'avg_obj': 0.63031507,
           'box_loss': 1.0604728,
           'class_loss': 0.4785186,
           'conf_loss': 1.9550595,
           'precision50': 0.22697388,
           'recall50': 0.71014494},
     'AP': 0.36186832,
     'AP50': 0.56066936,
     'AP75': 0.3922007,
     'APl': 0.5036075,
     'APm': 0.38465497,
     'APs': 0.14494312,
     'ARl': 0.6733775,
     'ARm': 0.5678035,
     'ARmax1': 0.2988495,
     'ARmax10': 0.48680428,
     'ARmax100': 0.5277159,
     'ARs': 0.29868296,
     'global': {'total_loss': 62.05135},
     'validation_loss': 62.05135}

train | step:  100000 | training until step 120000...
train | step:  110000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.66111434,
           'avg_obj': 0.2917929,
           'box_loss': 3.9886687,
           'class_loss': 2.0423222,
           'conf_loss': 46.908012,
           'precision50': 0.15440029,
           'recall50': 0.20391706},
     '4': {'avg_iou': 0.7803108,
           'avg_obj': 0.4581336,
           'box_loss': 2.5782027,
           'class_loss': 1.6063956,
           'conf_loss': 12.273336,
           'precision50': 0.19222033,
           'recall50': 0.4462011},
     '5': {'avg_iou': 0.81405467,
           'avg_obj': 0.55328125,
           'box_loss': 1.1941723,
           'class_loss': 0.8479412,
           'conf_loss': 2.3271658,
           'precision50': 0.25178275,
           'recall50': 0.60432833},
     'global': {'total_loss': 73.766335},
     'learning_rate': 0.001,
     'training_loss': 73.766335}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-110000.
train | step:  120000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6624672,
           'avg_obj': 0.29646343,
           'box_loss': 3.9845788,
           'class_loss': 2.0175087,
           'conf_loss': 46.425632,
           'precision50': 0.15567526,
           'recall50': 0.2088057},
     '4': {'avg_iou': 0.78231424,
           'avg_obj': 0.46416295,
           'box_loss': 2.5584793,
           'class_loss': 1.5801393,
           'conf_loss': 12.218503,
           'precision50': 0.19287972,
           'recall50': 0.45293394},
     '5': {'avg_iou': 0.8161781,
           'avg_obj': 0.5583146,
           'box_loss': 1.1804674,
           'class_loss': 0.83353,
           'conf_loss': 2.3066468,
           'precision50': 0.2511546,
           'recall50': 0.6087746},
     'global': {'total_loss': 73.10545},
     'learning_rate': 0.001,
     'training_loss': 73.10545}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-120000.
 eval | step:  120000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=187.26s).
Accumulating evaluation results...
DONE (t=33.57s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.359
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.557
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.395
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.144
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.381
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.500
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.298
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.526
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.301
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.563
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.667
 eval | step:  120000 | eval time:  521.5 sec | output: 
    {'3': {'avg_iou': 0.50144595,
           'avg_obj': 0.26134828,
           'box_loss': 2.7891889,
           'class_loss': 1.1167752,
           'conf_loss': 41.256,
           'precision50': 0.14110772,
           'recall50': 0.27057895},
     '4': {'avg_iou': 0.7236501,
           'avg_obj': 0.5043231,
           'box_loss': 2.0990343,
           'class_loss': 0.90728563,
           'conf_loss': 10.563343,
           'precision50': 0.17254147,
           'recall50': 0.5606069},
     '5': {'avg_iou': 0.7857528,
           'avg_obj': 0.628097,
           'box_loss': 1.0734714,
           'class_loss': 0.49093866,
           'conf_loss': 1.9587152,
           'precision50': 0.22719629,
           'recall50': 0.7085764},
     'AP': 0.35943106,
     'AP50': 0.55743694,
     'AP75': 0.3948932,
     'APl': 0.5002036,
     'APm': 0.38056076,
     'APs': 0.14395896,
     'ARl': 0.6665437,
     'ARm': 0.5628047,
     'ARmax1': 0.2983148,
     'ARmax10': 0.48471698,
     'ARmax100': 0.52561855,
     'ARs': 0.30138388,
     'global': {'total_loss': 62.254776},
     'validation_loss': 62.254776}
train | step:  120000 | training until step 140000...
train | step:  130000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.66327304,
           'avg_obj': 0.29991522,
           'box_loss': 3.9861968,
           'class_loss': 1.997472,
           'conf_loss': 46.329292,
           'precision50': 0.15807325,
           'recall50': 0.21211894},
     '4': {'avg_iou': 0.7839808,
           'avg_obj': 0.46907514,
           'box_loss': 2.5404568,
           'class_loss': 1.5601996,
           'conf_loss': 12.137709,
           'precision50': 0.19414414,
           'recall50': 0.45815903},
     '5': {'avg_iou': 0.8179574,
           'avg_obj': 0.5631935,
           'box_loss': 1.1692694,
           'class_loss': 0.8228723,
           'conf_loss': 2.2906811,
           'precision50': 0.2517106,
           'recall50': 0.6144522},
     'global': {'total_loss': 72.83385},
     'learning_rate': 0.001,
     'training_loss': 72.83385}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-130000.
train | step:  140000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6646907,
           'avg_obj': 0.30370104,
           'box_loss': 3.9667747,
           'class_loss': 1.9712018,
           'conf_loss': 45.92597,
           'precision50': 0.15682736,
           'recall50': 0.2164045},
     '4': {'avg_iou': 0.7854129,
           'avg_obj': 0.4732734,
           'box_loss': 2.5212176,
           'class_loss': 1.5340719,
           'conf_loss': 12.1169815,
           'precision50': 0.19210756,
           'recall50': 0.46299922},
     '5': {'avg_iou': 0.8195794,
           'avg_obj': 0.56711406,
           'box_loss': 1.1584784,
           'class_loss': 0.80805725,
           'conf_loss': 2.2692373,
           'precision50': 0.25250342,
           'recall50': 0.61907053},
     'global': {'total_loss': 72.27214},
     'learning_rate': 0.001,
     'training_loss': 72.27214}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-140000.
 eval | step:  140000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=190.04s).
Accumulating evaluation results...
DONE (t=28.13s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.362
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.561
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.392
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.145
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.385
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.504
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.299
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.487
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.528
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.299
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.568
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.673
 eval | step:  140000 | eval time:  520.1 sec | output: 
    {'3': {'avg_iou': 0.5029618,
           'avg_obj': 0.25751403,
           'box_loss': 2.7733874,
           'class_loss': 1.095536,
           'conf_loss': 41.10239,
           'precision50': 0.14161834,
           'recall50': 0.266464},
     '4': {'avg_iou': 0.72457415,
           'avg_obj': 0.5041789,
           'box_loss': 2.0873241,
           'class_loss': 0.8800246,
           'conf_loss': 10.618635,
           'precision50': 0.17115289,
           'recall50': 0.56001335},
     '5': {'avg_iou': 0.7880849,
           'avg_obj': 0.63031507,
           'box_loss': 1.0604728,
           'class_loss': 0.4785186,
           'conf_loss': 1.9550595,
           'precision50': 0.22697388,
           'recall50': 0.71014494},
     'AP': 0.36186832,
     'AP50': 0.56066936,
     'AP75': 0.3922007,
     'APl': 0.5036075,
     'APm': 0.38465497,
     'APs': 0.14494312,
     'ARl': 0.6733775,
     'ARm': 0.5678035,
     'ARmax1': 0.2988495,
     'ARmax10': 0.48680428,
     'ARmax100': 0.5277159,
     'ARs': 0.29868296,
     'global': {'total_loss': 62.05135},
     'validation_loss': 62.05135}I0425 17:18:32.982218 140388535805760 controller.py:211] train | step:  140000 | training until step 160000...
I0425 18:15:46.198912 140388535805760 controller.py:425] train | step:  150000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6662753,
           'avg_obj': 0.30791095,
           'box_loss': 3.951936,
           'class_loss': 1.9457508,
           'conf_loss': 45.821667,
           'precision50': 0.15852359,
           'recall50': 0.22073723},
     '4': {'avg_iou': 0.7870165,
           'avg_obj': 0.47825962,
           'box_loss': 2.5072231,
           'class_loss': 1.5166904,
           'conf_loss': 12.054615,
           'precision50': 0.1933097,
           'recall50': 0.4685594},
     '5': {'avg_iou': 0.8210914,
           'avg_obj': 0.5713223,
           'box_loss': 1.150082,
           'class_loss': 0.79716897,
           'conf_loss': 2.2521994,
           'precision50': 0.2526005,
           'recall50': 0.6228841},
     'global': {'total_loss': 71.99731},
     'learning_rate': 0.001,
     'training_loss': 71.99731}
I0425 18:16:31.777342 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-150000.
I0425 19:16:07.183409 140388535805760 controller.py:425] train | step:  160000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.66655236,
           'avg_obj': 0.31000304,
           'box_loss': 3.9424942,
           'class_loss': 1.9320221,
           'conf_loss': 46.776764,
           'precision50': 0.15605852,
           'recall50': 0.22336821},
     '4': {'avg_iou': 0.7880207,
           'avg_obj': 0.4816294,
           'box_loss': 2.4942887,
           'class_loss': 1.5002025,
           'conf_loss': 11.967942,
           'precision50': 0.19334231,
           'recall50': 0.4734328},
     '5': {'avg_iou': 0.8224333,
           'avg_obj': 0.5749881,
           'box_loss': 1.1405119,
           'class_loss': 0.7853673,
           'conf_loss': 2.2404451,
           'precision50': 0.2523509,
           'recall50': 0.62719977},
     'global': {'total_loss': 72.780106},
     'learning_rate': 0.001,
     'training_loss': 72.780106}
I0425 19:16:54.243671 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-160000.
I0425 19:16:54.249967 140388535805760 controller.py:252]  eval | step:  160000 | running 625 steps of evaluation...
I0425 19:21:05.892158 140388535805760 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0425 19:28:01.280717 140388535805760 controller.py:261]  eval | step:  160000 | eval time:  667.0 sec | output: 
    {'3': {'avg_iou': 0.50366735,
           'avg_obj': 0.260973,
           'box_loss': 2.7635157,
           'class_loss': 1.0912143,
           'conf_loss': 42.130447,
           'precision50': 0.141983,
           'recall50': 0.2714178},
     '4': {'avg_iou': 0.72578084,
           'avg_obj': 0.51033396,
           'box_loss': 2.076086,
           'class_loss': 0.87242687,
           'conf_loss': 10.65997,
           'precision50': 0.1684948,
           'recall50': 0.56662023},
     '5': {'avg_iou': 0.79028666,
           'avg_obj': 0.63579255,
           'box_loss': 1.0465285,
           'class_loss': 0.47294033,
           'conf_loss': 1.9487222,
           'precision50': 0.22624163,
           'recall50': 0.71519405},
     'AP': 0.3649047,
     'AP50': 0.5620244,
     'AP75': 0.39805472,
     'APl': 0.50770485,
     'APm': 0.389075,
     'APs': 0.1468979,
     'ARl': 0.6766153,
     'ARm': 0.5759984,
     'ARmax1': 0.30074152,
     'ARmax10': 0.49121013,
     'ARmax100': 0.5315402,
     'ARs': 0.30715007,
     'global': {'total_loss': 63.061787},
     'validation_loss': 63.061787}
I0425 19:28:17.718245 140388535805760 controller.py:211] train | step:  160000 | training until step 180000...
I0425 20:24:54.639810 140388535805760 controller.py:425] train | step:  170000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6656377,
           'avg_obj': 0.3113071,
           'box_loss': 3.944951,
           'class_loss': 1.9195147,
           'conf_loss': 49.73237,
           'precision50': 0.14903164,
           'recall50': 0.22336209},
     '4': {'avg_iou': 0.7884023,
           'avg_obj': 0.4832705,
           'box_loss': 2.4813418,
           'class_loss': 1.4882386,
           'conf_loss': 11.958221,
           'precision50': 0.19111516,
           'recall50': 0.47404352},
     '5': {'avg_iou': 0.8233338,
           'avg_obj': 0.5769136,
           'box_loss': 1.1314913,
           'class_loss': 0.7815616,
           'conf_loss': 2.2258933,
           'precision50': 0.25257015,
           'recall50': 0.62840533},
     'global': {'total_loss': 75.663734},
     'learning_rate': 0.001,
     'training_loss': 75.663734}
I0425 20:25:41.342691 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-170000.
I0425 21:24:24.686495 140388535805760 controller.py:425] train | step:  180000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.66646093,
           'avg_obj': 0.31331503,
           'box_loss': 3.92675,
           'class_loss': 1.9000474,
           'conf_loss': 48.585064,
           'precision50': 0.14735273,
           'recall50': 0.22492044},
     '4': {'avg_iou': 0.7897578,
           'avg_obj': 0.48700592,
           'box_loss': 2.4616675,
           'class_loss': 1.4676819,
           'conf_loss': 11.945692,
           'precision50': 0.19037297,
           'recall50': 0.47762603},
     '5': {'avg_iou': 0.8248306,
           'avg_obj': 0.579918,
           'box_loss': 1.1227303,
           'class_loss': 0.7730583,
           'conf_loss': 2.2211773,
           'precision50': 0.25228015,
           'recall50': 0.6318835},
     'global': {'total_loss': 74.4038},
     'learning_rate': 0.001,
     'training_loss': 74.4038}
I0425 21:25:13.159966 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-180000.
I0425 21:25:13.165611 140388535805760 controller.py:252]  eval | step:  180000 | running 625 steps of evaluation...
I0425 21:29:20.572504 140388535805760 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0425 21:34:06.009968 140388535805760 controller.py:261]  eval | step:  180000 | eval time:  532.8 sec | output: 
    {'3': {'avg_iou': 0.5022216,
           'avg_obj': 0.25997728,
           'box_loss': 2.7731695,
           'class_loss': 1.0842001,
           'conf_loss': 45.373955,
           'precision50': 0.12856898,
           'recall50': 0.26846954},
     '4': {'avg_iou': 0.7261791,
           'avg_obj': 0.5103421,
           'box_loss': 2.0714984,
           'class_loss': 0.86243504,
           'conf_loss': 10.719275,
           'precision50': 0.16758429,
           'recall50': 0.5662163},
     '5': {'avg_iou': 0.79103166,
           'avg_obj': 0.6368693,
           'box_loss': 1.0419545,
           'class_loss': 0.46492177,
           'conf_loss': 1.9427315,
           'precision50': 0.22677661,
           'recall50': 0.71660984},
     'AP': 0.36863282,
     'AP50': 0.5642708,
     'AP75': 0.4022233,
     'APl': 0.51753384,
     'APm': 0.39099345,
     'APs': 0.1449851,
     'ARl': 0.6794888,
     'ARm': 0.5746137,
     'ARmax1': 0.303034,
     'ARmax10': 0.49330488,
     'ARmax100': 0.53279406,
     'ARs': 0.30486453,
     'global': {'total_loss': 66.334145},
     'validation_loss': 66.334145}

train | step:  140000 | training until step 160000...
train | step:  150000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6662753,
           'avg_obj': 0.30791095,
           'box_loss': 3.951936,
           'class_loss': 1.9457508,
           'conf_loss': 45.821667,
           'precision50': 0.15852359,
           'recall50': 0.22073723},
     '4': {'avg_iou': 0.7870165,
           'avg_obj': 0.47825962,
           'box_loss': 2.5072231,
           'class_loss': 1.5166904,
           'conf_loss': 12.054615,
           'precision50': 0.1933097,
           'recall50': 0.4685594},
     '5': {'avg_iou': 0.8210914,
           'avg_obj': 0.5713223,
           'box_loss': 1.150082,
           'class_loss': 0.79716897,
           'conf_loss': 2.2521994,
           'precision50': 0.2526005,
           'recall50': 0.6228841},
     'global': {'total_loss': 71.99731},
     'learning_rate': 0.001,
     'training_loss': 71.99731}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-150000.
train | step:  160000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.66655236,
           'avg_obj': 0.31000304,
           'box_loss': 3.9424942,
           'class_loss': 1.9320221,
           'conf_loss': 46.776764,
           'precision50': 0.15605852,
           'recall50': 0.22336821},
     '4': {'avg_iou': 0.7880207,
           'avg_obj': 0.4816294,
           'box_loss': 2.4942887,
           'class_loss': 1.5002025,
           'conf_loss': 11.967942,
           'precision50': 0.19334231,
           'recall50': 0.4734328},
     '5': {'avg_iou': 0.8224333,
           'avg_obj': 0.5749881,
           'box_loss': 1.1405119,
           'class_loss': 0.7853673,
           'conf_loss': 2.2404451,
           'precision50': 0.2523509,
           'recall50': 0.62719977},
     'global': {'total_loss': 72.780106},
     'learning_rate': 0.001,
     'training_loss': 72.780106}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-160000.
 eval | step:  160000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=194.86s).
Accumulating evaluation results...
DONE (t=29.36s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.365
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.562
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.398
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.147
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.389
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.508
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.301
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.532
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.307
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.576
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.677
 eval | step:  160000 | eval time:  667.0 sec | output: 
    {'3': {'avg_iou': 0.50366735,
           'avg_obj': 0.260973,
           'box_loss': 2.7635157,
           'class_loss': 1.0912143,
           'conf_loss': 42.130447,
           'precision50': 0.141983,
           'recall50': 0.2714178},
     '4': {'avg_iou': 0.72578084,
           'avg_obj': 0.51033396,
           'box_loss': 2.076086,
           'class_loss': 0.87242687,
           'conf_loss': 10.65997,
           'precision50': 0.1684948,
           'recall50': 0.56662023},
     '5': {'avg_iou': 0.79028666,
           'avg_obj': 0.63579255,
           'box_loss': 1.0465285,
           'class_loss': 0.47294033,
           'conf_loss': 1.9487222,
           'precision50': 0.22624163,
           'recall50': 0.71519405},
     'AP': 0.3649047,
     'AP50': 0.5620244,
     'AP75': 0.39805472,
     'APl': 0.50770485,
     'APm': 0.389075,
     'APs': 0.1468979,
     'ARl': 0.6766153,
     'ARm': 0.5759984,
     'ARmax1': 0.30074152,
     'ARmax10': 0.49121013,
     'ARmax100': 0.5315402,
     'ARs': 0.30715007,
     'global': {'total_loss': 63.061787},
     'validation_loss': 63.061787}
train | step:  160000 | training until step 180000...
train | step:  170000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6656377,
           'avg_obj': 0.3113071,
           'box_loss': 3.944951,
           'class_loss': 1.9195147,
           'conf_loss': 49.73237,
           'precision50': 0.14903164,
           'recall50': 0.22336209},
     '4': {'avg_iou': 0.7884023,
           'avg_obj': 0.4832705,
           'box_loss': 2.4813418,
           'class_loss': 1.4882386,
           'conf_loss': 11.958221,
           'precision50': 0.19111516,
           'recall50': 0.47404352},
     '5': {'avg_iou': 0.8233338,
           'avg_obj': 0.5769136,
           'box_loss': 1.1314913,
           'class_loss': 0.7815616,
           'conf_loss': 2.2258933,
           'precision50': 0.25257015,
           'recall50': 0.62840533},
     'global': {'total_loss': 75.663734},
     'learning_rate': 0.001,
     'training_loss': 75.663734}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-170000.
train | step:  180000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.66646093,
           'avg_obj': 0.31331503,
           'box_loss': 3.92675,
           'class_loss': 1.9000474,
           'conf_loss': 48.585064,
           'precision50': 0.14735273,
           'recall50': 0.22492044},
     '4': {'avg_iou': 0.7897578,
           'avg_obj': 0.48700592,
           'box_loss': 2.4616675,
           'class_loss': 1.4676819,
           'conf_loss': 11.945692,
           'precision50': 0.19037297,
           'recall50': 0.47762603},
     '5': {'avg_iou': 0.8248306,
           'avg_obj': 0.579918,
           'box_loss': 1.1227303,
           'class_loss': 0.7730583,
           'conf_loss': 2.2211773,
           'precision50': 0.25228015,
           'recall50': 0.6318835},
     'global': {'total_loss': 74.4038},
     'learning_rate': 0.001,
     'training_loss': 74.4038}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-180000.
 eval | step:  180000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=194.55s).
Accumulating evaluation results...
DONE (t=28.56s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.369
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.564
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.402
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.145
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.391
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.518
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.303
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.493
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.533
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.305
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.575
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.679
 eval | step:  180000 | eval time:  532.8 sec | output: 
    {'3': {'avg_iou': 0.5022216,
           'avg_obj': 0.25997728,
           'box_loss': 2.7731695,
           'class_loss': 1.0842001,
           'conf_loss': 45.373955,
           'precision50': 0.12856898,
           'recall50': 0.26846954},
     '4': {'avg_iou': 0.7261791,
           'avg_obj': 0.5103421,
           'box_loss': 2.0714984,
           'class_loss': 0.86243504,
           'conf_loss': 10.719275,
           'precision50': 0.16758429,
           'recall50': 0.5662163},
     '5': {'avg_iou': 0.79103166,
           'avg_obj': 0.6368693,
           'box_loss': 1.0419545,
           'class_loss': 0.46492177,
           'conf_loss': 1.9427315,
           'precision50': 0.22677661,
           'recall50': 0.71660984},
     'AP': 0.36863282,
     'AP50': 0.5642708,
     'AP75': 0.4022233,
     'APl': 0.51753384,
     'APm': 0.39099345,
     'APs': 0.1449851,
     'ARl': 0.6794888,
     'ARm': 0.5746137,
     'ARmax1': 0.303034,
     'ARmax10': 0.49330488,
     'ARmax100': 0.53279406,
     'ARs': 0.30486453,
     'global': {'total_loss': 66.334145},
     'validation_loss': 66.334145}I0425 21:34:24.675110 140388535805760 controller.py:211] train | step:  180000 | training until step 200000...
I0425 22:28:56.958641 140388535805760 controller.py:425] train | step:  190000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.667527,
           'avg_obj': 0.3169073,
           'box_loss': 3.931421,
           'class_loss': 1.8869388,
           'conf_loss': 47.616257,
           'precision50': 0.14992736,
           'recall50': 0.22958328},
     '4': {'avg_iou': 0.79064643,
           'avg_obj': 0.49100918,
           'box_loss': 2.4598145,
           'class_loss': 1.4593347,
           'conf_loss': 11.941555,
           'precision50': 0.19137947,
           'recall50': 0.48274884},
     '5': {'avg_iou': 0.8259539,
           'avg_obj': 0.5838817,
           'box_loss': 1.1181396,
           'class_loss': 0.7658217,
           'conf_loss': 2.2063582,
           'precision50': 0.253898,
           'recall50': 0.6356813},
     'global': {'total_loss': 73.38553},
     'learning_rate': 0.001,
     'training_loss': 73.38553}
I0425 22:29:43.906105 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-190000.
I0425 23:28:55.393398 140388535805760 controller.py:425] train | step:  200000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.66943216,
           'avg_obj': 0.31962106,
           'box_loss': 3.9126477,
           'class_loss': 1.8769017,
           'conf_loss': 47.28835,
           'precision50': 0.15072303,
           'recall50': 0.2325562},
     '4': {'avg_iou': 0.79166204,
           'avg_obj': 0.49444643,
           'box_loss': 2.4473655,
           'class_loss': 1.4445597,
           'conf_loss': 11.886492,
           'precision50': 0.19274789,
           'recall50': 0.48692334},
     '5': {'avg_iou': 0.82744324,
           'avg_obj': 0.58834475,
           'box_loss': 1.1071159,
           'class_loss': 0.7541941,
           'conf_loss': 2.1869152,
           'precision50': 0.25448686,
           'recall50': 0.6407488},
     'global': {'total_loss': 72.904625},
     'learning_rate': 0.001,
     'training_loss': 72.904625}
I0425 23:29:42.923259 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-200000.
I0425 23:29:42.929985 140388535805760 controller.py:252]  eval | step:  200000 | running 625 steps of evaluation...
I0425 23:33:57.410992 140388535805760 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0425 23:38:36.853666 140388535805760 controller.py:261]  eval | step:  200000 | eval time:  533.9 sec | output: 
    {'3': {'avg_iou': 0.5035715,
           'avg_obj': 0.2674777,
           'box_loss': 2.7580378,
           'class_loss': 1.0759231,
           'conf_loss': 44.349842,
           'precision50': 0.13255657,
           'recall50': 0.2797199},
     '4': {'avg_iou': 0.72703195,
           'avg_obj': 0.5175487,
           'box_loss': 2.065989,
           'class_loss': 0.8678526,
           'conf_loss': 10.836667,
           'precision50': 0.16782904,
           'recall50': 0.5754343},
     '5': {'avg_iou': 0.79216963,
           'avg_obj': 0.64252657,
           'box_loss': 1.0349013,
           'class_loss': 0.46714166,
           'conf_loss': 1.9504826,
           'precision50': 0.22571906,
           'recall50': 0.721655},
     'AP': 0.3693909,
     'AP50': 0.5637556,
     'AP75': 0.4026554,
     'APl': 0.5143996,
     'APm': 0.39308098,
     'APs': 0.14638524,
     'ARl': 0.6756831,
     'ARm': 0.573539,
     'ARmax1': 0.30402735,
     'ARmax10': 0.49204242,
     'ARmax100': 0.5326078,
     'ARs': 0.3080168,
     'global': {'total_loss': 65.406876},
     'validation_loss': 65.406876}
I0425 23:38:53.658488 140388535805760 controller.py:211] train | step:  200000 | training until step 220000...
I0426 00:31:14.843145 140388535805760 controller.py:425] train | step:  210000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6703998,
           'avg_obj': 0.32172137,
           'box_loss': 3.9001808,
           'class_loss': 1.857392,
           'conf_loss': 47.135624,
           'precision50': 0.15072499,
           'recall50': 0.23480427},
     '4': {'avg_iou': 0.79260564,
           'avg_obj': 0.49753487,
           'box_loss': 2.437927,
           'class_loss': 1.4299283,
           'conf_loss': 11.82639,
           'precision50': 0.19265096,
           'recall50': 0.48996708},
     '5': {'avg_iou': 0.8283288,
           'avg_obj': 0.5905731,
           'box_loss': 1.102049,
           'class_loss': 0.74675274,
           'conf_loss': 2.191574,
           'precision50': 0.2524314,
           'recall50': 0.64245665},
     'global': {'total_loss': 72.62784},
     'learning_rate': 0.001,
     'training_loss': 72.62784}
I0426 00:32:03.922886 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-210000.
I0426 01:30:40.695147 140388535805760 controller.py:425] train | step:  220000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6687714,
           'avg_obj': 0.32309335,
           'box_loss': 3.9180875,
           'class_loss': 1.8409402,
           'conf_loss': 46.01648,
           'precision50': 0.16090462,
           'recall50': 0.23584267},
     '4': {'avg_iou': 0.7933024,
           'avg_obj': 0.50109756,
           'box_loss': 2.429053,
           'class_loss': 1.4141234,
           'conf_loss': 11.752312,
           'precision50': 0.19291827,
           'recall50': 0.49410543},
     '5': {'avg_iou': 0.8292053,
           'avg_obj': 0.59368557,
           'box_loss': 1.0940976,
           'class_loss': 0.73641294,
           'conf_loss': 2.1594548,
           'precision50': 0.2548876,
           'recall50': 0.64550495},
     'global': {'total_loss': 71.361015},
     'learning_rate': 0.001,
     'training_loss': 71.361015}
I0426 01:31:30.215469 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-220000.
I0426 01:31:30.221688 140388535805760 controller.py:252]  eval | step:  220000 | running 625 steps of evaluation...
I0426 01:35:43.749945 140388535805760 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0426 01:40:55.211916 140388535805760 controller.py:261]  eval | step:  220000 | eval time:  565.0 sec | output: 
    {'3': {'avg_iou': 0.50341856,
           'avg_obj': 0.2619231,
           'box_loss': 2.7517414,
           'class_loss': 1.0725281,
           'conf_loss': 43.04531,
           'precision50': 0.13392632,
           'recall50': 0.27408046},
     '4': {'avg_iou': 0.7265162,
           'avg_obj': 0.51478994,
           'box_loss': 2.0700707,
           'class_loss': 0.86101073,
           'conf_loss': 10.81352,
           'precision50': 0.16714926,
           'recall50': 0.5730079},
     '5': {'avg_iou': 0.7928233,
           'avg_obj': 0.6426112,
           'box_loss': 1.032848,
           'class_loss': 0.46318072,
           'conf_loss': 1.9389691,
           'precision50': 0.22606662,
           'recall50': 0.72027194},
     'AP': 0.37011555,
     'AP50': 0.56430095,
     'AP75': 0.40133083,
     'APl': 0.5169618,
     'APm': 0.39134058,
     'APs': 0.1489568,
     'ARl': 0.6851672,
     'ARm': 0.5728997,
     'ARmax1': 0.30565062,
     'ARmax10': 0.4947429,
     'ARmax100': 0.5354737,
     'ARs': 0.30954722,
     'global': {'total_loss': 64.0492},
     'validation_loss': 64.0492}

train | step:  180000 | training until step 200000...
train | step:  190000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.667527,
           'avg_obj': 0.3169073,
           'box_loss': 3.931421,
           'class_loss': 1.8869388,
           'conf_loss': 47.616257,
           'precision50': 0.14992736,
           'recall50': 0.22958328},
     '4': {'avg_iou': 0.79064643,
           'avg_obj': 0.49100918,
           'box_loss': 2.4598145,
           'class_loss': 1.4593347,
           'conf_loss': 11.941555,
           'precision50': 0.19137947,
           'recall50': 0.48274884},
     '5': {'avg_iou': 0.8259539,
           'avg_obj': 0.5838817,
           'box_loss': 1.1181396,
           'class_loss': 0.7658217,
           'conf_loss': 2.2063582,
           'precision50': 0.253898,
           'recall50': 0.6356813},
     'global': {'total_loss': 73.38553},
     'learning_rate': 0.001,
     'training_loss': 73.38553}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-190000.
train | step:  200000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.66943216,
           'avg_obj': 0.31962106,
           'box_loss': 3.9126477,
           'class_loss': 1.8769017,
           'conf_loss': 47.28835,
           'precision50': 0.15072303,
           'recall50': 0.2325562},
     '4': {'avg_iou': 0.79166204,
           'avg_obj': 0.49444643,
           'box_loss': 2.4473655,
           'class_loss': 1.4445597,
           'conf_loss': 11.886492,
           'precision50': 0.19274789,
           'recall50': 0.48692334},
     '5': {'avg_iou': 0.82744324,
           'avg_obj': 0.58834475,
           'box_loss': 1.1071159,
           'class_loss': 0.7541941,
           'conf_loss': 2.1869152,
           'precision50': 0.25448686,
           'recall50': 0.6407488},
     'global': {'total_loss': 72.904625},
     'learning_rate': 0.001,
     'training_loss': 72.904625}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-200000.
 eval | step:  200000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=191.63s).
Accumulating evaluation results...
DONE (t=30.14s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.369
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.564
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.403
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.146
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.393
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.514
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.304
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.492
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.533
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.308
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.574
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.676
 eval | step:  200000 | eval time:  533.9 sec | output: 
    {'3': {'avg_iou': 0.5035715,
           'avg_obj': 0.2674777,
           'box_loss': 2.7580378,
           'class_loss': 1.0759231,
           'conf_loss': 44.349842,
           'precision50': 0.13255657,
           'recall50': 0.2797199},
     '4': {'avg_iou': 0.72703195,
           'avg_obj': 0.5175487,
           'box_loss': 2.065989,
           'class_loss': 0.8678526,
           'conf_loss': 10.836667,
           'precision50': 0.16782904,
           'recall50': 0.5754343},
     '5': {'avg_iou': 0.79216963,
           'avg_obj': 0.64252657,
           'box_loss': 1.0349013,
           'class_loss': 0.46714166,
           'conf_loss': 1.9504826,
           'precision50': 0.22571906,
           'recall50': 0.721655},
     'AP': 0.3693909,
     'AP50': 0.5637556,
     'AP75': 0.4026554,
     'APl': 0.5143996,
     'APm': 0.39308098,
     'APs': 0.14638524,
     'ARl': 0.6756831,
     'ARm': 0.573539,
     'ARmax1': 0.30402735,
     'ARmax10': 0.49204242,
     'ARmax100': 0.5326078,
     'ARs': 0.3080168,
     'global': {'total_loss': 65.406876},
     'validation_loss': 65.406876}
train | step:  200000 | training until step 220000...
train | step:  210000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6703998,
           'avg_obj': 0.32172137,
           'box_loss': 3.9001808,
           'class_loss': 1.857392,
           'conf_loss': 47.135624,
           'precision50': 0.15072499,
           'recall50': 0.23480427},
     '4': {'avg_iou': 0.79260564,
           'avg_obj': 0.49753487,
           'box_loss': 2.437927,
           'class_loss': 1.4299283,
           'conf_loss': 11.82639,
           'precision50': 0.19265096,
           'recall50': 0.48996708},
     '5': {'avg_iou': 0.8283288,
           'avg_obj': 0.5905731,
           'box_loss': 1.102049,
           'class_loss': 0.74675274,
           'conf_loss': 2.191574,
           'precision50': 0.2524314,
           'recall50': 0.64245665},
     'global': {'total_loss': 72.62784},
     'learning_rate': 0.001,
     'training_loss': 72.62784}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-210000.
train | step:  220000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6687714,
           'avg_obj': 0.32309335,
           'box_loss': 3.9180875,
           'class_loss': 1.8409402,
           'conf_loss': 46.01648,
           'precision50': 0.16090462,
           'recall50': 0.23584267},
     '4': {'avg_iou': 0.7933024,
           'avg_obj': 0.50109756,
           'box_loss': 2.429053,
           'class_loss': 1.4141234,
           'conf_loss': 11.752312,
           'precision50': 0.19291827,
           'recall50': 0.49410543},
     '5': {'avg_iou': 0.8292053,
           'avg_obj': 0.59368557,
           'box_loss': 1.0940976,
           'class_loss': 0.73641294,
           'conf_loss': 2.1594548,
           'precision50': 0.2548876,
           'recall50': 0.64550495},
     'global': {'total_loss': 71.361015},
     'learning_rate': 0.001,
     'training_loss': 71.361015}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-220000.
 eval | step:  220000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=213.25s).
Accumulating evaluation results...
DONE (t=34.65s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.370
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.564
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.401
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.149
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.391
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.517
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.306
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.495
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.535
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.310
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.573
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.685
 eval | step:  220000 | eval time:  565.0 sec | output: 
    {'3': {'avg_iou': 0.50341856,
           'avg_obj': 0.2619231,
           'box_loss': 2.7517414,
           'class_loss': 1.0725281,
           'conf_loss': 43.04531,
           'precision50': 0.13392632,
           'recall50': 0.27408046},
     '4': {'avg_iou': 0.7265162,
           'avg_obj': 0.51478994,
           'box_loss': 2.0700707,
           'class_loss': 0.86101073,
           'conf_loss': 10.81352,
           'precision50': 0.16714926,
           'recall50': 0.5730079},
     '5': {'avg_iou': 0.7928233,
           'avg_obj': 0.6426112,
           'box_loss': 1.032848,
           'class_loss': 0.46318072,
           'conf_loss': 1.9389691,
           'precision50': 0.22606662,
           'recall50': 0.72027194},
     'AP': 0.37011555,
     'AP50': 0.56430095,
     'AP75': 0.40133083,
     'APl': 0.5169618,
     'APm': 0.39134058,
     'APs': 0.1489568,
     'ARl': 0.6851672,
     'ARm': 0.5728997,
     'ARmax1': 0.30565062,
     'ARmax10': 0.4947429,
     'ARmax100': 0.5354737,
     'ARs': 0.30954722,
     'global': {'total_loss': 64.0492},
     'validation_loss': 64.0492}I0426 01:41:18.382408 140388535805760 controller.py:211] train | step:  220000 | training until step 240000...
I0426 02:31:48.782353 140388535805760 controller.py:425] train | step:  230000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.670817,
           'avg_obj': 0.32621244,
           'box_loss': 3.8896523,
           'class_loss': 1.8329922,
           'conf_loss': 46.572525,
           'precision50': 0.15279926,
           'recall50': 0.23962986},
     '4': {'avg_iou': 0.79422003,
           'avg_obj': 0.5036211,
           'box_loss': 2.4151514,
           'class_loss': 1.404505,
           'conf_loss': 11.688643,
           'precision50': 0.19240259,
           'recall50': 0.49683475},
     '5': {'avg_iou': 0.8302568,
           'avg_obj': 0.5965729,
           'box_loss': 1.087845,
           'class_loss': 0.73162985,
           'conf_loss': 2.1518893,
           'precision50': 0.25437853,
           'recall50': 0.6481061},
     'global': {'total_loss': 71.77478},
     'learning_rate': 0.001,
     'training_loss': 71.77478}
I0426 02:32:36.774274 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-230000.
I0426 03:31:30.007438 140388535805760 controller.py:425] train | step:  240000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.67228186,
           'avg_obj': 0.32932633,
           'box_loss': 3.8784957,
           'class_loss': 1.8194356,
           'conf_loss': 45.608135,
           'precision50': 0.15422377,
           'recall50': 0.24314651},
     '4': {'avg_iou': 0.7952599,
           'avg_obj': 0.5073631,
           'box_loss': 2.4060044,
           'class_loss': 1.3930815,
           'conf_loss': 11.622601,
           'precision50': 0.19291554,
           'recall50': 0.5010888},
     '5': {'avg_iou': 0.8309276,
           'avg_obj': 0.59890556,
           'box_loss': 1.0845051,
           'class_loss': 0.72515637,
           'conf_loss': 2.1444054,
           'precision50': 0.2552216,
           'recall50': 0.65111804},
     'global': {'total_loss': 70.681816},
     'learning_rate': 0.001,
     'training_loss': 70.681816}
I0426 03:32:31.999483 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-240000.
I0426 03:32:32.006160 140388535805760 controller.py:252]  eval | step:  240000 | running 625 steps of evaluation...
I0426 03:36:49.205580 140388535805760 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0426 03:41:18.571961 140388535805760 controller.py:261]  eval | step:  240000 | eval time:  526.6 sec | output: 
    {'3': {'avg_iou': 0.5041258,
           'avg_obj': 0.2592974,
           'box_loss': 2.7520425,
           'class_loss': 1.0613645,
           'conf_loss': 42.39116,
           'precision50': 0.13153984,
           'recall50': 0.27083978},
     '4': {'avg_iou': 0.7263819,
           'avg_obj': 0.5133191,
           'box_loss': 2.0767403,
           'class_loss': 0.85604715,
           'conf_loss': 10.679826,
           'precision50': 0.16965054,
           'recall50': 0.5716396},
     '5': {'avg_iou': 0.7930385,
           'avg_obj': 0.642271,
           'box_loss': 1.0337887,
           'class_loss': 0.4605056,
           'conf_loss': 1.9313886,
           'precision50': 0.2298928,
           'recall50': 0.72158045},
     'AP': 0.3721358,
     'AP50': 0.56649613,
     'AP75': 0.40118566,
     'APl': 0.5216346,
     'APm': 0.39303643,
     'APs': 0.15139477,
     'ARl': 0.68430185,
     'ARm': 0.5719215,
     'ARmax1': 0.3057651,
     'ARmax10': 0.49483818,
     'ARmax100': 0.5352662,
     'ARs': 0.3056633,
     'global': {'total_loss': 63.242844},
     'validation_loss': 63.242844}
I0426 03:41:46.614100 140388535805760 controller.py:211] train | step:  240000 | training until step 260000...
I0426 04:37:00.753507 140388535805760 controller.py:425] train | step:  250000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6734693,
           'avg_obj': 0.33238474,
           'box_loss': 3.860127,
           'class_loss': 1.8011353,
           'conf_loss': 45.100243,
           'precision50': 0.15831715,
           'recall50': 0.24598782},
     '4': {'avg_iou': 0.79614514,
           'avg_obj': 0.5101312,
           'box_loss': 2.394346,
           'class_loss': 1.3778167,
           'conf_loss': 11.579691,
           'precision50': 0.19287764,
           'recall50': 0.5037406},
     '5': {'avg_iou': 0.8319858,
           'avg_obj': 0.6021607,
           'box_loss': 1.0781581,
           'class_loss': 0.7172301,
           'conf_loss': 2.1354315,
           'precision50': 0.25430807,
           'recall50': 0.65428513},
     'global': {'total_loss': 70.04429},
     'learning_rate': 0.001,
     'training_loss': 70.04429}
I0426 04:37:56.228127 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-250000.
I0426 05:38:03.733144 140388535805760 controller.py:425] train | step:  260000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.67406106,
           'avg_obj': 0.3346953,
           'box_loss': 3.859019,
           'class_loss': 1.7930822,
           'conf_loss': 45.23529,
           'precision50': 0.16013718,
           'recall50': 0.24824841},
     '4': {'avg_iou': 0.79715943,
           'avg_obj': 0.51287884,
           'box_loss': 2.3886225,
           'class_loss': 1.374977,
           'conf_loss': 11.54218,
           'precision50': 0.19289097,
           'recall50': 0.5068851},
     '5': {'avg_iou': 0.8323884,
           'avg_obj': 0.6041013,
           'box_loss': 1.0769447,
           'class_loss': 0.7132936,
           'conf_loss': 2.1340997,
           'precision50': 0.2542208,
           'recall50': 0.6560908},
     'global': {'total_loss': 70.11751},
     'learning_rate': 0.001,
     'training_loss': 70.11751}
I0426 05:38:51.680358 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-260000.
I0426 05:38:51.686514 140388535805760 controller.py:252]  eval | step:  260000 | running 625 steps of evaluation...
I0426 05:43:07.271573 140388535805760 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0426 05:48:03.018296 140388535805760 controller.py:261]  eval | step:  260000 | eval time:  551.3 sec | output: 
    {'3': {'avg_iou': 0.5047735,
           'avg_obj': 0.27191746,
           'box_loss': 2.741994,
           'class_loss': 1.0631981,
           'conf_loss': 42.29561,
           'precision50': 0.13712573,
           'recall50': 0.2861228},
     '4': {'avg_iou': 0.7270531,
           'avg_obj': 0.5220674,
           'box_loss': 2.06814,
           'class_loss': 0.8572758,
           'conf_loss': 10.813396,
           'precision50': 0.16816664,
           'recall50': 0.58052266},
     '5': {'avg_iou': 0.79313254,
           'avg_obj': 0.64763904,
           'box_loss': 1.0347018,
           'class_loss': 0.46417856,
           'conf_loss': 1.9502978,
           'precision50': 0.22696765,
           'recall50': 0.72485614},
     'AP': 0.37262195,
     'AP50': 0.56756747,
     'AP75': 0.4030112,
     'APl': 0.51721895,
     'APm': 0.39401385,
     'APs': 0.15540129,
     'ARl': 0.6853676,
     'ARm': 0.568915,
     'ARmax1': 0.30541587,
     'ARmax10': 0.49460384,
     'ARmax100': 0.5355666,
     'ARs': 0.31383926,
     'global': {'total_loss': 63.288837},
     'validation_loss': 63.288837}

train | step:  220000 | training until step 240000...
train | step:  230000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.670817,
           'avg_obj': 0.32621244,
           'box_loss': 3.8896523,
           'class_loss': 1.8329922,
           'conf_loss': 46.572525,
           'precision50': 0.15279926,
           'recall50': 0.23962986},
     '4': {'avg_iou': 0.79422003,
           'avg_obj': 0.5036211,
           'box_loss': 2.4151514,
           'class_loss': 1.404505,
           'conf_loss': 11.688643,
           'precision50': 0.19240259,
           'recall50': 0.49683475},
     '5': {'avg_iou': 0.8302568,
           'avg_obj': 0.5965729,
           'box_loss': 1.087845,
           'class_loss': 0.73162985,
           'conf_loss': 2.1518893,
           'precision50': 0.25437853,
           'recall50': 0.6481061},
     'global': {'total_loss': 71.77478},
     'learning_rate': 0.001,
     'training_loss': 71.77478}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-230000.
train | step:  240000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.67228186,
           'avg_obj': 0.32932633,
           'box_loss': 3.8784957,
           'class_loss': 1.8194356,
           'conf_loss': 45.608135,
           'precision50': 0.15422377,
           'recall50': 0.24314651},
     '4': {'avg_iou': 0.7952599,
           'avg_obj': 0.5073631,
           'box_loss': 2.4060044,
           'class_loss': 1.3930815,
           'conf_loss': 11.622601,
           'precision50': 0.19291554,
           'recall50': 0.5010888},
     '5': {'avg_iou': 0.8309276,
           'avg_obj': 0.59890556,
           'box_loss': 1.0845051,
           'class_loss': 0.72515637,
           'conf_loss': 2.1444054,
           'precision50': 0.2552216,
           'recall50': 0.65111804},
     'global': {'total_loss': 70.681816},
     'learning_rate': 0.001,
     'training_loss': 70.681816}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-240000.
 eval | step:  240000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=191.96s).
Accumulating evaluation results...
DONE (t=28.48s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.372
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.566
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.401
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.151
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.393
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.522
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.306
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.495
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.535
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.306
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.572
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.684
 eval | step:  240000 | eval time:  526.6 sec | output: 
    {'3': {'avg_iou': 0.5041258,
           'avg_obj': 0.2592974,
           'box_loss': 2.7520425,
           'class_loss': 1.0613645,
           'conf_loss': 42.39116,
           'precision50': 0.13153984,
           'recall50': 0.27083978},
     '4': {'avg_iou': 0.7263819,
           'avg_obj': 0.5133191,
           'box_loss': 2.0767403,
           'class_loss': 0.85604715,
           'conf_loss': 10.679826,
           'precision50': 0.16965054,
           'recall50': 0.5716396},
     '5': {'avg_iou': 0.7930385,
           'avg_obj': 0.642271,
           'box_loss': 1.0337887,
           'class_loss': 0.4605056,
           'conf_loss': 1.9313886,
           'precision50': 0.2298928,
           'recall50': 0.72158045},
     'AP': 0.3721358,
     'AP50': 0.56649613,
     'AP75': 0.40118566,
     'APl': 0.5216346,
     'APm': 0.39303643,
     'APs': 0.15139477,
     'ARl': 0.68430185,
     'ARm': 0.5719215,
     'ARmax1': 0.3057651,
     'ARmax10': 0.49483818,
     'ARmax100': 0.5352662,
     'ARs': 0.3056633,
     'global': {'total_loss': 63.242844},
     'validation_loss': 63.242844}
train | step:  240000 | training until step 260000...
train | step:  250000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6734693,
           'avg_obj': 0.33238474,
           'box_loss': 3.860127,
           'class_loss': 1.8011353,
           'conf_loss': 45.100243,
           'precision50': 0.15831715,
           'recall50': 0.24598782},
     '4': {'avg_iou': 0.79614514,
           'avg_obj': 0.5101312,
           'box_loss': 2.394346,
           'class_loss': 1.3778167,
           'conf_loss': 11.579691,
           'precision50': 0.19287764,
           'recall50': 0.5037406},
     '5': {'avg_iou': 0.8319858,
           'avg_obj': 0.6021607,
           'box_loss': 1.0781581,
           'class_loss': 0.7172301,
           'conf_loss': 2.1354315,
           'precision50': 0.25430807,
           'recall50': 0.65428513},
     'global': {'total_loss': 70.04429},
     'learning_rate': 0.001,
     'training_loss': 70.04429}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-250000.
train | step:  260000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.67406106,
           'avg_obj': 0.3346953,
           'box_loss': 3.859019,
           'class_loss': 1.7930822,
           'conf_loss': 45.23529,
           'precision50': 0.16013718,
           'recall50': 0.24824841},
     '4': {'avg_iou': 0.79715943,
           'avg_obj': 0.51287884,
           'box_loss': 2.3886225,
           'class_loss': 1.374977,
           'conf_loss': 11.54218,
           'precision50': 0.19289097,
           'recall50': 0.5068851},
     '5': {'avg_iou': 0.8323884,
           'avg_obj': 0.6041013,
           'box_loss': 1.0769447,
           'class_loss': 0.7132936,
           'conf_loss': 2.1340997,
           'precision50': 0.2542208,
           'recall50': 0.6560908},
     'global': {'total_loss': 70.11751},
     'learning_rate': 0.001,
     'training_loss': 70.11751}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-260000.
 eval | step:  260000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=203.93s).
Accumulating evaluation results...
DONE (t=30.76s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.373
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.568
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.403
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.155
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.394
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.517
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.305
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.495
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.536
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.314
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.569
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.685
 eval | step:  260000 | eval time:  551.3 sec | output: 
    {'3': {'avg_iou': 0.5047735,
           'avg_obj': 0.27191746,
           'box_loss': 2.741994,
           'class_loss': 1.0631981,
           'conf_loss': 42.29561,
           'precision50': 0.13712573,
           'recall50': 0.2861228},
     '4': {'avg_iou': 0.7270531,
           'avg_obj': 0.5220674,
           'box_loss': 2.06814,
           'class_loss': 0.8572758,
           'conf_loss': 10.813396,
           'precision50': 0.16816664,
           'recall50': 0.58052266},
     '5': {'avg_iou': 0.79313254,
           'avg_obj': 0.64763904,
           'box_loss': 1.0347018,
           'class_loss': 0.46417856,
           'conf_loss': 1.9502978,
           'precision50': 0.22696765,
           'recall50': 0.72485614},
     'AP': 0.37262195,
     'AP50': 0.56756747,
     'AP75': 0.4030112,
     'APl': 0.51721895,
     'APm': 0.39401385,
     'APs': 0.15540129,
     'ARl': 0.6853676,
     'ARm': 0.568915,
     'ARmax1': 0.30541587,
     'ARmax10': 0.49460384,
     'ARmax100': 0.5355666,
     'ARs': 0.31383926,
     'global': {'total_loss': 63.288837},
     'validation_loss': 63.288837}I0426 05:48:20.408391 140388535805760 controller.py:211] train | step:  260000 | training until step 280000...
I0426 06:38:21.881746 140388535805760 controller.py:425] train | step:  270000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.67487794,
           'avg_obj': 0.33729866,
           'box_loss': 3.8458538,
           'class_loss': 1.7803686,
           'conf_loss': 45.14765,
           'precision50': 0.15753555,
           'recall50': 0.25114664},
     '4': {'avg_iou': 0.79783505,
           'avg_obj': 0.5157824,
           'box_loss': 2.3755555,
           'class_loss': 1.3612257,
           'conf_loss': 11.469684,
           'precision50': 0.19337235,
           'recall50': 0.51013684},
     '5': {'avg_iou': 0.8331843,
           'avg_obj': 0.6063827,
           'box_loss': 1.0705189,
           'class_loss': 0.7065832,
           'conf_loss': 2.1140623,
           'precision50': 0.25600648,
           'recall50': 0.65861},
     'global': {'total_loss': 69.87139},
     'learning_rate': 0.001,
     'training_loss': 69.87139}
I0426 06:39:08.877261 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-270000.
I0426 07:37:32.368200 140388535805760 controller.py:425] train | step:  280000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6758341,
           'avg_obj': 0.33955777,
           'box_loss': 3.8314874,
           'class_loss': 1.7738233,
           'conf_loss': 45.38958,
           'precision50': 0.15688168,
           'recall50': 0.25331613},
     '4': {'avg_iou': 0.7986698,
           'avg_obj': 0.5180497,
           'box_loss': 2.3656855,
           'class_loss': 1.3523673,
           'conf_loss': 11.449538,
           'precision50': 0.19447942,
           'recall50': 0.5127542},
     '5': {'avg_iou': 0.8336538,
           'avg_obj': 0.6076191,
           'box_loss': 1.0665424,
           'class_loss': 0.7015302,
           'conf_loss': 2.097765,
           'precision50': 0.25624478,
           'recall50': 0.65989035},
     'global': {'total_loss': 70.02841},
     'learning_rate': 0.001,
     'training_loss': 70.02841}
I0426 07:38:19.618761 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-280000.
I0426 07:38:19.624760 140388535805760 controller.py:252]  eval | step:  280000 | running 625 steps of evaluation...
I0426 07:42:43.143802 140388535805760 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0426 07:47:23.645796 140388535805760 controller.py:261]  eval | step:  280000 | eval time:  544.0 sec | output: 
    {'3': {'avg_iou': 0.5053441,
           'avg_obj': 0.26729062,
           'box_loss': 2.7354188,
           'class_loss': 1.0598347,
           'conf_loss': 43.123383,
           'precision50': 0.13319787,
           'recall50': 0.28074333},
     '4': {'avg_iou': 0.72685343,
           'avg_obj': 0.5231249,
           'box_loss': 2.07635,
           'class_loss': 0.8559785,
           'conf_loss': 10.834319,
           'precision50': 0.16675363,
           'recall50': 0.5838167},
     '5': {'avg_iou': 0.7943066,
           'avg_obj': 0.6477638,
           'box_loss': 1.0284457,
           'class_loss': 0.45927143,
           'conf_loss': 1.9365944,
           'precision50': 0.22625029,
           'recall50': 0.72362024},
     'AP': 0.37343213,
     'AP50': 0.56993926,
     'AP75': 0.40497178,
     'APl': 0.52002966,
     'APm': 0.39218825,
     'APs': 0.15500574,
     'ARl': 0.68937814,
     'ARm': 0.57070524,
     'ARmax1': 0.30668125,
     'ARmax10': 0.49610022,
     'ARmax100': 0.5376003,
     'ARs': 0.31302622,
     'global': {'total_loss': 64.1096},
     'validation_loss': 64.1096}
I0426 07:47:41.620975 140388535805760 controller.py:211] train | step:  280000 | training until step 300000...
I0426 08:38:01.997002 140388535805760 controller.py:425] train | step:  290000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.67555237,
           'avg_obj': 0.34066615,
           'box_loss': 3.8384187,
           'class_loss': 1.768584,
           'conf_loss': 45.89065,
           'precision50': 0.15323359,
           'recall50': 0.2546193},
     '4': {'avg_iou': 0.799023,
           'avg_obj': 0.5196067,
           'box_loss': 2.361141,
           'class_loss': 1.3494354,
           'conf_loss': 11.440114,
           'precision50': 0.19205005,
           'recall50': 0.51403373},
     '5': {'avg_iou': 0.8346131,
           'avg_obj': 0.6095595,
           'box_loss': 1.0606954,
           'class_loss': 0.6984822,
           'conf_loss': 2.0899482,
           'precision50': 0.25622085,
           'recall50': 0.66148317},
     'global': {'total_loss': 70.4974},
     'learning_rate': 0.001,
     'training_loss': 70.4974}
I0426 08:38:53.294387 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-290000.
I0426 09:37:12.560564 140388535805760 controller.py:425] train | step:  300000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.67668104,
           'avg_obj': 0.3432871,
           'box_loss': 3.8233328,
           'class_loss': 1.7560664,
           'conf_loss': 44.960903,
           'precision50': 0.15584514,
           'recall50': 0.25671375},
     '4': {'avg_iou': 0.79966426,
           'avg_obj': 0.52232295,
           'box_loss': 2.3513389,
           'class_loss': 1.3371812,
           'conf_loss': 11.424125,
           'precision50': 0.19102009,
           'recall50': 0.5165802},
     '5': {'avg_iou': 0.8350073,
           'avg_obj': 0.6117747,
           'box_loss': 1.0563402,
           'class_loss': 0.692237,
           'conf_loss': 2.0740063,
           'precision50': 0.25633353,
           'recall50': 0.6634711},
     'global': {'total_loss': 69.47543},
     'learning_rate': 0.001,
     'training_loss': 69.47543}
I0426 09:38:05.208045 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-300000.
I0426 09:38:05.213615 140388535805760 controller.py:252]  eval | step:  300000 | running 625 steps of evaluation...
I0426 09:42:25.109035 140388535805760 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0426 09:47:13.639832 140388535805760 controller.py:261]  eval | step:  300000 | eval time:  548.4 sec | output: 
    {'3': {'avg_iou': 0.50540584,
           'avg_obj': 0.26824835,
           'box_loss': 2.737583,
           'class_loss': 1.0521731,
           'conf_loss': 43.83643,
           'precision50': 0.12978777,
           'recall50': 0.28185576},
     '4': {'avg_iou': 0.7270621,
           'avg_obj': 0.5211864,
           'box_loss': 2.0739439,
           'class_loss': 0.8497195,
           'conf_loss': 10.965684,
           'precision50': 0.16483574,
           'recall50': 0.5817631},
     '5': {'avg_iou': 0.7946927,
           'avg_obj': 0.64896834,
           'box_loss': 1.0261868,
           'class_loss': 0.45798907,
           'conf_loss': 1.9322428,
           'precision50': 0.22636047,
           'recall50': 0.7263247},
     'AP': 0.37320703,
     'AP50': 0.56852317,
     'AP75': 0.40464377,
     'APl': 0.5192377,
     'APm': 0.39551553,
     'APs': 0.15362303,
     'ARl': 0.68307793,
     'ARm': 0.5710215,
     'ARmax1': 0.30590016,
     'ARmax10': 0.49309498,
     'ARmax100': 0.5345005,
     'ARs': 0.3070263,
     'global': {'total_loss': 64.931915},
     'validation_loss': 64.931915}

train | step:  260000 | training until step 280000...
train | step:  270000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.67487794,
           'avg_obj': 0.33729866,
           'box_loss': 3.8458538,
           'class_loss': 1.7803686,
           'conf_loss': 45.14765,
           'precision50': 0.15753555,
           'recall50': 0.25114664},
     '4': {'avg_iou': 0.79783505,
           'avg_obj': 0.5157824,
           'box_loss': 2.3755555,
           'class_loss': 1.3612257,
           'conf_loss': 11.469684,
           'precision50': 0.19337235,
           'recall50': 0.51013684},
     '5': {'avg_iou': 0.8331843,
           'avg_obj': 0.6063827,
           'box_loss': 1.0705189,
           'class_loss': 0.7065832,
           'conf_loss': 2.1140623,
           'precision50': 0.25600648,
           'recall50': 0.65861},
     'global': {'total_loss': 69.87139},
     'learning_rate': 0.001,
     'training_loss': 69.87139}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-270000.
train | step:  280000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6758341,
           'avg_obj': 0.33955777,
           'box_loss': 3.8314874,
           'class_loss': 1.7738233,
           'conf_loss': 45.38958,
           'precision50': 0.15688168,
           'recall50': 0.25331613},
     '4': {'avg_iou': 0.7986698,
           'avg_obj': 0.5180497,
           'box_loss': 2.3656855,
           'class_loss': 1.3523673,
           'conf_loss': 11.449538,
           'precision50': 0.19447942,
           'recall50': 0.5127542},
     '5': {'avg_iou': 0.8336538,
           'avg_obj': 0.6076191,
           'box_loss': 1.0665424,
           'class_loss': 0.7015302,
           'conf_loss': 2.097765,
           'precision50': 0.25624478,
           'recall50': 0.65989035},
     'global': {'total_loss': 70.02841},
     'learning_rate': 0.001,
     'training_loss': 70.02841}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-280000.
 eval | step:  280000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=190.76s).
Accumulating evaluation results...
DONE (t=28.70s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.373
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.570
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.405
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.155
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.392
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.520
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.307
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.496
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.538
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.313
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.571
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.689
 eval | step:  280000 | eval time:  544.0 sec | output: 
    {'3': {'avg_iou': 0.5053441,
           'avg_obj': 0.26729062,
           'box_loss': 2.7354188,
           'class_loss': 1.0598347,
           'conf_loss': 43.123383,
           'precision50': 0.13319787,
           'recall50': 0.28074333},
     '4': {'avg_iou': 0.72685343,
           'avg_obj': 0.5231249,
           'box_loss': 2.07635,
           'class_loss': 0.8559785,
           'conf_loss': 10.834319,
           'precision50': 0.16675363,
           'recall50': 0.5838167},
     '5': {'avg_iou': 0.7943066,
           'avg_obj': 0.6477638,
           'box_loss': 1.0284457,
           'class_loss': 0.45927143,
           'conf_loss': 1.9365944,
           'precision50': 0.22625029,
           'recall50': 0.72362024},
     'AP': 0.37343213,
     'AP50': 0.56993926,
     'AP75': 0.40497178,
     'APl': 0.52002966,
     'APm': 0.39218825,
     'APs': 0.15500574,
     'ARl': 0.68937814,
     'ARm': 0.57070524,
     'ARmax1': 0.30668125,
     'ARmax10': 0.49610022,
     'ARmax100': 0.5376003,
     'ARs': 0.31302622,
     'global': {'total_loss': 64.1096},
     'validation_loss': 64.1096}
train | step:  280000 | training until step 300000...
train | step:  290000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.67555237,
           'avg_obj': 0.34066615,
           'box_loss': 3.8384187,
           'class_loss': 1.768584,
           'conf_loss': 45.89065,
           'precision50': 0.15323359,
           'recall50': 0.2546193},
     '4': {'avg_iou': 0.799023,
           'avg_obj': 0.5196067,
           'box_loss': 2.361141,
           'class_loss': 1.3494354,
           'conf_loss': 11.440114,
           'precision50': 0.19205005,
           'recall50': 0.51403373},
     '5': {'avg_iou': 0.8346131,
           'avg_obj': 0.6095595,
           'box_loss': 1.0606954,
           'class_loss': 0.6984822,
           'conf_loss': 2.0899482,
           'precision50': 0.25622085,
           'recall50': 0.66148317},
     'global': {'total_loss': 70.4974},
     'learning_rate': 0.001,
     'training_loss': 70.4974}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-290000.
train | step:  300000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.67668104,
           'avg_obj': 0.3432871,
           'box_loss': 3.8233328,
           'class_loss': 1.7560664,
           'conf_loss': 44.960903,
           'precision50': 0.15584514,
           'recall50': 0.25671375},
     '4': {'avg_iou': 0.79966426,
           'avg_obj': 0.52232295,
           'box_loss': 2.3513389,
           'class_loss': 1.3371812,
           'conf_loss': 11.424125,
           'precision50': 0.19102009,
           'recall50': 0.5165802},
     '5': {'avg_iou': 0.8350073,
           'avg_obj': 0.6117747,
           'box_loss': 1.0563402,
           'class_loss': 0.692237,
           'conf_loss': 2.0740063,
           'precision50': 0.25633353,
           'recall50': 0.6634711},
     'global': {'total_loss': 69.47543},
     'learning_rate': 0.001,
     'training_loss': 69.47543}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-300000.
 eval | step:  300000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=200.28s).
Accumulating evaluation results...
DONE (t=29.73s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.373
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.569
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.405
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.154
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.396
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.519
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.306
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.493
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.535
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.307
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.571
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.683
 eval | step:  300000 | eval time:  548.4 sec | output: 
    {'3': {'avg_iou': 0.50540584,
           'avg_obj': 0.26824835,
           'box_loss': 2.737583,
           'class_loss': 1.0521731,
           'conf_loss': 43.83643,
           'precision50': 0.12978777,
           'recall50': 0.28185576},
     '4': {'avg_iou': 0.7270621,
           'avg_obj': 0.5211864,
           'box_loss': 2.0739439,
           'class_loss': 0.8497195,
           'conf_loss': 10.965684,
           'precision50': 0.16483574,
           'recall50': 0.5817631},
     '5': {'avg_iou': 0.7946927,
           'avg_obj': 0.64896834,
           'box_loss': 1.0261868,
           'class_loss': 0.45798907,
           'conf_loss': 1.9322428,
           'precision50': 0.22636047,
           'recall50': 0.7263247},
     'AP': 0.37320703,
     'AP50': 0.56852317,
     'AP75': 0.40464377,
     'APl': 0.5192377,
     'APm': 0.39551553,
     'APs': 0.15362303,
     'ARl': 0.68307793,
     'ARm': 0.5710215,
     'ARmax1': 0.30590016,
     'ARmax10': 0.49309498,
     'ARmax100': 0.5345005,
     'ARs': 0.3070263,
     'global': {'total_loss': 64.931915},
     'validation_loss': 64.931915}I0426 09:47:32.729607 140388535805760 controller.py:211] train | step:  300000 | training until step 320000...
I0426 10:37:33.522456 140388535805760 controller.py:425] train | step:  310000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6767836,
           'avg_obj': 0.34378284,
           'box_loss': 3.8224325,
           'class_loss': 1.7540344,
           'conf_loss': 45.97202,
           'precision50': 0.15348415,
           'recall50': 0.25859386},
     '4': {'avg_iou': 0.8000946,
           'avg_obj': 0.5239035,
           'box_loss': 2.35,
           'class_loss': 1.335066,
           'conf_loss': 11.47719,
           'precision50': 0.19019897,
           'recall50': 0.51905453},
     '5': {'avg_iou': 0.8356461,
           'avg_obj': 0.6134093,
           'box_loss': 1.0537925,
           'class_loss': 0.6915938,
           'conf_loss': 2.078119,
           'precision50': 0.25485283,
           'recall50': 0.6649223},
     'global': {'total_loss': 70.5342},
     'learning_rate': 0.001,
     'training_loss': 70.5342}
I0426 10:38:20.725624 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-310000.
I0426 11:36:56.405199 140388535805760 controller.py:425] train | step:  320000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.67702824,
           'avg_obj': 0.34619674,
           'box_loss': 3.8206317,
           'class_loss': 1.7452977,
           'conf_loss': 45.722595,
           'precision50': 0.1542667,
           'recall50': 0.26051944},
     '4': {'avg_iou': 0.80052406,
           'avg_obj': 0.5260133,
           'box_loss': 2.341979,
           'class_loss': 1.3264034,
           'conf_loss': 11.510703,
           'precision50': 0.19045842,
           'recall50': 0.52123743},
     '5': {'avg_iou': 0.8365091,
           'avg_obj': 0.6153154,
           'box_loss': 1.0483077,
           'class_loss': 0.68580914,
           'conf_loss': 2.0829067,
           'precision50': 0.25327927,
           'recall50': 0.6673918},
     'global': {'total_loss': 70.28466},
     'learning_rate': 0.001,
     'training_loss': 70.28466}
I0426 11:37:43.677568 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-320000.
I0426 11:37:43.683618 140388535805760 controller.py:252]  eval | step:  320000 | running 625 steps of evaluation...
I0426 11:42:07.412763 140388535805760 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0426 11:46:47.221839 140388535805760 controller.py:261]  eval | step:  320000 | eval time:  543.5 sec | output: 
    {'3': {'avg_iou': 0.5047221,
           'avg_obj': 0.27125543,
           'box_loss': 2.7457728,
           'class_loss': 1.0545849,
           'conf_loss': 44.152473,
           'precision50': 0.12840673,
           'recall50': 0.28600758},
     '4': {'avg_iou': 0.72660255,
           'avg_obj': 0.52448344,
           'box_loss': 2.070195,
           'class_loss': 0.85069865,
           'conf_loss': 11.125504,
           'precision50': 0.1619571,
           'recall50': 0.5835497},
     '5': {'avg_iou': 0.79483163,
           'avg_obj': 0.6510057,
           'box_loss': 1.0244817,
           'class_loss': 0.45877227,
           'conf_loss': 1.9461609,
           'precision50': 0.22318193,
           'recall50': 0.7258765},
     'AP': 0.3738379,
     'AP50': 0.5678325,
     'AP75': 0.40753347,
     'APl': 0.5218344,
     'APm': 0.39384842,
     'APs': 0.15723565,
     'ARl': 0.68497425,
     'ARm': 0.57245475,
     'ARmax1': 0.30804786,
     'ARmax10': 0.49421495,
     'ARmax100': 0.5361575,
     'ARs': 0.31275424,
     'global': {'total_loss': 65.42858},
     'validation_loss': 65.42858}
I0426 11:47:04.949214 140388535805760 controller.py:211] train | step:  320000 | training until step 340000...
I0426 12:36:25.041432 140388535805760 controller.py:425] train | step:  330000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.67813694,
           'avg_obj': 0.34807235,
           'box_loss': 3.797919,
           'class_loss': 1.7293668,
           'conf_loss': 44.88666,
           'precision50': 0.15506504,
           'recall50': 0.2613428},
     '4': {'avg_iou': 0.8009351,
           'avg_obj': 0.52783763,
           'box_loss': 2.3327746,
           'class_loss': 1.3155414,
           'conf_loss': 11.377386,
           'precision50': 0.19133598,
           'recall50': 0.52228826},
     '5': {'avg_iou': 0.83692384,
           'avg_obj': 0.61683,
           'box_loss': 1.0445646,
           'class_loss': 0.67955065,
           'conf_loss': 2.0679169,
           'precision50': 0.25419858,
           'recall50': 0.66879797},
     'global': {'total_loss': 69.23161},
     'learning_rate': 0.001,
     'training_loss': 69.23161}
I0426 12:37:12.732372 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-330000.
I0426 13:36:56.474728 140388535805760 controller.py:425] train | step:  340000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6781835,
           'avg_obj': 0.34932607,
           'box_loss': 3.8058586,
           'class_loss': 1.7288742,
           'conf_loss': 45.44391,
           'precision50': 0.15619494,
           'recall50': 0.26274675},
     '4': {'avg_iou': 0.80031496,
           'avg_obj': 0.5287379,
           'box_loss': 2.3446963,
           'class_loss': 1.3128649,
           'conf_loss': 11.444341,
           'precision50': 0.18869825,
           'recall50': 0.52383244},
     '5': {'avg_iou': 0.8373072,
           'avg_obj': 0.6188729,
           'box_loss': 1.0434161,
           'class_loss': 0.6768675,
           'conf_loss': 2.0557792,
           'precision50': 0.25539836,
           'recall50': 0.6715425},
     'global': {'total_loss': 69.85647},
     'learning_rate': 0.001,
     'training_loss': 69.85647}
I0426 13:37:45.379106 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-340000.
I0426 13:37:45.386096 140388535805760 controller.py:252]  eval | step:  340000 | running 625 steps of evaluation...
I0426 13:42:08.625895 140388535805760 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0426 13:46:58.580925 140388535805760 controller.py:261]  eval | step:  340000 | eval time:  553.2 sec | output: 
    {'3': {'avg_iou': 0.50507015,
           'avg_obj': 0.26665902,
           'box_loss': 2.7355113,
           'class_loss': 1.0435308,
           'conf_loss': 44.0586,
           'precision50': 0.13015112,
           'recall50': 0.2795798},
     '4': {'avg_iou': 0.7258624,
           'avg_obj': 0.52082556,
           'box_loss': 2.0791852,
           'class_loss': 0.8424832,
           'conf_loss': 11.160378,
           'precision50': 0.16073924,
           'recall50': 0.57881325},
     '5': {'avg_iou': 0.7948019,
           'avg_obj': 0.65124106,
           'box_loss': 1.0253596,
           'class_loss': 0.45445284,
           'conf_loss': 1.9532646,
           'precision50': 0.22394653,
           'recall50': 0.7283306},
     'AP': 0.37306032,
     'AP50': 0.56620866,
     'AP75': 0.40673095,
     'APl': 0.5211937,
     'APm': 0.39330512,
     'APs': 0.15580475,
     'ARl': 0.68286705,
     'ARm': 0.57058245,
     'ARmax1': 0.30755988,
     'ARmax10': 0.4935285,
     'ARmax100': 0.5345494,
     'ARs': 0.30830333,
     'global': {'total_loss': 65.35272},
     'validation_loss': 65.35272}

train | step:  300000 | training until step 320000...
train | step:  310000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6767836,
           'avg_obj': 0.34378284,
           'box_loss': 3.8224325,
           'class_loss': 1.7540344,
           'conf_loss': 45.97202,
           'precision50': 0.15348415,
           'recall50': 0.25859386},
     '4': {'avg_iou': 0.8000946,
           'avg_obj': 0.5239035,
           'box_loss': 2.35,
           'class_loss': 1.335066,
           'conf_loss': 11.47719,
           'precision50': 0.19019897,
           'recall50': 0.51905453},
     '5': {'avg_iou': 0.8356461,
           'avg_obj': 0.6134093,
           'box_loss': 1.0537925,
           'class_loss': 0.6915938,
           'conf_loss': 2.078119,
           'precision50': 0.25485283,
           'recall50': 0.6649223},
     'global': {'total_loss': 70.5342},
     'learning_rate': 0.001,
     'training_loss': 70.5342}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-310000.
train | step:  320000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.67702824,
           'avg_obj': 0.34619674,
           'box_loss': 3.8206317,
           'class_loss': 1.7452977,
           'conf_loss': 45.722595,
           'precision50': 0.1542667,
           'recall50': 0.26051944},
     '4': {'avg_iou': 0.80052406,
           'avg_obj': 0.5260133,
           'box_loss': 2.341979,
           'class_loss': 1.3264034,
           'conf_loss': 11.510703,
           'precision50': 0.19045842,
           'recall50': 0.52123743},
     '5': {'avg_iou': 0.8365091,
           'avg_obj': 0.6153154,
           'box_loss': 1.0483077,
           'class_loss': 0.68580914,
           'conf_loss': 2.0829067,
           'precision50': 0.25327927,
           'recall50': 0.6673918},
     'global': {'total_loss': 70.28466},
     'learning_rate': 0.001,
     'training_loss': 70.28466}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-320000.
 eval | step:  320000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=194.55s).
Accumulating evaluation results...
DONE (t=30.55s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.374
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.568
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.408
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.157
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.394
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.522
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.308
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.494
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.536
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.313
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.572
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.685
 eval | step:  320000 | eval time:  543.5 sec | output: 
    {'3': {'avg_iou': 0.5047221,
           'avg_obj': 0.27125543,
           'box_loss': 2.7457728,
           'class_loss': 1.0545849,
           'conf_loss': 44.152473,
           'precision50': 0.12840673,
           'recall50': 0.28600758},
     '4': {'avg_iou': 0.72660255,
           'avg_obj': 0.52448344,
           'box_loss': 2.070195,
           'class_loss': 0.85069865,
           'conf_loss': 11.125504,
           'precision50': 0.1619571,
           'recall50': 0.5835497},
     '5': {'avg_iou': 0.79483163,
           'avg_obj': 0.6510057,
           'box_loss': 1.0244817,
           'class_loss': 0.45877227,
           'conf_loss': 1.9461609,
           'precision50': 0.22318193,
           'recall50': 0.7258765},
     'AP': 0.3738379,
     'AP50': 0.5678325,
     'AP75': 0.40753347,
     'APl': 0.5218344,
     'APm': 0.39384842,
     'APs': 0.15723565,
     'ARl': 0.68497425,
     'ARm': 0.57245475,
     'ARmax1': 0.30804786,
     'ARmax10': 0.49421495,
     'ARmax100': 0.5361575,
     'ARs': 0.31275424,
     'global': {'total_loss': 65.42858},
     'validation_loss': 65.42858}
train | step:  320000 | training until step 340000...
train | step:  330000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.67813694,
           'avg_obj': 0.34807235,
           'box_loss': 3.797919,
           'class_loss': 1.7293668,
           'conf_loss': 44.88666,
           'precision50': 0.15506504,
           'recall50': 0.2613428},
     '4': {'avg_iou': 0.8009351,
           'avg_obj': 0.52783763,
           'box_loss': 2.3327746,
           'class_loss': 1.3155414,
           'conf_loss': 11.377386,
           'precision50': 0.19133598,
           'recall50': 0.52228826},
     '5': {'avg_iou': 0.83692384,
           'avg_obj': 0.61683,
           'box_loss': 1.0445646,
           'class_loss': 0.67955065,
           'conf_loss': 2.0679169,
           'precision50': 0.25419858,
           'recall50': 0.66879797},
     'global': {'total_loss': 69.23161},
     'learning_rate': 0.001,
     'training_loss': 69.23161}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-330000.
train | step:  340000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6781835,
           'avg_obj': 0.34932607,
           'box_loss': 3.8058586,
           'class_loss': 1.7288742,
           'conf_loss': 45.44391,
           'precision50': 0.15619494,
           'recall50': 0.26274675},
     '4': {'avg_iou': 0.80031496,
           'avg_obj': 0.5287379,
           'box_loss': 2.3446963,
           'class_loss': 1.3128649,
           'conf_loss': 11.444341,
           'precision50': 0.18869825,
           'recall50': 0.52383244},
     '5': {'avg_iou': 0.8373072,
           'avg_obj': 0.6188729,
           'box_loss': 1.0434161,
           'class_loss': 0.6768675,
           'conf_loss': 2.0557792,
           'precision50': 0.25539836,
           'recall50': 0.6715425},
     'global': {'total_loss': 69.85647},
     'learning_rate': 0.001,
     'training_loss': 69.85647}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-340000.
 eval | step:  340000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=201.60s).
Accumulating evaluation results...
DONE (t=31.46s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.373
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.566
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.407
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.156
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.393
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.521
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.308
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.494
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.535
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.308
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.571
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.683
 eval | step:  340000 | eval time:  553.2 sec | output: 
    {'3': {'avg_iou': 0.50507015,
           'avg_obj': 0.26665902,
           'box_loss': 2.7355113,
           'class_loss': 1.0435308,
           'conf_loss': 44.0586,
           'precision50': 0.13015112,
           'recall50': 0.2795798},
     '4': {'avg_iou': 0.7258624,
           'avg_obj': 0.52082556,
           'box_loss': 2.0791852,
           'class_loss': 0.8424832,
           'conf_loss': 11.160378,
           'precision50': 0.16073924,
           'recall50': 0.57881325},
     '5': {'avg_iou': 0.7948019,
           'avg_obj': 0.65124106,
           'box_loss': 1.0253596,
           'class_loss': 0.45445284,
           'conf_loss': 1.9532646,
           'precision50': 0.22394653,
           'recall50': 0.7283306},
     'AP': 0.37306032,
     'AP50': 0.56620866,
     'AP75': 0.40673095,
     'APl': 0.5211937,
     'APm': 0.39330512,
     'APs': 0.15580475,
     'ARl': 0.68286705,
     'ARm': 0.57058245,
     'ARmax1': 0.30755988,
     'ARmax10': 0.4935285,
     'ARmax100': 0.5345494,
     'ARs': 0.30830333,
     'global': {'total_loss': 65.35272},
     'validation_loss': 65.35272}I0426 13:47:16.734028 140388535805760 controller.py:211] train | step:  340000 | training until step 360000...
I0426 14:36:49.162150 140388535805760 controller.py:425] train | step:  350000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6781994,
           'avg_obj': 0.35032696,
           'box_loss': 3.8095007,
           'class_loss': 1.72369,
           'conf_loss': 45.001877,
           'precision50': 0.15763932,
           'recall50': 0.26456937},
     '4': {'avg_iou': 0.802044,
           'avg_obj': 0.53213894,
           'box_loss': 2.3290803,
           'class_loss': 1.3073784,
           'conf_loss': 11.391313,
           'precision50': 0.18799798,
           'recall50': 0.5272203},
     '5': {'avg_iou': 0.83818513,
           'avg_obj': 0.6210714,
           'box_loss': 1.0392253,
           'class_loss': 0.67286694,
           'conf_loss': 2.0531783,
           'precision50': 0.25513342,
           'recall50': 0.6728737},
     'global': {'total_loss': 69.32826},
     'learning_rate': 0.001,
     'training_loss': 69.32826}
I0426 14:37:37.700812 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-350000.
I0426 15:36:06.621000 140388535805760 controller.py:425] train | step:  360000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.67833424,
           'avg_obj': 0.35219997,
           'box_loss': 3.8154762,
           'class_loss': 1.7201906,
           'conf_loss': 44.554703,
           'precision50': 0.16034621,
           'recall50': 0.26629007},
     '4': {'avg_iou': 0.8031199,
           'avg_obj': 0.5347448,
           'box_loss': 2.3154395,
           'class_loss': 1.3005438,
           'conf_loss': 11.2713585,
           'precision50': 0.18992415,
           'recall50': 0.530642},
     '5': {'avg_iou': 0.83859503,
           'avg_obj': 0.6230182,
           'box_loss': 1.0359732,
           'class_loss': 0.6692173,
           'conf_loss': 2.041632,
           'precision50': 0.25542858,
           'recall50': 0.67493594},
     'global': {'total_loss': 68.724594},
     'learning_rate': 0.001,
     'training_loss': 68.724594}
I0426 15:36:54.687132 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-360000.
I0426 15:36:54.694314 140388535805760 controller.py:252]  eval | step:  360000 | running 625 steps of evaluation...
I0426 15:41:12.821864 140388535805760 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0426 15:45:49.942877 140388535805760 controller.py:261]  eval | step:  360000 | eval time:  535.2 sec | output: 
    {'3': {'avg_iou': 0.5029386,
           'avg_obj': 0.2725541,
           'box_loss': 2.7620573,
           'class_loss': 1.0421097,
           'conf_loss': 43.882977,
           'precision50': 0.12948056,
           'recall50': 0.28896},
     '4': {'avg_iou': 0.7267997,
           'avg_obj': 0.5273198,
           'box_loss': 2.0759811,
           'class_loss': 0.84685594,
           'conf_loss': 11.081499,
           'precision50': 0.15926677,
           'recall50': 0.587173},
     '5': {'avg_iou': 0.79495496,
           'avg_obj': 0.6542607,
           'box_loss': 1.025474,
           'class_loss': 0.45718405,
           'conf_loss': 1.9690588,
           'precision50': 0.22269273,
           'recall50': 0.73146915},
     'AP': 0.37371027,
     'AP50': 0.5686087,
     'AP75': 0.40451193,
     'APl': 0.5222054,
     'APm': 0.3962942,
     'APs': 0.15586384,
     'ARl': 0.6789078,
     'ARm': 0.5663324,
     'ARmax1': 0.30601436,
     'ARmax10': 0.49241865,
     'ARmax100': 0.53219014,
     'ARs': 0.30535808,
     'global': {'total_loss': 65.14316},
     'validation_loss': 65.14316}
I0426 15:46:07.492486 140388535805760 controller.py:211] train | step:  360000 | training until step 380000...
I0426 16:36:11.693227 140388535805760 controller.py:425] train | step:  370000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6786357,
           'avg_obj': 0.354487,
           'box_loss': 3.8097918,
           'class_loss': 1.7134781,
           'conf_loss': 45.18848,
           'precision50': 0.15899119,
           'recall50': 0.2688017},
     '4': {'avg_iou': 0.803641,
           'avg_obj': 0.53658503,
           'box_loss': 2.3072188,
           'class_loss': 1.2925237,
           'conf_loss': 11.186417,
           'precision50': 0.19186476,
           'recall50': 0.53256685},
     '5': {'avg_iou': 0.83920467,
           'avg_obj': 0.62469286,
           'box_loss': 1.0305878,
           'class_loss': 0.6634924,
           'conf_loss': 2.0369735,
           'precision50': 0.25601584,
           'recall50': 0.6766876},
     'global': {'total_loss': 69.22891},
     'learning_rate': 0.001,
     'training_loss': 69.22891}
I0426 16:37:01.194643 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-370000.
I0426 17:35:53.020720 140388535805760 controller.py:425] train | step:  380000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6792865,
           'avg_obj': 0.3559463,
           'box_loss': 3.7948816,
           'class_loss': 1.7043169,
           'conf_loss': 44.87017,
           'precision50': 0.1555775,
           'recall50': 0.27073893},
     '4': {'avg_iou': 0.8044899,
           'avg_obj': 0.53906065,
           'box_loss': 2.297522,
           'class_loss': 1.2877505,
           'conf_loss': 11.136139,
           'precision50': 0.19122048,
           'recall50': 0.534755},
     '5': {'avg_iou': 0.8400203,
           'avg_obj': 0.62684524,
           'box_loss': 1.0268295,
           'class_loss': 0.6617678,
           'conf_loss': 2.0289927,
           'precision50': 0.25534698,
           'recall50': 0.6786573},
     'global': {'total_loss': 68.80812},
     'learning_rate': 0.001,
     'training_loss': 68.80812}
I0426 17:36:41.159976 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-380000.
I0426 17:36:41.166484 140388535805760 controller.py:252]  eval | step:  380000 | running 625 steps of evaluation...
I0426 17:40:58.584910 140388535805760 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0426 17:45:42.106169 140388535805760 controller.py:261]  eval | step:  380000 | eval time:  540.9 sec | output: 
    {'3': {'avg_iou': 0.50442547,
           'avg_obj': 0.2663561,
           'box_loss': 2.7380035,
           'class_loss': 1.0430987,
           'conf_loss': 43.563175,
           'precision50': 0.12923422,
           'recall50': 0.28140816},
     '4': {'avg_iou': 0.7264701,
           'avg_obj': 0.5213421,
           'box_loss': 2.0839555,
           'class_loss': 0.84573984,
           'conf_loss': 10.982884,
           'precision50': 0.1604878,
           'recall50': 0.57863337},
     '5': {'avg_iou': 0.79469275,
           'avg_obj': 0.6523268,
           'box_loss': 1.0275115,
           'class_loss': 0.4567465,
           'conf_loss': 1.959417,
           'precision50': 0.22519724,
           'recall50': 0.72815543},
     'AP': 0.37463072,
     'AP50': 0.5683394,
     'AP75': 0.40387234,
     'APl': 0.52178735,
     'APm': 0.39373377,
     'APs': 0.15801838,
     'ARl': 0.6846017,
     'ARm': 0.57076484,
     'ARmax1': 0.3074921,
     'ARmax10': 0.49440226,
     'ARmax100': 0.5347855,
     'ARs': 0.31109715,
     'global': {'total_loss': 64.70055},
     'validation_loss': 64.70055}

train | step:  340000 | training until step 360000...
train | step:  350000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6781994,
           'avg_obj': 0.35032696,
           'box_loss': 3.8095007,
           'class_loss': 1.72369,
           'conf_loss': 45.001877,
           'precision50': 0.15763932,
           'recall50': 0.26456937},
     '4': {'avg_iou': 0.802044,
           'avg_obj': 0.53213894,
           'box_loss': 2.3290803,
           'class_loss': 1.3073784,
           'conf_loss': 11.391313,
           'precision50': 0.18799798,
           'recall50': 0.5272203},
     '5': {'avg_iou': 0.83818513,
           'avg_obj': 0.6210714,
           'box_loss': 1.0392253,
           'class_loss': 0.67286694,
           'conf_loss': 2.0531783,
           'precision50': 0.25513342,
           'recall50': 0.6728737},
     'global': {'total_loss': 69.32826},
     'learning_rate': 0.001,
     'training_loss': 69.32826}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-350000.
train | step:  360000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.67833424,
           'avg_obj': 0.35219997,
           'box_loss': 3.8154762,
           'class_loss': 1.7201906,
           'conf_loss': 44.554703,
           'precision50': 0.16034621,
           'recall50': 0.26629007},
     '4': {'avg_iou': 0.8031199,
           'avg_obj': 0.5347448,
           'box_loss': 2.3154395,
           'class_loss': 1.3005438,
           'conf_loss': 11.2713585,
           'precision50': 0.18992415,
           'recall50': 0.530642},
     '5': {'avg_iou': 0.83859503,
           'avg_obj': 0.6230182,
           'box_loss': 1.0359732,
           'class_loss': 0.6692173,
           'conf_loss': 2.041632,
           'precision50': 0.25542858,
           'recall50': 0.67493594},
     'global': {'total_loss': 68.724594},
     'learning_rate': 0.001,
     'training_loss': 68.724594}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-360000.
 eval | step:  360000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=193.37s).
Accumulating evaluation results...
DONE (t=29.13s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.374
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.569
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.405
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.156
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.396
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.522
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.306
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.492
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.532
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.305
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.566
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.679
 eval | step:  360000 | eval time:  535.2 sec | output: 
    {'3': {'avg_iou': 0.5029386,
           'avg_obj': 0.2725541,
           'box_loss': 2.7620573,
           'class_loss': 1.0421097,
           'conf_loss': 43.882977,
           'precision50': 0.12948056,
           'recall50': 0.28896},
     '4': {'avg_iou': 0.7267997,
           'avg_obj': 0.5273198,
           'box_loss': 2.0759811,
           'class_loss': 0.84685594,
           'conf_loss': 11.081499,
           'precision50': 0.15926677,
           'recall50': 0.587173},
     '5': {'avg_iou': 0.79495496,
           'avg_obj': 0.6542607,
           'box_loss': 1.025474,
           'class_loss': 0.45718405,
           'conf_loss': 1.9690588,
           'precision50': 0.22269273,
           'recall50': 0.73146915},
     'AP': 0.37371027,
     'AP50': 0.5686087,
     'AP75': 0.40451193,
     'APl': 0.5222054,
     'APm': 0.3962942,
     'APs': 0.15586384,
     'ARl': 0.6789078,
     'ARm': 0.5663324,
     'ARmax1': 0.30601436,
     'ARmax10': 0.49241865,
     'ARmax100': 0.53219014,
     'ARs': 0.30535808,
     'global': {'total_loss': 65.14316},
     'validation_loss': 65.14316}
train | step:  360000 | training until step 380000...
train | step:  370000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6786357,
           'avg_obj': 0.354487,
           'box_loss': 3.8097918,
           'class_loss': 1.7134781,
           'conf_loss': 45.18848,
           'precision50': 0.15899119,
           'recall50': 0.2688017},
     '4': {'avg_iou': 0.803641,
           'avg_obj': 0.53658503,
           'box_loss': 2.3072188,
           'class_loss': 1.2925237,
           'conf_loss': 11.186417,
           'precision50': 0.19186476,
           'recall50': 0.53256685},
     '5': {'avg_iou': 0.83920467,
           'avg_obj': 0.62469286,
           'box_loss': 1.0305878,
           'class_loss': 0.6634924,
           'conf_loss': 2.0369735,
           'precision50': 0.25601584,
           'recall50': 0.6766876},
     'global': {'total_loss': 69.22891},
     'learning_rate': 0.001,
     'training_loss': 69.22891}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-370000.
train | step:  380000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6792865,
           'avg_obj': 0.3559463,
           'box_loss': 3.7948816,
           'class_loss': 1.7043169,
           'conf_loss': 44.87017,
           'precision50': 0.1555775,
           'recall50': 0.27073893},
     '4': {'avg_iou': 0.8044899,
           'avg_obj': 0.53906065,
           'box_loss': 2.297522,
           'class_loss': 1.2877505,
           'conf_loss': 11.136139,
           'precision50': 0.19122048,
           'recall50': 0.534755},
     '5': {'avg_iou': 0.8400203,
           'avg_obj': 0.62684524,
           'box_loss': 1.0268295,
           'class_loss': 0.6617678,
           'conf_loss': 2.0289927,
           'precision50': 0.25534698,
           'recall50': 0.6786573},
     'global': {'total_loss': 68.80812},
     'learning_rate': 0.001,
     'training_loss': 68.80812}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-380000.
 eval | step:  380000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=194.11s).
Accumulating evaluation results...
DONE (t=29.16s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.375
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.568
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.404
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.158
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.394
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.522
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.307
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.494
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.535
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.311
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.571
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.685
 eval | step:  380000 | eval time:  540.9 sec | output: 
    {'3': {'avg_iou': 0.50442547,
           'avg_obj': 0.2663561,
           'box_loss': 2.7380035,
           'class_loss': 1.0430987,
           'conf_loss': 43.563175,
           'precision50': 0.12923422,
           'recall50': 0.28140816},
     '4': {'avg_iou': 0.7264701,
           'avg_obj': 0.5213421,
           'box_loss': 2.0839555,
           'class_loss': 0.84573984,
           'conf_loss': 10.982884,
           'precision50': 0.1604878,
           'recall50': 0.57863337},
     '5': {'avg_iou': 0.79469275,
           'avg_obj': 0.6523268,
           'box_loss': 1.0275115,
           'class_loss': 0.4567465,
           'conf_loss': 1.959417,
           'precision50': 0.22519724,
           'recall50': 0.72815543},
     'AP': 0.37463072,
     'AP50': 0.5683394,
     'AP75': 0.40387234,
     'APl': 0.52178735,
     'APm': 0.39373377,
     'APs': 0.15801838,
     'ARl': 0.6846017,
     'ARm': 0.57076484,
     'ARmax1': 0.3074921,
     'ARmax10': 0.49440226,
     'ARmax100': 0.5347855,
     'ARs': 0.31109715,
     'global': {'total_loss': 64.70055},
     'validation_loss': 64.70055}I0426 17:46:04.592103 140388535805760 controller.py:211] train | step:  380000 | training until step 400000...
I0426 18:35:47.018764 140388535805760 controller.py:425] train | step:  390000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.680135,
           'avg_obj': 0.3573154,
           'box_loss': 3.7763224,
           'class_loss': 1.6878551,
           'conf_loss': 44.275795,
           'precision50': 0.15663907,
           'recall50': 0.27130187},
     '4': {'avg_iou': 0.8046061,
           'avg_obj': 0.5403181,
           'box_loss': 2.2909687,
           'class_loss': 1.276348,
           'conf_loss': 11.090816,
           'precision50': 0.1907078,
           'recall50': 0.53596526},
     '5': {'avg_iou': 0.8402501,
           'avg_obj': 0.6280354,
           'box_loss': 1.0229355,
           'class_loss': 0.6558852,
           'conf_loss': 2.0165055,
           'precision50': 0.254868,
           'recall50': 0.67946887},
     'global': {'total_loss': 68.093346},
     'learning_rate': 0.001,
     'training_loss': 68.093346}
I0426 18:36:33.308191 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-390000.
I0426 19:35:01.997383 140388535805760 controller.py:425] train | step:  400000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.67966443,
           'avg_obj': 0.3585761,
           'box_loss': 3.7889302,
           'class_loss': 1.6863098,
           'conf_loss': 44.28201,
           'precision50': 0.15788276,
           'recall50': 0.2730917},
     '4': {'avg_iou': 0.8047935,
           'avg_obj': 0.54265344,
           'box_loss': 2.2958252,
           'class_loss': 1.2736974,
           'conf_loss': 11.400101,
           'precision50': 0.18592359,
           'recall50': 0.53843653},
     '5': {'avg_iou': 0.84085184,
           'avg_obj': 0.6294047,
           'box_loss': 1.0219767,
           'class_loss': 0.6538554,
           'conf_loss': 2.0201833,
           'precision50': 0.255408,
           'recall50': 0.68165433},
     'global': {'total_loss': 68.42261},
     'learning_rate': 0.001,
     'training_loss': 68.42261}
I0426 19:35:49.006931 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-400000.
I0426 19:35:49.012478 140388535805760 controller.py:252]  eval | step:  400000 | running 625 steps of evaluation...
I0426 19:40:03.911443 140388535805760 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0426 19:44:49.526241 140388535805760 controller.py:261]  eval | step:  400000 | eval time:  540.5 sec | output: 
    {'3': {'avg_iou': 0.5045132,
           'avg_obj': 0.2673916,
           'box_loss': 2.7347362,
           'class_loss': 1.0375073,
           'conf_loss': 43.54209,
           'precision50': 0.12906373,
           'recall50': 0.28334457},
     '4': {'avg_iou': 0.7258305,
           'avg_obj': 0.52375305,
           'box_loss': 2.088707,
           'class_loss': 0.8455093,
           'conf_loss': 11.448239,
           'precision50': 0.15592226,
           'recall50': 0.58330446},
     '5': {'avg_iou': 0.7950592,
           'avg_obj': 0.65414184,
           'box_loss': 1.0255153,
           'class_loss': 0.45359537,
           'conf_loss': 1.9498061,
           'precision50': 0.22385423,
           'recall50': 0.72819734},
     'AP': 0.37558535,
     'AP50': 0.56939745,
     'AP75': 0.40588823,
     'APl': 0.521223,
     'APm': 0.39352942,
     'APs': 0.16304345,
     'ARl': 0.68471867,
     'ARm': 0.56457317,
     'ARmax1': 0.3067588,
     'ARmax10': 0.49389577,
     'ARmax100': 0.53391284,
     'ARs': 0.30805087,
     'global': {'total_loss': 65.1257},
     'validation_loss': 65.1257}
I0426 19:45:08.011933 140388535805760 controller.py:211] train | step:  400000 | training until step 420000...
I0426 20:35:04.725981 140388535805760 controller.py:425] train | step:  410000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.68652636,
           'avg_obj': 0.37789676,
           'box_loss': 3.7235427,
           'class_loss': 1.6082863,
           'conf_loss': 44.434216,
           'precision50': 0.15080698,
           'recall50': 0.29230368},
     '4': {'avg_iou': 0.809339,
           'avg_obj': 0.56215227,
           'box_loss': 2.2411628,
           'class_loss': 1.2007751,
           'conf_loss': 11.1499405,
           'precision50': 0.18356863,
           'recall50': 0.5599515},
     '5': {'avg_iou': 0.8477739,
           'avg_obj': 0.65041816,
           'box_loss': 0.97626007,
           'class_loss': 0.60378486,
           'conf_loss': 1.9145688,
           'precision50': 0.25504574,
           'recall50': 0.7008524},
     'global': {'total_loss': 67.85262},
     'learning_rate': 1e-04,
     'training_loss': 67.85262}
I0426 20:35:51.075952 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-410000.
I0426 21:35:07.173595 140388535805760 controller.py:425] train | step:  420000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6876232,
           'avg_obj': 0.3831902,
           'box_loss': 3.6940715,
           'class_loss': 1.5802414,
           'conf_loss': 44.25498,
           'precision50': 0.15127972,
           'recall50': 0.29814965},
     '4': {'avg_iou': 0.8123923,
           'avg_obj': 0.56997883,
           'box_loss': 2.203375,
           'class_loss': 1.17148,
           'conf_loss': 10.905826,
           'precision50': 0.18416846,
           'recall50': 0.56793535},
     '5': {'avg_iou': 0.84955525,
           'avg_obj': 0.6571751,
           'box_loss': 0.9641204,
           'class_loss': 0.58740866,
           'conf_loss': 1.8949326,
           'precision50': 0.25373384,
           'recall50': 0.707287},
     'global': {'total_loss': 67.25624},
     'learning_rate': 1e-04,
     'training_loss': 67.25624}
I0426 21:35:54.150115 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-420000.
I0426 21:35:54.158265 140388535805760 controller.py:252]  eval | step:  420000 | running 625 steps of evaluation...
I0426 21:40:08.610385 140388535805760 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0426 21:44:54.388213 140388535805760 controller.py:261]  eval | step:  420000 | eval time:  540.2 sec | output: 
    {'3': {'avg_iou': 0.50210804,
           'avg_obj': 0.26470467,
           'box_loss': 2.7622204,
           'class_loss': 1.0541074,
           'conf_loss': 45.0858,
           'precision50': 0.123750195,
           'recall50': 0.2809919},
     '4': {'avg_iou': 0.7218558,
           'avg_obj': 0.5201294,
           'box_loss': 2.1410735,
           'class_loss': 0.87084275,
           'conf_loss': 11.705615,
           'precision50': 0.1527985,
           'recall50': 0.5783618},
     '5': {'avg_iou': 0.7923037,
           'avg_obj': 0.65250283,
           'box_loss': 1.0444338,
           'class_loss': 0.4652851,
           'conf_loss': 1.9856924,
           'precision50': 0.22522505,
           'recall50': 0.7229707},
     'AP': 0.36507735,
     'AP50': 0.55611885,
     'AP75': 0.3961244,
     'APl': 0.5107306,
     'APm': 0.3818369,
     'APs': 0.15442774,
     'ARl': 0.67664427,
     'ARm': 0.5542735,
     'ARmax1': 0.3032432,
     'ARmax10': 0.48523352,
     'ARmax100': 0.5248492,
     'ARs': 0.3019115,
     'global': {'total_loss': 67.11506},
     'validation_loss': 67.11506}

train | step:  380000 | training until step 400000...
train | step:  390000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.680135,
           'avg_obj': 0.3573154,
           'box_loss': 3.7763224,
           'class_loss': 1.6878551,
           'conf_loss': 44.275795,
           'precision50': 0.15663907,
           'recall50': 0.27130187},
     '4': {'avg_iou': 0.8046061,
           'avg_obj': 0.5403181,
           'box_loss': 2.2909687,
           'class_loss': 1.276348,
           'conf_loss': 11.090816,
           'precision50': 0.1907078,
           'recall50': 0.53596526},
     '5': {'avg_iou': 0.8402501,
           'avg_obj': 0.6280354,
           'box_loss': 1.0229355,
           'class_loss': 0.6558852,
           'conf_loss': 2.0165055,
           'precision50': 0.254868,
           'recall50': 0.67946887},
     'global': {'total_loss': 68.093346},
     'learning_rate': 0.001,
     'training_loss': 68.093346}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-390000.
train | step:  400000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.67966443,
           'avg_obj': 0.3585761,
           'box_loss': 3.7889302,
           'class_loss': 1.6863098,
           'conf_loss': 44.28201,
           'precision50': 0.15788276,
           'recall50': 0.2730917},
     '4': {'avg_iou': 0.8047935,
           'avg_obj': 0.54265344,
           'box_loss': 2.2958252,
           'class_loss': 1.2736974,
           'conf_loss': 11.400101,
           'precision50': 0.18592359,
           'recall50': 0.53843653},
     '5': {'avg_iou': 0.84085184,
           'avg_obj': 0.6294047,
           'box_loss': 1.0219767,
           'class_loss': 0.6538554,
           'conf_loss': 2.0201833,
           'precision50': 0.255408,
           'recall50': 0.68165433},
     'global': {'total_loss': 68.42261},
     'learning_rate': 0.001,
     'training_loss': 68.42261}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-400000.
 eval | step:  400000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=198.41s).
Accumulating evaluation results...
DONE (t=28.75s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.376
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.569
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.406
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.163
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.394
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.521
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.307
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.494
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.534
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.308
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.565
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.685
 eval | step:  400000 | eval time:  540.5 sec | output: 
    {'3': {'avg_iou': 0.5045132,
           'avg_obj': 0.2673916,
           'box_loss': 2.7347362,
           'class_loss': 1.0375073,
           'conf_loss': 43.54209,
           'precision50': 0.12906373,
           'recall50': 0.28334457},
     '4': {'avg_iou': 0.7258305,
           'avg_obj': 0.52375305,
           'box_loss': 2.088707,
           'class_loss': 0.8455093,
           'conf_loss': 11.448239,
           'precision50': 0.15592226,
           'recall50': 0.58330446},
     '5': {'avg_iou': 0.7950592,
           'avg_obj': 0.65414184,
           'box_loss': 1.0255153,
           'class_loss': 0.45359537,
           'conf_loss': 1.9498061,
           'precision50': 0.22385423,
           'recall50': 0.72819734},
     'AP': 0.37558535,
     'AP50': 0.56939745,
     'AP75': 0.40588823,
     'APl': 0.521223,
     'APm': 0.39352942,
     'APs': 0.16304345,
     'ARl': 0.68471867,
     'ARm': 0.56457317,
     'ARmax1': 0.3067588,
     'ARmax10': 0.49389577,
     'ARmax100': 0.53391284,
     'ARs': 0.30805087,
     'global': {'total_loss': 65.1257},
     'validation_loss': 65.1257}
train | step:  400000 | training until step 420000...
train | step:  410000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.68652636,
           'avg_obj': 0.37789676,
           'box_loss': 3.7235427,
           'class_loss': 1.6082863,
           'conf_loss': 44.434216,
           'precision50': 0.15080698,
           'recall50': 0.29230368},
     '4': {'avg_iou': 0.809339,
           'avg_obj': 0.56215227,
           'box_loss': 2.2411628,
           'class_loss': 1.2007751,
           'conf_loss': 11.1499405,
           'precision50': 0.18356863,
           'recall50': 0.5599515},
     '5': {'avg_iou': 0.8477739,
           'avg_obj': 0.65041816,
           'box_loss': 0.97626007,
           'class_loss': 0.60378486,
           'conf_loss': 1.9145688,
           'precision50': 0.25504574,
           'recall50': 0.7008524},
     'global': {'total_loss': 67.85262},
     'learning_rate': 1e-04,
     'training_loss': 67.85262}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-410000.
train | step:  420000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6876232,
           'avg_obj': 0.3831902,
           'box_loss': 3.6940715,
           'class_loss': 1.5802414,
           'conf_loss': 44.25498,
           'precision50': 0.15127972,
           'recall50': 0.29814965},
     '4': {'avg_iou': 0.8123923,
           'avg_obj': 0.56997883,
           'box_loss': 2.203375,
           'class_loss': 1.17148,
           'conf_loss': 10.905826,
           'precision50': 0.18416846,
           'recall50': 0.56793535},
     '5': {'avg_iou': 0.84955525,
           'avg_obj': 0.6571751,
           'box_loss': 0.9641204,
           'class_loss': 0.58740866,
           'conf_loss': 1.8949326,
           'precision50': 0.25373384,
           'recall50': 0.707287},
     'global': {'total_loss': 67.25624},
     'learning_rate': 1e-04,
     'training_loss': 67.25624}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-420000.
 eval | step:  420000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=196.90s).
Accumulating evaluation results...
DONE (t=27.84s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.365
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.556
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.396
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.154
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.382
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.511
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.303
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.525
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.302
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.554
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.677
 eval | step:  420000 | eval time:  540.2 sec | output: 
    {'3': {'avg_iou': 0.50210804,
           'avg_obj': 0.26470467,
           'box_loss': 2.7622204,
           'class_loss': 1.0541074,
           'conf_loss': 45.0858,
           'precision50': 0.123750195,
           'recall50': 0.2809919},
     '4': {'avg_iou': 0.7218558,
           'avg_obj': 0.5201294,
           'box_loss': 2.1410735,
           'class_loss': 0.87084275,
           'conf_loss': 11.705615,
           'precision50': 0.1527985,
           'recall50': 0.5783618},
     '5': {'avg_iou': 0.7923037,
           'avg_obj': 0.65250283,
           'box_loss': 1.0444338,
           'class_loss': 0.4652851,
           'conf_loss': 1.9856924,
           'precision50': 0.22522505,
           'recall50': 0.7229707},
     'AP': 0.36507735,
     'AP50': 0.55611885,
     'AP75': 0.3961244,
     'APl': 0.5107306,
     'APm': 0.3818369,
     'APs': 0.15442774,
     'ARl': 0.67664427,
     'ARm': 0.5542735,
     'ARmax1': 0.3032432,
     'ARmax10': 0.48523352,
     'ARmax100': 0.5248492,
     'ARs': 0.3019115,
     'global': {'total_loss': 67.11506},
     'validation_loss': 67.11506}I0426 21:45:12.057199 140388535805760 controller.py:211] train | step:  420000 | training until step 440000...
I0426 22:35:14.568576 140388535805760 controller.py:425] train | step:  430000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6877832,
           'avg_obj': 0.38535994,
           'box_loss': 3.6952586,
           'class_loss': 1.5730208,
           'conf_loss': 44.132946,
           'precision50': 0.15232123,
           'recall50': 0.2999659},
     '4': {'avg_iou': 0.8135588,
           'avg_obj': 0.57347107,
           'box_loss': 2.1912136,
           'class_loss': 1.165603,
           'conf_loss': 10.927957,
           'precision50': 0.18159898,
           'recall50': 0.5713058},
     '5': {'avg_iou': 0.8505538,
           'avg_obj': 0.6601434,
           'box_loss': 0.9575564,
           'class_loss': 0.5815468,
           'conf_loss': 1.8903695,
           'precision50': 0.252451,
           'recall50': 0.70985067},
     'global': {'total_loss': 67.11553},
     'learning_rate': 1e-04,
     'training_loss': 67.11553}
I0426 22:36:02.717943 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-430000.
I0426 23:35:48.760930 140388535805760 controller.py:425] train | step:  440000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.68893313,
           'avg_obj': 0.38796985,
           'box_loss': 3.6831741,
           'class_loss': 1.5605565,
           'conf_loss': 44.1887,
           'precision50': 0.15114415,
           'recall50': 0.30316994},
     '4': {'avg_iou': 0.8142494,
           'avg_obj': 0.5758466,
           'box_loss': 2.1811883,
           'class_loss': 1.157486,
           'conf_loss': 10.896348,
           'precision50': 0.18215114,
           'recall50': 0.5740745},
     '5': {'avg_iou': 0.85106933,
           'avg_obj': 0.6620028,
           'box_loss': 0.955146,
           'class_loss': 0.57909805,
           'conf_loss': 1.8876827,
           'precision50': 0.25221813,
           'recall50': 0.71223366},
     'global': {'total_loss': 67.08927},
     'learning_rate': 1e-04,
     'training_loss': 67.08927}
I0426 23:36:36.850370 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-440000.
I0426 23:36:36.858174 140388535805760 controller.py:252]  eval | step:  440000 | running 625 steps of evaluation...
I0426 23:40:54.939049 140388535805760 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0426 23:45:42.477925 140388535805760 controller.py:261]  eval | step:  440000 | eval time:  545.6 sec | output: 
    {'3': {'avg_iou': 0.50167847,
           'avg_obj': 0.26617554,
           'box_loss': 2.7645981,
           'class_loss': 1.0578393,
           'conf_loss': 45.463833,
           'precision50': 0.12477809,
           'recall50': 0.28508738},
     '4': {'avg_iou': 0.7216024,
           'avg_obj': 0.52090514,
           'box_loss': 2.1462805,
           'class_loss': 0.870746,
           'conf_loss': 11.735126,
           'precision50': 0.15185814,
           'recall50': 0.5805623},
     '5': {'avg_iou': 0.79231477,
           'avg_obj': 0.65499693,
           'box_loss': 1.0450728,
           'class_loss': 0.46518242,
           'conf_loss': 1.9974971,
           'precision50': 0.22395538,
           'recall50': 0.725841},
     'AP': 0.36496198,
     'AP50': 0.5543896,
     'AP75': 0.3954365,
     'APl': 0.50955987,
     'APm': 0.3810739,
     'APs': 0.15663849,
     'ARl': 0.6754618,
     'ARm': 0.55241066,
     'ARmax1': 0.3040246,
     'ARmax10': 0.48514727,
     'ARmax100': 0.5246068,
     'ARs': 0.30387563,
     'global': {'total_loss': 67.546196},
     'validation_loss': 67.546196}
I0426 23:46:00.705979 140388535805760 controller.py:211] train | step:  440000 | training until step 460000...
I0427 00:35:56.374725 140388535805760 controller.py:425] train | step:  450000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.68885696,
           'avg_obj': 0.38896933,
           'box_loss': 3.6832638,
           'class_loss': 1.5626872,
           'conf_loss': 44.10572,
           'precision50': 0.1512814,
           'recall50': 0.30413744},
     '4': {'avg_iou': 0.8147189,
           'avg_obj': 0.57799643,
           'box_loss': 2.178048,
           'class_loss': 1.1544592,
           'conf_loss': 10.879086,
           'precision50': 0.18166113,
           'recall50': 0.5761545},
     '5': {'avg_iou': 0.85144746,
           'avg_obj': 0.66430557,
           'box_loss': 0.95161736,
           'class_loss': 0.5742575,
           'conf_loss': 1.8797935,
           'precision50': 0.25122416,
           'recall50': 0.7140145},
     'global': {'total_loss': 66.96901},
     'learning_rate': 1e-04,
     'training_loss': 66.96901}
I0427 00:36:45.583194 140388535805760 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512/ckpt-450000.
/home/cam2tensorflow/.experiment_start.sh: line 22:  3866 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   204    0     2  100   202     11   1167 --:--:-- --:--:-- --:--:--  1179
okRequest issued for: [node-3]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-27T00:51:32.359051550Z'
  endTime: '2021-04-27T00:52:30.953752907Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619484692344-5c0e9a9ce6fb6-5ba2cc13-47bb3e25
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619484692344-5c0e9a9ce6fb6-5ba2cc13-47bb3e25] to complete...
.............................................................................................................................................................................................................................................................................................................................................................................................done.
