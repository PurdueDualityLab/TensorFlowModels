cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is READY
europe-west4-a
I0515 05:56:36.599130 140114163504960 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[12.0, 16.0]',
                              '[19.0, 36.0]',
                              '[40.0, 28.0]',
                              '[36.0, 75.0]',
                              '[76.0, 55.0]',
                              '[72.0, 146.0]',
                              '[142.0, 110.0]',
                              '[192.0, 243.0]',
                              '[459.0, 401.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'input_size': [512, 512, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.1,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 2.0,
                                    'aug_scale_min': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 2.0,
                                         'aug_scale_min': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0515 05:56:36.599985 140114163504960 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/params.yaml
I0515 05:56:38.164856 140114163504960 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 05:56:38.307159 140114163504960 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0515 05:56:38.307447 140114163504960 transport.py:157] Attempting refresh to obtain initial access_token
I0515 05:56:38.372124 140114163504960 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 05:56:38.986566 140114163504960 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0515 05:56:38.986820 140114163504960 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-15 05:56:39.061138: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0515 05:56:39.061830 140114163504960 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 05:56:39.675025 140114163504960 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0515 05:56:39.675287 140114163504960 transport.py:157] Attempting refresh to obtain initial access_token
I0515 05:56:39.717609 140114163504960 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 05:56:39.858825 140114163504960 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0515 05:56:39.859071 140114163504960 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-15 05:56:39.908585: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-15 05:56:39.918265: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-05-15 05:56:39.918342: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:35802}
cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is READY
europe-west4-a
I0515 06:08:28.782451 139979217270592 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[12.0, 16.0]',
                              '[19.0, 36.0]',
                              '[40.0, 28.0]',
                              '[36.0, 75.0]',
                              '[76.0, 55.0]',
                              '[72.0, 146.0]',
                              '[142.0, 110.0]',
                              '[192.0, 243.0]',
                              '[459.0, 401.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'input_size': [512, 512, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.1,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 2.0,
                                    'aug_scale_min': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 2.0,
                                         'aug_scale_min': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0515 06:08:28.783295 139979217270592 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/params.yaml
I0515 06:08:29.646338 139979217270592 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 06:08:29.792743 139979217270592 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0515 06:08:29.793098 139979217270592 transport.py:157] Attempting refresh to obtain initial access_token
I0515 06:08:29.852046 139979217270592 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 06:08:29.991139 139979217270592 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0515 06:08:29.991499 139979217270592 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-15 06:08:30.051275: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0515 06:08:30.051910 139979217270592 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 06:08:30.194543 139979217270592 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0515 06:08:30.194782 139979217270592 transport.py:157] Attempting refresh to obtain initial access_token
I0515 06:08:30.249977 139979217270592 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 06:08:30.866151 139979217270592 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0515 06:08:30.866575 139979217270592 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-15 06:08:30.918617: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-15 06:08:30.928647: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-05-15 06:08:30.928722: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:36080}
cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is READY
europe-west4-a
I0515 06:10:14.300106 140038911502144 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[12.0, 16.0]',
                              '[19.0, 36.0]',
                              '[40.0, 28.0]',
                              '[36.0, 75.0]',
                              '[76.0, 55.0]',
                              '[72.0, 146.0]',
                              '[142.0, 110.0]',
                              '[192.0, 243.0]',
                              '[459.0, 401.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'input_size': [512, 512, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.1,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 2.0,
                                    'aug_scale_min': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 2.0,
                                         'aug_scale_min': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0515 06:10:14.301071 140038911502144 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/params.yaml
I0515 06:10:15.065799 140038911502144 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 06:10:15.686245 140038911502144 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0515 06:10:15.686490 140038911502144 transport.py:157] Attempting refresh to obtain initial access_token
I0515 06:10:15.757644 140038911502144 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 06:10:16.372452 140038911502144 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0515 06:10:16.372735 140038911502144 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-15 06:10:16.430619: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0515 06:10:16.431279 140038911502144 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 06:10:17.055121 140038911502144 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0515 06:10:17.055359 140038911502144 transport.py:157] Attempting refresh to obtain initial access_token
I0515 06:10:17.106602 140038911502144 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 06:10:17.251720 140038911502144 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0515 06:10:17.252033 140038911502144 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-15 06:10:17.306282: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-15 06:10:17.319274: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-05-15 06:10:17.319359: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:36219}
cat: .experiment_zone: No such file or directory
Request issued for: [node-5]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-15T06:18:28.196596846Z'
  endTime: '2021-05-15T06:19:03.048461870Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621059508182-5c25854251f3f-5471fa47-8137865f
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621059508182-5c25854251f3f-5471fa47-8137865f] to complete...
............................................................................................................................................................................................done.
europe-west4-a
I0515 06:13:46.673070 139725902800704 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[12.0, 16.0]',
                              '[19.0, 36.0]',
                              '[40.0, 28.0]',
                              '[36.0, 75.0]',
                              '[76.0, 55.0]',
                              '[72.0, 146.0]',
                              '[142.0, 110.0]',
                              '[192.0, 243.0]',
                              '[459.0, 401.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'input_size': [512, 512, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.1,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 2.0,
                                    'aug_scale_min': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 2.0,
                                         'aug_scale_min': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0515 06:13:46.674194 139725902800704 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/params.yaml
I0515 06:13:47.493219 139725902800704 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 06:13:47.640942 139725902800704 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0515 06:13:47.641205 139725902800704 transport.py:157] Attempting refresh to obtain initial access_token
I0515 06:13:47.693424 139725902800704 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 06:13:47.834985 139725902800704 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0515 06:13:47.835424 139725902800704 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-15 06:13:47.897533: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0515 06:13:47.898117 139725902800704 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 06:13:48.039957 139725902800704 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0515 06:13:48.040178 139725902800704 transport.py:157] Attempting refresh to obtain initial access_token
I0515 06:13:48.083375 139725902800704 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 06:13:48.699339 139725902800704 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0515 06:13:48.699820 139725902800704 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-15 06:13:48.755086: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-15 06:13:48.764879: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.56.217.90:8470}
2021-05-15 06:13:48.764954: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:36388}
cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is READY
europe-west4-a
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 115, in main
    params = train_utils.parse_configuration(FLAGS)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_utils.py", line 249, in parse_configuration
    params, config_file, is_strict=True)
  File "/home/cam2tensorflow/TensorFlowModels/official/modeling/hyperparams/params_dict.py", line 441, in override_params_dict
    params.override(yaml.load(f, Loader=yaml.FullLoader), is_strict)
  File "/home/cam2tensorflow/TensorFlowModels/official/modeling/hyperparams/params_dict.py", line 161, in override
    self._override(override_params, is_strict)  # pylint: disable=protected-access
  File "/home/cam2tensorflow/TensorFlowModels/official/modeling/hyperparams/base_config.py", line 220, in _override
    self.__dict__[k]._override(v, is_strict)  # pylint: disable=protected-access
  File "/home/cam2tensorflow/TensorFlowModels/official/modeling/hyperparams/base_config.py", line 220, in _override
    self.__dict__[k]._override(v, is_strict)  # pylint: disable=protected-access
  File "/home/cam2tensorflow/TensorFlowModels/official/modeling/hyperparams/base_config.py", line 215, in _override
    k, type(self)))
KeyError: "The key '_boxes' does not exist in <class 'yolo.configs.yolo.Yolo'>. To extend the existing keys, use `override` with `is_strict` = False."
yolo_custom
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     12   1276 --:--:-- --:--:-- --:--:--  1288
okRequest issued for: [node-5]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-15T06:33:28.173298025Z'
  endTime: '2021-05-15T06:33:50.687571709Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621060408157-5c25889c9a60f-b0c17f6f-23ea1548
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621060408157-5c25889c9a60f-b0c17f6f-23ea1548] to complete...
....................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-5]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-15T06:34:42.905506107Z'
  endTime: '2021-05-15T06:35:18.461691922Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621060482891-5c2588e3dfec4-70272126-fafc843c
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621060482891-5c2588e3dfec4-70272126-fafc843c] to complete...
.............................................................................................................................................................................................done.
europe-west4-a
I0515 06:30:01.338713 140710969427776 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[12.0, 16.0]',
                              '[19.0, 36.0]',
                              '[40.0, 28.0]',
                              '[36.0, 75.0]',
                              '[76.0, 55.0]',
                              '[72.0, 146.0]',
                              '[142.0, 110.0]',
                              '[192.0, 243.0]',
                              '[459.0, 401.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'input_size': [512, 512, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.1,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 2.0,
                                    'aug_scale_min': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 2.0,
                                         'aug_scale_min': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0515 06:30:01.340379 140710969427776 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/params.yaml
I0515 06:30:02.157016 140710969427776 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 06:30:02.778733 140710969427776 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0515 06:30:02.778987 140710969427776 transport.py:157] Attempting refresh to obtain initial access_token
I0515 06:30:02.866273 140710969427776 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 06:30:03.006834 140710969427776 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0515 06:30:03.007106 140710969427776 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-15 06:30:03.064061: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0515 06:30:03.064740 140710969427776 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 06:30:03.679621 140710969427776 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0515 06:30:03.679906 140710969427776 transport.py:157] Attempting refresh to obtain initial access_token
I0515 06:30:03.722850 140710969427776 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 06:30:04.338234 140710969427776 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0515 06:30:04.338486 140710969427776 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-15 06:30:04.388559: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-15 06:30:04.398124: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.56.217.90:8470}
2021-05-15 06:30:04.398206: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:36836}
cat: .experiment_zone: No such file or directory
Request issued for: [node-4]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-15T06:37:16.222733217Z'
  endTime: '2021-05-15T06:37:52.568209880Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621060636210-5c25897617415-88502561-6ee67ac1
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.117.66.216/29
  createTime: '2021-03-13T04:41:22.291533178Z'
  health: HEALTHY
  ipAddress: 10.117.66.218
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.117.66.218
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621060636210-5c25897617415-88502561-6ee67ac1] to complete...
......................................................................................................................................................................................................done.
europe-west4-a
I0515 06:32:36.383951 140269323401024 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[12.0, 16.0]',
                              '[19.0, 36.0]',
                              '[40.0, 28.0]',
                              '[36.0, 75.0]',
                              '[76.0, 55.0]',
                              '[72.0, 146.0]',
                              '[142.0, 110.0]',
                              '[192.0, 243.0]',
                              '[459.0, 401.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'input_size': [512, 512, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.1,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 2.0,
                                    'aug_scale_min': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 2.0,
                                         'aug_scale_min': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0515 06:32:36.385186 140269323401024 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/params.yaml
I0515 06:32:37.217569 140269323401024 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 06:32:37.832687 140269323401024 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0515 06:32:37.832965 140269323401024 transport.py:157] Attempting refresh to obtain initial access_token
I0515 06:32:37.884525 140269323401024 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 06:32:38.499303 140269323401024 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0515 06:32:38.499548 140269323401024 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-15 06:32:38.552042: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0515 06:32:38.552646 140269323401024 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 06:32:38.690175 140269323401024 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0515 06:32:38.690417 140269323401024 transport.py:157] Attempting refresh to obtain initial access_token
I0515 06:32:38.736675 140269323401024 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 06:32:39.351444 140269323401024 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0515 06:32:39.351736 140269323401024 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-15 06:32:39.395202: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-15 06:32:39.405945: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.117.66.218:8470}
2021-05-15 06:32:39.406021: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:36979}
2021-05-15 06:33:17.749395: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.117.66.218:8470}
2021-05-15 06:33:17.749519: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:36979}
2021-05-15 06:33:17.750058: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:36979
I0515 06:33:17.752515 140269323401024 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-4
I0515 06:33:17.753286 140269323401024 tpu_strategy_util.py:74] Initializing the TPU system: node-4
INFO:tensorflow:Clearing out eager caches
I0515 06:33:25.746024 140269323401024 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0515 06:33:25.748195 140269323401024 tpu_strategy_util.py:133] Finished initializing TPU system.
I0515 06:33:25.749566 140269323401024 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 06:33:25.891431 140269323401024 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0515 06:33:25.891675 140269323401024 transport.py:157] Attempting refresh to obtain initial access_token
I0515 06:33:25.937848 140269323401024 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0515 06:33:26.553760 140269323401024 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0515 06:33:26.553997 140269323401024 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0515 06:33:26.604259 140269323401024 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0515 06:33:26.604888 140269323401024 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0515 06:33:26.605455 140269323401024 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0515 06:33:26.605661 140269323401024 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0515 06:33:26.605857 140269323401024 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0515 06:33:26.606158 140269323401024 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0515 06:33:26.606280 140269323401024 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0515 06:33:26.606383 140269323401024 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0515 06:33:26.606477 140269323401024 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0515 06:33:26.606566 140269323401024 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0515 06:33:26.606658 140269323401024 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0515 06:33:26.606770 140269323401024 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0515 06:33:26.606866 140269323401024 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0515 06:33:26.606958 140269323401024 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0515 06:33:26.607047 140269323401024 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0515 06:33:26.607156 140269323401024 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0515 06:33:26.608636 140269323401024 train_utils.py:214] Running default trainer.
2021-05-15 06:33:26.629307: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, 'input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
heheheeheheheheheheheh:  [[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, 'input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f92985eceb8>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'5': (None, 16, 16, 57800704    input_2[0][0]                    
                                                                 input_3[0][0]                    
                                                                 input_4[0][0]                    
==================================================================================================I0515 06:34:10.458337 140269323401024 controller.py:362] restoring or initializing model...
I0515 06:34:20.946779 140269323401024 yolo.py:537] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0515 06:34:20.949125 140269323401024 controller.py:368] initialized model.
I0515 06:34:20.949553 140269323401024 train_lib.py:96] Starts to execute mode: train_and_eval
I0515 06:34:20.955219 140269323401024 controller.py:211] train | step:      0 | training until step 20000...
I0515 06:34:28.594506 140269323401024 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0515 06:35:09.581381 140269323401024 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0515 08:22:00.018594 140269323401024 controller.py:425] train | step:  10000 | steps/sec:    1.5 | output: 
    {'3': {'avg_iou': 0.44568193,
           'avg_obj': 0.10082123,
           'box_loss': 0.022116985,
           'class_loss': 0.04781383,
           'conf_loss': 0.1919361,
           'precision50': 0.13909495,
           'recall50': 0.037455346},
     '4': {'avg_iou': 0.52914387,
           'avg_obj': 0.16621163,
           'box_loss': 0.02152697,
           'class_loss': 0.04910469,
           'conf_loss': 0.061320465,
           'precision50': 0.31954837,
           'recall50': 0.0812665},
     '5': {'avg_iou': 0.5433076,
           'avg_obj': 0.22087526,
           'box_loss': 0.021346176,
           'class_loss': 0.04445788,
           'conf_loss': 0.033739395,
           'precision50': 0.40435815,
           'recall50': 0.1349001},
     'global': {'total_loss': 3.9469132},
     'learning_rate': 0.009985589,
     'training_loss': 3.9469132}
I0515 08:23:03.331046 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-10000.
I0515 10:01:00.016780 140269323401024 controller.py:425] train | step:  20000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.55618083,
           'avg_obj': 0.15043285,
           'box_loss': 0.017239183,
           'class_loss': 0.008738928,
           'conf_loss': 0.0250562,
           'precision50': 0.33736205,
           'recall50': 0.06266606},
     '4': {'avg_iou': 0.66326594,
           'avg_obj': 0.25813803,
           'box_loss': 0.015018014,
           'class_loss': 0.007819983,
           'conf_loss': 0.023222426,
           'precision50': 0.5761128,
           'recall50': 0.18745865},
     '5': {'avg_iou': 0.6998517,
           'avg_obj': 0.33900857,
           'box_loss': 0.013682743,
           'class_loss': 0.006963617,
           'conf_loss': 0.01721008,
           'precision50': 0.6713019,
           'recall50': 0.3049999},
     'global': {'total_loss': 1.0796106},
     'learning_rate': 0.009942464,
     'training_loss': 1.0796106}
I0515 10:01:57.481320 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-20000.
I0515 10:01:57.487173 140269323401024 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0515 10:01:58.084403 140269323401024 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0515 10:02:13.376553 140269323401024 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0515 10:07:04.094034 140269323401024 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0515 10:11:04.373024 140269323401024 controller.py:261]  eval | step:  20000 | eval time:  546.9 sec | output: 
    {'3': {'avg_iou': 0.45333666,
           'avg_obj': 0.13930468,
           'box_loss': 0.011628409,
           'class_loss': 0.004258355,
           'conf_loss': 0.018329134,
           'precision50': 0.31737417,
           'recall50': 0.09647212},
     '4': {'avg_iou': 0.6590743,
           'avg_obj': 0.2862114,
           'box_loss': 0.0116584,
           'class_loss': 0.004106511,
           'conf_loss': 0.016741855,
           'precision50': 0.57876116,
           'recall50': 0.25992313},
     '5': {'avg_iou': 0.7271703,
           'avg_obj': 0.39818016,
           'box_loss': 0.010991694,
           'class_loss': 0.003931974,
           'conf_loss': 0.013415284,
           'precision50': 0.715719,
           'recall50': 0.40651208},
     'AP': 0.27402857,
     'AP50': 0.4788657,
     'AP75': 0.27803072,
     'APl': 0.40040407,
     'APm': 0.27957895,
     'APs': 0.0910912,
     'ARl': 0.5951307,
     'ARm': 0.48825407,
     'ARmax1': 0.24816434,
     'ARmax10': 0.40836352,
     'ARmax100': 0.4520885,
     'ARs': 0.22545025,
     'global': {'total_loss': 0.0950616},
     'validation_loss': 0.0950616}
I0515 10:11:27.271508 140269323401024 controller.py:211] train | step:  20000 | training until step 40000...
I0515 11:49:41.584850 140269323401024 controller.py:425] train | step:  30000 | steps/sec:    1.5 | output: 
    {'3': {'avg_iou': 0.5783847,
           'avg_obj': 0.17677303,
           'box_loss': 0.016348287,
           'class_loss': 0.0076083145,
           'conf_loss': 0.024479084,
           'precision50': 0.38994744,
           'recall50': 0.08625172},
     '4': {'avg_iou': 0.6897525,
           'avg_obj': 0.2955768,
           'box_loss': 0.013770651,
           'class_loss': 0.006594986,
           'conf_loss': 0.022434138,
           'precision50': 0.6157034,
           'recall50': 0.23738332},
     '5': {'avg_iou': 0.7287758,
           'avg_obj': 0.38228324,
           'box_loss': 0.01228726,
           'class_loss': 0.0058556013,
           'conf_loss': 0.01649374,
           'precision50': 0.7047945,
           'recall50': 0.3695282},
     'global': {'total_loss': 1.0069761},
     'learning_rate': 0.0098709315,
     'training_loss': 1.0069761}

Total params: 57,800,704
Trainable params: 57,768,960
Non-trainable params: 31,744
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'5': (None, 16, 16, 2048 57800704  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  1033056   
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 85,486,272
Trainable params: 85,419,200
Non-trainable params: 67,072
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 400, 8), 5: (8, 200, 8)}, inds: {3: (8, 600, 3), 4: (8, 400, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
train | step:  10000 | steps/sec:    1.5 | output: 
    {'3': {'avg_iou': 0.44568193,
           'avg_obj': 0.10082123,
           'box_loss': 0.022116985,
           'class_loss': 0.04781383,
           'conf_loss': 0.1919361,
           'precision50': 0.13909495,
           'recall50': 0.037455346},
     '4': {'avg_iou': 0.52914387,
           'avg_obj': 0.16621163,
           'box_loss': 0.02152697,
           'class_loss': 0.04910469,
           'conf_loss': 0.061320465,
           'precision50': 0.31954837,
           'recall50': 0.0812665},
     '5': {'avg_iou': 0.5433076,
           'avg_obj': 0.22087526,
           'box_loss': 0.021346176,
           'class_loss': 0.04445788,
           'conf_loss': 0.033739395,
           'precision50': 0.40435815,
           'recall50': 0.1349001},
     'global': {'total_loss': 3.9469132},
     'learning_rate': 0.009985589,
     'training_loss': 3.9469132}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-10000.
train | step:  20000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.55618083,
           'avg_obj': 0.15043285,
           'box_loss': 0.017239183,
           'class_loss': 0.008738928,
           'conf_loss': 0.0250562,
           'precision50': 0.33736205,
           'recall50': 0.06266606},
     '4': {'avg_iou': 0.66326594,
           'avg_obj': 0.25813803,
           'box_loss': 0.015018014,
           'class_loss': 0.007819983,
           'conf_loss': 0.023222426,
           'precision50': 0.5761128,
           'recall50': 0.18745865},
     '5': {'avg_iou': 0.6998517,
           'avg_obj': 0.33900857,
           'box_loss': 0.013682743,
           'class_loss': 0.006963617,
           'conf_loss': 0.01721008,
           'precision50': 0.6713019,
           'recall50': 0.3049999},
     'global': {'total_loss': 1.0796106},
     'learning_rate': 0.009942464,
     'training_loss': 1.0796106}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-20000.
 eval | step:  20000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=172.58s).
Accumulating evaluation results...
DONE (t=16.59s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.274
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.479
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.278
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.091
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.280
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.400
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.248
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.408
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.452
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.225
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.488
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.595
 eval | step:  20000 | eval time:  546.9 sec | output: 
    {'3': {'avg_iou': 0.45333666,
           'avg_obj': 0.13930468,
           'box_loss': 0.011628409,
           'class_loss': 0.004258355,
           'conf_loss': 0.018329134,
           'precision50': 0.31737417,
           'recall50': 0.09647212},
     '4': {'avg_iou': 0.6590743,
           'avg_obj': 0.2862114,
           'box_loss': 0.0116584,
           'class_loss': 0.004106511,
           'conf_loss': 0.016741855,
           'precision50': 0.57876116,
           'recall50': 0.25992313},
     '5': {'avg_iou': 0.7271703,
           'avg_obj': 0.39818016,
           'box_loss': 0.010991694,
           'class_loss': 0.003931974,
           'conf_loss': 0.013415284,
           'precision50': 0.715719,
           'recall50': 0.40651208},
     'AP': 0.27402857,
     'AP50': 0.4788657,
     'AP75': 0.27803072,
     'APl': 0.40040407,
     'APm': 0.27957895,
     'APs': 0.0910912,
     'ARl': 0.5951307,
     'ARm': 0.48825407,
     'ARmax1': 0.24816434,
     'ARmax10': 0.40836352,
     'ARmax100': 0.4520885,
     'ARs': 0.22545025,
     'global': {'total_loss': 0.0950616},
     'validation_loss': 0.0950616}
train | step:  20000 | training until step 40000...
train | step:  30000 | steps/sec:    1.5 | output: 
    {'3': {'avg_iou': 0.5783847,
           'avg_obj': 0.17677303,
           'box_loss': 0.016348287,
           'class_loss': 0.0076083145,
           'conf_loss': 0.024479084,
           'precision50': 0.38994744,
           'recall50': 0.08625172},
     '4': {'avg_iou': 0.6897525,
           'avg_obj': 0.2955768,
           'box_loss': 0.013770651,
           'class_loss': 0.006594986,
           'conf_loss': 0.022434138,
           'precision50': 0.6157034,
           'recall50': 0.23738332},
     '5': {'avg_iou': 0.7287758,
           'avg_obj': 0.38228324,
           'box_loss': 0.01228726,
           'class_loss': 0.0058556013,
           'conf_loss': 0.01649374,
           'precision50': 0.7047945,
           'recall50': 0.3695282},
     'global': {'total_loss': 1.0069761},
     'learning_rate': 0.0098709315,
     'training_loss': 1.0069761}I0515 11:50:38.292493 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-30000.
I0515 13:27:26.555990 140269323401024 controller.py:425] train | step:  40000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5907163,
           'avg_obj': 0.19297422,
           'box_loss': 0.015827771,
           'class_loss': 0.0069805556,
           'conf_loss': 0.02399029,
           'precision50': 0.4139806,
           'recall50': 0.101316266},
     '4': {'avg_iou': 0.70374227,
           'avg_obj': 0.31682017,
           'box_loss': 0.013103707,
           'class_loss': 0.0059463037,
           'conf_loss': 0.021887477,
           'precision50': 0.6339135,
           'recall50': 0.2654304},
     '5': {'avg_iou': 0.7435685,
           'avg_obj': 0.4068161,
           'box_loss': 0.011571277,
           'class_loss': 0.0052809706,
           'conf_loss': 0.016011562,
           'precision50': 0.7191217,
           'recall50': 0.4034256},
     'global': {'total_loss': 0.9647988},
     'learning_rate': 0.00977151,
     'training_loss': 0.9647988}
I0515 13:28:22.306957 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-40000.
I0515 13:28:22.323500 140269323401024 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0515 13:32:20.131555 140269323401024 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0515 13:36:13.415010 140269323401024 controller.py:261]  eval | step:  40000 | eval time:  471.1 sec | output: 
    {'3': {'avg_iou': 0.46983945,
           'avg_obj': 0.16587901,
           'box_loss': 0.010794303,
           'class_loss': 0.0034822389,
           'conf_loss': 0.01776096,
           'precision50': 0.36368543,
           'recall50': 0.13044944},
     '4': {'avg_iou': 0.6796941,
           'avg_obj': 0.33268085,
           'box_loss': 0.01061403,
           'class_loss': 0.0033398273,
           'conf_loss': 0.015989317,
           'precision50': 0.6171184,
           'recall50': 0.327224},
     '5': {'avg_iou': 0.7497452,
           'avg_obj': 0.45031816,
           'box_loss': 0.0098481625,
           'class_loss': 0.0032970756,
           'conf_loss': 0.012668063,
           'precision50': 0.7420645,
           'recall50': 0.48246354},
     'AP': 0.32448578,
     'AP50': 0.536515,
     'AP75': 0.33833143,
     'APl': 0.46707934,
     'APm': 0.33264235,
     'APs': 0.122135535,
     'ARl': 0.63475704,
     'ARm': 0.53743654,
     'ARmax1': 0.2803208,
     'ARmax10': 0.45189762,
     'ARmax100': 0.49667242,
     'ARs': 0.27159178,
     'global': {'total_loss': 0.08779399},
     'validation_loss': 0.08779399}
I0515 13:36:29.737058 140269323401024 controller.py:211] train | step:  40000 | training until step 60000...
I0515 15:11:44.159161 140269323401024 controller.py:425] train | step:  50000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.59966785,
           'avg_obj': 0.20513006,
           'box_loss': 0.015460959,
           'class_loss': 0.006576263,
           'conf_loss': 0.023689682,
           'precision50': 0.4316839,
           'recall50': 0.11303686},
     '4': {'avg_iou': 0.713173,
           'avg_obj': 0.33199823,
           'box_loss': 0.012665945,
           'class_loss': 0.005519053,
           'conf_loss': 0.021512484,
           'precision50': 0.6450204,
           'recall50': 0.28501442},
     '5': {'avg_iou': 0.7532936,
           'avg_obj': 0.4231865,
           'box_loss': 0.011114927,
           'class_loss': 0.0048938105,
           'conf_loss': 0.015682781,
           'precision50': 0.72804934,
           'recall50': 0.42613408},
     'global': {'total_loss': 0.93692833},
     'learning_rate': 0.0096449135,
     'training_loss': 0.93692833}
I0515 15:12:40.410369 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-50000.
I0515 16:49:43.643725 140269323401024 controller.py:425] train | step:  60000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6062547,
           'avg_obj': 0.21495874,
           'box_loss': 0.015192347,
           'class_loss': 0.0062707136,
           'conf_loss': 0.023438986,
           'precision50': 0.44449297,
           'recall50': 0.12270784},
     '4': {'avg_iou': 0.7203499,
           'avg_obj': 0.34445006,
           'box_loss': 0.012329757,
           'class_loss': 0.0052099386,
           'conf_loss': 0.021197384,
           'precision50': 0.6540982,
           'recall50': 0.30108178},
     '5': {'avg_iou': 0.7607393,
           'avg_obj': 0.43664843,
           'box_loss': 0.0107535245,
           'class_loss': 0.0046157124,
           'conf_loss': 0.015416014,
           'precision50': 0.7344212,
           'recall50': 0.44370326},
     'global': {'total_loss': 0.9153963},
     'learning_rate': 0.009492056,
     'training_loss': 0.9153963}
I0515 16:50:41.017078 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-60000.
I0515 16:50:41.022611 140269323401024 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0515 16:54:43.506605 140269323401024 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0515 16:58:45.182735 140269323401024 controller.py:261]  eval | step:  60000 | eval time:  484.2 sec | output: 
    {'3': {'avg_iou': 0.47776982,
           'avg_obj': 0.17927697,
           'box_loss': 0.010394083,
           'class_loss': 0.0032175705,
           'conf_loss': 0.017489854,
           'precision50': 0.378998,
           'recall50': 0.14854796},
     '4': {'avg_iou': 0.68940616,
           'avg_obj': 0.354573,
           'box_loss': 0.010121681,
           'class_loss': 0.0030537294,
           'conf_loss': 0.015684985,
           'precision50': 0.63574475,
           'recall50': 0.35944396},
     '5': {'avg_iou': 0.75931716,
           'avg_obj': 0.47420004,
           'box_loss': 0.009364518,
           'class_loss': 0.0030454835,
           'conf_loss': 0.012369502,
           'precision50': 0.74946916,
           'recall50': 0.5155158},
     'AP': 0.34814015,
     'AP50': 0.5648671,
     'AP75': 0.36656356,
     'APl': 0.4959895,
     'APm': 0.35683692,
     'APs': 0.14134026,
     'ARl': 0.6594239,
     'ARm': 0.5565301,
     'ARmax1': 0.2927821,
     'ARmax10': 0.4738823,
     'ARmax100': 0.5188957,
     'ARs': 0.2981364,
     'global': {'total_loss': 0.0847414},
     'validation_loss': 0.0847414}
I0515 16:59:01.485364 140269323401024 controller.py:211] train | step:  60000 | training until step 80000...
I0515 18:30:22.362109 140269323401024 controller.py:425] train | step:  70000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6115385,
           'avg_obj': 0.22309856,
           'box_loss': 0.0149570145,
           'class_loss': 0.0060041132,
           'conf_loss': 0.023101728,
           'precision50': 0.45397046,
           'recall50': 0.13051757},
     '4': {'avg_iou': 0.72616714,
           'avg_obj': 0.35423368,
           'box_loss': 0.012047428,
           'class_loss': 0.004956749,
           'conf_loss': 0.020882262,
           'precision50': 0.6610113,
           'recall50': 0.31379282},
     '5': {'avg_iou': 0.7668839,
           'avg_obj': 0.44757614,
           'box_loss': 0.010442686,
           'class_loss': 0.004380962,
           'conf_loss': 0.015200563,
           'precision50': 0.7393714,
           'recall50': 0.45777982},
     'global': {'total_loss': 0.89578897},
     'learning_rate': 0.009314038,
     'training_loss': 0.89578897}

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-30000.
train | step:  40000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5907163,
           'avg_obj': 0.19297422,
           'box_loss': 0.015827771,
           'class_loss': 0.0069805556,
           'conf_loss': 0.02399029,
           'precision50': 0.4139806,
           'recall50': 0.101316266},
     '4': {'avg_iou': 0.70374227,
           'avg_obj': 0.31682017,
           'box_loss': 0.013103707,
           'class_loss': 0.0059463037,
           'conf_loss': 0.021887477,
           'precision50': 0.6339135,
           'recall50': 0.2654304},
     '5': {'avg_iou': 0.7435685,
           'avg_obj': 0.4068161,
           'box_loss': 0.011571277,
           'class_loss': 0.0052809706,
           'conf_loss': 0.016011562,
           'precision50': 0.7191217,
           'recall50': 0.4034256},
     'global': {'total_loss': 0.9647988},
     'learning_rate': 0.00977151,
     'training_loss': 0.9647988}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-40000.
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=170.07s).
Accumulating evaluation results...
DONE (t=14.13s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.324
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.537
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.338
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.122
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.333
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.467
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.280
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.452
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.497
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.272
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.537
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.635
 eval | step:  40000 | eval time:  471.1 sec | output: 
    {'3': {'avg_iou': 0.46983945,
           'avg_obj': 0.16587901,
           'box_loss': 0.010794303,
           'class_loss': 0.0034822389,
           'conf_loss': 0.01776096,
           'precision50': 0.36368543,
           'recall50': 0.13044944},
     '4': {'avg_iou': 0.6796941,
           'avg_obj': 0.33268085,
           'box_loss': 0.01061403,
           'class_loss': 0.0033398273,
           'conf_loss': 0.015989317,
           'precision50': 0.6171184,
           'recall50': 0.327224},
     '5': {'avg_iou': 0.7497452,
           'avg_obj': 0.45031816,
           'box_loss': 0.0098481625,
           'class_loss': 0.0032970756,
           'conf_loss': 0.012668063,
           'precision50': 0.7420645,
           'recall50': 0.48246354},
     'AP': 0.32448578,
     'AP50': 0.536515,
     'AP75': 0.33833143,
     'APl': 0.46707934,
     'APm': 0.33264235,
     'APs': 0.122135535,
     'ARl': 0.63475704,
     'ARm': 0.53743654,
     'ARmax1': 0.2803208,
     'ARmax10': 0.45189762,
     'ARmax100': 0.49667242,
     'ARs': 0.27159178,
     'global': {'total_loss': 0.08779399},
     'validation_loss': 0.08779399}
train | step:  40000 | training until step 60000...
train | step:  50000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.59966785,
           'avg_obj': 0.20513006,
           'box_loss': 0.015460959,
           'class_loss': 0.006576263,
           'conf_loss': 0.023689682,
           'precision50': 0.4316839,
           'recall50': 0.11303686},
     '4': {'avg_iou': 0.713173,
           'avg_obj': 0.33199823,
           'box_loss': 0.012665945,
           'class_loss': 0.005519053,
           'conf_loss': 0.021512484,
           'precision50': 0.6450204,
           'recall50': 0.28501442},
     '5': {'avg_iou': 0.7532936,
           'avg_obj': 0.4231865,
           'box_loss': 0.011114927,
           'class_loss': 0.0048938105,
           'conf_loss': 0.015682781,
           'precision50': 0.72804934,
           'recall50': 0.42613408},
     'global': {'total_loss': 0.93692833},
     'learning_rate': 0.0096449135,
     'training_loss': 0.93692833}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-50000.
train | step:  60000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6062547,
           'avg_obj': 0.21495874,
           'box_loss': 0.015192347,
           'class_loss': 0.0062707136,
           'conf_loss': 0.023438986,
           'precision50': 0.44449297,
           'recall50': 0.12270784},
     '4': {'avg_iou': 0.7203499,
           'avg_obj': 0.34445006,
           'box_loss': 0.012329757,
           'class_loss': 0.0052099386,
           'conf_loss': 0.021197384,
           'precision50': 0.6540982,
           'recall50': 0.30108178},
     '5': {'avg_iou': 0.7607393,
           'avg_obj': 0.43664843,
           'box_loss': 0.0107535245,
           'class_loss': 0.0046157124,
           'conf_loss': 0.015416014,
           'precision50': 0.7344212,
           'recall50': 0.44370326},
     'global': {'total_loss': 0.9153963},
     'learning_rate': 0.009492056,
     'training_loss': 0.9153963}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-60000.
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=173.77s).
Accumulating evaluation results...
DONE (t=14.10s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.348
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.565
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.367
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.141
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.357
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.496
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.293
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.474
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.519
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.298
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.557
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.659
 eval | step:  60000 | eval time:  484.2 sec | output: 
    {'3': {'avg_iou': 0.47776982,
           'avg_obj': 0.17927697,
           'box_loss': 0.010394083,
           'class_loss': 0.0032175705,
           'conf_loss': 0.017489854,
           'precision50': 0.378998,
           'recall50': 0.14854796},
     '4': {'avg_iou': 0.68940616,
           'avg_obj': 0.354573,
           'box_loss': 0.010121681,
           'class_loss': 0.0030537294,
           'conf_loss': 0.015684985,
           'precision50': 0.63574475,
           'recall50': 0.35944396},
     '5': {'avg_iou': 0.75931716,
           'avg_obj': 0.47420004,
           'box_loss': 0.009364518,
           'class_loss': 0.0030454835,
           'conf_loss': 0.012369502,
           'precision50': 0.74946916,
           'recall50': 0.5155158},
     'AP': 0.34814015,
     'AP50': 0.5648671,
     'AP75': 0.36656356,
     'APl': 0.4959895,
     'APm': 0.35683692,
     'APs': 0.14134026,
     'ARl': 0.6594239,
     'ARm': 0.5565301,
     'ARmax1': 0.2927821,
     'ARmax10': 0.4738823,
     'ARmax100': 0.5188957,
     'ARs': 0.2981364,
     'global': {'total_loss': 0.0847414},
     'validation_loss': 0.0847414}
train | step:  60000 | training until step 80000...
train | step:  70000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6115385,
           'avg_obj': 0.22309856,
           'box_loss': 0.0149570145,
           'class_loss': 0.0060041132,
           'conf_loss': 0.023101728,
           'precision50': 0.45397046,
           'recall50': 0.13051757},
     '4': {'avg_iou': 0.72616714,
           'avg_obj': 0.35423368,
           'box_loss': 0.012047428,
           'class_loss': 0.004956749,
           'conf_loss': 0.020882262,
           'precision50': 0.6610113,
           'recall50': 0.31379282},
     '5': {'avg_iou': 0.7668839,
           'avg_obj': 0.44757614,
           'box_loss': 0.010442686,
           'class_loss': 0.004380962,
           'conf_loss': 0.015200563,
           'precision50': 0.7393714,
           'recall50': 0.45777982},
     'global': {'total_loss': 0.89578897},
     'learning_rate': 0.009314038,
     'training_loss': 0.89578897}I0515 18:31:21.260015 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-70000.
I0515 20:04:56.953923 140269323401024 controller.py:425] train | step:  80000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.61617213,
           'avg_obj': 0.23030216,
           'box_loss': 0.01479777,
           'class_loss': 0.0057858173,
           'conf_loss': 0.022964688,
           'precision50': 0.46266598,
           'recall50': 0.13753854},
     '4': {'avg_iou': 0.7311388,
           'avg_obj': 0.3635013,
           'box_loss': 0.011821492,
           'class_loss': 0.004729932,
           'conf_loss': 0.020669714,
           'precision50': 0.66657025,
           'recall50': 0.32517812},
     '5': {'avg_iou': 0.7718965,
           'avg_obj': 0.4575046,
           'box_loss': 0.010211672,
           'class_loss': 0.0042020017,
           'conf_loss': 0.014979033,
           'precision50': 0.7442264,
           'recall50': 0.47015765},
     'global': {'total_loss': 0.8812973},
     'learning_rate': 0.009112143,
     'training_loss': 0.8812973}
I0515 20:05:55.322292 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-80000.
I0515 20:05:55.329165 140269323401024 controller.py:252]  eval | step:  80000 | running 625 steps of evaluation...
I0515 20:10:00.799094 140269323401024 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0515 20:13:52.610913 140269323401024 controller.py:261]  eval | step:  80000 | eval time:  477.3 sec | output: 
    {'3': {'avg_iou': 0.48295152,
           'avg_obj': 0.18859573,
           'box_loss': 0.010133148,
           'class_loss': 0.0030522845,
           'conf_loss': 0.017376903,
           'precision50': 0.39327136,
           'recall50': 0.16110611},
     '4': {'avg_iou': 0.6947438,
           'avg_obj': 0.3694832,
           'box_loss': 0.009853322,
           'class_loss': 0.0029711467,
           'conf_loss': 0.015525934,
           'precision50': 0.64248013,
           'recall50': 0.38053387},
     '5': {'avg_iou': 0.7647494,
           'avg_obj': 0.48872057,
           'box_loss': 0.0090902215,
           'class_loss': 0.002959684,
           'conf_loss': 0.0122439,
           'precision50': 0.7489663,
           'recall50': 0.5343073},
     'AP': 0.36369634,
     'AP50': 0.5805488,
     'AP75': 0.3837285,
     'APl': 0.51126426,
     'APm': 0.37418884,
     'APs': 0.1530342,
     'ARl': 0.6659166,
     'ARm': 0.5653072,
     'ARmax1': 0.30051094,
     'ARmax10': 0.48377296,
     'ARmax100': 0.5275811,
     'ARs': 0.30904683,
     'global': {'total_loss': 0.08320657},
     'validation_loss': 0.08320657}
I0515 20:14:16.484875 140269323401024 controller.py:211] train | step:  80000 | training until step 100000...
I0515 21:48:49.934880 140269323401024 controller.py:425] train | step:  90000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.61985505,
           'avg_obj': 0.23650347,
           'box_loss': 0.014625447,
           'class_loss': 0.0056160907,
           'conf_loss': 0.022793667,
           'precision50': 0.47052017,
           'recall50': 0.14407255},
     '4': {'avg_iou': 0.73510754,
           'avg_obj': 0.37120467,
           'box_loss': 0.011622706,
           'class_loss': 0.0045751715,
           'conf_loss': 0.020459129,
           'precision50': 0.67175317,
           'recall50': 0.3350823},
     '5': {'avg_iou': 0.77606404,
           'avg_obj': 0.46549493,
           'box_loss': 0.010010725,
           'class_loss': 0.004043807,
           'conf_loss': 0.014803041,
           'precision50': 0.7480703,
           'recall50': 0.48055375},
     'global': {'total_loss': 0.86839885},
     'learning_rate': 0.008887824,
     'training_loss': 0.86839885}
I0515 21:49:47.636981 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-90000.
I0515 23:24:35.695226 140269323401024 controller.py:425] train | step:  100000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.62355906,
           'avg_obj': 0.24234805,
           'box_loss': 0.014490036,
           'class_loss': 0.0054505304,
           'conf_loss': 0.022601448,
           'precision50': 0.4770625,
           'recall50': 0.15004103},
     '4': {'avg_iou': 0.73900527,
           'avg_obj': 0.37864432,
           'box_loss': 0.011444761,
           'class_loss': 0.004406453,
           'conf_loss': 0.02025743,
           'precision50': 0.6766283,
           'recall50': 0.34441024},
     '5': {'avg_iou': 0.7798185,
           'avg_obj': 0.47312665,
           'box_loss': 0.009833032,
           'class_loss': 0.0039036525,
           'conf_loss': 0.014655594,
           'precision50': 0.7516067,
           'recall50': 0.49025956},
     'global': {'total_loss': 0.856343},
     'learning_rate': 0.008642699,
     'training_loss': 0.856343}
I0515 23:25:34.259649 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-100000.
I0515 23:25:34.266952 140269323401024 controller.py:252]  eval | step:  100000 | running 625 steps of evaluation...
I0515 23:29:36.194272 140269323401024 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0515 23:33:41.018100 140269323401024 controller.py:261]  eval | step:  100000 | eval time:  486.8 sec | output: 
    {'3': {'avg_iou': 0.4858273,
           'avg_obj': 0.19378595,
           'box_loss': 0.0099906,
           'class_loss': 0.002983384,
           'conf_loss': 0.01733973,
           'precision50': 0.39783412,
           'recall50': 0.16924775},
     '4': {'avg_iou': 0.69813836,
           'avg_obj': 0.37767348,
           'box_loss': 0.00968189,
           'class_loss': 0.0028834506,
           'conf_loss': 0.015478084,
           'precision50': 0.6422647,
           'recall50': 0.3901761},
     '5': {'avg_iou': 0.768127,
           'avg_obj': 0.49907374,
           'box_loss': 0.00892076,
           'class_loss': 0.0029005276,
           'conf_loss': 0.01216012,
           'precision50': 0.7493574,
           'recall50': 0.5463036},
     'AP': 0.370833,
     'AP50': 0.5873245,
     'AP75': 0.3942403,
     'APl': 0.5221373,
     'APm': 0.3824467,
     'APs': 0.16199273,
     'ARl': 0.67314667,
     'ARm': 0.57499516,
     'ARmax1': 0.30523914,
     'ARmax10': 0.49019957,
     'ARmax100': 0.53568435,
     'ARs': 0.31619588,
     'global': {'total_loss': 0.082338534},
     'validation_loss': 0.082338534}
I0515 23:33:57.696873 140269323401024 controller.py:211] train | step:  100000 | training until step 120000...
I0516 01:04:01.904181 140269323401024 controller.py:425] train | step:  110000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6264075,
           'avg_obj': 0.24759114,
           'box_loss': 0.014366821,
           'class_loss': 0.005310651,
           'conf_loss': 0.022453431,
           'precision50': 0.4825688,
           'recall50': 0.15542068},
     '4': {'avg_iou': 0.7423266,
           'avg_obj': 0.38520712,
           'box_loss': 0.011300461,
           'class_loss': 0.0042811395,
           'conf_loss': 0.020065574,
           'precision50': 0.6811232,
           'recall50': 0.35316637},
     '5': {'avg_iou': 0.78333634,
           'avg_obj': 0.48001796,
           'box_loss': 0.009666388,
           'class_loss': 0.0037921688,
           'conf_loss': 0.014503018,
           'precision50': 0.75462633,
           'recall50': 0.4984273},
     'global': {'total_loss': 0.84591746},
     'learning_rate': 0.008378533,
     'training_loss': 0.84591746}

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-70000.
train | step:  80000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.61617213,
           'avg_obj': 0.23030216,
           'box_loss': 0.01479777,
           'class_loss': 0.0057858173,
           'conf_loss': 0.022964688,
           'precision50': 0.46266598,
           'recall50': 0.13753854},
     '4': {'avg_iou': 0.7311388,
           'avg_obj': 0.3635013,
           'box_loss': 0.011821492,
           'class_loss': 0.004729932,
           'conf_loss': 0.020669714,
           'precision50': 0.66657025,
           'recall50': 0.32517812},
     '5': {'avg_iou': 0.7718965,
           'avg_obj': 0.4575046,
           'box_loss': 0.010211672,
           'class_loss': 0.0042020017,
           'conf_loss': 0.014979033,
           'precision50': 0.7442264,
           'recall50': 0.47015765},
     'global': {'total_loss': 0.8812973},
     'learning_rate': 0.009112143,
     'training_loss': 0.8812973}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-80000.
 eval | step:  80000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=172.19s).
Accumulating evaluation results...
DONE (t=12.93s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.364
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.581
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.384
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.153
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.374
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.511
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.301
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.484
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.528
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.309
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.565
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.666
 eval | step:  80000 | eval time:  477.3 sec | output: 
    {'3': {'avg_iou': 0.48295152,
           'avg_obj': 0.18859573,
           'box_loss': 0.010133148,
           'class_loss': 0.0030522845,
           'conf_loss': 0.017376903,
           'precision50': 0.39327136,
           'recall50': 0.16110611},
     '4': {'avg_iou': 0.6947438,
           'avg_obj': 0.3694832,
           'box_loss': 0.009853322,
           'class_loss': 0.0029711467,
           'conf_loss': 0.015525934,
           'precision50': 0.64248013,
           'recall50': 0.38053387},
     '5': {'avg_iou': 0.7647494,
           'avg_obj': 0.48872057,
           'box_loss': 0.0090902215,
           'class_loss': 0.002959684,
           'conf_loss': 0.0122439,
           'precision50': 0.7489663,
           'recall50': 0.5343073},
     'AP': 0.36369634,
     'AP50': 0.5805488,
     'AP75': 0.3837285,
     'APl': 0.51126426,
     'APm': 0.37418884,
     'APs': 0.1530342,
     'ARl': 0.6659166,
     'ARm': 0.5653072,
     'ARmax1': 0.30051094,
     'ARmax10': 0.48377296,
     'ARmax100': 0.5275811,
     'ARs': 0.30904683,
     'global': {'total_loss': 0.08320657},
     'validation_loss': 0.08320657}
train | step:  80000 | training until step 100000...
train | step:  90000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.61985505,
           'avg_obj': 0.23650347,
           'box_loss': 0.014625447,
           'class_loss': 0.0056160907,
           'conf_loss': 0.022793667,
           'precision50': 0.47052017,
           'recall50': 0.14407255},
     '4': {'avg_iou': 0.73510754,
           'avg_obj': 0.37120467,
           'box_loss': 0.011622706,
           'class_loss': 0.0045751715,
           'conf_loss': 0.020459129,
           'precision50': 0.67175317,
           'recall50': 0.3350823},
     '5': {'avg_iou': 0.77606404,
           'avg_obj': 0.46549493,
           'box_loss': 0.010010725,
           'class_loss': 0.004043807,
           'conf_loss': 0.014803041,
           'precision50': 0.7480703,
           'recall50': 0.48055375},
     'global': {'total_loss': 0.86839885},
     'learning_rate': 0.008887824,
     'training_loss': 0.86839885}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-90000.
train | step:  100000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.62355906,
           'avg_obj': 0.24234805,
           'box_loss': 0.014490036,
           'class_loss': 0.0054505304,
           'conf_loss': 0.022601448,
           'precision50': 0.4770625,
           'recall50': 0.15004103},
     '4': {'avg_iou': 0.73900527,
           'avg_obj': 0.37864432,
           'box_loss': 0.011444761,
           'class_loss': 0.004406453,
           'conf_loss': 0.02025743,
           'precision50': 0.6766283,
           'recall50': 0.34441024},
     '5': {'avg_iou': 0.7798185,
           'avg_obj': 0.47312665,
           'box_loss': 0.009833032,
           'class_loss': 0.0039036525,
           'conf_loss': 0.014655594,
           'precision50': 0.7516067,
           'recall50': 0.49025956},
     'global': {'total_loss': 0.856343},
     'learning_rate': 0.008642699,
     'training_loss': 0.856343}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-100000.
 eval | step:  100000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=177.37s).
Accumulating evaluation results...
DONE (t=13.20s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.371
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.587
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.394
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.162
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.382
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.522
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.305
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.490
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.536
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.316
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.575
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.673
 eval | step:  100000 | eval time:  486.8 sec | output: 
    {'3': {'avg_iou': 0.4858273,
           'avg_obj': 0.19378595,
           'box_loss': 0.0099906,
           'class_loss': 0.002983384,
           'conf_loss': 0.01733973,
           'precision50': 0.39783412,
           'recall50': 0.16924775},
     '4': {'avg_iou': 0.69813836,
           'avg_obj': 0.37767348,
           'box_loss': 0.00968189,
           'class_loss': 0.0028834506,
           'conf_loss': 0.015478084,
           'precision50': 0.6422647,
           'recall50': 0.3901761},
     '5': {'avg_iou': 0.768127,
           'avg_obj': 0.49907374,
           'box_loss': 0.00892076,
           'class_loss': 0.0029005276,
           'conf_loss': 0.01216012,
           'precision50': 0.7493574,
           'recall50': 0.5463036},
     'AP': 0.370833,
     'AP50': 0.5873245,
     'AP75': 0.3942403,
     'APl': 0.5221373,
     'APm': 0.3824467,
     'APs': 0.16199273,
     'ARl': 0.67314667,
     'ARm': 0.57499516,
     'ARmax1': 0.30523914,
     'ARmax10': 0.49019957,
     'ARmax100': 0.53568435,
     'ARs': 0.31619588,
     'global': {'total_loss': 0.082338534},
     'validation_loss': 0.082338534}
train | step:  100000 | training until step 120000...
train | step:  110000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6264075,
           'avg_obj': 0.24759114,
           'box_loss': 0.014366821,
           'class_loss': 0.005310651,
           'conf_loss': 0.022453431,
           'precision50': 0.4825688,
           'recall50': 0.15542068},
     '4': {'avg_iou': 0.7423266,
           'avg_obj': 0.38520712,
           'box_loss': 0.011300461,
           'class_loss': 0.0042811395,
           'conf_loss': 0.020065574,
           'precision50': 0.6811232,
           'recall50': 0.35316637},
     '5': {'avg_iou': 0.78333634,
           'avg_obj': 0.48001796,
           'box_loss': 0.009666388,
           'class_loss': 0.0037921688,
           'conf_loss': 0.014503018,
           'precision50': 0.75462633,
           'recall50': 0.4984273},
     'global': {'total_loss': 0.84591746},
     'learning_rate': 0.008378533,
     'training_loss': 0.84591746}I0516 01:05:02.074757 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-110000.
I0516 02:36:28.178194 140269323401024 controller.py:425] train | step:  120000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6291369,
           'avg_obj': 0.25226203,
           'box_loss': 0.0142632695,
           'class_loss': 0.0051992307,
           'conf_loss': 0.022307577,
           'precision50': 0.48765668,
           'recall50': 0.16018108},
     '4': {'avg_iou': 0.74516857,
           'avg_obj': 0.3911366,
           'box_loss': 0.01115729,
           'class_loss': 0.004159658,
           'conf_loss': 0.01990899,
           'precision50': 0.68463916,
           'recall50': 0.3601763},
     '5': {'avg_iou': 0.7863703,
           'avg_obj': 0.48667568,
           'box_loss': 0.009525742,
           'class_loss': 0.0036886695,
           'conf_loss': 0.014354135,
           'precision50': 0.7576367,
           'recall50': 0.5063569},
     'global': {'total_loss': 0.836516},
     'learning_rate': 0.008097229,
     'training_loss': 0.836516}
I0516 02:37:28.176905 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-120000.
I0516 02:37:28.182954 140269323401024 controller.py:252]  eval | step:  120000 | running 625 steps of evaluation...
I0516 02:41:32.406378 140269323401024 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0516 02:45:26.873581 140269323401024 controller.py:261]  eval | step:  120000 | eval time:  478.7 sec | output: 
    {'3': {'avg_iou': 0.48799863,
           'avg_obj': 0.19896546,
           'box_loss': 0.009877722,
           'class_loss': 0.0029298607,
           'conf_loss': 0.017349103,
           'precision50': 0.40016523,
           'recall50': 0.1762224},
     '4': {'avg_iou': 0.7006774,
           'avg_obj': 0.3859149,
           'box_loss': 0.00955347,
           'class_loss': 0.0028854383,
           'conf_loss': 0.015495418,
           'precision50': 0.64217246,
           'recall50': 0.40454078},
     '5': {'avg_iou': 0.7700687,
           'avg_obj': 0.5072211,
           'box_loss': 0.0088213915,
           'class_loss': 0.002905625,
           'conf_loss': 0.012173991,
           'precision50': 0.7483431,
           'recall50': 0.55618286},
     'AP': 0.37647894,
     'AP50': 0.5916727,
     'AP75': 0.3984878,
     'APl': 0.52725923,
     'APm': 0.38996795,
     'APs': 0.16374211,
     'ARl': 0.6797022,
     'ARm': 0.57435,
     'ARmax1': 0.30711943,
     'ARmax10': 0.49461418,
     'ARmax100': 0.5391301,
     'ARs': 0.32723978,
     'global': {'total_loss': 0.08199208},
     'validation_loss': 0.08199208}
I0516 02:45:43.013442 140269323401024 controller.py:211] train | step:  120000 | training until step 140000...
I0516 04:13:59.610380 140269323401024 controller.py:425] train | step:  130000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6317358,
           'avg_obj': 0.25740248,
           'box_loss': 0.014131553,
           'class_loss': 0.005055294,
           'conf_loss': 0.02210155,
           'precision50': 0.49238414,
           'recall50': 0.16534604},
     '4': {'avg_iou': 0.7481793,
           'avg_obj': 0.3975046,
           'box_loss': 0.011001414,
           'class_loss': 0.004022199,
           'conf_loss': 0.019664329,
           'precision50': 0.6881137,
           'recall50': 0.3681089},
     '5': {'avg_iou': 0.78925717,
           'avg_obj': 0.49328148,
           'box_loss': 0.009379964,
           'class_loss': 0.003571465,
           'conf_loss': 0.014160071,
           'precision50': 0.75973386,
           'recall50': 0.5141308},
     'global': {'total_loss': 0.82470155},
     'learning_rate': 0.007800815,
     'training_loss': 0.82470155}
I0516 04:14:58.407561 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-130000.
I0516 05:47:11.403814 140269323401024 controller.py:425] train | step:  140000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6340175,
           'avg_obj': 0.26165777,
           'box_loss': 0.014044958,
           'class_loss': 0.004964445,
           'conf_loss': 0.021958858,
           'precision50': 0.49746338,
           'recall50': 0.1696999},
     '4': {'avg_iou': 0.75086486,
           'avg_obj': 0.4028735,
           'box_loss': 0.010888487,
           'class_loss': 0.003942891,
           'conf_loss': 0.019532647,
           'precision50': 0.6915586,
           'recall50': 0.3745134},
     '5': {'avg_iou': 0.79191005,
           'avg_obj': 0.49850914,
           'box_loss': 0.0092567485,
           'class_loss': 0.003499044,
           'conf_loss': 0.014067416,
           'precision50': 0.7622727,
           'recall50': 0.5203179},
     'global': {'total_loss': 0.8172436},
     'learning_rate': 0.007491425,
     'training_loss': 0.8172436}
I0516 05:48:11.784336 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-140000.
I0516 05:48:11.790371 140269323401024 controller.py:252]  eval | step:  140000 | running 625 steps of evaluation...
I0516 05:52:19.248232 140269323401024 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0516 05:56:17.477368 140269323401024 controller.py:261]  eval | step:  140000 | eval time:  485.7 sec | output: 
    {'3': {'avg_iou': 0.489617,
           'avg_obj': 0.20289515,
           'box_loss': 0.009795982,
           'class_loss': 0.0029250588,
           'conf_loss': 0.01739112,
           'precision50': 0.40576982,
           'recall50': 0.18405491},
     '4': {'avg_iou': 0.7025023,
           'avg_obj': 0.3917324,
           'box_loss': 0.009460034,
           'class_loss': 0.0029122443,
           'conf_loss': 0.015573748,
           'precision50': 0.6441271,
           'recall50': 0.41312203},
     '5': {'avg_iou': 0.77134293,
           'avg_obj': 0.5130625,
           'box_loss': 0.008758705,
           'class_loss': 0.0029365774,
           'conf_loss': 0.012237288,
           'precision50': 0.747482,
           'recall50': 0.56312644},
     'AP': 0.37916836,
     'AP50': 0.592952,
     'AP75': 0.4044326,
     'APl': 0.53103286,
     'APm': 0.3938552,
     'APs': 0.16940205,
     'ARl': 0.67864704,
     'ARm': 0.57652014,
     'ARmax1': 0.3102422,
     'ARmax10': 0.4988438,
     'ARmax100': 0.54140294,
     'ARs': 0.33118063,
     'global': {'total_loss': 0.081990734},
     'validation_loss': 0.081990734}
I0516 05:56:38.385942 140269323401024 controller.py:211] train | step:  140000 | training until step 160000...
I0516 07:27:38.778183 140269323401024 controller.py:425] train | step:  150000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.636032,
           'avg_obj': 0.26589245,
           'box_loss': 0.01397499,
           'class_loss': 0.004878353,
           'conf_loss': 0.021886872,
           'precision50': 0.50157,
           'recall50': 0.17410725},
     '4': {'avg_iou': 0.75310993,
           'avg_obj': 0.4080488,
           'box_loss': 0.010788738,
           'class_loss': 0.003857956,
           'conf_loss': 0.019420557,
           'precision50': 0.6951689,
           'recall50': 0.38145736},
     '5': {'avg_iou': 0.7943293,
           'avg_obj': 0.5039335,
           'box_loss': 0.0091359485,
           'class_loss': 0.0034190346,
           'conf_loss': 0.013953378,
           'precision50': 0.7648237,
           'recall50': 0.52731144},
     'global': {'total_loss': 0.8105244},
     'learning_rate': 0.007171291,
     'training_loss': 0.8105244}

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-110000.
train | step:  120000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6291369,
           'avg_obj': 0.25226203,
           'box_loss': 0.0142632695,
           'class_loss': 0.0051992307,
           'conf_loss': 0.022307577,
           'precision50': 0.48765668,
           'recall50': 0.16018108},
     '4': {'avg_iou': 0.74516857,
           'avg_obj': 0.3911366,
           'box_loss': 0.01115729,
           'class_loss': 0.004159658,
           'conf_loss': 0.01990899,
           'precision50': 0.68463916,
           'recall50': 0.3601763},
     '5': {'avg_iou': 0.7863703,
           'avg_obj': 0.48667568,
           'box_loss': 0.009525742,
           'class_loss': 0.0036886695,
           'conf_loss': 0.014354135,
           'precision50': 0.7576367,
           'recall50': 0.5063569},
     'global': {'total_loss': 0.836516},
     'learning_rate': 0.008097229,
     'training_loss': 0.836516}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-120000.
 eval | step:  120000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=173.72s).
Accumulating evaluation results...
DONE (t=12.01s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.376
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.592
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.398
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.164
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.390
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.527
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.307
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.495
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.539
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.327
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.574
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.680
 eval | step:  120000 | eval time:  478.7 sec | output: 
    {'3': {'avg_iou': 0.48799863,
           'avg_obj': 0.19896546,
           'box_loss': 0.009877722,
           'class_loss': 0.0029298607,
           'conf_loss': 0.017349103,
           'precision50': 0.40016523,
           'recall50': 0.1762224},
     '4': {'avg_iou': 0.7006774,
           'avg_obj': 0.3859149,
           'box_loss': 0.00955347,
           'class_loss': 0.0028854383,
           'conf_loss': 0.015495418,
           'precision50': 0.64217246,
           'recall50': 0.40454078},
     '5': {'avg_iou': 0.7700687,
           'avg_obj': 0.5072211,
           'box_loss': 0.0088213915,
           'class_loss': 0.002905625,
           'conf_loss': 0.012173991,
           'precision50': 0.7483431,
           'recall50': 0.55618286},
     'AP': 0.37647894,
     'AP50': 0.5916727,
     'AP75': 0.3984878,
     'APl': 0.52725923,
     'APm': 0.38996795,
     'APs': 0.16374211,
     'ARl': 0.6797022,
     'ARm': 0.57435,
     'ARmax1': 0.30711943,
     'ARmax10': 0.49461418,
     'ARmax100': 0.5391301,
     'ARs': 0.32723978,
     'global': {'total_loss': 0.08199208},
     'validation_loss': 0.08199208}
train | step:  120000 | training until step 140000...
train | step:  130000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6317358,
           'avg_obj': 0.25740248,
           'box_loss': 0.014131553,
           'class_loss': 0.005055294,
           'conf_loss': 0.02210155,
           'precision50': 0.49238414,
           'recall50': 0.16534604},
     '4': {'avg_iou': 0.7481793,
           'avg_obj': 0.3975046,
           'box_loss': 0.011001414,
           'class_loss': 0.004022199,
           'conf_loss': 0.019664329,
           'precision50': 0.6881137,
           'recall50': 0.3681089},
     '5': {'avg_iou': 0.78925717,
           'avg_obj': 0.49328148,
           'box_loss': 0.009379964,
           'class_loss': 0.003571465,
           'conf_loss': 0.014160071,
           'precision50': 0.75973386,
           'recall50': 0.5141308},
     'global': {'total_loss': 0.82470155},
     'learning_rate': 0.007800815,
     'training_loss': 0.82470155}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-130000.
train | step:  140000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6340175,
           'avg_obj': 0.26165777,
           'box_loss': 0.014044958,
           'class_loss': 0.004964445,
           'conf_loss': 0.021958858,
           'precision50': 0.49746338,
           'recall50': 0.1696999},
     '4': {'avg_iou': 0.75086486,
           'avg_obj': 0.4028735,
           'box_loss': 0.010888487,
           'class_loss': 0.003942891,
           'conf_loss': 0.019532647,
           'precision50': 0.6915586,
           'recall50': 0.3745134},
     '5': {'avg_iou': 0.79191005,
           'avg_obj': 0.49850914,
           'box_loss': 0.0092567485,
           'class_loss': 0.003499044,
           'conf_loss': 0.014067416,
           'precision50': 0.7622727,
           'recall50': 0.5203179},
     'global': {'total_loss': 0.8172436},
     'learning_rate': 0.007491425,
     'training_loss': 0.8172436}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-140000.
 eval | step:  140000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=174.81s).
Accumulating evaluation results...
DONE (t=12.07s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.379
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.593
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.404
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.169
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.394
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.531
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.310
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.499
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.541
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.331
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.577
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.679
 eval | step:  140000 | eval time:  485.7 sec | output: 
    {'3': {'avg_iou': 0.489617,
           'avg_obj': 0.20289515,
           'box_loss': 0.009795982,
           'class_loss': 0.0029250588,
           'conf_loss': 0.01739112,
           'precision50': 0.40576982,
           'recall50': 0.18405491},
     '4': {'avg_iou': 0.7025023,
           'avg_obj': 0.3917324,
           'box_loss': 0.009460034,
           'class_loss': 0.0029122443,
           'conf_loss': 0.015573748,
           'precision50': 0.6441271,
           'recall50': 0.41312203},
     '5': {'avg_iou': 0.77134293,
           'avg_obj': 0.5130625,
           'box_loss': 0.008758705,
           'class_loss': 0.0029365774,
           'conf_loss': 0.012237288,
           'precision50': 0.747482,
           'recall50': 0.56312644},
     'AP': 0.37916836,
     'AP50': 0.592952,
     'AP75': 0.4044326,
     'APl': 0.53103286,
     'APm': 0.3938552,
     'APs': 0.16940205,
     'ARl': 0.67864704,
     'ARm': 0.57652014,
     'ARmax1': 0.3102422,
     'ARmax10': 0.4988438,
     'ARmax100': 0.54140294,
     'ARs': 0.33118063,
     'global': {'total_loss': 0.081990734},
     'validation_loss': 0.081990734}
train | step:  140000 | training until step 160000...
train | step:  150000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.636032,
           'avg_obj': 0.26589245,
           'box_loss': 0.01397499,
           'class_loss': 0.004878353,
           'conf_loss': 0.021886872,
           'precision50': 0.50157,
           'recall50': 0.17410725},
     '4': {'avg_iou': 0.75310993,
           'avg_obj': 0.4080488,
           'box_loss': 0.010788738,
           'class_loss': 0.003857956,
           'conf_loss': 0.019420557,
           'precision50': 0.6951689,
           'recall50': 0.38145736},
     '5': {'avg_iou': 0.7943293,
           'avg_obj': 0.5039335,
           'box_loss': 0.0091359485,
           'class_loss': 0.0034190346,
           'conf_loss': 0.013953378,
           'precision50': 0.7648237,
           'recall50': 0.52731144},
     'global': {'total_loss': 0.8105244},
     'learning_rate': 0.007171291,
     'training_loss': 0.8105244}I0516 07:28:49.099287 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-150000.
I0516 08:59:29.930042 140269323401024 controller.py:425] train | step:  160000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6378741,
           'avg_obj': 0.26949564,
           'box_loss': 0.013886743,
           'class_loss': 0.0047790464,
           'conf_loss': 0.021734258,
           'precision50': 0.50539285,
           'recall50': 0.17770281},
     '4': {'avg_iou': 0.7556271,
           'avg_obj': 0.41321886,
           'box_loss': 0.010675097,
           'class_loss': 0.00375858,
           'conf_loss': 0.019283729,
           'precision50': 0.69853103,
           'recall50': 0.3876816},
     '5': {'avg_iou': 0.79674685,
           'avg_obj': 0.509333,
           'box_loss': 0.009032022,
           'class_loss': 0.0033373057,
           'conf_loss': 0.013849144,
           'precision50': 0.7670797,
           'recall50': 0.53322864},
     'global': {'total_loss': 0.8026877},
     'learning_rate': 0.0068427175,
     'training_loss': 0.8026877}
I0516 09:00:29.488247 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-160000.
I0516 09:00:29.495711 140269323401024 controller.py:252]  eval | step:  160000 | running 625 steps of evaluation...
I0516 09:04:47.292257 140269323401024 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0516 09:08:56.869747 140269323401024 controller.py:261]  eval | step:  160000 | eval time:  507.4 sec | output: 
    {'3': {'avg_iou': 0.49088007,
           'avg_obj': 0.20523115,
           'box_loss': 0.009734541,
           'class_loss': 0.002934455,
           'conf_loss': 0.017461764,
           'precision50': 0.40684354,
           'recall50': 0.18765835},
     '4': {'avg_iou': 0.7039213,
           'avg_obj': 0.39606732,
           'box_loss': 0.009388727,
           'class_loss': 0.0029655194,
           'conf_loss': 0.01569668,
           'precision50': 0.64409035,
           'recall50': 0.41683438},
     '5': {'avg_iou': 0.7723686,
           'avg_obj': 0.5182744,
           'box_loss': 0.00870588,
           'class_loss': 0.0029488415,
           'conf_loss': 0.012300532,
           'precision50': 0.74832225,
           'recall50': 0.5693948},
     'AP': 0.38365123,
     'AP50': 0.59573656,
     'AP75': 0.40975636,
     'APl': 0.5332662,
     'APm': 0.40000224,
     'APs': 0.17463498,
     'ARl': 0.67339754,
     'ARm': 0.5788628,
     'ARmax1': 0.31307754,
     'ARmax10': 0.49940097,
     'ARmax100': 0.54278004,
     'ARs': 0.3357995,
     'global': {'total_loss': 0.08213694},
     'validation_loss': 0.08213694}
I0516 09:09:15.264467 140269323401024 controller.py:211] train | step:  160000 | training until step 180000...
I0516 10:32:23.361946 140269323401024 controller.py:425] train | step:  170000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6398987,
           'avg_obj': 0.27357125,
           'box_loss': 0.013812567,
           'class_loss': 0.004689454,
           'conf_loss': 0.021563057,
           'precision50': 0.50895953,
           'recall50': 0.18184894},
     '4': {'avg_iou': 0.7575657,
           'avg_obj': 0.41770777,
           'box_loss': 0.010582813,
           'class_loss': 0.0036803188,
           'conf_loss': 0.01908851,
           'precision50': 0.6997946,
           'recall50': 0.39229882},
     '5': {'avg_iou': 0.79880404,
           'avg_obj': 0.51416755,
           'box_loss': 0.008921025,
           'class_loss': 0.0032618504,
           'conf_loss': 0.013697432,
           'precision50': 0.7683953,
           'recall50': 0.53837633},
     'global': {'total_loss': 0.7943777},
     'learning_rate': 0.0065080714,
     'training_loss': 0.7943777}
I0516 10:33:27.959683 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-170000.
I0516 12:05:55.586142 140269323401024 controller.py:425] train | step:  180000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6418264,
           'avg_obj': 0.27753407,
           'box_loss': 0.013742438,
           'class_loss': 0.0046133487,
           'conf_loss': 0.021485476,
           'precision50': 0.51315594,
           'recall50': 0.18645675},
     '4': {'avg_iou': 0.75942665,
           'avg_obj': 0.42216456,
           'box_loss': 0.010488893,
           'class_loss': 0.0036125446,
           'conf_loss': 0.018979654,
           'precision50': 0.7033481,
           'recall50': 0.3984966},
     '5': {'avg_iou': 0.80090386,
           'avg_obj': 0.5186123,
           'box_loss': 0.008820316,
           'class_loss': 0.0031984607,
           'conf_loss': 0.013603436,
           'precision50': 0.77051705,
           'recall50': 0.543933},
     'global': {'total_loss': 0.78835654},
     'learning_rate': 0.0061697643,
     'training_loss': 0.78835654}
I0516 12:06:56.127973 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-180000.
I0516 12:06:56.134387 140269323401024 controller.py:252]  eval | step:  180000 | running 625 steps of evaluation...
I0516 12:11:07.346821 140269323401024 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0516 12:15:16.375473 140269323401024 controller.py:261]  eval | step:  180000 | eval time:  500.2 sec | output: 
    {'3': {'avg_iou': 0.49169755,
           'avg_obj': 0.20797905,
           'box_loss': 0.009695886,
           'class_loss': 0.002985593,
           'conf_loss': 0.01762891,
           'precision50': 0.41001183,
           'recall50': 0.19222836},
     '4': {'avg_iou': 0.7039554,
           'avg_obj': 0.39827743,
           'box_loss': 0.00938653,
           'class_loss': 0.0030214419,
           'conf_loss': 0.015921773,
           'precision50': 0.639365,
           'recall50': 0.42197183},
     '5': {'avg_iou': 0.77258694,
           'avg_obj': 0.52155834,
           'box_loss': 0.008695959,
           'class_loss': 0.0030402099,
           'conf_loss': 0.0124135325,
           'precision50': 0.74423176,
           'recall50': 0.5733968},
     'AP': 0.38192233,
     'AP50': 0.593543,
     'AP75': 0.4077135,
     'APl': 0.5322012,
     'APm': 0.39469612,
     'APs': 0.17311169,
     'ARl': 0.6717468,
     'ARm': 0.5728621,
     'ARmax1': 0.3114361,
     'ARmax10': 0.49750823,
     'ARmax100': 0.5411232,
     'ARs': 0.33270815,
     'global': {'total_loss': 0.08278984},
     'validation_loss': 0.08278984}
I0516 12:15:34.302435 140269323401024 controller.py:211] train | step:  180000 | training until step 200000...
I0516 13:38:18.778269 140269323401024 controller.py:425] train | step:  190000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.643682,
           'avg_obj': 0.28149527,
           'box_loss': 0.013653406,
           'class_loss': 0.00453963,
           'conf_loss': 0.021362273,
           'precision50': 0.51588565,
           'recall50': 0.19013731},
     '4': {'avg_iou': 0.7612105,
           'avg_obj': 0.4268625,
           'box_loss': 0.010406208,
           'class_loss': 0.0035463038,
           'conf_loss': 0.018805524,
           'precision50': 0.704755,
           'recall50': 0.40382615},
     '5': {'avg_iou': 0.8030709,
           'avg_obj': 0.523741,
           'box_loss': 0.008720395,
           'class_loss': 0.0031404388,
           'conf_loss': 0.013450128,
           'precision50': 0.7724421,
           'recall50': 0.54961884},
     'global': {'total_loss': 0.7809944},
     'learning_rate': 0.0058302353,
     'training_loss': 0.7809944}

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-150000.
train | step:  160000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6378741,
           'avg_obj': 0.26949564,
           'box_loss': 0.013886743,
           'class_loss': 0.0047790464,
           'conf_loss': 0.021734258,
           'precision50': 0.50539285,
           'recall50': 0.17770281},
     '4': {'avg_iou': 0.7556271,
           'avg_obj': 0.41321886,
           'box_loss': 0.010675097,
           'class_loss': 0.00375858,
           'conf_loss': 0.019283729,
           'precision50': 0.69853103,
           'recall50': 0.3876816},
     '5': {'avg_iou': 0.79674685,
           'avg_obj': 0.509333,
           'box_loss': 0.009032022,
           'class_loss': 0.0033373057,
           'conf_loss': 0.013849144,
           'precision50': 0.7670797,
           'recall50': 0.53322864},
     'global': {'total_loss': 0.8026877},
     'learning_rate': 0.0068427175,
     'training_loss': 0.8026877}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-160000.
 eval | step:  160000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=180.00s).
Accumulating evaluation results...
DONE (t=11.77s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.384
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.596
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.410
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.175
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.400
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.533
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.313
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.499
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.543
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.336
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.579
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.673
 eval | step:  160000 | eval time:  507.4 sec | output: 
    {'3': {'avg_iou': 0.49088007,
           'avg_obj': 0.20523115,
           'box_loss': 0.009734541,
           'class_loss': 0.002934455,
           'conf_loss': 0.017461764,
           'precision50': 0.40684354,
           'recall50': 0.18765835},
     '4': {'avg_iou': 0.7039213,
           'avg_obj': 0.39606732,
           'box_loss': 0.009388727,
           'class_loss': 0.0029655194,
           'conf_loss': 0.01569668,
           'precision50': 0.64409035,
           'recall50': 0.41683438},
     '5': {'avg_iou': 0.7723686,
           'avg_obj': 0.5182744,
           'box_loss': 0.00870588,
           'class_loss': 0.0029488415,
           'conf_loss': 0.012300532,
           'precision50': 0.74832225,
           'recall50': 0.5693948},
     'AP': 0.38365123,
     'AP50': 0.59573656,
     'AP75': 0.40975636,
     'APl': 0.5332662,
     'APm': 0.40000224,
     'APs': 0.17463498,
     'ARl': 0.67339754,
     'ARm': 0.5788628,
     'ARmax1': 0.31307754,
     'ARmax10': 0.49940097,
     'ARmax100': 0.54278004,
     'ARs': 0.3357995,
     'global': {'total_loss': 0.08213694},
     'validation_loss': 0.08213694}
train | step:  160000 | training until step 180000...
train | step:  170000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6398987,
           'avg_obj': 0.27357125,
           'box_loss': 0.013812567,
           'class_loss': 0.004689454,
           'conf_loss': 0.021563057,
           'precision50': 0.50895953,
           'recall50': 0.18184894},
     '4': {'avg_iou': 0.7575657,
           'avg_obj': 0.41770777,
           'box_loss': 0.010582813,
           'class_loss': 0.0036803188,
           'conf_loss': 0.01908851,
           'precision50': 0.6997946,
           'recall50': 0.39229882},
     '5': {'avg_iou': 0.79880404,
           'avg_obj': 0.51416755,
           'box_loss': 0.008921025,
           'class_loss': 0.0032618504,
           'conf_loss': 0.013697432,
           'precision50': 0.7683953,
           'recall50': 0.53837633},
     'global': {'total_loss': 0.7943777},
     'learning_rate': 0.0065080714,
     'training_loss': 0.7943777}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-170000.
train | step:  180000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6418264,
           'avg_obj': 0.27753407,
           'box_loss': 0.013742438,
           'class_loss': 0.0046133487,
           'conf_loss': 0.021485476,
           'precision50': 0.51315594,
           'recall50': 0.18645675},
     '4': {'avg_iou': 0.75942665,
           'avg_obj': 0.42216456,
           'box_loss': 0.010488893,
           'class_loss': 0.0036125446,
           'conf_loss': 0.018979654,
           'precision50': 0.7033481,
           'recall50': 0.3984966},
     '5': {'avg_iou': 0.80090386,
           'avg_obj': 0.5186123,
           'box_loss': 0.008820316,
           'class_loss': 0.0031984607,
           'conf_loss': 0.013603436,
           'precision50': 0.77051705,
           'recall50': 0.543933},
     'global': {'total_loss': 0.78835654},
     'learning_rate': 0.0061697643,
     'training_loss': 0.78835654}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-180000.
 eval | step:  180000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=179.41s).
Accumulating evaluation results...
DONE (t=13.95s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.382
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.594
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.408
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.173
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.395
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.532
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.311
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.498
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.541
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.333
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.573
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.672
 eval | step:  180000 | eval time:  500.2 sec | output: 
    {'3': {'avg_iou': 0.49169755,
           'avg_obj': 0.20797905,
           'box_loss': 0.009695886,
           'class_loss': 0.002985593,
           'conf_loss': 0.01762891,
           'precision50': 0.41001183,
           'recall50': 0.19222836},
     '4': {'avg_iou': 0.7039554,
           'avg_obj': 0.39827743,
           'box_loss': 0.00938653,
           'class_loss': 0.0030214419,
           'conf_loss': 0.015921773,
           'precision50': 0.639365,
           'recall50': 0.42197183},
     '5': {'avg_iou': 0.77258694,
           'avg_obj': 0.52155834,
           'box_loss': 0.008695959,
           'class_loss': 0.0030402099,
           'conf_loss': 0.0124135325,
           'precision50': 0.74423176,
           'recall50': 0.5733968},
     'AP': 0.38192233,
     'AP50': 0.593543,
     'AP75': 0.4077135,
     'APl': 0.5322012,
     'APm': 0.39469612,
     'APs': 0.17311169,
     'ARl': 0.6717468,
     'ARm': 0.5728621,
     'ARmax1': 0.3114361,
     'ARmax10': 0.49750823,
     'ARmax100': 0.5411232,
     'ARs': 0.33270815,
     'global': {'total_loss': 0.08278984},
     'validation_loss': 0.08278984}
train | step:  180000 | training until step 200000...
train | step:  190000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.643682,
           'avg_obj': 0.28149527,
           'box_loss': 0.013653406,
           'class_loss': 0.00453963,
           'conf_loss': 0.021362273,
           'precision50': 0.51588565,
           'recall50': 0.19013731},
     '4': {'avg_iou': 0.7612105,
           'avg_obj': 0.4268625,
           'box_loss': 0.010406208,
           'class_loss': 0.0035463038,
           'conf_loss': 0.018805524,
           'precision50': 0.704755,
           'recall50': 0.40382615},
     '5': {'avg_iou': 0.8030709,
           'avg_obj': 0.523741,
           'box_loss': 0.008720395,
           'class_loss': 0.0031404388,
           'conf_loss': 0.013450128,
           'precision50': 0.7724421,
           'recall50': 0.54961884},
     'global': {'total_loss': 0.7809944},
     'learning_rate': 0.0058302353,
     'training_loss': 0.7809944}I0516 13:39:19.979639 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-190000.
I0516 15:08:16.713254 140269323401024 controller.py:425] train | step:  200000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.64510876,
           'avg_obj': 0.28487307,
           'box_loss': 0.013590103,
           'class_loss': 0.004455348,
           'conf_loss': 0.021226836,
           'precision50': 0.51934475,
           'recall50': 0.19354631},
     '4': {'avg_iou': 0.7630252,
           'avg_obj': 0.43090177,
           'box_loss': 0.010310579,
           'class_loss': 0.0034685014,
           'conf_loss': 0.018701965,
           'precision50': 0.70710826,
           'recall50': 0.40829086},
     '5': {'avg_iou': 0.80460745,
           'avg_obj': 0.52775466,
           'box_loss': 0.008642403,
           'class_loss': 0.003069495,
           'conf_loss': 0.013365549,
           'precision50': 0.77439547,
           'recall50': 0.5542738},
     'global': {'total_loss': 0.7746455},
     'learning_rate': 0.005491929,
     'training_loss': 0.7746455}
I0516 15:09:18.119766 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-200000.
I0516 15:09:18.125862 140269323401024 controller.py:252]  eval | step:  200000 | running 625 steps of evaluation...
I0516 15:13:20.253422 140269323401024 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0516 15:17:20.289391 140269323401024 controller.py:261]  eval | step:  200000 | eval time:  482.2 sec | output: 
    {'3': {'avg_iou': 0.49219814,
           'avg_obj': 0.2096752,
           'box_loss': 0.009669897,
           'class_loss': 0.0030138607,
           'conf_loss': 0.017760195,
           'precision50': 0.41296783,
           'recall50': 0.19631033},
     '4': {'avg_iou': 0.70479774,
           'avg_obj': 0.4014503,
           'box_loss': 0.009344924,
           'class_loss': 0.0030967875,
           'conf_loss': 0.016072387,
           'precision50': 0.6376668,
           'recall50': 0.42723638},
     '5': {'avg_iou': 0.7732044,
           'avg_obj': 0.52475923,
           'box_loss': 0.008666322,
           'class_loss': 0.003071125,
           'conf_loss': 0.012552046,
           'precision50': 0.74336886,
           'recall50': 0.5766765},
     'AP': 0.38285816,
     'AP50': 0.5918515,
     'AP75': 0.40958858,
     'APl': 0.5308755,
     'APm': 0.3994576,
     'APs': 0.17738527,
     'ARl': 0.6709691,
     'ARm': 0.572115,
     'ARmax1': 0.3129034,
     'ARmax10': 0.49824327,
     'ARmax100': 0.5396811,
     'ARs': 0.3308926,
     'global': {'total_loss': 0.08324761},
     'validation_loss': 0.08324761}
I0516 15:17:43.779625 140269323401024 controller.py:211] train | step:  200000 | training until step 220000...
I0516 16:43:12.752636 140269323401024 controller.py:425] train | step:  210000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6466771,
           'avg_obj': 0.28801075,
           'box_loss': 0.0135377,
           'class_loss': 0.004410268,
           'conf_loss': 0.02118435,
           'precision50': 0.52363706,
           'recall50': 0.19746186},
     '4': {'avg_iou': 0.76480156,
           'avg_obj': 0.43541953,
           'box_loss': 0.010239604,
           'class_loss': 0.0034253318,
           'conf_loss': 0.018617516,
           'precision50': 0.710765,
           'recall50': 0.41476485},
     '5': {'avg_iou': 0.8064621,
           'avg_obj': 0.5322489,
           'box_loss': 0.008559881,
           'class_loss': 0.0030304985,
           'conf_loss': 0.013277508,
           'precision50': 0.77659935,
           'recall50': 0.5593458},
     'global': {'total_loss': 0.7702619},
     'learning_rate': 0.005157283,
     'training_loss': 0.7702619}
I0516 16:44:14.571383 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-210000.
I0516 18:18:41.984667 140269323401024 controller.py:425] train | step:  220000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6483548,
           'avg_obj': 0.29158255,
           'box_loss': 0.013462191,
           'class_loss': 0.0043296213,
           'conf_loss': 0.020965043,
           'precision50': 0.52621216,
           'recall50': 0.20102029},
     '4': {'avg_iou': 0.7665318,
           'avg_obj': 0.43935814,
           'box_loss': 0.010154452,
           'class_loss': 0.0033606652,
           'conf_loss': 0.018431222,
           'precision50': 0.7118653,
           'recall50': 0.4189464},
     '5': {'avg_iou': 0.8082367,
           'avg_obj': 0.53622735,
           'box_loss': 0.008467853,
           'class_loss': 0.0029667208,
           'conf_loss': 0.013165699,
           'precision50': 0.7773174,
           'recall50': 0.56364065},
     'global': {'total_loss': 0.76242626},
     'learning_rate': 0.0048287087,
     'training_loss': 0.76242626}
I0516 18:19:40.599627 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-220000.
I0516 18:19:40.605848 140269323401024 controller.py:252]  eval | step:  220000 | running 625 steps of evaluation...
I0516 18:23:52.715241 140269323401024 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0516 18:28:04.405940 140269323401024 controller.py:261]  eval | step:  220000 | eval time:  503.8 sec | output: 
    {'3': {'avg_iou': 0.4924032,
           'avg_obj': 0.21041143,
           'box_loss': 0.009660482,
           'class_loss': 0.0030082434,
           'conf_loss': 0.017943876,
           'precision50': 0.40926006,
           'recall50': 0.19852017},
     '4': {'avg_iou': 0.7041499,
           'avg_obj': 0.4027331,
           'box_loss': 0.009379788,
           'class_loss': 0.0031353687,
           'conf_loss': 0.016295854,
           'precision50': 0.6355252,
           'recall50': 0.42905015},
     '5': {'avg_iou': 0.7732951,
           'avg_obj': 0.5271885,
           'box_loss': 0.008663462,
           'class_loss': 0.0031463949,
           'conf_loss': 0.012703417,
           'precision50': 0.73958457,
           'recall50': 0.57695013},
     'AP': 0.38076007,
     'AP50': 0.58920413,
     'AP75': 0.4069899,
     'APl': 0.5304847,
     'APm': 0.39619005,
     'APs': 0.18141076,
     'ARl': 0.6685227,
     'ARm': 0.5688396,
     'ARmax1': 0.31108224,
     'ARmax10': 0.4957535,
     'ARmax100': 0.53829366,
     'ARs': 0.33680904,
     'global': {'total_loss': 0.08393688},
     'validation_loss': 0.08393688}
I0516 18:28:27.290325 140269323401024 controller.py:211] train | step:  220000 | training until step 240000...
I0516 19:55:32.213376 140269323401024 controller.py:425] train | step:  230000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.64963186,
           'avg_obj': 0.29472333,
           'box_loss': 0.013415353,
           'class_loss': 0.00427119,
           'conf_loss': 0.02093087,
           'precision50': 0.5289994,
           'recall50': 0.20418756},
     '4': {'avg_iou': 0.76821584,
           'avg_obj': 0.44326094,
           'box_loss': 0.010077311,
           'class_loss': 0.0033032394,
           'conf_loss': 0.018376,
           'precision50': 0.71488917,
           'recall50': 0.42377082},
     '5': {'avg_iou': 0.80993533,
           'avg_obj': 0.5405219,
           'box_loss': 0.008390297,
           'class_loss': 0.0029313876,
           'conf_loss': 0.013085716,
           'precision50': 0.7793143,
           'recall50': 0.5682896},
     'global': {'total_loss': 0.75825274},
     'learning_rate': 0.004508574,
     'training_loss': 0.75825274}

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-190000.
train | step:  200000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.64510876,
           'avg_obj': 0.28487307,
           'box_loss': 0.013590103,
           'class_loss': 0.004455348,
           'conf_loss': 0.021226836,
           'precision50': 0.51934475,
           'recall50': 0.19354631},
     '4': {'avg_iou': 0.7630252,
           'avg_obj': 0.43090177,
           'box_loss': 0.010310579,
           'class_loss': 0.0034685014,
           'conf_loss': 0.018701965,
           'precision50': 0.70710826,
           'recall50': 0.40829086},
     '5': {'avg_iou': 0.80460745,
           'avg_obj': 0.52775466,
           'box_loss': 0.008642403,
           'class_loss': 0.003069495,
           'conf_loss': 0.013365549,
           'precision50': 0.77439547,
           'recall50': 0.5542738},
     'global': {'total_loss': 0.7746455},
     'learning_rate': 0.005491929,
     'training_loss': 0.7746455}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-200000.
 eval | step:  200000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=177.34s).
Accumulating evaluation results...
DONE (t=10.94s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.383
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.592
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.410
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.177
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.399
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.531
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.313
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.498
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.540
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.331
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.572
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.671
 eval | step:  200000 | eval time:  482.2 sec | output: 
    {'3': {'avg_iou': 0.49219814,
           'avg_obj': 0.2096752,
           'box_loss': 0.009669897,
           'class_loss': 0.0030138607,
           'conf_loss': 0.017760195,
           'precision50': 0.41296783,
           'recall50': 0.19631033},
     '4': {'avg_iou': 0.70479774,
           'avg_obj': 0.4014503,
           'box_loss': 0.009344924,
           'class_loss': 0.0030967875,
           'conf_loss': 0.016072387,
           'precision50': 0.6376668,
           'recall50': 0.42723638},
     '5': {'avg_iou': 0.7732044,
           'avg_obj': 0.52475923,
           'box_loss': 0.008666322,
           'class_loss': 0.003071125,
           'conf_loss': 0.012552046,
           'precision50': 0.74336886,
           'recall50': 0.5766765},
     'AP': 0.38285816,
     'AP50': 0.5918515,
     'AP75': 0.40958858,
     'APl': 0.5308755,
     'APm': 0.3994576,
     'APs': 0.17738527,
     'ARl': 0.6709691,
     'ARm': 0.572115,
     'ARmax1': 0.3129034,
     'ARmax10': 0.49824327,
     'ARmax100': 0.5396811,
     'ARs': 0.3308926,
     'global': {'total_loss': 0.08324761},
     'validation_loss': 0.08324761}
train | step:  200000 | training until step 220000...
train | step:  210000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6466771,
           'avg_obj': 0.28801075,
           'box_loss': 0.0135377,
           'class_loss': 0.004410268,
           'conf_loss': 0.02118435,
           'precision50': 0.52363706,
           'recall50': 0.19746186},
     '4': {'avg_iou': 0.76480156,
           'avg_obj': 0.43541953,
           'box_loss': 0.010239604,
           'class_loss': 0.0034253318,
           'conf_loss': 0.018617516,
           'precision50': 0.710765,
           'recall50': 0.41476485},
     '5': {'avg_iou': 0.8064621,
           'avg_obj': 0.5322489,
           'box_loss': 0.008559881,
           'class_loss': 0.0030304985,
           'conf_loss': 0.013277508,
           'precision50': 0.77659935,
           'recall50': 0.5593458},
     'global': {'total_loss': 0.7702619},
     'learning_rate': 0.005157283,
     'training_loss': 0.7702619}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-210000.
train | step:  220000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6483548,
           'avg_obj': 0.29158255,
           'box_loss': 0.013462191,
           'class_loss': 0.0043296213,
           'conf_loss': 0.020965043,
           'precision50': 0.52621216,
           'recall50': 0.20102029},
     '4': {'avg_iou': 0.7665318,
           'avg_obj': 0.43935814,
           'box_loss': 0.010154452,
           'class_loss': 0.0033606652,
           'conf_loss': 0.018431222,
           'precision50': 0.7118653,
           'recall50': 0.4189464},
     '5': {'avg_iou': 0.8082367,
           'avg_obj': 0.53622735,
           'box_loss': 0.008467853,
           'class_loss': 0.0029667208,
           'conf_loss': 0.013165699,
           'precision50': 0.7773174,
           'recall50': 0.56364065},
     'global': {'total_loss': 0.76242626},
     'learning_rate': 0.0048287087,
     'training_loss': 0.76242626}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-220000.
 eval | step:  220000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=182.37s).
Accumulating evaluation results...
DONE (t=10.81s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.381
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.589
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.407
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.181
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.396
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.530
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.311
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.496
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.538
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.337
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.569
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.669
 eval | step:  220000 | eval time:  503.8 sec | output: 
    {'3': {'avg_iou': 0.4924032,
           'avg_obj': 0.21041143,
           'box_loss': 0.009660482,
           'class_loss': 0.0030082434,
           'conf_loss': 0.017943876,
           'precision50': 0.40926006,
           'recall50': 0.19852017},
     '4': {'avg_iou': 0.7041499,
           'avg_obj': 0.4027331,
           'box_loss': 0.009379788,
           'class_loss': 0.0031353687,
           'conf_loss': 0.016295854,
           'precision50': 0.6355252,
           'recall50': 0.42905015},
     '5': {'avg_iou': 0.7732951,
           'avg_obj': 0.5271885,
           'box_loss': 0.008663462,
           'class_loss': 0.0031463949,
           'conf_loss': 0.012703417,
           'precision50': 0.73958457,
           'recall50': 0.57695013},
     'AP': 0.38076007,
     'AP50': 0.58920413,
     'AP75': 0.4069899,
     'APl': 0.5304847,
     'APm': 0.39619005,
     'APs': 0.18141076,
     'ARl': 0.6685227,
     'ARm': 0.5688396,
     'ARmax1': 0.31108224,
     'ARmax10': 0.4957535,
     'ARmax100': 0.53829366,
     'ARs': 0.33680904,
     'global': {'total_loss': 0.08393688},
     'validation_loss': 0.08393688}
train | step:  220000 | training until step 240000...
train | step:  230000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.64963186,
           'avg_obj': 0.29472333,
           'box_loss': 0.013415353,
           'class_loss': 0.00427119,
           'conf_loss': 0.02093087,
           'precision50': 0.5289994,
           'recall50': 0.20418756},
     '4': {'avg_iou': 0.76821584,
           'avg_obj': 0.44326094,
           'box_loss': 0.010077311,
           'class_loss': 0.0033032394,
           'conf_loss': 0.018376,
           'precision50': 0.71488917,
           'recall50': 0.42377082},
     '5': {'avg_iou': 0.80993533,
           'avg_obj': 0.5405219,
           'box_loss': 0.008390297,
           'class_loss': 0.0029313876,
           'conf_loss': 0.013085716,
           'precision50': 0.7793143,
           'recall50': 0.5682896},
     'global': {'total_loss': 0.75825274},
     'learning_rate': 0.004508574,
     'training_loss': 0.75825274}I0516 19:56:31.271883 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-230000.
I0516 21:34:28.669597 140269323401024 controller.py:425] train | step:  240000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6509874,
           'avg_obj': 0.2979658,
           'box_loss': 0.013354481,
           'class_loss': 0.004213633,
           'conf_loss': 0.02078922,
           'precision50': 0.53239346,
           'recall50': 0.2081437},
     '4': {'avg_iou': 0.7695508,
           'avg_obj': 0.44706976,
           'box_loss': 0.010013718,
           'class_loss': 0.0032492513,
           'conf_loss': 0.018208204,
           'precision50': 0.71630347,
           'recall50': 0.42842326},
     '5': {'avg_iou': 0.81149143,
           'avg_obj': 0.5442711,
           'box_loss': 0.008314054,
           'class_loss': 0.0028791602,
           'conf_loss': 0.012964153,
           'precision50': 0.780691,
           'recall50': 0.5726473},
     'global': {'total_loss': 0.75188595},
     'learning_rate': 0.0041991845,
     'training_loss': 0.75188595}
I0516 21:35:28.769676 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-240000.
I0516 21:35:28.775283 140269323401024 controller.py:252]  eval | step:  240000 | running 625 steps of evaluation...
I0516 21:39:37.650676 140269323401024 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0516 21:43:42.302287 140269323401024 controller.py:261]  eval | step:  240000 | eval time:  493.5 sec | output: 
    {'3': {'avg_iou': 0.49199024,
           'avg_obj': 0.21133032,
           'box_loss': 0.009681324,
           'class_loss': 0.0030835813,
           'conf_loss': 0.018119102,
           'precision50': 0.41085768,
           'recall50': 0.19972634},
     '4': {'avg_iou': 0.70390123,
           'avg_obj': 0.4043313,
           'box_loss': 0.009394861,
           'class_loss': 0.003178358,
           'conf_loss': 0.016481576,
           'precision50': 0.6380834,
           'recall50': 0.43104532},
     '5': {'avg_iou': 0.77327317,
           'avg_obj': 0.5284646,
           'box_loss': 0.008664621,
           'class_loss': 0.0031819073,
           'conf_loss': 0.012826105,
           'precision50': 0.7390543,
           'recall50': 0.5787132},
     'AP': 0.38084227,
     'AP50': 0.58910596,
     'AP75': 0.41044262,
     'APl': 0.52982247,
     'APm': 0.3942219,
     'APs': 0.17688726,
     'ARl': 0.6680831,
     'ARm': 0.5653005,
     'ARmax1': 0.31096125,
     'ARmax10': 0.49360937,
     'ARmax100': 0.5357446,
     'ARs': 0.3322784,
     'global': {'total_loss': 0.0846114},
     'validation_loss': 0.0846114}
I0516 21:44:04.406284 140269323401024 controller.py:211] train | step:  240000 | training until step 260000...
I0516 23:10:55.071785 140269323401024 controller.py:425] train | step:  250000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6523121,
           'avg_obj': 0.30095202,
           'box_loss': 0.013286374,
           'class_loss': 0.004165452,
           'conf_loss': 0.020666217,
           'precision50': 0.53429985,
           'recall50': 0.21104756},
     '4': {'avg_iou': 0.77120936,
           'avg_obj': 0.45088863,
           'box_loss': 0.009930925,
           'class_loss': 0.0031999967,
           'conf_loss': 0.018083079,
           'precision50': 0.71828187,
           'recall50': 0.43320996},
     '5': {'avg_iou': 0.8129349,
           'avg_obj': 0.5476475,
           'box_loss': 0.008241017,
           'class_loss': 0.002838162,
           'conf_loss': 0.012866056,
           'precision50': 0.78214,
           'recall50': 0.57638407},
     'global': {'total_loss': 0.74621874},
     'learning_rate': 0.0039027706,
     'training_loss': 0.74621874}
I0516 23:11:53.795991 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-250000.
I0517 00:44:48.248334 140269323401024 controller.py:425] train | step:  260000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6536568,
           'avg_obj': 0.3042358,
           'box_loss': 0.013249978,
           'class_loss': 0.00411623,
           'conf_loss': 0.020601133,
           'precision50': 0.5383706,
           'recall50': 0.21512513},
     '4': {'avg_iou': 0.7725053,
           'avg_obj': 0.45433325,
           'box_loss': 0.009878101,
           'class_loss': 0.0031533255,
           'conf_loss': 0.018000323,
           'precision50': 0.7201709,
           'recall50': 0.43713668},
     '5': {'avg_iou': 0.8142292,
           'avg_obj': 0.5512882,
           'box_loss': 0.008182431,
           'class_loss': 0.0027921842,
           'conf_loss': 0.012778648,
           'precision50': 0.7838204,
           'recall50': 0.58043325},
     'global': {'total_loss': 0.74201757},
     'learning_rate': 0.0036214672,
     'training_loss': 0.74201757}
I0517 00:46:03.272770 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-260000.
I0517 00:46:03.278835 140269323401024 controller.py:252]  eval | step:  260000 | running 625 steps of evaluation...
I0517 00:50:47.849439 140269323401024 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0517 00:54:54.009633 140269323401024 controller.py:261]  eval | step:  260000 | eval time:  530.7 sec | output: 
    {'3': {'avg_iou': 0.49141905,
           'avg_obj': 0.21161985,
           'box_loss': 0.009716215,
           'class_loss': 0.0031519744,
           'conf_loss': 0.018283075,
           'precision50': 0.40863556,
           'recall50': 0.20194283},
     '4': {'avg_iou': 0.70364016,
           'avg_obj': 0.40564802,
           'box_loss': 0.009406473,
           'class_loss': 0.0032791004,
           'conf_loss': 0.016728267,
           'precision50': 0.6334516,
           'recall50': 0.43248042},
     '5': {'avg_iou': 0.7732651,
           'avg_obj': 0.5311487,
           'box_loss': 0.008668525,
           'class_loss': 0.0032570052,
           'conf_loss': 0.01302222,
           'precision50': 0.73616195,
           'recall50': 0.58182645},
     'AP': 0.38035065,
     'AP50': 0.58727205,
     'AP75': 0.406626,
     'APl': 0.5286006,
     'APm': 0.39455646,
     'APs': 0.18085092,
     'ARl': 0.66134095,
     'ARm': 0.56364006,
     'ARmax1': 0.3116562,
     'ARmax10': 0.49308065,
     'ARmax100': 0.5337112,
     'ARs': 0.33351395,
     'global': {'total_loss': 0.0855129},
     'validation_loss': 0.0855129}
I0517 00:55:23.567124 140269323401024 controller.py:211] train | step:  260000 | training until step 280000...
I0517 02:29:24.471748 140269323401024 controller.py:425] train | step:  270000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.65445036,
           'avg_obj': 0.30704325,
           'box_loss': 0.013220409,
           'class_loss': 0.004065338,
           'conf_loss': 0.020468116,
           'precision50': 0.53971255,
           'recall50': 0.2178676},
     '4': {'avg_iou': 0.77379006,
           'avg_obj': 0.45754752,
           'box_loss': 0.009819641,
           'class_loss': 0.0031106398,
           'conf_loss': 0.01785843,
           'precision50': 0.7216168,
           'recall50': 0.44077128},
     '5': {'avg_iou': 0.81572944,
           'avg_obj': 0.55495185,
           'box_loss': 0.008112231,
           'class_loss': 0.0027547183,
           'conf_loss': 0.012679469,
           'precision50': 0.7845074,
           'recall50': 0.583952},
     'global': {'total_loss': 0.736713},
     'learning_rate': 0.003357301,
     'training_loss': 0.736713}

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-230000.
train | step:  240000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6509874,
           'avg_obj': 0.2979658,
           'box_loss': 0.013354481,
           'class_loss': 0.004213633,
           'conf_loss': 0.02078922,
           'precision50': 0.53239346,
           'recall50': 0.2081437},
     '4': {'avg_iou': 0.7695508,
           'avg_obj': 0.44706976,
           'box_loss': 0.010013718,
           'class_loss': 0.0032492513,
           'conf_loss': 0.018208204,
           'precision50': 0.71630347,
           'recall50': 0.42842326},
     '5': {'avg_iou': 0.81149143,
           'avg_obj': 0.5442711,
           'box_loss': 0.008314054,
           'class_loss': 0.0028791602,
           'conf_loss': 0.012964153,
           'precision50': 0.780691,
           'recall50': 0.5726473},
     'global': {'total_loss': 0.75188595},
     'learning_rate': 0.0041991845,
     'training_loss': 0.75188595}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-240000.
 eval | step:  240000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=180.84s).
Accumulating evaluation results...
DONE (t=10.40s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.381
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.589
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.410
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.177
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.394
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.530
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.311
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.494
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.536
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.332
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.565
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.668
 eval | step:  240000 | eval time:  493.5 sec | output: 
    {'3': {'avg_iou': 0.49199024,
           'avg_obj': 0.21133032,
           'box_loss': 0.009681324,
           'class_loss': 0.0030835813,
           'conf_loss': 0.018119102,
           'precision50': 0.41085768,
           'recall50': 0.19972634},
     '4': {'avg_iou': 0.70390123,
           'avg_obj': 0.4043313,
           'box_loss': 0.009394861,
           'class_loss': 0.003178358,
           'conf_loss': 0.016481576,
           'precision50': 0.6380834,
           'recall50': 0.43104532},
     '5': {'avg_iou': 0.77327317,
           'avg_obj': 0.5284646,
           'box_loss': 0.008664621,
           'class_loss': 0.0031819073,
           'conf_loss': 0.012826105,
           'precision50': 0.7390543,
           'recall50': 0.5787132},
     'AP': 0.38084227,
     'AP50': 0.58910596,
     'AP75': 0.41044262,
     'APl': 0.52982247,
     'APm': 0.3942219,
     'APs': 0.17688726,
     'ARl': 0.6680831,
     'ARm': 0.5653005,
     'ARmax1': 0.31096125,
     'ARmax10': 0.49360937,
     'ARmax100': 0.5357446,
     'ARs': 0.3322784,
     'global': {'total_loss': 0.0846114},
     'validation_loss': 0.0846114}
train | step:  240000 | training until step 260000...
train | step:  250000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6523121,
           'avg_obj': 0.30095202,
           'box_loss': 0.013286374,
           'class_loss': 0.004165452,
           'conf_loss': 0.020666217,
           'precision50': 0.53429985,
           'recall50': 0.21104756},
     '4': {'avg_iou': 0.77120936,
           'avg_obj': 0.45088863,
           'box_loss': 0.009930925,
           'class_loss': 0.0031999967,
           'conf_loss': 0.018083079,
           'precision50': 0.71828187,
           'recall50': 0.43320996},
     '5': {'avg_iou': 0.8129349,
           'avg_obj': 0.5476475,
           'box_loss': 0.008241017,
           'class_loss': 0.002838162,
           'conf_loss': 0.012866056,
           'precision50': 0.78214,
           'recall50': 0.57638407},
     'global': {'total_loss': 0.74621874},
     'learning_rate': 0.0039027706,
     'training_loss': 0.74621874}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-250000.
train | step:  260000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6536568,
           'avg_obj': 0.3042358,
           'box_loss': 0.013249978,
           'class_loss': 0.00411623,
           'conf_loss': 0.020601133,
           'precision50': 0.5383706,
           'recall50': 0.21512513},
     '4': {'avg_iou': 0.7725053,
           'avg_obj': 0.45433325,
           'box_loss': 0.009878101,
           'class_loss': 0.0031533255,
           'conf_loss': 0.018000323,
           'precision50': 0.7201709,
           'recall50': 0.43713668},
     '5': {'avg_iou': 0.8142292,
           'avg_obj': 0.5512882,
           'box_loss': 0.008182431,
           'class_loss': 0.0027921842,
           'conf_loss': 0.012778648,
           'precision50': 0.7838204,
           'recall50': 0.58043325},
     'global': {'total_loss': 0.74201757},
     'learning_rate': 0.0036214672,
     'training_loss': 0.74201757}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-260000.
 eval | step:  260000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=180.89s).
Accumulating evaluation results...
DONE (t=11.04s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.380
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.587
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.407
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.181
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.395
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.529
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.312
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.493
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.534
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.334
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.564
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.661
 eval | step:  260000 | eval time:  530.7 sec | output: 
    {'3': {'avg_iou': 0.49141905,
           'avg_obj': 0.21161985,
           'box_loss': 0.009716215,
           'class_loss': 0.0031519744,
           'conf_loss': 0.018283075,
           'precision50': 0.40863556,
           'recall50': 0.20194283},
     '4': {'avg_iou': 0.70364016,
           'avg_obj': 0.40564802,
           'box_loss': 0.009406473,
           'class_loss': 0.0032791004,
           'conf_loss': 0.016728267,
           'precision50': 0.6334516,
           'recall50': 0.43248042},
     '5': {'avg_iou': 0.7732651,
           'avg_obj': 0.5311487,
           'box_loss': 0.008668525,
           'class_loss': 0.0032570052,
           'conf_loss': 0.01302222,
           'precision50': 0.73616195,
           'recall50': 0.58182645},
     'AP': 0.38035065,
     'AP50': 0.58727205,
     'AP75': 0.406626,
     'APl': 0.5286006,
     'APm': 0.39455646,
     'APs': 0.18085092,
     'ARl': 0.66134095,
     'ARm': 0.56364006,
     'ARmax1': 0.3116562,
     'ARmax10': 0.49308065,
     'ARmax100': 0.5337112,
     'ARs': 0.33351395,
     'global': {'total_loss': 0.0855129},
     'validation_loss': 0.0855129}
train | step:  260000 | training until step 280000...
train | step:  270000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.65445036,
           'avg_obj': 0.30704325,
           'box_loss': 0.013220409,
           'class_loss': 0.004065338,
           'conf_loss': 0.020468116,
           'precision50': 0.53971255,
           'recall50': 0.2178676},
     '4': {'avg_iou': 0.77379006,
           'avg_obj': 0.45754752,
           'box_loss': 0.009819641,
           'class_loss': 0.0031106398,
           'conf_loss': 0.01785843,
           'precision50': 0.7216168,
           'recall50': 0.44077128},
     '5': {'avg_iou': 0.81572944,
           'avg_obj': 0.55495185,
           'box_loss': 0.008112231,
           'class_loss': 0.0027547183,
           'conf_loss': 0.012679469,
           'precision50': 0.7845074,
           'recall50': 0.583952},
     'global': {'total_loss': 0.736713},
     'learning_rate': 0.003357301,
     'training_loss': 0.736713}I0517 02:30:22.215077 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-270000.
I0517 04:05:18.230018 140269323401024 controller.py:425] train | step:  280000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6557422,
           'avg_obj': 0.30962503,
           'box_loss': 0.013142487,
           'class_loss': 0.004010169,
           'conf_loss': 0.020388534,
           'precision50': 0.54164225,
           'recall50': 0.22044607},
     '4': {'avg_iou': 0.7749926,
           'avg_obj': 0.46093446,
           'box_loss': 0.009749268,
           'class_loss': 0.0030644117,
           'conf_loss': 0.017746586,
           'precision50': 0.72306645,
           'recall50': 0.44489458},
     '5': {'avg_iou': 0.8167176,
           'avg_obj': 0.5581113,
           'box_loss': 0.008053561,
           'class_loss': 0.002718023,
           'conf_loss': 0.012597248,
           'precision50': 0.7859891,
           'recall50': 0.5876785},
     'global': {'total_loss': 0.73176324},
     'learning_rate': 0.003112175,
     'training_loss': 0.73176324}
I0517 04:06:19.151812 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-280000.
I0517 04:06:19.158095 140269323401024 controller.py:252]  eval | step:  280000 | running 625 steps of evaluation...
I0517 04:10:24.508491 140269323401024 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0517 04:14:25.232982 140269323401024 controller.py:261]  eval | step:  280000 | eval time:  486.1 sec | output: 
    {'3': {'avg_iou': 0.49141234,
           'avg_obj': 0.21323034,
           'box_loss': 0.009717577,
           'class_loss': 0.0032180604,
           'conf_loss': 0.0184888,
           'precision50': 0.40866825,
           'recall50': 0.20489582},
     '4': {'avg_iou': 0.7032337,
           'avg_obj': 0.40793332,
           'box_loss': 0.009428045,
           'class_loss': 0.0033230195,
           'conf_loss': 0.01697981,
           'precision50': 0.6328104,
           'recall50': 0.43494603},
     '5': {'avg_iou': 0.7724805,
           'avg_obj': 0.5326479,
           'box_loss': 0.008708484,
           'class_loss': 0.003275566,
           'conf_loss': 0.013157486,
           'precision50': 0.7356164,
           'recall50': 0.5842499},
     'AP': 0.38063154,
     'AP50': 0.5860298,
     'AP75': 0.40696892,
     'APl': 0.52953464,
     'APm': 0.3941872,
     'APs': 0.17862375,
     'ARl': 0.6620008,
     'ARm': 0.5620937,
     'ARmax1': 0.31141672,
     'ARmax10': 0.4914485,
     'ARmax100': 0.53295624,
     'ARs': 0.3337392,
     'global': {'total_loss': 0.0862969},
     'validation_loss': 0.0862969}
I0517 04:14:43.263202 140269323401024 controller.py:211] train | step:  280000 | training until step 300000...
I0517 05:46:02.970415 140269323401024 controller.py:425] train | step:  290000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6566963,
           'avg_obj': 0.31199017,
           'box_loss': 0.013096551,
           'class_loss': 0.003982433,
           'conf_loss': 0.020339748,
           'precision50': 0.5446784,
           'recall50': 0.22341976},
     '4': {'avg_iou': 0.77600616,
           'avg_obj': 0.46351507,
           'box_loss': 0.009714316,
           'class_loss': 0.0030440455,
           'conf_loss': 0.017702233,
           'precision50': 0.7245018,
           'recall50': 0.44777226},
     '5': {'avg_iou': 0.8179371,
           'avg_obj': 0.56111497,
           'box_loss': 0.008000987,
           'class_loss': 0.00268631,
           'conf_loss': 0.012545683,
           'precision50': 0.78735524,
           'recall50': 0.5908032},
     'global': {'total_loss': 0.72889805},
     'learning_rate': 0.002887857,
     'training_loss': 0.72889805}
I0517 05:47:02.021355 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-290000.
I0517 07:21:32.126487 140269323401024 controller.py:425] train | step:  300000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6577917,
           'avg_obj': 0.31422484,
           'box_loss': 0.0130660115,
           'class_loss': 0.0039443285,
           'conf_loss': 0.02026398,
           'precision50': 0.5465023,
           'recall50': 0.22580469},
     '4': {'avg_iou': 0.7770291,
           'avg_obj': 0.46650255,
           'box_loss': 0.009652131,
           'class_loss': 0.0030075032,
           'conf_loss': 0.017641095,
           'precision50': 0.7259694,
           'recall50': 0.4514957},
     '5': {'avg_iou': 0.81903696,
           'avg_obj': 0.5638721,
           'box_loss': 0.007950429,
           'class_loss': 0.0026642026,
           'conf_loss': 0.012490319,
           'precision50': 0.7891852,
           'recall50': 0.5942472},
     'global': {'total_loss': 0.7254428},
     'learning_rate': 0.002685961,
     'training_loss': 0.7254428}
I0517 07:22:35.766814 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-300000.
I0517 07:22:35.773212 140269323401024 controller.py:252]  eval | step:  300000 | running 625 steps of evaluation...
I0517 07:26:55.995737 140269323401024 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0517 07:31:12.064828 140269323401024 controller.py:261]  eval | step:  300000 | eval time:  516.3 sec | output: 
    {'3': {'avg_iou': 0.49125415,
           'avg_obj': 0.21408132,
           'box_loss': 0.009724588,
           'class_loss': 0.0033092008,
           'conf_loss': 0.018633416,
           'precision50': 0.40834296,
           'recall50': 0.2064396},
     '4': {'avg_iou': 0.7029739,
           'avg_obj': 0.40991363,
           'box_loss': 0.00944323,
           'class_loss': 0.00336969,
           'conf_loss': 0.01719528,
           'precision50': 0.6295043,
           'recall50': 0.43937427},
     '5': {'avg_iou': 0.77236384,
           'avg_obj': 0.53442925,
           'box_loss': 0.008714007,
           'class_loss': 0.0032945313,
           'conf_loss': 0.013288478,
           'precision50': 0.7373074,
           'recall50': 0.5860495},
     'AP': 0.37810615,
     'AP50': 0.58228064,
     'AP75': 0.40406683,
     'APl': 0.52324915,
     'APm': 0.39151335,
     'APs': 0.17456438,
     'ARl': 0.6581868,
     'ARm': 0.55753183,
     'ARmax1': 0.31044394,
     'ARmax10': 0.4887648,
     'ARmax100': 0.52968264,
     'ARs': 0.32877612,
     'global': {'total_loss': 0.086972475},
     'validation_loss': 0.086972475}
I0517 07:31:33.612668 140269323401024 controller.py:211] train | step:  300000 | training until step 320000...
I0517 08:55:42.440968 140269323401024 controller.py:425] train | step:  310000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.65836155,
           'avg_obj': 0.31650752,
           'box_loss': 0.013018534,
           'class_loss': 0.0038991822,
           'conf_loss': 0.020119963,
           'precision50': 0.54703194,
           'recall50': 0.22773556},
     '4': {'avg_iou': 0.77816975,
           'avg_obj': 0.46880895,
           'box_loss': 0.009605844,
           'class_loss': 0.002975059,
           'conf_loss': 0.017506264,
           'precision50': 0.7270163,
           'recall50': 0.45421866},
     '5': {'avg_iou': 0.82011056,
           'avg_obj': 0.5660442,
           'box_loss': 0.007900235,
           'class_loss': 0.002631736,
           'conf_loss': 0.012410577,
           'precision50': 0.7892946,
           'recall50': 0.5964914},
     'global': {'total_loss': 0.7205382},
     'learning_rate': 0.0025079434,
     'training_loss': 0.7205382}

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-270000.
train | step:  280000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6557422,
           'avg_obj': 0.30962503,
           'box_loss': 0.013142487,
           'class_loss': 0.004010169,
           'conf_loss': 0.020388534,
           'precision50': 0.54164225,
           'recall50': 0.22044607},
     '4': {'avg_iou': 0.7749926,
           'avg_obj': 0.46093446,
           'box_loss': 0.009749268,
           'class_loss': 0.0030644117,
           'conf_loss': 0.017746586,
           'precision50': 0.72306645,
           'recall50': 0.44489458},
     '5': {'avg_iou': 0.8167176,
           'avg_obj': 0.5581113,
           'box_loss': 0.008053561,
           'class_loss': 0.002718023,
           'conf_loss': 0.012597248,
           'precision50': 0.7859891,
           'recall50': 0.5876785},
     'global': {'total_loss': 0.73176324},
     'learning_rate': 0.003112175,
     'training_loss': 0.73176324}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-280000.
 eval | step:  280000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=179.44s).
Accumulating evaluation results...
DONE (t=10.71s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.381
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.586
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.407
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.179
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.394
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.530
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.311
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.533
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.334
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.562
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.662
 eval | step:  280000 | eval time:  486.1 sec | output: 
    {'3': {'avg_iou': 0.49141234,
           'avg_obj': 0.21323034,
           'box_loss': 0.009717577,
           'class_loss': 0.0032180604,
           'conf_loss': 0.0184888,
           'precision50': 0.40866825,
           'recall50': 0.20489582},
     '4': {'avg_iou': 0.7032337,
           'avg_obj': 0.40793332,
           'box_loss': 0.009428045,
           'class_loss': 0.0033230195,
           'conf_loss': 0.01697981,
           'precision50': 0.6328104,
           'recall50': 0.43494603},
     '5': {'avg_iou': 0.7724805,
           'avg_obj': 0.5326479,
           'box_loss': 0.008708484,
           'class_loss': 0.003275566,
           'conf_loss': 0.013157486,
           'precision50': 0.7356164,
           'recall50': 0.5842499},
     'AP': 0.38063154,
     'AP50': 0.5860298,
     'AP75': 0.40696892,
     'APl': 0.52953464,
     'APm': 0.3941872,
     'APs': 0.17862375,
     'ARl': 0.6620008,
     'ARm': 0.5620937,
     'ARmax1': 0.31141672,
     'ARmax10': 0.4914485,
     'ARmax100': 0.53295624,
     'ARs': 0.3337392,
     'global': {'total_loss': 0.0862969},
     'validation_loss': 0.0862969}
train | step:  280000 | training until step 300000...
train | step:  290000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6566963,
           'avg_obj': 0.31199017,
           'box_loss': 0.013096551,
           'class_loss': 0.003982433,
           'conf_loss': 0.020339748,
           'precision50': 0.5446784,
           'recall50': 0.22341976},
     '4': {'avg_iou': 0.77600616,
           'avg_obj': 0.46351507,
           'box_loss': 0.009714316,
           'class_loss': 0.0030440455,
           'conf_loss': 0.017702233,
           'precision50': 0.7245018,
           'recall50': 0.44777226},
     '5': {'avg_iou': 0.8179371,
           'avg_obj': 0.56111497,
           'box_loss': 0.008000987,
           'class_loss': 0.00268631,
           'conf_loss': 0.012545683,
           'precision50': 0.78735524,
           'recall50': 0.5908032},
     'global': {'total_loss': 0.72889805},
     'learning_rate': 0.002887857,
     'training_loss': 0.72889805}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-290000.
train | step:  300000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6577917,
           'avg_obj': 0.31422484,
           'box_loss': 0.0130660115,
           'class_loss': 0.0039443285,
           'conf_loss': 0.02026398,
           'precision50': 0.5465023,
           'recall50': 0.22580469},
     '4': {'avg_iou': 0.7770291,
           'avg_obj': 0.46650255,
           'box_loss': 0.009652131,
           'class_loss': 0.0030075032,
           'conf_loss': 0.017641095,
           'precision50': 0.7259694,
           'recall50': 0.4514957},
     '5': {'avg_iou': 0.81903696,
           'avg_obj': 0.5638721,
           'box_loss': 0.007950429,
           'class_loss': 0.0026642026,
           'conf_loss': 0.012490319,
           'precision50': 0.7891852,
           'recall50': 0.5942472},
     'global': {'total_loss': 0.7254428},
     'learning_rate': 0.002685961,
     'training_loss': 0.7254428}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-300000.
 eval | step:  300000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=184.78s).
Accumulating evaluation results...
DONE (t=10.34s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.378
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.582
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.404
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.175
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.392
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.523
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.310
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.489
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.530
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.329
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.558
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.658
 eval | step:  300000 | eval time:  516.3 sec | output: 
    {'3': {'avg_iou': 0.49125415,
           'avg_obj': 0.21408132,
           'box_loss': 0.009724588,
           'class_loss': 0.0033092008,
           'conf_loss': 0.018633416,
           'precision50': 0.40834296,
           'recall50': 0.2064396},
     '4': {'avg_iou': 0.7029739,
           'avg_obj': 0.40991363,
           'box_loss': 0.00944323,
           'class_loss': 0.00336969,
           'conf_loss': 0.01719528,
           'precision50': 0.6295043,
           'recall50': 0.43937427},
     '5': {'avg_iou': 0.77236384,
           'avg_obj': 0.53442925,
           'box_loss': 0.008714007,
           'class_loss': 0.0032945313,
           'conf_loss': 0.013288478,
           'precision50': 0.7373074,
           'recall50': 0.5860495},
     'AP': 0.37810615,
     'AP50': 0.58228064,
     'AP75': 0.40406683,
     'APl': 0.52324915,
     'APm': 0.39151335,
     'APs': 0.17456438,
     'ARl': 0.6581868,
     'ARm': 0.55753183,
     'ARmax1': 0.31044394,
     'ARmax10': 0.4887648,
     'ARmax100': 0.52968264,
     'ARs': 0.32877612,
     'global': {'total_loss': 0.086972475},
     'validation_loss': 0.086972475}
train | step:  300000 | training until step 320000...
train | step:  310000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.65836155,
           'avg_obj': 0.31650752,
           'box_loss': 0.013018534,
           'class_loss': 0.0038991822,
           'conf_loss': 0.020119963,
           'precision50': 0.54703194,
           'recall50': 0.22773556},
     '4': {'avg_iou': 0.77816975,
           'avg_obj': 0.46880895,
           'box_loss': 0.009605844,
           'class_loss': 0.002975059,
           'conf_loss': 0.017506264,
           'precision50': 0.7270163,
           'recall50': 0.45421866},
     '5': {'avg_iou': 0.82011056,
           'avg_obj': 0.5660442,
           'box_loss': 0.007900235,
           'class_loss': 0.002631736,
           'conf_loss': 0.012410577,
           'precision50': 0.7892946,
           'recall50': 0.5964914},
     'global': {'total_loss': 0.7205382},
     'learning_rate': 0.0025079434,
     'training_loss': 0.7205382}I0517 08:56:40.950080 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-310000.
I0517 10:24:36.026344 140269323401024 controller.py:425] train | step:  320000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.65918624,
           'avg_obj': 0.31848547,
           'box_loss': 0.013003206,
           'class_loss': 0.0038793804,
           'conf_loss': 0.020094493,
           'precision50': 0.548934,
           'recall50': 0.23009458},
     '4': {'avg_iou': 0.7789092,
           'avg_obj': 0.47135255,
           'box_loss': 0.009578409,
           'class_loss': 0.002953365,
           'conf_loss': 0.017440425,
           'precision50': 0.7280884,
           'recall50': 0.45673344},
     '5': {'avg_iou': 0.82087225,
           'avg_obj': 0.5688619,
           'box_loss': 0.007862132,
           'class_loss': 0.0026155293,
           'conf_loss': 0.012336106,
           'precision50': 0.7901602,
           'recall50': 0.59916013},
     'global': {'total_loss': 0.71810615},
     'learning_rate': 0.002355086,
     'training_loss': 0.71810615}
I0517 10:25:36.656557 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-320000.
I0517 10:25:36.664426 140269323401024 controller.py:252]  eval | step:  320000 | running 625 steps of evaluation...
I0517 10:29:54.732445 140269323401024 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0517 10:34:02.365324 140269323401024 controller.py:261]  eval | step:  320000 | eval time:  505.7 sec | output: 
    {'3': {'avg_iou': 0.4909125,
           'avg_obj': 0.21419431,
           'box_loss': 0.009744397,
           'class_loss': 0.0033077057,
           'conf_loss': 0.018798249,
           'precision50': 0.4091124,
           'recall50': 0.20804414},
     '4': {'avg_iou': 0.7025549,
           'avg_obj': 0.41014096,
           'box_loss': 0.009464417,
           'class_loss': 0.0034024902,
           'conf_loss': 0.01740762,
           'precision50': 0.6277449,
           'recall50': 0.43997377},
     '5': {'avg_iou': 0.77246016,
           'avg_obj': 0.53529286,
           'box_loss': 0.008707552,
           'class_loss': 0.0033051083,
           'conf_loss': 0.013423296,
           'precision50': 0.7359418,
           'recall50': 0.5836612},
     'AP': 0.37880152,
     'AP50': 0.5819308,
     'AP75': 0.40571362,
     'APl': 0.52839166,
     'APm': 0.39068255,
     'APs': 0.17711866,
     'ARl': 0.66065687,
     'ARm': 0.55540633,
     'ARmax1': 0.31058347,
     'ARmax10': 0.48942888,
     'ARmax100': 0.5294176,
     'ARs': 0.33413094,
     'global': {'total_loss': 0.087560825},
     'validation_loss': 0.087560825}
I0517 10:34:21.392542 140269323401024 controller.py:211] train | step:  320000 | training until step 340000...
I0517 11:56:24.940055 140269323401024 controller.py:425] train | step:  330000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.66060495,
           'avg_obj': 0.32041094,
           'box_loss': 0.012955434,
           'class_loss': 0.0038443524,
           'conf_loss': 0.02005448,
           'precision50': 0.55085856,
           'recall50': 0.23229565},
     '4': {'avg_iou': 0.7798241,
           'avg_obj': 0.4737389,
           'box_loss': 0.009534379,
           'class_loss': 0.002923327,
           'conf_loss': 0.017394044,
           'precision50': 0.72941834,
           'recall50': 0.45963597},
     '5': {'avg_iou': 0.821512,
           'avg_obj': 0.57068783,
           'box_loss': 0.007832721,
           'class_loss': 0.0025910002,
           'conf_loss': 0.012290661,
           'precision50': 0.79154676,
           'recall50': 0.6015451},
     'global': {'total_loss': 0.71536374},
     'learning_rate': 0.0022284898,
     'training_loss': 0.71536374}
I0517 11:57:25.570793 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-330000.
I0517 13:24:04.484373 140269323401024 controller.py:425] train | step:  340000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.66049284,
           'avg_obj': 0.32218617,
           'box_loss': 0.012950527,
           'class_loss': 0.0038263223,
           'conf_loss': 0.020001844,
           'precision50': 0.55257535,
           'recall50': 0.23420474},
     '4': {'avg_iou': 0.7803915,
           'avg_obj': 0.47561514,
           'box_loss': 0.009502991,
           'class_loss': 0.002896957,
           'conf_loss': 0.017342927,
           'precision50': 0.7307413,
           'recall50': 0.462352},
     '5': {'avg_iou': 0.82243955,
           'avg_obj': 0.572807,
           'box_loss': 0.0077853897,
           'class_loss': 0.002565046,
           'conf_loss': 0.012254084,
           'precision50': 0.7913733,
           'recall50': 0.6030797},
     'global': {'total_loss': 0.7130094},
     'learning_rate': 0.0021290681,
     'training_loss': 0.7130094}
I0517 13:25:03.483629 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-340000.
I0517 13:25:03.490762 140269323401024 controller.py:252]  eval | step:  340000 | running 625 steps of evaluation...
I0517 13:29:10.695540 140269323401024 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0517 13:33:13.266770 140269323401024 controller.py:261]  eval | step:  340000 | eval time:  489.8 sec | output: 
    {'3': {'avg_iou': 0.49024233,
           'avg_obj': 0.21495478,
           'box_loss': 0.009777885,
           'class_loss': 0.0033127929,
           'conf_loss': 0.018928353,
           'precision50': 0.4076048,
           'recall50': 0.20938244},
     '4': {'avg_iou': 0.7020517,
           'avg_obj': 0.4101008,
           'box_loss': 0.009491884,
           'class_loss': 0.0034397317,
           'conf_loss': 0.01757978,
           'precision50': 0.62687194,
           'recall50': 0.43981454},
     '5': {'avg_iou': 0.77233714,
           'avg_obj': 0.53590053,
           'box_loss': 0.008715815,
           'class_loss': 0.0033631912,
           'conf_loss': 0.013538459,
           'precision50': 0.73307526,
           'recall50': 0.5851791},
     'AP': 0.37850177,
     'AP50': 0.5817748,
     'AP75': 0.40491858,
     'APl': 0.52899706,
     'APm': 0.3908752,
     'APs': 0.17853057,
     'ARl': 0.6563507,
     'ARm': 0.55096793,
     'ARmax1': 0.3096508,
     'ARmax10': 0.4875264,
     'ARmax100': 0.5267798,
     'ARs': 0.3324429,
     'global': {'total_loss': 0.0881479},
     'validation_loss': 0.0881479}
I0517 13:33:36.439147 140269323401024 controller.py:211] train | step:  340000 | training until step 360000...
I0517 14:55:01.263016 140269323401024 controller.py:425] train | step:  350000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6614206,
           'avg_obj': 0.32421657,
           'box_loss': 0.012909796,
           'class_loss': 0.0037969442,
           'conf_loss': 0.019913085,
           'precision50': 0.55425555,
           'recall50': 0.23665115},
     '4': {'avg_iou': 0.7813082,
           'avg_obj': 0.4779476,
           'box_loss': 0.009460206,
           'class_loss': 0.0028782424,
           'conf_loss': 0.017243175,
           'precision50': 0.7316651,
           'recall50': 0.46493462},
     '5': {'avg_iou': 0.8229153,
           'avg_obj': 0.574597,
           'box_loss': 0.0077617583,
           'class_loss': 0.0025498876,
           'conf_loss': 0.012182159,
           'precision50': 0.7921846,
           'recall50': 0.60515},
     'global': {'total_loss': 0.7095621},
     'learning_rate': 0.0020575363,
     'training_loss': 0.7095621}

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-310000.
train | step:  320000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.65918624,
           'avg_obj': 0.31848547,
           'box_loss': 0.013003206,
           'class_loss': 0.0038793804,
           'conf_loss': 0.020094493,
           'precision50': 0.548934,
           'recall50': 0.23009458},
     '4': {'avg_iou': 0.7789092,
           'avg_obj': 0.47135255,
           'box_loss': 0.009578409,
           'class_loss': 0.002953365,
           'conf_loss': 0.017440425,
           'precision50': 0.7280884,
           'recall50': 0.45673344},
     '5': {'avg_iou': 0.82087225,
           'avg_obj': 0.5688619,
           'box_loss': 0.007862132,
           'class_loss': 0.0026155293,
           'conf_loss': 0.012336106,
           'precision50': 0.7901602,
           'recall50': 0.59916013},
     'global': {'total_loss': 0.71810615},
     'learning_rate': 0.002355086,
     'training_loss': 0.71810615}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-320000.
 eval | step:  320000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=180.14s).
Accumulating evaluation results...
DONE (t=12.02s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.379
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.582
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.406
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.177
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.391
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.528
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.311
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.489
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.529
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.334
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.555
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.661
 eval | step:  320000 | eval time:  505.7 sec | output: 
    {'3': {'avg_iou': 0.4909125,
           'avg_obj': 0.21419431,
           'box_loss': 0.009744397,
           'class_loss': 0.0033077057,
           'conf_loss': 0.018798249,
           'precision50': 0.4091124,
           'recall50': 0.20804414},
     '4': {'avg_iou': 0.7025549,
           'avg_obj': 0.41014096,
           'box_loss': 0.009464417,
           'class_loss': 0.0034024902,
           'conf_loss': 0.01740762,
           'precision50': 0.6277449,
           'recall50': 0.43997377},
     '5': {'avg_iou': 0.77246016,
           'avg_obj': 0.53529286,
           'box_loss': 0.008707552,
           'class_loss': 0.0033051083,
           'conf_loss': 0.013423296,
           'precision50': 0.7359418,
           'recall50': 0.5836612},
     'AP': 0.37880152,
     'AP50': 0.5819308,
     'AP75': 0.40571362,
     'APl': 0.52839166,
     'APm': 0.39068255,
     'APs': 0.17711866,
     'ARl': 0.66065687,
     'ARm': 0.55540633,
     'ARmax1': 0.31058347,
     'ARmax10': 0.48942888,
     'ARmax100': 0.5294176,
     'ARs': 0.33413094,
     'global': {'total_loss': 0.087560825},
     'validation_loss': 0.087560825}
train | step:  320000 | training until step 340000...
train | step:  330000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.66060495,
           'avg_obj': 0.32041094,
           'box_loss': 0.012955434,
           'class_loss': 0.0038443524,
           'conf_loss': 0.02005448,
           'precision50': 0.55085856,
           'recall50': 0.23229565},
     '4': {'avg_iou': 0.7798241,
           'avg_obj': 0.4737389,
           'box_loss': 0.009534379,
           'class_loss': 0.002923327,
           'conf_loss': 0.017394044,
           'precision50': 0.72941834,
           'recall50': 0.45963597},
     '5': {'avg_iou': 0.821512,
           'avg_obj': 0.57068783,
           'box_loss': 0.007832721,
           'class_loss': 0.0025910002,
           'conf_loss': 0.012290661,
           'precision50': 0.79154676,
           'recall50': 0.6015451},
     'global': {'total_loss': 0.71536374},
     'learning_rate': 0.0022284898,
     'training_loss': 0.71536374}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-330000.
train | step:  340000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.66049284,
           'avg_obj': 0.32218617,
           'box_loss': 0.012950527,
           'class_loss': 0.0038263223,
           'conf_loss': 0.020001844,
           'precision50': 0.55257535,
           'recall50': 0.23420474},
     '4': {'avg_iou': 0.7803915,
           'avg_obj': 0.47561514,
           'box_loss': 0.009502991,
           'class_loss': 0.002896957,
           'conf_loss': 0.017342927,
           'precision50': 0.7307413,
           'recall50': 0.462352},
     '5': {'avg_iou': 0.82243955,
           'avg_obj': 0.572807,
           'box_loss': 0.0077853897,
           'class_loss': 0.002565046,
           'conf_loss': 0.012254084,
           'precision50': 0.7913733,
           'recall50': 0.6030797},
     'global': {'total_loss': 0.7130094},
     'learning_rate': 0.0021290681,
     'training_loss': 0.7130094}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-340000.
 eval | step:  340000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=179.65s).
Accumulating evaluation results...
DONE (t=9.88s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.379
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.582
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.405
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.179
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.391
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.529
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.310
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.488
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.527
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.332
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.551
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.656
 eval | step:  340000 | eval time:  489.8 sec | output: 
    {'3': {'avg_iou': 0.49024233,
           'avg_obj': 0.21495478,
           'box_loss': 0.009777885,
           'class_loss': 0.0033127929,
           'conf_loss': 0.018928353,
           'precision50': 0.4076048,
           'recall50': 0.20938244},
     '4': {'avg_iou': 0.7020517,
           'avg_obj': 0.4101008,
           'box_loss': 0.009491884,
           'class_loss': 0.0034397317,
           'conf_loss': 0.01757978,
           'precision50': 0.62687194,
           'recall50': 0.43981454},
     '5': {'avg_iou': 0.77233714,
           'avg_obj': 0.53590053,
           'box_loss': 0.008715815,
           'class_loss': 0.0033631912,
           'conf_loss': 0.013538459,
           'precision50': 0.73307526,
           'recall50': 0.5851791},
     'AP': 0.37850177,
     'AP50': 0.5817748,
     'AP75': 0.40491858,
     'APl': 0.52899706,
     'APm': 0.3908752,
     'APs': 0.17853057,
     'ARl': 0.6563507,
     'ARm': 0.55096793,
     'ARmax1': 0.3096508,
     'ARmax10': 0.4875264,
     'ARmax100': 0.5267798,
     'ARs': 0.3324429,
     'global': {'total_loss': 0.0881479},
     'validation_loss': 0.0881479}
train | step:  340000 | training until step 360000...
train | step:  350000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6614206,
           'avg_obj': 0.32421657,
           'box_loss': 0.012909796,
           'class_loss': 0.0037969442,
           'conf_loss': 0.019913085,
           'precision50': 0.55425555,
           'recall50': 0.23665115},
     '4': {'avg_iou': 0.7813082,
           'avg_obj': 0.4779476,
           'box_loss': 0.009460206,
           'class_loss': 0.0028782424,
           'conf_loss': 0.017243175,
           'precision50': 0.7316651,
           'recall50': 0.46493462},
     '5': {'avg_iou': 0.8229153,
           'avg_obj': 0.574597,
           'box_loss': 0.0077617583,
           'class_loss': 0.0025498876,
           'conf_loss': 0.012182159,
           'precision50': 0.7921846,
           'recall50': 0.60515},
     'global': {'total_loss': 0.7095621},
     'learning_rate': 0.0020575363,
     'training_loss': 0.7095621}I0517 14:55:59.522413 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-350000.
I0517 16:23:26.877704 140269323401024 controller.py:425] train | step:  360000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6617823,
           'avg_obj': 0.3251982,
           'box_loss': 0.012887902,
           'class_loss': 0.0037680122,
           'conf_loss': 0.019866277,
           'precision50': 0.5549947,
           'recall50': 0.23772505},
     '4': {'avg_iou': 0.781702,
           'avg_obj': 0.4790772,
           'box_loss': 0.009453772,
           'class_loss': 0.002864659,
           'conf_loss': 0.017229794,
           'precision50': 0.73291713,
           'recall50': 0.46663135},
     '5': {'avg_iou': 0.8233586,
           'avg_obj': 0.57589865,
           'box_loss': 0.007747656,
           'class_loss': 0.002537951,
           'conf_loss': 0.01217603,
           'precision50': 0.7929917,
           'recall50': 0.60638636},
     'global': {'total_loss': 0.70825666},
     'learning_rate': 0.00201441,
     'training_loss': 0.70825666}
I0517 16:24:25.517926 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-360000.
I0517 16:24:25.524680 140269323401024 controller.py:252]  eval | step:  360000 | running 625 steps of evaluation...
I0517 16:28:39.822783 140269323401024 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0517 16:32:45.670405 140269323401024 controller.py:261]  eval | step:  360000 | eval time:  500.1 sec | output: 
    {'3': {'avg_iou': 0.48963794,
           'avg_obj': 0.2148396,
           'box_loss': 0.009811223,
           'class_loss': 0.0033748513,
           'conf_loss': 0.019131267,
           'precision50': 0.4082117,
           'recall50': 0.21006487},
     '4': {'avg_iou': 0.70155597,
           'avg_obj': 0.41005355,
           'box_loss': 0.009517789,
           'class_loss': 0.0035081794,
           'conf_loss': 0.017803852,
           'precision50': 0.62624544,
           'recall50': 0.4406856},
     '5': {'avg_iou': 0.7716066,
           'avg_obj': 0.5368995,
           'box_loss': 0.008752713,
           'class_loss': 0.003414479,
           'conf_loss': 0.013643262,
           'precision50': 0.7354018,
           'recall50': 0.58707744},
     'AP': 0.37579492,
     'AP50': 0.5769904,
     'AP75': 0.40372887,
     'APl': 0.52352756,
     'APm': 0.3874166,
     'APs': 0.17664267,
     'ARl': 0.65041846,
     'ARm': 0.5499561,
     'ARmax1': 0.3093719,
     'ARmax10': 0.48476616,
     'ARmax100': 0.52397424,
     'ARs': 0.3250141,
     'global': {'total_loss': 0.088957645},
     'validation_loss': 0.088957645}
I0517 16:33:09.365218 140269323401024 controller.py:211] train | step:  360000 | training until step 375000...
I0517 17:55:15.611520 140269323401024 controller.py:425] train | step:  370000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6623463,
           'avg_obj': 0.3270475,
           'box_loss': 0.012879852,
           'class_loss': 0.0037600822,
           'conf_loss': 0.019810336,
           'precision50': 0.5571845,
           'recall50': 0.23980305},
     '4': {'avg_iou': 0.78220963,
           'avg_obj': 0.4808238,
           'box_loss': 0.009422326,
           'class_loss': 0.002857997,
           'conf_loss': 0.01715556,
           'precision50': 0.7332707,
           'recall50': 0.46830836},
     '5': {'avg_iou': 0.82390887,
           'avg_obj': 0.57753235,
           'box_loss': 0.007710556,
           'class_loss': 0.0025156667,
           'conf_loss': 0.012109301,
           'precision50': 0.7931448,
           'recall50': 0.60811156},
     'global': {'total_loss': 0.7057734},
     'learning_rate': 0.002,
     'training_loss': 0.7057734}
I0517 17:56:17.667988 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-370000.
I0517 18:39:45.629865 140269323401024 controller.py:425] train | step:  375000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.66265327,
           'avg_obj': 0.3276498,
           'box_loss': 0.0128712375,
           'class_loss': 0.003763439,
           'conf_loss': 0.019845236,
           'precision50': 0.5570081,
           'recall50': 0.240033},
     '4': {'avg_iou': 0.782454,
           'avg_obj': 0.48116866,
           'box_loss': 0.009408384,
           'class_loss': 0.0028525924,
           'conf_loss': 0.017184436,
           'precision50': 0.7333175,
           'recall50': 0.4685821},
     '5': {'avg_iou': 0.82413465,
           'avg_obj': 0.57776463,
           'box_loss': 0.007706157,
           'class_loss': 0.0025193738,
           'conf_loss': 0.012125875,
           'precision50': 0.7940019,
           'recall50': 0.60884637},
     'global': {'total_loss': 0.7062148},
     'learning_rate': 0.002,
     'training_loss': 0.7062148}
I0517 18:39:59.072265 140269323401024 controller.py:252]  eval | step:  375000 | running 625 steps of evaluation...
I0517 18:44:12.248984 140269323401024 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0517 18:48:10.094930 140269323401024 controller.py:261]  eval | step:  375000 | eval time:  491.0 sec | output: 
    {'3': {'avg_iou': 0.48965624,
           'avg_obj': 0.215226,
           'box_loss': 0.009810958,
           'class_loss': 0.003411877,
           'conf_loss': 0.019174065,
           'precision50': 0.40788296,
           'recall50': 0.21082021},
     '4': {'avg_iou': 0.70128787,
           'avg_obj': 0.4109664,
           'box_loss': 0.009531065,
           'class_loss': 0.0035058525,
           'conf_loss': 0.017894683,
           'precision50': 0.62719464,
           'recall50': 0.44040996},
     '5': {'avg_iou': 0.77196497,
           'avg_obj': 0.5375367,
           'box_loss': 0.008734995,
           'class_loss': 0.0034293698,
           'conf_loss': 0.013699825,
           'precision50': 0.733182,
           'recall50': 0.58812356},
     'AP': 0.37608615,
     'AP50': 0.5775233,
     'AP75': 0.40302053,
     'APl': 0.5232113,
     'APm': 0.38635933,
     'APs': 0.174342,
     'ARl': 0.6511512,
     'ARm': 0.5492555,
     'ARmax1': 0.30988866,
     'ARmax10': 0.4851045,
     'ARmax100': 0.5231363,
     'ARs': 0.32585895,
     'global': {'total_loss': 0.08919268},
     'validation_loss': 0.08919268}
I0517 18:49:13.787132 140269323401024 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-375000.
I0517 18:49:13.801618 140269323401024 train_lib.py:123] Number of trainable params in model: 85.486272 Millions.

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-350000.
train | step:  360000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6617823,
           'avg_obj': 0.3251982,
           'box_loss': 0.012887902,
           'class_loss': 0.0037680122,
           'conf_loss': 0.019866277,
           'precision50': 0.5549947,
           'recall50': 0.23772505},
     '4': {'avg_iou': 0.781702,
           'avg_obj': 0.4790772,
           'box_loss': 0.009453772,
           'class_loss': 0.002864659,
           'conf_loss': 0.017229794,
           'precision50': 0.73291713,
           'recall50': 0.46663135},
     '5': {'avg_iou': 0.8233586,
           'avg_obj': 0.57589865,
           'box_loss': 0.007747656,
           'class_loss': 0.002537951,
           'conf_loss': 0.01217603,
           'precision50': 0.7929917,
           'recall50': 0.60638636},
     'global': {'total_loss': 0.70825666},
     'learning_rate': 0.00201441,
     'training_loss': 0.70825666}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-360000.
 eval | step:  360000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=179.57s).
Accumulating evaluation results...
DONE (t=9.70s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.376
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.577
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.404
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.177
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.387
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.524
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.309
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.524
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.325
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.550
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.650
 eval | step:  360000 | eval time:  500.1 sec | output: 
    {'3': {'avg_iou': 0.48963794,
           'avg_obj': 0.2148396,
           'box_loss': 0.009811223,
           'class_loss': 0.0033748513,
           'conf_loss': 0.019131267,
           'precision50': 0.4082117,
           'recall50': 0.21006487},
     '4': {'avg_iou': 0.70155597,
           'avg_obj': 0.41005355,
           'box_loss': 0.009517789,
           'class_loss': 0.0035081794,
           'conf_loss': 0.017803852,
           'precision50': 0.62624544,
           'recall50': 0.4406856},
     '5': {'avg_iou': 0.7716066,
           'avg_obj': 0.5368995,
           'box_loss': 0.008752713,
           'class_loss': 0.003414479,
           'conf_loss': 0.013643262,
           'precision50': 0.7354018,
           'recall50': 0.58707744},
     'AP': 0.37579492,
     'AP50': 0.5769904,
     'AP75': 0.40372887,
     'APl': 0.52352756,
     'APm': 0.3874166,
     'APs': 0.17664267,
     'ARl': 0.65041846,
     'ARm': 0.5499561,
     'ARmax1': 0.3093719,
     'ARmax10': 0.48476616,
     'ARmax100': 0.52397424,
     'ARs': 0.3250141,
     'global': {'total_loss': 0.088957645},
     'validation_loss': 0.088957645}
train | step:  360000 | training until step 375000...
train | step:  370000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6623463,
           'avg_obj': 0.3270475,
           'box_loss': 0.012879852,
           'class_loss': 0.0037600822,
           'conf_loss': 0.019810336,
           'precision50': 0.5571845,
           'recall50': 0.23980305},
     '4': {'avg_iou': 0.78220963,
           'avg_obj': 0.4808238,
           'box_loss': 0.009422326,
           'class_loss': 0.002857997,
           'conf_loss': 0.01715556,
           'precision50': 0.7332707,
           'recall50': 0.46830836},
     '5': {'avg_iou': 0.82390887,
           'avg_obj': 0.57753235,
           'box_loss': 0.007710556,
           'class_loss': 0.0025156667,
           'conf_loss': 0.012109301,
           'precision50': 0.7931448,
           'recall50': 0.60811156},
     'global': {'total_loss': 0.7057734},
     'learning_rate': 0.002,
     'training_loss': 0.7057734}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-370000.
train | step:  375000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.66265327,
           'avg_obj': 0.3276498,
           'box_loss': 0.0128712375,
           'class_loss': 0.003763439,
           'conf_loss': 0.019845236,
           'precision50': 0.5570081,
           'recall50': 0.240033},
     '4': {'avg_iou': 0.782454,
           'avg_obj': 0.48116866,
           'box_loss': 0.009408384,
           'class_loss': 0.0028525924,
           'conf_loss': 0.017184436,
           'precision50': 0.7333175,
           'recall50': 0.4685821},
     '5': {'avg_iou': 0.82413465,
           'avg_obj': 0.57776463,
           'box_loss': 0.007706157,
           'class_loss': 0.0025193738,
           'conf_loss': 0.012125875,
           'precision50': 0.7940019,
           'recall50': 0.60884637},
     'global': {'total_loss': 0.7062148},
     'learning_rate': 0.002,
     'training_loss': 0.7062148}
 eval | step:  375000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=178.42s).
Accumulating evaluation results...
DONE (t=9.39s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.376
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.578
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.403
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.174
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.386
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.523
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.310
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.523
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.326
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.549
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.651
 eval | step:  375000 | eval time:  491.0 sec | output: 
    {'3': {'avg_iou': 0.48965624,
           'avg_obj': 0.215226,
           'box_loss': 0.009810958,
           'class_loss': 0.003411877,
           'conf_loss': 0.019174065,
           'precision50': 0.40788296,
           'recall50': 0.21082021},
     '4': {'avg_iou': 0.70128787,
           'avg_obj': 0.4109664,
           'box_loss': 0.009531065,
           'class_loss': 0.0035058525,
           'conf_loss': 0.017894683,
           'precision50': 0.62719464,
           'recall50': 0.44040996},
     '5': {'avg_iou': 0.77196497,
           'avg_obj': 0.5375367,
           'box_loss': 0.008734995,
           'class_loss': 0.0034293698,
           'conf_loss': 0.013699825,
           'precision50': 0.733182,
           'recall50': 0.58812356},
     'AP': 0.37608615,
     'AP50': 0.5775233,
     'AP75': 0.40302053,
     'APl': 0.5232113,
     'APm': 0.38635933,
     'APs': 0.174342,
     'ARl': 0.6511512,
     'ARm': 0.5492555,
     'ARmax1': 0.30988866,
     'ARmax10': 0.4851045,
     'ARmax100': 0.5231363,
     'ARs': 0.32585895,
     'global': {'total_loss': 0.08919268},
     'validation_loss': 0.08919268}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-11/ckpt-375000.
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     12   1316 --:--:-- --:--:-- --:--:--  1329
okRequest issued for: [node-4]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-17T18:55:09.104590663Z'
  endTime: '2021-05-17T18:55:45.634673630Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621277709086-5c28b21eeb113-61832033-428b94d2
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.117.66.216/29
  createTime: '2021-03-13T04:41:22.291533178Z'
  health: HEALTHY
  ipAddress: 10.117.66.218
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.117.66.218
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621277709086-5c28b21eeb113-61832033-428b94d2] to complete...
...............................................................................................................................................................................................done.
/home/cam2tensorflow/.experiment_start.sh: line 22:  6080 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4-$5
/home/cam2tensorflow/.experiment_start.sh: line 22:  6388 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4-$5
/home/cam2tensorflow/.experiment_start.sh: line 22:  5802 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4-$5
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0/home/cam2tensorflow/.experiment_start.sh: line 22:  6836 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4-$5
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208      7    745 --:--:-- --:--:-- --:--:--   752
ok100   210    0     2  100   208      8    866 --:--:-- --:--:-- --:--:--   875
ok100   210    0     2  100   208      9    936 --:--:-- --:--:-- --:--:--   945
ok100   210    0     2  100   208      7    750 --:--:-- --:--:-- --:--:--   758
okRequest issued for: [node-3]
Request issued for: [node-5]
Request issued for: [node-5]
ERROR: (gcloud.compute.tpus.stop) ABORTED: unable to queue the operation
- '@type': type.googleapis.com/google.rpc.ResourceInfo
  resourceName: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
/home/cam2tensorflow/.experiment_start.sh: line 22:  6219 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4-$5
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     12   1268 --:--:-- --:--:-- --:--:--  1280
okERROR: (gcloud.compute.tpus.stop) ABORTED: unable to queue the operation
- '@type': type.googleapis.com/google.rpc.ResourceInfo
  resourceName: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-17T19:16:45.314621265Z'
  endTime: '2021-05-17T19:16:56.590835279Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621279005296-5c28b6f314847-14423e9a-aea5a10e
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621279005296-5c28b6f314847-14423e9a-aea5a10e] to complete...
..............................................................done.
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-17T19:16:45.298508014Z'
  endTime: '2021-05-17T19:17:07.499621852Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621279005286-5c28b6f311faf-f1b659ac-a82fa6cd
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621279005286-5c28b6f311faf-f1b659ac-a82fa6cd] to complete...
.................................................................................................................................done.
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-17T19:16:45.343499288Z'
  endTime: '2021-05-17T19:17:07.828662416Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621279005307-5c28b6f317193-5fe4238e-2338dff7
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621279005307-5c28b6f317193-5fe4238e-2338dff7] to complete...
.......................................................................................................................................done.
