cat: .experiment_zone: No such file or directory
Request issued for: [node-5]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-30T20:00:05.078716897Z'
  endTime: '2021-04-30T20:00:39.237521512Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619812805062-5c1360ed930f7-01b50b02-45bcc3be
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619812805062-5c1360ed930f7-01b50b02-45bcc3be] to complete...
.........................................................................................................................................................................................done.
europe-west4-a
I0430 19:57:20.333247 140262404466496 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.2,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.3,
                                         'aug_scale_max': 2.0,
                                         'aug_scale_min': 0.1,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [400000,
                                                                                450000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.001,
                                                                            0.0001,
                                                                            1e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 500000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0430 19:57:20.335095 140262404466496 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/params.yaml
I0430 19:57:21.933534 140262404466496 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0430 19:57:22.075777 140262404466496 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0430 19:57:22.076115 140262404466496 transport.py:157] Attempting refresh to obtain initial access_token
I0430 19:57:22.142061 140262404466496 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0430 19:57:22.761398 140262404466496 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0430 19:57:22.761728 140262404466496 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-30 19:57:22.820103: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0430 19:57:22.820752 140262404466496 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0430 19:57:22.967084 140262404466496 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0430 19:57:22.967360 140262404466496 transport.py:157] Attempting refresh to obtain initial access_token
I0430 19:57:23.033567 140262404466496 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0430 19:57:23.180095 140262404466496 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0430 19:57:23.180368 140262404466496 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-30 19:57:23.230854: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-30 19:57:23.249980: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.56.217.90:8470}
2021-04-30 19:57:23.250060: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:47129}
2021-04-30 19:58:05.709432: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.56.217.90:8470}
2021-04-30 19:58:05.709555: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:47129}
2021-04-30 19:58:05.710707: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:47129
I0430 19:58:05.711863 140262404466496 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-5
I0430 19:58:05.715979 140262404466496 tpu_strategy_util.py:74] Initializing the TPU system: node-5
INFO:tensorflow:Clearing out eager caches
I0430 19:58:14.257829 140262404466496 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0430 19:58:14.260286 140262404466496 tpu_strategy_util.py:133] Finished initializing TPU system.
I0430 19:58:14.261877 140262404466496 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0430 19:58:14.409603 140262404466496 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0430 19:58:14.409902 140262404466496 transport.py:157] Attempting refresh to obtain initial access_token
I0430 19:58:14.478151 140262404466496 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0430 19:58:14.631493 140262404466496 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0430 19:58:14.631783 140262404466496 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0430 19:58:14.679598 140262404466496 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0430 19:58:14.679889 140262404466496 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0430 19:58:14.680190 140262404466496 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0430 19:58:14.680275 140262404466496 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0430 19:58:14.680338 140262404466496 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0430 19:58:14.680536 140262404466496 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0430 19:58:14.680587 140262404466496 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0430 19:58:14.680645 140262404466496 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0430 19:58:14.680693 140262404466496 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0430 19:58:14.680739 140262404466496 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0430 19:58:14.680815 140262404466496 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0430 19:58:14.681066 140262404466496 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0430 19:58:14.681118 140262404466496 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0430 19:58:14.681172 140262404466496 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0430 19:58:14.681219 140262404466496 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0430 19:58:14.681286 140262404466496 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0430 19:58:14.682788 140262404466496 train_utils.py:214] Running default trainer.
2021-04-30 19:58:14.704541: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.2, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.3, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [400000, 450000], 'values': [0.001, 0.0001, 1e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 500000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f90fe80a908>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________
yolo_fpn (YoloFPN)              {'5': (None, 16, 16, 9626112     input_2[0][0]                    
                                                                 input_3[0][0]                    I0430 19:59:05.423122 140262404466496 controller.py:362] restoring or initializing model...
I0430 19:59:13.907190 140262404466496 yolo.py:542] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0430 19:59:13.909623 140262404466496 controller.py:368] initialized model.
I0430 19:59:13.909947 140262404466496 train_lib.py:96] Starts to execute mode: train_and_eval
I0430 19:59:13.915163 140262404466496 controller.py:211] train | step:      0 | training until step 20000...
I0430 19:59:21.574136 140262404466496 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0430 20:00:31.988984 140262404466496 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0430 21:10:01.166350 140262404466496 controller.py:425] train | step:  10000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.92178065,
           'avg_obj': 0.14123882,
           'box_loss': 6.6346025,
           'class_loss': 22.721704,
           'conf_loss': 201.11208,
           'precision50': 0.16506556,
           'recall50': 0.073124945},
     '4': {'avg_iou': 0.8776568,
           'avg_obj': 0.23695159,
           'box_loss': 5.2376847,
           'class_loss': 20.256538,
           'conf_loss': 26.682003,
           'precision50': 0.23057452,
           'recall50': 0.1930869},
     '5': {'avg_iou': 0.87107676,
           'avg_obj': 0.30797657,
           'box_loss': 2.5311995,
           'class_loss': 9.869955,
           'conf_loss': 4.788854,
           'precision50': 0.3271891,
           'recall50': 0.29046574},
     'global': {'total_loss': 299.83496},
     'learning_rate': 0.001,
     'training_loss': 299.83496}
I0430 21:10:54.095777 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-10000.
I0430 22:20:14.813315 140262404466496 controller.py:425] train | step:  20000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.86659783,
           'avg_obj': 0.20812505,
           'box_loss': 5.771666,
           'class_loss': 7.472414,
           'conf_loss': 57.961483,
           'precision50': 0.20027664,
           'recall50': 0.13615191},
     '4': {'avg_iou': 0.831431,
           'avg_obj': 0.3430444,
           'box_loss': 4.1250978,
           'class_loss': 5.635154,
           'conf_loss': 14.394878,
           'precision50': 0.23469815,
           'recall50': 0.3320864},
     '5': {'avg_iou': 0.8309114,
           'avg_obj': 0.4279282,
           'box_loss': 1.8690248,
           'class_loss': 2.6696737,
           'conf_loss': 2.4548464,
           'precision50': 0.34305823,
           'recall50': 0.46645454},
     'global': {'total_loss': 102.35476},
     'learning_rate': 0.001,
     'training_loss': 102.35476}
I0430 22:21:01.812869 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-20000.
I0430 22:21:01.819313 140262404466496 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0430 22:21:02.520001 140262404466496 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0430 22:21:19.875896 140262404466496 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0430 22:26:22.926543 140262404466496 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0430 22:31:12.963334 140262404466496 controller.py:261]  eval | step:  20000 | eval time:  611.1 sec | output: 
    {'3': {'avg_iou': 0.6104412,
           'avg_obj': 0.20363303,
           'box_loss': 2.931638,
           'class_loss': 3.0182183,
           'conf_loss': 38.2222,
           'precision50': 0.15457201,
           'recall50': 0.19794576},
     '4': {'avg_iou': 0.76525474,
           'avg_obj': 0.40330467,
           'box_loss': 2.4104588,
           'class_loss': 2.408342,
           'conf_loss': 10.124307,
           'precision50': 0.19196904,
           'recall50': 0.43292037},
     '5': {'avg_iou': 0.79337096,
           'avg_obj': 0.5087112,
           'box_loss': 1.3431914,
           'class_loss': 1.3538492,
           'conf_loss': 1.9964119,
           'precision50': 0.2835408,
           'recall50': 0.5665919},
     'AP': 0.2594773,
     'AP50': 0.43772653,
     'AP75': 0.27861908,
     'APl': 0.34160715,
     'APm': 0.27860877,
     'APs': 0.09444084,
     'ARl': 0.53104967,
     'ARm': 0.4674528,
     'ARmax1': 0.22935261,
     'ARmax10': 0.38735372,
     'ARmax100': 0.42515016,
     'ARs': 0.20204403,
     'global': {'total_loss': 63.808613},
     'validation_loss': 63.808613}

                                                                 input_4[0][0]                    
__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'3': (None, 64, 64, 16271360    yolo_fpn[0][0]                   
                                                                 yolo_fpn[0][1]                   
                                                                 yolo_fpn[0][2]                   
==================================================================================================
Total params: 25,897,472
Trainable params: 25,867,520
Non-trainable params: 29,952
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 200, 8), 4: (8, 200, 8), 5: (8, 200, 8)}, inds: {3: (8, 200, 3), 4: (8, 200, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
train | step:  10000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.92178065,
           'avg_obj': 0.14123882,
           'box_loss': 6.6346025,
           'class_loss': 22.721704,
           'conf_loss': 201.11208,
           'precision50': 0.16506556,
           'recall50': 0.073124945},
     '4': {'avg_iou': 0.8776568,
           'avg_obj': 0.23695159,
           'box_loss': 5.2376847,
           'class_loss': 20.256538,
           'conf_loss': 26.682003,
           'precision50': 0.23057452,
           'recall50': 0.1930869},
     '5': {'avg_iou': 0.87107676,
           'avg_obj': 0.30797657,
           'box_loss': 2.5311995,
           'class_loss': 9.869955,
           'conf_loss': 4.788854,
           'precision50': 0.3271891,
           'recall50': 0.29046574},
     'global': {'total_loss': 299.83496},
     'learning_rate': 0.001,
     'training_loss': 299.83496}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-10000.
train | step:  20000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.86659783,
           'avg_obj': 0.20812505,
           'box_loss': 5.771666,
           'class_loss': 7.472414,
           'conf_loss': 57.961483,
           'precision50': 0.20027664,
           'recall50': 0.13615191},
     '4': {'avg_iou': 0.831431,
           'avg_obj': 0.3430444,
           'box_loss': 4.1250978,
           'class_loss': 5.635154,
           'conf_loss': 14.394878,
           'precision50': 0.23469815,
           'recall50': 0.3320864},
     '5': {'avg_iou': 0.8309114,
           'avg_obj': 0.4279282,
           'box_loss': 1.8690248,
           'class_loss': 2.6696737,
           'conf_loss': 2.4548464,
           'precision50': 0.34305823,
           'recall50': 0.46645454},
     'global': {'total_loss': 102.35476},
     'learning_rate': 0.001,
     'training_loss': 102.35476}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-20000.
 eval | step:  20000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=195.03s).
Accumulating evaluation results...
DONE (t=32.98s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.259
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.438
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.279
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.094
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.279
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.342
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.229
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.387
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.425
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.202
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.467
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.531
 eval | step:  20000 | eval time:  611.1 sec | output: 
    {'3': {'avg_iou': 0.6104412,
           'avg_obj': 0.20363303,
           'box_loss': 2.931638,
           'class_loss': 3.0182183,
           'conf_loss': 38.2222,
           'precision50': 0.15457201,
           'recall50': 0.19794576},
     '4': {'avg_iou': 0.76525474,
           'avg_obj': 0.40330467,
           'box_loss': 2.4104588,
           'class_loss': 2.408342,
           'conf_loss': 10.124307,
           'precision50': 0.19196904,
           'recall50': 0.43292037},
     '5': {'avg_iou': 0.79337096,
           'avg_obj': 0.5087112,
           'box_loss': 1.3431914,
           'class_loss': 1.3538492,
           'conf_loss': 1.9964119,
           'precision50': 0.2835408,
           'recall50': 0.5665919},
     'AP': 0.2594773,
     'AP50': 0.43772653,
     'AP75': 0.27861908,
     'APl': 0.34160715,
     'APm': 0.27860877,
     'APs': 0.09444084,
     'ARl': 0.53104967,
     'ARm': 0.4674528,
     'ARmax1': 0.22935261,
     'ARmax10': 0.38735372,
     'ARmax100': 0.42515016,
     'ARs': 0.20204403,
     'global': {'total_loss': 63.808613},
     'validation_loss': 63.808613}I0430 22:31:36.161921 140262404466496 controller.py:211] train | step:  20000 | training until step 40000...
I0430 23:38:29.002352 140262404466496 controller.py:425] train | step:  30000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.85073555,
           'avg_obj': 0.23791365,
           'box_loss': 5.557201,
           'class_loss': 6.2971387,
           'conf_loss': 59.150387,
           'precision50': 0.1930564,
           'recall50': 0.17110185},
     '4': {'avg_iou': 0.82698977,
           'avg_obj': 0.38344178,
           'box_loss': 3.8401902,
           'class_loss': 4.799044,
           'conf_loss': 14.389769,
           'precision50': 0.22375755,
           'recall50': 0.38572088},
     '5': {'avg_iou': 0.8290185,
           'avg_obj': 0.4736461,
           'box_loss': 1.7042338,
           'class_loss': 2.3045168,
           'conf_loss': 2.3863907,
           'precision50': 0.32671463,
           'recall50': 0.5279269},
     'global': {'total_loss': 100.42887},
     'learning_rate': 0.001,
     'training_loss': 100.42887}
I0430 23:39:14.598913 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-30000.
I0501 00:45:16.999988 140262404466496 controller.py:425] train | step:  40000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.84565437,
           'avg_obj': 0.25744683,
           'box_loss': 5.4314194,
           'class_loss': 5.761651,
           'conf_loss': 59.0267,
           'precision50': 0.19191633,
           'recall50': 0.19353527},
     '4': {'avg_iou': 0.8258641,
           'avg_obj': 0.41022623,
           'box_loss': 3.6691673,
           'class_loss': 4.359499,
           'conf_loss': 14.234691,
           'precision50': 0.21930502,
           'recall50': 0.42071962},
     '5': {'avg_iou': 0.8294124,
           'avg_obj': 0.5027875,
           'box_loss': 1.6060524,
           'class_loss': 2.0890923,
           'conf_loss': 2.332596,
           'precision50': 0.31824324,
           'recall50': 0.5652784},
     'global': {'total_loss': 98.51092},
     'learning_rate': 0.001,
     'training_loss': 98.51092}
I0501 00:46:03.656937 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-40000.
I0501 00:46:03.663220 140262404466496 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0501 00:50:25.097652 140262404466496 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 00:55:26.100387 140262404466496 controller.py:261]  eval | step:  40000 | eval time:  562.4 sec | output: 
    {'3': {'avg_iou': 0.6178415,
           'avg_obj': 0.23184334,
           'box_loss': 2.7997284,
           'class_loss': 2.410284,
           'conf_loss': 38.843754,
           'precision50': 0.1500413,
           'recall50': 0.23270828},
     '4': {'avg_iou': 0.76813465,
           'avg_obj': 0.4483303,
           'box_loss': 2.2330365,
           'class_loss': 1.9890049,
           'conf_loss': 10.205018,
           'precision50': 0.18020591,
           'recall50': 0.49142832},
     '5': {'avg_iou': 0.7938799,
           'avg_obj': 0.5619903,
           'box_loss': 1.2054132,
           'class_loss': 1.117054,
           'conf_loss': 1.9394691,
           'precision50': 0.26125234,
           'recall50': 0.63176936},
     'AP': 0.31181857,
     'AP50': 0.50017995,
     'AP75': 0.3359825,
     'APl': 0.41007075,
     'APm': 0.3356032,
     'APs': 0.12334644,
     'ARl': 0.58747315,
     'ARm': 0.5147685,
     'ARmax1': 0.26076978,
     'ARmax10': 0.43127477,
     'ARmax100': 0.4718264,
     'ARs': 0.24745749,
     'global': {'total_loss': 62.742764},
     'validation_loss': 62.742764}
I0501 00:55:49.160132 140262404466496 controller.py:211] train | step:  40000 | training until step 60000...
I0501 02:00:34.088558 140262404466496 controller.py:425] train | step:  50000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.84238183,
           'avg_obj': 0.27111235,
           'box_loss': 5.3207397,
           'class_loss': 5.409745,
           'conf_loss': 58.768562,
           'precision50': 0.19129771,
           'recall50': 0.2089917},
     '4': {'avg_iou': 0.8259799,
           'avg_obj': 0.42828918,
           'box_loss': 3.557895,
           'class_loss': 4.066883,
           'conf_loss': 13.999694,
           'precision50': 0.21858388,
           'recall50': 0.44360176},
     '5': {'avg_iou': 0.8300304,
           'avg_obj': 0.5221774,
           'box_loss': 1.5426573,
           'class_loss': 1.9516605,
           'conf_loss': 2.2999325,
           'precision50': 0.31382632,
           'recall50': 0.5893012},
     'global': {'total_loss': 96.91796},
     'learning_rate': 0.001,
     'training_loss': 96.91796}
I0501 02:01:20.542623 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-50000.
I0501 03:00:41.781078 140262404466496 controller.py:425] train | step:  60000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.8411961,
           'avg_obj': 0.283079,
           'box_loss': 5.2511506,
           'class_loss': 5.1777577,
           'conf_loss': 58.080868,
           'precision50': 0.19496779,
           'recall50': 0.22182375},
     '4': {'avg_iou': 0.8258728,
           'avg_obj': 0.44380245,
           'box_loss': 3.4696019,
           'class_loss': 3.8423903,
           'conf_loss': 13.8319235,
           'precision50': 0.21781398,
           'recall50': 0.46209708},
     '5': {'avg_iou': 0.8305892,
           'avg_obj': 0.5378259,
           'box_loss': 1.4910038,
           'class_loss': 1.8503822,
           'conf_loss': 2.270467,
           'precision50': 0.30873552,
           'recall50': 0.60675985},
     'global': {'total_loss': 95.26535},
     'learning_rate': 0.001,
     'training_loss': 95.26535}
I0501 03:01:36.775414 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-60000.
I0501 03:01:36.781598 140262404466496 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0501 03:05:54.393856 140262404466496 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 03:10:39.393162 140262404466496 controller.py:261]  eval | step:  60000 | eval time:  542.6 sec | output: 
    {'3': {'avg_iou': 0.6126701,
           'avg_obj': 0.2443991,
           'box_loss': 2.7230918,
           'class_loss': 2.2196138,
           'conf_loss': 38.744366,
           'precision50': 0.14893594,
           'recall50': 0.24762356},
     '4': {'avg_iou': 0.76835495,
           'avg_obj': 0.4720203,
           'box_loss': 2.1481452,
           'class_loss': 1.81604,
           'conf_loss': 10.156302,
           'precision50': 0.17780647,
           'recall50': 0.519701},
     '5': {'avg_iou': 0.7970491,
           'avg_obj': 0.58992743,
           'box_loss': 1.1343209,
           'class_loss': 1.0352029,
           'conf_loss': 1.9220692,
           'precision50': 0.253788,
           'recall50': 0.6619389},
     'AP': 0.33748752,
     'AP50': 0.52823955,
     'AP75': 0.36705846,
     'APl': 0.45240185,
     'APm': 0.36168954,
     'APs': 0.14110246,
     'ARl': 0.6179648,
     'ARm': 0.53374994,
     'ARmax1': 0.27571848,
     'ARmax10': 0.45416272,
     'ARmax100': 0.49435598,
     'ARs': 0.27178293,
     'global': {'total_loss': 61.89914},
     'validation_loss': 61.89914}

train | step:  20000 | training until step 40000...
train | step:  30000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.85073555,
           'avg_obj': 0.23791365,
           'box_loss': 5.557201,
           'class_loss': 6.2971387,
           'conf_loss': 59.150387,
           'precision50': 0.1930564,
           'recall50': 0.17110185},
     '4': {'avg_iou': 0.82698977,
           'avg_obj': 0.38344178,
           'box_loss': 3.8401902,
           'class_loss': 4.799044,
           'conf_loss': 14.389769,
           'precision50': 0.22375755,
           'recall50': 0.38572088},
     '5': {'avg_iou': 0.8290185,
           'avg_obj': 0.4736461,
           'box_loss': 1.7042338,
           'class_loss': 2.3045168,
           'conf_loss': 2.3863907,
           'precision50': 0.32671463,
           'recall50': 0.5279269},
     'global': {'total_loss': 100.42887},
     'learning_rate': 0.001,
     'training_loss': 100.42887}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-30000.
train | step:  40000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.84565437,
           'avg_obj': 0.25744683,
           'box_loss': 5.4314194,
           'class_loss': 5.761651,
           'conf_loss': 59.0267,
           'precision50': 0.19191633,
           'recall50': 0.19353527},
     '4': {'avg_iou': 0.8258641,
           'avg_obj': 0.41022623,
           'box_loss': 3.6691673,
           'class_loss': 4.359499,
           'conf_loss': 14.234691,
           'precision50': 0.21930502,
           'recall50': 0.42071962},
     '5': {'avg_iou': 0.8294124,
           'avg_obj': 0.5027875,
           'box_loss': 1.6060524,
           'class_loss': 2.0890923,
           'conf_loss': 2.332596,
           'precision50': 0.31824324,
           'recall50': 0.5652784},
     'global': {'total_loss': 98.51092},
     'learning_rate': 0.001,
     'training_loss': 98.51092}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-40000.
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=201.43s).
Accumulating evaluation results...
DONE (t=34.85s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.312
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.500
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.336
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.123
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.336
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.410
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.261
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.431
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.472
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.247
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.515
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.587
 eval | step:  40000 | eval time:  562.4 sec | output: 
    {'3': {'avg_iou': 0.6178415,
           'avg_obj': 0.23184334,
           'box_loss': 2.7997284,
           'class_loss': 2.410284,
           'conf_loss': 38.843754,
           'precision50': 0.1500413,
           'recall50': 0.23270828},
     '4': {'avg_iou': 0.76813465,
           'avg_obj': 0.4483303,
           'box_loss': 2.2330365,
           'class_loss': 1.9890049,
           'conf_loss': 10.205018,
           'precision50': 0.18020591,
           'recall50': 0.49142832},
     '5': {'avg_iou': 0.7938799,
           'avg_obj': 0.5619903,
           'box_loss': 1.2054132,
           'class_loss': 1.117054,
           'conf_loss': 1.9394691,
           'precision50': 0.26125234,
           'recall50': 0.63176936},
     'AP': 0.31181857,
     'AP50': 0.50017995,
     'AP75': 0.3359825,
     'APl': 0.41007075,
     'APm': 0.3356032,
     'APs': 0.12334644,
     'ARl': 0.58747315,
     'ARm': 0.5147685,
     'ARmax1': 0.26076978,
     'ARmax10': 0.43127477,
     'ARmax100': 0.4718264,
     'ARs': 0.24745749,
     'global': {'total_loss': 62.742764},
     'validation_loss': 62.742764}
train | step:  40000 | training until step 60000...
train | step:  50000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.84238183,
           'avg_obj': 0.27111235,
           'box_loss': 5.3207397,
           'class_loss': 5.409745,
           'conf_loss': 58.768562,
           'precision50': 0.19129771,
           'recall50': 0.2089917},
     '4': {'avg_iou': 0.8259799,
           'avg_obj': 0.42828918,
           'box_loss': 3.557895,
           'class_loss': 4.066883,
           'conf_loss': 13.999694,
           'precision50': 0.21858388,
           'recall50': 0.44360176},
     '5': {'avg_iou': 0.8300304,
           'avg_obj': 0.5221774,
           'box_loss': 1.5426573,
           'class_loss': 1.9516605,
           'conf_loss': 2.2999325,
           'precision50': 0.31382632,
           'recall50': 0.5893012},
     'global': {'total_loss': 96.91796},
     'learning_rate': 0.001,
     'training_loss': 96.91796}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-50000.
train | step:  60000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.8411961,
           'avg_obj': 0.283079,
           'box_loss': 5.2511506,
           'class_loss': 5.1777577,
           'conf_loss': 58.080868,
           'precision50': 0.19496779,
           'recall50': 0.22182375},
     '4': {'avg_iou': 0.8258728,
           'avg_obj': 0.44380245,
           'box_loss': 3.4696019,
           'class_loss': 3.8423903,
           'conf_loss': 13.8319235,
           'precision50': 0.21781398,
           'recall50': 0.46209708},
     '5': {'avg_iou': 0.8305892,
           'avg_obj': 0.5378259,
           'box_loss': 1.4910038,
           'class_loss': 1.8503822,
           'conf_loss': 2.270467,
           'precision50': 0.30873552,
           'recall50': 0.60675985},
     'global': {'total_loss': 95.26535},
     'learning_rate': 0.001,
     'training_loss': 95.26535}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-60000.
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=194.86s).
Accumulating evaluation results...
DONE (t=33.91s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.337
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.528
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.367
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.141
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.362
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.452
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.276
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.454
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.494
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.272
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.534
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.618
 eval | step:  60000 | eval time:  542.6 sec | output: 
    {'3': {'avg_iou': 0.6126701,
           'avg_obj': 0.2443991,
           'box_loss': 2.7230918,
           'class_loss': 2.2196138,
           'conf_loss': 38.744366,
           'precision50': 0.14893594,
           'recall50': 0.24762356},
     '4': {'avg_iou': 0.76835495,
           'avg_obj': 0.4720203,
           'box_loss': 2.1481452,
           'class_loss': 1.81604,
           'conf_loss': 10.156302,
           'precision50': 0.17780647,
           'recall50': 0.519701},
     '5': {'avg_iou': 0.7970491,
           'avg_obj': 0.58992743,
           'box_loss': 1.1343209,
           'class_loss': 1.0352029,
           'conf_loss': 1.9220692,
           'precision50': 0.253788,
           'recall50': 0.6619389},
     'AP': 0.33748752,
     'AP50': 0.52823955,
     'AP75': 0.36705846,
     'APl': 0.45240185,
     'APm': 0.36168954,
     'APs': 0.14110246,
     'ARl': 0.6179648,
     'ARm': 0.53374994,
     'ARmax1': 0.27571848,
     'ARmax10': 0.45416272,
     'ARmax100': 0.49435598,
     'ARs': 0.27178293,
     'global': {'total_loss': 61.89914},
     'validation_loss': 61.89914}I0501 03:11:00.228443 140262404466496 controller.py:211] train | step:  60000 | training until step 80000...
I0501 04:10:10.079619 140262404466496 controller.py:425] train | step:  70000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.84063613,
           'avg_obj': 0.28939772,
           'box_loss': 5.2052155,
           'class_loss': 5.0310373,
           'conf_loss': 57.608612,
           'precision50': 0.19522265,
           'recall50': 0.22986995},
     '4': {'avg_iou': 0.8262892,
           'avg_obj': 0.45285025,
           'box_loss': 3.4125977,
           'class_loss': 3.7184265,
           'conf_loss': 13.673615,
           'precision50': 0.21805778,
           'recall50': 0.47324345},
     '5': {'avg_iou': 0.83122295,
           'avg_obj': 0.5481114,
           'box_loss': 1.4591396,
           'class_loss': 1.7872957,
           'conf_loss': 2.2475593,
           'precision50': 0.30798674,
           'recall50': 0.61847633},
     'global': {'total_loss': 94.14353},
     'learning_rate': 0.001,
     'training_loss': 94.14353}
I0501 04:10:56.802862 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-70000.
I0501 05:10:09.489275 140262404466496 controller.py:425] train | step:  80000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.8394076,
           'avg_obj': 0.29978696,
           'box_loss': 5.1390853,
           'class_loss': 4.827646,
           'conf_loss': 56.952614,
           'precision50': 0.19518362,
           'recall50': 0.24127217},
     '4': {'avg_iou': 0.82637256,
           'avg_obj': 0.46598017,
           'box_loss': 3.3282542,
           'class_loss': 3.5382102,
           'conf_loss': 13.439424,
           'precision50': 0.21903078,
           'recall50': 0.4893906},
     '5': {'avg_iou': 0.83182156,
           'avg_obj': 0.56053,
           'box_loss': 1.418585,
           'class_loss': 1.7023941,
           'conf_loss': 2.208237,
           'precision50': 0.30744103,
           'recall50': 0.6334378},
     'global': {'total_loss': 92.55447},
     'learning_rate': 0.001,
     'training_loss': 92.55447}
I0501 05:10:57.325567 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-80000.
I0501 05:10:57.332237 140262404466496 controller.py:252]  eval | step:  80000 | running 625 steps of evaluation...
I0501 05:15:30.512707 140262404466496 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 05:22:02.981187 140262404466496 controller.py:261]  eval | step:  80000 | eval time:  665.6 sec | output: 
    {'3': {'avg_iou': 0.60827166,
           'avg_obj': 0.2525046,
           'box_loss': 2.67819,
           'class_loss': 2.1276808,
           'conf_loss': 38.631348,
           'precision50': 0.14795871,
           'recall50': 0.26044703},
     '4': {'avg_iou': 0.76882046,
           'avg_obj': 0.48439473,
           'box_loss': 2.0934186,
           'class_loss': 1.7391801,
           'conf_loss': 10.034862,
           'precision50': 0.17952475,
           'recall50': 0.5329116},
     '5': {'avg_iou': 0.7986225,
           'avg_obj': 0.603605,
           'box_loss': 1.0979828,
           'class_loss': 0.98554754,
           'conf_loss': 1.9095315,
           'precision50': 0.2517493,
           'recall50': 0.675962},
     'AP': 0.3506622,
     'AP50': 0.5413895,
     'AP75': 0.37875265,
     'APl': 0.47220778,
     'APm': 0.3731598,
     'APs': 0.15216076,
     'ARl': 0.62828547,
     'ARm': 0.5485691,
     'ARmax1': 0.2840194,
     'ARmax10': 0.46556252,
     'ARmax100': 0.50659853,
     'ARs': 0.2895708,
     'global': {'total_loss': 61.297756},
     'validation_loss': 61.297756}
I0501 05:22:23.397448 140262404466496 controller.py:211] train | step:  80000 | training until step 100000...
I0501 06:21:59.864000 140262404466496 controller.py:425] train | step:  90000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.83895683,
           'avg_obj': 0.30804682,
           'box_loss': 5.1013713,
           'class_loss': 4.6790338,
           'conf_loss': 56.43197,
           'precision50': 0.19681793,
           'recall50': 0.25049958},
     '4': {'avg_iou': 0.8266629,
           'avg_obj': 0.47612303,
           'box_loss': 3.277727,
           'class_loss': 3.4144032,
           'conf_loss': 13.272796,
           'precision50': 0.21976994,
           'recall50': 0.50108457},
     '5': {'avg_iou': 0.8323675,
           'avg_obj': 0.57069016,
           'box_loss': 1.3915224,
           'class_loss': 1.644508,
           'conf_loss': 2.1791496,
           'precision50': 0.3059352,
           'recall50': 0.6433334},
     'global': {'total_loss': 91.39282},
     'learning_rate': 0.001,
     'training_loss': 91.39282}
I0501 06:22:47.339338 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-90000.
I0501 07:22:10.042876 140262404466496 controller.py:425] train | step:  100000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.8384901,
           'avg_obj': 0.3142913,
           'box_loss': 5.0808806,
           'class_loss': 4.5836835,
           'conf_loss': 56.138187,
           'precision50': 0.19838347,
           'recall50': 0.2580847},
     '4': {'avg_iou': 0.8267674,
           'avg_obj': 0.4839446,
           'box_loss': 3.2418725,
           'class_loss': 3.3175628,
           'conf_loss': 13.1437235,
           'precision50': 0.2209145,
           'recall50': 0.51063776},
     '5': {'avg_iou': 0.8328503,
           'avg_obj': 0.5783961,
           'box_loss': 1.3694595,
           'class_loss': 1.594966,
           'conf_loss': 2.158306,
           'precision50': 0.30412096,
           'recall50': 0.65254384},
     'global': {'total_loss': 90.628555},
     'learning_rate': 0.001,
     'training_loss': 90.628555}
I0501 07:22:59.812801 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-100000.
I0501 07:22:59.819322 140262404466496 controller.py:252]  eval | step:  100000 | running 625 steps of evaluation...
I0501 07:27:22.511536 140262404466496 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 07:32:15.521964 140262404466496 controller.py:261]  eval | step:  100000 | eval time:  555.7 sec | output: 
    {'3': {'avg_iou': 0.6047524,
           'avg_obj': 0.25800943,
           'box_loss': 2.6459286,
           'class_loss': 2.0683045,
           'conf_loss': 38.74776,
           'precision50': 0.14879252,
           'recall50': 0.2693521},
     '4': {'avg_iou': 0.7699926,
           'avg_obj': 0.49389857,
           'box_loss': 2.0546994,
           'class_loss': 1.7060746,
           'conf_loss': 9.957405,
           'precision50': 0.17854644,
           'recall50': 0.54325354},
     '5': {'avg_iou': 0.7999331,
           'avg_obj': 0.6161941,
           'box_loss': 1.070269,
           'class_loss': 0.96647614,
           'conf_loss': 1.9095752,
           'precision50': 0.24871607,
           'recall50': 0.6870728},
     'AP': 0.35895166,
     'AP50': 0.54950976,
     'AP75': 0.38977814,
     'APl': 0.48371568,
     'APm': 0.3801386,
     'APs': 0.1589041,
     'ARl': 0.6377157,
     'ARm': 0.5548526,
     'ARmax1': 0.28920346,
     'ARmax10': 0.4746597,
     'ARmax100': 0.51470554,
     'ARs': 0.29432952,
     'global': {'total_loss': 61.126526},
     'validation_loss': 61.126526}

train | step:  60000 | training until step 80000...
train | step:  70000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.84063613,
           'avg_obj': 0.28939772,
           'box_loss': 5.2052155,
           'class_loss': 5.0310373,
           'conf_loss': 57.608612,
           'precision50': 0.19522265,
           'recall50': 0.22986995},
     '4': {'avg_iou': 0.8262892,
           'avg_obj': 0.45285025,
           'box_loss': 3.4125977,
           'class_loss': 3.7184265,
           'conf_loss': 13.673615,
           'precision50': 0.21805778,
           'recall50': 0.47324345},
     '5': {'avg_iou': 0.83122295,
           'avg_obj': 0.5481114,
           'box_loss': 1.4591396,
           'class_loss': 1.7872957,
           'conf_loss': 2.2475593,
           'precision50': 0.30798674,
           'recall50': 0.61847633},
     'global': {'total_loss': 94.14353},
     'learning_rate': 0.001,
     'training_loss': 94.14353}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-70000.
train | step:  80000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.8394076,
           'avg_obj': 0.29978696,
           'box_loss': 5.1390853,
           'class_loss': 4.827646,
           'conf_loss': 56.952614,
           'precision50': 0.19518362,
           'recall50': 0.24127217},
     '4': {'avg_iou': 0.82637256,
           'avg_obj': 0.46598017,
           'box_loss': 3.3282542,
           'class_loss': 3.5382102,
           'conf_loss': 13.439424,
           'precision50': 0.21903078,
           'recall50': 0.4893906},
     '5': {'avg_iou': 0.83182156,
           'avg_obj': 0.56053,
           'box_loss': 1.418585,
           'class_loss': 1.7023941,
           'conf_loss': 2.208237,
           'precision50': 0.30744103,
           'recall50': 0.6334378},
     'global': {'total_loss': 92.55447},
     'learning_rate': 0.001,
     'training_loss': 92.55447}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-80000.
 eval | step:  80000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=262.52s).
Accumulating evaluation results...
DONE (t=52.63s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.351
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.541
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.379
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.152
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.373
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.472
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.284
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.466
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.507
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.290
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.549
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.628
 eval | step:  80000 | eval time:  665.6 sec | output: 
    {'3': {'avg_iou': 0.60827166,
           'avg_obj': 0.2525046,
           'box_loss': 2.67819,
           'class_loss': 2.1276808,
           'conf_loss': 38.631348,
           'precision50': 0.14795871,
           'recall50': 0.26044703},
     '4': {'avg_iou': 0.76882046,
           'avg_obj': 0.48439473,
           'box_loss': 2.0934186,
           'class_loss': 1.7391801,
           'conf_loss': 10.034862,
           'precision50': 0.17952475,
           'recall50': 0.5329116},
     '5': {'avg_iou': 0.7986225,
           'avg_obj': 0.603605,
           'box_loss': 1.0979828,
           'class_loss': 0.98554754,
           'conf_loss': 1.9095315,
           'precision50': 0.2517493,
           'recall50': 0.675962},
     'AP': 0.3506622,
     'AP50': 0.5413895,
     'AP75': 0.37875265,
     'APl': 0.47220778,
     'APm': 0.3731598,
     'APs': 0.15216076,
     'ARl': 0.62828547,
     'ARm': 0.5485691,
     'ARmax1': 0.2840194,
     'ARmax10': 0.46556252,
     'ARmax100': 0.50659853,
     'ARs': 0.2895708,
     'global': {'total_loss': 61.297756},
     'validation_loss': 61.297756}
train | step:  80000 | training until step 100000...
train | step:  90000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.83895683,
           'avg_obj': 0.30804682,
           'box_loss': 5.1013713,
           'class_loss': 4.6790338,
           'conf_loss': 56.43197,
           'precision50': 0.19681793,
           'recall50': 0.25049958},
     '4': {'avg_iou': 0.8266629,
           'avg_obj': 0.47612303,
           'box_loss': 3.277727,
           'class_loss': 3.4144032,
           'conf_loss': 13.272796,
           'precision50': 0.21976994,
           'recall50': 0.50108457},
     '5': {'avg_iou': 0.8323675,
           'avg_obj': 0.57069016,
           'box_loss': 1.3915224,
           'class_loss': 1.644508,
           'conf_loss': 2.1791496,
           'precision50': 0.3059352,
           'recall50': 0.6433334},
     'global': {'total_loss': 91.39282},
     'learning_rate': 0.001,
     'training_loss': 91.39282}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-90000.
train | step:  100000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.8384901,
           'avg_obj': 0.3142913,
           'box_loss': 5.0808806,
           'class_loss': 4.5836835,
           'conf_loss': 56.138187,
           'precision50': 0.19838347,
           'recall50': 0.2580847},
     '4': {'avg_iou': 0.8267674,
           'avg_obj': 0.4839446,
           'box_loss': 3.2418725,
           'class_loss': 3.3175628,
           'conf_loss': 13.1437235,
           'precision50': 0.2209145,
           'recall50': 0.51063776},
     '5': {'avg_iou': 0.8328503,
           'avg_obj': 0.5783961,
           'box_loss': 1.3694595,
           'class_loss': 1.594966,
           'conf_loss': 2.158306,
           'precision50': 0.30412096,
           'recall50': 0.65254384},
     'global': {'total_loss': 90.628555},
     'learning_rate': 0.001,
     'training_loss': 90.628555}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-100000.
 eval | step:  100000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=202.94s).
Accumulating evaluation results...
DONE (t=39.67s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.359
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.550
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.390
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.159
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.380
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.484
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.289
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.475
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.515
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.294
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.555
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.638
 eval | step:  100000 | eval time:  555.7 sec | output: 
    {'3': {'avg_iou': 0.6047524,
           'avg_obj': 0.25800943,
           'box_loss': 2.6459286,
           'class_loss': 2.0683045,
           'conf_loss': 38.74776,
           'precision50': 0.14879252,
           'recall50': 0.2693521},
     '4': {'avg_iou': 0.7699926,
           'avg_obj': 0.49389857,
           'box_loss': 2.0546994,
           'class_loss': 1.7060746,
           'conf_loss': 9.957405,
           'precision50': 0.17854644,
           'recall50': 0.54325354},
     '5': {'avg_iou': 0.7999331,
           'avg_obj': 0.6161941,
           'box_loss': 1.070269,
           'class_loss': 0.96647614,
           'conf_loss': 1.9095752,
           'precision50': 0.24871607,
           'recall50': 0.6870728},
     'AP': 0.35895166,
     'AP50': 0.54950976,
     'AP75': 0.38977814,
     'APl': 0.48371568,
     'APm': 0.3801386,
     'APs': 0.1589041,
     'ARl': 0.6377157,
     'ARm': 0.5548526,
     'ARmax1': 0.28920346,
     'ARmax10': 0.4746597,
     'ARmax100': 0.51470554,
     'ARs': 0.29432952,
     'global': {'total_loss': 61.126526},
     'validation_loss': 61.126526}I0501 07:32:36.863116 140262404466496 controller.py:211] train | step:  100000 | training until step 120000...
I0501 08:31:57.042808 140262404466496 controller.py:425] train | step:  110000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.83781856,
           'avg_obj': 0.3206084,
           'box_loss': 5.038103,
           'class_loss': 4.4656024,
           'conf_loss': 55.717255,
           'precision50': 0.19835697,
           'recall50': 0.26536098},
     '4': {'avg_iou': 0.8270441,
           'avg_obj': 0.49173817,
           'box_loss': 3.2025487,
           'class_loss': 3.2269292,
           'conf_loss': 12.95635,
           'precision50': 0.22149101,
           'recall50': 0.51901203},
     '5': {'avg_iou': 0.8332501,
           'avg_obj': 0.58535296,
           'box_loss': 1.3474865,
           'class_loss': 1.5529311,
           'conf_loss': 2.1373754,
           'precision50': 0.30331334,
           'recall50': 0.6599803},
     'global': {'total_loss': 89.64479},
     'learning_rate': 0.001,
     'training_loss': 89.64479}
I0501 08:32:45.332030 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-110000.
I0501 09:31:36.581066 140262404466496 controller.py:425] train | step:  120000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.83800876,
           'avg_obj': 0.32725435,
           'box_loss': 5.0160108,
           'class_loss': 4.3876867,
           'conf_loss': 55.100994,
           'precision50': 0.20199412,
           'recall50': 0.27336133},
     '4': {'avg_iou': 0.8270877,
           'avg_obj': 0.49894884,
           'box_loss': 3.1716518,
           'class_loss': 3.1550095,
           'conf_loss': 12.864655,
           'precision50': 0.22147156,
           'recall50': 0.52813447},
     '5': {'avg_iou': 0.83359104,
           'avg_obj': 0.59221625,
           'box_loss': 1.3311937,
           'class_loss': 1.516098,
           'conf_loss': 2.1221044,
           'precision50': 0.30145198,
           'recall50': 0.66807985},
     'global': {'total_loss': 88.665565},
     'learning_rate': 0.001,
     'training_loss': 88.665565}
I0501 09:32:22.662075 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-120000.
I0501 09:32:22.668051 140262404466496 controller.py:252]  eval | step:  120000 | running 625 steps of evaluation...
I0501 09:36:46.874568 140262404466496 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 09:41:55.044662 140262404466496 controller.py:261]  eval | step:  120000 | eval time:  572.4 sec | output: 
    {'3': {'avg_iou': 0.60466146,
           'avg_obj': 0.26245615,
           'box_loss': 2.6200778,
           'class_loss': 2.0333984,
           'conf_loss': 38.574207,
           'precision50': 0.14978878,
           'recall50': 0.2760078},
     '4': {'avg_iou': 0.7662933,
           'avg_obj': 0.4991066,
           'box_loss': 2.0294979,
           'class_loss': 1.6832602,
           'conf_loss': 9.897315,
           'precision50': 0.1813508,
           'recall50': 0.550112},
     '5': {'avg_iou': 0.79991096,
           'avg_obj': 0.62265736,
           'box_loss': 1.0518618,
           'class_loss': 0.95408136,
           'conf_loss': 1.9261692,
           'precision50': 0.24697532,
           'recall50': 0.69669044},
     'AP': 0.36519724,
     'AP50': 0.5542388,
     'AP75': 0.397817,
     'APl': 0.49339306,
     'APm': 0.3840309,
     'APs': 0.16365413,
     'ARl': 0.6484964,
     'ARm': 0.5619754,
     'ARmax1': 0.29423672,
     'ARmax10': 0.48063236,
     'ARmax100': 0.5219333,
     'ARs': 0.30258954,
     'global': {'total_loss': 60.769855},
     'validation_loss': 60.769855}
I0501 09:42:17.519147 140262404466496 controller.py:211] train | step:  120000 | training until step 140000...
I0501 10:40:06.997311 140262404466496 controller.py:425] train | step:  130000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.8378743,
           'avg_obj': 0.33232674,
           'box_loss': 4.977955,
           'class_loss': 4.284993,
           'conf_loss': 54.472313,
           'precision50': 0.20579089,
           'recall50': 0.27799016},
     '4': {'avg_iou': 0.8270869,
           'avg_obj': 0.50506884,
           'box_loss': 3.1336956,
           'class_loss': 3.0790699,
           'conf_loss': 12.754851,
           'precision50': 0.22159182,
           'recall50': 0.5348539},
     '5': {'avg_iou': 0.83402985,
           'avg_obj': 0.5988594,
           'box_loss': 1.3125197,
           'class_loss': 1.483094,
           'conf_loss': 2.0954535,
           'precision50': 0.30118114,
           'recall50': 0.6748745},
     'global': {'total_loss': 87.59397},
     'learning_rate': 0.001,
     'training_loss': 87.59397}
I0501 10:41:05.835766 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-130000.
I0501 11:39:47.529937 140262404466496 controller.py:425] train | step:  140000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.83633065,
           'avg_obj': 0.33672968,
           'box_loss': 4.9640794,
           'class_loss': 4.220309,
           'conf_loss': 54.780224,
           'precision50': 0.20261087,
           'recall50': 0.2834005},
     '4': {'avg_iou': 0.8273383,
           'avg_obj': 0.51059705,
           'box_loss': 3.1104228,
           'class_loss': 3.0317461,
           'conf_loss': 12.655792,
           'precision50': 0.22251265,
           'recall50': 0.5418156},
     '5': {'avg_iou': 0.834299,
           'avg_obj': 0.60388094,
           'box_loss': 1.2977028,
           'class_loss': 1.4531956,
           'conf_loss': 2.0846858,
           'precision50': 0.3005345,
           'recall50': 0.6796748},
     'global': {'total_loss': 87.59834},
     'learning_rate': 0.001,
     'training_loss': 87.59834}
I0501 11:40:36.562439 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-140000.
I0501 11:40:36.568473 140262404466496 controller.py:252]  eval | step:  140000 | running 625 steps of evaluation...
I0501 11:45:02.446859 140262404466496 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 11:50:17.587517 140262404466496 controller.py:261]  eval | step:  140000 | eval time:  581.0 sec | output: 
    {'3': {'avg_iou': 0.61128205,
           'avg_obj': 0.26360998,
           'box_loss': 2.608029,
           'class_loss': 2.0097284,
           'conf_loss': 39.061203,
           'precision50': 0.14698121,
           'recall50': 0.2764533},
     '4': {'avg_iou': 0.76767176,
           'avg_obj': 0.50377065,
           'box_loss': 2.0172315,
           'class_loss': 1.6649243,
           'conf_loss': 10.018311,
           'precision50': 0.17962354,
           'recall50': 0.5535509},
     '5': {'avg_iou': 0.8008768,
           'avg_obj': 0.62957543,
           'box_loss': 1.037865,
           'class_loss': 0.94208956,
           'conf_loss': 1.9353738,
           'precision50': 0.24323425,
           'recall50': 0.7007284},
     'AP': 0.36799145,
     'AP50': 0.55750877,
     'AP75': 0.40027565,
     'APl': 0.49671623,
     'APm': 0.3870518,
     'APs': 0.16318972,
     'ARl': 0.64788306,
     'ARm': 0.5574198,
     'ARmax1': 0.29580986,
     'ARmax10': 0.48151308,
     'ARmax100': 0.52200717,
     'ARs': 0.30734518,
     'global': {'total_loss': 61.29477},
     'validation_loss': 61.29477}

train | step:  100000 | training until step 120000...
train | step:  110000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.83781856,
           'avg_obj': 0.3206084,
           'box_loss': 5.038103,
           'class_loss': 4.4656024,
           'conf_loss': 55.717255,
           'precision50': 0.19835697,
           'recall50': 0.26536098},
     '4': {'avg_iou': 0.8270441,
           'avg_obj': 0.49173817,
           'box_loss': 3.2025487,
           'class_loss': 3.2269292,
           'conf_loss': 12.95635,
           'precision50': 0.22149101,
           'recall50': 0.51901203},
     '5': {'avg_iou': 0.8332501,
           'avg_obj': 0.58535296,
           'box_loss': 1.3474865,
           'class_loss': 1.5529311,
           'conf_loss': 2.1373754,
           'precision50': 0.30331334,
           'recall50': 0.6599803},
     'global': {'total_loss': 89.64479},
     'learning_rate': 0.001,
     'training_loss': 89.64479}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-110000.
train | step:  120000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.83800876,
           'avg_obj': 0.32725435,
           'box_loss': 5.0160108,
           'class_loss': 4.3876867,
           'conf_loss': 55.100994,
           'precision50': 0.20199412,
           'recall50': 0.27336133},
     '4': {'avg_iou': 0.8270877,
           'avg_obj': 0.49894884,
           'box_loss': 3.1716518,
           'class_loss': 3.1550095,
           'conf_loss': 12.864655,
           'precision50': 0.22147156,
           'recall50': 0.52813447},
     '5': {'avg_iou': 0.83359104,
           'avg_obj': 0.59221625,
           'box_loss': 1.3311937,
           'class_loss': 1.516098,
           'conf_loss': 2.1221044,
           'precision50': 0.30145198,
           'recall50': 0.66807985},
     'global': {'total_loss': 88.665565},
     'learning_rate': 0.001,
     'training_loss': 88.665565}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-120000.
 eval | step:  120000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=211.39s).
Accumulating evaluation results...
DONE (t=41.52s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.365
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.554
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.398
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.164
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.384
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.493
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.294
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.481
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.522
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.303
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.562
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.648
 eval | step:  120000 | eval time:  572.4 sec | output: 
    {'3': {'avg_iou': 0.60466146,
           'avg_obj': 0.26245615,
           'box_loss': 2.6200778,
           'class_loss': 2.0333984,
           'conf_loss': 38.574207,
           'precision50': 0.14978878,
           'recall50': 0.2760078},
     '4': {'avg_iou': 0.7662933,
           'avg_obj': 0.4991066,
           'box_loss': 2.0294979,
           'class_loss': 1.6832602,
           'conf_loss': 9.897315,
           'precision50': 0.1813508,
           'recall50': 0.550112},
     '5': {'avg_iou': 0.79991096,
           'avg_obj': 0.62265736,
           'box_loss': 1.0518618,
           'class_loss': 0.95408136,
           'conf_loss': 1.9261692,
           'precision50': 0.24697532,
           'recall50': 0.69669044},
     'AP': 0.36519724,
     'AP50': 0.5542388,
     'AP75': 0.397817,
     'APl': 0.49339306,
     'APm': 0.3840309,
     'APs': 0.16365413,
     'ARl': 0.6484964,
     'ARm': 0.5619754,
     'ARmax1': 0.29423672,
     'ARmax10': 0.48063236,
     'ARmax100': 0.5219333,
     'ARs': 0.30258954,
     'global': {'total_loss': 60.769855},
     'validation_loss': 60.769855}
train | step:  120000 | training until step 140000...
train | step:  130000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.8378743,
           'avg_obj': 0.33232674,
           'box_loss': 4.977955,
           'class_loss': 4.284993,
           'conf_loss': 54.472313,
           'precision50': 0.20579089,
           'recall50': 0.27799016},
     '4': {'avg_iou': 0.8270869,
           'avg_obj': 0.50506884,
           'box_loss': 3.1336956,
           'class_loss': 3.0790699,
           'conf_loss': 12.754851,
           'precision50': 0.22159182,
           'recall50': 0.5348539},
     '5': {'avg_iou': 0.83402985,
           'avg_obj': 0.5988594,
           'box_loss': 1.3125197,
           'class_loss': 1.483094,
           'conf_loss': 2.0954535,
           'precision50': 0.30118114,
           'recall50': 0.6748745},
     'global': {'total_loss': 87.59397},
     'learning_rate': 0.001,
     'training_loss': 87.59397}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-130000.
train | step:  140000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.83633065,
           'avg_obj': 0.33672968,
           'box_loss': 4.9640794,
           'class_loss': 4.220309,
           'conf_loss': 54.780224,
           'precision50': 0.20261087,
           'recall50': 0.2834005},
     '4': {'avg_iou': 0.8273383,
           'avg_obj': 0.51059705,
           'box_loss': 3.1104228,
           'class_loss': 3.0317461,
           'conf_loss': 12.655792,
           'precision50': 0.22251265,
           'recall50': 0.5418156},
     '5': {'avg_iou': 0.834299,
           'avg_obj': 0.60388094,
           'box_loss': 1.2977028,
           'class_loss': 1.4531956,
           'conf_loss': 2.0846858,
           'precision50': 0.3005345,
           'recall50': 0.6796748},
     'global': {'total_loss': 87.59834},
     'learning_rate': 0.001,
     'training_loss': 87.59834}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-140000.
 eval | step:  140000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=215.31s).
Accumulating evaluation results...
DONE (t=41.22s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.368
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.558
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.400
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.163
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.387
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.497
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.296
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.482
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.522
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.307
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.557
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.648
 eval | step:  140000 | eval time:  581.0 sec | output: 
    {'3': {'avg_iou': 0.61128205,
           'avg_obj': 0.26360998,
           'box_loss': 2.608029,
           'class_loss': 2.0097284,
           'conf_loss': 39.061203,
           'precision50': 0.14698121,
           'recall50': 0.2764533},
     '4': {'avg_iou': 0.76767176,
           'avg_obj': 0.50377065,
           'box_loss': 2.0172315,
           'class_loss': 1.6649243,
           'conf_loss': 10.018311,
           'precision50': 0.17962354,
           'recall50': 0.5535509},
     '5': {'avg_iou': 0.8008768,
           'avg_obj': 0.62957543,
           'box_loss': 1.037865,
           'class_loss': 0.94208956,
           'conf_loss': 1.9353738,
           'precision50': 0.24323425,
           'recall50': 0.7007284},
     'AP': 0.36799145,
     'AP50': 0.55750877,
     'AP75': 0.40027565,
     'APl': 0.49671623,
     'APm': 0.3870518,
     'APs': 0.16318972,
     'ARl': 0.64788306,
     'ARm': 0.5574198,
     'ARmax1': 0.29580986,
     'ARmax10': 0.48151308,
     'ARmax100': 0.52200717,
     'ARs': 0.30734518,
     'global': {'total_loss': 61.29477},
     'validation_loss': 61.29477}I0501 11:50:40.081339 140262404466496 controller.py:211] train | step:  140000 | training until step 160000...
I0501 12:46:16.960773 140262404466496 controller.py:425] train | step:  150000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.836434,
           'avg_obj': 0.3421848,
           'box_loss': 4.928441,
           'class_loss': 4.1507993,
           'conf_loss': 53.91419,
           'precision50': 0.20436178,
           'recall50': 0.289021},
     '4': {'avg_iou': 0.82722783,
           'avg_obj': 0.5172406,
           'box_loss': 3.0725307,
           'class_loss': 2.9538608,
           'conf_loss': 12.545963,
           'precision50': 0.22128117,
           'recall50': 0.5490665},
     '5': {'avg_iou': 0.8345788,
           'avg_obj': 0.6097753,
           'box_loss': 1.278811,
           'class_loss': 1.4206936,
           'conf_loss': 2.059895,
           'precision50': 0.2987012,
           'recall50': 0.6860461},
     'global': {'total_loss': 86.32536},
     'learning_rate': 0.001,
     'training_loss': 86.32536}
I0501 12:47:04.024098 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-150000.
I0501 13:50:11.668939 140262404466496 controller.py:425] train | step:  160000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.8358875,
           'avg_obj': 0.34667438,
           'box_loss': 4.9179926,
           'class_loss': 4.091413,
           'conf_loss': 53.864937,
           'precision50': 0.20440143,
           'recall50': 0.2946848},
     '4': {'avg_iou': 0.8273389,
           'avg_obj': 0.5223965,
           'box_loss': 3.0584981,
           'class_loss': 2.9114573,
           'conf_loss': 12.464045,
           'precision50': 0.22162442,
           'recall50': 0.55486083},
     '5': {'avg_iou': 0.83482903,
           'avg_obj': 0.61462396,
           'box_loss': 1.2691987,
           'class_loss': 1.3945649,
           'conf_loss': 2.0479224,
           'precision50': 0.2990724,
           'recall50': 0.6913464},
     'global': {'total_loss': 86.019875},
     'learning_rate': 0.001,
     'training_loss': 86.019875}
I0501 13:50:59.748839 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-160000.
I0501 13:50:59.755026 140262404466496 controller.py:252]  eval | step:  160000 | running 625 steps of evaluation...
I0501 13:55:25.479438 140262404466496 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 14:00:26.811219 140262404466496 controller.py:261]  eval | step:  160000 | eval time:  567.1 sec | output: 
    {'3': {'avg_iou': 0.6072655,
           'avg_obj': 0.26761115,
           'box_loss': 2.593479,
           'class_loss': 1.9744769,
           'conf_loss': 38.99702,
           'precision50': 0.14827831,
           'recall50': 0.2821994},
     '4': {'avg_iou': 0.76954436,
           'avg_obj': 0.5082728,
           'box_loss': 2.0039434,
           'class_loss': 1.6601826,
           'conf_loss': 10.133087,
           'precision50': 0.17816557,
           'recall50': 0.5600859},
     '5': {'avg_iou': 0.80056494,
           'avg_obj': 0.6335776,
           'box_loss': 1.0250329,
           'class_loss': 0.9331781,
           'conf_loss': 1.9563202,
           'precision50': 0.23935044,
           'recall50': 0.70220137},
     'AP': 0.37142578,
     'AP50': 0.5596083,
     'AP75': 0.40493354,
     'APl': 0.5016728,
     'APm': 0.39041588,
     'APs': 0.16809928,
     'ARl': 0.65539974,
     'ARm': 0.5625895,
     'ARmax1': 0.2985884,
     'ARmax10': 0.48516774,
     'ARmax100': 0.5260825,
     'ARs': 0.3080274,
     'global': {'total_loss': 61.27667},
     'validation_loss': 61.27667}
I0501 14:00:48.997837 140262404466496 controller.py:211] train | step:  160000 | training until step 180000...
I0501 14:55:27.881291 140262404466496 controller.py:425] train | step:  170000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.8352374,
           'avg_obj': 0.35108528,
           'box_loss': 4.8848014,
           'class_loss': 4.0273557,
           'conf_loss': 53.62932,
           'precision50': 0.2030847,
           'recall50': 0.29934254},
     '4': {'avg_iou': 0.8276167,
           'avg_obj': 0.52706647,
           'box_loss': 3.028436,
           'class_loss': 2.8635068,
           'conf_loss': 12.332461,
           'precision50': 0.22147876,
           'recall50': 0.56034255},
     '5': {'avg_iou': 0.83516496,
           'avg_obj': 0.61908346,
           'box_loss': 1.2563423,
           'class_loss': 1.3712039,
           'conf_loss': 2.0287282,
           'precision50': 0.29831693,
           'recall50': 0.6956202},
     'global': {'total_loss': 85.42218},
     'learning_rate': 0.001,
     'training_loss': 85.42218}
I0501 14:56:21.418243 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-170000.
I0501 16:00:11.553819 140262404466496 controller.py:425] train | step:  180000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.8351118,
           'avg_obj': 0.35480133,
           'box_loss': 4.874506,
           'class_loss': 3.9870477,
           'conf_loss': 53.43323,
           'precision50': 0.20282322,
           'recall50': 0.3037906},
     '4': {'avg_iou': 0.827937,
           'avg_obj': 0.5315226,
           'box_loss': 3.0100203,
           'class_loss': 2.8253968,
           'conf_loss': 12.208511,
           'precision50': 0.22255193,
           'recall50': 0.5652755},
     '5': {'avg_iou': 0.8353957,
           'avg_obj': 0.6230322,
           'box_loss': 1.2439119,
           'class_loss': 1.3489445,
           'conf_loss': 2.014155,
           'precision50': 0.2979843,
           'recall50': 0.6999419},
     'global': {'total_loss': 84.94576},
     'learning_rate': 0.001,
     'training_loss': 84.94576}
I0501 16:01:02.341328 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-180000.
I0501 16:01:02.347921 140262404466496 controller.py:252]  eval | step:  180000 | running 625 steps of evaluation...
I0501 16:05:31.871442 140262404466496 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 16:10:40.603012 140262404466496 controller.py:261]  eval | step:  180000 | eval time:  578.3 sec | output: 
    {'3': {'avg_iou': 0.6068798,
           'avg_obj': 0.26852745,
           'box_loss': 2.5900106,
           'class_loss': 1.9716316,
           'conf_loss': 39.252304,
           'precision50': 0.14686069,
           'recall50': 0.2849423},
     '4': {'avg_iou': 0.7692349,
           'avg_obj': 0.5108967,
           'box_loss': 1.9949629,
           'class_loss': 1.666171,
           'conf_loss': 10.06975,
           'precision50': 0.17756864,
           'recall50': 0.56189317},
     '5': {'avg_iou': 0.800921,
           'avg_obj': 0.63621885,
           'box_loss': 1.0173848,
           'class_loss': 0.9182303,
           'conf_loss': 1.9513887,
           'precision50': 0.24069846,
           'recall50': 0.70605224},
     'AP': 0.37208712,
     'AP50': 0.5592431,
     'AP75': 0.40227973,
     'APl': 0.5034698,
     'APm': 0.38940263,
     'APs': 0.16949089,
     'ARl': 0.65659994,
     'ARm': 0.5622513,
     'ARmax1': 0.29737374,
     'ARmax10': 0.48633993,
     'ARmax100': 0.5272843,
     'ARs': 0.31291062,
     'global': {'total_loss': 61.43184},
     'validation_loss': 61.43184}

train | step:  140000 | training until step 160000...
train | step:  150000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.836434,
           'avg_obj': 0.3421848,
           'box_loss': 4.928441,
           'class_loss': 4.1507993,
           'conf_loss': 53.91419,
           'precision50': 0.20436178,
           'recall50': 0.289021},
     '4': {'avg_iou': 0.82722783,
           'avg_obj': 0.5172406,
           'box_loss': 3.0725307,
           'class_loss': 2.9538608,
           'conf_loss': 12.545963,
           'precision50': 0.22128117,
           'recall50': 0.5490665},
     '5': {'avg_iou': 0.8345788,
           'avg_obj': 0.6097753,
           'box_loss': 1.278811,
           'class_loss': 1.4206936,
           'conf_loss': 2.059895,
           'precision50': 0.2987012,
           'recall50': 0.6860461},
     'global': {'total_loss': 86.32536},
     'learning_rate': 0.001,
     'training_loss': 86.32536}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-150000.
train | step:  160000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.8358875,
           'avg_obj': 0.34667438,
           'box_loss': 4.9179926,
           'class_loss': 4.091413,
           'conf_loss': 53.864937,
           'precision50': 0.20440143,
           'recall50': 0.2946848},
     '4': {'avg_iou': 0.8273389,
           'avg_obj': 0.5223965,
           'box_loss': 3.0584981,
           'class_loss': 2.9114573,
           'conf_loss': 12.464045,
           'precision50': 0.22162442,
           'recall50': 0.55486083},
     '5': {'avg_iou': 0.83482903,
           'avg_obj': 0.61462396,
           'box_loss': 1.2691987,
           'class_loss': 1.3945649,
           'conf_loss': 2.0479224,
           'precision50': 0.2990724,
           'recall50': 0.6913464},
     'global': {'total_loss': 86.019875},
     'learning_rate': 0.001,
     'training_loss': 86.019875}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-160000.
 eval | step:  160000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=208.06s).
Accumulating evaluation results...
DONE (t=35.98s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.371
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.560
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.405
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.168
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.390
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.502
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.299
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.526
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.308
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.563
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.655
 eval | step:  160000 | eval time:  567.1 sec | output: 
    {'3': {'avg_iou': 0.6072655,
           'avg_obj': 0.26761115,
           'box_loss': 2.593479,
           'class_loss': 1.9744769,
           'conf_loss': 38.99702,
           'precision50': 0.14827831,
           'recall50': 0.2821994},
     '4': {'avg_iou': 0.76954436,
           'avg_obj': 0.5082728,
           'box_loss': 2.0039434,
           'class_loss': 1.6601826,
           'conf_loss': 10.133087,
           'precision50': 0.17816557,
           'recall50': 0.5600859},
     '5': {'avg_iou': 0.80056494,
           'avg_obj': 0.6335776,
           'box_loss': 1.0250329,
           'class_loss': 0.9331781,
           'conf_loss': 1.9563202,
           'precision50': 0.23935044,
           'recall50': 0.70220137},
     'AP': 0.37142578,
     'AP50': 0.5596083,
     'AP75': 0.40493354,
     'APl': 0.5016728,
     'APm': 0.39041588,
     'APs': 0.16809928,
     'ARl': 0.65539974,
     'ARm': 0.5625895,
     'ARmax1': 0.2985884,
     'ARmax10': 0.48516774,
     'ARmax100': 0.5260825,
     'ARs': 0.3080274,
     'global': {'total_loss': 61.27667},
     'validation_loss': 61.27667}
train | step:  160000 | training until step 180000...
train | step:  170000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.8352374,
           'avg_obj': 0.35108528,
           'box_loss': 4.8848014,
           'class_loss': 4.0273557,
           'conf_loss': 53.62932,
           'precision50': 0.2030847,
           'recall50': 0.29934254},
     '4': {'avg_iou': 0.8276167,
           'avg_obj': 0.52706647,
           'box_loss': 3.028436,
           'class_loss': 2.8635068,
           'conf_loss': 12.332461,
           'precision50': 0.22147876,
           'recall50': 0.56034255},
     '5': {'avg_iou': 0.83516496,
           'avg_obj': 0.61908346,
           'box_loss': 1.2563423,
           'class_loss': 1.3712039,
           'conf_loss': 2.0287282,
           'precision50': 0.29831693,
           'recall50': 0.6956202},
     'global': {'total_loss': 85.42218},
     'learning_rate': 0.001,
     'training_loss': 85.42218}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-170000.
train | step:  180000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.8351118,
           'avg_obj': 0.35480133,
           'box_loss': 4.874506,
           'class_loss': 3.9870477,
           'conf_loss': 53.43323,
           'precision50': 0.20282322,
           'recall50': 0.3037906},
     '4': {'avg_iou': 0.827937,
           'avg_obj': 0.5315226,
           'box_loss': 3.0100203,
           'class_loss': 2.8253968,
           'conf_loss': 12.208511,
           'precision50': 0.22255193,
           'recall50': 0.5652755},
     '5': {'avg_iou': 0.8353957,
           'avg_obj': 0.6230322,
           'box_loss': 1.2439119,
           'class_loss': 1.3489445,
           'conf_loss': 2.014155,
           'precision50': 0.2979843,
           'recall50': 0.6999419},
     'global': {'total_loss': 84.94576},
     'learning_rate': 0.001,
     'training_loss': 84.94576}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-180000.
 eval | step:  180000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=211.77s).
Accumulating evaluation results...
DONE (t=39.20s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.372
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.559
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.402
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.169
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.389
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.503
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.297
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.486
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.527
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.313
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.562
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.657
 eval | step:  180000 | eval time:  578.3 sec | output: 
    {'3': {'avg_iou': 0.6068798,
           'avg_obj': 0.26852745,
           'box_loss': 2.5900106,
           'class_loss': 1.9716316,
           'conf_loss': 39.252304,
           'precision50': 0.14686069,
           'recall50': 0.2849423},
     '4': {'avg_iou': 0.7692349,
           'avg_obj': 0.5108967,
           'box_loss': 1.9949629,
           'class_loss': 1.666171,
           'conf_loss': 10.06975,
           'precision50': 0.17756864,
           'recall50': 0.56189317},
     '5': {'avg_iou': 0.800921,
           'avg_obj': 0.63621885,
           'box_loss': 1.0173848,
           'class_loss': 0.9182303,
           'conf_loss': 1.9513887,
           'precision50': 0.24069846,
           'recall50': 0.70605224},
     'AP': 0.37208712,
     'AP50': 0.5592431,
     'AP75': 0.40227973,
     'APl': 0.5034698,
     'APm': 0.38940263,
     'APs': 0.16949089,
     'ARl': 0.65659994,
     'ARm': 0.5622513,
     'ARmax1': 0.29737374,
     'ARmax10': 0.48633993,
     'ARmax100': 0.5272843,
     'ARs': 0.31291062,
     'global': {'total_loss': 61.43184},
     'validation_loss': 61.43184}I0501 16:11:03.974470 140262404466496 controller.py:211] train | step:  180000 | training until step 200000...
I0501 17:03:38.375349 140262404466496 controller.py:425] train | step:  190000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.83459413,
           'avg_obj': 0.35851404,
           'box_loss': 4.866177,
           'class_loss': 3.9472039,
           'conf_loss': 53.49943,
           'precision50': 0.20146829,
           'recall50': 0.30777365},
     '4': {'avg_iou': 0.8280156,
           'avg_obj': 0.5358793,
           'box_loss': 2.9961686,
           'class_loss': 2.7898676,
           'conf_loss': 12.153168,
           'precision50': 0.2222898,
           'recall50': 0.57027966},
     '5': {'avg_iou': 0.83575237,
           'avg_obj': 0.62704206,
           'box_loss': 1.23633,
           'class_loss': 1.332139,
           'conf_loss': 1.9964732,
           'precision50': 0.2973214,
           'recall50': 0.703853},
     'global': {'total_loss': 84.817},
     'learning_rate': 0.001,
     'training_loss': 84.817}
I0501 17:04:36.937790 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-190000.
I0501 18:03:56.933202 140262404466496 controller.py:425] train | step:  200000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.8343048,
           'avg_obj': 0.36171734,
           'box_loss': 4.842384,
           'class_loss': 3.905437,
           'conf_loss': 53.16427,
           'precision50': 0.20114179,
           'recall50': 0.3113159},
     '4': {'avg_iou': 0.82827044,
           'avg_obj': 0.53978217,
           'box_loss': 2.9732065,
           'class_loss': 2.7556581,
           'conf_loss': 12.05346,
           'precision50': 0.2220303,
           'recall50': 0.5738708},
     '5': {'avg_iou': 0.83607996,
           'avg_obj': 0.6305398,
           'box_loss': 1.2243644,
           'class_loss': 1.3147796,
           'conf_loss': 1.9837633,
           'precision50': 0.29789278,
           'recall50': 0.70718503},
     'global': {'total_loss': 84.21772},
     'learning_rate': 0.001,
     'training_loss': 84.21772}
I0501 18:04:50.878077 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-200000.
I0501 18:04:50.884124 140262404466496 controller.py:252]  eval | step:  200000 | running 625 steps of evaluation...
I0501 18:09:09.465903 140262404466496 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 18:13:58.340894 140262404466496 controller.py:261]  eval | step:  200000 | eval time:  547.5 sec | output: 
    {'3': {'avg_iou': 0.61322033,
           'avg_obj': 0.270778,
           'box_loss': 2.581181,
           'class_loss': 1.9653428,
           'conf_loss': 39.68966,
           'precision50': 0.14370474,
           'recall50': 0.28665087},
     '4': {'avg_iou': 0.77194816,
           'avg_obj': 0.5131946,
           'box_loss': 1.9876164,
           'class_loss': 1.6837877,
           'conf_loss': 10.171303,
           'precision50': 0.17898907,
           'recall50': 0.56579167},
     '5': {'avg_iou': 0.80222976,
           'avg_obj': 0.63790494,
           'box_loss': 1.0171219,
           'class_loss': 0.92868495,
           'conf_loss': 1.9635963,
           'precision50': 0.23950137,
           'recall50': 0.70666987},
     'AP': 0.37218305,
     'AP50': 0.55919266,
     'AP75': 0.40296918,
     'APl': 0.5018926,
     'APm': 0.3899215,
     'APs': 0.16705835,
     'ARl': 0.66320693,
     'ARm': 0.5601692,
     'ARmax1': 0.30108482,
     'ARmax10': 0.48893505,
     'ARmax100': 0.5293781,
     'ARs': 0.3088851,
     'global': {'total_loss': 61.988255},
     'validation_loss': 61.988255}
I0501 18:14:15.609224 140262404466496 controller.py:211] train | step:  200000 | training until step 220000...
I0501 19:05:07.594895 140262404466496 controller.py:425] train | step:  210000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.8339694,
           'avg_obj': 0.3655496,
           'box_loss': 4.833462,
           'class_loss': 3.851966,
           'conf_loss': 52.9684,
           'precision50': 0.20248733,
           'recall50': 0.31528607},
     '4': {'avg_iou': 0.8283312,
           'avg_obj': 0.5441809,
           'box_loss': 2.954788,
           'class_loss': 2.7141726,
           'conf_loss': 11.964978,
           'precision50': 0.22264405,
           'recall50': 0.57828236},
     '5': {'avg_iou': 0.83620226,
           'avg_obj': 0.6343552,
           'box_loss': 1.2166114,
           'class_loss': 1.2945557,
           'conf_loss': 1.9724178,
           'precision50': 0.29749194,
           'recall50': 0.7112572},
     'global': {'total_loss': 83.77126},
     'learning_rate': 0.001,
     'training_loss': 83.77126}
I0501 19:05:58.933866 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-210000.
I0501 20:05:56.362575 140262404466496 controller.py:425] train | step:  220000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.8344505,
           'avg_obj': 0.36905912,
           'box_loss': 4.8217483,
           'class_loss': 3.824269,
           'conf_loss': 52.428295,
           'precision50': 0.20461945,
           'recall50': 0.31884152},
     '4': {'avg_iou': 0.8285218,
           'avg_obj': 0.5477751,
           'box_loss': 2.9383976,
           'class_loss': 2.6842988,
           'conf_loss': 11.864214,
           'precision50': 0.22368713,
           'recall50': 0.5828827},
     '5': {'avg_iou': 0.8366615,
           'avg_obj': 0.6376162,
           'box_loss': 1.2064881,
           'class_loss': 1.2793995,
           'conf_loss': 1.9557643,
           'precision50': 0.2972155,
           'recall50': 0.71443415},
     'global': {'total_loss': 83.002884},
     'learning_rate': 0.001,
     'training_loss': 83.002884}
I0501 20:07:11.900566 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-220000.
I0501 20:07:11.908339 140262404466496 controller.py:252]  eval | step:  220000 | running 625 steps of evaluation...
I0501 20:11:32.486400 140262404466496 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 20:16:25.915968 140262404466496 controller.py:261]  eval | step:  220000 | eval time:  554.0 sec | output: 
    {'3': {'avg_iou': 0.61200315,
           'avg_obj': 0.2710643,
           'box_loss': 2.5788975,
           'class_loss': 1.9818951,
           'conf_loss': 39.6914,
           'precision50': 0.14234503,
           'recall50': 0.28651714},
     '4': {'avg_iou': 0.7700833,
           'avg_obj': 0.51544327,
           'box_loss': 1.9869394,
           'class_loss': 1.6997756,
           'conf_loss': 10.164855,
           'precision50': 0.17588593,
           'recall50': 0.5663639},
     '5': {'avg_iou': 0.80247855,
           'avg_obj': 0.64232624,
           'box_loss': 1.0075337,
           'class_loss': 0.93104434,
           'conf_loss': 1.9741089,
           'precision50': 0.23733237,
           'recall50': 0.70883924},
     'AP': 0.37305003,
     'AP50': 0.5586675,
     'AP75': 0.4024954,
     'APl': 0.5036836,
     'APm': 0.39015692,
     'APs': 0.1712001,
     'ARl': 0.6557639,
     'ARm': 0.55831045,
     'ARmax1': 0.29903015,
     'ARmax10': 0.48667789,
     'ARmax100': 0.52741194,
     'ARs': 0.31866872,
     'global': {'total_loss': 62.016468},
     'validation_loss': 62.016468}

train | step:  180000 | training until step 200000...
train | step:  190000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.83459413,
           'avg_obj': 0.35851404,
           'box_loss': 4.866177,
           'class_loss': 3.9472039,
           'conf_loss': 53.49943,
           'precision50': 0.20146829,
           'recall50': 0.30777365},
     '4': {'avg_iou': 0.8280156,
           'avg_obj': 0.5358793,
           'box_loss': 2.9961686,
           'class_loss': 2.7898676,
           'conf_loss': 12.153168,
           'precision50': 0.2222898,
           'recall50': 0.57027966},
     '5': {'avg_iou': 0.83575237,
           'avg_obj': 0.62704206,
           'box_loss': 1.23633,
           'class_loss': 1.332139,
           'conf_loss': 1.9964732,
           'precision50': 0.2973214,
           'recall50': 0.703853},
     'global': {'total_loss': 84.817},
     'learning_rate': 0.001,
     'training_loss': 84.817}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-190000.
train | step:  200000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.8343048,
           'avg_obj': 0.36171734,
           'box_loss': 4.842384,
           'class_loss': 3.905437,
           'conf_loss': 53.16427,
           'precision50': 0.20114179,
           'recall50': 0.3113159},
     '4': {'avg_iou': 0.82827044,
           'avg_obj': 0.53978217,
           'box_loss': 2.9732065,
           'class_loss': 2.7556581,
           'conf_loss': 12.05346,
           'precision50': 0.2220303,
           'recall50': 0.5738708},
     '5': {'avg_iou': 0.83607996,
           'avg_obj': 0.6305398,
           'box_loss': 1.2243644,
           'class_loss': 1.3147796,
           'conf_loss': 1.9837633,
           'precision50': 0.29789278,
           'recall50': 0.70718503},
     'global': {'total_loss': 84.21772},
     'learning_rate': 0.001,
     'training_loss': 84.21772}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-200000.
 eval | step:  200000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=197.42s).
Accumulating evaluation results...
DONE (t=38.26s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.372
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.559
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.403
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.167
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.390
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.502
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.301
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.489
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.529
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.309
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.560
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.663
 eval | step:  200000 | eval time:  547.5 sec | output: 
    {'3': {'avg_iou': 0.61322033,
           'avg_obj': 0.270778,
           'box_loss': 2.581181,
           'class_loss': 1.9653428,
           'conf_loss': 39.68966,
           'precision50': 0.14370474,
           'recall50': 0.28665087},
     '4': {'avg_iou': 0.77194816,
           'avg_obj': 0.5131946,
           'box_loss': 1.9876164,
           'class_loss': 1.6837877,
           'conf_loss': 10.171303,
           'precision50': 0.17898907,
           'recall50': 0.56579167},
     '5': {'avg_iou': 0.80222976,
           'avg_obj': 0.63790494,
           'box_loss': 1.0171219,
           'class_loss': 0.92868495,
           'conf_loss': 1.9635963,
           'precision50': 0.23950137,
           'recall50': 0.70666987},
     'AP': 0.37218305,
     'AP50': 0.55919266,
     'AP75': 0.40296918,
     'APl': 0.5018926,
     'APm': 0.3899215,
     'APs': 0.16705835,
     'ARl': 0.66320693,
     'ARm': 0.5601692,
     'ARmax1': 0.30108482,
     'ARmax10': 0.48893505,
     'ARmax100': 0.5293781,
     'ARs': 0.3088851,
     'global': {'total_loss': 61.988255},
     'validation_loss': 61.988255}
train | step:  200000 | training until step 220000...
train | step:  210000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.8339694,
           'avg_obj': 0.3655496,
           'box_loss': 4.833462,
           'class_loss': 3.851966,
           'conf_loss': 52.9684,
           'precision50': 0.20248733,
           'recall50': 0.31528607},
     '4': {'avg_iou': 0.8283312,
           'avg_obj': 0.5441809,
           'box_loss': 2.954788,
           'class_loss': 2.7141726,
           'conf_loss': 11.964978,
           'precision50': 0.22264405,
           'recall50': 0.57828236},
     '5': {'avg_iou': 0.83620226,
           'avg_obj': 0.6343552,
           'box_loss': 1.2166114,
           'class_loss': 1.2945557,
           'conf_loss': 1.9724178,
           'precision50': 0.29749194,
           'recall50': 0.7112572},
     'global': {'total_loss': 83.77126},
     'learning_rate': 0.001,
     'training_loss': 83.77126}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-210000.
train | step:  220000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.8344505,
           'avg_obj': 0.36905912,
           'box_loss': 4.8217483,
           'class_loss': 3.824269,
           'conf_loss': 52.428295,
           'precision50': 0.20461945,
           'recall50': 0.31884152},
     '4': {'avg_iou': 0.8285218,
           'avg_obj': 0.5477751,
           'box_loss': 2.9383976,
           'class_loss': 2.6842988,
           'conf_loss': 11.864214,
           'precision50': 0.22368713,
           'recall50': 0.5828827},
     '5': {'avg_iou': 0.8366615,
           'avg_obj': 0.6376162,
           'box_loss': 1.2064881,
           'class_loss': 1.2793995,
           'conf_loss': 1.9557643,
           'precision50': 0.2972155,
           'recall50': 0.71443415},
     'global': {'total_loss': 83.002884},
     'learning_rate': 0.001,
     'training_loss': 83.002884}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-220000.
 eval | step:  220000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=209.81s).
Accumulating evaluation results...
DONE (t=35.68s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.373
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.559
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.402
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.171
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.390
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.504
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.299
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.487
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.527
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.319
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.558
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.656
 eval | step:  220000 | eval time:  554.0 sec | output: 
    {'3': {'avg_iou': 0.61200315,
           'avg_obj': 0.2710643,
           'box_loss': 2.5788975,
           'class_loss': 1.9818951,
           'conf_loss': 39.6914,
           'precision50': 0.14234503,
           'recall50': 0.28651714},
     '4': {'avg_iou': 0.7700833,
           'avg_obj': 0.51544327,
           'box_loss': 1.9869394,
           'class_loss': 1.6997756,
           'conf_loss': 10.164855,
           'precision50': 0.17588593,
           'recall50': 0.5663639},
     '5': {'avg_iou': 0.80247855,
           'avg_obj': 0.64232624,
           'box_loss': 1.0075337,
           'class_loss': 0.93104434,
           'conf_loss': 1.9741089,
           'precision50': 0.23733237,
           'recall50': 0.70883924},
     'AP': 0.37305003,
     'AP50': 0.5586675,
     'AP75': 0.4024954,
     'APl': 0.5036836,
     'APm': 0.39015692,
     'APs': 0.1712001,
     'ARl': 0.6557639,
     'ARm': 0.55831045,
     'ARmax1': 0.29903015,
     'ARmax10': 0.48667789,
     'ARmax100': 0.52741194,
     'ARs': 0.31866872,
     'global': {'total_loss': 62.016468},
     'validation_loss': 62.016468}I0501 20:16:43.849774 140262404466496 controller.py:211] train | step:  220000 | training until step 240000...
I0501 21:09:06.342002 140262404466496 controller.py:425] train | step:  230000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.83407295,
           'avg_obj': 0.37215802,
           'box_loss': 4.8024015,
           'class_loss': 3.770732,
           'conf_loss': 52.156063,
           'precision50': 0.20456873,
           'recall50': 0.32249126},
     '4': {'avg_iou': 0.8284155,
           'avg_obj': 0.55178845,
           'box_loss': 2.9204733,
           'class_loss': 2.6476014,
           'conf_loss': 11.794214,
           'precision50': 0.22290413,
           'recall50': 0.587463},
     '5': {'avg_iou': 0.8366625,
           'avg_obj': 0.641246,
           'box_loss': 1.1976345,
           'class_loss': 1.2628756,
           'conf_loss': 1.9428943,
           'precision50': 0.29684544,
           'recall50': 0.71809036},
     'global': {'total_loss': 82.49495},
     'learning_rate': 0.001,
     'training_loss': 82.49495}
I0501 21:09:59.092339 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-230000.
I0501 22:09:04.359951 140262404466496 controller.py:425] train | step:  240000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.8337231,
           'avg_obj': 0.37501472,
           'box_loss': 4.804647,
           'class_loss': 3.7449758,
           'conf_loss': 52.09417,
           'precision50': 0.2033663,
           'recall50': 0.32565826},
     '4': {'avg_iou': 0.8284042,
           'avg_obj': 0.555237,
           'box_loss': 2.9067886,
           'class_loss': 2.6157115,
           'conf_loss': 11.744801,
           'precision50': 0.22216578,
           'recall50': 0.59065914},
     '5': {'avg_iou': 0.8369503,
           'avg_obj': 0.64437747,
           'box_loss': 1.1906714,
           'class_loss': 1.2448864,
           'conf_loss': 1.9254282,
           'precision50': 0.29739088,
           'recall50': 0.7213181},
     'global': {'total_loss': 82.272194},
     'learning_rate': 0.001,
     'training_loss': 82.272194}
I0501 22:09:52.426793 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-240000.
I0501 22:09:52.432522 140262404466496 controller.py:252]  eval | step:  240000 | running 625 steps of evaluation...
I0501 22:14:13.931484 140262404466496 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 22:19:24.268360 140262404466496 controller.py:261]  eval | step:  240000 | eval time:  571.8 sec | output: 
    {'3': {'avg_iou': 0.61630356,
           'avg_obj': 0.27201912,
           'box_loss': 2.5800846,
           'class_loss': 1.9780279,
           'conf_loss': 39.80063,
           'precision50': 0.14209218,
           'recall50': 0.28873676},
     '4': {'avg_iou': 0.7713381,
           'avg_obj': 0.51719856,
           'box_loss': 1.9908199,
           'class_loss': 1.710166,
           'conf_loss': 10.247077,
           'precision50': 0.1736514,
           'recall50': 0.5687586},
     '5': {'avg_iou': 0.80359983,
           'avg_obj': 0.6439087,
           'box_loss': 1.003045,
           'class_loss': 0.9325104,
           'conf_loss': 1.9686476,
           'precision50': 0.23576704,
           'recall50': 0.7096419},
     'AP': 0.3736316,
     'AP50': 0.55752397,
     'AP75': 0.40540794,
     'APl': 0.50647885,
     'APm': 0.3900176,
     'APs': 0.17018944,
     'ARl': 0.6608207,
     'ARm': 0.55750287,
     'ARmax1': 0.29917732,
     'ARmax10': 0.48682395,
     'ARmax100': 0.52753997,
     'ARs': 0.3190237,
     'global': {'total_loss': 62.211018},
     'validation_loss': 62.211018}
I0501 22:19:41.746950 140262404466496 controller.py:211] train | step:  240000 | training until step 260000...
I0501 23:09:49.501518 140262404466496 controller.py:425] train | step:  250000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.8334628,
           'avg_obj': 0.37785885,
           'box_loss': 4.791492,
           'class_loss': 3.7168179,
           'conf_loss': 51.968407,
           'precision50': 0.20328039,
           'recall50': 0.32899225},
     '4': {'avg_iou': 0.8284787,
           'avg_obj': 0.5582345,
           'box_loss': 2.8931367,
           'class_loss': 2.5892951,
           'conf_loss': 11.690843,
           'precision50': 0.22253662,
           'recall50': 0.5942382},
     '5': {'avg_iou': 0.83731633,
           'avg_obj': 0.6472724,
           'box_loss': 1.1812379,
           'class_loss': 1.2297474,
           'conf_loss': 1.9123533,
           'precision50': 0.29756224,
           'recall50': 0.7234639},
     'global': {'total_loss': 81.97327},
     'learning_rate': 0.001,
     'training_loss': 81.97327}
I0501 23:10:39.697019 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-250000.
I0502 00:10:15.327548 140262404466496 controller.py:425] train | step:  260000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.83309764,
           'avg_obj': 0.38093966,
           'box_loss': 4.77877,
           'class_loss': 3.685583,
           'conf_loss': 51.745426,
           'precision50': 0.20259932,
           'recall50': 0.3330627},
     '4': {'avg_iou': 0.82851356,
           'avg_obj': 0.56187284,
           'box_loss': 2.8805203,
           'class_loss': 2.5666735,
           'conf_loss': 11.6246605,
           'precision50': 0.22205222,
           'recall50': 0.5980361},
     '5': {'avg_iou': 0.83743495,
           'avg_obj': 0.65032715,
           'box_loss': 1.1758636,
           'class_loss': 1.216735,
           'conf_loss': 1.8993884,
           'precision50': 0.29777512,
           'recall50': 0.7273011},
     'global': {'total_loss': 81.573654},
     'learning_rate': 0.001,
     'training_loss': 81.573654}
I0502 00:11:10.533089 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-260000.
I0502 00:11:10.539541 140262404466496 controller.py:252]  eval | step:  260000 | running 625 steps of evaluation...
I0502 00:15:32.389710 140262404466496 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0502 00:20:28.731226 140262404466496 controller.py:261]  eval | step:  260000 | eval time:  558.2 sec | output: 
    {'3': {'avg_iou': 0.61537033,
           'avg_obj': 0.27047035,
           'box_loss': 2.5788932,
           'class_loss': 1.98059,
           'conf_loss': 39.956177,
           'precision50': 0.14090644,
           'recall50': 0.2863299},
     '4': {'avg_iou': 0.7714439,
           'avg_obj': 0.51780385,
           'box_loss': 1.9850549,
           'class_loss': 1.7058426,
           'conf_loss': 10.261006,
           'precision50': 0.17412157,
           'recall50': 0.569724},
     '5': {'avg_iou': 0.80358857,
           'avg_obj': 0.6458381,
           'box_loss': 0.995587,
           'class_loss': 0.9339512,
           'conf_loss': 1.9650466,
           'precision50': 0.23686069,
           'recall50': 0.7111089},
     'AP': 0.3733505,
     'AP50': 0.5569613,
     'AP75': 0.40369415,
     'APl': 0.5076196,
     'APm': 0.3865255,
     'APs': 0.17069553,
     'ARl': 0.65953404,
     'ARm': 0.5554834,
     'ARmax1': 0.29945034,
     'ARmax10': 0.4860526,
     'ARmax100': 0.5277818,
     'ARs': 0.31779277,
     'global': {'total_loss': 62.362183},
     'validation_loss': 62.362183}

train | step:  220000 | training until step 240000...
train | step:  230000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.83407295,
           'avg_obj': 0.37215802,
           'box_loss': 4.8024015,
           'class_loss': 3.770732,
           'conf_loss': 52.156063,
           'precision50': 0.20456873,
           'recall50': 0.32249126},
     '4': {'avg_iou': 0.8284155,
           'avg_obj': 0.55178845,
           'box_loss': 2.9204733,
           'class_loss': 2.6476014,
           'conf_loss': 11.794214,
           'precision50': 0.22290413,
           'recall50': 0.587463},
     '5': {'avg_iou': 0.8366625,
           'avg_obj': 0.641246,
           'box_loss': 1.1976345,
           'class_loss': 1.2628756,
           'conf_loss': 1.9428943,
           'precision50': 0.29684544,
           'recall50': 0.71809036},
     'global': {'total_loss': 82.49495},
     'learning_rate': 0.001,
     'training_loss': 82.49495}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-230000.
train | step:  240000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.8337231,
           'avg_obj': 0.37501472,
           'box_loss': 4.804647,
           'class_loss': 3.7449758,
           'conf_loss': 52.09417,
           'precision50': 0.2033663,
           'recall50': 0.32565826},
     '4': {'avg_iou': 0.8284042,
           'avg_obj': 0.555237,
           'box_loss': 2.9067886,
           'class_loss': 2.6157115,
           'conf_loss': 11.744801,
           'precision50': 0.22216578,
           'recall50': 0.59065914},
     '5': {'avg_iou': 0.8369503,
           'avg_obj': 0.64437747,
           'box_loss': 1.1906714,
           'class_loss': 1.2448864,
           'conf_loss': 1.9254282,
           'precision50': 0.29739088,
           'recall50': 0.7213181},
     'global': {'total_loss': 82.272194},
     'learning_rate': 0.001,
     'training_loss': 82.272194}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-240000.
 eval | step:  240000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=213.56s).
Accumulating evaluation results...
DONE (t=37.61s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.374
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.558
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.405
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.170
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.390
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.506
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.299
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.487
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.528
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.319
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.558
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.661
 eval | step:  240000 | eval time:  571.8 sec | output: 
    {'3': {'avg_iou': 0.61630356,
           'avg_obj': 0.27201912,
           'box_loss': 2.5800846,
           'class_loss': 1.9780279,
           'conf_loss': 39.80063,
           'precision50': 0.14209218,
           'recall50': 0.28873676},
     '4': {'avg_iou': 0.7713381,
           'avg_obj': 0.51719856,
           'box_loss': 1.9908199,
           'class_loss': 1.710166,
           'conf_loss': 10.247077,
           'precision50': 0.1736514,
           'recall50': 0.5687586},
     '5': {'avg_iou': 0.80359983,
           'avg_obj': 0.6439087,
           'box_loss': 1.003045,
           'class_loss': 0.9325104,
           'conf_loss': 1.9686476,
           'precision50': 0.23576704,
           'recall50': 0.7096419},
     'AP': 0.3736316,
     'AP50': 0.55752397,
     'AP75': 0.40540794,
     'APl': 0.50647885,
     'APm': 0.3900176,
     'APs': 0.17018944,
     'ARl': 0.6608207,
     'ARm': 0.55750287,
     'ARmax1': 0.29917732,
     'ARmax10': 0.48682395,
     'ARmax100': 0.52753997,
     'ARs': 0.3190237,
     'global': {'total_loss': 62.211018},
     'validation_loss': 62.211018}
train | step:  240000 | training until step 260000...
train | step:  250000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.8334628,
           'avg_obj': 0.37785885,
           'box_loss': 4.791492,
           'class_loss': 3.7168179,
           'conf_loss': 51.968407,
           'precision50': 0.20328039,
           'recall50': 0.32899225},
     '4': {'avg_iou': 0.8284787,
           'avg_obj': 0.5582345,
           'box_loss': 2.8931367,
           'class_loss': 2.5892951,
           'conf_loss': 11.690843,
           'precision50': 0.22253662,
           'recall50': 0.5942382},
     '5': {'avg_iou': 0.83731633,
           'avg_obj': 0.6472724,
           'box_loss': 1.1812379,
           'class_loss': 1.2297474,
           'conf_loss': 1.9123533,
           'precision50': 0.29756224,
           'recall50': 0.7234639},
     'global': {'total_loss': 81.97327},
     'learning_rate': 0.001,
     'training_loss': 81.97327}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-250000.
train | step:  260000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.83309764,
           'avg_obj': 0.38093966,
           'box_loss': 4.77877,
           'class_loss': 3.685583,
           'conf_loss': 51.745426,
           'precision50': 0.20259932,
           'recall50': 0.3330627},
     '4': {'avg_iou': 0.82851356,
           'avg_obj': 0.56187284,
           'box_loss': 2.8805203,
           'class_loss': 2.5666735,
           'conf_loss': 11.6246605,
           'precision50': 0.22205222,
           'recall50': 0.5980361},
     '5': {'avg_iou': 0.83743495,
           'avg_obj': 0.65032715,
           'box_loss': 1.1758636,
           'class_loss': 1.216735,
           'conf_loss': 1.8993884,
           'precision50': 0.29777512,
           'recall50': 0.7273011},
     'global': {'total_loss': 81.573654},
     'learning_rate': 0.001,
     'training_loss': 81.573654}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-260000.
 eval | step:  260000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=202.55s).
Accumulating evaluation results...
DONE (t=34.65s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.373
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.557
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.404
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.171
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.387
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.508
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.299
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.486
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.528
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.318
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.555
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.660
 eval | step:  260000 | eval time:  558.2 sec | output: 
    {'3': {'avg_iou': 0.61537033,
           'avg_obj': 0.27047035,
           'box_loss': 2.5788932,
           'class_loss': 1.98059,
           'conf_loss': 39.956177,
           'precision50': 0.14090644,
           'recall50': 0.2863299},
     '4': {'avg_iou': 0.7714439,
           'avg_obj': 0.51780385,
           'box_loss': 1.9850549,
           'class_loss': 1.7058426,
           'conf_loss': 10.261006,
           'precision50': 0.17412157,
           'recall50': 0.569724},
     '5': {'avg_iou': 0.80358857,
           'avg_obj': 0.6458381,
           'box_loss': 0.995587,
           'class_loss': 0.9339512,
           'conf_loss': 1.9650466,
           'precision50': 0.23686069,
           'recall50': 0.7111089},
     'AP': 0.3733505,
     'AP50': 0.5569613,
     'AP75': 0.40369415,
     'APl': 0.5076196,
     'APm': 0.3865255,
     'APs': 0.17069553,
     'ARl': 0.65953404,
     'ARm': 0.5554834,
     'ARmax1': 0.29945034,
     'ARmax10': 0.4860526,
     'ARmax100': 0.5277818,
     'ARs': 0.31779277,
     'global': {'total_loss': 62.362183},
     'validation_loss': 62.362183}I0502 00:20:46.300995 140262404466496 controller.py:211] train | step:  260000 | training until step 280000...
I0502 01:11:04.960915 140262404466496 controller.py:425] train | step:  270000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.83265704,
           'avg_obj': 0.3839435,
           'box_loss': 4.7703614,
           'class_loss': 3.649034,
           'conf_loss': 51.632042,
           'precision50': 0.20507908,
           'recall50': 0.33525756},
     '4': {'avg_iou': 0.82858235,
           'avg_obj': 0.56542176,
           'box_loss': 2.8673697,
           'class_loss': 2.5348396,
           'conf_loss': 11.545785,
           'precision50': 0.22261563,
           'recall50': 0.6019745},
     '5': {'avg_iou': 0.8376601,
           'avg_obj': 0.65315944,
           'box_loss': 1.1690131,
           'class_loss': 1.2011759,
           'conf_loss': 1.887458,
           'precision50': 0.2970298,
           'recall50': 0.7298808},
     'global': {'total_loss': 81.25719},
     'learning_rate': 0.001,
     'training_loss': 81.25719}
I0502 01:11:56.628438 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-270000.
I0502 02:11:11.533555 140262404466496 controller.py:425] train | step:  280000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.8329186,
           'avg_obj': 0.38667956,
           'box_loss': 4.743145,
           'class_loss': 3.6137965,
           'conf_loss': 51.1029,
           'precision50': 0.20599858,
           'recall50': 0.33848834},
     '4': {'avg_iou': 0.8286734,
           'avg_obj': 0.56839436,
           'box_loss': 2.8485286,
           'class_loss': 2.5094266,
           'conf_loss': 11.463191,
           'precision50': 0.2222557,
           'recall50': 0.6048302},
     '5': {'avg_iou': 0.83793604,
           'avg_obj': 0.6558604,
           'box_loss': 1.1617619,
           'class_loss': 1.1869947,
           'conf_loss': 1.8695775,
           'precision50': 0.29830375,
           'recall50': 0.7323804},
     'global': {'total_loss': 80.49941},
     'learning_rate': 0.001,
     'training_loss': 80.49941}
I0502 02:12:01.149876 140262404466496 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test5/ckpt-280000.
I0502 02:12:01.156468 140262404466496 controller.py:252]  eval | step:  280000 | running 625 steps of evaluation...
I0502 02:16:22.259763 140262404466496 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0502 02:21:24.770384 140262404466496 controller.py:261]  eval | step:  280000 | eval time:  563.6 sec | output: 
    {'3': {'avg_iou': 0.6095993,
           'avg_obj': 0.27450022,
           'box_loss': 2.5700235,
           'class_loss': 1.9794742,
           'conf_loss': 40.05749,
           'precision50': 0.14298196,
           'recall50': 0.29286417},
     '4': {'avg_iou': 0.7705436,
           'avg_obj': 0.5215879,
           'box_loss': 1.976458,
           'class_loss': 1.7145871,
           'conf_loss': 10.291214,
           'precision50': 0.17401871,
           'recall50': 0.573011},
     '5': {'avg_iou': 0.8044616,
           'avg_obj': 0.6492624,
           'box_loss': 0.9946323,
           'class_loss': 0.942999,
           'conf_loss': 1.9624933,
           'precision50': 0.23785615,
           'recall50': 0.7166527},
     'AP': 0.3759567,
     'AP50': 0.5577233,
     'AP75': 0.40703616,
     'APl': 0.510133,
     'APm': 0.3893294,
     'APs': 0.1738522,
     'ARl': 0.6603073,
     'ARm': 0.5600902,
     'ARmax1': 0.30178353,
     'ARmax10': 0.48920953,
     'ARmax100': 0.5303643,
     'ARs': 0.3190931,
     'global': {'total_loss': 62.4894},
     'validation_loss': 62.4894}
I0502 02:21:42.801312 140262404466496 controller.py:211] train | step:  280000 | training until step 300000...
/home/cam2tensorflow/.experiment_start.sh: line 22: 17129 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4-$5
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   204    0     2  100   202     11   1181 --:--:-- --:--:-- --:--:--  1192
okRequest issued for: [node-5]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-02T02:28:34.088212087Z'
  endTime: '2021-05-02T02:29:27.067274810Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619922514058-5c14f9a039ec9-3073b60a-31dd9ed4
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619922514058-5c14f9a039ec9-3073b60a-31dd9ed4] to complete...
...............................................................................................................................................................................................................................................................................done.
