cat: .experiment_zone: No such file or directory
Request issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-29T22:11:08.883125393Z'
  endTime: '2021-04-29T22:11:47.903567171Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619734268868-5c123c5b9f91a-44c6d99d-113dff08
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T05:45:10.821112479Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T05:44:59.159875+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T19:29:05.781890630Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T19:28:54.243943+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619734268868-5c123c5b9f91a-44c6d99d-113dff08] to complete...
...........................................................................................................................................................................................................................................................................done.
europe-west4-a
I0429 22:08:58.296421 140231479412544 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.2,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.3,
                                         'aug_scale_max': 2.0,
                                         'aug_scale_min': 0.1,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [400000,
                                                                                450000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.001,
                                                                            0.0001,
                                                                            1e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 500000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0429 22:08:58.297724 140231479412544 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/params.yaml
I0429 22:08:59.922093 140231479412544 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0429 22:09:00.542464 140231479412544 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0429 22:09:00.542782 140231479412544 transport.py:157] Attempting refresh to obtain initial access_token
I0429 22:09:00.610863 140231479412544 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0429 22:09:01.229401 140231479412544 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0429 22:09:01.229645 140231479412544 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-29 22:09:01.285053: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0429 22:09:01.285872 140231479412544 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0429 22:09:01.900996 140231479412544 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0429 22:09:01.901465 140231479412544 transport.py:157] Attempting refresh to obtain initial access_token
I0429 22:09:01.949257 140231479412544 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0429 22:09:02.565104 140231479412544 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0429 22:09:02.565370 140231479412544 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-29 22:09:02.626576: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-29 22:09:02.673848: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-04-29 22:09:02.673927: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:61532}
2021-04-29 22:09:13.392806: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-04-29 22:09:13.392893: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:61532}
2021-04-29 22:09:13.394032: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:61532
I0429 22:09:13.395081 140231479412544 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-1
I0429 22:09:13.396100 140231479412544 tpu_strategy_util.py:74] Initializing the TPU system: node-1
INFO:tensorflow:Clearing out eager caches
I0429 22:09:21.690906 140231479412544 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0429 22:09:21.693253 140231479412544 tpu_strategy_util.py:133] Finished initializing TPU system.
I0429 22:09:21.696647 140231479412544 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0429 22:09:22.310656 140231479412544 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0429 22:09:22.311004 140231479412544 transport.py:157] Attempting refresh to obtain initial access_token
I0429 22:09:22.359994 140231479412544 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0429 22:09:22.976975 140231479412544 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0429 22:09:22.977267 140231479412544 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0429 22:09:23.026754 140231479412544 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0429 22:09:23.026998 140231479412544 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0429 22:09:23.027406 140231479412544 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0429 22:09:23.027477 140231479412544 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0429 22:09:23.027529 140231479412544 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0429 22:09:23.027698 140231479412544 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0429 22:09:23.027752 140231479412544 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0429 22:09:23.027801 140231479412544 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0429 22:09:23.027870 140231479412544 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0429 22:09:23.027994 140231479412544 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0429 22:09:23.028131 140231479412544 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0429 22:09:23.028330 140231479412544 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0429 22:09:23.028390 140231479412544 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0429 22:09:23.028473 140231479412544 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0429 22:09:23.028587 140231479412544 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0429 22:09:23.028684 140231479412544 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0429 22:09:23.030001 140231479412544 train_utils.py:214] Running default trainer.
2021-04-29 22:09:23.152304: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.2, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.3, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [400000, 450000], 'values': [0.001, 0.0001, 1e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 500000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f89cb41aa90>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________
yolo_fpn (YoloFPN)              {'5': (None, 16, 16, 9626112     input_2[0][0]                    
                                                                 input_3[0][0]                    I0429 22:10:15.702122 140231479412544 controller.py:362] restoring or initializing model...
I0429 22:10:26.010974 140231479412544 yolo.py:542] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0429 22:10:26.012647 140231479412544 controller.py:368] initialized model.
I0429 22:10:26.012874 140231479412544 train_lib.py:96] Starts to execute mode: train_and_eval
I0429 22:10:26.017252 140231479412544 controller.py:211] train | step:      0 | training until step 20000...
I0429 22:10:34.335997 140231479412544 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0429 22:11:42.280884 140231479412544 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
2021-04-29 22:13:11.462833: W tensorflow/core/distributed_runtime/eager/remote_tensor_handle_data.cc:76] Unable to destroy remote tensor handles. If you are running a tf.function, it usually indicates some op in the graph gets an error: 7 root error(s) found.
  (0) Not found: {{function_node __inference_loop_fn_246191}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_2811963093750746413/_147}}]]
  (1) Invalid argument: {{function_node __inference_loop_fn_246191}} Compilation failure: Input 1 to node `while/body/_1/yolo/cspdarknet53/ConvBN_0_0/Pad` with op Pad must be a compile-time constant.

XLA compilation requires that operator arguments that represent shapes or dimensions be evaluated to concrete values at compile time. This error means that a shape or dimension argument could not be evaluated at compile time, usually because the value of the argument depends on a parameter to the computation, on a variable, or on a stateful operation such as a random number generator.
	 [[{{node while/body/_1/yolo/cspdarknet53/ConvBN_0_0/Pad}}]]
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_9076745383832093068/_130]]
	 [[TPUVariableReshard/last_iteration/_1528697847462863027/_132/_88]]
  (2) Invalid argument: {{function_node __inference_loop_fn_246191}} Compilation failure: Input 1 to node `while/body/_1/yolo/cspdarknet53/ConvBN_0_0/Pad` with op Pad must be a compile-time constant.

XLA compilation requires that operator arguments that represent shapes or dimensions be evaluated to concrete values at compile time. This error means that a shape or dimension argument could not be evaluated at compile time, usually because the value of the argument depends on a parameter to the computation, on a variable, or on a stateful operation such as a random number generator.
	 [[{{node while/body/_1/yolo/cspdarknet53/ConvBN_0_0/Pad}}]]
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_9076745383832093068/_130]]
	 [[Func/while/body/_1/input/_4691/_1747]]
  (3) Not found: {{function_node __inference_loop_fn_246191}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_15597302331242910214/_144}}]]
  (4) Not found: {{function_node __inference_loop_fn_246191}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_2110610257255519554/_135}}]]
  (5) Invalid argument: {{function_node __inference_loop_fn_246191}} Compilation failure: Input 1 to node `while/body/_1/yolo/cspdarknet53/ConvBN_0_0/Pad` with op Pad must be a compile-time constant.

XLA compilation requires that operator arguments that represent shapes or dimensions be evaluated to concrete values at compile time. This error means that a shape or dimension argument could not be evaluated at compile time, usually because the value of the argument depends on a parameter to the computation, on a variable, or on a stateful operation such as a random number generator.
	 [[{{node while/body/_1/yolo/cspdarknet53/ConvBN_0_0/Pad}}]]
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_9076745383832093068/_130]]
  (6) Not found: {{function_node __inference_loop_fn_246191}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/resha ... [truncated]
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 149, in main
    model_dir=model_dir)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_lib.py", line 104, in run_experiment
    eval_interval=params.trainer.validation_interval)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 303, in train_and_evaluate
    self.train(steps=num_steps, checkpoint_at_completion=False)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 215, in train
    self._train_n_steps(num_steps)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 410, in _train_n_steps
    train_output = self.trainer.train(num_steps_tensor)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/standard_runner.py", line 142, in train
    return self.train_loop_end()
  File "/home/cam2tensorflow/TensorFlowModels/official/core/base_trainer.py", line 276, in train_loop_end
    self._recovery.maybe_recover(self.train_loss.result().numpy(),
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 1071, in numpy
    maybe_arr = self._numpy()  # pylint: disable=protected-access
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 1039, in _numpy
    six.raise_from(core._status_to_exception(e.code, e.message), None)  # pylint: disable=protected-access
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.NotFoundError: 7 root error(s) found.
  (0) Not found: {{function_node __inference_loop_fn_246191}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_2811963093750746413/_147}}]]
  (1) Invalid argument: {{function_node __inference_loop_fn_246191}} Compilation failure: Input 1 to node `while/body/_1/yolo/cspdarknet53/ConvBN_0_0/Pad` with op Pad must be a compile-time constant.

XLA compilation requires that operator arguments that represent shapes or dimensions be evaluated to concrete values at compile time. This error means that a shape or dimension argument could not be evaluated at compile time, usually because the value of the argument depends on a parameter to the computation, on a variable, or on a stateful operation such as a random number generator.
	 [[{{node while/body/_1/yolo/cspdarknet53/ConvBN_0_0/Pad}}]]
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_9076745383832093068/_130]]
	 [[TPUVariableReshard/last_iteration/_1528697847462863027/_132/_88]]
  (2) Invalid argument: {{function_node __inference_loop_fn_246191}} Compilation failure: Input 1 to node `while/body/_1/yolo/cspdarknet53/ConvBN_0_0/Pad` with op Pad must be a compile-time constant.

XLA compilation requires that operator arguments that represent shapes or dimensions be evaluated to concrete values at compile time. This error means that a shape or dimension argument could not be evaluated at compile time, usually because the value of the argument depends on a parameter to the computation, on a variable, or on a stateful operation such as a random number generator.
	 [[{{node while/body/_1/yolo/cspdarknet53/ConvBN_0_0/Pad}}]]
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_9076745383832093068/_130]]
	 [[Func/while/body/_1/input/_4691/_1747]]
  (3) Not found: {{function_node __inference_loop_fn_246191}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_15597302331242910214/_144}}]]
  (4) Not found: {{function_node __inference_loop_fn_246191}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_2110610257255519554/_135}}]]
  (5) Invalid argument: {{function_node __inference_loop_fn_246191}} Compilation failure: Input 1 to node `while/body/_1/yolo/cspdarknet53/ConvBN_0_0/Pad` with op Pad must be a compile-time constant.

XLA compilation requires that operator arguments that represent shapes or dimensions be evaluated to concrete values at compile time. This error means that a shape or dimension argument could not be evaluated at compile time, usually because the value of the argument depends on a parameter to the computation, on a variable, or on a stateful operation such as a random number generator.
	 [[{{node while/body/_1/yolo/cspdarknet53/ConvBN_0_0/Pad}}]]
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_9076745383832093068/_130]]
  (6) Not found: {{function_node __inference_loop_fn_246191}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/resha ... [truncated]
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/tpu_strategy.py", line 738, in async_wait
    context.async_wait()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/context.py", line 2330, in async_wait
    context().sync_executors()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/context.py", line 645, in sync_executors
    pywrap_tfe.TFE_ContextSyncExecutors(self._context_handle)
tensorflow.python.framework.errors_impl.NotFoundError: 7 root error(s) found.
  (0) Not found: {{function_node __inference_loop_fn_246191}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_2811963093750746413/_147}}]]
  (1) Invalid argument: {{function_node __inference_loop_fn_246191}} Compilation failure: Input 1 to node `while/body/_1/yolo/cspdarknet53/ConvBN_0_0/Pad` with op Pad must be a compile-time constant.

XLA compilation requires that operator arguments that represent shapes or dimensions be evaluated to concrete values at compile time. This error means that a shape or dimension argument could not be evaluated at compile time, usually because the value of the argument depends on a parameter to the computation, on a variable, or on a stateful operation such as a random number generator.
	 [[{{node while/body/_1/yolo/cspdarknet53/ConvBN_0_0/Pad}}]]
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_9076745383832093068/_130]]
	 [[TPUVariableReshard/last_iteration/_1528697847462863027/_132/_88]]
  (2) Invalid argument: {{function_node __inference_loop_fn_246191}} Compilation failure: Input 1 to node `while/body/_1/yolo/cspdarknet53/ConvBN_0_0/Pad` with op Pad must be a compile-time constant.

XLA compilation requires that operator arguments that represent shapes or dimensions be evaluated to concrete values at compile time. This error means that a shape or dimension argument could not be evaluated at compile time, usually because the value of the argument depends on a parameter to the computation, on a variable, or on a stateful operation such as a random number generator.
	 [[{{node while/body/_1/yolo/cspdarknet53/ConvBN_0_0/Pad}}]]
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_9076745383832093068/_130]]
	 [[Func/while/body/_1/input/_4691/_1747]]
  (3) Not found: {{function_node __inference_loop_fn_246191}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_15597302331242910214/_144}}]]
  (4) Not found: {{function_node __inference_loop_fn_246191}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_2110610257255519554/_135}}]]
  (5) Invalid argument: {{function_node __inference_loop_fn_246191}} Compilation failure: Input 1 to node `while/body/_1/yolo/cspdarknet53/ConvBN_0_0/Pad` with op Pad must be a compile-time constant.

XLA compilation requires that operator arguments that represent shapes or dimensions be evaluated to concrete values at compile time. This error means that a shape or dimension argument could not be evaluated at compile time, usually because the value of the argument depends on a parameter to the computation, on a variable, or on a stateful operation such as a random number generator.
	 [[{{node while/body/_1/yolo/cspdarknet53/ConvBN_0_0/Pad}}]]
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_9076745383832093068/_130]]
  (6) Not found: {{function_node __inference_loop_fn_246191}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/resha ... [truncated]

                                                                 input_4[0][0]                    
__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'3': (None, 64, 64, 16271360    yolo_fpn[0][0]                   
                                                                 yolo_fpn[0][1]                   
                                                                 yolo_fpn[0][2]                   
==================================================================================================
Total params: 25,897,472
Trainable params: 25,867,520
Non-trainable params: 29,952
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 200, 8), 4: (8, 200, 8), 5: (8, 200, 8)}, inds: {3: (8, 200, 3), 4: (8, 200, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
2021-04-29 22:13:17.797335: W ./tensorflow/core/distributed_runtime/eager/destroy_tensor_handle_node.h:57] Ignoring an error encountered when deleting remote tensors handles: Invalid argument: Unable to find the relevant tensor remote_handle: Op ID: 42957, Output num: 0
Additional GRPC error information from remote target /job:worker/replica:0/task:0:
:{"created":"@1619734397.797079654","description":"Error received from peer ipv4:10.62.133.178:8470","file":"external/com_github_grpc_grpc/src/core/lib/surface/call.cc","file_line":1056,"grpc_message":"Unable to find the relevant tensor remote_handle: Op ID: 42957, Output num: 0","grpc_status":3}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   204    0     2  100   202     11   1141 --:--:-- --:--:-- --:--:--  1146
okRequest issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-29T22:16:44.046888933Z'
  endTime: '2021-04-29T22:17:19.678361972Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619734604033-5c123d9b42dd2-a30acccf-9741df6f
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T05:45:10.821112479Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T05:44:59.159875+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T19:29:05.781890630Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T19:28:54.243943+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619734604033-5c123d9b42dd2-a30acccf-9741df6f] to complete...
...........................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-29T22:17:35.597191741Z'
  endTime: '2021-04-29T22:18:10.750585563Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619734655582-5c123dcc6c25b-0ae62476-9a767699
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T05:45:10.821112479Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T05:44:59.159875+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T19:29:05.781890630Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T19:28:54.243943+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619734655582-5c123dcc6c25b-0ae62476-9a767699] to complete...
....................................................................................................................................................................................................done.
europe-west4-a
I0429 22:14:59.012661 140290927105856 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.2,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.3,
                                         'aug_scale_max': 2.0,
                                         'aug_scale_min': 0.1,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [400000,
                                                                                450000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.001,
                                                                            0.0001,
                                                                            1e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 500000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0429 22:14:59.013721 140290927105856 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/params.yaml
I0429 22:14:59.825542 140290927105856 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0429 22:14:59.966422 140290927105856 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0429 22:14:59.966687 140290927105856 transport.py:157] Attempting refresh to obtain initial access_token
I0429 22:15:00.034362 140290927105856 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0429 22:15:00.649347 140290927105856 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0429 22:15:00.649622 140290927105856 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-29 22:15:00.703820: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0429 22:15:00.704528 140290927105856 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0429 22:15:01.318482 140290927105856 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0429 22:15:01.318985 140290927105856 transport.py:157] Attempting refresh to obtain initial access_token
I0429 22:15:01.369474 140290927105856 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0429 22:15:01.989345 140290927105856 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0429 22:15:01.989831 140290927105856 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-29 22:15:02.135815: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-29 22:15:02.147529: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-04-29 22:15:02.147605: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:61842}
2021-04-29 22:15:37.553686: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-04-29 22:15:37.553816: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:61842}
2021-04-29 22:15:37.554446: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:61842
I0429 22:15:37.555474 140290927105856 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-1
I0429 22:15:37.556162 140290927105856 tpu_strategy_util.py:74] Initializing the TPU system: node-1
INFO:tensorflow:Clearing out eager caches
I0429 22:15:45.753041 140290927105856 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0429 22:15:45.756037 140290927105856 tpu_strategy_util.py:133] Finished initializing TPU system.
I0429 22:15:45.758918 140290927105856 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0429 22:15:46.407117 140290927105856 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0429 22:15:46.408464 140290927105856 transport.py:157] Attempting refresh to obtain initial access_token
I0429 22:15:46.492220 140290927105856 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0429 22:15:46.664449 140290927105856 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0429 22:15:46.665179 140290927105856 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0429 22:15:46.732483 140290927105856 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0429 22:15:46.732774 140290927105856 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0429 22:15:46.733185 140290927105856 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0429 22:15:46.733303 140290927105856 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0429 22:15:46.733404 140290927105856 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0429 22:15:46.733659 140290927105856 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0429 22:15:46.733760 140290927105856 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0429 22:15:46.733863 140290927105856 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0429 22:15:46.733960 140290927105856 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0429 22:15:46.734051 140290927105856 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0429 22:15:46.734146 140290927105856 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0429 22:15:46.734245 140290927105856 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0429 22:15:46.734352 140290927105856 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0429 22:15:46.734440 140290927105856 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0429 22:15:46.734528 140290927105856 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0429 22:15:46.734620 140290927105856 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0429 22:15:46.736440 140290927105856 train_utils.py:214] Running default trainer.
2021-04-29 22:15:46.782101: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.2, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.3, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [400000, 450000], 'values': [0.001, 0.0001, 1e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 500000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f97a00b5b70>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________
yolo_fpn (YoloFPN)              {'5': (None, 16, 16, 9626112     input_2[0][0]                    
                                                                 input_3[0][0]                    I0429 22:16:42.430799 140290927105856 controller.py:362] restoring or initializing model...
I0429 22:16:56.126697 140290927105856 yolo.py:542] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0429 22:16:56.128842 140290927105856 controller.py:368] initialized model.
I0429 22:16:56.129098 140290927105856 train_lib.py:96] Starts to execute mode: train_and_eval
I0429 22:16:56.134999 140290927105856 controller.py:211] train | step:      0 | training until step 20000...
I0429 22:17:02.608748 140290927105856 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0429 22:18:13.439584 140290927105856 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0429 23:30:42.297599 140290927105856 controller.py:425] train | step:  10000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.5256774,
           'avg_obj': 0.005990361,
           'box_loss': 7.478024,
           'class_loss': 21.870905,
           'conf_loss': 146.78737,
           'precision50': 2.666322e-05,
           'recall50': 0.0033705062},
     '4': {'avg_iou': 0.580144,
           'avg_obj': 0.093118966,
           'box_loss': 6.376452,
           'class_loss': 20.007048,
           'conf_loss': 14.82448,
           'precision50': 0.12366363,
           'recall50': 0.063615985},
     '5': {'avg_iou': 0.5850307,
           'avg_obj': 0.12385907,
           'box_loss': 3.1313624,
           'class_loss': 9.77586,
           'conf_loss': 3.1744268,
           'precision50': 0.15861444,
           'recall50': 0.09002532},
     'global': {'total_loss': 233.4262},
     'learning_rate': 0.001,
     'training_loss': 233.4262}
I0429 23:31:34.380496 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-10000.
I0430 00:31:16.049952 140290927105856 controller.py:425] train | step:  20000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.5889374,
           'avg_obj': 1.0738976e-05,
           'box_loss': 6.4746146,
           'class_loss': 6.5209436,
           'conf_loss': 24.883696,
           'precision50': 0.0,
           'recall50': 0.0},
     '4': {'avg_iou': 0.6757152,
           'avg_obj': 0.21692398,
           'box_loss': 4.9213967,
           'class_loss': 5.169748,
           'conf_loss': 7.322879,
           'precision50': 0.2067941,
           'recall50': 0.19953394},
     '5': {'avg_iou': 0.6884427,
           'avg_obj': 0.2687515,
           'box_loss': 2.3491642,
           'class_loss': 2.4748185,
           'conf_loss': 1.396273,
           'precision50': 0.3195996,
           'recall50': 0.2604824},
     'global': {'total_loss': 61.513596},
     'learning_rate': 0.001,
     'training_loss': 61.513596}
I0430 00:32:03.389786 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-20000.
I0430 00:32:03.396820 140290927105856 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0430 00:32:04.137004 140290927105856 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0430 00:32:23.173975 140290927105856 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0430 00:37:19.935409 140290927105856 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0430 00:42:23.884097 140290927105856 controller.py:261]  eval | step:  20000 | eval time:  620.5 sec | output: 
    {'3': {'avg_iou': 0.4494984,
           'avg_obj': 3.3321992e-06,
           'box_loss': 3.3841434,
           'class_loss': 2.604203,
           'conf_loss': 24.143942,
           'precision50': 0.0,
           'recall50': 0.0},
     '4': {'avg_iou': 0.6448772,
           'avg_obj': 0.29125056,
           'box_loss': 2.9117892,
           'class_loss': 2.2179472,
           'conf_loss': 6.0534463,
           'precision50': 0.17379689,
           'recall50': 0.3011351},
     '5': {'avg_iou': 0.6818185,
           'avg_obj': 0.3636523,
           'box_loss': 1.6986172,
           'class_loss': 1.2482122,
           'conf_loss': 1.2986014,
           'precision50': 0.29526407,
           'recall50': 0.38747588},
     'AP': 0.18643145,
     'AP50': 0.34352827,
     'AP75': 0.18539043,
     'APl': 0.27330196,
     'APm': 0.21194065,
     'APs': 0.031459764,
     'ARl': 0.45564497,
     'ARm': 0.37154022,
     'ARmax1': 0.17511025,
     'ARmax10': 0.28797638,
     'ARmax100': 0.3162864,
     'ARs': 0.054338902,
     'global': {'total_loss': 45.560905},
     'validation_loss': 45.560905}

                                                                 input_4[0][0]                    
__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'3': (None, 64, 64, 16271360    yolo_fpn[0][0]                   
                                                                 yolo_fpn[0][1]                   
                                                                 yolo_fpn[0][2]                   
==================================================================================================
Total params: 25,897,472
Trainable params: 25,867,520
Non-trainable params: 29,952
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 200, 8), 4: (8, 200, 8), 5: (8, 200, 8)}, inds: {3: (8, 200, 3), 4: (8, 200, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
train | step:  10000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.5256774,
           'avg_obj': 0.005990361,
           'box_loss': 7.478024,
           'class_loss': 21.870905,
           'conf_loss': 146.78737,
           'precision50': 2.666322e-05,
           'recall50': 0.0033705062},
     '4': {'avg_iou': 0.580144,
           'avg_obj': 0.093118966,
           'box_loss': 6.376452,
           'class_loss': 20.007048,
           'conf_loss': 14.82448,
           'precision50': 0.12366363,
           'recall50': 0.063615985},
     '5': {'avg_iou': 0.5850307,
           'avg_obj': 0.12385907,
           'box_loss': 3.1313624,
           'class_loss': 9.77586,
           'conf_loss': 3.1744268,
           'precision50': 0.15861444,
           'recall50': 0.09002532},
     'global': {'total_loss': 233.4262},
     'learning_rate': 0.001,
     'training_loss': 233.4262}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-10000.
train | step:  20000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.5889374,
           'avg_obj': 1.0738976e-05,
           'box_loss': 6.4746146,
           'class_loss': 6.5209436,
           'conf_loss': 24.883696,
           'precision50': 0.0,
           'recall50': 0.0},
     '4': {'avg_iou': 0.6757152,
           'avg_obj': 0.21692398,
           'box_loss': 4.9213967,
           'class_loss': 5.169748,
           'conf_loss': 7.322879,
           'precision50': 0.2067941,
           'recall50': 0.19953394},
     '5': {'avg_iou': 0.6884427,
           'avg_obj': 0.2687515,
           'box_loss': 2.3491642,
           'class_loss': 2.4748185,
           'conf_loss': 1.396273,
           'precision50': 0.3195996,
           'recall50': 0.2604824},
     'global': {'total_loss': 61.513596},
     'learning_rate': 0.001,
     'training_loss': 61.513596}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-20000.
 eval | step:  20000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=206.58s).
Accumulating evaluation results...
DONE (t=40.51s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.186
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.344
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.185
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.031
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.212
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.273
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.175
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.288
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.316
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.054
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.372
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.456
 eval | step:  20000 | eval time:  620.5 sec | output: 
    {'3': {'avg_iou': 0.4494984,
           'avg_obj': 3.3321992e-06,
           'box_loss': 3.3841434,
           'class_loss': 2.604203,
           'conf_loss': 24.143942,
           'precision50': 0.0,
           'recall50': 0.0},
     '4': {'avg_iou': 0.6448772,
           'avg_obj': 0.29125056,
           'box_loss': 2.9117892,
           'class_loss': 2.2179472,
           'conf_loss': 6.0534463,
           'precision50': 0.17379689,
           'recall50': 0.3011351},
     '5': {'avg_iou': 0.6818185,
           'avg_obj': 0.3636523,
           'box_loss': 1.6986172,
           'class_loss': 1.2482122,
           'conf_loss': 1.2986014,
           'precision50': 0.29526407,
           'recall50': 0.38747588},
     'AP': 0.18643145,
     'AP50': 0.34352827,
     'AP75': 0.18539043,
     'APl': 0.27330196,
     'APm': 0.21194065,
     'APs': 0.031459764,
     'ARl': 0.45564497,
     'ARm': 0.37154022,
     'ARmax1': 0.17511025,
     'ARmax10': 0.28797638,
     'ARmax100': 0.3162864,
     'ARs': 0.054338902,
     'global': {'total_loss': 45.560905},
     'validation_loss': 45.560905}I0430 00:42:51.670185 140290927105856 controller.py:211] train | step:  20000 | training until step 40000...
I0430 01:45:05.130026 140290927105856 controller.py:425] train | step:  30000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.60207814,
           'avg_obj': 0.08812932,
           'box_loss': 6.287305,
           'class_loss': 6.071909,
           'conf_loss': 24.001862,
           'precision50': 0.11300158,
           'recall50': 0.05862657},
     '4': {'avg_iou': 0.70373166,
           'avg_obj': 0.27223995,
           'box_loss': 4.50246,
           'class_loss': 4.645779,
           'conf_loss': 8.315361,
           'precision50': 0.20811905,
           'recall50': 0.26938233},
     '5': {'avg_iou': 0.7217391,
           'avg_obj': 0.34003314,
           'box_loss': 2.099717,
           'class_loss': 2.2274606,
           'conf_loss': 1.5210717,
           'precision50': 0.3323959,
           'recall50': 0.36411747},
     'global': {'total_loss': 59.6729},
     'learning_rate': 0.001,
     'training_loss': 59.6729}
I0430 01:45:56.316174 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-30000.
I0430 02:52:10.174873 140290927105856 controller.py:425] train | step:  40000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6174526,
           'avg_obj': 0.13866113,
           'box_loss': 6.0594797,
           'class_loss': 5.7404504,
           'conf_loss': 25.662943,
           'precision50': 0.14456579,
           'recall50': 0.10354763},
     '4': {'avg_iou': 0.72200364,
           'avg_obj': 0.31223136,
           'box_loss': 4.2330694,
           'class_loss': 4.3407035,
           'conf_loss': 8.949714,
           'precision50': 0.20614035,
           'recall50': 0.31963268},
     '5': {'avg_iou': 0.7416016,
           'avg_obj': 0.38323468,
           'box_loss': 1.9508864,
           'class_loss': 2.078463,
           'conf_loss': 1.5751542,
           'precision50': 0.32918137,
           'recall50': 0.42430127},
     'global': {'total_loss': 60.590908},
     'learning_rate': 0.001,
     'training_loss': 60.590908}
I0430 02:53:04.021600 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-40000.
I0430 02:53:04.027815 140290927105856 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0430 02:57:24.709804 140290927105856 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0430 03:02:22.947005 140290927105856 controller.py:261]  eval | step:  40000 | eval time:  558.9 sec | output: 
    {'3': {'avg_iou': 0.47239774,
           'avg_obj': 0.15009908,
           'box_loss': 3.1406317,
           'class_loss': 2.4111605,
           'conf_loss': 20.77699,
           'precision50': 0.119126,
           'recall50': 0.14298552},
     '4': {'avg_iou': 0.6797032,
           'avg_obj': 0.3704088,
           'box_loss': 2.5541685,
           'class_loss': 1.9424244,
           'conf_loss': 7.0250773,
           'precision50': 0.17585754,
           'recall50': 0.40319735},
     '5': {'avg_iou': 0.72312033,
           'avg_obj': 0.46289682,
           'box_loss': 1.4556159,
           'class_loss': 1.1010221,
           'conf_loss': 1.3871725,
           'precision50': 0.2827299,
           'recall50': 0.52076405},
     'AP': 0.26378715,
     'AP50': 0.43993604,
     'AP75': 0.28430557,
     'APl': 0.35520262,
     'APm': 0.29014435,
     'APs': 0.09305717,
     'ARl': 0.5286171,
     'ARm': 0.45994893,
     'ARmax1': 0.2271518,
     'ARmax10': 0.3762914,
     'ARmax100': 0.41253966,
     'ARs': 0.19072737,
     'global': {'total_loss': 41.79424},
     'validation_loss': 41.79424}
I0430 03:02:40.279601 140290927105856 controller.py:211] train | step:  40000 | training until step 60000...
I0430 04:08:18.021217 140290927105856 controller.py:425] train | step:  50000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6276309,
           'avg_obj': 0.15891242,
           'box_loss': 5.903997,
           'class_loss': 5.4124203,
           'conf_loss': 27.019941,
           'precision50': 0.1488641,
           'recall50': 0.12554748},
     '4': {'avg_iou': 0.73425734,
           'avg_obj': 0.3411919,
           'box_loss': 4.0460143,
           'class_loss': 4.0343375,
           'conf_loss': 9.286224,
           'precision50': 0.20582855,
           'recall50': 0.35562918},
     '5': {'avg_iou': 0.7558811,
           'avg_obj': 0.4167396,
           'box_loss': 1.8434154,
           'class_loss': 1.9359275,
           'conf_loss': 1.6089449,
           'precision50': 0.32552633,
           'recall50': 0.4687695},
     'global': {'total_loss': 61.091305},
     'learning_rate': 0.001,
     'training_loss': 61.091305}
I0430 04:09:05.397192 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-50000.
I0430 05:13:10.851345 140290927105856 controller.py:425] train | step:  60000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.63400495,
           'avg_obj': 0.17419669,
           'box_loss': 5.801099,
           'class_loss': 5.1438994,
           'conf_loss': 28.17095,
           'precision50': 0.15041031,
           'recall50': 0.14206491},
     '4': {'avg_iou': 0.74269503,
           'avg_obj': 0.3622157,
           'box_loss': 3.916611,
           'class_loss': 3.8078337,
           'conf_loss': 9.478632,
           'precision50': 0.20305674,
           'recall50': 0.380911},
     '5': {'avg_iou': 0.76624185,
           'avg_obj': 0.44114307,
           'box_loss': 1.7642186,
           'class_loss': 1.8369019,
           'conf_loss': 1.6193905,
           'precision50': 0.3191608,
           'recall50': 0.50040203},
     'global': {'total_loss': 61.539417},
     'learning_rate': 0.001,
     'training_loss': 61.539417}
I0430 05:13:58.608358 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-60000.
I0430 05:13:58.614610 140290927105856 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0430 05:18:21.332500 140290927105856 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0430 05:23:38.957176 140290927105856 controller.py:261]  eval | step:  60000 | eval time:  580.3 sec | output: 
    {'3': {'avg_iou': 0.48214132,
           'avg_obj': 0.17762224,
           'box_loss': 3.0237436,
           'class_loss': 2.1973784,
           'conf_loss': 22.669783,
           'precision50': 0.120763674,
           'recall50': 0.17785195},
     '4': {'avg_iou': 0.6938465,
           'avg_obj': 0.4103249,
           'box_loss': 2.406603,
           'class_loss': 1.7669787,
           'conf_loss': 7.475516,
           'precision50': 0.16986331,
           'recall50': 0.4487974},
     '5': {'avg_iou': 0.7427923,
           'avg_obj': 0.5120635,
           'box_loss': 1.3378681,
           'class_loss': 1.0197363,
           'conf_loss': 1.4273375,
           'precision50': 0.2723091,
           'recall50': 0.5808141},
     'AP': 0.29712248,
     'AP50': 0.47789332,
     'AP75': 0.32565266,
     'APl': 0.40755814,
     'APm': 0.32409328,
     'APs': 0.11159958,
     'ARl': 0.5630669,
     'ARm': 0.48980772,
     'ARmax1': 0.24633129,
     'ARmax10': 0.40510148,
     'ARmax100': 0.43970105,
     'ARs': 0.20918578,
     'global': {'total_loss': 43.324974},
     'validation_loss': 43.324974}

train | step:  20000 | training until step 40000...
train | step:  30000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.60207814,
           'avg_obj': 0.08812932,
           'box_loss': 6.287305,
           'class_loss': 6.071909,
           'conf_loss': 24.001862,
           'precision50': 0.11300158,
           'recall50': 0.05862657},
     '4': {'avg_iou': 0.70373166,
           'avg_obj': 0.27223995,
           'box_loss': 4.50246,
           'class_loss': 4.645779,
           'conf_loss': 8.315361,
           'precision50': 0.20811905,
           'recall50': 0.26938233},
     '5': {'avg_iou': 0.7217391,
           'avg_obj': 0.34003314,
           'box_loss': 2.099717,
           'class_loss': 2.2274606,
           'conf_loss': 1.5210717,
           'precision50': 0.3323959,
           'recall50': 0.36411747},
     'global': {'total_loss': 59.6729},
     'learning_rate': 0.001,
     'training_loss': 59.6729}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-30000.
train | step:  40000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6174526,
           'avg_obj': 0.13866113,
           'box_loss': 6.0594797,
           'class_loss': 5.7404504,
           'conf_loss': 25.662943,
           'precision50': 0.14456579,
           'recall50': 0.10354763},
     '4': {'avg_iou': 0.72200364,
           'avg_obj': 0.31223136,
           'box_loss': 4.2330694,
           'class_loss': 4.3407035,
           'conf_loss': 8.949714,
           'precision50': 0.20614035,
           'recall50': 0.31963268},
     '5': {'avg_iou': 0.7416016,
           'avg_obj': 0.38323468,
           'box_loss': 1.9508864,
           'class_loss': 2.078463,
           'conf_loss': 1.5751542,
           'precision50': 0.32918137,
           'recall50': 0.42430127},
     'global': {'total_loss': 60.590908},
     'learning_rate': 0.001,
     'training_loss': 60.590908}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-40000.
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=204.60s).
Accumulating evaluation results...
DONE (t=38.51s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.264
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.440
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.284
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.093
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.290
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.355
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.227
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.376
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.413
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.191
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.460
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.529
 eval | step:  40000 | eval time:  558.9 sec | output: 
    {'3': {'avg_iou': 0.47239774,
           'avg_obj': 0.15009908,
           'box_loss': 3.1406317,
           'class_loss': 2.4111605,
           'conf_loss': 20.77699,
           'precision50': 0.119126,
           'recall50': 0.14298552},
     '4': {'avg_iou': 0.6797032,
           'avg_obj': 0.3704088,
           'box_loss': 2.5541685,
           'class_loss': 1.9424244,
           'conf_loss': 7.0250773,
           'precision50': 0.17585754,
           'recall50': 0.40319735},
     '5': {'avg_iou': 0.72312033,
           'avg_obj': 0.46289682,
           'box_loss': 1.4556159,
           'class_loss': 1.1010221,
           'conf_loss': 1.3871725,
           'precision50': 0.2827299,
           'recall50': 0.52076405},
     'AP': 0.26378715,
     'AP50': 0.43993604,
     'AP75': 0.28430557,
     'APl': 0.35520262,
     'APm': 0.29014435,
     'APs': 0.09305717,
     'ARl': 0.5286171,
     'ARm': 0.45994893,
     'ARmax1': 0.2271518,
     'ARmax10': 0.3762914,
     'ARmax100': 0.41253966,
     'ARs': 0.19072737,
     'global': {'total_loss': 41.79424},
     'validation_loss': 41.79424}
train | step:  40000 | training until step 60000...
train | step:  50000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6276309,
           'avg_obj': 0.15891242,
           'box_loss': 5.903997,
           'class_loss': 5.4124203,
           'conf_loss': 27.019941,
           'precision50': 0.1488641,
           'recall50': 0.12554748},
     '4': {'avg_iou': 0.73425734,
           'avg_obj': 0.3411919,
           'box_loss': 4.0460143,
           'class_loss': 4.0343375,
           'conf_loss': 9.286224,
           'precision50': 0.20582855,
           'recall50': 0.35562918},
     '5': {'avg_iou': 0.7558811,
           'avg_obj': 0.4167396,
           'box_loss': 1.8434154,
           'class_loss': 1.9359275,
           'conf_loss': 1.6089449,
           'precision50': 0.32552633,
           'recall50': 0.4687695},
     'global': {'total_loss': 61.091305},
     'learning_rate': 0.001,
     'training_loss': 61.091305}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-50000.
train | step:  60000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.63400495,
           'avg_obj': 0.17419669,
           'box_loss': 5.801099,
           'class_loss': 5.1438994,
           'conf_loss': 28.17095,
           'precision50': 0.15041031,
           'recall50': 0.14206491},
     '4': {'avg_iou': 0.74269503,
           'avg_obj': 0.3622157,
           'box_loss': 3.916611,
           'class_loss': 3.8078337,
           'conf_loss': 9.478632,
           'precision50': 0.20305674,
           'recall50': 0.380911},
     '5': {'avg_iou': 0.76624185,
           'avg_obj': 0.44114307,
           'box_loss': 1.7642186,
           'class_loss': 1.8369019,
           'conf_loss': 1.6193905,
           'precision50': 0.3191608,
           'recall50': 0.50040203},
     'global': {'total_loss': 61.539417},
     'learning_rate': 0.001,
     'training_loss': 61.539417}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-60000.
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=217.36s).
Accumulating evaluation results...
DONE (t=39.70s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.297
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.478
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.326
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.112
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.324
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.408
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.246
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.405
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.440
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.209
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.490
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.563
 eval | step:  60000 | eval time:  580.3 sec | output: 
    {'3': {'avg_iou': 0.48214132,
           'avg_obj': 0.17762224,
           'box_loss': 3.0237436,
           'class_loss': 2.1973784,
           'conf_loss': 22.669783,
           'precision50': 0.120763674,
           'recall50': 0.17785195},
     '4': {'avg_iou': 0.6938465,
           'avg_obj': 0.4103249,
           'box_loss': 2.406603,
           'class_loss': 1.7669787,
           'conf_loss': 7.475516,
           'precision50': 0.16986331,
           'recall50': 0.4487974},
     '5': {'avg_iou': 0.7427923,
           'avg_obj': 0.5120635,
           'box_loss': 1.3378681,
           'class_loss': 1.0197363,
           'conf_loss': 1.4273375,
           'precision50': 0.2723091,
           'recall50': 0.5808141},
     'AP': 0.29712248,
     'AP50': 0.47789332,
     'AP75': 0.32565266,
     'APl': 0.40755814,
     'APm': 0.32409328,
     'APs': 0.11159958,
     'ARl': 0.5630669,
     'ARm': 0.48980772,
     'ARmax1': 0.24633129,
     'ARmax10': 0.40510148,
     'ARmax100': 0.43970105,
     'ARs': 0.20918578,
     'global': {'total_loss': 43.324974},
     'validation_loss': 43.324974}I0430 05:23:56.569826 140290927105856 controller.py:211] train | step:  60000 | training until step 80000...
I0430 06:40:18.030830 140290927105856 controller.py:425] train | step:  70000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6390033,
           'avg_obj': 0.18502885,
           'box_loss': 5.7214174,
           'class_loss': 4.964866,
           'conf_loss': 28.872297,
           'precision50': 0.15113725,
           'recall50': 0.1544846},
     '4': {'avg_iou': 0.7489803,
           'avg_obj': 0.37887317,
           'box_loss': 3.830393,
           'class_loss': 3.6525831,
           'conf_loss': 9.565839,
           'precision50': 0.20192336,
           'recall50': 0.40102047},
     '5': {'avg_iou': 0.774095,
           'avg_obj': 0.4609574,
           'box_loss': 1.7078979,
           'class_loss': 1.756166,
           'conf_loss': 1.6311874,
           'precision50': 0.31481385,
           'recall50': 0.5248093},
     'global': {'total_loss': 61.702614},
     'learning_rate': 0.001,
     'training_loss': 61.702614}
I0430 06:41:08.656452 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-70000.
I0430 07:44:00.780853 140290927105856 controller.py:425] train | step:  80000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.64328855,
           'avg_obj': 0.19508213,
           'box_loss': 5.67569,
           'class_loss': 4.8386517,
           'conf_loss': 29.58353,
           'precision50': 0.15166155,
           'recall50': 0.16568913},
     '4': {'avg_iou': 0.7541073,
           'avg_obj': 0.3927094,
           'box_loss': 3.757328,
           'class_loss': 3.5250008,
           'conf_loss': 9.643991,
           'precision50': 0.20187935,
           'recall50': 0.41738075},
     '5': {'avg_iou': 0.7806868,
           'avg_obj': 0.47738564,
           'box_loss': 1.6604358,
           'class_loss': 1.6942341,
           'conf_loss': 1.6346145,
           'precision50': 0.31046513,
           'recall50': 0.5440408},
     'global': {'total_loss': 62.01344},
     'learning_rate': 0.001,
     'training_loss': 62.01344}
I0430 07:44:51.098995 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-80000.
I0430 07:44:51.105039 140290927105856 controller.py:252]  eval | step:  80000 | running 625 steps of evaluation...
I0430 07:49:17.946644 140290927105856 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0430 07:54:39.468708 140290927105856 controller.py:261]  eval | step:  80000 | eval time:  588.4 sec | output: 
    {'3': {'avg_iou': 0.48717022,
           'avg_obj': 0.19248277,
           'box_loss': 2.956873,
           'class_loss': 2.1145117,
           'conf_loss': 23.849754,
           'precision50': 0.11866748,
           'recall50': 0.19585091},
     '4': {'avg_iou': 0.70176965,
           'avg_obj': 0.43370274,
           'box_loss': 2.3234024,
           'class_loss': 1.7103283,
           'conf_loss': 7.6734476,
           'precision50': 0.16922885,
           'recall50': 0.47637963},
     '5': {'avg_iou': 0.7538739,
           'avg_obj': 0.5420642,
           'box_loss': 1.2705387,
           'class_loss': 0.98074275,
           'conf_loss': 1.4590911,
           'precision50': 0.26254177,
           'recall50': 0.61260754},
     'AP': 0.3155544,
     'AP50': 0.49403492,
     'AP75': 0.3475706,
     'APl': 0.43012977,
     'APm': 0.34245282,
     'APs': 0.1258683,
     'ARl': 0.5868089,
     'ARm': 0.506221,
     'ARmax1': 0.2595392,
     'ARmax10': 0.42355844,
     'ARmax100': 0.45778653,
     'ARs': 0.23001859,
     'global': {'total_loss': 44.338715},
     'validation_loss': 44.338715}
I0430 07:55:01.578199 140290927105856 controller.py:211] train | step:  80000 | training until step 100000...
I0430 08:54:30.361731 140290927105856 controller.py:425] train | step:  90000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6467785,
           'avg_obj': 0.20346266,
           'box_loss': 5.61893,
           'class_loss': 4.710083,
           'conf_loss': 29.771206,
           'precision50': 0.15275294,
           'recall50': 0.17452082},
     '4': {'avg_iou': 0.75848484,
           'avg_obj': 0.40473518,
           'box_loss': 3.6807942,
           'class_loss': 3.4008427,
           'conf_loss': 9.655512,
           'precision50': 0.20126575,
           'recall50': 0.43148956},
     '5': {'avg_iou': 0.7861478,
           'avg_obj': 0.49106157,
           'box_loss': 1.6154044,
           'class_loss': 1.6364356,
           'conf_loss': 1.6323568,
           'precision50': 0.30594188,
           'recall50': 0.5603814},
     'global': {'total_loss': 61.72163},
     'learning_rate': 0.001,
     'training_loss': 61.72163}
I0430 08:55:19.110001 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-90000.
I0430 09:53:52.129551 140290927105856 controller.py:425] train | step:  100000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6501187,
           'avg_obj': 0.211253,
           'box_loss': 5.5537333,
           'class_loss': 4.579705,
           'conf_loss': 29.74565,
           'precision50': 0.15512493,
           'recall50': 0.18242514},
     '4': {'avg_iou': 0.7620853,
           'avg_obj': 0.41485143,
           'box_loss': 3.6223125,
           'class_loss': 3.2918987,
           'conf_loss': 9.632725,
           'precision50': 0.20039195,
           'recall50': 0.443818},
     '5': {'avg_iou': 0.7908056,
           'avg_obj': 0.5026865,
           'box_loss': 1.5784165,
           'class_loss': 1.5817034,
           'conf_loss': 1.6290867,
           'precision50': 0.30344123,
           'recall50': 0.5739888},
     'global': {'total_loss': 61.215267},
     'learning_rate': 0.001,
     'training_loss': 61.215267}
I0430 09:54:39.920882 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-100000.
I0430 09:54:39.926660 140290927105856 controller.py:252]  eval | step:  100000 | running 625 steps of evaluation...
I0430 09:59:05.803323 140290927105856 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0430 10:04:28.453047 140290927105856 controller.py:261]  eval | step:  100000 | eval time:  588.5 sec | output: 
    {'3': {'avg_iou': 0.49015453,
           'avg_obj': 0.20051315,
           'box_loss': 2.9116702,
           'class_loss': 2.0498636,
           'conf_loss': 24.233421,
           'precision50': 0.11879508,
           'recall50': 0.20474043},
     '4': {'avg_iou': 0.706626,
           'avg_obj': 0.4491107,
           'box_loss': 2.272074,
           'class_loss': 1.6740906,
           'conf_loss': 7.816482,
           'precision50': 0.16731328,
           'recall50': 0.4958757},
     '5': {'avg_iou': 0.7613122,
           'avg_obj': 0.56082964,
           'box_loss': 1.2246215,
           'class_loss': 0.95472324,
           'conf_loss': 1.4857142,
           'precision50': 0.2553239,
           'recall50': 0.6327393},
     'AP': 0.32579243,
     'AP50': 0.50614375,
     'AP75': 0.360176,
     'APl': 0.44479194,
     'APm': 0.35260546,
     'APs': 0.132212,
     'ARl': 0.5968738,
     'ARm': 0.5127189,
     'ARmax1': 0.2638813,
     'ARmax10': 0.43228778,
     'ARmax100': 0.4665839,
     'ARs': 0.24888383,
     'global': {'total_loss': 44.622646},
     'validation_loss': 44.622646}

train | step:  60000 | training until step 80000...
train | step:  70000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6390033,
           'avg_obj': 0.18502885,
           'box_loss': 5.7214174,
           'class_loss': 4.964866,
           'conf_loss': 28.872297,
           'precision50': 0.15113725,
           'recall50': 0.1544846},
     '4': {'avg_iou': 0.7489803,
           'avg_obj': 0.37887317,
           'box_loss': 3.830393,
           'class_loss': 3.6525831,
           'conf_loss': 9.565839,
           'precision50': 0.20192336,
           'recall50': 0.40102047},
     '5': {'avg_iou': 0.774095,
           'avg_obj': 0.4609574,
           'box_loss': 1.7078979,
           'class_loss': 1.756166,
           'conf_loss': 1.6311874,
           'precision50': 0.31481385,
           'recall50': 0.5248093},
     'global': {'total_loss': 61.702614},
     'learning_rate': 0.001,
     'training_loss': 61.702614}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-70000.
train | step:  80000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.64328855,
           'avg_obj': 0.19508213,
           'box_loss': 5.67569,
           'class_loss': 4.8386517,
           'conf_loss': 29.58353,
           'precision50': 0.15166155,
           'recall50': 0.16568913},
     '4': {'avg_iou': 0.7541073,
           'avg_obj': 0.3927094,
           'box_loss': 3.757328,
           'class_loss': 3.5250008,
           'conf_loss': 9.643991,
           'precision50': 0.20187935,
           'recall50': 0.41738075},
     '5': {'avg_iou': 0.7806868,
           'avg_obj': 0.47738564,
           'box_loss': 1.6604358,
           'class_loss': 1.6942341,
           'conf_loss': 1.6346145,
           'precision50': 0.31046513,
           'recall50': 0.5440408},
     'global': {'total_loss': 62.01344},
     'learning_rate': 0.001,
     'training_loss': 62.01344}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-80000.
 eval | step:  80000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=216.82s).
Accumulating evaluation results...
DONE (t=41.98s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.316
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.494
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.348
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.126
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.342
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.430
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.260
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.424
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.458
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.230
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.506
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.587
 eval | step:  80000 | eval time:  588.4 sec | output: 
    {'3': {'avg_iou': 0.48717022,
           'avg_obj': 0.19248277,
           'box_loss': 2.956873,
           'class_loss': 2.1145117,
           'conf_loss': 23.849754,
           'precision50': 0.11866748,
           'recall50': 0.19585091},
     '4': {'avg_iou': 0.70176965,
           'avg_obj': 0.43370274,
           'box_loss': 2.3234024,
           'class_loss': 1.7103283,
           'conf_loss': 7.6734476,
           'precision50': 0.16922885,
           'recall50': 0.47637963},
     '5': {'avg_iou': 0.7538739,
           'avg_obj': 0.5420642,
           'box_loss': 1.2705387,
           'class_loss': 0.98074275,
           'conf_loss': 1.4590911,
           'precision50': 0.26254177,
           'recall50': 0.61260754},
     'AP': 0.3155544,
     'AP50': 0.49403492,
     'AP75': 0.3475706,
     'APl': 0.43012977,
     'APm': 0.34245282,
     'APs': 0.1258683,
     'ARl': 0.5868089,
     'ARm': 0.506221,
     'ARmax1': 0.2595392,
     'ARmax10': 0.42355844,
     'ARmax100': 0.45778653,
     'ARs': 0.23001859,
     'global': {'total_loss': 44.338715},
     'validation_loss': 44.338715}
train | step:  80000 | training until step 100000...
train | step:  90000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6467785,
           'avg_obj': 0.20346266,
           'box_loss': 5.61893,
           'class_loss': 4.710083,
           'conf_loss': 29.771206,
           'precision50': 0.15275294,
           'recall50': 0.17452082},
     '4': {'avg_iou': 0.75848484,
           'avg_obj': 0.40473518,
           'box_loss': 3.6807942,
           'class_loss': 3.4008427,
           'conf_loss': 9.655512,
           'precision50': 0.20126575,
           'recall50': 0.43148956},
     '5': {'avg_iou': 0.7861478,
           'avg_obj': 0.49106157,
           'box_loss': 1.6154044,
           'class_loss': 1.6364356,
           'conf_loss': 1.6323568,
           'precision50': 0.30594188,
           'recall50': 0.5603814},
     'global': {'total_loss': 61.72163},
     'learning_rate': 0.001,
     'training_loss': 61.72163}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-90000.
train | step:  100000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6501187,
           'avg_obj': 0.211253,
           'box_loss': 5.5537333,
           'class_loss': 4.579705,
           'conf_loss': 29.74565,
           'precision50': 0.15512493,
           'recall50': 0.18242514},
     '4': {'avg_iou': 0.7620853,
           'avg_obj': 0.41485143,
           'box_loss': 3.6223125,
           'class_loss': 3.2918987,
           'conf_loss': 9.632725,
           'precision50': 0.20039195,
           'recall50': 0.443818},
     '5': {'avg_iou': 0.7908056,
           'avg_obj': 0.5026865,
           'box_loss': 1.5784165,
           'class_loss': 1.5817034,
           'conf_loss': 1.6290867,
           'precision50': 0.30344123,
           'recall50': 0.5739888},
     'global': {'total_loss': 61.215267},
     'learning_rate': 0.001,
     'training_loss': 61.215267}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-100000.
 eval | step:  100000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=219.93s).
Accumulating evaluation results...
DONE (t=39.68s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.326
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.506
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.360
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.132
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.353
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.445
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.264
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.432
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.467
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.249
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.513
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.597
 eval | step:  100000 | eval time:  588.5 sec | output: 
    {'3': {'avg_iou': 0.49015453,
           'avg_obj': 0.20051315,
           'box_loss': 2.9116702,
           'class_loss': 2.0498636,
           'conf_loss': 24.233421,
           'precision50': 0.11879508,
           'recall50': 0.20474043},
     '4': {'avg_iou': 0.706626,
           'avg_obj': 0.4491107,
           'box_loss': 2.272074,
           'class_loss': 1.6740906,
           'conf_loss': 7.816482,
           'precision50': 0.16731328,
           'recall50': 0.4958757},
     '5': {'avg_iou': 0.7613122,
           'avg_obj': 0.56082964,
           'box_loss': 1.2246215,
           'class_loss': 0.95472324,
           'conf_loss': 1.4857142,
           'precision50': 0.2553239,
           'recall50': 0.6327393},
     'AP': 0.32579243,
     'AP50': 0.50614375,
     'AP75': 0.360176,
     'APl': 0.44479194,
     'APm': 0.35260546,
     'APs': 0.132212,
     'ARl': 0.5968738,
     'ARm': 0.5127189,
     'ARmax1': 0.2638813,
     'ARmax10': 0.43228778,
     'ARmax100': 0.4665839,
     'ARs': 0.24888383,
     'global': {'total_loss': 44.622646},
     'validation_loss': 44.622646}I0430 10:04:49.987328 140290927105856 controller.py:211] train | step:  100000 | training until step 120000...
I0430 11:08:18.152769 140290927105856 controller.py:425] train | step:  110000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.65277946,
           'avg_obj': 0.2180699,
           'box_loss': 5.5148997,
           'class_loss': 4.498497,
           'conf_loss': 29.803595,
           'precision50': 0.15616982,
           'recall50': 0.18970066},
     '4': {'avg_iou': 0.7653149,
           'avg_obj': 0.42438683,
           'box_loss': 3.573477,
           'class_loss': 3.2144003,
           'conf_loss': 9.563209,
           'precision50': 0.20156357,
           'recall50': 0.4542888},
     '5': {'avg_iou': 0.7947151,
           'avg_obj': 0.51352847,
           'box_loss': 1.550613,
           'class_loss': 1.5412256,
           'conf_loss': 1.6265956,
           'precision50': 0.3012495,
           'recall50': 0.5856251},
     'global': {'total_loss': 60.88657},
     'learning_rate': 0.001,
     'training_loss': 60.88657}
I0430 11:09:11.038585 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-110000.
I0430 12:08:13.196335 140290927105856 controller.py:425] train | step:  120000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6552271,
           'avg_obj': 0.2241788,
           'box_loss': 5.48825,
           'class_loss': 4.409626,
           'conf_loss': 29.986582,
           'precision50': 0.1582166,
           'recall50': 0.19663821},
     '4': {'avg_iou': 0.7678167,
           'avg_obj': 0.4322649,
           'box_loss': 3.5455534,
           'class_loss': 3.1416798,
           'conf_loss': 9.569947,
           'precision50': 0.2024519,
           'recall50': 0.46371797},
     '5': {'avg_iou': 0.79817855,
           'avg_obj': 0.5223718,
           'box_loss': 1.5254503,
           'class_loss': 1.4990124,
           'conf_loss': 1.6265212,
           'precision50': 0.29949903,
           'recall50': 0.59618723},
     'global': {'total_loss': 60.792606},
     'learning_rate': 0.001,
     'training_loss': 60.792606}
I0430 12:09:08.340429 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-120000.
I0430 12:09:08.346536 140290927105856 controller.py:252]  eval | step:  120000 | running 625 steps of evaluation...
I0430 12:13:33.742678 140290927105856 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0430 12:18:51.199072 140290927105856 controller.py:261]  eval | step:  120000 | eval time:  582.9 sec | output: 
    {'3': {'avg_iou': 0.49259576,
           'avg_obj': 0.2078358,
           'box_loss': 2.8785405,
           'class_loss': 2.0177372,
           'conf_loss': 24.549849,
           'precision50': 0.12025161,
           'recall50': 0.21531609},
     '4': {'avg_iou': 0.7100494,
           'avg_obj': 0.45802587,
           'box_loss': 2.2390122,
           'class_loss': 1.6595685,
           'conf_loss': 7.875066,
           'precision50': 0.16750288,
           'recall50': 0.5054609},
     '5': {'avg_iou': 0.7673308,
           'avg_obj': 0.5743838,
           'box_loss': 1.1914853,
           'class_loss': 0.9425498,
           'conf_loss': 1.4944254,
           'precision50': 0.25210106,
           'recall50': 0.6462533},
     'AP': 0.3349156,
     'AP50': 0.5140854,
     'AP75': 0.3704932,
     'APl': 0.4594488,
     'APm': 0.3614241,
     'APs': 0.14259776,
     'ARl': 0.60921896,
     'ARm': 0.5235501,
     'ARmax1': 0.27189162,
     'ARmax10': 0.44180045,
     'ARmax100': 0.47633958,
     'ARs': 0.25433853,
     'global': {'total_loss': 44.84822},
     'validation_loss': 44.84822}
I0430 12:19:14.082045 140290927105856 controller.py:211] train | step:  120000 | training until step 140000...
I0430 13:16:36.300309 140290927105856 controller.py:425] train | step:  130000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6568078,
           'avg_obj': 0.2300674,
           'box_loss': 5.453367,
           'class_loss': 4.3159485,
           'conf_loss': 30.202679,
           'precision50': 0.15721887,
           'recall50': 0.20322306},
     '4': {'avg_iou': 0.77028847,
           'avg_obj': 0.43974987,
           'box_loss': 3.497963,
           'class_loss': 3.0726695,
           'conf_loss': 9.507331,
           'precision50': 0.20279062,
           'recall50': 0.4723253},
     '5': {'avg_iou': 0.80111414,
           'avg_obj': 0.5299392,
           'box_loss': 1.5009055,
           'class_loss': 1.4679782,
           'conf_loss': 1.6163297,
           'precision50': 0.29871857,
           'recall50': 0.604785},
     'global': {'total_loss': 60.63518},
     'learning_rate': 0.001,
     'training_loss': 60.63518}
I0430 13:17:28.808368 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-130000.
I0430 14:17:33.555233 140290927105856 controller.py:425] train | step:  140000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.65883684,
           'avg_obj': 0.23521109,
           'box_loss': 5.423289,
           'class_loss': 4.254017,
           'conf_loss': 30.397854,
           'precision50': 0.15684313,
           'recall50': 0.20899382},
     '4': {'avg_iou': 0.77259207,
           'avg_obj': 0.44677755,
           'box_loss': 3.4672852,
           'class_loss': 3.0230606,
           'conf_loss': 9.496483,
           'precision50': 0.20219062,
           'recall50': 0.48030585},
     '5': {'avg_iou': 0.80388945,
           'avg_obj': 0.53753066,
           'box_loss': 1.4818342,
           'class_loss': 1.4455887,
           'conf_loss': 1.6237153,
           'precision50': 0.2964354,
           'recall50': 0.6131129},
     'global': {'total_loss': 60.61323},
     'learning_rate': 0.001,
     'training_loss': 60.61323}
I0430 14:18:24.904448 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-140000.
I0430 14:18:24.911612 140290927105856 controller.py:252]  eval | step:  140000 | running 625 steps of evaluation...
I0430 14:23:00.364014 140290927105856 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0430 14:28:21.547063 140290927105856 controller.py:261]  eval | step:  140000 | eval time:  596.6 sec | output: 
    {'3': {'avg_iou': 0.49429864,
           'avg_obj': 0.21396768,
           'box_loss': 2.8598957,
           'class_loss': 1.996177,
           'conf_loss': 25.118692,
           'precision50': 0.11907113,
           'recall50': 0.22299887},
     '4': {'avg_iou': 0.7121969,
           'avg_obj': 0.46542373,
           'box_loss': 2.2160347,
           'class_loss': 1.6509275,
           'conf_loss': 7.932104,
           'precision50': 0.16808303,
           'recall50': 0.51254314},
     '5': {'avg_iou': 0.7709641,
           'avg_obj': 0.58347595,
           'box_loss': 1.1702553,
           'class_loss': 0.9325045,
           'conf_loss': 1.515206,
           'precision50': 0.24985044,
           'recall50': 0.65533775},
     'AP': 0.33994052,
     'AP50': 0.5174379,
     'AP75': 0.37889048,
     'APl': 0.4688606,
     'APm': 0.36640194,
     'APs': 0.1412812,
     'ARl': 0.615109,
     'ARm': 0.5288585,
     'ARmax1': 0.27322796,
     'ARmax10': 0.4464223,
     'ARmax100': 0.48021612,
     'ARs': 0.25049272,
     'global': {'total_loss': 45.391773},
     'validation_loss': 45.391773}

train | step:  100000 | training until step 120000...
train | step:  110000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.65277946,
           'avg_obj': 0.2180699,
           'box_loss': 5.5148997,
           'class_loss': 4.498497,
           'conf_loss': 29.803595,
           'precision50': 0.15616982,
           'recall50': 0.18970066},
     '4': {'avg_iou': 0.7653149,
           'avg_obj': 0.42438683,
           'box_loss': 3.573477,
           'class_loss': 3.2144003,
           'conf_loss': 9.563209,
           'precision50': 0.20156357,
           'recall50': 0.4542888},
     '5': {'avg_iou': 0.7947151,
           'avg_obj': 0.51352847,
           'box_loss': 1.550613,
           'class_loss': 1.5412256,
           'conf_loss': 1.6265956,
           'precision50': 0.3012495,
           'recall50': 0.5856251},
     'global': {'total_loss': 60.88657},
     'learning_rate': 0.001,
     'training_loss': 60.88657}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-110000.
train | step:  120000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6552271,
           'avg_obj': 0.2241788,
           'box_loss': 5.48825,
           'class_loss': 4.409626,
           'conf_loss': 29.986582,
           'precision50': 0.1582166,
           'recall50': 0.19663821},
     '4': {'avg_iou': 0.7678167,
           'avg_obj': 0.4322649,
           'box_loss': 3.5455534,
           'class_loss': 3.1416798,
           'conf_loss': 9.569947,
           'precision50': 0.2024519,
           'recall50': 0.46371797},
     '5': {'avg_iou': 0.79817855,
           'avg_obj': 0.5223718,
           'box_loss': 1.5254503,
           'class_loss': 1.4990124,
           'conf_loss': 1.6265212,
           'precision50': 0.29949903,
           'recall50': 0.59618723},
     'global': {'total_loss': 60.792606},
     'learning_rate': 0.001,
     'training_loss': 60.792606}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-120000.
 eval | step:  120000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=220.24s).
Accumulating evaluation results...
DONE (t=39.48s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.335
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.514
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.370
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.143
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.361
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.459
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.272
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.442
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.476
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.254
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.524
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.609
 eval | step:  120000 | eval time:  582.9 sec | output: 
    {'3': {'avg_iou': 0.49259576,
           'avg_obj': 0.2078358,
           'box_loss': 2.8785405,
           'class_loss': 2.0177372,
           'conf_loss': 24.549849,
           'precision50': 0.12025161,
           'recall50': 0.21531609},
     '4': {'avg_iou': 0.7100494,
           'avg_obj': 0.45802587,
           'box_loss': 2.2390122,
           'class_loss': 1.6595685,
           'conf_loss': 7.875066,
           'precision50': 0.16750288,
           'recall50': 0.5054609},
     '5': {'avg_iou': 0.7673308,
           'avg_obj': 0.5743838,
           'box_loss': 1.1914853,
           'class_loss': 0.9425498,
           'conf_loss': 1.4944254,
           'precision50': 0.25210106,
           'recall50': 0.6462533},
     'AP': 0.3349156,
     'AP50': 0.5140854,
     'AP75': 0.3704932,
     'APl': 0.4594488,
     'APm': 0.3614241,
     'APs': 0.14259776,
     'ARl': 0.60921896,
     'ARm': 0.5235501,
     'ARmax1': 0.27189162,
     'ARmax10': 0.44180045,
     'ARmax100': 0.47633958,
     'ARs': 0.25433853,
     'global': {'total_loss': 44.84822},
     'validation_loss': 44.84822}
train | step:  120000 | training until step 140000...
train | step:  130000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6568078,
           'avg_obj': 0.2300674,
           'box_loss': 5.453367,
           'class_loss': 4.3159485,
           'conf_loss': 30.202679,
           'precision50': 0.15721887,
           'recall50': 0.20322306},
     '4': {'avg_iou': 0.77028847,
           'avg_obj': 0.43974987,
           'box_loss': 3.497963,
           'class_loss': 3.0726695,
           'conf_loss': 9.507331,
           'precision50': 0.20279062,
           'recall50': 0.4723253},
     '5': {'avg_iou': 0.80111414,
           'avg_obj': 0.5299392,
           'box_loss': 1.5009055,
           'class_loss': 1.4679782,
           'conf_loss': 1.6163297,
           'precision50': 0.29871857,
           'recall50': 0.604785},
     'global': {'total_loss': 60.63518},
     'learning_rate': 0.001,
     'training_loss': 60.63518}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-130000.
train | step:  140000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.65883684,
           'avg_obj': 0.23521109,
           'box_loss': 5.423289,
           'class_loss': 4.254017,
           'conf_loss': 30.397854,
           'precision50': 0.15684313,
           'recall50': 0.20899382},
     '4': {'avg_iou': 0.77259207,
           'avg_obj': 0.44677755,
           'box_loss': 3.4672852,
           'class_loss': 3.0230606,
           'conf_loss': 9.496483,
           'precision50': 0.20219062,
           'recall50': 0.48030585},
     '5': {'avg_iou': 0.80388945,
           'avg_obj': 0.53753066,
           'box_loss': 1.4818342,
           'class_loss': 1.4455887,
           'conf_loss': 1.6237153,
           'precision50': 0.2964354,
           'recall50': 0.6131129},
     'global': {'total_loss': 60.61323},
     'learning_rate': 0.001,
     'training_loss': 60.61323}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-140000.
 eval | step:  140000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=215.27s).
Accumulating evaluation results...
DONE (t=41.88s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.340
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.517
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.379
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.141
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.366
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.469
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.273
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.446
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.480
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.250
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.529
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.615
 eval | step:  140000 | eval time:  596.6 sec | output: 
    {'3': {'avg_iou': 0.49429864,
           'avg_obj': 0.21396768,
           'box_loss': 2.8598957,
           'class_loss': 1.996177,
           'conf_loss': 25.118692,
           'precision50': 0.11907113,
           'recall50': 0.22299887},
     '4': {'avg_iou': 0.7121969,
           'avg_obj': 0.46542373,
           'box_loss': 2.2160347,
           'class_loss': 1.6509275,
           'conf_loss': 7.932104,
           'precision50': 0.16808303,
           'recall50': 0.51254314},
     '5': {'avg_iou': 0.7709641,
           'avg_obj': 0.58347595,
           'box_loss': 1.1702553,
           'class_loss': 0.9325045,
           'conf_loss': 1.515206,
           'precision50': 0.24985044,
           'recall50': 0.65533775},
     'AP': 0.33994052,
     'AP50': 0.5174379,
     'AP75': 0.37889048,
     'APl': 0.4688606,
     'APm': 0.36640194,
     'APs': 0.1412812,
     'ARl': 0.615109,
     'ARm': 0.5288585,
     'ARmax1': 0.27322796,
     'ARmax10': 0.4464223,
     'ARmax100': 0.48021612,
     'ARs': 0.25049272,
     'global': {'total_loss': 45.391773},
     'validation_loss': 45.391773}I0430 14:28:38.178922 140290927105856 controller.py:211] train | step:  140000 | training until step 160000...
I0430 15:25:50.367143 140290927105856 controller.py:425] train | step:  150000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6603053,
           'avg_obj': 0.2398302,
           'box_loss': 5.4087467,
           'class_loss': 4.199013,
           'conf_loss': 30.19167,
           'precision50': 0.15979381,
           'recall50': 0.21385479},
     '4': {'avg_iou': 0.7746216,
           'avg_obj': 0.4529444,
           'box_loss': 3.4394367,
           'class_loss': 2.9640067,
           'conf_loss': 9.449533,
           'precision50': 0.20274079,
           'recall50': 0.4870353},
     '5': {'avg_iou': 0.8063583,
           'avg_obj': 0.54445994,
           'box_loss': 1.4641448,
           'class_loss': 1.4144632,
           'conf_loss': 1.6171465,
           'precision50': 0.29634467,
           'recall50': 0.62047875},
     'global': {'total_loss': 60.148033},
     'learning_rate': 0.001,
     'training_loss': 60.148033}
I0430 15:26:50.511479 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-150000.
I0430 16:27:43.359029 140290927105856 controller.py:425] train | step:  160000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6621319,
           'avg_obj': 0.24511658,
           'box_loss': 5.3674283,
           'class_loss': 4.124974,
           'conf_loss': 30.105116,
           'precision50': 0.16058049,
           'recall50': 0.21901985},
     '4': {'avg_iou': 0.77675134,
           'avg_obj': 0.4601172,
           'box_loss': 3.3976781,
           'class_loss': 2.901463,
           'conf_loss': 9.380213,
           'precision50': 0.20236792,
           'recall50': 0.49487972},
     '5': {'avg_iou': 0.80886984,
           'avg_obj': 0.55174154,
           'box_loss': 1.4418176,
           'class_loss': 1.3823999,
           'conf_loss': 1.6072106,
           'precision50': 0.29667577,
           'recall50': 0.6286578},
     'global': {'total_loss': 59.708237},
     'learning_rate': 0.001,
     'training_loss': 59.708237}
I0430 16:28:30.427827 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-160000.
I0430 16:28:30.434211 140290927105856 controller.py:252]  eval | step:  160000 | running 625 steps of evaluation...
I0430 16:32:56.348129 140290927105856 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0430 16:38:16.066756 140290927105856 controller.py:261]  eval | step:  160000 | eval time:  585.6 sec | output: 
    {'3': {'avg_iou': 0.49528247,
           'avg_obj': 0.21667837,
           'box_loss': 2.8396394,
           'class_loss': 1.9936764,
           'conf_loss': 25.697992,
           'precision50': 0.119545035,
           'recall50': 0.22509024},
     '4': {'avg_iou': 0.71318024,
           'avg_obj': 0.47154415,
           'box_loss': 2.2055597,
           'class_loss': 1.6608045,
           'conf_loss': 8.024411,
           'precision50': 0.1661248,
           'recall50': 0.5194867},
     '5': {'avg_iou': 0.7737715,
           'avg_obj': 0.59192693,
           'box_loss': 1.1518047,
           'class_loss': 0.92867976,
           'conf_loss': 1.5182606,
           'precision50': 0.24743079,
           'recall50': 0.6612666},
     'AP': 0.3441247,
     'AP50': 0.52112675,
     'AP75': 0.3825088,
     'APl': 0.47541702,
     'APm': 0.37040067,
     'APs': 0.14539377,
     'ARl': 0.6214102,
     'ARm': 0.5279971,
     'ARmax1': 0.2779578,
     'ARmax10': 0.4499308,
     'ARmax100': 0.483403,
     'ARs': 0.26036152,
     'global': {'total_loss': 46.02082},
     'validation_loss': 46.02082}
I0430 16:38:33.309689 140290927105856 controller.py:211] train | step:  160000 | training until step 180000...
I0430 17:32:48.585843 140290927105856 controller.py:425] train | step:  170000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6638441,
           'avg_obj': 0.2490556,
           'box_loss': 5.3401423,
           'class_loss': 4.08203,
           'conf_loss': 30.287725,
           'precision50': 0.1592664,
           'recall50': 0.22406799},
     '4': {'avg_iou': 0.778271,
           'avg_obj': 0.46479908,
           'box_loss': 3.3746462,
           'class_loss': 2.8663461,
           'conf_loss': 9.315173,
           'precision50': 0.20289811,
           'recall50': 0.50055057},
     '5': {'avg_iou': 0.8108676,
           'avg_obj': 0.55688155,
           'box_loss': 1.4268693,
           'class_loss': 1.3616946,
           'conf_loss': 1.5999304,
           'precision50': 0.29624116,
           'recall50': 0.6335217},
     'global': {'total_loss': 59.654606},
     'learning_rate': 0.001,
     'training_loss': 59.654606}
I0430 17:33:38.001769 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-170000.
I0430 18:32:31.452721 140290927105856 controller.py:425] train | step:  180000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6649471,
           'avg_obj': 0.25291732,
           'box_loss': 5.3342505,
           'class_loss': 4.044133,
           'conf_loss': 30.294037,
           'precision50': 0.15942156,
           'recall50': 0.22816192},
     '4': {'avg_iou': 0.78006834,
           'avg_obj': 0.47058403,
           'box_loss': 3.3547044,
           'class_loss': 2.8251886,
           'conf_loss': 9.329454,
           'precision50': 0.20276327,
           'recall50': 0.5061461},
     '5': {'avg_iou': 0.8125177,
           'avg_obj': 0.5618727,
           'box_loss': 1.4168468,
           'class_loss': 1.3450018,
           'conf_loss': 1.6010902,
           'precision50': 0.2951132,
           'recall50': 0.63896},
     'global': {'total_loss': 59.54476},
     'learning_rate': 0.001,
     'training_loss': 59.54476}
I0430 18:33:19.794743 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-180000.
I0430 18:33:19.801984 140290927105856 controller.py:252]  eval | step:  180000 | running 625 steps of evaluation...
I0430 18:37:49.185072 140290927105856 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0430 18:43:04.546748 140290927105856 controller.py:261]  eval | step:  180000 | eval time:  584.7 sec | output: 
    {'3': {'avg_iou': 0.49659735,
           'avg_obj': 0.22023404,
           'box_loss': 2.8235912,
           'class_loss': 1.9735627,
           'conf_loss': 26.097286,
           'precision50': 0.11782131,
           'recall50': 0.22866438},
     '4': {'avg_iou': 0.7150481,
           'avg_obj': 0.4766584,
           'box_loss': 2.1923857,
           'class_loss': 1.6505795,
           'conf_loss': 8.158714,
           'precision50': 0.1665757,
           'recall50': 0.52599126},
     '5': {'avg_iou': 0.7756931,
           'avg_obj': 0.5976409,
           'box_loss': 1.1418842,
           'class_loss': 0.9191575,
           'conf_loss': 1.5526859,
           'precision50': 0.2453534,
           'recall50': 0.6704493},
     'AP': 0.34510076,
     'AP50': 0.51989967,
     'AP75': 0.3837623,
     'APl': 0.47525656,
     'APm': 0.36824712,
     'APs': 0.1473293,
     'ARl': 0.619356,
     'ARm': 0.528152,
     'ARmax1': 0.27953166,
     'ARmax10': 0.45278713,
     'ARmax100': 0.48530215,
     'ARs': 0.26978102,
     'global': {'total_loss': 46.509857},
     'validation_loss': 46.509857}

train | step:  140000 | training until step 160000...
train | step:  150000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6603053,
           'avg_obj': 0.2398302,
           'box_loss': 5.4087467,
           'class_loss': 4.199013,
           'conf_loss': 30.19167,
           'precision50': 0.15979381,
           'recall50': 0.21385479},
     '4': {'avg_iou': 0.7746216,
           'avg_obj': 0.4529444,
           'box_loss': 3.4394367,
           'class_loss': 2.9640067,
           'conf_loss': 9.449533,
           'precision50': 0.20274079,
           'recall50': 0.4870353},
     '5': {'avg_iou': 0.8063583,
           'avg_obj': 0.54445994,
           'box_loss': 1.4641448,
           'class_loss': 1.4144632,
           'conf_loss': 1.6171465,
           'precision50': 0.29634467,
           'recall50': 0.62047875},
     'global': {'total_loss': 60.148033},
     'learning_rate': 0.001,
     'training_loss': 60.148033}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-150000.
train | step:  160000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6621319,
           'avg_obj': 0.24511658,
           'box_loss': 5.3674283,
           'class_loss': 4.124974,
           'conf_loss': 30.105116,
           'precision50': 0.16058049,
           'recall50': 0.21901985},
     '4': {'avg_iou': 0.77675134,
           'avg_obj': 0.4601172,
           'box_loss': 3.3976781,
           'class_loss': 2.901463,
           'conf_loss': 9.380213,
           'precision50': 0.20236792,
           'recall50': 0.49487972},
     '5': {'avg_iou': 0.80886984,
           'avg_obj': 0.55174154,
           'box_loss': 1.4418176,
           'class_loss': 1.3823999,
           'conf_loss': 1.6072106,
           'precision50': 0.29667577,
           'recall50': 0.6286578},
     'global': {'total_loss': 59.708237},
     'learning_rate': 0.001,
     'training_loss': 59.708237}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-160000.
 eval | step:  160000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=215.65s).
Accumulating evaluation results...
DONE (t=39.43s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.344
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.521
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.383
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.145
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.370
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.475
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.278
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.450
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.483
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.260
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.528
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.621
 eval | step:  160000 | eval time:  585.6 sec | output: 
    {'3': {'avg_iou': 0.49528247,
           'avg_obj': 0.21667837,
           'box_loss': 2.8396394,
           'class_loss': 1.9936764,
           'conf_loss': 25.697992,
           'precision50': 0.119545035,
           'recall50': 0.22509024},
     '4': {'avg_iou': 0.71318024,
           'avg_obj': 0.47154415,
           'box_loss': 2.2055597,
           'class_loss': 1.6608045,
           'conf_loss': 8.024411,
           'precision50': 0.1661248,
           'recall50': 0.5194867},
     '5': {'avg_iou': 0.7737715,
           'avg_obj': 0.59192693,
           'box_loss': 1.1518047,
           'class_loss': 0.92867976,
           'conf_loss': 1.5182606,
           'precision50': 0.24743079,
           'recall50': 0.6612666},
     'AP': 0.3441247,
     'AP50': 0.52112675,
     'AP75': 0.3825088,
     'APl': 0.47541702,
     'APm': 0.37040067,
     'APs': 0.14539377,
     'ARl': 0.6214102,
     'ARm': 0.5279971,
     'ARmax1': 0.2779578,
     'ARmax10': 0.4499308,
     'ARmax100': 0.483403,
     'ARs': 0.26036152,
     'global': {'total_loss': 46.02082},
     'validation_loss': 46.02082}
train | step:  160000 | training until step 180000...
train | step:  170000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6638441,
           'avg_obj': 0.2490556,
           'box_loss': 5.3401423,
           'class_loss': 4.08203,
           'conf_loss': 30.287725,
           'precision50': 0.1592664,
           'recall50': 0.22406799},
     '4': {'avg_iou': 0.778271,
           'avg_obj': 0.46479908,
           'box_loss': 3.3746462,
           'class_loss': 2.8663461,
           'conf_loss': 9.315173,
           'precision50': 0.20289811,
           'recall50': 0.50055057},
     '5': {'avg_iou': 0.8108676,
           'avg_obj': 0.55688155,
           'box_loss': 1.4268693,
           'class_loss': 1.3616946,
           'conf_loss': 1.5999304,
           'precision50': 0.29624116,
           'recall50': 0.6335217},
     'global': {'total_loss': 59.654606},
     'learning_rate': 0.001,
     'training_loss': 59.654606}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-170000.
train | step:  180000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6649471,
           'avg_obj': 0.25291732,
           'box_loss': 5.3342505,
           'class_loss': 4.044133,
           'conf_loss': 30.294037,
           'precision50': 0.15942156,
           'recall50': 0.22816192},
     '4': {'avg_iou': 0.78006834,
           'avg_obj': 0.47058403,
           'box_loss': 3.3547044,
           'class_loss': 2.8251886,
           'conf_loss': 9.329454,
           'precision50': 0.20276327,
           'recall50': 0.5061461},
     '5': {'avg_iou': 0.8125177,
           'avg_obj': 0.5618727,
           'box_loss': 1.4168468,
           'class_loss': 1.3450018,
           'conf_loss': 1.6010902,
           'precision50': 0.2951132,
           'recall50': 0.63896},
     'global': {'total_loss': 59.54476},
     'learning_rate': 0.001,
     'training_loss': 59.54476}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-180000.
 eval | step:  180000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=215.87s).
Accumulating evaluation results...
DONE (t=39.61s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.345
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.520
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.384
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.147
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.368
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.475
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.280
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.453
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.270
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.528
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.619
 eval | step:  180000 | eval time:  584.7 sec | output: 
    {'3': {'avg_iou': 0.49659735,
           'avg_obj': 0.22023404,
           'box_loss': 2.8235912,
           'class_loss': 1.9735627,
           'conf_loss': 26.097286,
           'precision50': 0.11782131,
           'recall50': 0.22866438},
     '4': {'avg_iou': 0.7150481,
           'avg_obj': 0.4766584,
           'box_loss': 2.1923857,
           'class_loss': 1.6505795,
           'conf_loss': 8.158714,
           'precision50': 0.1665757,
           'recall50': 0.52599126},
     '5': {'avg_iou': 0.7756931,
           'avg_obj': 0.5976409,
           'box_loss': 1.1418842,
           'class_loss': 0.9191575,
           'conf_loss': 1.5526859,
           'precision50': 0.2453534,
           'recall50': 0.6704493},
     'AP': 0.34510076,
     'AP50': 0.51989967,
     'AP75': 0.3837623,
     'APl': 0.47525656,
     'APm': 0.36824712,
     'APs': 0.1473293,
     'ARl': 0.619356,
     'ARm': 0.528152,
     'ARmax1': 0.27953166,
     'ARmax10': 0.45278713,
     'ARmax100': 0.48530215,
     'ARs': 0.26978102,
     'global': {'total_loss': 46.509857},
     'validation_loss': 46.509857}I0430 18:43:25.955689 140290927105856 controller.py:211] train | step:  180000 | training until step 200000...
I0430 19:36:04.077411 140290927105856 controller.py:425] train | step:  190000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.66590655,
           'avg_obj': 0.25672284,
           'box_loss': 5.3200636,
           'class_loss': 4.0003166,
           'conf_loss': 30.208715,
           'precision50': 0.16046004,
           'recall50': 0.2322533},
     '4': {'avg_iou': 0.78133804,
           'avg_obj': 0.47533974,
           'box_loss': 3.3335855,
           'class_loss': 2.7872036,
           'conf_loss': 9.24345,
           'precision50': 0.20366345,
           'recall50': 0.51183534},
     '5': {'avg_iou': 0.814352,
           'avg_obj': 0.566845,
           'box_loss': 1.4013479,
           'class_loss': 1.3234191,
           'conf_loss': 1.5922726,
           'precision50': 0.29439896,
           'recall50': 0.6450835},
     'global': {'total_loss': 59.21025},
     'learning_rate': 0.001,
     'training_loss': 59.21025}
I0430 19:36:52.808147 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-190000.
I0430 20:35:51.628001 140290927105856 controller.py:425] train | step:  200000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6675297,
           'avg_obj': 0.26044706,
           'box_loss': 5.280048,
           'class_loss': 3.9370477,
           'conf_loss': 30.210934,
           'precision50': 0.15962179,
           'recall50': 0.23654006},
     '4': {'avg_iou': 0.78302723,
           'avg_obj': 0.48019922,
           'box_loss': 3.3067765,
           'class_loss': 2.7444499,
           'conf_loss': 9.225921,
           'precision50': 0.20362055,
           'recall50': 0.51705086},
     '5': {'avg_iou': 0.8158275,
           'avg_obj': 0.5714479,
           'box_loss': 1.3913015,
           'class_loss': 1.3034301,
           'conf_loss': 1.5820428,
           'precision50': 0.29374906,
           'recall50': 0.6491317},
     'global': {'total_loss': 58.98181},
     'learning_rate': 0.001,
     'training_loss': 58.98181}
I0430 20:36:38.134348 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-200000.
I0430 20:36:38.141588 140290927105856 controller.py:252]  eval | step:  200000 | running 625 steps of evaluation...
I0430 20:41:05.529682 140290927105856 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0430 20:46:20.848461 140290927105856 controller.py:261]  eval | step:  200000 | eval time:  582.7 sec | output: 
    {'3': {'avg_iou': 0.49772456,
           'avg_obj': 0.22201467,
           'box_loss': 2.8092089,
           'class_loss': 1.9724629,
           'conf_loss': 26.364456,
           'precision50': 0.119202234,
           'recall50': 0.2334464},
     '4': {'avg_iou': 0.715734,
           'avg_obj': 0.47851983,
           'box_loss': 2.178524,
           'class_loss': 1.6615657,
           'conf_loss': 8.20752,
           'precision50': 0.16599019,
           'recall50': 0.5273748},
     '5': {'avg_iou': 0.7766621,
           'avg_obj': 0.60158896,
           'box_loss': 1.1343149,
           'class_loss': 0.91488767,
           'conf_loss': 1.5585064,
           'precision50': 0.24165505,
           'recall50': 0.6704672},
     'AP': 0.34701288,
     'AP50': 0.5219555,
     'AP75': 0.38555115,
     'APl': 0.479507,
     'APm': 0.36854592,
     'APs': 0.1501889,
     'ARl': 0.62576973,
     'ARm': 0.5284458,
     'ARmax1': 0.28126118,
     'ARmax10': 0.4544328,
     'ARmax100': 0.48826888,
     'ARs': 0.2669244,
     'global': {'total_loss': 46.801468},
     'validation_loss': 46.801468}
I0430 20:46:37.476889 140290927105856 controller.py:211] train | step:  200000 | training until step 220000...
I0430 21:37:57.697367 140290927105856 controller.py:425] train | step:  210000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.66863024,
           'avg_obj': 0.26366618,
           'box_loss': 5.2670846,
           'class_loss': 3.9004095,
           'conf_loss': 30.203335,
           'precision50': 0.16000561,
           'recall50': 0.23981757},
     '4': {'avg_iou': 0.7843791,
           'avg_obj': 0.48478863,
           'box_loss': 3.2879508,
           'class_loss': 2.7123346,
           'conf_loss': 9.138124,
           'precision50': 0.20419544,
           'recall50': 0.52250886},
     '5': {'avg_iou': 0.8175833,
           'avg_obj': 0.57616067,
           'box_loss': 1.3802304,
           'class_loss': 1.2887251,
           'conf_loss': 1.5757061,
           'precision50': 0.29409108,
           'recall50': 0.6543595},
     'global': {'total_loss': 58.75387},
     'learning_rate': 0.001,
     'training_loss': 58.75387}
I0430 21:38:45.209269 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-210000.
I0430 22:38:37.386609 140290927105856 controller.py:425] train | step:  220000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6694294,
           'avg_obj': 0.2667114,
           'box_loss': 5.2529664,
           'class_loss': 3.8629706,
           'conf_loss': 29.940882,
           'precision50': 0.16058326,
           'recall50': 0.2431605},
     '4': {'avg_iou': 0.78545696,
           'avg_obj': 0.4889993,
           'box_loss': 3.2660966,
           'class_loss': 2.671315,
           'conf_loss': 9.089832,
           'precision50': 0.20484038,
           'recall50': 0.5262176},
     '5': {'avg_iou': 0.8191252,
           'avg_obj': 0.5810964,
           'box_loss': 1.3655026,
           'class_loss': 1.266234,
           'conf_loss': 1.5722451,
           'precision50': 0.2932178,
           'recall50': 0.65956354},
     'global': {'total_loss': 58.288067},
     'learning_rate': 0.001,
     'training_loss': 58.288067}
I0430 22:39:24.411069 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-220000.
I0430 22:39:24.417395 140290927105856 controller.py:252]  eval | step:  220000 | running 625 steps of evaluation...
I0430 22:43:54.880406 140290927105856 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0430 22:49:10.031033 140290927105856 controller.py:261]  eval | step:  220000 | eval time:  585.6 sec | output: 
    {'3': {'avg_iou': 0.4983144,
           'avg_obj': 0.22467366,
           'box_loss': 2.801524,
           'class_loss': 1.9680535,
           'conf_loss': 26.766775,
           'precision50': 0.11962858,
           'recall50': 0.23670734},
     '4': {'avg_iou': 0.71663886,
           'avg_obj': 0.48223466,
           'box_loss': 2.171881,
           'class_loss': 1.6693269,
           'conf_loss': 8.255888,
           'precision50': 0.16538775,
           'recall50': 0.53175575},
     '5': {'avg_iou': 0.7782296,
           'avg_obj': 0.6069979,
           'box_loss': 1.124221,
           'class_loss': 0.91868144,
           'conf_loss': 1.562637,
           'precision50': 0.24176812,
           'recall50': 0.67624635},
     'AP': 0.34789377,
     'AP50': 0.5209949,
     'AP75': 0.38507617,
     'APl': 0.48014802,
     'APm': 0.36858833,
     'APs': 0.14924309,
     'ARl': 0.6252809,
     'ARm': 0.53124964,
     'ARmax1': 0.2833203,
     'ARmax10': 0.45585695,
     'ARmax100': 0.49056435,
     'ARs': 0.27051854,
     'global': {'total_loss': 47.238964},
     'validation_loss': 47.238964}

train | step:  180000 | training until step 200000...
train | step:  190000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.66590655,
           'avg_obj': 0.25672284,
           'box_loss': 5.3200636,
           'class_loss': 4.0003166,
           'conf_loss': 30.208715,
           'precision50': 0.16046004,
           'recall50': 0.2322533},
     '4': {'avg_iou': 0.78133804,
           'avg_obj': 0.47533974,
           'box_loss': 3.3335855,
           'class_loss': 2.7872036,
           'conf_loss': 9.24345,
           'precision50': 0.20366345,
           'recall50': 0.51183534},
     '5': {'avg_iou': 0.814352,
           'avg_obj': 0.566845,
           'box_loss': 1.4013479,
           'class_loss': 1.3234191,
           'conf_loss': 1.5922726,
           'precision50': 0.29439896,
           'recall50': 0.6450835},
     'global': {'total_loss': 59.21025},
     'learning_rate': 0.001,
     'training_loss': 59.21025}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-190000.
train | step:  200000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6675297,
           'avg_obj': 0.26044706,
           'box_loss': 5.280048,
           'class_loss': 3.9370477,
           'conf_loss': 30.210934,
           'precision50': 0.15962179,
           'recall50': 0.23654006},
     '4': {'avg_iou': 0.78302723,
           'avg_obj': 0.48019922,
           'box_loss': 3.3067765,
           'class_loss': 2.7444499,
           'conf_loss': 9.225921,
           'precision50': 0.20362055,
           'recall50': 0.51705086},
     '5': {'avg_iou': 0.8158275,
           'avg_obj': 0.5714479,
           'box_loss': 1.3913015,
           'class_loss': 1.3034301,
           'conf_loss': 1.5820428,
           'precision50': 0.29374906,
           'recall50': 0.6491317},
     'global': {'total_loss': 58.98181},
     'learning_rate': 0.001,
     'training_loss': 58.98181}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-200000.
 eval | step:  200000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=212.63s).
Accumulating evaluation results...
DONE (t=39.40s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.347
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.522
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.386
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.150
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.369
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.480
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.281
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.454
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.488
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.267
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.528
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.626
 eval | step:  200000 | eval time:  582.7 sec | output: 
    {'3': {'avg_iou': 0.49772456,
           'avg_obj': 0.22201467,
           'box_loss': 2.8092089,
           'class_loss': 1.9724629,
           'conf_loss': 26.364456,
           'precision50': 0.119202234,
           'recall50': 0.2334464},
     '4': {'avg_iou': 0.715734,
           'avg_obj': 0.47851983,
           'box_loss': 2.178524,
           'class_loss': 1.6615657,
           'conf_loss': 8.20752,
           'precision50': 0.16599019,
           'recall50': 0.5273748},
     '5': {'avg_iou': 0.7766621,
           'avg_obj': 0.60158896,
           'box_loss': 1.1343149,
           'class_loss': 0.91488767,
           'conf_loss': 1.5585064,
           'precision50': 0.24165505,
           'recall50': 0.6704672},
     'AP': 0.34701288,
     'AP50': 0.5219555,
     'AP75': 0.38555115,
     'APl': 0.479507,
     'APm': 0.36854592,
     'APs': 0.1501889,
     'ARl': 0.62576973,
     'ARm': 0.5284458,
     'ARmax1': 0.28126118,
     'ARmax10': 0.4544328,
     'ARmax100': 0.48826888,
     'ARs': 0.2669244,
     'global': {'total_loss': 46.801468},
     'validation_loss': 46.801468}
train | step:  200000 | training until step 220000...
train | step:  210000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.66863024,
           'avg_obj': 0.26366618,
           'box_loss': 5.2670846,
           'class_loss': 3.9004095,
           'conf_loss': 30.203335,
           'precision50': 0.16000561,
           'recall50': 0.23981757},
     '4': {'avg_iou': 0.7843791,
           'avg_obj': 0.48478863,
           'box_loss': 3.2879508,
           'class_loss': 2.7123346,
           'conf_loss': 9.138124,
           'precision50': 0.20419544,
           'recall50': 0.52250886},
     '5': {'avg_iou': 0.8175833,
           'avg_obj': 0.57616067,
           'box_loss': 1.3802304,
           'class_loss': 1.2887251,
           'conf_loss': 1.5757061,
           'precision50': 0.29409108,
           'recall50': 0.6543595},
     'global': {'total_loss': 58.75387},
     'learning_rate': 0.001,
     'training_loss': 58.75387}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-210000.
train | step:  220000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6694294,
           'avg_obj': 0.2667114,
           'box_loss': 5.2529664,
           'class_loss': 3.8629706,
           'conf_loss': 29.940882,
           'precision50': 0.16058326,
           'recall50': 0.2431605},
     '4': {'avg_iou': 0.78545696,
           'avg_obj': 0.4889993,
           'box_loss': 3.2660966,
           'class_loss': 2.671315,
           'conf_loss': 9.089832,
           'precision50': 0.20484038,
           'recall50': 0.5262176},
     '5': {'avg_iou': 0.8191252,
           'avg_obj': 0.5810964,
           'box_loss': 1.3655026,
           'class_loss': 1.266234,
           'conf_loss': 1.5722451,
           'precision50': 0.2932178,
           'recall50': 0.65956354},
     'global': {'total_loss': 58.288067},
     'learning_rate': 0.001,
     'training_loss': 58.288067}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-220000.
 eval | step:  220000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=214.89s).
Accumulating evaluation results...
DONE (t=38.85s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.348
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.521
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.385
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.149
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.369
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.480
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.283
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.456
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.271
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.531
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.625
 eval | step:  220000 | eval time:  585.6 sec | output: 
    {'3': {'avg_iou': 0.4983144,
           'avg_obj': 0.22467366,
           'box_loss': 2.801524,
           'class_loss': 1.9680535,
           'conf_loss': 26.766775,
           'precision50': 0.11962858,
           'recall50': 0.23670734},
     '4': {'avg_iou': 0.71663886,
           'avg_obj': 0.48223466,
           'box_loss': 2.171881,
           'class_loss': 1.6693269,
           'conf_loss': 8.255888,
           'precision50': 0.16538775,
           'recall50': 0.53175575},
     '5': {'avg_iou': 0.7782296,
           'avg_obj': 0.6069979,
           'box_loss': 1.124221,
           'class_loss': 0.91868144,
           'conf_loss': 1.562637,
           'precision50': 0.24176812,
           'recall50': 0.67624635},
     'AP': 0.34789377,
     'AP50': 0.5209949,
     'AP75': 0.38507617,
     'APl': 0.48014802,
     'APm': 0.36858833,
     'APs': 0.14924309,
     'ARl': 0.6252809,
     'ARm': 0.53124964,
     'ARmax1': 0.2833203,
     'ARmax10': 0.45585695,
     'ARmax100': 0.49056435,
     'ARs': 0.27051854,
     'global': {'total_loss': 47.238964},
     'validation_loss': 47.238964}I0430 22:49:28.725127 140290927105856 controller.py:211] train | step:  220000 | training until step 240000...
I0430 23:39:41.080043 140290927105856 controller.py:425] train | step:  230000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.670029,
           'avg_obj': 0.26968986,
           'box_loss': 5.2508755,
           'class_loss': 3.8313153,
           'conf_loss': 29.96115,
           'precision50': 0.16106685,
           'recall50': 0.2462021},
     '4': {'avg_iou': 0.7860973,
           'avg_obj': 0.49193794,
           'box_loss': 3.2589045,
           'class_loss': 2.6471074,
           'conf_loss': 9.0614605,
           'precision50': 0.20533335,
           'recall50': 0.5298032},
     '5': {'avg_iou': 0.8202914,
           'avg_obj': 0.58395976,
           'box_loss': 1.3558006,
           'class_loss': 1.2488765,
           'conf_loss': 1.566264,
           'precision50': 0.29283762,
           'recall50': 0.66156644},
     'global': {'total_loss': 58.181656},
     'learning_rate': 0.001,
     'training_loss': 58.181656}
I0430 23:40:27.401400 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-230000.
I0501 00:39:51.654759 140290927105856 controller.py:425] train | step:  240000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6708248,
           'avg_obj': 0.27269566,
           'box_loss': 5.24493,
           'class_loss': 3.798434,
           'conf_loss': 29.945807,
           'precision50': 0.16146408,
           'recall50': 0.25011075},
     '4': {'avg_iou': 0.787626,
           'avg_obj': 0.49688032,
           'box_loss': 3.2391849,
           'class_loss': 2.617488,
           'conf_loss': 9.046072,
           'precision50': 0.20445225,
           'recall50': 0.5351459},
     '5': {'avg_iou': 0.82168216,
           'avg_obj': 0.58901787,
           'box_loss': 1.3483229,
           'class_loss': 1.2347502,
           'conf_loss': 1.5567023,
           'precision50': 0.29314387,
           'recall50': 0.6670702},
     'global': {'total_loss': 58.03172},
     'learning_rate': 0.001,
     'training_loss': 58.03172}
I0501 00:40:38.889463 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-240000.
I0501 00:40:38.896523 140290927105856 controller.py:252]  eval | step:  240000 | running 625 steps of evaluation...
I0501 00:45:07.216956 140290927105856 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 00:50:16.954548 140290927105856 controller.py:261]  eval | step:  240000 | eval time:  578.1 sec | output: 
    {'3': {'avg_iou': 0.49851015,
           'avg_obj': 0.22682112,
           'box_loss': 2.7985272,
           'class_loss': 1.953742,
           'conf_loss': 27.003363,
           'precision50': 0.11690663,
           'recall50': 0.23681526},
     '4': {'avg_iou': 0.71768767,
           'avg_obj': 0.483826,
           'box_loss': 2.1640155,
           'class_loss': 1.6565642,
           'conf_loss': 8.311171,
           'precision50': 0.16515797,
           'recall50': 0.5299572},
     '5': {'avg_iou': 0.7804615,
           'avg_obj': 0.609262,
           'box_loss': 1.1140728,
           'class_loss': 0.90581894,
           'conf_loss': 1.5897702,
           'precision50': 0.24064448,
           'recall50': 0.67659205},
     'AP': 0.3500557,
     'AP50': 0.5234954,
     'AP75': 0.3883819,
     'APl': 0.48323882,
     'APm': 0.36941692,
     'APs': 0.1522154,
     'ARl': 0.6306126,
     'ARm': 0.53081155,
     'ARmax1': 0.2846679,
     'ARmax10': 0.45952877,
     'ARmax100': 0.49343568,
     'ARs': 0.27060404,
     'global': {'total_loss': 47.497025},
     'validation_loss': 47.497025}
I0501 00:50:39.311339 140290927105856 controller.py:211] train | step:  240000 | training until step 260000...
I0501 01:40:26.212204 140290927105856 controller.py:425] train | step:  250000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.67192405,
           'avg_obj': 0.27542913,
           'box_loss': 5.2220526,
           'class_loss': 3.7619011,
           'conf_loss': 29.834156,
           'precision50': 0.16143525,
           'recall50': 0.25237274},
     '4': {'avg_iou': 0.7884118,
           'avg_obj': 0.49975878,
           'box_loss': 3.2235534,
           'class_loss': 2.5907717,
           'conf_loss': 8.959071,
           'precision50': 0.20556326,
           'recall50': 0.5383705},
     '5': {'avg_iou': 0.8228313,
           'avg_obj': 0.59200233,
           'box_loss': 1.3365346,
           'class_loss': 1.2230343,
           'conf_loss': 1.557857,
           'precision50': 0.29262814,
           'recall50': 0.67079586},
     'global': {'total_loss': 57.70899},
     'learning_rate': 0.001,
     'training_loss': 57.70899}
I0501 01:41:12.889193 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-250000.
I0501 02:40:42.209832 140290927105856 controller.py:425] train | step:  260000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.67237735,
           'avg_obj': 0.27780244,
           'box_loss': 5.2109327,
           'class_loss': 3.736631,
           'conf_loss': 29.91345,
           'precision50': 0.16083561,
           'recall50': 0.25541413},
     '4': {'avg_iou': 0.78962564,
           'avg_obj': 0.5035305,
           'box_loss': 3.206794,
           'class_loss': 2.5687802,
           'conf_loss': 8.901734,
           'precision50': 0.20598088,
           'recall50': 0.5420178},
     '5': {'avg_iou': 0.82405794,
           'avg_obj': 0.59585226,
           'box_loss': 1.3276235,
           'class_loss': 1.2077852,
           'conf_loss': 1.5478702,
           'precision50': 0.292248,
           'recall50': 0.6741798},
     'global': {'total_loss': 57.621525},
     'learning_rate': 0.001,
     'training_loss': 57.621525}
I0501 02:41:30.151418 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-260000.
I0501 02:41:30.157365 140290927105856 controller.py:252]  eval | step:  260000 | running 625 steps of evaluation...
I0501 02:46:00.801898 140290927105856 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 02:51:18.092097 140290927105856 controller.py:261]  eval | step:  260000 | eval time:  587.9 sec | output: 
    {'3': {'avg_iou': 0.49871537,
           'avg_obj': 0.22687395,
           'box_loss': 2.791117,
           'class_loss': 1.9649488,
           'conf_loss': 27.154102,
           'precision50': 0.11725318,
           'recall50': 0.23747896},
     '4': {'avg_iou': 0.7180954,
           'avg_obj': 0.48656332,
           'box_loss': 2.1568658,
           'class_loss': 1.6564534,
           'conf_loss': 8.287768,
           'precision50': 0.16366681,
           'recall50': 0.53365},
     '5': {'avg_iou': 0.78150845,
           'avg_obj': 0.61263025,
           'box_loss': 1.1074865,
           'class_loss': 0.91156477,
           'conf_loss': 1.5802861,
           'precision50': 0.23990174,
           'recall50': 0.6799966},
     'AP': 0.3501891,
     'AP50': 0.5222365,
     'AP75': 0.3878379,
     'APl': 0.48685685,
     'APm': 0.36881375,
     'APs': 0.15112652,
     'ARl': 0.63817453,
     'ARm': 0.53168166,
     'ARmax1': 0.28471884,
     'ARmax10': 0.46074712,
     'ARmax100': 0.49479422,
     'ARs': 0.27401775,
     'global': {'total_loss': 47.610588},
     'validation_loss': 47.610588}

train | step:  220000 | training until step 240000...
train | step:  230000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.670029,
           'avg_obj': 0.26968986,
           'box_loss': 5.2508755,
           'class_loss': 3.8313153,
           'conf_loss': 29.96115,
           'precision50': 0.16106685,
           'recall50': 0.2462021},
     '4': {'avg_iou': 0.7860973,
           'avg_obj': 0.49193794,
           'box_loss': 3.2589045,
           'class_loss': 2.6471074,
           'conf_loss': 9.0614605,
           'precision50': 0.20533335,
           'recall50': 0.5298032},
     '5': {'avg_iou': 0.8202914,
           'avg_obj': 0.58395976,
           'box_loss': 1.3558006,
           'class_loss': 1.2488765,
           'conf_loss': 1.566264,
           'precision50': 0.29283762,
           'recall50': 0.66156644},
     'global': {'total_loss': 58.181656},
     'learning_rate': 0.001,
     'training_loss': 58.181656}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-230000.
train | step:  240000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6708248,
           'avg_obj': 0.27269566,
           'box_loss': 5.24493,
           'class_loss': 3.798434,
           'conf_loss': 29.945807,
           'precision50': 0.16146408,
           'recall50': 0.25011075},
     '4': {'avg_iou': 0.787626,
           'avg_obj': 0.49688032,
           'box_loss': 3.2391849,
           'class_loss': 2.617488,
           'conf_loss': 9.046072,
           'precision50': 0.20445225,
           'recall50': 0.5351459},
     '5': {'avg_iou': 0.82168216,
           'avg_obj': 0.58901787,
           'box_loss': 1.3483229,
           'class_loss': 1.2347502,
           'conf_loss': 1.5567023,
           'precision50': 0.29314387,
           'recall50': 0.6670702},
     'global': {'total_loss': 58.03172},
     'learning_rate': 0.001,
     'training_loss': 58.03172}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-240000.
 eval | step:  240000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=211.52s).
Accumulating evaluation results...
DONE (t=40.75s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.350
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.523
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.388
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.152
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.369
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.483
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.285
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.460
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.493
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.271
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.531
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.631
 eval | step:  240000 | eval time:  578.1 sec | output: 
    {'3': {'avg_iou': 0.49851015,
           'avg_obj': 0.22682112,
           'box_loss': 2.7985272,
           'class_loss': 1.953742,
           'conf_loss': 27.003363,
           'precision50': 0.11690663,
           'recall50': 0.23681526},
     '4': {'avg_iou': 0.71768767,
           'avg_obj': 0.483826,
           'box_loss': 2.1640155,
           'class_loss': 1.6565642,
           'conf_loss': 8.311171,
           'precision50': 0.16515797,
           'recall50': 0.5299572},
     '5': {'avg_iou': 0.7804615,
           'avg_obj': 0.609262,
           'box_loss': 1.1140728,
           'class_loss': 0.90581894,
           'conf_loss': 1.5897702,
           'precision50': 0.24064448,
           'recall50': 0.67659205},
     'AP': 0.3500557,
     'AP50': 0.5234954,
     'AP75': 0.3883819,
     'APl': 0.48323882,
     'APm': 0.36941692,
     'APs': 0.1522154,
     'ARl': 0.6306126,
     'ARm': 0.53081155,
     'ARmax1': 0.2846679,
     'ARmax10': 0.45952877,
     'ARmax100': 0.49343568,
     'ARs': 0.27060404,
     'global': {'total_loss': 47.497025},
     'validation_loss': 47.497025}
train | step:  240000 | training until step 260000...
train | step:  250000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.67192405,
           'avg_obj': 0.27542913,
           'box_loss': 5.2220526,
           'class_loss': 3.7619011,
           'conf_loss': 29.834156,
           'precision50': 0.16143525,
           'recall50': 0.25237274},
     '4': {'avg_iou': 0.7884118,
           'avg_obj': 0.49975878,
           'box_loss': 3.2235534,
           'class_loss': 2.5907717,
           'conf_loss': 8.959071,
           'precision50': 0.20556326,
           'recall50': 0.5383705},
     '5': {'avg_iou': 0.8228313,
           'avg_obj': 0.59200233,
           'box_loss': 1.3365346,
           'class_loss': 1.2230343,
           'conf_loss': 1.557857,
           'precision50': 0.29262814,
           'recall50': 0.67079586},
     'global': {'total_loss': 57.70899},
     'learning_rate': 0.001,
     'training_loss': 57.70899}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-250000.
train | step:  260000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.67237735,
           'avg_obj': 0.27780244,
           'box_loss': 5.2109327,
           'class_loss': 3.736631,
           'conf_loss': 29.91345,
           'precision50': 0.16083561,
           'recall50': 0.25541413},
     '4': {'avg_iou': 0.78962564,
           'avg_obj': 0.5035305,
           'box_loss': 3.206794,
           'class_loss': 2.5687802,
           'conf_loss': 8.901734,
           'precision50': 0.20598088,
           'recall50': 0.5420178},
     '5': {'avg_iou': 0.82405794,
           'avg_obj': 0.59585226,
           'box_loss': 1.3276235,
           'class_loss': 1.2077852,
           'conf_loss': 1.5478702,
           'precision50': 0.292248,
           'recall50': 0.6741798},
     'global': {'total_loss': 57.621525},
     'learning_rate': 0.001,
     'training_loss': 57.621525}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-260000.
 eval | step:  260000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=211.30s).
Accumulating evaluation results...
DONE (t=43.52s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.350
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.522
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.388
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.151
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.369
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.487
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.285
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.461
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.495
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.274
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.532
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.638
 eval | step:  260000 | eval time:  587.9 sec | output: 
    {'3': {'avg_iou': 0.49871537,
           'avg_obj': 0.22687395,
           'box_loss': 2.791117,
           'class_loss': 1.9649488,
           'conf_loss': 27.154102,
           'precision50': 0.11725318,
           'recall50': 0.23747896},
     '4': {'avg_iou': 0.7180954,
           'avg_obj': 0.48656332,
           'box_loss': 2.1568658,
           'class_loss': 1.6564534,
           'conf_loss': 8.287768,
           'precision50': 0.16366681,
           'recall50': 0.53365},
     '5': {'avg_iou': 0.78150845,
           'avg_obj': 0.61263025,
           'box_loss': 1.1074865,
           'class_loss': 0.91156477,
           'conf_loss': 1.5802861,
           'precision50': 0.23990174,
           'recall50': 0.6799966},
     'AP': 0.3501891,
     'AP50': 0.5222365,
     'AP75': 0.3878379,
     'APl': 0.48685685,
     'APm': 0.36881375,
     'APs': 0.15112652,
     'ARl': 0.63817453,
     'ARm': 0.53168166,
     'ARmax1': 0.28471884,
     'ARmax10': 0.46074712,
     'ARmax100': 0.49479422,
     'ARs': 0.27401775,
     'global': {'total_loss': 47.610588},
     'validation_loss': 47.610588}I0501 02:51:39.975794 140290927105856 controller.py:211] train | step:  260000 | training until step 280000...
I0501 03:41:18.314862 140290927105856 controller.py:425] train | step:  270000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.67267627,
           'avg_obj': 0.28007326,
           'box_loss': 5.220128,
           'class_loss': 3.7110937,
           'conf_loss': 29.697609,
           'precision50': 0.16329958,
           'recall50': 0.2572995},
     '4': {'avg_iou': 0.79076916,
           'avg_obj': 0.5077683,
           'box_loss': 3.1928473,
           'class_loss': 2.5312464,
           'conf_loss': 8.872078,
           'precision50': 0.2054002,
           'recall50': 0.5466379},
     '5': {'avg_iou': 0.82513875,
           'avg_obj': 0.5997068,
           'box_loss': 1.319783,
           'class_loss': 1.1905072,
           'conf_loss': 1.5374217,
           'precision50': 0.29219696,
           'recall50': 0.6779968},
     'global': {'total_loss': 57.272663},
     'learning_rate': 0.001,
     'training_loss': 57.272663}
I0501 03:42:04.806664 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-270000.
I0501 04:41:57.008429 140290927105856 controller.py:425] train | step:  280000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.674381,
           'avg_obj': 0.28383958,
           'box_loss': 5.1894555,
           'class_loss': 3.679521,
           'conf_loss': 29.458544,
           'precision50': 0.16341577,
           'recall50': 0.26127318},
     '4': {'avg_iou': 0.79196334,
           'avg_obj': 0.5114996,
           'box_loss': 3.1718073,
           'class_loss': 2.503007,
           'conf_loss': 8.829982,
           'precision50': 0.20483203,
           'recall50': 0.5502509},
     '5': {'avg_iou': 0.82622087,
           'avg_obj': 0.60344297,
           'box_loss': 1.3102592,
           'class_loss': 1.175707,
           'conf_loss': 1.5299795,
           'precision50': 0.29169792,
           'recall50': 0.68206406},
     'global': {'total_loss': 56.848392},
     'learning_rate': 0.001,
     'training_loss': 56.848392}
I0501 04:42:43.982616 140290927105856 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test1/ckpt-280000.
I0501 04:42:43.989132 140290927105856 controller.py:252]  eval | step:  280000 | running 625 steps of evaluation...
I0501 04:47:12.082239 140290927105856 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 04:52:19.031239 140290927105856 controller.py:261]  eval | step:  280000 | eval time:  575.0 sec | output: 
    {'3': {'avg_iou': 0.49898744,
           'avg_obj': 0.22823638,
           'box_loss': 2.785366,
           'class_loss': 1.939133,
           'conf_loss': 27.063572,
           'precision50': 0.11738462,
           'recall50': 0.24037598},
     '4': {'avg_iou': 0.71797067,
           'avg_obj': 0.4893076,
           'box_loss': 2.1557493,
           'class_loss': 1.6418604,
           'conf_loss': 8.316825,
           'precision50': 0.1622526,
           'recall50': 0.5372859},
     '5': {'avg_iou': 0.78237534,
           'avg_obj': 0.6159229,
           'box_loss': 1.1020526,
           'class_loss': 0.9058289,
           'conf_loss': 1.5936855,
           'precision50': 0.23948984,
           'recall50': 0.68289024},
     'AP': 0.35139397,
     'AP50': 0.5243695,
     'AP75': 0.38736275,
     'APl': 0.4863116,
     'APm': 0.3706952,
     'APs': 0.15249065,
     'ARl': 0.6329057,
     'ARm': 0.53158903,
     'ARmax1': 0.28417698,
     'ARmax10': 0.459576,
     'ARmax100': 0.49358067,
     'ARs': 0.2716361,
     'global': {'total_loss': 47.504086},
     'validation_loss': 47.504086}
I0501 04:52:43.244566 140290927105856 controller.py:211] train | step:  280000 | training until step 300000...
