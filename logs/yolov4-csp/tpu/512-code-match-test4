cat: .experiment_zone: No such file or directory
Request issued for: [node-2]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-30T16:50:00.202500541Z'
  endTime: '2021-04-30T16:50:37.610644752Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619801400187-5c13367109baf-986bec68-35cfd1ad
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.73.142.64/29
  createTime: '2021-03-13T00:10:24.868252445Z'
  health: HEALTHY
  ipAddress: 10.73.142.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.73.142.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-25T19:28:21.704126002Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T19:28:19Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-03-28T21:10:24.483577115Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:10:19Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T02:18:59.164603377Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T02:18:30.044758+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-30T05:32:54.575339610Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-30T05:32:31.628489+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619801400187-5c13367109baf-986bec68-35cfd1ad] to complete...
..........................................................................................................................................................................................................done.
europe-west4-a
I0430 16:47:19.868695 140039519143744 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.2,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.3,
                                         'aug_scale_max': 2.0,
                                         'aug_scale_min': 0.1,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [400000,
                                                                                450000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.001,
                                                                            0.0001,
                                                                            1e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 500000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0430 16:47:19.869843 140039519143744 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/params.yaml
I0430 16:47:21.404762 140039519143744 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0430 16:47:21.548376 140039519143744 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2?alt=json
I0430 16:47:21.548718 140039519143744 transport.py:157] Attempting refresh to obtain initial access_token
I0430 16:47:21.614688 140039519143744 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0430 16:47:21.758258 140039519143744 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2?alt=json
I0430 16:47:21.758611 140039519143744 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-30 16:47:21.807042: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0430 16:47:21.807889 140039519143744 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0430 16:47:21.950667 140039519143744 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2?alt=json
I0430 16:47:21.950934 140039519143744 transport.py:157] Attempting refresh to obtain initial access_token
I0430 16:47:22.020415 140039519143744 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0430 16:47:22.164803 140039519143744 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2?alt=json
I0430 16:47:22.165087 140039519143744 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-30 16:47:22.214385: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-30 16:47:22.231053: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.73.142.66:8470}
2021-04-30 16:47:22.231147: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:44851}
2021-04-30 16:47:55.602623: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.73.142.66:8470}
2021-04-30 16:47:55.602712: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:44851}
2021-04-30 16:47:55.603670: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:44851
I0430 16:47:55.604715 140039519143744 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-2
I0430 16:47:55.605516 140039519143744 tpu_strategy_util.py:74] Initializing the TPU system: node-2
INFO:tensorflow:Clearing out eager caches
I0430 16:48:04.344045 140039519143744 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0430 16:48:04.346564 140039519143744 tpu_strategy_util.py:133] Finished initializing TPU system.
I0430 16:48:04.348161 140039519143744 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0430 16:48:04.499801 140039519143744 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2?alt=json
I0430 16:48:04.500091 140039519143744 transport.py:157] Attempting refresh to obtain initial access_token
I0430 16:48:04.566104 140039519143744 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0430 16:48:05.185535 140039519143744 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2?alt=json
I0430 16:48:05.185802 140039519143744 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0430 16:48:05.242603 140039519143744 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0430 16:48:05.242900 140039519143744 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0430 16:48:05.243298 140039519143744 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0430 16:48:05.243410 140039519143744 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0430 16:48:05.243507 140039519143744 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0430 16:48:05.243732 140039519143744 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0430 16:48:05.243824 140039519143744 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0430 16:48:05.243959 140039519143744 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0430 16:48:05.244063 140039519143744 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0430 16:48:05.244176 140039519143744 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0430 16:48:05.244277 140039519143744 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0430 16:48:05.244380 140039519143744 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0430 16:48:05.244468 140039519143744 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0430 16:48:05.244554 140039519143744 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0430 16:48:05.244639 140039519143744 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0430 16:48:05.244724 140039519143744 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0430 16:48:05.246125 140039519143744 train_utils.py:214] Running default trainer.
2021-04-30 16:48:05.269146: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.2, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.3, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [400000, 450000], 'values': [0.001, 0.0001, 1e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 500000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f5d197dde10>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________
yolo_fpn (YoloFPN)              {'5': (None, 16, 16, 9626112     input_2[0][0]                    
                                                                 input_3[0][0]                    I0430 16:49:01.636050 140039519143744 controller.py:362] restoring or initializing model...
I0430 16:49:11.593538 140039519143744 yolo.py:542] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0430 16:49:11.596122 140039519143744 controller.py:368] initialized model.
I0430 16:49:11.596393 140039519143744 train_lib.py:96] Starts to execute mode: train_and_eval
I0430 16:49:11.601804 140039519143744 controller.py:211] train | step:      0 | training until step 20000...
I0430 16:49:19.255947 140039519143744 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0430 16:50:29.220239 140039519143744 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0430 17:56:14.232532 140039519143744 controller.py:425] train | step:  10000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.5740593,
           'avg_obj': 0.10051979,
           'box_loss': 6.7404594,
           'class_loss': 22.51212,
           'conf_loss': 158.92206,
           'precision50': 0.119758725,
           'recall50': 0.049052414},
     '4': {'avg_iou': 0.6492797,
           'avg_obj': 0.19694242,
           'box_loss': 5.337481,
           'class_loss': 20.327148,
           'conf_loss': 20.742485,
           'precision50': 0.1963999,
           'recall50': 0.15711765},
     '5': {'avg_iou': 0.65941066,
           'avg_obj': 0.2560589,
           'box_loss': 2.5709565,
           'class_loss': 10.254598,
           'conf_loss': 3.1802073,
           'precision50': 0.2808522,
           'recall50': 0.22948776},
     'global': {'total_loss': 250.58798},
     'learning_rate': 0.001,
     'training_loss': 250.58798}
I0430 17:57:11.313333 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-10000.
I0430 18:57:01.633958 140039519143744 controller.py:425] train | step:  20000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6315825,
           'avg_obj': 0.16565822,
           'box_loss': 5.8383374,
           'class_loss': 7.6885834,
           'conf_loss': 34.856895,
           'precision50': 0.1679995,
           'recall50': 0.10632234},
     '4': {'avg_iou': 0.72531784,
           'avg_obj': 0.3128101,
           'box_loss': 4.1806717,
           'class_loss': 5.769694,
           'conf_loss': 10.840766,
           'precision50': 0.2257341,
           'recall50': 0.30118275},
     '5': {'avg_iou': 0.7497864,
           'avg_obj': 0.39892793,
           'box_loss': 1.8907954,
           'class_loss': 2.7074828,
           'conf_loss': 1.9403082,
           'precision50': 0.3328637,
           'recall50': 0.43151984},
     'global': {'total_loss': 75.713615},
     'learning_rate': 0.001,
     'training_loss': 75.713615}
I0430 18:57:48.860401 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-20000.
I0430 18:57:48.867403 140039519143744 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0430 18:57:49.572449 140039519143744 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0430 18:58:07.605937 140039519143744 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0430 19:03:15.069847 140039519143744 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0430 19:09:28.805658 140039519143744 controller.py:261]  eval | step:  20000 | eval time:  699.9 sec | output: 
    {'3': {'avg_iou': 0.48617685,
           'avg_obj': 0.17431378,
           'box_loss': 2.9630888,
           'class_loss': 3.1842775,
           'conf_loss': 27.545088,
           'precision50': 0.14025545,
           'recall50': 0.16655862},
     '4': {'avg_iou': 0.6894119,
           'avg_obj': 0.37786502,
           'box_loss': 2.4479833,
           'class_loss': 2.5027945,
           'conf_loss': 8.211833,
           'precision50': 0.18964536,
           'recall50': 0.4049239},
     '5': {'avg_iou': 0.73966575,
           'avg_obj': 0.48891938,
           'box_loss': 1.3594086,
           'class_loss': 1.3750674,
           'conf_loss': 1.6391826,
           'precision50': 0.27764413,
           'recall50': 0.54364944},
     'AP': 0.2518648,
     'AP50': 0.4197457,
     'AP75': 0.27010223,
     'APl': 0.3297875,
     'APm': 0.27291253,
     'APs': 0.08516057,
     'ARl': 0.52037734,
     'ARm': 0.45624208,
     'ARmax1': 0.22279361,
     'ARmax10': 0.37610957,
     'ARmax100': 0.41180843,
     'ARs': 0.18581505,
     'global': {'total_loss': 51.228695},
     'validation_loss': 51.228695}

                                                                 input_4[0][0]                    
__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'3': (None, 64, 64, 16271360    yolo_fpn[0][0]                   
                                                                 yolo_fpn[0][1]                   
                                                                 yolo_fpn[0][2]                   
==================================================================================================
Total params: 25,897,472
Trainable params: 25,867,520
Non-trainable params: 29,952
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 200, 8), 4: (8, 200, 8), 5: (8, 200, 8)}, inds: {3: (8, 200, 3), 4: (8, 200, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
train | step:  10000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.5740593,
           'avg_obj': 0.10051979,
           'box_loss': 6.7404594,
           'class_loss': 22.51212,
           'conf_loss': 158.92206,
           'precision50': 0.119758725,
           'recall50': 0.049052414},
     '4': {'avg_iou': 0.6492797,
           'avg_obj': 0.19694242,
           'box_loss': 5.337481,
           'class_loss': 20.327148,
           'conf_loss': 20.742485,
           'precision50': 0.1963999,
           'recall50': 0.15711765},
     '5': {'avg_iou': 0.65941066,
           'avg_obj': 0.2560589,
           'box_loss': 2.5709565,
           'class_loss': 10.254598,
           'conf_loss': 3.1802073,
           'precision50': 0.2808522,
           'recall50': 0.22948776},
     'global': {'total_loss': 250.58798},
     'learning_rate': 0.001,
     'training_loss': 250.58798}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-10000.
train | step:  20000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6315825,
           'avg_obj': 0.16565822,
           'box_loss': 5.8383374,
           'class_loss': 7.6885834,
           'conf_loss': 34.856895,
           'precision50': 0.1679995,
           'recall50': 0.10632234},
     '4': {'avg_iou': 0.72531784,
           'avg_obj': 0.3128101,
           'box_loss': 4.1806717,
           'class_loss': 5.769694,
           'conf_loss': 10.840766,
           'precision50': 0.2257341,
           'recall50': 0.30118275},
     '5': {'avg_iou': 0.7497864,
           'avg_obj': 0.39892793,
           'box_loss': 1.8907954,
           'class_loss': 2.7074828,
           'conf_loss': 1.9403082,
           'precision50': 0.3328637,
           'recall50': 0.43151984},
     'global': {'total_loss': 75.713615},
     'learning_rate': 0.001,
     'training_loss': 75.713615}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-20000.
 eval | step:  20000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=258.33s).
Accumulating evaluation results...
DONE (t=46.06s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.252
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.420
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.270
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.085
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.273
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.330
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.223
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.376
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.412
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.186
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.456
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.520
 eval | step:  20000 | eval time:  699.9 sec | output: 
    {'3': {'avg_iou': 0.48617685,
           'avg_obj': 0.17431378,
           'box_loss': 2.9630888,
           'class_loss': 3.1842775,
           'conf_loss': 27.545088,
           'precision50': 0.14025545,
           'recall50': 0.16655862},
     '4': {'avg_iou': 0.6894119,
           'avg_obj': 0.37786502,
           'box_loss': 2.4479833,
           'class_loss': 2.5027945,
           'conf_loss': 8.211833,
           'precision50': 0.18964536,
           'recall50': 0.4049239},
     '5': {'avg_iou': 0.73966575,
           'avg_obj': 0.48891938,
           'box_loss': 1.3594086,
           'class_loss': 1.3750674,
           'conf_loss': 1.6391826,
           'precision50': 0.27764413,
           'recall50': 0.54364944},
     'AP': 0.2518648,
     'AP50': 0.4197457,
     'AP75': 0.27010223,
     'APl': 0.3297875,
     'APm': 0.27291253,
     'APs': 0.08516057,
     'ARl': 0.52037734,
     'ARm': 0.45624208,
     'ARmax1': 0.22279361,
     'ARmax10': 0.37610957,
     'ARmax100': 0.41180843,
     'ARs': 0.18581505,
     'global': {'total_loss': 51.228695},
     'validation_loss': 51.228695}I0430 19:09:52.250779 140039519143744 controller.py:211] train | step:  20000 | training until step 40000...
I0430 20:18:51.586085 140039519143744 controller.py:425] train | step:  30000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.6458506,
           'avg_obj': 0.19803086,
           'box_loss': 5.629061,
           'class_loss': 6.48686,
           'conf_loss': 38.33878,
           'precision50': 0.16925427,
           'recall50': 0.14383791},
     '4': {'avg_iou': 0.74503845,
           'avg_obj': 0.35872567,
           'box_loss': 3.8862863,
           'class_loss': 4.914164,
           'conf_loss': 11.334219,
           'precision50': 0.21828309,
           'recall50': 0.36140084},
     '5': {'avg_iou': 0.77238953,
           'avg_obj': 0.4511566,
           'box_loss': 1.7203066,
           'class_loss': 2.3279004,
           'conf_loss': 1.9764807,
           'precision50': 0.31838286,
           'recall50': 0.5023485},
     'global': {'total_loss': 76.61428},
     'learning_rate': 0.001,
     'training_loss': 76.61428}
I0430 20:19:37.592341 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-30000.
I0430 21:22:56.326175 140039519143744 controller.py:425] train | step:  40000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6555258,
           'avg_obj': 0.21892078,
           'box_loss': 5.4671645,
           'class_loss': 5.8863244,
           'conf_loss': 39.23748,
           'precision50': 0.17068498,
           'recall50': 0.16644245},
     '4': {'avg_iou': 0.75663936,
           'avg_obj': 0.38734016,
           'box_loss': 3.702621,
           'class_loss': 4.4369297,
           'conf_loss': 11.52213,
           'precision50': 0.2152446,
           'recall50': 0.39807665},
     '5': {'avg_iou': 0.7855693,
           'avg_obj': 0.48136485,
           'box_loss': 1.6183506,
           'class_loss': 2.1166234,
           'conf_loss': 1.9809166,
           'precision50': 0.31092286,
           'recall50': 0.5407535},
     'global': {'total_loss': 75.968765},
     'learning_rate': 0.001,
     'training_loss': 75.968765}
I0430 21:23:42.396499 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-40000.
I0430 21:23:42.402791 140039519143744 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0430 21:27:59.028163 140039519143744 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0430 21:32:52.000103 140039519143744 controller.py:261]  eval | step:  40000 | eval time:  549.6 sec | output: 
    {'3': {'avg_iou': 0.49684858,
           'avg_obj': 0.21063791,
           'box_loss': 2.8187478,
           'class_loss': 2.478931,
           'conf_loss': 29.427715,
           'precision50': 0.13561904,
           'recall50': 0.2097761},
     '4': {'avg_iou': 0.7091116,
           'avg_obj': 0.43245196,
           'box_loss': 2.2394366,
           'class_loss': 2.00443,
           'conf_loss': 8.629781,
           'precision50': 0.18045443,
           'recall50': 0.47320396},
     '5': {'avg_iou': 0.76450354,
           'avg_obj': 0.5497036,
           'box_loss': 1.2113274,
           'class_loss': 1.1322703,
           'conf_loss': 1.6762211,
           'precision50': 0.2593799,
           'recall50': 0.61753464},
     'AP': 0.30977044,
     'AP50': 0.490931,
     'AP75': 0.33629602,
     'APl': 0.41041955,
     'APm': 0.33423644,
     'APs': 0.120128796,
     'ARl': 0.5839944,
     'ARm': 0.5102371,
     'ARmax1': 0.25602093,
     'ARmax10': 0.4279147,
     'ARmax100': 0.46649116,
     'ARs': 0.24368317,
     'global': {'total_loss': 51.618835},
     'validation_loss': 51.618835}
I0430 21:33:08.678752 140039519143744 controller.py:211] train | step:  40000 | training until step 60000...
I0430 22:32:42.428298 140039519143744 controller.py:425] train | step:  50000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.66183406,
           'avg_obj': 0.23299551,
           'box_loss': 5.371232,
           'class_loss': 5.538025,
           'conf_loss': 39.803074,
           'precision50': 0.17096157,
           'recall50': 0.18160488},
     '4': {'avg_iou': 0.7646002,
           'avg_obj': 0.40812,
           'box_loss': 3.5831218,
           'class_loss': 4.1239834,
           'conf_loss': 11.543235,
           'precision50': 0.21447884,
           'recall50': 0.42376795},
     '5': {'avg_iou': 0.79474473,
           'avg_obj': 0.50372434,
           'box_loss': 1.5483665,
           'class_loss': 1.9730818,
           'conf_loss': 1.9687562,
           'precision50': 0.30727008,
           'recall50': 0.56767976},
     'global': {'total_loss': 75.45275},
     'learning_rate': 0.001,
     'training_loss': 75.45275}
I0430 22:33:28.899222 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-50000.
I0430 23:33:44.588213 140039519143744 controller.py:425] train | step:  60000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.66676944,
           'avg_obj': 0.24492314,
           'box_loss': 5.2996783,
           'class_loss': 5.296718,
           'conf_loss': 40.097267,
           'precision50': 0.17200994,
           'recall50': 0.19541894},
     '4': {'avg_iou': 0.7708115,
           'avg_obj': 0.42432284,
           'box_loss': 3.4923847,
           'class_loss': 3.8923492,
           'conf_loss': 11.52001,
           'precision50': 0.21272288,
           'recall50': 0.44356674},
     '5': {'avg_iou': 0.80160093,
           'avg_obj': 0.52086174,
           'box_loss': 1.4983982,
           'class_loss': 1.8668485,
           'conf_loss': 1.9527781,
           'precision50': 0.30474022,
           'recall50': 0.58804935},
     'global': {'total_loss': 74.9165},
     'learning_rate': 0.001,
     'training_loss': 74.9165}
I0430 23:34:31.014863 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-60000.
I0430 23:34:31.021052 140039519143744 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0430 23:38:50.735177 140039519143744 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0430 23:43:49.613020 140039519143744 controller.py:261]  eval | step:  60000 | eval time:  558.6 sec | output: 
    {'3': {'avg_iou': 0.5033613,
           'avg_obj': 0.22620535,
           'box_loss': 2.7376158,
           'class_loss': 2.2594929,
           'conf_loss': 30.283169,
           'precision50': 0.13320427,
           'recall50': 0.22884126},
     '4': {'avg_iou': 0.7183176,
           'avg_obj': 0.45924872,
           'box_loss': 2.1507823,
           'class_loss': 1.8212783,
           'conf_loss': 8.735406,
           'precision50': 0.17616522,
           'recall50': 0.50457376},
     '5': {'avg_iou': 0.7758528,
           'avg_obj': 0.57894504,
           'box_loss': 1.1409444,
           'class_loss': 1.0397509,
           'conf_loss': 1.6849233,
           'precision50': 0.24867283,
           'recall50': 0.6460359},
     'AP': 0.3353515,
     'AP50': 0.5196792,
     'AP75': 0.3672015,
     'APl': 0.44647366,
     'APm': 0.3615444,
     'APs': 0.14067203,
     'ARl': 0.6146772,
     'ARm': 0.53121436,
     'ARmax1': 0.27292714,
     'ARmax10': 0.45127192,
     'ARmax100': 0.48978347,
     'ARs': 0.26950225,
     'global': {'total_loss': 51.85336},
     'validation_loss': 51.85336}

train | step:  20000 | training until step 40000...
train | step:  30000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.6458506,
           'avg_obj': 0.19803086,
           'box_loss': 5.629061,
           'class_loss': 6.48686,
           'conf_loss': 38.33878,
           'precision50': 0.16925427,
           'recall50': 0.14383791},
     '4': {'avg_iou': 0.74503845,
           'avg_obj': 0.35872567,
           'box_loss': 3.8862863,
           'class_loss': 4.914164,
           'conf_loss': 11.334219,
           'precision50': 0.21828309,
           'recall50': 0.36140084},
     '5': {'avg_iou': 0.77238953,
           'avg_obj': 0.4511566,
           'box_loss': 1.7203066,
           'class_loss': 2.3279004,
           'conf_loss': 1.9764807,
           'precision50': 0.31838286,
           'recall50': 0.5023485},
     'global': {'total_loss': 76.61428},
     'learning_rate': 0.001,
     'training_loss': 76.61428}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-30000.
train | step:  40000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6555258,
           'avg_obj': 0.21892078,
           'box_loss': 5.4671645,
           'class_loss': 5.8863244,
           'conf_loss': 39.23748,
           'precision50': 0.17068498,
           'recall50': 0.16644245},
     '4': {'avg_iou': 0.75663936,
           'avg_obj': 0.38734016,
           'box_loss': 3.702621,
           'class_loss': 4.4369297,
           'conf_loss': 11.52213,
           'precision50': 0.2152446,
           'recall50': 0.39807665},
     '5': {'avg_iou': 0.7855693,
           'avg_obj': 0.48136485,
           'box_loss': 1.6183506,
           'class_loss': 2.1166234,
           'conf_loss': 1.9809166,
           'precision50': 0.31092286,
           'recall50': 0.5407535},
     'global': {'total_loss': 75.968765},
     'learning_rate': 0.001,
     'training_loss': 75.968765}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-40000.
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=199.86s).
Accumulating evaluation results...
DONE (t=39.57s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.310
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.491
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.336
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.120
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.334
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.410
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.256
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.428
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.466
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.244
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.510
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.584
 eval | step:  40000 | eval time:  549.6 sec | output: 
    {'3': {'avg_iou': 0.49684858,
           'avg_obj': 0.21063791,
           'box_loss': 2.8187478,
           'class_loss': 2.478931,
           'conf_loss': 29.427715,
           'precision50': 0.13561904,
           'recall50': 0.2097761},
     '4': {'avg_iou': 0.7091116,
           'avg_obj': 0.43245196,
           'box_loss': 2.2394366,
           'class_loss': 2.00443,
           'conf_loss': 8.629781,
           'precision50': 0.18045443,
           'recall50': 0.47320396},
     '5': {'avg_iou': 0.76450354,
           'avg_obj': 0.5497036,
           'box_loss': 1.2113274,
           'class_loss': 1.1322703,
           'conf_loss': 1.6762211,
           'precision50': 0.2593799,
           'recall50': 0.61753464},
     'AP': 0.30977044,
     'AP50': 0.490931,
     'AP75': 0.33629602,
     'APl': 0.41041955,
     'APm': 0.33423644,
     'APs': 0.120128796,
     'ARl': 0.5839944,
     'ARm': 0.5102371,
     'ARmax1': 0.25602093,
     'ARmax10': 0.4279147,
     'ARmax100': 0.46649116,
     'ARs': 0.24368317,
     'global': {'total_loss': 51.618835},
     'validation_loss': 51.618835}
train | step:  40000 | training until step 60000...
train | step:  50000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.66183406,
           'avg_obj': 0.23299551,
           'box_loss': 5.371232,
           'class_loss': 5.538025,
           'conf_loss': 39.803074,
           'precision50': 0.17096157,
           'recall50': 0.18160488},
     '4': {'avg_iou': 0.7646002,
           'avg_obj': 0.40812,
           'box_loss': 3.5831218,
           'class_loss': 4.1239834,
           'conf_loss': 11.543235,
           'precision50': 0.21447884,
           'recall50': 0.42376795},
     '5': {'avg_iou': 0.79474473,
           'avg_obj': 0.50372434,
           'box_loss': 1.5483665,
           'class_loss': 1.9730818,
           'conf_loss': 1.9687562,
           'precision50': 0.30727008,
           'recall50': 0.56767976},
     'global': {'total_loss': 75.45275},
     'learning_rate': 0.001,
     'training_loss': 75.45275}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-50000.
train | step:  60000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.66676944,
           'avg_obj': 0.24492314,
           'box_loss': 5.2996783,
           'class_loss': 5.296718,
           'conf_loss': 40.097267,
           'precision50': 0.17200994,
           'recall50': 0.19541894},
     '4': {'avg_iou': 0.7708115,
           'avg_obj': 0.42432284,
           'box_loss': 3.4923847,
           'class_loss': 3.8923492,
           'conf_loss': 11.52001,
           'precision50': 0.21272288,
           'recall50': 0.44356674},
     '5': {'avg_iou': 0.80160093,
           'avg_obj': 0.52086174,
           'box_loss': 1.4983982,
           'class_loss': 1.8668485,
           'conf_loss': 1.9527781,
           'precision50': 0.30474022,
           'recall50': 0.58804935},
     'global': {'total_loss': 74.9165},
     'learning_rate': 0.001,
     'training_loss': 74.9165}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-60000.
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=201.78s).
Accumulating evaluation results...
DONE (t=39.52s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.335
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.520
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.367
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.141
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.362
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.446
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.273
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.451
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.490
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.270
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.531
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.615
 eval | step:  60000 | eval time:  558.6 sec | output: 
    {'3': {'avg_iou': 0.5033613,
           'avg_obj': 0.22620535,
           'box_loss': 2.7376158,
           'class_loss': 2.2594929,
           'conf_loss': 30.283169,
           'precision50': 0.13320427,
           'recall50': 0.22884126},
     '4': {'avg_iou': 0.7183176,
           'avg_obj': 0.45924872,
           'box_loss': 2.1507823,
           'class_loss': 1.8212783,
           'conf_loss': 8.735406,
           'precision50': 0.17616522,
           'recall50': 0.50457376},
     '5': {'avg_iou': 0.7758528,
           'avg_obj': 0.57894504,
           'box_loss': 1.1409444,
           'class_loss': 1.0397509,
           'conf_loss': 1.6849233,
           'precision50': 0.24867283,
           'recall50': 0.6460359},
     'AP': 0.3353515,
     'AP50': 0.5196792,
     'AP75': 0.3672015,
     'APl': 0.44647366,
     'APm': 0.3615444,
     'APs': 0.14067203,
     'ARl': 0.6146772,
     'ARm': 0.53121436,
     'ARmax1': 0.27292714,
     'ARmax10': 0.45127192,
     'ARmax100': 0.48978347,
     'ARs': 0.26950225,
     'global': {'total_loss': 51.85336},
     'validation_loss': 51.85336}I0430 23:44:10.780960 140039519143744 controller.py:211] train | step:  60000 | training until step 80000...
I0501 00:45:14.140683 140039519143744 controller.py:425] train | step:  70000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.67087734,
           'avg_obj': 0.25509673,
           'box_loss': 5.234861,
           'class_loss': 5.0869665,
           'conf_loss': 40.162426,
           'precision50': 0.17261027,
           'recall50': 0.20747903},
     '4': {'avg_iou': 0.7761235,
           'avg_obj': 0.43783292,
           'box_loss': 3.4148645,
           'class_loss': 3.725836,
           'conf_loss': 11.508625,
           'precision50': 0.21196672,
           'recall50': 0.46039987},
     '5': {'avg_iou': 0.8071639,
           'avg_obj': 0.53482896,
           'box_loss': 1.4579213,
           'class_loss': 1.7884791,
           'conf_loss': 1.9360036,
           'precision50': 0.30349976,
           'recall50': 0.60453016},
     'global': {'total_loss': 74.31614},
     'learning_rate': 0.001,
     'training_loss': 74.31614}
I0501 00:46:00.730671 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-70000.
I0501 01:45:13.688094 140039519143744 controller.py:425] train | step:  80000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6743422,
           'avg_obj': 0.26404974,
           'box_loss': 5.187092,
           'class_loss': 4.9084916,
           'conf_loss': 40.246563,
           'precision50': 0.17427343,
           'recall50': 0.21742891},
     '4': {'avg_iou': 0.7801393,
           'avg_obj': 0.4491848,
           'box_loss': 3.3559577,
           'class_loss': 3.5710835,
           'conf_loss': 11.446464,
           'precision50': 0.21202402,
           'recall50': 0.47417432},
     '5': {'avg_iou': 0.8115892,
           'avg_obj': 0.54627585,
           'box_loss': 1.4236257,
           'class_loss': 1.7130799,
           'conf_loss': 1.9238355,
           'precision50': 0.3006842,
           'recall50': 0.61727196},
     'global': {'total_loss': 73.776215},
     'learning_rate': 0.001,
     'training_loss': 73.776215}
I0501 01:46:01.409826 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-80000.
I0501 01:46:01.416782 140039519143744 controller.py:252]  eval | step:  80000 | running 625 steps of evaluation...
I0501 01:50:24.558028 140039519143744 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 01:55:26.162588 140039519143744 controller.py:261]  eval | step:  80000 | eval time:  564.7 sec | output: 
    {'3': {'avg_iou': 0.50696903,
           'avg_obj': 0.23645227,
           'box_loss': 2.6895,
           'class_loss': 2.1331253,
           'conf_loss': 30.62992,
           'precision50': 0.13459882,
           'recall50': 0.23991433},
     '4': {'avg_iou': 0.72311,
           'avg_obj': 0.4759101,
           'box_loss': 2.0949287,
           'class_loss': 1.737644,
           'conf_loss': 8.813527,
           'precision50': 0.17535998,
           'recall50': 0.52268064},
     '5': {'avg_iou': 0.7825753,
           'avg_obj': 0.5978063,
           'box_loss': 1.0986768,
           'class_loss': 0.9951106,
           'conf_loss': 1.6896106,
           'precision50': 0.24589474,
           'recall50': 0.66685605},
     'AP': 0.3510564,
     'AP50': 0.5361312,
     'AP75': 0.3828035,
     'APl': 0.4700445,
     'APm': 0.37485364,
     'APs': 0.15512563,
     'ARl': 0.6255657,
     'ARm': 0.54382646,
     'ARmax1': 0.28253862,
     'ARmax10': 0.4642726,
     'ARmax100': 0.50247824,
     'ARs': 0.2814343,
     'global': {'total_loss': 51.88208},
     'validation_loss': 51.88208}
I0501 01:55:48.912872 140039519143744 controller.py:211] train | step:  80000 | training until step 100000...
I0501 02:54:18.346944 140039519143744 controller.py:425] train | step:  90000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6770726,
           'avg_obj': 0.27143544,
           'box_loss': 5.1523275,
           'class_loss': 4.791866,
           'conf_loss': 40.628593,
           'precision50': 0.17261682,
           'recall50': 0.2253135},
     '4': {'avg_iou': 0.7834652,
           'avg_obj': 0.4586123,
           'box_loss': 3.3059058,
           'class_loss': 3.4696739,
           'conf_loss': 11.324521,
           'precision50': 0.21288857,
           'recall50': 0.48460972},
     '5': {'avg_iou': 0.81502986,
           'avg_obj': 0.5553195,
           'box_loss': 1.3978153,
           'class_loss': 1.6623744,
           'conf_loss': 1.9082098,
           'precision50': 0.29952148,
           'recall50': 0.62724215},
     'global': {'total_loss': 73.64151},
     'learning_rate': 0.001,
     'training_loss': 73.64151}
I0501 02:55:05.483698 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-90000.
I0501 03:54:34.017740 140039519143744 controller.py:425] train | step:  100000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6793118,
           'avg_obj': 0.27748844,
           'box_loss': 5.1100307,
           'class_loss': 4.673456,
           'conf_loss': 40.58087,
           'precision50': 0.17255425,
           'recall50': 0.23222114},
     '4': {'avg_iou': 0.7863811,
           'avg_obj': 0.4670651,
           'box_loss': 3.2610495,
           'class_loss': 3.3720133,
           'conf_loss': 11.244973,
           'precision50': 0.21375744,
           'recall50': 0.49433473},
     '5': {'avg_iou': 0.81839764,
           'avg_obj': 0.5640657,
           'box_loss': 1.3730028,
           'class_loss': 1.61958,
           'conf_loss': 1.8908062,
           'precision50': 0.2982119,
           'recall50': 0.63682276},
     'global': {'total_loss': 73.125656},
     'learning_rate': 0.001,
     'training_loss': 73.125656}
I0501 03:55:21.338703 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-100000.
I0501 03:55:21.345845 140039519143744 controller.py:252]  eval | step:  100000 | running 625 steps of evaluation...
I0501 03:59:44.537835 140039519143744 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 04:04:42.057127 140039519143744 controller.py:261]  eval | step:  100000 | eval time:  560.7 sec | output: 
    {'3': {'avg_iou': 0.5084771,
           'avg_obj': 0.24227595,
           'box_loss': 2.6606963,
           'class_loss': 2.0835752,
           'conf_loss': 31.347857,
           'precision50': 0.1317195,
           'recall50': 0.24731138},
     '4': {'avg_iou': 0.7266962,
           'avg_obj': 0.48608774,
           'box_loss': 2.0550401,
           'class_loss': 1.6850553,
           'conf_loss': 8.849499,
           'precision50': 0.17586038,
           'recall50': 0.53649694},
     '5': {'avg_iou': 0.7871309,
           'avg_obj': 0.6078863,
           'box_loss': 1.0697132,
           'class_loss': 0.9684447,
           'conf_loss': 1.6972711,
           'precision50': 0.241697,
           'recall50': 0.67740744},
     'AP': 0.35837793,
     'AP50': 0.5430322,
     'AP75': 0.39325216,
     'APl': 0.48203188,
     'APm': 0.37972695,
     'APs': 0.15785666,
     'ARl': 0.6388007,
     'ARm': 0.5499202,
     'ARmax1': 0.28779024,
     'ARmax10': 0.4722618,
     'ARmax100': 0.5114092,
     'ARs': 0.29351795,
     'global': {'total_loss': 52.417126},
     'validation_loss': 52.417126}

train | step:  60000 | training until step 80000...
train | step:  70000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.67087734,
           'avg_obj': 0.25509673,
           'box_loss': 5.234861,
           'class_loss': 5.0869665,
           'conf_loss': 40.162426,
           'precision50': 0.17261027,
           'recall50': 0.20747903},
     '4': {'avg_iou': 0.7761235,
           'avg_obj': 0.43783292,
           'box_loss': 3.4148645,
           'class_loss': 3.725836,
           'conf_loss': 11.508625,
           'precision50': 0.21196672,
           'recall50': 0.46039987},
     '5': {'avg_iou': 0.8071639,
           'avg_obj': 0.53482896,
           'box_loss': 1.4579213,
           'class_loss': 1.7884791,
           'conf_loss': 1.9360036,
           'precision50': 0.30349976,
           'recall50': 0.60453016},
     'global': {'total_loss': 74.31614},
     'learning_rate': 0.001,
     'training_loss': 74.31614}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-70000.
train | step:  80000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6743422,
           'avg_obj': 0.26404974,
           'box_loss': 5.187092,
           'class_loss': 4.9084916,
           'conf_loss': 40.246563,
           'precision50': 0.17427343,
           'recall50': 0.21742891},
     '4': {'avg_iou': 0.7801393,
           'avg_obj': 0.4491848,
           'box_loss': 3.3559577,
           'class_loss': 3.5710835,
           'conf_loss': 11.446464,
           'precision50': 0.21202402,
           'recall50': 0.47417432},
     '5': {'avg_iou': 0.8115892,
           'avg_obj': 0.54627585,
           'box_loss': 1.4236257,
           'class_loss': 1.7130799,
           'conf_loss': 1.9238355,
           'precision50': 0.3006842,
           'recall50': 0.61727196},
     'global': {'total_loss': 73.776215},
     'learning_rate': 0.001,
     'training_loss': 73.776215}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-80000.
 eval | step:  80000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=204.95s).
Accumulating evaluation results...
DONE (t=41.81s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.351
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.536
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.383
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.155
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.375
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.470
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.283
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.464
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.502
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.281
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.544
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.626
 eval | step:  80000 | eval time:  564.7 sec | output: 
    {'3': {'avg_iou': 0.50696903,
           'avg_obj': 0.23645227,
           'box_loss': 2.6895,
           'class_loss': 2.1331253,
           'conf_loss': 30.62992,
           'precision50': 0.13459882,
           'recall50': 0.23991433},
     '4': {'avg_iou': 0.72311,
           'avg_obj': 0.4759101,
           'box_loss': 2.0949287,
           'class_loss': 1.737644,
           'conf_loss': 8.813527,
           'precision50': 0.17535998,
           'recall50': 0.52268064},
     '5': {'avg_iou': 0.7825753,
           'avg_obj': 0.5978063,
           'box_loss': 1.0986768,
           'class_loss': 0.9951106,
           'conf_loss': 1.6896106,
           'precision50': 0.24589474,
           'recall50': 0.66685605},
     'AP': 0.3510564,
     'AP50': 0.5361312,
     'AP75': 0.3828035,
     'APl': 0.4700445,
     'APm': 0.37485364,
     'APs': 0.15512563,
     'ARl': 0.6255657,
     'ARm': 0.54382646,
     'ARmax1': 0.28253862,
     'ARmax10': 0.4642726,
     'ARmax100': 0.50247824,
     'ARs': 0.2814343,
     'global': {'total_loss': 51.88208},
     'validation_loss': 51.88208}
train | step:  80000 | training until step 100000...
train | step:  90000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6770726,
           'avg_obj': 0.27143544,
           'box_loss': 5.1523275,
           'class_loss': 4.791866,
           'conf_loss': 40.628593,
           'precision50': 0.17261682,
           'recall50': 0.2253135},
     '4': {'avg_iou': 0.7834652,
           'avg_obj': 0.4586123,
           'box_loss': 3.3059058,
           'class_loss': 3.4696739,
           'conf_loss': 11.324521,
           'precision50': 0.21288857,
           'recall50': 0.48460972},
     '5': {'avg_iou': 0.81502986,
           'avg_obj': 0.5553195,
           'box_loss': 1.3978153,
           'class_loss': 1.6623744,
           'conf_loss': 1.9082098,
           'precision50': 0.29952148,
           'recall50': 0.62724215},
     'global': {'total_loss': 73.64151},
     'learning_rate': 0.001,
     'training_loss': 73.64151}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-90000.
train | step:  100000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6793118,
           'avg_obj': 0.27748844,
           'box_loss': 5.1100307,
           'class_loss': 4.673456,
           'conf_loss': 40.58087,
           'precision50': 0.17255425,
           'recall50': 0.23222114},
     '4': {'avg_iou': 0.7863811,
           'avg_obj': 0.4670651,
           'box_loss': 3.2610495,
           'class_loss': 3.3720133,
           'conf_loss': 11.244973,
           'precision50': 0.21375744,
           'recall50': 0.49433473},
     '5': {'avg_iou': 0.81839764,
           'avg_obj': 0.5640657,
           'box_loss': 1.3730028,
           'class_loss': 1.61958,
           'conf_loss': 1.8908062,
           'precision50': 0.2982119,
           'recall50': 0.63682276},
     'global': {'total_loss': 73.125656},
     'learning_rate': 0.001,
     'training_loss': 73.125656}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-100000.
 eval | step:  100000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=201.18s).
Accumulating evaluation results...
DONE (t=43.05s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.358
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.543
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.393
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.158
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.380
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.482
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.288
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.472
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.511
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.294
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.550
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.639
 eval | step:  100000 | eval time:  560.7 sec | output: 
    {'3': {'avg_iou': 0.5084771,
           'avg_obj': 0.24227595,
           'box_loss': 2.6606963,
           'class_loss': 2.0835752,
           'conf_loss': 31.347857,
           'precision50': 0.1317195,
           'recall50': 0.24731138},
     '4': {'avg_iou': 0.7266962,
           'avg_obj': 0.48608774,
           'box_loss': 2.0550401,
           'class_loss': 1.6850553,
           'conf_loss': 8.849499,
           'precision50': 0.17586038,
           'recall50': 0.53649694},
     '5': {'avg_iou': 0.7871309,
           'avg_obj': 0.6078863,
           'box_loss': 1.0697132,
           'class_loss': 0.9684447,
           'conf_loss': 1.6972711,
           'precision50': 0.241697,
           'recall50': 0.67740744},
     'AP': 0.35837793,
     'AP50': 0.5430322,
     'AP75': 0.39325216,
     'APl': 0.48203188,
     'APm': 0.37972695,
     'APs': 0.15785666,
     'ARl': 0.6388007,
     'ARm': 0.5499202,
     'ARmax1': 0.28779024,
     'ARmax10': 0.4722618,
     'ARmax100': 0.5114092,
     'ARs': 0.29351795,
     'global': {'total_loss': 52.417126},
     'validation_loss': 52.417126}I0501 04:05:03.892682 140039519143744 controller.py:211] train | step:  100000 | training until step 120000...
I0501 05:03:17.651140 140039519143744 controller.py:425] train | step:  110000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.68137807,
           'avg_obj': 0.28359178,
           'box_loss': 5.0816326,
           'class_loss': 4.5767355,
           'conf_loss': 40.58819,
           'precision50': 0.17154299,
           'recall50': 0.2385263},
     '4': {'avg_iou': 0.78906906,
           'avg_obj': 0.47497398,
           'box_loss': 3.2179525,
           'class_loss': 3.2847347,
           'conf_loss': 11.164385,
           'precision50': 0.21373057,
           'recall50': 0.5031449},
     '5': {'avg_iou': 0.821204,
           'avg_obj': 0.5713163,
           'box_loss': 1.3505024,
           'class_loss': 1.5779989,
           'conf_loss': 1.8775506,
           'precision50': 0.2979383,
           'recall50': 0.64481646},
     'global': {'total_loss': 72.719574},
     'learning_rate': 0.001,
     'training_loss': 72.719574}
I0501 05:04:04.984439 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-110000.
I0501 06:02:53.973796 140039519143744 controller.py:425] train | step:  120000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6837972,
           'avg_obj': 0.28980875,
           'box_loss': 5.0343237,
           'class_loss': 4.468161,
           'conf_loss': 40.341667,
           'precision50': 0.17216763,
           'recall50': 0.24569297},
     '4': {'avg_iou': 0.7913775,
           'avg_obj': 0.48276117,
           'box_loss': 3.1805735,
           'class_loss': 3.1954944,
           'conf_loss': 11.041702,
           'precision50': 0.21455261,
           'recall50': 0.5123702},
     '5': {'avg_iou': 0.8238785,
           'avg_obj': 0.57962805,
           'box_loss': 1.3301384,
           'class_loss': 1.5282497,
           'conf_loss': 1.861215,
           'precision50': 0.2973195,
           'recall50': 0.6542661},
     'global': {'total_loss': 71.98174},
     'learning_rate': 0.001,
     'training_loss': 71.98174}
I0501 06:03:43.553608 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-120000.
I0501 06:03:43.560009 140039519143744 controller.py:252]  eval | step:  120000 | running 625 steps of evaluation...
I0501 06:08:07.831925 140039519143744 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 06:13:07.919674 140039519143744 controller.py:261]  eval | step:  120000 | eval time:  564.4 sec | output: 
    {'3': {'avg_iou': 0.5101301,
           'avg_obj': 0.24685031,
           'box_loss': 2.636318,
           'class_loss': 2.0352592,
           'conf_loss': 31.685238,
           'precision50': 0.13084511,
           'recall50': 0.2555155},
     '4': {'avg_iou': 0.7288527,
           'avg_obj': 0.49368793,
           'box_loss': 2.0361652,
           'class_loss': 1.669516,
           'conf_loss': 8.920205,
           'precision50': 0.17465818,
           'recall50': 0.543698},
     '5': {'avg_iou': 0.7900592,
           'avg_obj': 0.61610806,
           'box_loss': 1.0530705,
           'class_loss': 0.9374539,
           'conf_loss': 1.6946104,
           'precision50': 0.24051951,
           'recall50': 0.68487346},
     'AP': 0.36365205,
     'AP50': 0.54675543,
     'AP75': 0.3982425,
     'APl': 0.4861635,
     'APm': 0.38222522,
     'APs': 0.16363557,
     'ARl': 0.64361435,
     'ARm': 0.55364984,
     'ARmax1': 0.29110712,
     'ARmax10': 0.47556323,
     'ARmax100': 0.514703,
     'ARs': 0.3000394,
     'global': {'total_loss': 52.66784},
     'validation_loss': 52.66784}
I0501 06:13:24.702183 140039519143744 controller.py:211] train | step:  120000 | training until step 140000...
I0501 07:10:34.577565 140039519143744 controller.py:425] train | step:  130000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.68536013,
           'avg_obj': 0.2947726,
           'box_loss': 5.011268,
           'class_loss': 4.3768144,
           'conf_loss': 40.04689,
           'precision50': 0.17362233,
           'recall50': 0.2517514},
     '4': {'avg_iou': 0.7933764,
           'avg_obj': 0.48910218,
           'box_loss': 3.147566,
           'class_loss': 3.1240516,
           'conf_loss': 10.9122305,
           'precision50': 0.21491247,
           'recall50': 0.5192036},
     '5': {'avg_iou': 0.82599884,
           'avg_obj': 0.5853368,
           'box_loss': 1.311393,
           'class_loss': 1.4900132,
           'conf_loss': 1.8483984,
           'precision50': 0.29781,
           'recall50': 0.65949047},
     'global': {'total_loss': 71.268616},
     'learning_rate': 0.001,
     'training_loss': 71.268616}
I0501 07:11:24.630834 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-130000.
I0501 08:10:54.340190 140039519143744 controller.py:425] train | step:  140000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6869439,
           'avg_obj': 0.29982013,
           'box_loss': 4.9863334,
           'class_loss': 4.307257,
           'conf_loss': 39.95284,
           'precision50': 0.17435329,
           'recall50': 0.25691703},
     '4': {'avg_iou': 0.7951883,
           'avg_obj': 0.4952674,
           'box_loss': 3.1210024,
           'class_loss': 3.067753,
           'conf_loss': 10.870489,
           'precision50': 0.21615635,
           'recall50': 0.52657205},
     '5': {'avg_iou': 0.82810956,
           'avg_obj': 0.5912245,
           'box_loss': 1.2985786,
           'class_loss': 1.4682387,
           'conf_loss': 1.84298,
           'precision50': 0.29772198,
           'recall50': 0.66598415},
     'global': {'total_loss': 70.91529},
     'learning_rate': 0.001,
     'training_loss': 70.91529}
I0501 08:11:43.566615 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-140000.
I0501 08:11:43.573538 140039519143744 controller.py:252]  eval | step:  140000 | running 625 steps of evaluation...
I0501 08:16:09.853137 140039519143744 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 08:21:05.996693 140039519143744 controller.py:261]  eval | step:  140000 | eval time:  562.4 sec | output: 
    {'3': {'avg_iou': 0.51142913,
           'avg_obj': 0.25178957,
           'box_loss': 2.615714,
           'class_loss': 2.0236437,
           'conf_loss': 31.9729,
           'precision50': 0.12909949,
           'recall50': 0.2616143},
     '4': {'avg_iou': 0.72995573,
           'avg_obj': 0.5000951,
           'box_loss': 2.021185,
           'class_loss': 1.6879518,
           'conf_loss': 8.924995,
           'precision50': 0.17446667,
           'recall50': 0.55272603},
     '5': {'avg_iou': 0.79174596,
           'avg_obj': 0.6227541,
           'box_loss': 1.0413597,
           'class_loss': 0.93700725,
           'conf_loss': 1.704697,
           'precision50': 0.2401439,
           'recall50': 0.69136435},
     'AP': 0.36595663,
     'AP50': 0.54963326,
     'AP75': 0.39904305,
     'APl': 0.49129924,
     'APm': 0.3839092,
     'APs': 0.1626132,
     'ARl': 0.65263385,
     'ARm': 0.55345696,
     'ARmax1': 0.2938888,
     'ARmax10': 0.47996882,
     'ARmax100': 0.5193931,
     'ARs': 0.30241272,
     'global': {'total_loss': 52.92948},
     'validation_loss': 52.92948}

train | step:  100000 | training until step 120000...
train | step:  110000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.68137807,
           'avg_obj': 0.28359178,
           'box_loss': 5.0816326,
           'class_loss': 4.5767355,
           'conf_loss': 40.58819,
           'precision50': 0.17154299,
           'recall50': 0.2385263},
     '4': {'avg_iou': 0.78906906,
           'avg_obj': 0.47497398,
           'box_loss': 3.2179525,
           'class_loss': 3.2847347,
           'conf_loss': 11.164385,
           'precision50': 0.21373057,
           'recall50': 0.5031449},
     '5': {'avg_iou': 0.821204,
           'avg_obj': 0.5713163,
           'box_loss': 1.3505024,
           'class_loss': 1.5779989,
           'conf_loss': 1.8775506,
           'precision50': 0.2979383,
           'recall50': 0.64481646},
     'global': {'total_loss': 72.719574},
     'learning_rate': 0.001,
     'training_loss': 72.719574}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-110000.
train | step:  120000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6837972,
           'avg_obj': 0.28980875,
           'box_loss': 5.0343237,
           'class_loss': 4.468161,
           'conf_loss': 40.341667,
           'precision50': 0.17216763,
           'recall50': 0.24569297},
     '4': {'avg_iou': 0.7913775,
           'avg_obj': 0.48276117,
           'box_loss': 3.1805735,
           'class_loss': 3.1954944,
           'conf_loss': 11.041702,
           'precision50': 0.21455261,
           'recall50': 0.5123702},
     '5': {'avg_iou': 0.8238785,
           'avg_obj': 0.57962805,
           'box_loss': 1.3301384,
           'class_loss': 1.5282497,
           'conf_loss': 1.861215,
           'precision50': 0.2973195,
           'recall50': 0.6542661},
     'global': {'total_loss': 71.98174},
     'learning_rate': 0.001,
     'training_loss': 71.98174}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-120000.
 eval | step:  120000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=200.36s).
Accumulating evaluation results...
DONE (t=36.95s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.364
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.547
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.398
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.164
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.382
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.486
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.291
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.476
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.515
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.300
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.554
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.644
 eval | step:  120000 | eval time:  564.4 sec | output: 
    {'3': {'avg_iou': 0.5101301,
           'avg_obj': 0.24685031,
           'box_loss': 2.636318,
           'class_loss': 2.0352592,
           'conf_loss': 31.685238,
           'precision50': 0.13084511,
           'recall50': 0.2555155},
     '4': {'avg_iou': 0.7288527,
           'avg_obj': 0.49368793,
           'box_loss': 2.0361652,
           'class_loss': 1.669516,
           'conf_loss': 8.920205,
           'precision50': 0.17465818,
           'recall50': 0.543698},
     '5': {'avg_iou': 0.7900592,
           'avg_obj': 0.61610806,
           'box_loss': 1.0530705,
           'class_loss': 0.9374539,
           'conf_loss': 1.6946104,
           'precision50': 0.24051951,
           'recall50': 0.68487346},
     'AP': 0.36365205,
     'AP50': 0.54675543,
     'AP75': 0.3982425,
     'APl': 0.4861635,
     'APm': 0.38222522,
     'APs': 0.16363557,
     'ARl': 0.64361435,
     'ARm': 0.55364984,
     'ARmax1': 0.29110712,
     'ARmax10': 0.47556323,
     'ARmax100': 0.514703,
     'ARs': 0.3000394,
     'global': {'total_loss': 52.66784},
     'validation_loss': 52.66784}
train | step:  120000 | training until step 140000...
train | step:  130000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.68536013,
           'avg_obj': 0.2947726,
           'box_loss': 5.011268,
           'class_loss': 4.3768144,
           'conf_loss': 40.04689,
           'precision50': 0.17362233,
           'recall50': 0.2517514},
     '4': {'avg_iou': 0.7933764,
           'avg_obj': 0.48910218,
           'box_loss': 3.147566,
           'class_loss': 3.1240516,
           'conf_loss': 10.9122305,
           'precision50': 0.21491247,
           'recall50': 0.5192036},
     '5': {'avg_iou': 0.82599884,
           'avg_obj': 0.5853368,
           'box_loss': 1.311393,
           'class_loss': 1.4900132,
           'conf_loss': 1.8483984,
           'precision50': 0.29781,
           'recall50': 0.65949047},
     'global': {'total_loss': 71.268616},
     'learning_rate': 0.001,
     'training_loss': 71.268616}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-130000.
train | step:  140000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6869439,
           'avg_obj': 0.29982013,
           'box_loss': 4.9863334,
           'class_loss': 4.307257,
           'conf_loss': 39.95284,
           'precision50': 0.17435329,
           'recall50': 0.25691703},
     '4': {'avg_iou': 0.7951883,
           'avg_obj': 0.4952674,
           'box_loss': 3.1210024,
           'class_loss': 3.067753,
           'conf_loss': 10.870489,
           'precision50': 0.21615635,
           'recall50': 0.52657205},
     '5': {'avg_iou': 0.82810956,
           'avg_obj': 0.5912245,
           'box_loss': 1.2985786,
           'class_loss': 1.4682387,
           'conf_loss': 1.84298,
           'precision50': 0.29772198,
           'recall50': 0.66598415},
     'global': {'total_loss': 70.91529},
     'learning_rate': 0.001,
     'training_loss': 70.91529}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-140000.
 eval | step:  140000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=200.98s).
Accumulating evaluation results...
DONE (t=35.83s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.366
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.550
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.399
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.163
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.384
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.294
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.480
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.519
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.302
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.553
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.653
 eval | step:  140000 | eval time:  562.4 sec | output: 
    {'3': {'avg_iou': 0.51142913,
           'avg_obj': 0.25178957,
           'box_loss': 2.615714,
           'class_loss': 2.0236437,
           'conf_loss': 31.9729,
           'precision50': 0.12909949,
           'recall50': 0.2616143},
     '4': {'avg_iou': 0.72995573,
           'avg_obj': 0.5000951,
           'box_loss': 2.021185,
           'class_loss': 1.6879518,
           'conf_loss': 8.924995,
           'precision50': 0.17446667,
           'recall50': 0.55272603},
     '5': {'avg_iou': 0.79174596,
           'avg_obj': 0.6227541,
           'box_loss': 1.0413597,
           'class_loss': 0.93700725,
           'conf_loss': 1.704697,
           'precision50': 0.2401439,
           'recall50': 0.69136435},
     'AP': 0.36595663,
     'AP50': 0.54963326,
     'AP75': 0.39904305,
     'APl': 0.49129924,
     'APm': 0.3839092,
     'APs': 0.1626132,
     'ARl': 0.65263385,
     'ARm': 0.55345696,
     'ARmax1': 0.2938888,
     'ARmax10': 0.47996882,
     'ARmax100': 0.5193931,
     'ARs': 0.30241272,
     'global': {'total_loss': 52.92948},
     'validation_loss': 52.92948}I0501 08:21:23.133599 140039519143744 controller.py:211] train | step:  140000 | training until step 160000...
I0501 09:15:30.201713 140039519143744 controller.py:425] train | step:  150000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6883896,
           'avg_obj': 0.30459726,
           'box_loss': 4.9623375,
           'class_loss': 4.2354183,
           'conf_loss': 39.649086,
           'precision50': 0.1750259,
           'recall50': 0.26211658},
     '4': {'avg_iou': 0.79732615,
           'avg_obj': 0.5017007,
           'box_loss': 3.0887291,
           'class_loss': 3.0086398,
           'conf_loss': 10.760263,
           'precision50': 0.21669973,
           'recall50': 0.5333826},
     '5': {'avg_iou': 0.8301122,
           'avg_obj': 0.59713405,
           'box_loss': 1.2817006,
           'class_loss': 1.4367741,
           'conf_loss': 1.8254079,
           'precision50': 0.2971234,
           'recall50': 0.6718689},
     'global': {'total_loss': 70.24846},
     'learning_rate': 0.001,
     'training_loss': 70.24846}
I0501 09:16:18.754484 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-150000.
I0501 10:15:11.270624 140039519143744 controller.py:425] train | step:  160000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6897522,
           'avg_obj': 0.30922198,
           'box_loss': 4.9483795,
           'class_loss': 4.171057,
           'conf_loss': 39.4364,
           'precision50': 0.1767259,
           'recall50': 0.26724738},
     '4': {'avg_iou': 0.7989186,
           'avg_obj': 0.5069709,
           'box_loss': 3.0681117,
           'class_loss': 2.9558797,
           'conf_loss': 10.702175,
           'precision50': 0.21624748,
           'recall50': 0.5401611},
     '5': {'avg_iou': 0.8318587,
           'avg_obj': 0.60219955,
           'box_loss': 1.2692629,
           'class_loss': 1.4095337,
           'conf_loss': 1.8141035,
           'precision50': 0.29674435,
           'recall50': 0.6780994},
     'global': {'total_loss': 69.77487},
     'learning_rate': 0.001,
     'training_loss': 69.77487}
I0501 10:15:59.539084 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-160000.
I0501 10:15:59.546790 140039519143744 controller.py:252]  eval | step:  160000 | running 625 steps of evaluation...
I0501 10:20:25.368215 140039519143744 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 10:25:49.078842 140039519143744 controller.py:261]  eval | step:  160000 | eval time:  589.5 sec | output: 
    {'3': {'avg_iou': 0.5122271,
           'avg_obj': 0.2517461,
           'box_loss': 2.6077209,
           'class_loss': 2.0017655,
           'conf_loss': 31.864372,
           'precision50': 0.12975861,
           'recall50': 0.26227295},
     '4': {'avg_iou': 0.7309552,
           'avg_obj': 0.503145,
           'box_loss': 2.010452,
           'class_loss': 1.6595407,
           'conf_loss': 8.991464,
           'precision50': 0.17384738,
           'recall50': 0.5541553},
     '5': {'avg_iou': 0.79381603,
           'avg_obj': 0.6272559,
           'box_loss': 1.0268621,
           'class_loss': 0.9314665,
           'conf_loss': 1.7095617,
           'precision50': 0.23850325,
           'recall50': 0.69522893},
     'AP': 0.36924455,
     'AP50': 0.55075926,
     'AP75': 0.4040585,
     'APl': 0.49890524,
     'APm': 0.38704965,
     'APs': 0.16596867,
     'ARl': 0.6512078,
     'ARm': 0.55707383,
     'ARmax1': 0.29470795,
     'ARmax10': 0.4814583,
     'ARmax100': 0.52117324,
     'ARs': 0.30221635,
     'global': {'total_loss': 52.803207},
     'validation_loss': 52.803207}
I0501 10:26:13.755393 140039519143744 controller.py:211] train | step:  160000 | training until step 180000...
I0501 11:19:39.089022 140039519143744 controller.py:425] train | step:  170000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6912399,
           'avg_obj': 0.31351212,
           'box_loss': 4.9120436,
           'class_loss': 4.1072783,
           'conf_loss': 39.326942,
           'precision50': 0.17636453,
           'recall50': 0.27183974},
     '4': {'avg_iou': 0.80038166,
           'avg_obj': 0.51224554,
           'box_loss': 3.0401115,
           'class_loss': 2.9077113,
           'conf_loss': 10.605662,
           'precision50': 0.21739861,
           'recall50': 0.54532546},
     '5': {'avg_iou': 0.833358,
           'avg_obj': 0.6070666,
           'box_loss': 1.2558123,
           'class_loss': 1.383378,
           'conf_loss': 1.7985867,
           'precision50': 0.29691043,
           'recall50': 0.68260187},
     'global': {'total_loss': 69.3375},
     'learning_rate': 0.001,
     'training_loss': 69.3375}
I0501 11:20:29.553069 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-170000.
I0501 12:19:24.161180 140039519143744 controller.py:425] train | step:  180000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6924951,
           'avg_obj': 0.31739998,
           'box_loss': 4.906278,
           'class_loss': 4.066268,
           'conf_loss': 38.970913,
           'precision50': 0.17906973,
           'recall50': 0.2762692},
     '4': {'avg_iou': 0.801769,
           'avg_obj': 0.5169505,
           'box_loss': 3.0239327,
           'class_loss': 2.8671048,
           'conf_loss': 10.565751,
           'precision50': 0.21793298,
           'recall50': 0.55094594},
     '5': {'avg_iou': 0.8350172,
           'avg_obj': 0.61150736,
           'box_loss': 1.2438282,
           'class_loss': 1.3653324,
           'conf_loss': 1.7841167,
           'precision50': 0.29751828,
           'recall50': 0.6871066},
     'global': {'total_loss': 68.793335},
     'learning_rate': 0.001,
     'training_loss': 68.793335}
I0501 12:20:11.404106 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-180000.
I0501 12:20:11.410857 140039519143744 controller.py:252]  eval | step:  180000 | running 625 steps of evaluation...
I0501 12:24:38.202810 140039519143744 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 12:29:46.602801 140039519143744 controller.py:261]  eval | step:  180000 | eval time:  575.2 sec | output: 
    {'3': {'avg_iou': 0.5131664,
           'avg_obj': 0.25440872,
           'box_loss': 2.597881,
           'class_loss': 1.9997525,
           'conf_loss': 31.945503,
           'precision50': 0.13247335,
           'recall50': 0.2664839},
     '4': {'avg_iou': 0.7319178,
           'avg_obj': 0.5060917,
           'box_loss': 2.0030634,
           'class_loss': 1.6708922,
           'conf_loss': 9.12787,
           'precision50': 0.17299893,
           'recall50': 0.5554255},
     '5': {'avg_iou': 0.7950735,
           'avg_obj': 0.6299123,
           'box_loss': 1.0180625,
           'class_loss': 0.921458,
           'conf_loss': 1.7197092,
           'precision50': 0.23881447,
           'recall50': 0.6979108},
     'AP': 0.3697452,
     'AP50': 0.55015254,
     'AP75': 0.40532863,
     'APl': 0.50109816,
     'APm': 0.38462147,
     'APs': 0.16861495,
     'ARl': 0.6548144,
     'ARm': 0.5614209,
     'ARmax1': 0.29674202,
     'ARmax10': 0.48507163,
     'ARmax100': 0.52489835,
     'ARs': 0.30791974,
     'global': {'total_loss': 53.004192},
     'validation_loss': 53.004192}

train | step:  140000 | training until step 160000...
train | step:  150000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6883896,
           'avg_obj': 0.30459726,
           'box_loss': 4.9623375,
           'class_loss': 4.2354183,
           'conf_loss': 39.649086,
           'precision50': 0.1750259,
           'recall50': 0.26211658},
     '4': {'avg_iou': 0.79732615,
           'avg_obj': 0.5017007,
           'box_loss': 3.0887291,
           'class_loss': 3.0086398,
           'conf_loss': 10.760263,
           'precision50': 0.21669973,
           'recall50': 0.5333826},
     '5': {'avg_iou': 0.8301122,
           'avg_obj': 0.59713405,
           'box_loss': 1.2817006,
           'class_loss': 1.4367741,
           'conf_loss': 1.8254079,
           'precision50': 0.2971234,
           'recall50': 0.6718689},
     'global': {'total_loss': 70.24846},
     'learning_rate': 0.001,
     'training_loss': 70.24846}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-150000.
train | step:  160000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6897522,
           'avg_obj': 0.30922198,
           'box_loss': 4.9483795,
           'class_loss': 4.171057,
           'conf_loss': 39.4364,
           'precision50': 0.1767259,
           'recall50': 0.26724738},
     '4': {'avg_iou': 0.7989186,
           'avg_obj': 0.5069709,
           'box_loss': 3.0681117,
           'class_loss': 2.9558797,
           'conf_loss': 10.702175,
           'precision50': 0.21624748,
           'recall50': 0.5401611},
     '5': {'avg_iou': 0.8318587,
           'avg_obj': 0.60219955,
           'box_loss': 1.2692629,
           'class_loss': 1.4095337,
           'conf_loss': 1.8141035,
           'precision50': 0.29674435,
           'recall50': 0.6780994},
     'global': {'total_loss': 69.77487},
     'learning_rate': 0.001,
     'training_loss': 69.77487}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-160000.
 eval | step:  160000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=220.42s).
Accumulating evaluation results...
DONE (t=40.14s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.369
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.551
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.404
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.166
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.387
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.499
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.295
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.481
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.521
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.302
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.557
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.651
 eval | step:  160000 | eval time:  589.5 sec | output: 
    {'3': {'avg_iou': 0.5122271,
           'avg_obj': 0.2517461,
           'box_loss': 2.6077209,
           'class_loss': 2.0017655,
           'conf_loss': 31.864372,
           'precision50': 0.12975861,
           'recall50': 0.26227295},
     '4': {'avg_iou': 0.7309552,
           'avg_obj': 0.503145,
           'box_loss': 2.010452,
           'class_loss': 1.6595407,
           'conf_loss': 8.991464,
           'precision50': 0.17384738,
           'recall50': 0.5541553},
     '5': {'avg_iou': 0.79381603,
           'avg_obj': 0.6272559,
           'box_loss': 1.0268621,
           'class_loss': 0.9314665,
           'conf_loss': 1.7095617,
           'precision50': 0.23850325,
           'recall50': 0.69522893},
     'AP': 0.36924455,
     'AP50': 0.55075926,
     'AP75': 0.4040585,
     'APl': 0.49890524,
     'APm': 0.38704965,
     'APs': 0.16596867,
     'ARl': 0.6512078,
     'ARm': 0.55707383,
     'ARmax1': 0.29470795,
     'ARmax10': 0.4814583,
     'ARmax100': 0.52117324,
     'ARs': 0.30221635,
     'global': {'total_loss': 52.803207},
     'validation_loss': 52.803207}
train | step:  160000 | training until step 180000...
train | step:  170000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6912399,
           'avg_obj': 0.31351212,
           'box_loss': 4.9120436,
           'class_loss': 4.1072783,
           'conf_loss': 39.326942,
           'precision50': 0.17636453,
           'recall50': 0.27183974},
     '4': {'avg_iou': 0.80038166,
           'avg_obj': 0.51224554,
           'box_loss': 3.0401115,
           'class_loss': 2.9077113,
           'conf_loss': 10.605662,
           'precision50': 0.21739861,
           'recall50': 0.54532546},
     '5': {'avg_iou': 0.833358,
           'avg_obj': 0.6070666,
           'box_loss': 1.2558123,
           'class_loss': 1.383378,
           'conf_loss': 1.7985867,
           'precision50': 0.29691043,
           'recall50': 0.68260187},
     'global': {'total_loss': 69.3375},
     'learning_rate': 0.001,
     'training_loss': 69.3375}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-170000.
train | step:  180000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6924951,
           'avg_obj': 0.31739998,
           'box_loss': 4.906278,
           'class_loss': 4.066268,
           'conf_loss': 38.970913,
           'precision50': 0.17906973,
           'recall50': 0.2762692},
     '4': {'avg_iou': 0.801769,
           'avg_obj': 0.5169505,
           'box_loss': 3.0239327,
           'class_loss': 2.8671048,
           'conf_loss': 10.565751,
           'precision50': 0.21793298,
           'recall50': 0.55094594},
     '5': {'avg_iou': 0.8350172,
           'avg_obj': 0.61150736,
           'box_loss': 1.2438282,
           'class_loss': 1.3653324,
           'conf_loss': 1.7841167,
           'precision50': 0.29751828,
           'recall50': 0.6871066},
     'global': {'total_loss': 68.793335},
     'learning_rate': 0.001,
     'training_loss': 68.793335}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-180000.
 eval | step:  180000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=209.55s).
Accumulating evaluation results...
DONE (t=36.71s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.370
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.550
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.405
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.169
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.385
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.501
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.297
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.525
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.308
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.561
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.655
 eval | step:  180000 | eval time:  575.2 sec | output: 
    {'3': {'avg_iou': 0.5131664,
           'avg_obj': 0.25440872,
           'box_loss': 2.597881,
           'class_loss': 1.9997525,
           'conf_loss': 31.945503,
           'precision50': 0.13247335,
           'recall50': 0.2664839},
     '4': {'avg_iou': 0.7319178,
           'avg_obj': 0.5060917,
           'box_loss': 2.0030634,
           'class_loss': 1.6708922,
           'conf_loss': 9.12787,
           'precision50': 0.17299893,
           'recall50': 0.5554255},
     '5': {'avg_iou': 0.7950735,
           'avg_obj': 0.6299123,
           'box_loss': 1.0180625,
           'class_loss': 0.921458,
           'conf_loss': 1.7197092,
           'precision50': 0.23881447,
           'recall50': 0.6979108},
     'AP': 0.3697452,
     'AP50': 0.55015254,
     'AP75': 0.40532863,
     'APl': 0.50109816,
     'APm': 0.38462147,
     'APs': 0.16861495,
     'ARl': 0.6548144,
     'ARm': 0.5614209,
     'ARmax1': 0.29674202,
     'ARmax10': 0.48507163,
     'ARmax100': 0.52489835,
     'ARs': 0.30791974,
     'global': {'total_loss': 53.004192},
     'validation_loss': 53.004192}I0501 12:30:10.442024 140039519143744 controller.py:211] train | step:  180000 | training until step 200000...
I0501 13:21:00.677220 140039519143744 controller.py:425] train | step:  190000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6933374,
           'avg_obj': 0.32118008,
           'box_loss': 4.8874474,
           'class_loss': 4.010498,
           'conf_loss': 38.71594,
           'precision50': 0.17925543,
           'recall50': 0.28062716},
     '4': {'avg_iou': 0.8030382,
           'avg_obj': 0.5220091,
           'box_loss': 3.0023062,
           'class_loss': 2.8157134,
           'conf_loss': 10.482713,
           'precision50': 0.21721505,
           'recall50': 0.5564316},
     '5': {'avg_iou': 0.8363534,
           'avg_obj': 0.6155521,
           'box_loss': 1.2346057,
           'class_loss': 1.3399667,
           'conf_loss': 1.7758933,
           'precision50': 0.29723278,
           'recall50': 0.69153196},
     'global': {'total_loss': 68.2653},
     'learning_rate': 0.001,
     'training_loss': 68.2653}
I0501 13:21:49.335465 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-190000.
I0501 14:20:54.292770 140039519143744 controller.py:425] train | step:  200000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.69470376,
           'avg_obj': 0.324882,
           'box_loss': 4.8573613,
           'class_loss': 3.957817,
           'conf_loss': 38.308537,
           'precision50': 0.18171756,
           'recall50': 0.2841251},
     '4': {'avg_iou': 0.80446887,
           'avg_obj': 0.5262283,
           'box_loss': 2.9794848,
           'class_loss': 2.7806065,
           'conf_loss': 10.416385,
           'precision50': 0.2175751,
           'recall50': 0.56082726},
     '5': {'avg_iou': 0.8377591,
           'avg_obj': 0.620162,
           'box_loss': 1.2244959,
           'class_loss': 1.3192924,
           'conf_loss': 1.7663014,
           'precision50': 0.29666427,
           'recall50': 0.69601566},
     'global': {'total_loss': 67.61035},
     'learning_rate': 0.001,
     'training_loss': 67.61035}
I0501 14:21:42.329316 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-200000.
I0501 14:21:42.335295 140039519143744 controller.py:252]  eval | step:  200000 | running 625 steps of evaluation...
I0501 14:26:07.574981 140039519143744 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 14:31:11.479038 140039519143744 controller.py:261]  eval | step:  200000 | eval time:  569.1 sec | output: 
    {'3': {'avg_iou': 0.51404405,
           'avg_obj': 0.25559264,
           'box_loss': 2.5881462,
           'class_loss': 1.975068,
           'conf_loss': 31.958263,
           'precision50': 0.13201977,
           'recall50': 0.26660198},
     '4': {'avg_iou': 0.7329546,
           'avg_obj': 0.50792027,
           'box_loss': 1.9913964,
           'class_loss': 1.6572458,
           'conf_loss': 9.129054,
           'precision50': 0.17281891,
           'recall50': 0.5567919},
     '5': {'avg_iou': 0.79612666,
           'avg_obj': 0.6329109,
           'box_loss': 1.0131028,
           'class_loss': 0.91723865,
           'conf_loss': 1.7177881,
           'precision50': 0.23787493,
           'recall50': 0.6989586},
     'AP': 0.3728891,
     'AP50': 0.5538794,
     'AP75': 0.40777823,
     'APl': 0.5038056,
     'APm': 0.38895643,
     'APs': 0.17162518,
     'ARl': 0.6558733,
     'ARm': 0.5635784,
     'ARmax1': 0.29791966,
     'ARmax10': 0.48637316,
     'ARmax100': 0.52557325,
     'ARs': 0.31022853,
     'global': {'total_loss': 52.947292},
     'validation_loss': 52.947292}
I0501 14:31:33.617345 140039519143744 controller.py:211] train | step:  200000 | training until step 220000...
I0501 15:21:07.187870 140039519143744 controller.py:425] train | step:  210000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6958549,
           'avg_obj': 0.32854688,
           'box_loss': 4.8347673,
           'class_loss': 3.9091964,
           'conf_loss': 38.129322,
           'precision50': 0.18156047,
           'recall50': 0.28818882},
     '4': {'avg_iou': 0.8056823,
           'avg_obj': 0.5306816,
           'box_loss': 2.959916,
           'class_loss': 2.736926,
           'conf_loss': 10.329498,
           'precision50': 0.21831502,
           'recall50': 0.5657361},
     '5': {'avg_iou': 0.83898777,
           'avg_obj': 0.62404245,
           'box_loss': 1.2144978,
           'class_loss': 1.303075,
           'conf_loss': 1.758251,
           'precision50': 0.2959334,
           'recall50': 0.69997936},
     'global': {'total_loss': 67.17558},
     'learning_rate': 0.001,
     'training_loss': 67.17558}
I0501 15:21:54.138156 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-210000.
I0501 16:21:00.594590 140039519143744 controller.py:425] train | step:  220000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.69663054,
           'avg_obj': 0.33170983,
           'box_loss': 4.8446946,
           'class_loss': 3.8817759,
           'conf_loss': 38.194786,
           'precision50': 0.18299599,
           'recall50': 0.29293013},
     '4': {'avg_iou': 0.8067499,
           'avg_obj': 0.5342834,
           'box_loss': 2.9518309,
           'class_loss': 2.7135153,
           'conf_loss': 10.28159,
           'precision50': 0.21887536,
           'recall50': 0.57002056},
     '5': {'avg_iou': 0.84016955,
           'avg_obj': 0.62730545,
           'box_loss': 1.2070673,
           'class_loss': 1.2866673,
           'conf_loss': 1.7409362,
           'precision50': 0.29775208,
           'recall50': 0.70325047},
     'global': {'total_loss': 67.10265},
     'learning_rate': 0.001,
     'training_loss': 67.10265}
I0501 16:21:47.665469 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-220000.
I0501 16:21:47.672385 140039519143744 controller.py:252]  eval | step:  220000 | running 625 steps of evaluation...
I0501 16:26:14.697751 140039519143744 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 16:31:19.670612 140039519143744 controller.py:261]  eval | step:  220000 | eval time:  572.0 sec | output: 
    {'3': {'avg_iou': 0.5147537,
           'avg_obj': 0.2574229,
           'box_loss': 2.5810807,
           'class_loss': 1.9692202,
           'conf_loss': 31.931974,
           'precision50': 0.13235126,
           'recall50': 0.26969555},
     '4': {'avg_iou': 0.7333906,
           'avg_obj': 0.50983083,
           'box_loss': 1.9859533,
           'class_loss': 1.6739943,
           'conf_loss': 9.163926,
           'precision50': 0.17227481,
           'recall50': 0.5595699},
     '5': {'avg_iou': 0.7973107,
           'avg_obj': 0.6360857,
           'box_loss': 1.0058632,
           'class_loss': 0.9173966,
           'conf_loss': 1.7308432,
           'precision50': 0.23744453,
           'recall50': 0.70292777},
     'AP': 0.3755354,
     'AP50': 0.5565378,
     'AP75': 0.41091096,
     'APl': 0.5083495,
     'APm': 0.39139485,
     'APs': 0.1718898,
     'ARl': 0.65732574,
     'ARm': 0.5616484,
     'ARmax1': 0.30030686,
     'ARmax10': 0.48870802,
     'ARmax100': 0.5277745,
     'ARs': 0.31421724,
     'global': {'total_loss': 52.96025},
     'validation_loss': 52.96025}

train | step:  180000 | training until step 200000...
train | step:  190000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6933374,
           'avg_obj': 0.32118008,
           'box_loss': 4.8874474,
           'class_loss': 4.010498,
           'conf_loss': 38.71594,
           'precision50': 0.17925543,
           'recall50': 0.28062716},
     '4': {'avg_iou': 0.8030382,
           'avg_obj': 0.5220091,
           'box_loss': 3.0023062,
           'class_loss': 2.8157134,
           'conf_loss': 10.482713,
           'precision50': 0.21721505,
           'recall50': 0.5564316},
     '5': {'avg_iou': 0.8363534,
           'avg_obj': 0.6155521,
           'box_loss': 1.2346057,
           'class_loss': 1.3399667,
           'conf_loss': 1.7758933,
           'precision50': 0.29723278,
           'recall50': 0.69153196},
     'global': {'total_loss': 68.2653},
     'learning_rate': 0.001,
     'training_loss': 68.2653}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-190000.
train | step:  200000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.69470376,
           'avg_obj': 0.324882,
           'box_loss': 4.8573613,
           'class_loss': 3.957817,
           'conf_loss': 38.308537,
           'precision50': 0.18171756,
           'recall50': 0.2841251},
     '4': {'avg_iou': 0.80446887,
           'avg_obj': 0.5262283,
           'box_loss': 2.9794848,
           'class_loss': 2.7806065,
           'conf_loss': 10.416385,
           'precision50': 0.2175751,
           'recall50': 0.56082726},
     '5': {'avg_iou': 0.8377591,
           'avg_obj': 0.620162,
           'box_loss': 1.2244959,
           'class_loss': 1.3192924,
           'conf_loss': 1.7663014,
           'precision50': 0.29666427,
           'recall50': 0.69601566},
     'global': {'total_loss': 67.61035},
     'learning_rate': 0.001,
     'training_loss': 67.61035}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-200000.
 eval | step:  200000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=206.18s).
Accumulating evaluation results...
DONE (t=36.07s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.373
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.554
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.408
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.172
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.389
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.504
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.298
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.486
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.526
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.310
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.564
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.656
 eval | step:  200000 | eval time:  569.1 sec | output: 
    {'3': {'avg_iou': 0.51404405,
           'avg_obj': 0.25559264,
           'box_loss': 2.5881462,
           'class_loss': 1.975068,
           'conf_loss': 31.958263,
           'precision50': 0.13201977,
           'recall50': 0.26660198},
     '4': {'avg_iou': 0.7329546,
           'avg_obj': 0.50792027,
           'box_loss': 1.9913964,
           'class_loss': 1.6572458,
           'conf_loss': 9.129054,
           'precision50': 0.17281891,
           'recall50': 0.5567919},
     '5': {'avg_iou': 0.79612666,
           'avg_obj': 0.6329109,
           'box_loss': 1.0131028,
           'class_loss': 0.91723865,
           'conf_loss': 1.7177881,
           'precision50': 0.23787493,
           'recall50': 0.6989586},
     'AP': 0.3728891,
     'AP50': 0.5538794,
     'AP75': 0.40777823,
     'APl': 0.5038056,
     'APm': 0.38895643,
     'APs': 0.17162518,
     'ARl': 0.6558733,
     'ARm': 0.5635784,
     'ARmax1': 0.29791966,
     'ARmax10': 0.48637316,
     'ARmax100': 0.52557325,
     'ARs': 0.31022853,
     'global': {'total_loss': 52.947292},
     'validation_loss': 52.947292}
train | step:  200000 | training until step 220000...
train | step:  210000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6958549,
           'avg_obj': 0.32854688,
           'box_loss': 4.8347673,
           'class_loss': 3.9091964,
           'conf_loss': 38.129322,
           'precision50': 0.18156047,
           'recall50': 0.28818882},
     '4': {'avg_iou': 0.8056823,
           'avg_obj': 0.5306816,
           'box_loss': 2.959916,
           'class_loss': 2.736926,
           'conf_loss': 10.329498,
           'precision50': 0.21831502,
           'recall50': 0.5657361},
     '5': {'avg_iou': 0.83898777,
           'avg_obj': 0.62404245,
           'box_loss': 1.2144978,
           'class_loss': 1.303075,
           'conf_loss': 1.758251,
           'precision50': 0.2959334,
           'recall50': 0.69997936},
     'global': {'total_loss': 67.17558},
     'learning_rate': 0.001,
     'training_loss': 67.17558}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-210000.
train | step:  220000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.69663054,
           'avg_obj': 0.33170983,
           'box_loss': 4.8446946,
           'class_loss': 3.8817759,
           'conf_loss': 38.194786,
           'precision50': 0.18299599,
           'recall50': 0.29293013},
     '4': {'avg_iou': 0.8067499,
           'avg_obj': 0.5342834,
           'box_loss': 2.9518309,
           'class_loss': 2.7135153,
           'conf_loss': 10.28159,
           'precision50': 0.21887536,
           'recall50': 0.57002056},
     '5': {'avg_iou': 0.84016955,
           'avg_obj': 0.62730545,
           'box_loss': 1.2070673,
           'class_loss': 1.2866673,
           'conf_loss': 1.7409362,
           'precision50': 0.29775208,
           'recall50': 0.70325047},
     'global': {'total_loss': 67.10265},
     'learning_rate': 0.001,
     'training_loss': 67.10265}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-220000.
 eval | step:  220000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=208.09s).
Accumulating evaluation results...
DONE (t=35.90s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.376
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.557
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.411
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.172
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.391
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.508
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.300
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.489
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.528
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.314
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.562
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.657
 eval | step:  220000 | eval time:  572.0 sec | output: 
    {'3': {'avg_iou': 0.5147537,
           'avg_obj': 0.2574229,
           'box_loss': 2.5810807,
           'class_loss': 1.9692202,
           'conf_loss': 31.931974,
           'precision50': 0.13235126,
           'recall50': 0.26969555},
     '4': {'avg_iou': 0.7333906,
           'avg_obj': 0.50983083,
           'box_loss': 1.9859533,
           'class_loss': 1.6739943,
           'conf_loss': 9.163926,
           'precision50': 0.17227481,
           'recall50': 0.5595699},
     '5': {'avg_iou': 0.7973107,
           'avg_obj': 0.6360857,
           'box_loss': 1.0058632,
           'class_loss': 0.9173966,
           'conf_loss': 1.7308432,
           'precision50': 0.23744453,
           'recall50': 0.70292777},
     'AP': 0.3755354,
     'AP50': 0.5565378,
     'AP75': 0.41091096,
     'APl': 0.5083495,
     'APm': 0.39139485,
     'APs': 0.1718898,
     'ARl': 0.65732574,
     'ARm': 0.5616484,
     'ARmax1': 0.30030686,
     'ARmax10': 0.48870802,
     'ARmax100': 0.5277745,
     'ARs': 0.31421724,
     'global': {'total_loss': 52.96025},
     'validation_loss': 52.96025}I0501 16:31:42.141952 140039519143744 controller.py:211] train | step:  220000 | training until step 240000...
I0501 17:33:34.850509 140039519143744 controller.py:425] train | step:  230000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.69754094,
           'avg_obj': 0.33524963,
           'box_loss': 4.8232837,
           'class_loss': 3.847554,
           'conf_loss': 37.87875,
           'precision50': 0.18406963,
           'recall50': 0.2956755},
     '4': {'avg_iou': 0.8079724,
           'avg_obj': 0.53838074,
           'box_loss': 2.927696,
           'class_loss': 2.6744013,
           'conf_loss': 10.222097,
           'precision50': 0.21772082,
           'recall50': 0.5741769},
     '5': {'avg_iou': 0.84125733,
           'avg_obj': 0.6307403,
           'box_loss': 1.1966141,
           'class_loss': 1.267338,
           'conf_loss': 1.7289685,
           'precision50': 0.29679903,
           'recall50': 0.70608723},
     'global': {'total_loss': 66.56667},
     'learning_rate': 0.001,
     'training_loss': 66.56667}
I0501 17:34:21.821433 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-230000.
I0501 18:34:07.782430 140039519143744 controller.py:425] train | step:  240000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6983364,
           'avg_obj': 0.3378724,
           'box_loss': 4.8104277,
           'class_loss': 3.8036454,
           'conf_loss': 37.792656,
           'precision50': 0.18407598,
           'recall50': 0.29846805},
     '4': {'avg_iou': 0.80880034,
           'avg_obj': 0.54202664,
           'box_loss': 2.9132245,
           'class_loss': 2.6423516,
           'conf_loss': 10.162249,
           'precision50': 0.21795937,
           'recall50': 0.57842416},
     '5': {'avg_iou': 0.84230673,
           'avg_obj': 0.6347027,
           'box_loss': 1.1888655,
           'class_loss': 1.2477543,
           'conf_loss': 1.7261629,
           'precision50': 0.29472438,
           'recall50': 0.71043384},
     'global': {'total_loss': 66.287384},
     'learning_rate': 0.001,
     'training_loss': 66.287384}
I0501 18:34:58.059340 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-240000.
I0501 18:34:58.065405 140039519143744 controller.py:252]  eval | step:  240000 | running 625 steps of evaluation...
I0501 18:39:22.676719 140039519143744 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 18:44:13.886028 140039519143744 controller.py:261]  eval | step:  240000 | eval time:  555.8 sec | output: 
    {'3': {'avg_iou': 0.5149707,
           'avg_obj': 0.26048502,
           'box_loss': 2.5787055,
           'class_loss': 1.9905722,
           'conf_loss': 32.407463,
           'precision50': 0.13176394,
           'recall50': 0.27416122},
     '4': {'avg_iou': 0.733902,
           'avg_obj': 0.513678,
           'box_loss': 1.9825795,
           'class_loss': 1.6796067,
           'conf_loss': 9.251359,
           'precision50': 0.17252713,
           'recall50': 0.5664774},
     '5': {'avg_iou': 0.7983847,
           'avg_obj': 0.6376035,
           'box_loss': 0.9998683,
           'class_loss': 0.92288357,
           'conf_loss': 1.7476299,
           'precision50': 0.23647685,
           'recall50': 0.70382243},
     'AP': 0.37430185,
     'AP50': 0.55465305,
     'AP75': 0.4075634,
     'APl': 0.5085339,
     'APm': 0.39073566,
     'APs': 0.17296836,
     'ARl': 0.6552815,
     'ARm': 0.56087637,
     'ARmax1': 0.29933366,
     'ARmax10': 0.48505396,
     'ARmax100': 0.52540433,
     'ARs': 0.31440294,
     'global': {'total_loss': 53.56068},
     'validation_loss': 53.56068}
I0501 18:44:32.282889 140039519143744 controller.py:211] train | step:  240000 | training until step 260000...
I0501 19:36:58.774531 140039519143744 controller.py:425] train | step:  250000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.69914055,
           'avg_obj': 0.34136674,
           'box_loss': 4.8008304,
           'class_loss': 3.7708027,
           'conf_loss': 37.707363,
           'precision50': 0.18373114,
           'recall50': 0.30171296},
     '4': {'avg_iou': 0.80983126,
           'avg_obj': 0.5453351,
           'box_loss': 2.898487,
           'class_loss': 2.6136286,
           'conf_loss': 10.122604,
           'precision50': 0.21749651,
           'recall50': 0.5819479},
     '5': {'avg_iou': 0.8433526,
           'avg_obj': 0.63741815,
           'box_loss': 1.1800718,
           'class_loss': 1.2312355,
           'conf_loss': 1.7078958,
           'precision50': 0.296516,
           'recall50': 0.7134539},
     'global': {'total_loss': 66.0329},
     'learning_rate': 0.001,
     'training_loss': 66.0329}
I0501 19:37:49.362537 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-250000.
I0501 20:37:39.180559 140039519143744 controller.py:425] train | step:  260000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.69998664,
           'avg_obj': 0.34408846,
           'box_loss': 4.7825317,
           'class_loss': 3.7338474,
           'conf_loss': 37.6038,
           'precision50': 0.1840382,
           'recall50': 0.30538043},
     '4': {'avg_iou': 0.81084377,
           'avg_obj': 0.54896325,
           'box_loss': 2.8796742,
           'class_loss': 2.5815797,
           'conf_loss': 10.061763,
           'precision50': 0.21732508,
           'recall50': 0.5851288},
     '5': {'avg_iou': 0.84423447,
           'avg_obj': 0.6406431,
           'box_loss': 1.1722841,
           'class_loss': 1.216357,
           'conf_loss': 1.7057631,
           'precision50': 0.29529154,
           'recall50': 0.7167973},
     'global': {'total_loss': 65.737625},
     'learning_rate': 0.001,
     'training_loss': 65.737625}
I0501 20:38:28.678747 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-260000.
I0501 20:38:28.684446 140039519143744 controller.py:252]  eval | step:  260000 | running 625 steps of evaluation...
I0501 20:42:51.877381 140039519143744 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 20:47:48.642457 140039519143744 controller.py:261]  eval | step:  260000 | eval time:  560.0 sec | output: 
    {'3': {'avg_iou': 0.51523435,
           'avg_obj': 0.2595314,
           'box_loss': 2.5718741,
           'class_loss': 1.9859871,
           'conf_loss': 32.554935,
           'precision50': 0.13214608,
           'recall50': 0.2731783},
     '4': {'avg_iou': 0.73347634,
           'avg_obj': 0.51390576,
           'box_loss': 1.9868873,
           'class_loss': 1.6955829,
           'conf_loss': 9.298045,
           'precision50': 0.17166314,
           'recall50': 0.5657815},
     '5': {'avg_iou': 0.7991656,
           'avg_obj': 0.6401189,
           'box_loss': 0.99674845,
           'class_loss': 0.9184252,
           'conf_loss': 1.7469794,
           'precision50': 0.23513837,
           'recall50': 0.7063305},
     'AP': 0.37514752,
     'AP50': 0.55456877,
     'AP75': 0.40824205,
     'APl': 0.51150423,
     'APm': 0.38942608,
     'APs': 0.17100407,
     'ARl': 0.6572445,
     'ARm': 0.5569397,
     'ARmax1': 0.30064812,
     'ARmax10': 0.486224,
     'ARmax100': 0.52492654,
     'ARs': 0.31307682,
     'global': {'total_loss': 53.755417},
     'validation_loss': 53.755417}

train | step:  220000 | training until step 240000...
train | step:  230000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.69754094,
           'avg_obj': 0.33524963,
           'box_loss': 4.8232837,
           'class_loss': 3.847554,
           'conf_loss': 37.87875,
           'precision50': 0.18406963,
           'recall50': 0.2956755},
     '4': {'avg_iou': 0.8079724,
           'avg_obj': 0.53838074,
           'box_loss': 2.927696,
           'class_loss': 2.6744013,
           'conf_loss': 10.222097,
           'precision50': 0.21772082,
           'recall50': 0.5741769},
     '5': {'avg_iou': 0.84125733,
           'avg_obj': 0.6307403,
           'box_loss': 1.1966141,
           'class_loss': 1.267338,
           'conf_loss': 1.7289685,
           'precision50': 0.29679903,
           'recall50': 0.70608723},
     'global': {'total_loss': 66.56667},
     'learning_rate': 0.001,
     'training_loss': 66.56667}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-230000.
train | step:  240000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6983364,
           'avg_obj': 0.3378724,
           'box_loss': 4.8104277,
           'class_loss': 3.8036454,
           'conf_loss': 37.792656,
           'precision50': 0.18407598,
           'recall50': 0.29846805},
     '4': {'avg_iou': 0.80880034,
           'avg_obj': 0.54202664,
           'box_loss': 2.9132245,
           'class_loss': 2.6423516,
           'conf_loss': 10.162249,
           'precision50': 0.21795937,
           'recall50': 0.57842416},
     '5': {'avg_iou': 0.84230673,
           'avg_obj': 0.6347027,
           'box_loss': 1.1888655,
           'class_loss': 1.2477543,
           'conf_loss': 1.7261629,
           'precision50': 0.29472438,
           'recall50': 0.71043384},
     'global': {'total_loss': 66.287384},
     'learning_rate': 0.001,
     'training_loss': 66.287384}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-240000.
 eval | step:  240000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=198.72s).
Accumulating evaluation results...
DONE (t=34.13s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.374
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.555
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.408
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.173
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.391
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.509
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.299
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.525
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.314
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.561
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.655
 eval | step:  240000 | eval time:  555.8 sec | output: 
    {'3': {'avg_iou': 0.5149707,
           'avg_obj': 0.26048502,
           'box_loss': 2.5787055,
           'class_loss': 1.9905722,
           'conf_loss': 32.407463,
           'precision50': 0.13176394,
           'recall50': 0.27416122},
     '4': {'avg_iou': 0.733902,
           'avg_obj': 0.513678,
           'box_loss': 1.9825795,
           'class_loss': 1.6796067,
           'conf_loss': 9.251359,
           'precision50': 0.17252713,
           'recall50': 0.5664774},
     '5': {'avg_iou': 0.7983847,
           'avg_obj': 0.6376035,
           'box_loss': 0.9998683,
           'class_loss': 0.92288357,
           'conf_loss': 1.7476299,
           'precision50': 0.23647685,
           'recall50': 0.70382243},
     'AP': 0.37430185,
     'AP50': 0.55465305,
     'AP75': 0.4075634,
     'APl': 0.5085339,
     'APm': 0.39073566,
     'APs': 0.17296836,
     'ARl': 0.6552815,
     'ARm': 0.56087637,
     'ARmax1': 0.29933366,
     'ARmax10': 0.48505396,
     'ARmax100': 0.52540433,
     'ARs': 0.31440294,
     'global': {'total_loss': 53.56068},
     'validation_loss': 53.56068}
train | step:  240000 | training until step 260000...
train | step:  250000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.69914055,
           'avg_obj': 0.34136674,
           'box_loss': 4.8008304,
           'class_loss': 3.7708027,
           'conf_loss': 37.707363,
           'precision50': 0.18373114,
           'recall50': 0.30171296},
     '4': {'avg_iou': 0.80983126,
           'avg_obj': 0.5453351,
           'box_loss': 2.898487,
           'class_loss': 2.6136286,
           'conf_loss': 10.122604,
           'precision50': 0.21749651,
           'recall50': 0.5819479},
     '5': {'avg_iou': 0.8433526,
           'avg_obj': 0.63741815,
           'box_loss': 1.1800718,
           'class_loss': 1.2312355,
           'conf_loss': 1.7078958,
           'precision50': 0.296516,
           'recall50': 0.7134539},
     'global': {'total_loss': 66.0329},
     'learning_rate': 0.001,
     'training_loss': 66.0329}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-250000.
train | step:  260000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.69998664,
           'avg_obj': 0.34408846,
           'box_loss': 4.7825317,
           'class_loss': 3.7338474,
           'conf_loss': 37.6038,
           'precision50': 0.1840382,
           'recall50': 0.30538043},
     '4': {'avg_iou': 0.81084377,
           'avg_obj': 0.54896325,
           'box_loss': 2.8796742,
           'class_loss': 2.5815797,
           'conf_loss': 10.061763,
           'precision50': 0.21732508,
           'recall50': 0.5851288},
     '5': {'avg_iou': 0.84423447,
           'avg_obj': 0.6406431,
           'box_loss': 1.1722841,
           'class_loss': 1.216357,
           'conf_loss': 1.7057631,
           'precision50': 0.29529154,
           'recall50': 0.7167973},
     'global': {'total_loss': 65.737625},
     'learning_rate': 0.001,
     'training_loss': 65.737625}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-260000.
 eval | step:  260000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=200.47s).
Accumulating evaluation results...
DONE (t=34.91s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.375
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.555
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.408
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.171
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.389
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.512
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.301
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.486
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.525
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.313
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.557
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.657
 eval | step:  260000 | eval time:  560.0 sec | output: 
    {'3': {'avg_iou': 0.51523435,
           'avg_obj': 0.2595314,
           'box_loss': 2.5718741,
           'class_loss': 1.9859871,
           'conf_loss': 32.554935,
           'precision50': 0.13214608,
           'recall50': 0.2731783},
     '4': {'avg_iou': 0.73347634,
           'avg_obj': 0.51390576,
           'box_loss': 1.9868873,
           'class_loss': 1.6955829,
           'conf_loss': 9.298045,
           'precision50': 0.17166314,
           'recall50': 0.5657815},
     '5': {'avg_iou': 0.7991656,
           'avg_obj': 0.6401189,
           'box_loss': 0.99674845,
           'class_loss': 0.9184252,
           'conf_loss': 1.7469794,
           'precision50': 0.23513837,
           'recall50': 0.7063305},
     'AP': 0.37514752,
     'AP50': 0.55456877,
     'AP75': 0.40824205,
     'APl': 0.51150423,
     'APm': 0.38942608,
     'APs': 0.17100407,
     'ARl': 0.6572445,
     'ARm': 0.5569397,
     'ARmax1': 0.30064812,
     'ARmax10': 0.486224,
     'ARmax100': 0.52492654,
     'ARs': 0.31307682,
     'global': {'total_loss': 53.755417},
     'validation_loss': 53.755417}I0501 20:48:06.470582 140039519143744 controller.py:211] train | step:  260000 | training until step 280000...
I0501 21:38:33.586718 140039519143744 controller.py:425] train | step:  270000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.7005216,
           'avg_obj': 0.3467608,
           'box_loss': 4.787169,
           'class_loss': 3.7159526,
           'conf_loss': 37.631077,
           'precision50': 0.18423277,
           'recall50': 0.3081783},
     '4': {'avg_iou': 0.811687,
           'avg_obj': 0.55238205,
           'box_loss': 2.876447,
           'class_loss': 2.5588427,
           'conf_loss': 10.0280285,
           'precision50': 0.21741614,
           'recall50': 0.58915615},
     '5': {'avg_iou': 0.8450804,
           'avg_obj': 0.64354795,
           'box_loss': 1.169368,
           'class_loss': 1.2030401,
           'conf_loss': 1.6978188,
           'precision50': 0.29586607,
           'recall50': 0.7192342},
     'global': {'total_loss': 65.66767},
     'learning_rate': 0.001,
     'training_loss': 65.66767}
I0501 21:39:21.709851 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-270000.
I0501 22:38:45.739330 140039519143744 controller.py:425] train | step:  280000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.7012216,
           'avg_obj': 0.3491729,
           'box_loss': 4.7593493,
           'class_loss': 3.6758761,
           'conf_loss': 37.31342,
           'precision50': 0.18530898,
           'recall50': 0.3107252},
     '4': {'avg_iou': 0.8124741,
           'avg_obj': 0.55547494,
           'box_loss': 2.8579,
           'class_loss': 2.531499,
           'conf_loss': 9.934914,
           'precision50': 0.21793462,
           'recall50': 0.5928557},
     '5': {'avg_iou': 0.84599423,
           'avg_obj': 0.64644736,
           'box_loss': 1.1616712,
           'class_loss': 1.1901417,
           'conf_loss': 1.68737,
           'precision50': 0.2957732,
           'recall50': 0.7223578},
     'global': {'total_loss': 65.11211},
     'learning_rate': 0.001,
     'training_loss': 65.11211}
I0501 22:39:35.170434 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-280000.
I0501 22:39:35.175886 140039519143744 controller.py:252]  eval | step:  280000 | running 625 steps of evaluation...
I0501 22:43:52.929096 140039519143744 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0501 22:48:45.124516 140039519143744 controller.py:261]  eval | step:  280000 | eval time:  549.9 sec | output: 
    {'3': {'avg_iou': 0.5151201,
           'avg_obj': 0.2612994,
           'box_loss': 2.569795,
           'class_loss': 1.9973617,
           'conf_loss': 32.69475,
           'precision50': 0.13169217,
           'recall50': 0.27686635},
     '4': {'avg_iou': 0.7338736,
           'avg_obj': 0.51706326,
           'box_loss': 1.9811608,
           'class_loss': 1.6953748,
           'conf_loss': 9.30756,
           'precision50': 0.17051682,
           'recall50': 0.5704571},
     '5': {'avg_iou': 0.7994064,
           'avg_obj': 0.6431524,
           'box_loss': 0.99486583,
           'class_loss': 0.92003155,
           'conf_loss': 1.7626562,
           'precision50': 0.23504946,
           'recall50': 0.7101104},
     'AP': 0.37420538,
     'AP50': 0.5523046,
     'AP75': 0.40796217,
     'APl': 0.5088811,
     'APm': 0.38928306,
     'APs': 0.17221628,
     'ARl': 0.65965664,
     'ARm': 0.5583177,
     'ARmax1': 0.29998693,
     'ARmax10': 0.4865401,
     'ARmax100': 0.5253643,
     'ARs': 0.3155352,
     'global': {'total_loss': 53.923588},
     'validation_loss': 53.923588}
I0501 22:49:02.315105 140039519143744 controller.py:211] train | step:  280000 | training until step 300000...
I0502 00:57:22.583591 140039519143744 controller.py:425] train | step:  290000 | steps/sec:    1.2 | output: 
    {'3': {'avg_iou': 0.70182043,
           'avg_obj': 0.35203165,
           'box_loss': 4.7641606,
           'class_loss': 3.6513321,
           'conf_loss': 37.24456,
           'precision50': 0.18606362,
           'recall50': 0.31435543},
     '4': {'avg_iou': 0.81329924,
           'avg_obj': 0.55845344,
           'box_loss': 2.8477151,
           'class_loss': 2.5093706,
           'conf_loss': 9.925555,
           'precision50': 0.21807472,
           'recall50': 0.59584516},
     '5': {'avg_iou': 0.8468997,
           'avg_obj': 0.64924216,
           'box_loss': 1.1548153,
           'class_loss': 1.1777792,
           'conf_loss': 1.6812958,
           'precision50': 0.29503253,
           'recall50': 0.7246614},
     'global': {'total_loss': 64.95657},
     'learning_rate': 0.001,
     'training_loss': 64.95657}
I0502 00:58:14.987335 140039519143744 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-code-match-test4/ckpt-290000.
/home/cam2tensorflow/.experiment_start.sh: line 22: 14851 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4-$5
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   204    0     2  100   202     10   1103 --:--:-- --:--:-- --:--:--  1114
okRequest issued for: [node-2]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-02T01:11:56.526577317Z'
  endTime: '2021-05-02T01:12:50.726687795Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619917916511-5c14e87fa9dc2-a4e4a630-1b025df2
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.73.142.64/29
  createTime: '2021-03-13T00:10:24.868252445Z'
  health: HEALTHY
  ipAddress: 10.73.142.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.73.142.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-25T19:28:21.704126002Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T19:28:19Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-03-28T21:10:24.483577115Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:10:19Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T02:18:59.164603377Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T02:18:30.044758+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-30T05:32:54.575339610Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-30T05:32:31.628489+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619917916511-5c14e87fa9dc2-a4e4a630-1b025df2] to complete...
...........................................................................................................................................................................................................................................................................................................................................................................................done.
