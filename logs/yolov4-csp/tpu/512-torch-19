cat: .experiment_zone: No such file or directory
Request issued for: [node-2]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520065467-5c2c38f7f962a-39f7a9d2-f412b109] to complete...
.................................................................................................failed.
ERROR: (gcloud.compute.tpus.start) {
  "code": 8,
  "message": "There is no more capacity in the zone \"europe-west4-a\"; you can try in another zone where Cloud TPU Nodes are offered (see https://cloud.google.com/tpu/docs/regions) [EID: 0x8453b3f8b698dcdc]"
}
europe-west4-a
I0520 14:08:43.850266 140609541502784 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 14:08:43.851289 140609541502784 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/params.yaml
I0520 14:08:45.476472 140609541502784 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:08:45.619454 140609541502784 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2?alt=json
I0520 14:08:45.619890 140609541502784 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-2" is not yet ready; state: "STOPPED"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     10   1142 --:--:-- --:--:-- --:--:--  1153
okRequest issued for: [node-2]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-20T14:14:51.797420217Z'
  endTime: '2021-05-20T14:15:03.028081332Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520091782-5c2c391111c4f-b95808e0-b150d68f
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.73.142.64/29
  createTime: '2021-03-13T00:10:24.868252445Z'
  health: HEALTHY
  ipAddress: 10.73.142.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.73.142.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-25T19:28:21.704126002Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T19:28:19Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-03-28T21:10:24.483577115Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:10:19Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T02:18:59.164603377Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T02:18:30.044758+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-30T05:32:54.575339610Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-30T05:32:31.628489+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520091782-5c2c391111c4f-b95808e0-b150d68f] to complete...
.............................................................done.
cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is STOPPING
europe-west4-a
I0520 14:09:42.369289 139988356499264 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 14:09:42.370513 139988356499264 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/params.yaml
I0520 14:09:43.155512 139988356499264 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:09:43.770101 139988356499264 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:09:43.770392 139988356499264 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-4" is not yet ready; state: "STOPPING"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     12   1283 --:--:-- --:--:-- --:--:--  1296
okRequest issued for: [node-4]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520149891-5c2c39487c807-7bca6bbf-9e32d801] to complete...
...........aborted by ctrl-c.
ERROR: (gcloud.compute.tpus.stop) Aborting wait for operation https://tpu.googleapis.com/v1alpha1/projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520149891-5c2c39487c807-7bca6bbf-9e32d801.

cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is STOPPING
europe-west4-a
I0520 14:09:52.441135 140073078679360 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 14:09:52.443956 140073078679360 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/params.yaml
I0520 14:09:53.238644 140073078679360 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:09:53.382688 140073078679360 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:09:53.383243 140073078679360 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-4" is not yet ready; state: "STOPPING"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     11   1238 --:--:-- --:--:-- --:--:--  1257
okERROR: (gcloud.compute.tpus.stop) ABORTED: unable to queue the operation
- '@type': type.googleapis.com/google.rpc.ResourceInfo
  resourceName: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is STOPPING
europe-west4-a
I0520 14:10:04.674933 139844729911104 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 14:10:04.676154 139844729911104 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/params.yaml
I0520 14:10:05.500096 139844729911104 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:10:05.743585 139844729911104 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:10:05.744232 139844729911104 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-4" is not yet ready; state: "STOPPED"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     11   1195 --:--:-- --:--:-- --:--:--  1213
okRequest issued for: [node-4]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520171880-5c2c395d751ee-b11baeb4-70fad2d9] to complete...
........................................................................................................aborted by ctrl-c.
ERROR: (gcloud.compute.tpus.stop) Aborting wait for operation https://tpu.googleapis.com/v1alpha1/projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520171880-5c2c395d751ee-b11baeb4-70fad2d9.

cat: .experiment_zone: No such file or directory
Request issued for: [node-4]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-20T14:16:33.515979952Z'
  endTime: '2021-05-20T14:17:07.948677283Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520193503-5c2c397214002-f3ef462b-a84db5a0
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.117.66.216/29
  createTime: '2021-03-13T04:41:22.291533178Z'
  health: HEALTHY
  ipAddress: 10.117.66.218
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.117.66.218
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520193503-5c2c397214002-f3ef462b-a84db5a0] to complete...
.............................................................................................................................................................................................done.
europe-west4-a
I0520 14:11:09.341567 140587436492608 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 14:11:09.342884 140587436492608 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/params.yaml
I0520 14:11:10.144450 140587436492608 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:11:10.766318 140587436492608 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:11:10.766626 140587436492608 transport.py:157] Attempting refresh to obtain initial access_token
I0520 14:11:10.822657 140587436492608 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:11:11.438174 140587436492608 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:11:11.438479 140587436492608 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-20 14:11:11.495964: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0520 14:11:11.496685 140587436492608 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:11:12.114189 140587436492608 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:11:12.114478 140587436492608 transport.py:157] Attempting refresh to obtain initial access_token
I0520 14:11:12.157058 140587436492608 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:11:12.775553 140587436492608 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:11:12.775870 140587436492608 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-20 14:11:12.834095: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-20 14:11:12.848830: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.117.66.218:8470}
2021-05-20 14:11:12.848927: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:40535}
2021-05-20 14:11:51.843766: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.117.66.218:8470}
2021-05-20 14:11:51.843902: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:40535}
2021-05-20 14:11:51.844869: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:40535
I0520 14:11:51.845669 140587436492608 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-4
I0520 14:11:51.847817 140587436492608 tpu_strategy_util.py:74] Initializing the TPU system: node-4
INFO:tensorflow:Clearing out eager caches
I0520 14:12:00.337381 140587436492608 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0520 14:12:00.339523 140587436492608 tpu_strategy_util.py:133] Finished initializing TPU system.
I0520 14:12:00.341064 140587436492608 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:12:00.961863 140587436492608 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:12:00.962167 140587436492608 transport.py:157] Attempting refresh to obtain initial access_token
I0520 14:12:01.018037 140587436492608 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:12:01.156494 140587436492608 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:12:01.156770 140587436492608 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0520 14:12:01.210233 140587436492608 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0520 14:12:01.210866 140587436492608 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0520 14:12:01.211244 140587436492608 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0520 14:12:01.211374 140587436492608 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0520 14:12:01.211475 140587436492608 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0520 14:12:01.211795 140587436492608 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0520 14:12:01.211933 140587436492608 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0520 14:12:01.212020 140587436492608 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0520 14:12:01.212119 140587436492608 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0520 14:12:01.212224 140587436492608 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0520 14:12:01.212334 140587436492608 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0520 14:12:01.212438 140587436492608 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0520 14:12:01.212552 140587436492608 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0520 14:12:01.212663 140587436492608 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0520 14:12:01.212756 140587436492608 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0520 14:12:01.212844 140587436492608 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0520 14:12:01.214346 140587436492608 train_utils.py:214] Running default trainer.
2021-05-20 14:12:01.236316: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7fdca860a710>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 /home/cam2tensorflow/.experiment_start.sh: line 22: 10535 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4-$5
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     10   1130 --:--:-- --:--:-- --:--:--  1141
okRequest issued for: [node-4]
cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is STOPPING
europe-west4-a
I0520 14:12:27.942967 140418634467136 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 14:12:27.944081 140418634467136 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/params.yaml
I0520 14:12:28.795507 140418634467136 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:12:28.938195 140418634467136 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:12:28.938478 140418634467136 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-4" is not yet ready; state: "STOPPING"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     12   1283 --:--:-- --:--:-- --:--:--  1288
okRequest issued for: [node-4]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520315089-5c2c39e6083fa-b1f88749-6d86f591] to complete...
.......................................................aborted by ctrl-c.
ERROR: (gcloud.compute.tpus.stop) Aborting wait for operation https://tpu.googleapis.com/v1alpha1/projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520315089-5c2c39e6083fa-b1f88749-6d86f591.

cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is STOPPING
europe-west4-a
I0520 14:12:46.977944 139704846313280 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 14:12:46.979323 139704846313280 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/params.yaml
I0520 14:12:47.785933 139704846313280 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:12:47.929296 139704846313280 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:12:47.929841 139704846313280 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-4" is not yet ready; state: "STOPPING"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     11   1181 --:--:-- --:--:-- --:--:--  1186
okERROR: (gcloud.compute.tpus.stop) ABORTED: unable to queue the operation
- '@type': type.googleapis.com/google.rpc.ResourceInfo
  resourceName: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is STOPPING
europe-west4-a
I0520 14:13:01.154355 139708887721792 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 14:13:01.155242 139708887721792 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/params.yaml
I0520 14:13:01.949977 139708887721792 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:13:02.105254 139708887721792 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:13:02.105511 139708887721792 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-4" is not yet ready; state: "STOPPED"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     11   1149 --:--:-- --:--:-- --:--:--  1160
okRequest issued for: [node-4]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520348238-5c2c3a05a50e3-50dd0b3d-0d0b23ba] to complete...
.aborted by ctrl-c.
ERROR: (gcloud.compute.tpus.stop) Aborting wait for operation https://tpu.googleapis.com/v1alpha1/projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520348238-5c2c3a05a50e3-50dd0b3d-0d0b23ba.

cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) ABORTED: unable to queue the operation
- '@type': type.googleapis.com/google.rpc.ResourceInfo
  resourceName: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
europe-west4-a
I0520 14:13:09.229521 140642258073408 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 14:13:09.230405 140642258073408 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/params.yaml
I0520 14:13:10.009938 140642258073408 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:13:10.152823 140642258073408 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:13:10.153085 140642258073408 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-4" is not yet ready; state: "STOPPED"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     12   1308 --:--:-- --:--:-- --:--:--  1329
okRequest issued for: [node-4]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520356292-5c2c3a0d538a3-ab8ff899-12266e4e] to complete...
.......aborted by ctrl-c.
ERROR: (gcloud.compute.tpus.stop) Aborting wait for operation https://tpu.googleapis.com/v1alpha1/projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520356292-5c2c3a0d538a3-ab8ff899-12266e4e.

cat: .experiment_zone: No such file or directory
Request issued for: [node-4]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-20T14:18:25.612600663Z'
  endTime: '2021-05-20T14:19:04.543505177Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520305598-5c2c39dcfb0a0-8d5bf592-3eb60055
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.117.66.216/29
  createTime: '2021-03-13T04:41:22.291533178Z'
  health: HEALTHY
  ipAddress: 10.117.66.218
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.117.66.218
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520305598-5c2c39dcfb0a0-8d5bf592-3eb60055] to complete...
.................................................................................................................................................................................................................................................................................done.
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520359089-5c2c3a0ffe5f7-3d8a0f63-7836d94f] to complete...
.....................................................aborted by ctrl-c.
ERROR: (gcloud.compute.tpus.start) Aborting wait for operation https://tpu.googleapis.com/v1alpha1/projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520359089-5c2c3a0ffe5f7-3d8a0f63-7836d94f.

europe-west4-a
I0520 14:13:28.159332 140569758484288 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 14:13:28.160263 140569758484288 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/params.yaml
I0520 14:13:28.964697 140569758484288 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:13:29.586908 140569758484288 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:13:29.587162 140569758484288 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-4" is not yet ready; state: "STARTING"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
cat: .experiment_zone: No such file or directory
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     11   1245 --:--:-- --:--:-- --:--:--  1257
okERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is STARTING
europe-west4-a
Request issued for: [node-4]
I0520 14:13:34.409360 140513397851968 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 14:13:34.410657 140513397851968 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/params.yaml
I0520 14:13:35.250385 140513397851968 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:13:35.872426 140513397851968 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:13:35.872727 140513397851968 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-4" is not yet ready; state: "STARTING"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     11   1209 --:--:-- --:--:-- --:--:--  1213100   210    0     2  100   208     11   1209 --:--:-- --:--:-- --:--:--  1213
okERROR: (gcloud.compute.tpus.stop) ABORTED: unable to queue the operation
- '@type': type.googleapis.com/google.rpc.ResourceInfo
  resourceName: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is STARTING
europe-west4-a
I0520 14:14:02.990300 140309551671104 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 14:14:02.991734 140309551671104 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/params.yaml
I0520 14:14:03.784534 140309551671104 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:14:03.924444 140309551671104 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:14:03.924761 140309551671104 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-4" is not yet ready; state: "STOPPING"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208      6    727 --:--:-- --:--:-- --:--:--   731
okRequest issued for: [node-4]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520410204-5c2c3a40bd986-fa801662-3fcfa2bf] to complete...
.....................................................................................................................................................................................................................................aborted by ctrl-c.
ERROR: (gcloud.compute.tpus.stop) Aborting wait for operation https://tpu.googleapis.com/v1alpha1/projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520410204-5c2c3a40bd986-fa801662-3fcfa2bf.

cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is STOPPING
europe-west4-a
I0520 14:14:55.468561 139860739753792 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 14:14:55.471252 139860739753792 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/params.yaml
I0520 14:14:56.257397 139860739753792 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:14:56.400584 139860739753792 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:14:56.400899 139860739753792 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-4" is not yet ready; state: "STOPPING"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208      7    828 --:--:-- --:--:-- --:--:--   840
okERROR: (gcloud.compute.tpus.stop) ABORTED: unable to queue the operation
- '@type': type.googleapis.com/google.rpc.ResourceInfo
  resourceName: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is STOPPING
europe-west4-a
I0520 14:15:51.667121 140129419441984 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 14:15:51.668149 140129419441984 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/params.yaml
I0520 14:15:52.465845 140129419441984 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:15:52.609515 140129419441984 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:15:52.609807 140129419441984 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-4" is not yet ready; state: "STOPPING"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     13   1414 --:--:-- --:--:-- --:--:--  1428
okERROR: (gcloud.compute.tpus.stop) ABORTED: unable to queue the operation
- '@type': type.googleapis.com/google.rpc.ResourceInfo
  resourceName: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
cat: .experiment_zone: No such file or directory
Request issued for: [node-3]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520532247-5c2c3ab5213ff-f43183cf-6c684308] to complete...
................................................................................................failed.
ERROR: (gcloud.compute.tpus.start) {
  "code": 8,
  "message": "There is no more capacity in the zone \"europe-west4-a\"; you can try in another zone where Cloud TPU Nodes are offered (see https://cloud.google.com/tpu/docs/regions) [EID: 0xa1763cf8bbcb9ba1]"
}
europe-west4-a
I0520 14:16:29.917379 139661009291072 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 14:16:29.918524 139661009291072 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/params.yaml
I0520 14:16:30.717344 139661009291072 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:16:31.338364 139661009291072 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0520 14:16:31.338618 139661009291072 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-3" is not yet ready; state: "STOPPED"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     11   1181 --:--:-- --:--:-- --:--:--  1193
okRequest issued for: [node-3]
cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is STOPPING
europe-west4-a
I0520 14:16:38.888856 140028183004992 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 14:16:38.890711 140028183004992 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/params.yaml
I0520 14:16:39.695653 140028183004992 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:16:40.316385 140028183004992 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:16:40.316684 140028183004992 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-4" is not yet ready; state: "STOPPING"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     12   1283 --:--:-- --:--:-- --:--:--  1296
okERROR: (gcloud.compute.tpus.stop) ABORTED: unable to queue the operation
- '@type': type.googleapis.com/google.rpc.ResourceInfo
  resourceName: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-20T14:22:37.604106591Z'
  endTime: '2021-05-20T14:22:48.839366226Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520557587-5c2c3acd4ba5f-bb5460c9-86bdbfd5
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520557587-5c2c3acd4ba5f-bb5460c9-86bdbfd5] to complete...
...........................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-5]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520582590-5c2c3ae523ed7-1986d0c5-fb9ab5f0] to complete...
...............................................................................................................................................................................................................................................................................aborted by ctrl-c.
ERROR: (gcloud.compute.tpus.start) Aborting wait for operation https://tpu.googleapis.com/v1alpha1/projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520582590-5c2c3ae523ed7-1986d0c5-fb9ab5f0.

europe-west4-a
cat: .experiment_zone: No such file or directory
Request issued for: [node-4]
I0520 14:17:54.636711 139875257415488 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 14:17:54.637622 139875257415488 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/params.yaml
I0520 14:17:55.500171 139875257415488 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:17:56.119981 139875257415488 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0520 14:17:56.120405 139875257415488 transport.py:157] Attempting refresh to obtain initial access_token
I0520 14:17:56.174206 139875257415488 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:17:56.788234 139875257415488 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0520 14:17:56.788518 139875257415488 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-20 14:17:56.832462: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0520 14:17:56.833241 139875257415488 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:17:57.448266 139875257415488 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0520 14:17:57.448510 139875257415488 transport.py:157] Attempting refresh to obtain initial access_token
I0520 14:17:57.506373 139875257415488 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:17:57.650016 139875257415488 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0520 14:17:57.650278 139875257415488 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-20 14:17:57.701934: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-20 14:17:57.713322: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.56.217.90:8470}
2021-05-20 14:17:57.713421: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:41223}
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-20T14:19:35.836270426Z'
  endTime: '2021-05-20T14:23:18.279441229Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520375822-5c2c3a1ff39ce-86b0bc3c-5b343a08
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.117.66.216/29
  createTime: '2021-03-13T04:41:22.291533178Z'
  health: HEALTHY
  ipAddress: 10.117.66.218
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.117.66.218
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520375822-5c2c3a1ff39ce-86b0bc3c-5b343a08] to complete...
...................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................done.
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-20T14:23:58.002742611Z'
  endTime: '2021-05-20T14:24:31.998331657Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520637988-5c2c3b19f8e3c-81f14b55-60209e3d
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.117.66.216/29
  createTime: '2021-03-13T04:41:22.291533178Z'
  health: HEALTHY
  ipAddress: 10.117.66.218
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.117.66.218
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520637988-5c2c3b19f8e3c-81f14b55-60209e3d] to complete...
................................................................................................................................................................................................done.
europe-west4-a
I0520 14:18:34.671556 140256446252864 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 14:18:34.673261 140256446252864 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/params.yaml
I0520 14:18:35.508217 140256446252864 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:18:35.652127 140256446252864 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:18:35.652409 140256446252864 transport.py:157] Attempting refresh to obtain initial access_token
I0520 14:18:35.706182 140256446252864 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:18:36.323745 140256446252864 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:18:36.324215 140256446252864 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-20 14:18:36.377108: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0520 14:18:36.377791 140256446252864 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:18:36.996664 140256446252864 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:18:36.996933 140256446252864 transport.py:157] Attempting refresh to obtain initial access_token
I0520 14:18:37.054657 140256446252864 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:18:37.668395 140256446252864 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:18:37.668944 140256446252864 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-20 14:18:37.710451: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-20 14:18:37.732192: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.117.66.218:8470}
2021-05-20 14:18:37.732292: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:41349}
/home/cam2tensorflow/.experiment_start.sh: line 22: 11223 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4-$5
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     11   1202 --:--:-- --:--:-- --:--:--  1213
okRequest issued for: [node-5]
2021-05-20 14:19:12.086235: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.117.66.218:8470}
2021-05-20 14:19:12.086332: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:41349}
2021-05-20 14:19:12.087045: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:41349
I0520 14:19:12.088369 140256446252864 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-4
I0520 14:19:12.089670 140256446252864 tpu_strategy_util.py:74] Initializing the TPU system: node-4
INFO:tensorflow:Clearing out eager caches
I0520 14:19:20.270349 140256446252864 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0520 14:19:20.272792 140256446252864 tpu_strategy_util.py:133] Finished initializing TPU system.
I0520 14:19:20.274548 140256446252864 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:19:20.599057 140256446252864 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:19:20.599575 140256446252864 transport.py:157] Attempting refresh to obtain initial access_token
I0520 14:19:20.664481 140256446252864 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 14:19:20.806746 140256446252864 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0520 14:19:20.807042 140256446252864 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0520 14:19:20.856065 140256446252864 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0520 14:19:20.856348 140256446252864 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0520 14:19:20.856724 140256446252864 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0520 14:19:20.856901 140256446252864 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0520 14:19:20.857008 140256446252864 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0520 14:19:20.857244 140256446252864 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0520 14:19:20.857360 140256446252864 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0520 14:19:20.857455 140256446252864 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0520 14:19:20.857548 140256446252864 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0520 14:19:20.857637 140256446252864 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0520 14:19:20.857745 140256446252864 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0520 14:19:20.857848 140256446252864 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0520 14:19:20.857943 140256446252864 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0520 14:19:20.858042 140256446252864 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0520 14:19:20.858137 140256446252864 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0520 14:19:20.858255 140256446252864 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0520 14:19:20.859819 140256446252864 train_utils.py:214] Running default trainer.
2021-05-20 14:19:20.880309: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-20T14:25:01.667144453Z'
  endTime: '2021-05-20T14:25:24.412605950Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520701648-5c2c3b56af008-0a822679-295a4c2b
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621520701648-5c2c3b56af008-0a822679-295a4c2b] to complete...
....................................................................................................................................done.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f8f98543240>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________
yolo_fpn (YoloFPN)              {'5': (None, 16, 16, 9626112     input_2[0][0]                    
                                                                 input_3[0][0]                    I0520 14:20:09.736100 140256446252864 controller.py:362] restoring or initializing model...
I0520 14:20:18.908045 140256446252864 yolo.py:542] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0520 14:20:18.911083 140256446252864 controller.py:368] initialized model.
I0520 14:20:18.911325 140256446252864 train_lib.py:96] Starts to execute mode: train_and_eval
I0520 14:20:18.915881 140256446252864 controller.py:211] train | step:      0 | training until step 20000...
I0520 14:20:26.646070 140256446252864 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0520 14:21:17.078658 140256446252864 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0520 16:10:19.373478 140256446252864 controller.py:425] train | step:  10000 | steps/sec:    1.5 | output: 
    {'3': {'avg_iou': 0.4156914,
           'avg_obj': 0.0581194,
           'box_loss': 0.02409312,
           'class_loss': 0.057154913,
           'conf_loss': 0.18053508,
           'precision50': 0.039496314,
           'recall50': 0.01821211},
     '4': {'avg_iou': 0.48956114,
           'avg_obj': 0.10900611,
           'box_loss': 0.023908095,
           'class_loss': 0.059144977,
           'conf_loss': 0.079004504,
           'precision50': 0.13644718,
           'recall50': 0.04334804},
     '5': {'avg_iou': 0.5294323,
           'avg_obj': 0.16259503,
           'box_loss': 0.022926677,
           'class_loss': 0.055357765,
           'conf_loss': 0.040002156,
           'precision50': 0.23016712,
           'recall50': 0.064641744},
     'global': {'total_loss': 4.3370166},
     'learning_rate': 0.009985589,
     'training_loss': 4.3370166}
I0520 16:11:12.331770 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-10000.
I0520 17:50:29.681330 140256446252864 controller.py:425] train | step:  20000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.48126933,
           'avg_obj': 0.044715855,
           'box_loss': 0.020989688,
           'class_loss': 0.016735634,
           'conf_loss': 0.03537368,
           'precision50': 0.057395227,
           'recall50': 0.004545201},
     '4': {'avg_iou': 0.58014315,
           'avg_obj': 0.10870417,
           'box_loss': 0.01939265,
           'class_loss': 0.016896077,
           'conf_loss': 0.03237779,
           'precision50': 0.22796512,
           'recall50': 0.03126801},
     '5': {'avg_iou': 0.6495087,
           'avg_obj': 0.2109305,
           'box_loss': 0.016832676,
           'class_loss': 0.014960715,
           'conf_loss': 0.021904089,
           'precision50': 0.4530274,
           'recall50': 0.116862744},
     'global': {'total_loss': 1.5637053},
     'learning_rate': 0.009942464,
     'training_loss': 1.5637053}
I0520 17:51:21.677354 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-20000.
I0520 17:51:21.683396 140256446252864 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0520 17:51:22.334061 140256446252864 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0520 17:51:42.307479 140256446252864 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0520 17:56:29.940676 140256446252864 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0520 18:00:35.611778 140256446252864 controller.py:261]  eval | step:  20000 | eval time:  553.9 sec | output: 
    {'3': {'avg_iou': 0.38872135,
           'avg_obj': 0.02825307,
           'box_loss': 0.014894794,
           'class_loss': 0.011867685,
           'conf_loss': 0.023014074,
           'precision50': 0.046368167,
           'recall50': 0.004909544},
     '4': {'avg_iou': 0.5682632,
           'avg_obj': 0.090744354,
           'box_loss': 0.01625784,
           'class_loss': 0.013568686,
           'conf_loss': 0.021763522,
           'precision50': 0.16385472,
           'recall50': 0.03827903},
     '5': {'avg_iou': 0.6581544,
           'avg_obj': 0.20586126,
           'box_loss': 0.014498629,
           'class_loss': 0.011614638,
           'conf_loss': 0.017205741,
           'precision50': 0.3531178,
           'recall50': 0.12994435},
     'AP': 0.071379334,
     'AP50': 0.13310069,
     'AP75': 0.06825999,
     'APl': 0.11656289,
     'APm': 0.05557303,
     'APs': 0.00833078,
     'ARl': 0.38630047,
     'ARm': 0.2213679,
     'ARmax1': 0.1266237,
     'ARmax10': 0.22221774,
     'ARmax100': 0.23888035,
     'ARs': 0.04969067,
     'global': {'total_loss': 0.14468561},
     'validation_loss': 0.14468561}

                                                                 input_4[0][0]                    
__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'3': (None, 64, 64, 16271360    yolo_fpn[0][0]                   
                                                                 yolo_fpn[0][1]                   
                                                                 yolo_fpn[0][2]                   
==================================================================================================
Total params: 25,897,472
Trainable params: 25,867,520
Non-trainable params: 29,952
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 400, 8), 5: (8, 200, 8)}, inds: {3: (8, 600, 3), 4: (8, 400, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
train | step:  10000 | steps/sec:    1.5 | output: 
    {'3': {'avg_iou': 0.4156914,
           'avg_obj': 0.0581194,
           'box_loss': 0.02409312,
           'class_loss': 0.057154913,
           'conf_loss': 0.18053508,
           'precision50': 0.039496314,
           'recall50': 0.01821211},
     '4': {'avg_iou': 0.48956114,
           'avg_obj': 0.10900611,
           'box_loss': 0.023908095,
           'class_loss': 0.059144977,
           'conf_loss': 0.079004504,
           'precision50': 0.13644718,
           'recall50': 0.04334804},
     '5': {'avg_iou': 0.5294323,
           'avg_obj': 0.16259503,
           'box_loss': 0.022926677,
           'class_loss': 0.055357765,
           'conf_loss': 0.040002156,
           'precision50': 0.23016712,
           'recall50': 0.064641744},
     'global': {'total_loss': 4.3370166},
     'learning_rate': 0.009985589,
     'training_loss': 4.3370166}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-10000.
train | step:  20000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.48126933,
           'avg_obj': 0.044715855,
           'box_loss': 0.020989688,
           'class_loss': 0.016735634,
           'conf_loss': 0.03537368,
           'precision50': 0.057395227,
           'recall50': 0.004545201},
     '4': {'avg_iou': 0.58014315,
           'avg_obj': 0.10870417,
           'box_loss': 0.01939265,
           'class_loss': 0.016896077,
           'conf_loss': 0.03237779,
           'precision50': 0.22796512,
           'recall50': 0.03126801},
     '5': {'avg_iou': 0.6495087,
           'avg_obj': 0.2109305,
           'box_loss': 0.016832676,
           'class_loss': 0.014960715,
           'conf_loss': 0.021904089,
           'precision50': 0.4530274,
           'recall50': 0.116862744},
     'global': {'total_loss': 1.5637053},
     'learning_rate': 0.009942464,
     'training_loss': 1.5637053}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-20000.
 eval | step:  20000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=162.48s).
Accumulating evaluation results...
DONE (t=25.87s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.071
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.133
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.068
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.008
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.056
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.117
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.127
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.222
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.239
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.221
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.386
 eval | step:  20000 | eval time:  553.9 sec | output: 
    {'3': {'avg_iou': 0.38872135,
           'avg_obj': 0.02825307,
           'box_loss': 0.014894794,
           'class_loss': 0.011867685,
           'conf_loss': 0.023014074,
           'precision50': 0.046368167,
           'recall50': 0.004909544},
     '4': {'avg_iou': 0.5682632,
           'avg_obj': 0.090744354,
           'box_loss': 0.01625784,
           'class_loss': 0.013568686,
           'conf_loss': 0.021763522,
           'precision50': 0.16385472,
           'recall50': 0.03827903},
     '5': {'avg_iou': 0.6581544,
           'avg_obj': 0.20586126,
           'box_loss': 0.014498629,
           'class_loss': 0.011614638,
           'conf_loss': 0.017205741,
           'precision50': 0.3531178,
           'recall50': 0.12994435},
     'AP': 0.071379334,
     'AP50': 0.13310069,
     'AP75': 0.06825999,
     'APl': 0.11656289,
     'APm': 0.05557303,
     'APs': 0.00833078,
     'ARl': 0.38630047,
     'ARm': 0.2213679,
     'ARmax1': 0.1266237,
     'ARmax10': 0.22221774,
     'ARmax100': 0.23888035,
     'ARs': 0.04969067,
     'global': {'total_loss': 0.14468561},
     'validation_loss': 0.14468561}I0520 18:00:59.228312 140256446252864 controller.py:211] train | step:  20000 | training until step 40000...
I0520 19:37:42.279865 140256446252864 controller.py:425] train | step:  30000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.50931007,
           'avg_obj': 0.06776867,
           'box_loss': 0.01976482,
           'class_loss': 0.014523981,
           'conf_loss': 0.034215126,
           'precision50': 0.12878346,
           'recall50': 0.011820018},
     '4': {'avg_iou': 0.6176784,
           'avg_obj': 0.15376502,
           'box_loss': 0.017540481,
           'class_loss': 0.014130241,
           'conf_loss': 0.031002637,
           'precision50': 0.38141847,
           'recall50': 0.06858959},
     '5': {'avg_iou': 0.68808144,
           'avg_obj': 0.2731498,
           'box_loss': 0.014846538,
           'class_loss': 0.012293854,
           'conf_loss': 0.020627618,
           'precision50': 0.5870295,
           'recall50': 0.20931675},
     'global': {'total_loss': 1.4315585},
     'learning_rate': 0.0098709315,
     'training_loss': 1.4315585}
I0520 19:38:31.713286 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-30000.
I0520 21:14:35.516834 140256446252864 controller.py:425] train | step:  40000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.52798325,
           'avg_obj': 0.08658636,
           'box_loss': 0.018986242,
           'class_loss': 0.0131501835,
           'conf_loss': 0.03332311,
           'precision50': 0.1905529,
           'recall50': 0.020406963},
     '4': {'avg_iou': 0.6416597,
           'avg_obj': 0.18596558,
           'box_loss': 0.016365083,
           'class_loss': 0.012472713,
           'conf_loss': 0.030036315,
           'precision50': 0.46214956,
           'recall50': 0.101836555},
     '5': {'avg_iou': 0.7108466,
           'avg_obj': 0.31235337,
           'box_loss': 0.013673543,
           'class_loss': 0.010759289,
           'conf_loss': 0.019785864,
           'precision50': 0.6440477,
           'recall50': 0.27104893},
     'global': {'total_loss': 1.348419},
     'learning_rate': 0.00977151,
     'training_loss': 1.348419}
I0520 21:15:24.348196 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-40000.
I0520 21:15:24.354873 140256446252864 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0520 21:19:24.456770 140256446252864 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0520 21:23:17.935686 140256446252864 controller.py:261]  eval | step:  40000 | eval time:  473.6 sec | output: 
    {'3': {'avg_iou': 0.41730693,
           'avg_obj': 0.057804536,
           'box_loss': 0.013454213,
           'class_loss': 0.008899657,
           'conf_loss': 0.02141705,
           'precision50': 0.12784415,
           'recall50': 0.022137165},
     '4': {'avg_iou': 0.61574817,
           'avg_obj': 0.15710223,
           'box_loss': 0.013860358,
           'class_loss': 0.009590459,
           'conf_loss': 0.020082638,
           'precision50': 0.3248527,
           'recall50': 0.10118024},
     '5': {'avg_iou': 0.7109799,
           'avg_obj': 0.30718395,
           'box_loss': 0.011826237,
           'class_loss': 0.008058073,
           'conf_loss': 0.015576436,
           'precision50': 0.5728084,
           'recall50': 0.2693223},
     'AP': 0.14728071,
     'AP50': 0.2541848,
     'AP75': 0.14954588,
     'APl': 0.2340166,
     'APm': 0.12898147,
     'APs': 0.025129385,
     'ARl': 0.50720364,
     'ARm': 0.35534555,
     'ARmax1': 0.18503198,
     'ARmax10': 0.31856593,
     'ARmax100': 0.34570777,
     'ARs': 0.11544345,
     'global': {'total_loss': 0.122765064},
     'validation_loss': 0.122765064}
I0520 21:23:34.899352 140256446252864 controller.py:211] train | step:  40000 | training until step 60000...
I0520 23:00:05.774924 140256446252864 controller.py:425] train | step:  50000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.54159045,
           'avg_obj': 0.101619095,
           'box_loss': 0.018393686,
           'class_loss': 0.0121793095,
           'conf_loss': 0.032606497,
           'precision50': 0.23748164,
           'recall50': 0.028893033},
     '4': {'avg_iou': 0.6589351,
           'avg_obj': 0.21058105,
           'box_loss': 0.015529386,
           'class_loss': 0.011340627,
           'conf_loss': 0.029292965,
           'precision50': 0.5114704,
           'recall50': 0.1301507},
     '5': {'avg_iou': 0.7264762,
           'avg_obj': 0.34055096,
           'box_loss': 0.012870372,
           'class_loss': 0.009717798,
           'conf_loss': 0.019181568,
           'precision50': 0.6762969,
           'recall50': 0.31484938},
     'global': {'total_loss': 1.2888981},
     'learning_rate': 0.0096449135,
     'training_loss': 1.2888981}
I0520 23:01:00.251041 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-50000.
I0521 00:38:17.137095 140256446252864 controller.py:425] train | step:  60000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5520005,
           'avg_obj': 0.11375986,
           'box_loss': 0.01796203,
           'class_loss': 0.011471223,
           'conf_loss': 0.03212359,
           'precision50': 0.27313477,
           'recall50': 0.036552023},
     '4': {'avg_iou': 0.67137784,
           'avg_obj': 0.23013613,
           'box_loss': 0.014913585,
           'class_loss': 0.010526946,
           'conf_loss': 0.028672855,
           'precision50': 0.54693127,
           'recall50': 0.15430637},
     '5': {'avg_iou': 0.7382036,
           'avg_obj': 0.3621127,
           'box_loss': 0.012281943,
           'class_loss': 0.008983591,
           'conf_loss': 0.018703448,
           'precision50': 0.69830173,
           'recall50': 0.34827882},
     'global': {'total_loss': 1.245114},
     'learning_rate': 0.009492056,
     'training_loss': 1.245114}
I0521 00:39:04.743278 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-60000.
I0521 00:39:04.749611 140256446252864 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0521 00:43:09.981239 140256446252864 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0521 00:47:09.730282 140256446252864 controller.py:261]  eval | step:  60000 | eval time:  485.0 sec | output: 
    {'3': {'avg_iou': 0.43420976,
           'avg_obj': 0.082631566,
           'box_loss': 0.012596656,
           'class_loss': 0.0074048117,
           'conf_loss': 0.020426808,
           'precision50': 0.18619147,
           'recall50': 0.04037272},
     '4': {'avg_iou': 0.6432359,
           'avg_obj': 0.20825244,
           'box_loss': 0.012469724,
           'class_loss': 0.0076328665,
           'conf_loss': 0.018989433,
           'precision50': 0.42415702,
           'recall50': 0.15898241},
     '5': {'avg_iou': 0.73522806,
           'avg_obj': 0.36511928,
           'box_loss': 0.010594438,
           'class_loss': 0.0064548934,
           'conf_loss': 0.0145569565,
           'precision50': 0.6499765,
           'recall50': 0.3541312},
     'AP': 0.20120645,
     'AP50': 0.33381137,
     'AP75': 0.21013671,
     'APl': 0.3103383,
     'APm': 0.19084324,
     'APs': 0.041004274,
     'ARl': 0.57018316,
     'ARm': 0.42142332,
     'ARmax1': 0.22087969,
     'ARmax10': 0.36835137,
     'ARmax100': 0.40190515,
     'ARs': 0.1581747,
     'global': {'total_loss': 0.11112653},
     'validation_loss': 0.11112653}

train | step:  20000 | training until step 40000...
train | step:  30000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.50931007,
           'avg_obj': 0.06776867,
           'box_loss': 0.01976482,
           'class_loss': 0.014523981,
           'conf_loss': 0.034215126,
           'precision50': 0.12878346,
           'recall50': 0.011820018},
     '4': {'avg_iou': 0.6176784,
           'avg_obj': 0.15376502,
           'box_loss': 0.017540481,
           'class_loss': 0.014130241,
           'conf_loss': 0.031002637,
           'precision50': 0.38141847,
           'recall50': 0.06858959},
     '5': {'avg_iou': 0.68808144,
           'avg_obj': 0.2731498,
           'box_loss': 0.014846538,
           'class_loss': 0.012293854,
           'conf_loss': 0.020627618,
           'precision50': 0.5870295,
           'recall50': 0.20931675},
     'global': {'total_loss': 1.4315585},
     'learning_rate': 0.0098709315,
     'training_loss': 1.4315585}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-30000.
train | step:  40000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.52798325,
           'avg_obj': 0.08658636,
           'box_loss': 0.018986242,
           'class_loss': 0.0131501835,
           'conf_loss': 0.03332311,
           'precision50': 0.1905529,
           'recall50': 0.020406963},
     '4': {'avg_iou': 0.6416597,
           'avg_obj': 0.18596558,
           'box_loss': 0.016365083,
           'class_loss': 0.012472713,
           'conf_loss': 0.030036315,
           'precision50': 0.46214956,
           'recall50': 0.101836555},
     '5': {'avg_iou': 0.7108466,
           'avg_obj': 0.31235337,
           'box_loss': 0.013673543,
           'class_loss': 0.010759289,
           'conf_loss': 0.019785864,
           'precision50': 0.6440477,
           'recall50': 0.27104893},
     'global': {'total_loss': 1.348419},
     'learning_rate': 0.00977151,
     'training_loss': 1.348419}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-40000.
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=161.26s).
Accumulating evaluation results...
DONE (t=23.15s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.147
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.254
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.150
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.025
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.129
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.234
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.185
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.319
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.346
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.115
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.355
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.507
 eval | step:  40000 | eval time:  473.6 sec | output: 
    {'3': {'avg_iou': 0.41730693,
           'avg_obj': 0.057804536,
           'box_loss': 0.013454213,
           'class_loss': 0.008899657,
           'conf_loss': 0.02141705,
           'precision50': 0.12784415,
           'recall50': 0.022137165},
     '4': {'avg_iou': 0.61574817,
           'avg_obj': 0.15710223,
           'box_loss': 0.013860358,
           'class_loss': 0.009590459,
           'conf_loss': 0.020082638,
           'precision50': 0.3248527,
           'recall50': 0.10118024},
     '5': {'avg_iou': 0.7109799,
           'avg_obj': 0.30718395,
           'box_loss': 0.011826237,
           'class_loss': 0.008058073,
           'conf_loss': 0.015576436,
           'precision50': 0.5728084,
           'recall50': 0.2693223},
     'AP': 0.14728071,
     'AP50': 0.2541848,
     'AP75': 0.14954588,
     'APl': 0.2340166,
     'APm': 0.12898147,
     'APs': 0.025129385,
     'ARl': 0.50720364,
     'ARm': 0.35534555,
     'ARmax1': 0.18503198,
     'ARmax10': 0.31856593,
     'ARmax100': 0.34570777,
     'ARs': 0.11544345,
     'global': {'total_loss': 0.122765064},
     'validation_loss': 0.122765064}
train | step:  40000 | training until step 60000...
train | step:  50000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.54159045,
           'avg_obj': 0.101619095,
           'box_loss': 0.018393686,
           'class_loss': 0.0121793095,
           'conf_loss': 0.032606497,
           'precision50': 0.23748164,
           'recall50': 0.028893033},
     '4': {'avg_iou': 0.6589351,
           'avg_obj': 0.21058105,
           'box_loss': 0.015529386,
           'class_loss': 0.011340627,
           'conf_loss': 0.029292965,
           'precision50': 0.5114704,
           'recall50': 0.1301507},
     '5': {'avg_iou': 0.7264762,
           'avg_obj': 0.34055096,
           'box_loss': 0.012870372,
           'class_loss': 0.009717798,
           'conf_loss': 0.019181568,
           'precision50': 0.6762969,
           'recall50': 0.31484938},
     'global': {'total_loss': 1.2888981},
     'learning_rate': 0.0096449135,
     'training_loss': 1.2888981}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-50000.
train | step:  60000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5520005,
           'avg_obj': 0.11375986,
           'box_loss': 0.01796203,
           'class_loss': 0.011471223,
           'conf_loss': 0.03212359,
           'precision50': 0.27313477,
           'recall50': 0.036552023},
     '4': {'avg_iou': 0.67137784,
           'avg_obj': 0.23013613,
           'box_loss': 0.014913585,
           'class_loss': 0.010526946,
           'conf_loss': 0.028672855,
           'precision50': 0.54693127,
           'recall50': 0.15430637},
     '5': {'avg_iou': 0.7382036,
           'avg_obj': 0.3621127,
           'box_loss': 0.012281943,
           'class_loss': 0.008983591,
           'conf_loss': 0.018703448,
           'precision50': 0.69830173,
           'recall50': 0.34827882},
     'global': {'total_loss': 1.245114},
     'learning_rate': 0.009492056,
     'training_loss': 1.245114}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-60000.
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=163.96s).
Accumulating evaluation results...
DONE (t=21.45s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.201
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.334
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.210
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.041
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.191
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.310
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.221
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.368
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.402
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.158
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.421
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.570
 eval | step:  60000 | eval time:  485.0 sec | output: 
    {'3': {'avg_iou': 0.43420976,
           'avg_obj': 0.082631566,
           'box_loss': 0.012596656,
           'class_loss': 0.0074048117,
           'conf_loss': 0.020426808,
           'precision50': 0.18619147,
           'recall50': 0.04037272},
     '4': {'avg_iou': 0.6432359,
           'avg_obj': 0.20825244,
           'box_loss': 0.012469724,
           'class_loss': 0.0076328665,
           'conf_loss': 0.018989433,
           'precision50': 0.42415702,
           'recall50': 0.15898241},
     '5': {'avg_iou': 0.73522806,
           'avg_obj': 0.36511928,
           'box_loss': 0.010594438,
           'class_loss': 0.0064548934,
           'conf_loss': 0.0145569565,
           'precision50': 0.6499765,
           'recall50': 0.3541312},
     'AP': 0.20120645,
     'AP50': 0.33381137,
     'AP75': 0.21013671,
     'APl': 0.3103383,
     'APm': 0.19084324,
     'APs': 0.041004274,
     'ARl': 0.57018316,
     'ARm': 0.42142332,
     'ARmax1': 0.22087969,
     'ARmax10': 0.36835137,
     'ARmax100': 0.40190515,
     'ARs': 0.1581747,
     'global': {'total_loss': 0.11112653},
     'validation_loss': 0.11112653}I0521 00:47:28.294745 140256446252864 controller.py:211] train | step:  60000 | training until step 80000...
I0521 02:28:04.142193 140256446252864 controller.py:425] train | step:  70000 | steps/sec:    1.5 | output: 
    {'3': {'avg_iou': 0.5597542,
           'avg_obj': 0.123940185,
           'box_loss': 0.017617246,
           'class_loss': 0.0108897295,
           'conf_loss': 0.0316618,
           'precision50': 0.30167764,
           'recall50': 0.04406795},
     '4': {'avg_iou': 0.6815845,
           'avg_obj': 0.24597226,
           'box_loss': 0.0144156935,
           'class_loss': 0.009886191,
           'conf_loss': 0.028199725,
           'precision50': 0.5715362,
           'recall50': 0.17508435},
     '5': {'avg_iou': 0.74760026,
           'avg_obj': 0.37943283,
           'box_loss': 0.011802624,
           'class_loss': 0.008395615,
           'conf_loss': 0.018349225,
           'precision50': 0.71259487,
           'recall50': 0.37471393},
     'global': {'total_loss': 1.2097437},
     'learning_rate': 0.009314038,
     'training_loss': 1.2097437}
I0521 02:28:52.429588 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-70000.
I0521 04:05:02.534462 140256446252864 controller.py:425] train | step:  80000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.56654185,
           'avg_obj': 0.13253519,
           'box_loss': 0.017322574,
           'class_loss': 0.010411152,
           'conf_loss': 0.031333603,
           'precision50': 0.3242306,
           'recall50': 0.050765075},
     '4': {'avg_iou': 0.68995345,
           'avg_obj': 0.25978157,
           'box_loss': 0.014015021,
           'class_loss': 0.009375349,
           'conf_loss': 0.027785165,
           'precision50': 0.59061056,
           'recall50': 0.19321303},
     '5': {'avg_iou': 0.7549685,
           'avg_obj': 0.39403135,
           'box_loss': 0.011440135,
           'class_loss': 0.007926471,
           'conf_loss': 0.018010033,
           'precision50': 0.7246798,
           'recall50': 0.3965094},
     'global': {'total_loss': 1.1809584},
     'learning_rate': 0.009112143,
     'training_loss': 1.1809584}
I0521 04:05:52.140473 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-80000.
I0521 04:05:52.147078 140256446252864 controller.py:252]  eval | step:  80000 | running 625 steps of evaluation...
I0521 04:10:01.001611 140256446252864 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0521 04:14:09.259321 140256446252864 controller.py:261]  eval | step:  80000 | eval time:  497.1 sec | output: 
    {'3': {'avg_iou': 0.44544458,
           'avg_obj': 0.10291539,
           'box_loss': 0.012028348,
           'class_loss': 0.0064775553,
           'conf_loss': 0.019808099,
           'precision50': 0.24225403,
           'recall50': 0.058654945},
     '4': {'avg_iou': 0.65966207,
           'avg_obj': 0.24568047,
           'box_loss': 0.0116370395,
           'class_loss': 0.006499382,
           'conf_loss': 0.018227812,
           'precision50': 0.48634088,
           'recall50': 0.20489383},
     '5': {'avg_iou': 0.7509999,
           'avg_obj': 0.40970653,
           'box_loss': 0.009797923,
           'class_loss': 0.005555292,
           'conf_loss': 0.013904363,
           'precision50': 0.692791,
           'recall50': 0.41944546},
     'AP': 0.23980057,
     'AP50': 0.38868022,
     'AP75': 0.25245494,
     'APl': 0.36716747,
     'APm': 0.23228028,
     'APs': 0.060620394,
     'ARl': 0.6036964,
     'ARm': 0.46541607,
     'ARmax1': 0.2445858,
     'ARmax10': 0.401653,
     'ARmax100': 0.43887335,
     'ARs': 0.19107829,
     'global': {'total_loss': 0.10393589},
     'validation_loss': 0.10393589}
I0521 04:14:25.818749 140256446252864 controller.py:211] train | step:  80000 | training until step 100000...
I0521 05:49:17.511605 140256446252864 controller.py:425] train | step:  90000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.5722856,
           'avg_obj': 0.14029689,
           'box_loss': 0.017089233,
           'class_loss': 0.010022241,
           'conf_loss': 0.03104251,
           'precision50': 0.34469113,
           'recall50': 0.057190076},
     '4': {'avg_iou': 0.69697183,
           'avg_obj': 0.2717633,
           'box_loss': 0.01366772,
           'class_loss': 0.008921155,
           'conf_loss': 0.027427755,
           'precision50': 0.6054987,
           'recall50': 0.20916617},
     '5': {'avg_iou': 0.76170313,
           'avg_obj': 0.40704033,
           'box_loss': 0.0111009125,
           'class_loss': 0.007538806,
           'conf_loss': 0.017726114,
           'precision50': 0.733745,
           'recall50': 0.41537666},
     'global': {'total_loss': 1.1562916},
     'learning_rate': 0.008887824,
     'training_loss': 1.1562916}
I0521 05:50:05.416336 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-90000.
I0521 07:25:35.361877 140256446252864 controller.py:425] train | step:  100000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.57734764,
           'avg_obj': 0.14716819,
           'box_loss': 0.016860273,
           'class_loss': 0.009651254,
           'conf_loss': 0.030783404,
           'precision50': 0.36106795,
           'recall50': 0.06307808},
     '4': {'avg_iou': 0.7029843,
           'avg_obj': 0.28168795,
           'box_loss': 0.0133651905,
           'class_loss': 0.008551798,
           'conf_loss': 0.027110202,
           'precision50': 0.6177801,
           'recall50': 0.22255811},
     '5': {'avg_iou': 0.7674562,
           'avg_obj': 0.41786617,
           'box_loss': 0.0108034145,
           'class_loss': 0.007230601,
           'conf_loss': 0.017490117,
           'precision50': 0.7405481,
           'recall50': 0.43105155},
     'global': {'total_loss': 1.1347703},
     'learning_rate': 0.008642699,
     'training_loss': 1.1347703}
I0521 07:26:23.209183 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-100000.
I0521 07:26:23.215306 140256446252864 controller.py:252]  eval | step:  100000 | running 625 steps of evaluation...
I0521 07:30:30.113308 140256446252864 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0521 07:34:43.256087 140256446252864 controller.py:261]  eval | step:  100000 | eval time:  500.0 sec | output: 
    {'3': {'avg_iou': 0.45251617,
           'avg_obj': 0.11573945,
           'box_loss': 0.011673012,
           'class_loss': 0.005865123,
           'conf_loss': 0.019402469,
           'precision50': 0.26740047,
           'recall50': 0.072694},
     '4': {'avg_iou': 0.6698812,
           'avg_obj': 0.26956284,
           'box_loss': 0.011120509,
           'class_loss': 0.005810071,
           'conf_loss': 0.017714716,
           'precision50': 0.52077425,
           'recall50': 0.2364508},
     '5': {'avg_iou': 0.7604621,
           'avg_obj': 0.4357894,
           'box_loss': 0.009317783,
           'class_loss': 0.004993656,
           'conf_loss': 0.013481822,
           'precision50': 0.7089135,
           'recall50': 0.4559512},
     'AP': 0.26572034,
     'AP50': 0.4239137,
     'AP75': 0.2788687,
     'APl': 0.4043936,
     'APm': 0.26037008,
     'APs': 0.071175076,
     'ARl': 0.6300798,
     'ARm': 0.4877957,
     'ARmax1': 0.2584867,
     'ARmax10': 0.42140985,
     'ARmax100': 0.4598181,
     'ARs': 0.2102591,
     'global': {'total_loss': 0.09937918},
     'validation_loss': 0.09937918}

train | step:  60000 | training until step 80000...
train | step:  70000 | steps/sec:    1.5 | output: 
    {'3': {'avg_iou': 0.5597542,
           'avg_obj': 0.123940185,
           'box_loss': 0.017617246,
           'class_loss': 0.0108897295,
           'conf_loss': 0.0316618,
           'precision50': 0.30167764,
           'recall50': 0.04406795},
     '4': {'avg_iou': 0.6815845,
           'avg_obj': 0.24597226,
           'box_loss': 0.0144156935,
           'class_loss': 0.009886191,
           'conf_loss': 0.028199725,
           'precision50': 0.5715362,
           'recall50': 0.17508435},
     '5': {'avg_iou': 0.74760026,
           'avg_obj': 0.37943283,
           'box_loss': 0.011802624,
           'class_loss': 0.008395615,
           'conf_loss': 0.018349225,
           'precision50': 0.71259487,
           'recall50': 0.37471393},
     'global': {'total_loss': 1.2097437},
     'learning_rate': 0.009314038,
     'training_loss': 1.2097437}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-70000.
train | step:  80000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.56654185,
           'avg_obj': 0.13253519,
           'box_loss': 0.017322574,
           'class_loss': 0.010411152,
           'conf_loss': 0.031333603,
           'precision50': 0.3242306,
           'recall50': 0.050765075},
     '4': {'avg_iou': 0.68995345,
           'avg_obj': 0.25978157,
           'box_loss': 0.014015021,
           'class_loss': 0.009375349,
           'conf_loss': 0.027785165,
           'precision50': 0.59061056,
           'recall50': 0.19321303},
     '5': {'avg_iou': 0.7549685,
           'avg_obj': 0.39403135,
           'box_loss': 0.011440135,
           'class_loss': 0.007926471,
           'conf_loss': 0.018010033,
           'precision50': 0.7246798,
           'recall50': 0.3965094},
     'global': {'total_loss': 1.1809584},
     'learning_rate': 0.009112143,
     'training_loss': 1.1809584}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-80000.
 eval | step:  80000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=169.32s).
Accumulating evaluation results...
DONE (t=20.77s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.240
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.389
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.252
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.061
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.232
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.367
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.245
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.402
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.439
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.191
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.465
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.604
 eval | step:  80000 | eval time:  497.1 sec | output: 
    {'3': {'avg_iou': 0.44544458,
           'avg_obj': 0.10291539,
           'box_loss': 0.012028348,
           'class_loss': 0.0064775553,
           'conf_loss': 0.019808099,
           'precision50': 0.24225403,
           'recall50': 0.058654945},
     '4': {'avg_iou': 0.65966207,
           'avg_obj': 0.24568047,
           'box_loss': 0.0116370395,
           'class_loss': 0.006499382,
           'conf_loss': 0.018227812,
           'precision50': 0.48634088,
           'recall50': 0.20489383},
     '5': {'avg_iou': 0.7509999,
           'avg_obj': 0.40970653,
           'box_loss': 0.009797923,
           'class_loss': 0.005555292,
           'conf_loss': 0.013904363,
           'precision50': 0.692791,
           'recall50': 0.41944546},
     'AP': 0.23980057,
     'AP50': 0.38868022,
     'AP75': 0.25245494,
     'APl': 0.36716747,
     'APm': 0.23228028,
     'APs': 0.060620394,
     'ARl': 0.6036964,
     'ARm': 0.46541607,
     'ARmax1': 0.2445858,
     'ARmax10': 0.401653,
     'ARmax100': 0.43887335,
     'ARs': 0.19107829,
     'global': {'total_loss': 0.10393589},
     'validation_loss': 0.10393589}
train | step:  80000 | training until step 100000...
train | step:  90000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.5722856,
           'avg_obj': 0.14029689,
           'box_loss': 0.017089233,
           'class_loss': 0.010022241,
           'conf_loss': 0.03104251,
           'precision50': 0.34469113,
           'recall50': 0.057190076},
     '4': {'avg_iou': 0.69697183,
           'avg_obj': 0.2717633,
           'box_loss': 0.01366772,
           'class_loss': 0.008921155,
           'conf_loss': 0.027427755,
           'precision50': 0.6054987,
           'recall50': 0.20916617},
     '5': {'avg_iou': 0.76170313,
           'avg_obj': 0.40704033,
           'box_loss': 0.0111009125,
           'class_loss': 0.007538806,
           'conf_loss': 0.017726114,
           'precision50': 0.733745,
           'recall50': 0.41537666},
     'global': {'total_loss': 1.1562916},
     'learning_rate': 0.008887824,
     'training_loss': 1.1562916}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-90000.
train | step:  100000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.57734764,
           'avg_obj': 0.14716819,
           'box_loss': 0.016860273,
           'class_loss': 0.009651254,
           'conf_loss': 0.030783404,
           'precision50': 0.36106795,
           'recall50': 0.06307808},
     '4': {'avg_iou': 0.7029843,
           'avg_obj': 0.28168795,
           'box_loss': 0.0133651905,
           'class_loss': 0.008551798,
           'conf_loss': 0.027110202,
           'precision50': 0.6177801,
           'recall50': 0.22255811},
     '5': {'avg_iou': 0.7674562,
           'avg_obj': 0.41786617,
           'box_loss': 0.0108034145,
           'class_loss': 0.007230601,
           'conf_loss': 0.017490117,
           'precision50': 0.7405481,
           'recall50': 0.43105155},
     'global': {'total_loss': 1.1347703},
     'learning_rate': 0.008642699,
     'training_loss': 1.1347703}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-100000.
 eval | step:  100000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=174.24s).
Accumulating evaluation results...
DONE (t=19.97s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.266
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.424
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.279
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.071
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.260
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.404
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.258
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.421
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.460
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.210
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.488
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.630
 eval | step:  100000 | eval time:  500.0 sec | output: 
    {'3': {'avg_iou': 0.45251617,
           'avg_obj': 0.11573945,
           'box_loss': 0.011673012,
           'class_loss': 0.005865123,
           'conf_loss': 0.019402469,
           'precision50': 0.26740047,
           'recall50': 0.072694},
     '4': {'avg_iou': 0.6698812,
           'avg_obj': 0.26956284,
           'box_loss': 0.011120509,
           'class_loss': 0.005810071,
           'conf_loss': 0.017714716,
           'precision50': 0.52077425,
           'recall50': 0.2364508},
     '5': {'avg_iou': 0.7604621,
           'avg_obj': 0.4357894,
           'box_loss': 0.009317783,
           'class_loss': 0.004993656,
           'conf_loss': 0.013481822,
           'precision50': 0.7089135,
           'recall50': 0.4559512},
     'AP': 0.26572034,
     'AP50': 0.4239137,
     'AP75': 0.2788687,
     'APl': 0.4043936,
     'APm': 0.26037008,
     'APs': 0.071175076,
     'ARl': 0.6300798,
     'ARm': 0.4877957,
     'ARmax1': 0.2584867,
     'ARmax10': 0.42140985,
     'ARmax100': 0.4598181,
     'ARs': 0.2102591,
     'global': {'total_loss': 0.09937918},
     'validation_loss': 0.09937918}I0521 07:34:59.869655 140256446252864 controller.py:211] train | step:  100000 | training until step 120000...
I0521 09:06:07.501503 140256446252864 controller.py:425] train | step:  110000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.581673,
           'avg_obj': 0.15340124,
           'box_loss': 0.016668467,
           'class_loss': 0.00935575,
           'conf_loss': 0.030524114,
           'precision50': 0.3745926,
           'recall50': 0.06836123},
     '4': {'avg_iou': 0.7083671,
           'avg_obj': 0.29097667,
           'box_loss': 0.013122925,
           'class_loss': 0.008245719,
           'conf_loss': 0.026826508,
           'precision50': 0.6276878,
           'recall50': 0.23496528},
     '5': {'avg_iou': 0.77229,
           'avg_obj': 0.4273099,
           'box_loss': 0.010569928,
           'class_loss': 0.0069353464,
           'conf_loss': 0.017282583,
           'precision50': 0.74668247,
           'recall50': 0.4440626},
     'global': {'total_loss': 1.1162494},
     'learning_rate': 0.008378533,
     'training_loss': 1.1162494}
I0521 09:06:55.582660 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-110000.
I0521 10:39:51.939490 140256446252864 controller.py:425] train | step:  120000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5855803,
           'avg_obj': 0.15925142,
           'box_loss': 0.01649283,
           'class_loss': 0.009071813,
           'conf_loss': 0.030268414,
           'precision50': 0.3882109,
           'recall50': 0.07370777},
     '4': {'avg_iou': 0.7131657,
           'avg_obj': 0.2994761,
           'box_loss': 0.012884606,
           'class_loss': 0.007951329,
           'conf_loss': 0.026542466,
           'precision50': 0.63687044,
           'recall50': 0.24688055},
     '5': {'avg_iou': 0.77663845,
           'avg_obj': 0.43626356,
           'box_loss': 0.010350788,
           'class_loss': 0.0066969246,
           'conf_loss': 0.017065795,
           'precision50': 0.7520918,
           'recall50': 0.45642555},
     'global': {'total_loss': 1.0985994},
     'learning_rate': 0.008097229,
     'training_loss': 1.0985994}
I0521 10:40:40.170826 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-120000.
I0521 10:40:40.176820 140256446252864 controller.py:252]  eval | step:  120000 | running 625 steps of evaluation...
I0521 10:44:47.046370 140256446252864 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0521 10:48:57.131228 140256446252864 controller.py:261]  eval | step:  120000 | eval time:  497.0 sec | output: 
    {'3': {'avg_iou': 0.45802066,
           'avg_obj': 0.12546678,
           'box_loss': 0.011396427,
           'class_loss': 0.005424182,
           'conf_loss': 0.01910356,
           'precision50': 0.2861881,
           'recall50': 0.082481965},
     '4': {'avg_iou': 0.677428,
           'avg_obj': 0.28711563,
           'box_loss': 0.010738003,
           'class_loss': 0.005385516,
           'conf_loss': 0.017349428,
           'precision50': 0.5443832,
           'recall50': 0.26116514},
     '5': {'avg_iou': 0.7670294,
           'avg_obj': 0.45350763,
           'box_loss': 0.0089870365,
           'class_loss': 0.0046323324,
           'conf_loss': 0.013212273,
           'precision50': 0.71650344,
           'recall50': 0.48109552},
     'AP': 0.28485727,
     'AP50': 0.44807833,
     'AP75': 0.30059367,
     'APl': 0.42742676,
     'APm': 0.2800593,
     'APs': 0.08290823,
     'ARl': 0.6433807,
     'ARm': 0.5057561,
     'ARmax1': 0.26848507,
     'ARmax10': 0.43525678,
     'ARmax100': 0.47509164,
     'ARs': 0.22571866,
     'global': {'total_loss': 0.096228816},
     'validation_loss': 0.096228816}
I0521 10:49:18.504935 140256446252864 controller.py:211] train | step:  120000 | training until step 140000...
I0521 12:18:23.272149 140256446252864 controller.py:425] train | step:  130000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.58964455,
           'avg_obj': 0.16472265,
           'box_loss': 0.01635339,
           'class_loss': 0.008827009,
           'conf_loss': 0.030135544,
           'precision50': 0.39927852,
           'recall50': 0.07894339},
     '4': {'avg_iou': 0.7177757,
           'avg_obj': 0.3075457,
           'box_loss': 0.012666864,
           'class_loss': 0.007679938,
           'conf_loss': 0.026341602,
           'precision50': 0.644849,
           'recall50': 0.2575826},
     '5': {'avg_iou': 0.7808646,
           'avg_obj': 0.4444486,
           'box_loss': 0.010141084,
           'class_loss': 0.0064548706,
           'conf_loss': 0.016895339,
           'precision50': 0.75648385,
           'recall50': 0.46750215},
     'global': {'total_loss': 1.0839635},
     'learning_rate': 0.007800815,
     'training_loss': 1.0839635}
I0521 12:19:11.624716 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-130000.
I0521 13:50:20.876675 140256446252864 controller.py:425] train | step:  140000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.59275657,
           'avg_obj': 0.16950797,
           'box_loss': 0.01620392,
           'class_loss': 0.008599713,
           'conf_loss': 0.029906467,
           'precision50': 0.40855342,
           'recall50': 0.083138034},
     '4': {'avg_iou': 0.72167015,
           'avg_obj': 0.31434903,
           'box_loss': 0.012479569,
           'class_loss': 0.00746055,
           'conf_loss': 0.026125778,
           'precision50': 0.65073997,
           'recall50': 0.2669614},
     '5': {'avg_iou': 0.78446835,
           'avg_obj': 0.45179498,
           'box_loss': 0.009960346,
           'class_loss': 0.0062535726,
           'conf_loss': 0.01673196,
           'precision50': 0.76070285,
           'recall50': 0.47754228},
     'global': {'total_loss': 1.0697753},
     'learning_rate': 0.007491425,
     'training_loss': 1.0697753}
I0521 13:51:08.492172 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-140000.
I0521 13:51:08.501386 140256446252864 controller.py:252]  eval | step:  140000 | running 625 steps of evaluation...
I0521 13:55:16.491874 140256446252864 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0521 13:59:28.120540 140256446252864 controller.py:261]  eval | step:  140000 | eval time:  499.6 sec | output: 
    {'3': {'avg_iou': 0.46158236,
           'avg_obj': 0.13359062,
           'box_loss': 0.011215905,
           'class_loss': 0.0052465643,
           'conf_loss': 0.018894933,
           'precision50': 0.30565685,
           'recall50': 0.09151634},
     '4': {'avg_iou': 0.68246335,
           'avg_obj': 0.300357,
           'box_loss': 0.010482303,
           'class_loss': 0.0051496853,
           'conf_loss': 0.017113121,
           'precision50': 0.5611023,
           'recall50': 0.27880383},
     '5': {'avg_iou': 0.77115667,
           'avg_obj': 0.4646485,
           'box_loss': 0.008781923,
           'class_loss': 0.0045295116,
           'conf_loss': 0.013012726,
           'precision50': 0.72238785,
           'recall50': 0.49613228},
     'AP': 0.29943144,
     'AP50': 0.4677862,
     'AP75': 0.31243828,
     'APl': 0.44829163,
     'APm': 0.29782504,
     'APs': 0.09204462,
     'ARl': 0.656018,
     'ARm': 0.51724607,
     'ARmax1': 0.27484813,
     'ARmax10': 0.44784123,
     'ARmax100': 0.48658347,
     'ARs': 0.23747039,
     'global': {'total_loss': 0.09442666},
     'validation_loss': 0.09442666}

train | step:  100000 | training until step 120000...
train | step:  110000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.581673,
           'avg_obj': 0.15340124,
           'box_loss': 0.016668467,
           'class_loss': 0.00935575,
           'conf_loss': 0.030524114,
           'precision50': 0.3745926,
           'recall50': 0.06836123},
     '4': {'avg_iou': 0.7083671,
           'avg_obj': 0.29097667,
           'box_loss': 0.013122925,
           'class_loss': 0.008245719,
           'conf_loss': 0.026826508,
           'precision50': 0.6276878,
           'recall50': 0.23496528},
     '5': {'avg_iou': 0.77229,
           'avg_obj': 0.4273099,
           'box_loss': 0.010569928,
           'class_loss': 0.0069353464,
           'conf_loss': 0.017282583,
           'precision50': 0.74668247,
           'recall50': 0.4440626},
     'global': {'total_loss': 1.1162494},
     'learning_rate': 0.008378533,
     'training_loss': 1.1162494}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-110000.
train | step:  120000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5855803,
           'avg_obj': 0.15925142,
           'box_loss': 0.01649283,
           'class_loss': 0.009071813,
           'conf_loss': 0.030268414,
           'precision50': 0.3882109,
           'recall50': 0.07370777},
     '4': {'avg_iou': 0.7131657,
           'avg_obj': 0.2994761,
           'box_loss': 0.012884606,
           'class_loss': 0.007951329,
           'conf_loss': 0.026542466,
           'precision50': 0.63687044,
           'recall50': 0.24688055},
     '5': {'avg_iou': 0.77663845,
           'avg_obj': 0.43626356,
           'box_loss': 0.010350788,
           'class_loss': 0.0066969246,
           'conf_loss': 0.017065795,
           'precision50': 0.7520918,
           'recall50': 0.45642555},
     'global': {'total_loss': 1.0985994},
     'learning_rate': 0.008097229,
     'training_loss': 1.0985994}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-120000.
 eval | step:  120000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=170.82s).
Accumulating evaluation results...
DONE (t=19.61s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.285
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.448
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.301
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.083
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.280
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.427
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.268
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.435
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.475
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.226
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.506
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.643
 eval | step:  120000 | eval time:  497.0 sec | output: 
    {'3': {'avg_iou': 0.45802066,
           'avg_obj': 0.12546678,
           'box_loss': 0.011396427,
           'class_loss': 0.005424182,
           'conf_loss': 0.01910356,
           'precision50': 0.2861881,
           'recall50': 0.082481965},
     '4': {'avg_iou': 0.677428,
           'avg_obj': 0.28711563,
           'box_loss': 0.010738003,
           'class_loss': 0.005385516,
           'conf_loss': 0.017349428,
           'precision50': 0.5443832,
           'recall50': 0.26116514},
     '5': {'avg_iou': 0.7670294,
           'avg_obj': 0.45350763,
           'box_loss': 0.0089870365,
           'class_loss': 0.0046323324,
           'conf_loss': 0.013212273,
           'precision50': 0.71650344,
           'recall50': 0.48109552},
     'AP': 0.28485727,
     'AP50': 0.44807833,
     'AP75': 0.30059367,
     'APl': 0.42742676,
     'APm': 0.2800593,
     'APs': 0.08290823,
     'ARl': 0.6433807,
     'ARm': 0.5057561,
     'ARmax1': 0.26848507,
     'ARmax10': 0.43525678,
     'ARmax100': 0.47509164,
     'ARs': 0.22571866,
     'global': {'total_loss': 0.096228816},
     'validation_loss': 0.096228816}
train | step:  120000 | training until step 140000...
train | step:  130000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.58964455,
           'avg_obj': 0.16472265,
           'box_loss': 0.01635339,
           'class_loss': 0.008827009,
           'conf_loss': 0.030135544,
           'precision50': 0.39927852,
           'recall50': 0.07894339},
     '4': {'avg_iou': 0.7177757,
           'avg_obj': 0.3075457,
           'box_loss': 0.012666864,
           'class_loss': 0.007679938,
           'conf_loss': 0.026341602,
           'precision50': 0.644849,
           'recall50': 0.2575826},
     '5': {'avg_iou': 0.7808646,
           'avg_obj': 0.4444486,
           'box_loss': 0.010141084,
           'class_loss': 0.0064548706,
           'conf_loss': 0.016895339,
           'precision50': 0.75648385,
           'recall50': 0.46750215},
     'global': {'total_loss': 1.0839635},
     'learning_rate': 0.007800815,
     'training_loss': 1.0839635}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-130000.
train | step:  140000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.59275657,
           'avg_obj': 0.16950797,
           'box_loss': 0.01620392,
           'class_loss': 0.008599713,
           'conf_loss': 0.029906467,
           'precision50': 0.40855342,
           'recall50': 0.083138034},
     '4': {'avg_iou': 0.72167015,
           'avg_obj': 0.31434903,
           'box_loss': 0.012479569,
           'class_loss': 0.00746055,
           'conf_loss': 0.026125778,
           'precision50': 0.65073997,
           'recall50': 0.2669614},
     '5': {'avg_iou': 0.78446835,
           'avg_obj': 0.45179498,
           'box_loss': 0.009960346,
           'class_loss': 0.0062535726,
           'conf_loss': 0.01673196,
           'precision50': 0.76070285,
           'recall50': 0.47754228},
     'global': {'total_loss': 1.0697753},
     'learning_rate': 0.007491425,
     'training_loss': 1.0697753}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-140000.
 eval | step:  140000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=171.12s).
Accumulating evaluation results...
DONE (t=18.66s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.299
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.468
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.312
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.092
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.298
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.448
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.275
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.448
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.487
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.237
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.517
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.656
 eval | step:  140000 | eval time:  499.6 sec | output: 
    {'3': {'avg_iou': 0.46158236,
           'avg_obj': 0.13359062,
           'box_loss': 0.011215905,
           'class_loss': 0.0052465643,
           'conf_loss': 0.018894933,
           'precision50': 0.30565685,
           'recall50': 0.09151634},
     '4': {'avg_iou': 0.68246335,
           'avg_obj': 0.300357,
           'box_loss': 0.010482303,
           'class_loss': 0.0051496853,
           'conf_loss': 0.017113121,
           'precision50': 0.5611023,
           'recall50': 0.27880383},
     '5': {'avg_iou': 0.77115667,
           'avg_obj': 0.4646485,
           'box_loss': 0.008781923,
           'class_loss': 0.0045295116,
           'conf_loss': 0.013012726,
           'precision50': 0.72238785,
           'recall50': 0.49613228},
     'AP': 0.29943144,
     'AP50': 0.4677862,
     'AP75': 0.31243828,
     'APl': 0.44829163,
     'APm': 0.29782504,
     'APs': 0.09204462,
     'ARl': 0.656018,
     'ARm': 0.51724607,
     'ARmax1': 0.27484813,
     'ARmax10': 0.44784123,
     'ARmax100': 0.48658347,
     'ARs': 0.23747039,
     'global': {'total_loss': 0.09442666},
     'validation_loss': 0.09442666}I0521 13:59:44.686473 140256446252864 controller.py:211] train | step:  140000 | training until step 160000...
I0521 15:22:52.390946 140256446252864 controller.py:425] train | step:  150000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.59561366,
           'avg_obj': 0.17370623,
           'box_loss': 0.016075317,
           'class_loss': 0.008395901,
           'conf_loss': 0.029728845,
           'precision50': 0.41803223,
           'recall50': 0.08744537},
     '4': {'avg_iou': 0.7252497,
           'avg_obj': 0.3209147,
           'box_loss': 0.012292213,
           'class_loss': 0.0072386046,
           'conf_loss': 0.025890704,
           'precision50': 0.657115,
           'recall50': 0.2759873},
     '5': {'avg_iou': 0.78783023,
           'avg_obj': 0.45865646,
           'box_loss': 0.00979352,
           'class_loss': 0.0060753818,
           'conf_loss': 0.016549114,
           'precision50': 0.76393956,
           'recall50': 0.486605},
     'global': {'total_loss': 1.0563163},
     'learning_rate': 0.007171291,
     'training_loss': 1.0563163}
I0521 15:23:40.966172 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-150000.
I0521 16:55:26.177824 140256446252864 controller.py:425] train | step:  160000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.59872264,
           'avg_obj': 0.17823377,
           'box_loss': 0.015962474,
           'class_loss': 0.008213915,
           'conf_loss': 0.029548056,
           'precision50': 0.42680869,
           'recall50': 0.09194482},
     '4': {'avg_iou': 0.7285804,
           'avg_obj': 0.32720804,
           'box_loss': 0.012133319,
           'class_loss': 0.0070467894,
           'conf_loss': 0.025694152,
           'precision50': 0.6625275,
           'recall50': 0.28444725},
     '5': {'avg_iou': 0.7910826,
           'avg_obj': 0.4655895,
           'box_loss': 0.009629866,
           'class_loss': 0.0058872434,
           'conf_loss': 0.016389964,
           'precision50': 0.76737773,
           'recall50': 0.4951978},
     'global': {'total_loss': 1.0440482},
     'learning_rate': 0.0068427175,
     'training_loss': 1.0440482}
I0521 16:56:14.269033 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-160000.
I0521 16:56:14.275047 140256446252864 controller.py:252]  eval | step:  160000 | running 625 steps of evaluation...
I0521 17:00:23.627657 140256446252864 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0521 17:04:31.435354 140256446252864 controller.py:261]  eval | step:  160000 | eval time:  497.2 sec | output: 
    {'3': {'avg_iou': 0.46494058,
           'avg_obj': 0.13950005,
           'box_loss': 0.011047045,
           'class_loss': 0.0051746564,
           'conf_loss': 0.01870646,
           'precision50': 0.31757805,
           'recall50': 0.09938554},
     '4': {'avg_iou': 0.6868369,
           'avg_obj': 0.31155267,
           'box_loss': 0.010260803,
           'class_loss': 0.005006165,
           'conf_loss': 0.01687625,
           'precision50': 0.5748163,
           'recall50': 0.29454058},
     '5': {'avg_iou': 0.7751995,
           'avg_obj': 0.47827652,
           'box_loss': 0.008578611,
           'class_loss': 0.004409174,
           'conf_loss': 0.012845345,
           'precision50': 0.7272959,
           'recall50': 0.5134807},
     'AP': 0.31124493,
     'AP50': 0.48247677,
     'AP75': 0.32712147,
     'APl': 0.4604552,
     'APm': 0.3102801,
     'APs': 0.09900033,
     'ARl': 0.66314125,
     'ARm': 0.53439695,
     'ARmax1': 0.2829275,
     'ARmax10': 0.45918977,
     'ARmax100': 0.49871427,
     'ARs': 0.2505085,
     'global': {'total_loss': 0.092904456},
     'validation_loss': 0.092904456}
I0521 17:04:49.924203 140256446252864 controller.py:211] train | step:  160000 | training until step 180000...
I0521 18:31:05.801396 140256446252864 controller.py:425] train | step:  170000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6011324,
           'avg_obj': 0.18208344,
           'box_loss': 0.015842857,
           'class_loss': 0.008029749,
           'conf_loss': 0.029371645,
           'precision50': 0.4333729,
           'recall50': 0.09561643},
     '4': {'avg_iou': 0.731641,
           'avg_obj': 0.33252093,
           'box_loss': 0.011978193,
           'class_loss': 0.006875411,
           'conf_loss': 0.02548133,
           'precision50': 0.66642284,
           'recall50': 0.2916657},
     '5': {'avg_iou': 0.79383606,
           'avg_obj': 0.47102046,
           'box_loss': 0.009485897,
           'class_loss': 0.0057399916,
           'conf_loss': 0.016236829,
           'precision50': 0.7703899,
           'recall50': 0.5027914},
     'global': {'total_loss': 1.0323354},
     'learning_rate': 0.0065080714,
     'training_loss': 1.0323354}
I0521 18:31:54.253608 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-170000.
I0521 20:05:44.853330 140256446252864 controller.py:425] train | step:  180000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6037687,
           'avg_obj': 0.18592636,
           'box_loss': 0.015726676,
           'class_loss': 0.007877462,
           'conf_loss': 0.02926286,
           'precision50': 0.44033563,
           'recall50': 0.09916284},
     '4': {'avg_iou': 0.7345635,
           'avg_obj': 0.33827648,
           'box_loss': 0.011834519,
           'class_loss': 0.0067084213,
           'conf_loss': 0.025344117,
           'precision50': 0.6718369,
           'recall50': 0.29930174},
     '5': {'avg_iou': 0.79660386,
           'avg_obj': 0.47685444,
           'box_loss': 0.009351569,
           'class_loss': 0.005605698,
           'conf_loss': 0.016111229,
           'precision50': 0.77375335,
           'recall50': 0.51037234},
     'global': {'total_loss': 1.0225796},
     'learning_rate': 0.0061697643,
     'training_loss': 1.0225796}
I0521 20:06:34.373911 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-180000.
I0521 20:06:34.380709 140256446252864 controller.py:252]  eval | step:  180000 | running 625 steps of evaluation...
I0521 20:10:42.286700 140256446252864 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0521 20:14:49.533666 140256446252864 controller.py:261]  eval | step:  180000 | eval time:  495.2 sec | output: 
    {'3': {'avg_iou': 0.4676405,
           'avg_obj': 0.14480878,
           'box_loss': 0.010910816,
           'class_loss': 0.0046271887,
           'conf_loss': 0.018601174,
           'precision50': 0.3290051,
           'recall50': 0.10677093},
     '4': {'avg_iou': 0.6902095,
           'avg_obj': 0.31936517,
           'box_loss': 0.010091085,
           'class_loss': 0.004542319,
           'conf_loss': 0.016755,
           'precision50': 0.57987946,
           'recall50': 0.30540895},
     '5': {'avg_iou': 0.7776928,
           'avg_obj': 0.48321608,
           'box_loss': 0.0084513705,
           'class_loss': 0.004020439,
           'conf_loss': 0.012753066,
           'precision50': 0.73032415,
           'recall50': 0.51744497},
     'AP': 0.3200518,
     'AP50': 0.4928102,
     'AP75': 0.33975723,
     'APl': 0.47059634,
     'APm': 0.319962,
     'APs': 0.10499231,
     'ARl': 0.67732775,
     'ARm': 0.54123044,
     'ARmax1': 0.2893237,
     'ARmax10': 0.4688535,
     'ARmax100': 0.5098347,
     'ARs': 0.25641233,
     'global': {'total_loss': 0.09075244},
     'validation_loss': 0.09075244}

train | step:  140000 | training until step 160000...
train | step:  150000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.59561366,
           'avg_obj': 0.17370623,
           'box_loss': 0.016075317,
           'class_loss': 0.008395901,
           'conf_loss': 0.029728845,
           'precision50': 0.41803223,
           'recall50': 0.08744537},
     '4': {'avg_iou': 0.7252497,
           'avg_obj': 0.3209147,
           'box_loss': 0.012292213,
           'class_loss': 0.0072386046,
           'conf_loss': 0.025890704,
           'precision50': 0.657115,
           'recall50': 0.2759873},
     '5': {'avg_iou': 0.78783023,
           'avg_obj': 0.45865646,
           'box_loss': 0.00979352,
           'class_loss': 0.0060753818,
           'conf_loss': 0.016549114,
           'precision50': 0.76393956,
           'recall50': 0.486605},
     'global': {'total_loss': 1.0563163},
     'learning_rate': 0.007171291,
     'training_loss': 1.0563163}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-150000.
train | step:  160000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.59872264,
           'avg_obj': 0.17823377,
           'box_loss': 0.015962474,
           'class_loss': 0.008213915,
           'conf_loss': 0.029548056,
           'precision50': 0.42680869,
           'recall50': 0.09194482},
     '4': {'avg_iou': 0.7285804,
           'avg_obj': 0.32720804,
           'box_loss': 0.012133319,
           'class_loss': 0.0070467894,
           'conf_loss': 0.025694152,
           'precision50': 0.6625275,
           'recall50': 0.28444725},
     '5': {'avg_iou': 0.7910826,
           'avg_obj': 0.4655895,
           'box_loss': 0.009629866,
           'class_loss': 0.0058872434,
           'conf_loss': 0.016389964,
           'precision50': 0.76737773,
           'recall50': 0.4951978},
     'global': {'total_loss': 1.0440482},
     'learning_rate': 0.0068427175,
     'training_loss': 1.0440482}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-160000.
 eval | step:  160000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=170.24s).
Accumulating evaluation results...
DONE (t=17.99s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.311
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.482
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.327
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.099
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.310
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.460
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.283
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.459
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.499
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.251
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.534
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.663
 eval | step:  160000 | eval time:  497.2 sec | output: 
    {'3': {'avg_iou': 0.46494058,
           'avg_obj': 0.13950005,
           'box_loss': 0.011047045,
           'class_loss': 0.0051746564,
           'conf_loss': 0.01870646,
           'precision50': 0.31757805,
           'recall50': 0.09938554},
     '4': {'avg_iou': 0.6868369,
           'avg_obj': 0.31155267,
           'box_loss': 0.010260803,
           'class_loss': 0.005006165,
           'conf_loss': 0.01687625,
           'precision50': 0.5748163,
           'recall50': 0.29454058},
     '5': {'avg_iou': 0.7751995,
           'avg_obj': 0.47827652,
           'box_loss': 0.008578611,
           'class_loss': 0.004409174,
           'conf_loss': 0.012845345,
           'precision50': 0.7272959,
           'recall50': 0.5134807},
     'AP': 0.31124493,
     'AP50': 0.48247677,
     'AP75': 0.32712147,
     'APl': 0.4604552,
     'APm': 0.3102801,
     'APs': 0.09900033,
     'ARl': 0.66314125,
     'ARm': 0.53439695,
     'ARmax1': 0.2829275,
     'ARmax10': 0.45918977,
     'ARmax100': 0.49871427,
     'ARs': 0.2505085,
     'global': {'total_loss': 0.092904456},
     'validation_loss': 0.092904456}
train | step:  160000 | training until step 180000...
train | step:  170000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6011324,
           'avg_obj': 0.18208344,
           'box_loss': 0.015842857,
           'class_loss': 0.008029749,
           'conf_loss': 0.029371645,
           'precision50': 0.4333729,
           'recall50': 0.09561643},
     '4': {'avg_iou': 0.731641,
           'avg_obj': 0.33252093,
           'box_loss': 0.011978193,
           'class_loss': 0.006875411,
           'conf_loss': 0.02548133,
           'precision50': 0.66642284,
           'recall50': 0.2916657},
     '5': {'avg_iou': 0.79383606,
           'avg_obj': 0.47102046,
           'box_loss': 0.009485897,
           'class_loss': 0.0057399916,
           'conf_loss': 0.016236829,
           'precision50': 0.7703899,
           'recall50': 0.5027914},
     'global': {'total_loss': 1.0323354},
     'learning_rate': 0.0065080714,
     'training_loss': 1.0323354}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-170000.
train | step:  180000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6037687,
           'avg_obj': 0.18592636,
           'box_loss': 0.015726676,
           'class_loss': 0.007877462,
           'conf_loss': 0.02926286,
           'precision50': 0.44033563,
           'recall50': 0.09916284},
     '4': {'avg_iou': 0.7345635,
           'avg_obj': 0.33827648,
           'box_loss': 0.011834519,
           'class_loss': 0.0067084213,
           'conf_loss': 0.025344117,
           'precision50': 0.6718369,
           'recall50': 0.29930174},
     '5': {'avg_iou': 0.79660386,
           'avg_obj': 0.47685444,
           'box_loss': 0.009351569,
           'class_loss': 0.005605698,
           'conf_loss': 0.016111229,
           'precision50': 0.77375335,
           'recall50': 0.51037234},
     'global': {'total_loss': 1.0225796},
     'learning_rate': 0.0061697643,
     'training_loss': 1.0225796}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-180000.
 eval | step:  180000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=173.62s).
Accumulating evaluation results...
DONE (t=17.10s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.320
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.493
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.340
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.105
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.320
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.471
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.289
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.469
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.510
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.256
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.541
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.677
 eval | step:  180000 | eval time:  495.2 sec | output: 
    {'3': {'avg_iou': 0.4676405,
           'avg_obj': 0.14480878,
           'box_loss': 0.010910816,
           'class_loss': 0.0046271887,
           'conf_loss': 0.018601174,
           'precision50': 0.3290051,
           'recall50': 0.10677093},
     '4': {'avg_iou': 0.6902095,
           'avg_obj': 0.31936517,
           'box_loss': 0.010091085,
           'class_loss': 0.004542319,
           'conf_loss': 0.016755,
           'precision50': 0.57987946,
           'recall50': 0.30540895},
     '5': {'avg_iou': 0.7776928,
           'avg_obj': 0.48321608,
           'box_loss': 0.0084513705,
           'class_loss': 0.004020439,
           'conf_loss': 0.012753066,
           'precision50': 0.73032415,
           'recall50': 0.51744497},
     'AP': 0.3200518,
     'AP50': 0.4928102,
     'AP75': 0.33975723,
     'APl': 0.47059634,
     'APm': 0.319962,
     'APs': 0.10499231,
     'ARl': 0.67732775,
     'ARm': 0.54123044,
     'ARmax1': 0.2893237,
     'ARmax10': 0.4688535,
     'ARmax100': 0.5098347,
     'ARs': 0.25641233,
     'global': {'total_loss': 0.09075244},
     'validation_loss': 0.09075244}I0521 20:15:14.410711 140256446252864 controller.py:211] train | step:  180000 | training until step 200000...
I0521 21:44:05.343474 140256446252864 controller.py:425] train | step:  190000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.60615695,
           'avg_obj': 0.19006392,
           'box_loss': 0.015624116,
           'class_loss': 0.007722956,
           'conf_loss': 0.029083973,
           'precision50': 0.4471151,
           'recall50': 0.10335908},
     '4': {'avg_iou': 0.7377156,
           'avg_obj': 0.34377915,
           'box_loss': 0.0116941165,
           'class_loss': 0.0065505705,
           'conf_loss': 0.025165766,
           'precision50': 0.6757143,
           'recall50': 0.30643216},
     '5': {'avg_iou': 0.79930556,
           'avg_obj': 0.48249784,
           'box_loss': 0.0092233205,
           'class_loss': 0.00546526,
           'conf_loss': 0.015988268,
           'precision50': 0.7758413,
           'recall50': 0.5174393},
     'global': {'total_loss': 1.0121478},
     'learning_rate': 0.0058302353,
     'training_loss': 1.0121478}
I0521 21:44:52.055427 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-190000.
I0521 23:17:44.941205 140256446252864 controller.py:425] train | step:  200000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6082972,
           'avg_obj': 0.19348788,
           'box_loss': 0.01553681,
           'class_loss': 0.007580964,
           'conf_loss': 0.028961536,
           'precision50': 0.45245942,
           'recall50': 0.10681797},
     '4': {'avg_iou': 0.7400248,
           'avg_obj': 0.3488138,
           'box_loss': 0.011566223,
           'class_loss': 0.0063978634,
           'conf_loss': 0.02498053,
           'precision50': 0.6795988,
           'recall50': 0.3131772},
     '5': {'avg_iou': 0.801788,
           'avg_obj': 0.4876477,
           'box_loss': 0.009098831,
           'class_loss': 0.0053354395,
           'conf_loss': 0.01584828,
           'precision50': 0.7786354,
           'recall50': 0.5241471},
     'global': {'total_loss': 1.0024546},
     'learning_rate': 0.005491929,
     'training_loss': 1.0024546}
I0521 23:18:33.660989 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-200000.
I0521 23:18:33.666420 140256446252864 controller.py:252]  eval | step:  200000 | running 625 steps of evaluation...
I0521 23:22:40.737534 140256446252864 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0521 23:26:44.597636 140256446252864 controller.py:261]  eval | step:  200000 | eval time:  490.9 sec | output: 
    {'3': {'avg_iou': 0.46987793,
           'avg_obj': 0.15073125,
           'box_loss': 0.010797619,
           'class_loss': 0.0044571403,
           'conf_loss': 0.018452615,
           'precision50': 0.33878577,
           'recall50': 0.11355487},
     '4': {'avg_iou': 0.6938899,
           'avg_obj': 0.33036956,
           'box_loss': 0.009907035,
           'class_loss': 0.004371675,
           'conf_loss': 0.01657723,
           'precision50': 0.587555,
           'recall50': 0.31911916},
     '5': {'avg_iou': 0.7810427,
           'avg_obj': 0.4964458,
           'box_loss': 0.008283993,
           'class_loss': 0.00389601,
           'conf_loss': 0.012618967,
           'precision50': 0.73298144,
           'recall50': 0.5348532},
     'AP': 0.3295648,
     'AP50': 0.50497925,
     'AP75': 0.3484999,
     'APl': 0.48317707,
     'APm': 0.3311254,
     'APs': 0.109705076,
     'ARl': 0.6829844,
     'ARm': 0.5478751,
     'ARmax1': 0.29493493,
     'ARmax10': 0.47493547,
     'ARmax100': 0.5159726,
     'ARs': 0.26351058,
     'global': {'total_loss': 0.08936229},
     'validation_loss': 0.08936229}
I0521 23:27:02.770536 140256446252864 controller.py:211] train | step:  200000 | training until step 220000...
I0522 00:58:53.151860 140256446252864 controller.py:425] train | step:  210000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.6105973,
           'avg_obj': 0.19669318,
           'box_loss': 0.01543546,
           'class_loss': 0.0074464614,
           'conf_loss': 0.028878385,
           'precision50': 0.45850942,
           'recall50': 0.1098947},
     '4': {'avg_iou': 0.7425508,
           'avg_obj': 0.35324165,
           'box_loss': 0.01146101,
           'class_loss': 0.0062733823,
           'conf_loss': 0.024892291,
           'precision50': 0.68286276,
           'recall50': 0.31925133},
     '5': {'avg_iou': 0.8039283,
           'avg_obj': 0.4924493,
           'box_loss': 0.008991794,
           'class_loss': 0.0052214717,
           'conf_loss': 0.01574596,
           'precision50': 0.7810873,
           'recall50': 0.52975297},
     'global': {'total_loss': 0.99476737},
     'learning_rate': 0.005157283,
     'training_loss': 0.99476737}
I0522 00:59:40.106054 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-210000.
I0522 02:34:23.207987 140256446252864 controller.py:425] train | step:  220000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.61265856,
           'avg_obj': 0.20001492,
           'box_loss': 0.015329908,
           'class_loss': 0.0073228967,
           'conf_loss': 0.028657984,
           'precision50': 0.46262226,
           'recall50': 0.113268286},
     '4': {'avg_iou': 0.7449587,
           'avg_obj': 0.35757142,
           'box_loss': 0.0113327885,
           'class_loss': 0.006137645,
           'conf_loss': 0.024689725,
           'precision50': 0.6854831,
           'recall50': 0.32471374},
     '5': {'avg_iou': 0.8061662,
           'avg_obj': 0.49677408,
           'box_loss': 0.008878976,
           'class_loss': 0.0051008905,
           'conf_loss': 0.015626783,
           'precision50': 0.7831992,
           'recall50': 0.5359621},
     'global': {'total_loss': 0.98461944},
     'learning_rate': 0.0048287087,
     'training_loss': 0.98461944}
I0522 02:35:12.079069 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-220000.
I0522 02:35:12.085392 140256446252864 controller.py:252]  eval | step:  220000 | running 625 steps of evaluation...
I0522 02:39:21.076643 140256446252864 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0522 02:43:28.110880 140256446252864 controller.py:261]  eval | step:  220000 | eval time:  496.0 sec | output: 
    {'3': {'avg_iou': 0.47174633,
           'avg_obj': 0.15390942,
           'box_loss': 0.01070187,
           'class_loss': 0.004333263,
           'conf_loss': 0.018323312,
           'precision50': 0.3441448,
           'recall50': 0.11805519},
     '4': {'avg_iou': 0.6960783,
           'avg_obj': 0.33726636,
           'box_loss': 0.009794557,
           'class_loss': 0.004250767,
           'conf_loss': 0.016461035,
           'precision50': 0.59326863,
           'recall50': 0.32923797},
     '5': {'avg_iou': 0.7827571,
           'avg_obj': 0.5038897,
           'box_loss': 0.008197558,
           'class_loss': 0.0037927688,
           'conf_loss': 0.012538414,
           'precision50': 0.73625284,
           'recall50': 0.543869},
     'AP': 0.33583036,
     'AP50': 0.51313186,
     'AP75': 0.35577694,
     'APl': 0.49412706,
     'APm': 0.33847287,
     'APs': 0.11191163,
     'ARl': 0.6877716,
     'ARm': 0.55508274,
     'ARmax1': 0.29576755,
     'ARmax10': 0.47834045,
     'ARmax100': 0.5198081,
     'ARs': 0.26635066,
     'global': {'total_loss': 0.08839352},
     'validation_loss': 0.08839352}

train | step:  180000 | training until step 200000...
train | step:  190000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.60615695,
           'avg_obj': 0.19006392,
           'box_loss': 0.015624116,
           'class_loss': 0.007722956,
           'conf_loss': 0.029083973,
           'precision50': 0.4471151,
           'recall50': 0.10335908},
     '4': {'avg_iou': 0.7377156,
           'avg_obj': 0.34377915,
           'box_loss': 0.0116941165,
           'class_loss': 0.0065505705,
           'conf_loss': 0.025165766,
           'precision50': 0.6757143,
           'recall50': 0.30643216},
     '5': {'avg_iou': 0.79930556,
           'avg_obj': 0.48249784,
           'box_loss': 0.0092233205,
           'class_loss': 0.00546526,
           'conf_loss': 0.015988268,
           'precision50': 0.7758413,
           'recall50': 0.5174393},
     'global': {'total_loss': 1.0121478},
     'learning_rate': 0.0058302353,
     'training_loss': 1.0121478}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-190000.
train | step:  200000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6082972,
           'avg_obj': 0.19348788,
           'box_loss': 0.01553681,
           'class_loss': 0.007580964,
           'conf_loss': 0.028961536,
           'precision50': 0.45245942,
           'recall50': 0.10681797},
     '4': {'avg_iou': 0.7400248,
           'avg_obj': 0.3488138,
           'box_loss': 0.011566223,
           'class_loss': 0.0063978634,
           'conf_loss': 0.02498053,
           'precision50': 0.6795988,
           'recall50': 0.3131772},
     '5': {'avg_iou': 0.801788,
           'avg_obj': 0.4876477,
           'box_loss': 0.009098831,
           'class_loss': 0.0053354395,
           'conf_loss': 0.01584828,
           'precision50': 0.7786354,
           'recall50': 0.5241471},
     'global': {'total_loss': 1.0024546},
     'learning_rate': 0.005491929,
     'training_loss': 1.0024546}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-200000.
 eval | step:  200000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=174.68s).
Accumulating evaluation results...
DONE (t=16.56s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.330
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.505
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.348
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.110
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.331
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.483
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.295
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.475
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.516
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.264
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.548
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.683
 eval | step:  200000 | eval time:  490.9 sec | output: 
    {'3': {'avg_iou': 0.46987793,
           'avg_obj': 0.15073125,
           'box_loss': 0.010797619,
           'class_loss': 0.0044571403,
           'conf_loss': 0.018452615,
           'precision50': 0.33878577,
           'recall50': 0.11355487},
     '4': {'avg_iou': 0.6938899,
           'avg_obj': 0.33036956,
           'box_loss': 0.009907035,
           'class_loss': 0.004371675,
           'conf_loss': 0.01657723,
           'precision50': 0.587555,
           'recall50': 0.31911916},
     '5': {'avg_iou': 0.7810427,
           'avg_obj': 0.4964458,
           'box_loss': 0.008283993,
           'class_loss': 0.00389601,
           'conf_loss': 0.012618967,
           'precision50': 0.73298144,
           'recall50': 0.5348532},
     'AP': 0.3295648,
     'AP50': 0.50497925,
     'AP75': 0.3484999,
     'APl': 0.48317707,
     'APm': 0.3311254,
     'APs': 0.109705076,
     'ARl': 0.6829844,
     'ARm': 0.5478751,
     'ARmax1': 0.29493493,
     'ARmax10': 0.47493547,
     'ARmax100': 0.5159726,
     'ARs': 0.26351058,
     'global': {'total_loss': 0.08936229},
     'validation_loss': 0.08936229}
train | step:  200000 | training until step 220000...
train | step:  210000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.6105973,
           'avg_obj': 0.19669318,
           'box_loss': 0.01543546,
           'class_loss': 0.0074464614,
           'conf_loss': 0.028878385,
           'precision50': 0.45850942,
           'recall50': 0.1098947},
     '4': {'avg_iou': 0.7425508,
           'avg_obj': 0.35324165,
           'box_loss': 0.01146101,
           'class_loss': 0.0062733823,
           'conf_loss': 0.024892291,
           'precision50': 0.68286276,
           'recall50': 0.31925133},
     '5': {'avg_iou': 0.8039283,
           'avg_obj': 0.4924493,
           'box_loss': 0.008991794,
           'class_loss': 0.0052214717,
           'conf_loss': 0.01574596,
           'precision50': 0.7810873,
           'recall50': 0.52975297},
     'global': {'total_loss': 0.99476737},
     'learning_rate': 0.005157283,
     'training_loss': 0.99476737}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-210000.
train | step:  220000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.61265856,
           'avg_obj': 0.20001492,
           'box_loss': 0.015329908,
           'class_loss': 0.0073228967,
           'conf_loss': 0.028657984,
           'precision50': 0.46262226,
           'recall50': 0.113268286},
     '4': {'avg_iou': 0.7449587,
           'avg_obj': 0.35757142,
           'box_loss': 0.0113327885,
           'class_loss': 0.006137645,
           'conf_loss': 0.024689725,
           'precision50': 0.6854831,
           'recall50': 0.32471374},
     '5': {'avg_iou': 0.8061662,
           'avg_obj': 0.49677408,
           'box_loss': 0.008878976,
           'class_loss': 0.0051008905,
           'conf_loss': 0.015626783,
           'precision50': 0.7831992,
           'recall50': 0.5359621},
     'global': {'total_loss': 0.98461944},
     'learning_rate': 0.0048287087,
     'training_loss': 0.98461944}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-220000.
 eval | step:  220000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=173.34s).
Accumulating evaluation results...
DONE (t=16.82s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.336
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.513
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.356
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.112
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.338
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.494
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.296
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.478
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.520
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.266
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.555
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.688
 eval | step:  220000 | eval time:  496.0 sec | output: 
    {'3': {'avg_iou': 0.47174633,
           'avg_obj': 0.15390942,
           'box_loss': 0.01070187,
           'class_loss': 0.004333263,
           'conf_loss': 0.018323312,
           'precision50': 0.3441448,
           'recall50': 0.11805519},
     '4': {'avg_iou': 0.6960783,
           'avg_obj': 0.33726636,
           'box_loss': 0.009794557,
           'class_loss': 0.004250767,
           'conf_loss': 0.016461035,
           'precision50': 0.59326863,
           'recall50': 0.32923797},
     '5': {'avg_iou': 0.7827571,
           'avg_obj': 0.5038897,
           'box_loss': 0.008197558,
           'class_loss': 0.0037927688,
           'conf_loss': 0.012538414,
           'precision50': 0.73625284,
           'recall50': 0.543869},
     'AP': 0.33583036,
     'AP50': 0.51313186,
     'AP75': 0.35577694,
     'APl': 0.49412706,
     'APm': 0.33847287,
     'APs': 0.11191163,
     'ARl': 0.6877716,
     'ARm': 0.55508274,
     'ARmax1': 0.29576755,
     'ARmax10': 0.47834045,
     'ARmax100': 0.5198081,
     'ARs': 0.26635066,
     'global': {'total_loss': 0.08839352},
     'validation_loss': 0.08839352}I0522 02:43:49.558876 140256446252864 controller.py:211] train | step:  220000 | training until step 240000...
I0522 04:11:28.903946 140256446252864 controller.py:425] train | step:  230000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6142343,
           'avg_obj': 0.20276773,
           'box_loss': 0.015257936,
           'class_loss': 0.0072143828,
           'conf_loss': 0.028565265,
           'precision50': 0.4674499,
           'recall50': 0.116346896},
     '4': {'avg_iou': 0.7468523,
           'avg_obj': 0.36157355,
           'box_loss': 0.0112345675,
           'class_loss': 0.0060219965,
           'conf_loss': 0.02455688,
           'precision50': 0.688514,
           'recall50': 0.33052883},
     '5': {'avg_iou': 0.8081203,
           'avg_obj': 0.50114465,
           'box_loss': 0.008777232,
           'class_loss': 0.0049936967,
           'conf_loss': 0.015527515,
           'precision50': 0.7852943,
           'recall50': 0.5412948},
     'global': {'total_loss': 0.97719735},
     'learning_rate': 0.004508574,
     'training_loss': 0.97719735}
I0522 04:12:15.781951 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-230000.
I0522 05:43:45.327212 140256446252864 controller.py:425] train | step:  240000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.615896,
           'avg_obj': 0.20562832,
           'box_loss': 0.015213635,
           'class_loss': 0.0071221148,
           'conf_loss': 0.028498612,
           'precision50': 0.47133887,
           'recall50': 0.119217515},
     '4': {'avg_iou': 0.74876213,
           'avg_obj': 0.36547244,
           'box_loss': 0.011145434,
           'class_loss': 0.0059275087,
           'conf_loss': 0.024438854,
           'precision50': 0.6913923,
           'recall50': 0.33541822},
     '5': {'avg_iou': 0.80999446,
           'avg_obj': 0.50504506,
           'box_loss': 0.0086929,
           'class_loss': 0.0049165213,
           'conf_loss': 0.015422049,
           'precision50': 0.7865665,
           'recall50': 0.54556507},
     'global': {'total_loss': 0.9710218},
     'learning_rate': 0.0041991845,
     'training_loss': 0.9710218}
I0522 05:44:32.666443 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-240000.
I0522 05:44:32.671834 140256446252864 controller.py:252]  eval | step:  240000 | running 625 steps of evaluation...
I0522 05:48:40.665580 140256446252864 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0522 05:52:41.496829 140256446252864 controller.py:261]  eval | step:  240000 | eval time:  488.8 sec | output: 
    {'3': {'avg_iou': 0.47313565,
           'avg_obj': 0.15868314,
           'box_loss': 0.010634122,
           'class_loss': 0.0042244853,
           'conf_loss': 0.018266467,
           'precision50': 0.34917125,
           'recall50': 0.12377506},
     '4': {'avg_iou': 0.6981615,
           'avg_obj': 0.3424024,
           'box_loss': 0.009689464,
           'class_loss': 0.0041623744,
           'conf_loss': 0.016397975,
           'precision50': 0.5980177,
           'recall50': 0.3367994},
     '5': {'avg_iou': 0.7842189,
           'avg_obj': 0.50655663,
           'box_loss': 0.008123353,
           'class_loss': 0.0037652208,
           'conf_loss': 0.012522768,
           'precision50': 0.73829436,
           'recall50': 0.54793084},
     'AP': 0.34144875,
     'AP50': 0.52001995,
     'AP75': 0.3636459,
     'APl': 0.49931946,
     'APm': 0.34519675,
     'APs': 0.12133758,
     'ARl': 0.6918115,
     'ARm': 0.56061214,
     'ARmax1': 0.29814824,
     'ARmax10': 0.48409364,
     'ARmax100': 0.52514166,
     'ARs': 0.28079104,
     'global': {'total_loss': 0.0877862},
     'validation_loss': 0.0877862}
I0522 05:53:02.243394 140256446252864 controller.py:211] train | step:  240000 | training until step 260000...
I0522 07:21:14.941058 140256446252864 controller.py:425] train | step:  250000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6174195,
           'avg_obj': 0.20823313,
           'box_loss': 0.0151274,
           'class_loss': 0.0070170774,
           'conf_loss': 0.02835039,
           'precision50': 0.47599596,
           'recall50': 0.12220348},
     '4': {'avg_iou': 0.7506086,
           'avg_obj': 0.3695611,
           'box_loss': 0.011051615,
           'class_loss': 0.0058164545,
           'conf_loss': 0.024265913,
           'precision50': 0.6943751,
           'recall50': 0.34106317},
     '5': {'avg_iou': 0.8116753,
           'avg_obj': 0.50924,
           'box_loss': 0.008603394,
           'class_loss': 0.0048064417,
           'conf_loss': 0.015291195,
           'precision50': 0.78883636,
           'recall50': 0.55141884},
     'global': {'total_loss': 0.9626413},
     'learning_rate': 0.0039027706,
     'training_loss': 0.9626413}
I0522 07:22:03.351180 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-250000.
I0522 08:53:50.586331 140256446252864 controller.py:425] train | step:  260000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6187978,
           'avg_obj': 0.2105844,
           'box_loss': 0.015059621,
           'class_loss': 0.0069392435,
           'conf_loss': 0.028258719,
           'precision50': 0.47810313,
           'recall50': 0.12407057},
     '4': {'avg_iou': 0.7523769,
           'avg_obj': 0.37289384,
           'box_loss': 0.010969193,
           'class_loss': 0.0057345754,
           'conf_loss': 0.024168884,
           'precision50': 0.6960832,
           'recall50': 0.3451658},
     '5': {'avg_iou': 0.8133865,
           'avg_obj': 0.5131437,
           'box_loss': 0.008522407,
           'class_loss': 0.0047245733,
           'conf_loss': 0.0152124725,
           'precision50': 0.79171306,
           'recall50': 0.556328},
     'global': {'total_loss': 0.95671916},
     'learning_rate': 0.0036214672,
     'training_loss': 0.95671916}
I0522 08:54:45.785640 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-260000.
I0522 08:54:45.791613 140256446252864 controller.py:252]  eval | step:  260000 | running 625 steps of evaluation...
I0522 08:58:51.713014 140256446252864 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0522 09:03:07.251484 140256446252864 controller.py:261]  eval | step:  260000 | eval time:  501.5 sec | output: 
    {'3': {'avg_iou': 0.47455195,
           'avg_obj': 0.15964909,
           'box_loss': 0.0105623435,
           'class_loss': 0.0041308994,
           'conf_loss': 0.01816493,
           'precision50': 0.35004342,
           'recall50': 0.1253891},
     '4': {'avg_iou': 0.69997996,
           'avg_obj': 0.3474359,
           'box_loss': 0.0095966235,
           'class_loss': 0.0040782313,
           'conf_loss': 0.01631073,
           'precision50': 0.6029009,
           'recall50': 0.34479105},
     '5': {'avg_iou': 0.78578633,
           'avg_obj': 0.51420957,
           'box_loss': 0.008044728,
           'class_loss': 0.003670683,
           'conf_loss': 0.01243508,
           'precision50': 0.7388852,
           'recall50': 0.55578923},
     'AP': 0.34597418,
     'AP50': 0.5252852,
     'AP75': 0.3683108,
     'APl': 0.5061138,
     'APm': 0.34911928,
     'APs': 0.1200401,
     'ARl': 0.69739383,
     'ARm': 0.5626293,
     'ARmax1': 0.30229676,
     'ARmax10': 0.4871915,
     'ARmax100': 0.5300143,
     'ARs': 0.27783075,
     'global': {'total_loss': 0.08699425},
     'validation_loss': 0.08699425}

train | step:  220000 | training until step 240000...
train | step:  230000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6142343,
           'avg_obj': 0.20276773,
           'box_loss': 0.015257936,
           'class_loss': 0.0072143828,
           'conf_loss': 0.028565265,
           'precision50': 0.4674499,
           'recall50': 0.116346896},
     '4': {'avg_iou': 0.7468523,
           'avg_obj': 0.36157355,
           'box_loss': 0.0112345675,
           'class_loss': 0.0060219965,
           'conf_loss': 0.02455688,
           'precision50': 0.688514,
           'recall50': 0.33052883},
     '5': {'avg_iou': 0.8081203,
           'avg_obj': 0.50114465,
           'box_loss': 0.008777232,
           'class_loss': 0.0049936967,
           'conf_loss': 0.015527515,
           'precision50': 0.7852943,
           'recall50': 0.5412948},
     'global': {'total_loss': 0.97719735},
     'learning_rate': 0.004508574,
     'training_loss': 0.97719735}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-230000.
train | step:  240000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.615896,
           'avg_obj': 0.20562832,
           'box_loss': 0.015213635,
           'class_loss': 0.0071221148,
           'conf_loss': 0.028498612,
           'precision50': 0.47133887,
           'recall50': 0.119217515},
     '4': {'avg_iou': 0.74876213,
           'avg_obj': 0.36547244,
           'box_loss': 0.011145434,
           'class_loss': 0.0059275087,
           'conf_loss': 0.024438854,
           'precision50': 0.6913923,
           'recall50': 0.33541822},
     '5': {'avg_iou': 0.80999446,
           'avg_obj': 0.50504506,
           'box_loss': 0.0086929,
           'class_loss': 0.0049165213,
           'conf_loss': 0.015422049,
           'precision50': 0.7865665,
           'recall50': 0.54556507},
     'global': {'total_loss': 0.9710218},
     'learning_rate': 0.0041991845,
     'training_loss': 0.9710218}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-240000.
 eval | step:  240000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=171.15s).
Accumulating evaluation results...
DONE (t=16.62s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.341
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.520
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.364
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.121
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.345
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.499
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.298
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.484
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.525
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.281
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.561
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.692
 eval | step:  240000 | eval time:  488.8 sec | output: 
    {'3': {'avg_iou': 0.47313565,
           'avg_obj': 0.15868314,
           'box_loss': 0.010634122,
           'class_loss': 0.0042244853,
           'conf_loss': 0.018266467,
           'precision50': 0.34917125,
           'recall50': 0.12377506},
     '4': {'avg_iou': 0.6981615,
           'avg_obj': 0.3424024,
           'box_loss': 0.009689464,
           'class_loss': 0.0041623744,
           'conf_loss': 0.016397975,
           'precision50': 0.5980177,
           'recall50': 0.3367994},
     '5': {'avg_iou': 0.7842189,
           'avg_obj': 0.50655663,
           'box_loss': 0.008123353,
           'class_loss': 0.0037652208,
           'conf_loss': 0.012522768,
           'precision50': 0.73829436,
           'recall50': 0.54793084},
     'AP': 0.34144875,
     'AP50': 0.52001995,
     'AP75': 0.3636459,
     'APl': 0.49931946,
     'APm': 0.34519675,
     'APs': 0.12133758,
     'ARl': 0.6918115,
     'ARm': 0.56061214,
     'ARmax1': 0.29814824,
     'ARmax10': 0.48409364,
     'ARmax100': 0.52514166,
     'ARs': 0.28079104,
     'global': {'total_loss': 0.0877862},
     'validation_loss': 0.0877862}
train | step:  240000 | training until step 260000...
train | step:  250000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6174195,
           'avg_obj': 0.20823313,
           'box_loss': 0.0151274,
           'class_loss': 0.0070170774,
           'conf_loss': 0.02835039,
           'precision50': 0.47599596,
           'recall50': 0.12220348},
     '4': {'avg_iou': 0.7506086,
           'avg_obj': 0.3695611,
           'box_loss': 0.011051615,
           'class_loss': 0.0058164545,
           'conf_loss': 0.024265913,
           'precision50': 0.6943751,
           'recall50': 0.34106317},
     '5': {'avg_iou': 0.8116753,
           'avg_obj': 0.50924,
           'box_loss': 0.008603394,
           'class_loss': 0.0048064417,
           'conf_loss': 0.015291195,
           'precision50': 0.78883636,
           'recall50': 0.55141884},
     'global': {'total_loss': 0.9626413},
     'learning_rate': 0.0039027706,
     'training_loss': 0.9626413}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-250000.
train | step:  260000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6187978,
           'avg_obj': 0.2105844,
           'box_loss': 0.015059621,
           'class_loss': 0.0069392435,
           'conf_loss': 0.028258719,
           'precision50': 0.47810313,
           'recall50': 0.12407057},
     '4': {'avg_iou': 0.7523769,
           'avg_obj': 0.37289384,
           'box_loss': 0.010969193,
           'class_loss': 0.0057345754,
           'conf_loss': 0.024168884,
           'precision50': 0.6960832,
           'recall50': 0.3451658},
     '5': {'avg_iou': 0.8133865,
           'avg_obj': 0.5131437,
           'box_loss': 0.008522407,
           'class_loss': 0.0047245733,
           'conf_loss': 0.0152124725,
           'precision50': 0.79171306,
           'recall50': 0.556328},
     'global': {'total_loss': 0.95671916},
     'learning_rate': 0.0036214672,
     'training_loss': 0.95671916}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-260000.
 eval | step:  260000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=172.60s).
Accumulating evaluation results...
DONE (t=15.52s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.346
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.525
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.368
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.120
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.349
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.506
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.302
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.487
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.530
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.278
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.563
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.697
 eval | step:  260000 | eval time:  501.5 sec | output: 
    {'3': {'avg_iou': 0.47455195,
           'avg_obj': 0.15964909,
           'box_loss': 0.0105623435,
           'class_loss': 0.0041308994,
           'conf_loss': 0.01816493,
           'precision50': 0.35004342,
           'recall50': 0.1253891},
     '4': {'avg_iou': 0.69997996,
           'avg_obj': 0.3474359,
           'box_loss': 0.0095966235,
           'class_loss': 0.0040782313,
           'conf_loss': 0.01631073,
           'precision50': 0.6029009,
           'recall50': 0.34479105},
     '5': {'avg_iou': 0.78578633,
           'avg_obj': 0.51420957,
           'box_loss': 0.008044728,
           'class_loss': 0.003670683,
           'conf_loss': 0.01243508,
           'precision50': 0.7388852,
           'recall50': 0.55578923},
     'AP': 0.34597418,
     'AP50': 0.5252852,
     'AP75': 0.3683108,
     'APl': 0.5061138,
     'APm': 0.34911928,
     'APs': 0.1200401,
     'ARl': 0.69739383,
     'ARm': 0.5626293,
     'ARmax1': 0.30229676,
     'ARmax10': 0.4871915,
     'ARmax100': 0.5300143,
     'ARs': 0.27783075,
     'global': {'total_loss': 0.08699425},
     'validation_loss': 0.08699425}I0522 09:03:25.661852 140256446252864 controller.py:211] train | step:  260000 | training until step 280000...
I0522 10:30:58.982329 140256446252864 controller.py:425] train | step:  270000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6202799,
           'avg_obj': 0.21293974,
           'box_loss': 0.0149999205,
           'class_loss': 0.0068511055,
           'conf_loss': 0.028138403,
           'precision50': 0.481378,
           'recall50': 0.12648578},
     '4': {'avg_iou': 0.7538567,
           'avg_obj': 0.3756458,
           'box_loss': 0.010879652,
           'class_loss': 0.005634783,
           'conf_loss': 0.02405832,
           'precision50': 0.6979225,
           'recall50': 0.3489953},
     '5': {'avg_iou': 0.81485516,
           'avg_obj': 0.5163538,
           'box_loss': 0.008439071,
           'class_loss': 0.00464483,
           'conf_loss': 0.015120989,
           'precision50': 0.79185593,
           'recall50': 0.5599669},
     'global': {'total_loss': 0.95013595},
     'learning_rate': 0.003357301,
     'training_loss': 0.95013595}
I0522 10:31:48.302736 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-270000.
I0522 12:04:52.422027 140256446252864 controller.py:425] train | step:  280000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.62153596,
           'avg_obj': 0.21521783,
           'box_loss': 0.014975238,
           'class_loss': 0.006787957,
           'conf_loss': 0.02814226,
           'precision50': 0.48620117,
           'recall50': 0.12926453},
     '4': {'avg_iou': 0.7556251,
           'avg_obj': 0.379327,
           'box_loss': 0.010809143,
           'class_loss': 0.005564381,
           'conf_loss': 0.02401935,
           'precision50': 0.7015142,
           'recall50': 0.35409287},
     '5': {'avg_iou': 0.8161623,
           'avg_obj': 0.5196341,
           'box_loss': 0.008377071,
           'class_loss': 0.0045924014,
           'conf_loss': 0.015068979,
           'precision50': 0.7939993,
           'recall50': 0.5642722},
     'global': {'total_loss': 0.94669616},
     'learning_rate': 0.003112175,
     'training_loss': 0.94669616}
I0522 12:05:39.418554 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-280000.
I0522 12:05:39.424094 140256446252864 controller.py:252]  eval | step:  280000 | running 625 steps of evaluation...
I0522 12:09:46.572510 140256446252864 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0522 12:13:56.004025 140256446252864 controller.py:261]  eval | step:  280000 | eval time:  496.6 sec | output: 
    {'3': {'avg_iou': 0.47539333,
           'avg_obj': 0.16105217,
           'box_loss': 0.0105198305,
           'class_loss': 0.0040699183,
           'conf_loss': 0.018139623,
           'precision50': 0.3560793,
           'recall50': 0.12772015},
     '4': {'avg_iou': 0.70081913,
           'avg_obj': 0.3502073,
           'box_loss': 0.009553914,
           'class_loss': 0.004016933,
           'conf_loss': 0.016263438,
           'precision50': 0.60418653,
           'recall50': 0.34909204},
     '5': {'avg_iou': 0.78648174,
           'avg_obj': 0.517731,
           'box_loss': 0.00800692,
           'class_loss': 0.0036524555,
           'conf_loss': 0.0124099525,
           'precision50': 0.7369216,
           'recall50': 0.5603798},
     'AP': 0.34979415,
     'AP50': 0.5305555,
     'AP75': 0.37046942,
     'APl': 0.50932956,
     'APm': 0.3537313,
     'APs': 0.12242618,
     'ARl': 0.69591266,
     'ARm': 0.564209,
     'ARmax1': 0.30498207,
     'ARmax10': 0.4894458,
     'ARmax100': 0.53086776,
     'ARs': 0.28018734,
     'global': {'total_loss': 0.08663295},
     'validation_loss': 0.08663295}
I0522 12:14:19.357768 140256446252864 controller.py:211] train | step:  280000 | training until step 300000...
I0522 13:38:10.049526 140256446252864 controller.py:425] train | step:  290000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6227722,
           'avg_obj': 0.21768047,
           'box_loss': 0.014898407,
           'class_loss': 0.006690393,
           'conf_loss': 0.028054345,
           'precision50': 0.48952374,
           'recall50': 0.13169728},
     '4': {'avg_iou': 0.75696343,
           'avg_obj': 0.38249093,
           'box_loss': 0.010740352,
           'class_loss': 0.0054798094,
           'conf_loss': 0.02389111,
           'precision50': 0.7027704,
           'recall50': 0.35774773},
     '5': {'avg_iou': 0.8174899,
           'avg_obj': 0.5224679,
           'box_loss': 0.008315291,
           'class_loss': 0.0045163017,
           'conf_loss': 0.014980055,
           'precision50': 0.7952164,
           'recall50': 0.5678877},
     'global': {'total_loss': 0.9405288},
     'learning_rate': 0.002887857,
     'training_loss': 0.9405288}
I0522 13:38:59.780640 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-290000.
I0522 15:13:16.326475 140256446252864 controller.py:425] train | step:  300000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.62405705,
           'avg_obj': 0.21941608,
           'box_loss': 0.014835541,
           'class_loss': 0.006622894,
           'conf_loss': 0.027913999,
           'precision50': 0.49038506,
           'recall50': 0.13360353},
     '4': {'avg_iou': 0.7581151,
           'avg_obj': 0.3849312,
           'box_loss': 0.010676191,
           'class_loss': 0.005411541,
           'conf_loss': 0.023764601,
           'precision50': 0.70421857,
           'recall50': 0.3611765},
     '5': {'avg_iou': 0.8188125,
           'avg_obj': 0.5256463,
           'box_loss': 0.008247205,
           'class_loss': 0.0044460697,
           'conf_loss': 0.014891515,
           'precision50': 0.7964298,
           'recall50': 0.5712622},
     'global': {'total_loss': 0.93447775},
     'learning_rate': 0.002685961,
     'training_loss': 0.93447775}
I0522 15:14:04.380217 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-300000.
I0522 15:14:04.386093 140256446252864 controller.py:252]  eval | step:  300000 | running 625 steps of evaluation...
I0522 15:18:05.671979 140256446252864 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0522 15:22:09.364938 140256446252864 controller.py:261]  eval | step:  300000 | eval time:  485.0 sec | output: 
    {'3': {'avg_iou': 0.47620815,
           'avg_obj': 0.1639075,
           'box_loss': 0.010479326,
           'class_loss': 0.004016628,
           'conf_loss': 0.018112617,
           'precision50': 0.36050093,
           'recall50': 0.13190955},
     '4': {'avg_iou': 0.70146036,
           'avg_obj': 0.35461596,
           'box_loss': 0.009521749,
           'class_loss': 0.003988779,
           'conf_loss': 0.016238878,
           'precision50': 0.6100964,
           'recall50': 0.35605693},
     '5': {'avg_iou': 0.7869311,
           'avg_obj': 0.52107996,
           'box_loss': 0.007987358,
           'class_loss': 0.0036033036,
           'conf_loss': 0.012407519,
           'precision50': 0.73875153,
           'recall50': 0.565339},
     'AP': 0.35185567,
     'AP50': 0.5325572,
     'AP75': 0.37310162,
     'APl': 0.5112181,
     'APm': 0.357546,
     'APs': 0.12736295,
     'ARl': 0.69810957,
     'ARm': 0.5654188,
     'ARmax1': 0.3041682,
     'ARmax10': 0.49132764,
     'ARmax100': 0.5321838,
     'ARs': 0.28408265,
     'global': {'total_loss': 0.08635616},
     'validation_loss': 0.08635616}

train | step:  260000 | training until step 280000...
train | step:  270000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6202799,
           'avg_obj': 0.21293974,
           'box_loss': 0.0149999205,
           'class_loss': 0.0068511055,
           'conf_loss': 0.028138403,
           'precision50': 0.481378,
           'recall50': 0.12648578},
     '4': {'avg_iou': 0.7538567,
           'avg_obj': 0.3756458,
           'box_loss': 0.010879652,
           'class_loss': 0.005634783,
           'conf_loss': 0.02405832,
           'precision50': 0.6979225,
           'recall50': 0.3489953},
     '5': {'avg_iou': 0.81485516,
           'avg_obj': 0.5163538,
           'box_loss': 0.008439071,
           'class_loss': 0.00464483,
           'conf_loss': 0.015120989,
           'precision50': 0.79185593,
           'recall50': 0.5599669},
     'global': {'total_loss': 0.95013595},
     'learning_rate': 0.003357301,
     'training_loss': 0.95013595}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-270000.
train | step:  280000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.62153596,
           'avg_obj': 0.21521783,
           'box_loss': 0.014975238,
           'class_loss': 0.006787957,
           'conf_loss': 0.02814226,
           'precision50': 0.48620117,
           'recall50': 0.12926453},
     '4': {'avg_iou': 0.7556251,
           'avg_obj': 0.379327,
           'box_loss': 0.010809143,
           'class_loss': 0.005564381,
           'conf_loss': 0.02401935,
           'precision50': 0.7015142,
           'recall50': 0.35409287},
     '5': {'avg_iou': 0.8161623,
           'avg_obj': 0.5196341,
           'box_loss': 0.008377071,
           'class_loss': 0.0045924014,
           'conf_loss': 0.015068979,
           'precision50': 0.7939993,
           'recall50': 0.5642722},
     'global': {'total_loss': 0.94669616},
     'learning_rate': 0.003112175,
     'training_loss': 0.94669616}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-280000.
 eval | step:  280000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=173.41s).
Accumulating evaluation results...
DONE (t=15.37s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.350
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.531
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.370
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.122
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.354
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.509
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.305
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.489
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.531
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.280
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.564
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.696
 eval | step:  280000 | eval time:  496.6 sec | output: 
    {'3': {'avg_iou': 0.47539333,
           'avg_obj': 0.16105217,
           'box_loss': 0.0105198305,
           'class_loss': 0.0040699183,
           'conf_loss': 0.018139623,
           'precision50': 0.3560793,
           'recall50': 0.12772015},
     '4': {'avg_iou': 0.70081913,
           'avg_obj': 0.3502073,
           'box_loss': 0.009553914,
           'class_loss': 0.004016933,
           'conf_loss': 0.016263438,
           'precision50': 0.60418653,
           'recall50': 0.34909204},
     '5': {'avg_iou': 0.78648174,
           'avg_obj': 0.517731,
           'box_loss': 0.00800692,
           'class_loss': 0.0036524555,
           'conf_loss': 0.0124099525,
           'precision50': 0.7369216,
           'recall50': 0.5603798},
     'AP': 0.34979415,
     'AP50': 0.5305555,
     'AP75': 0.37046942,
     'APl': 0.50932956,
     'APm': 0.3537313,
     'APs': 0.12242618,
     'ARl': 0.69591266,
     'ARm': 0.564209,
     'ARmax1': 0.30498207,
     'ARmax10': 0.4894458,
     'ARmax100': 0.53086776,
     'ARs': 0.28018734,
     'global': {'total_loss': 0.08663295},
     'validation_loss': 0.08663295}
train | step:  280000 | training until step 300000...
train | step:  290000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6227722,
           'avg_obj': 0.21768047,
           'box_loss': 0.014898407,
           'class_loss': 0.006690393,
           'conf_loss': 0.028054345,
           'precision50': 0.48952374,
           'recall50': 0.13169728},
     '4': {'avg_iou': 0.75696343,
           'avg_obj': 0.38249093,
           'box_loss': 0.010740352,
           'class_loss': 0.0054798094,
           'conf_loss': 0.02389111,
           'precision50': 0.7027704,
           'recall50': 0.35774773},
     '5': {'avg_iou': 0.8174899,
           'avg_obj': 0.5224679,
           'box_loss': 0.008315291,
           'class_loss': 0.0045163017,
           'conf_loss': 0.014980055,
           'precision50': 0.7952164,
           'recall50': 0.5678877},
     'global': {'total_loss': 0.9405288},
     'learning_rate': 0.002887857,
     'training_loss': 0.9405288}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-290000.
train | step:  300000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.62405705,
           'avg_obj': 0.21941608,
           'box_loss': 0.014835541,
           'class_loss': 0.006622894,
           'conf_loss': 0.027913999,
           'precision50': 0.49038506,
           'recall50': 0.13360353},
     '4': {'avg_iou': 0.7581151,
           'avg_obj': 0.3849312,
           'box_loss': 0.010676191,
           'class_loss': 0.005411541,
           'conf_loss': 0.023764601,
           'precision50': 0.70421857,
           'recall50': 0.3611765},
     '5': {'avg_iou': 0.8188125,
           'avg_obj': 0.5256463,
           'box_loss': 0.008247205,
           'class_loss': 0.0044460697,
           'conf_loss': 0.014891515,
           'precision50': 0.7964298,
           'recall50': 0.5712622},
     'global': {'total_loss': 0.93447775},
     'learning_rate': 0.002685961,
     'training_loss': 0.93447775}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-300000.
 eval | step:  300000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=173.25s).
Accumulating evaluation results...
DONE (t=15.43s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.352
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.533
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.373
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.127
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.358
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.511
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.304
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.532
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.284
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.565
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.698
 eval | step:  300000 | eval time:  485.0 sec | output: 
    {'3': {'avg_iou': 0.47620815,
           'avg_obj': 0.1639075,
           'box_loss': 0.010479326,
           'class_loss': 0.004016628,
           'conf_loss': 0.018112617,
           'precision50': 0.36050093,
           'recall50': 0.13190955},
     '4': {'avg_iou': 0.70146036,
           'avg_obj': 0.35461596,
           'box_loss': 0.009521749,
           'class_loss': 0.003988779,
           'conf_loss': 0.016238878,
           'precision50': 0.6100964,
           'recall50': 0.35605693},
     '5': {'avg_iou': 0.7869311,
           'avg_obj': 0.52107996,
           'box_loss': 0.007987358,
           'class_loss': 0.0036033036,
           'conf_loss': 0.012407519,
           'precision50': 0.73875153,
           'recall50': 0.565339},
     'AP': 0.35185567,
     'AP50': 0.5325572,
     'AP75': 0.37310162,
     'APl': 0.5112181,
     'APm': 0.357546,
     'APs': 0.12736295,
     'ARl': 0.69810957,
     'ARm': 0.5654188,
     'ARmax1': 0.3041682,
     'ARmax10': 0.49132764,
     'ARmax100': 0.5321838,
     'ARs': 0.28408265,
     'global': {'total_loss': 0.08635616},
     'validation_loss': 0.08635616}I0522 15:22:27.883946 140256446252864 controller.py:211] train | step:  300000 | training until step 320000...
I0522 16:50:39.259509 140256446252864 controller.py:425] train | step:  310000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6245494,
           'avg_obj': 0.22080642,
           'box_loss': 0.014809465,
           'class_loss': 0.0065542953,
           'conf_loss': 0.027903587,
           'precision50': 0.4931854,
           'recall50': 0.13510321},
     '4': {'avg_iou': 0.75919336,
           'avg_obj': 0.38753578,
           'box_loss': 0.010620761,
           'class_loss': 0.0053417096,
           'conf_loss': 0.023715751,
           'precision50': 0.70627224,
           'recall50': 0.36441976},
     '5': {'avg_iou': 0.8199059,
           'avg_obj': 0.5287439,
           'box_loss': 0.008196412,
           'class_loss': 0.004396089,
           'conf_loss': 0.014819315,
           'precision50': 0.7977738,
           'recall50': 0.5745776},
     'global': {'total_loss': 0.93085635},
     'learning_rate': 0.0025079434,
     'training_loss': 0.93085635}
I0522 16:51:28.086657 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-310000.
I0522 18:26:35.654847 140256446252864 controller.py:425] train | step:  320000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6259612,
           'avg_obj': 0.22266294,
           'box_loss': 0.014770548,
           'class_loss': 0.006510478,
           'conf_loss': 0.027816262,
           'precision50': 0.4955918,
           'recall50': 0.13710222},
     '4': {'avg_iou': 0.7605356,
           'avg_obj': 0.38978097,
           'box_loss': 0.010572157,
           'class_loss': 0.005288319,
           'conf_loss': 0.023656428,
           'precision50': 0.7085532,
           'recall50': 0.36798188},
     '5': {'avg_iou': 0.82090694,
           'avg_obj': 0.53072625,
           'box_loss': 0.008142481,
           'class_loss': 0.004342277,
           'conf_loss': 0.0147952,
           'precision50': 0.7983913,
           'recall50': 0.577247},
     'global': {'total_loss': 0.927152},
     'learning_rate': 0.002355086,
     'training_loss': 0.927152}
I0522 18:27:23.653138 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-320000.
I0522 18:27:23.658892 140256446252864 controller.py:252]  eval | step:  320000 | running 625 steps of evaluation...
I0522 18:31:24.226133 140256446252864 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0522 18:35:35.484315 140256446252864 controller.py:261]  eval | step:  320000 | eval time:  491.8 sec | output: 
    {'3': {'avg_iou': 0.47701186,
           'avg_obj': 0.16797873,
           'box_loss': 0.010439899,
           'class_loss': 0.0039763334,
           'conf_loss': 0.018105995,
           'precision50': 0.36664858,
           'recall50': 0.13778108},
     '4': {'avg_iou': 0.7023358,
           'avg_obj': 0.35954106,
           'box_loss': 0.009477284,
           'class_loss': 0.003957723,
           'conf_loss': 0.016223624,
           'precision50': 0.610785,
           'recall50': 0.36404043},
     '5': {'avg_iou': 0.78799665,
           'avg_obj': 0.5245457,
           'box_loss': 0.007933789,
           'class_loss': 0.0036187568,
           'conf_loss': 0.012402765,
           'precision50': 0.7399621,
           'recall50': 0.568565},
     'AP': 0.3537825,
     'AP50': 0.53447825,
     'AP75': 0.37694377,
     'APl': 0.5153666,
     'APm': 0.35866183,
     'APs': 0.13309385,
     'ARl': 0.69862086,
     'ARm': 0.56825066,
     'ARmax1': 0.30366895,
     'ARmax10': 0.49362952,
     'ARmax100': 0.5344963,
     'ARs': 0.30091825,
     'global': {'total_loss': 0.08613616},
     'validation_loss': 0.08613616}
I0522 18:35:53.603212 140256446252864 controller.py:211] train | step:  320000 | training until step 340000...
I0522 20:05:47.335637 140256446252864 controller.py:425] train | step:  330000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6265372,
           'avg_obj': 0.2243731,
           'box_loss': 0.014704549,
           'class_loss': 0.006431601,
           'conf_loss': 0.027683878,
           'precision50': 0.4975455,
           'recall50': 0.13877475},
     '4': {'avg_iou': 0.76143205,
           'avg_obj': 0.3922602,
           'box_loss': 0.010512993,
           'class_loss': 0.0052283397,
           'conf_loss': 0.023497919,
           'precision50': 0.7091776,
           'recall50': 0.37102565},
     '5': {'avg_iou': 0.8218124,
           'avg_obj': 0.53323674,
           'box_loss': 0.0080965925,
           'class_loss': 0.004290218,
           'conf_loss': 0.014692929,
           'precision50': 0.7996763,
           'recall50': 0.5802581},
     'global': {'total_loss': 0.92111194},
     'learning_rate': 0.0022284898,
     'training_loss': 0.92111194}
I0522 20:06:37.247610 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-330000.
I0522 21:41:18.279450 140256446252864 controller.py:425] train | step:  340000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6273418,
           'avg_obj': 0.22598581,
           'box_loss': 0.0146909775,
           'class_loss': 0.006389271,
           'conf_loss': 0.027653301,
           'precision50': 0.5003107,
           'recall50': 0.14071336},
     '4': {'avg_iou': 0.7624264,
           'avg_obj': 0.39462882,
           'box_loss': 0.010465676,
           'class_loss': 0.00518011,
           'conf_loss': 0.023450647,
           'precision50': 0.7106507,
           'recall50': 0.3741117},
     '5': {'avg_iou': 0.8226577,
           'avg_obj': 0.53543264,
           'box_loss': 0.008052199,
           'class_loss': 0.004241491,
           'conf_loss': 0.014651667,
           'precision50': 0.80081326,
           'recall50': 0.5831889},
     'global': {'total_loss': 0.9182043},
     'learning_rate': 0.0021290681,
     'training_loss': 0.9182043}
I0522 21:42:05.656074 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-340000.
I0522 21:42:05.661691 140256446252864 controller.py:252]  eval | step:  340000 | running 625 steps of evaluation...
I0522 21:46:15.084078 140256446252864 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0522 21:50:25.581582 140256446252864 controller.py:261]  eval | step:  340000 | eval time:  499.9 sec | output: 
    {'3': {'avg_iou': 0.47718945,
           'avg_obj': 0.16838768,
           'box_loss': 0.010431443,
           'class_loss': 0.003959639,
           'conf_loss': 0.018116828,
           'precision50': 0.36588702,
           'recall50': 0.13915344},
     '4': {'avg_iou': 0.70244545,
           'avg_obj': 0.3591541,
           'box_loss': 0.009471627,
           'class_loss': 0.0039392295,
           'conf_loss': 0.01627561,
           'precision50': 0.60798776,
           'recall50': 0.3629525},
     '5': {'avg_iou': 0.78726196,
           'avg_obj': 0.5230474,
           'box_loss': 0.007967926,
           'class_loss': 0.003628275,
           'conf_loss': 0.012474039,
           'precision50': 0.7394807,
           'recall50': 0.5673219},
     'AP': 0.35462233,
     'AP50': 0.5368222,
     'AP75': 0.37601632,
     'APl': 0.5140402,
     'APm': 0.3601916,
     'APs': 0.13232669,
     'ARl': 0.6989426,
     'ARm': 0.56769085,
     'ARmax1': 0.30536535,
     'ARmax10': 0.49482077,
     'ARmax100': 0.53533155,
     'ARs': 0.29711977,
     'global': {'total_loss': 0.08626462},
     'validation_loss': 0.08626462}

train | step:  300000 | training until step 320000...
train | step:  310000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6245494,
           'avg_obj': 0.22080642,
           'box_loss': 0.014809465,
           'class_loss': 0.0065542953,
           'conf_loss': 0.027903587,
           'precision50': 0.4931854,
           'recall50': 0.13510321},
     '4': {'avg_iou': 0.75919336,
           'avg_obj': 0.38753578,
           'box_loss': 0.010620761,
           'class_loss': 0.0053417096,
           'conf_loss': 0.023715751,
           'precision50': 0.70627224,
           'recall50': 0.36441976},
     '5': {'avg_iou': 0.8199059,
           'avg_obj': 0.5287439,
           'box_loss': 0.008196412,
           'class_loss': 0.004396089,
           'conf_loss': 0.014819315,
           'precision50': 0.7977738,
           'recall50': 0.5745776},
     'global': {'total_loss': 0.93085635},
     'learning_rate': 0.0025079434,
     'training_loss': 0.93085635}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-310000.
train | step:  320000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6259612,
           'avg_obj': 0.22266294,
           'box_loss': 0.014770548,
           'class_loss': 0.006510478,
           'conf_loss': 0.027816262,
           'precision50': 0.4955918,
           'recall50': 0.13710222},
     '4': {'avg_iou': 0.7605356,
           'avg_obj': 0.38978097,
           'box_loss': 0.010572157,
           'class_loss': 0.005288319,
           'conf_loss': 0.023656428,
           'precision50': 0.7085532,
           'recall50': 0.36798188},
     '5': {'avg_iou': 0.82090694,
           'avg_obj': 0.53072625,
           'box_loss': 0.008142481,
           'class_loss': 0.004342277,
           'conf_loss': 0.0147952,
           'precision50': 0.7983913,
           'recall50': 0.577247},
     'global': {'total_loss': 0.927152},
     'learning_rate': 0.002355086,
     'training_loss': 0.927152}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-320000.
 eval | step:  320000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.20s).
Accumulating evaluation results...
DONE (t=15.38s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.354
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.534
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.377
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.133
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.359
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.515
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.304
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.494
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.534
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.301
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.568
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.699
 eval | step:  320000 | eval time:  491.8 sec | output: 
    {'3': {'avg_iou': 0.47701186,
           'avg_obj': 0.16797873,
           'box_loss': 0.010439899,
           'class_loss': 0.0039763334,
           'conf_loss': 0.018105995,
           'precision50': 0.36664858,
           'recall50': 0.13778108},
     '4': {'avg_iou': 0.7023358,
           'avg_obj': 0.35954106,
           'box_loss': 0.009477284,
           'class_loss': 0.003957723,
           'conf_loss': 0.016223624,
           'precision50': 0.610785,
           'recall50': 0.36404043},
     '5': {'avg_iou': 0.78799665,
           'avg_obj': 0.5245457,
           'box_loss': 0.007933789,
           'class_loss': 0.0036187568,
           'conf_loss': 0.012402765,
           'precision50': 0.7399621,
           'recall50': 0.568565},
     'AP': 0.3537825,
     'AP50': 0.53447825,
     'AP75': 0.37694377,
     'APl': 0.5153666,
     'APm': 0.35866183,
     'APs': 0.13309385,
     'ARl': 0.69862086,
     'ARm': 0.56825066,
     'ARmax1': 0.30366895,
     'ARmax10': 0.49362952,
     'ARmax100': 0.5344963,
     'ARs': 0.30091825,
     'global': {'total_loss': 0.08613616},
     'validation_loss': 0.08613616}
train | step:  320000 | training until step 340000...
train | step:  330000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6265372,
           'avg_obj': 0.2243731,
           'box_loss': 0.014704549,
           'class_loss': 0.006431601,
           'conf_loss': 0.027683878,
           'precision50': 0.4975455,
           'recall50': 0.13877475},
     '4': {'avg_iou': 0.76143205,
           'avg_obj': 0.3922602,
           'box_loss': 0.010512993,
           'class_loss': 0.0052283397,
           'conf_loss': 0.023497919,
           'precision50': 0.7091776,
           'recall50': 0.37102565},
     '5': {'avg_iou': 0.8218124,
           'avg_obj': 0.53323674,
           'box_loss': 0.0080965925,
           'class_loss': 0.004290218,
           'conf_loss': 0.014692929,
           'precision50': 0.7996763,
           'recall50': 0.5802581},
     'global': {'total_loss': 0.92111194},
     'learning_rate': 0.0022284898,
     'training_loss': 0.92111194}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-330000.
train | step:  340000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6273418,
           'avg_obj': 0.22598581,
           'box_loss': 0.0146909775,
           'class_loss': 0.006389271,
           'conf_loss': 0.027653301,
           'precision50': 0.5003107,
           'recall50': 0.14071336},
     '4': {'avg_iou': 0.7624264,
           'avg_obj': 0.39462882,
           'box_loss': 0.010465676,
           'class_loss': 0.00518011,
           'conf_loss': 0.023450647,
           'precision50': 0.7106507,
           'recall50': 0.3741117},
     '5': {'avg_iou': 0.8226577,
           'avg_obj': 0.53543264,
           'box_loss': 0.008052199,
           'class_loss': 0.004241491,
           'conf_loss': 0.014651667,
           'precision50': 0.80081326,
           'recall50': 0.5831889},
     'global': {'total_loss': 0.9182043},
     'learning_rate': 0.0021290681,
     'training_loss': 0.9182043}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-340000.
 eval | step:  340000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.23s).
Accumulating evaluation results...
DONE (t=15.67s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.355
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.537
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.376
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.132
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.360
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.514
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.305
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.495
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.535
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.297
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.568
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.699
 eval | step:  340000 | eval time:  499.9 sec | output: 
    {'3': {'avg_iou': 0.47718945,
           'avg_obj': 0.16838768,
           'box_loss': 0.010431443,
           'class_loss': 0.003959639,
           'conf_loss': 0.018116828,
           'precision50': 0.36588702,
           'recall50': 0.13915344},
     '4': {'avg_iou': 0.70244545,
           'avg_obj': 0.3591541,
           'box_loss': 0.009471627,
           'class_loss': 0.0039392295,
           'conf_loss': 0.01627561,
           'precision50': 0.60798776,
           'recall50': 0.3629525},
     '5': {'avg_iou': 0.78726196,
           'avg_obj': 0.5230474,
           'box_loss': 0.007967926,
           'class_loss': 0.003628275,
           'conf_loss': 0.012474039,
           'precision50': 0.7394807,
           'recall50': 0.5673219},
     'AP': 0.35462233,
     'AP50': 0.5368222,
     'AP75': 0.37601632,
     'APl': 0.5140402,
     'APm': 0.3601916,
     'APs': 0.13232669,
     'ARl': 0.6989426,
     'ARm': 0.56769085,
     'ARmax1': 0.30536535,
     'ARmax10': 0.49482077,
     'ARmax100': 0.53533155,
     'ARs': 0.29711977,
     'global': {'total_loss': 0.08626462},
     'validation_loss': 0.08626462}I0522 21:50:43.543627 140256446252864 controller.py:211] train | step:  340000 | training until step 360000...
I0522 23:18:54.947594 140256446252864 controller.py:425] train | step:  350000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.62817776,
           'avg_obj': 0.22734888,
           'box_loss': 0.014660587,
           'class_loss': 0.006350614,
           'conf_loss': 0.027601156,
           'precision50': 0.50196075,
           'recall50': 0.1421959},
     '4': {'avg_iou': 0.76324713,
           'avg_obj': 0.3964893,
           'box_loss': 0.010427721,
           'class_loss': 0.005136278,
           'conf_loss': 0.023392398,
           'precision50': 0.7122231,
           'recall50': 0.37674165},
     '5': {'avg_iou': 0.8235503,
           'avg_obj': 0.5374765,
           'box_loss': 0.008013967,
           'class_loss': 0.0042094905,
           'conf_loss': 0.014593533,
           'precision50': 0.8015463,
           'recall50': 0.5855608},
     'global': {'total_loss': 0.91508675},
     'learning_rate': 0.0020575363,
     'training_loss': 0.91508675}
I0522 23:19:41.632427 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-350000.
I0523 00:52:02.227656 140256446252864 controller.py:425] train | step:  360000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6285857,
           'avg_obj': 0.22873628,
           'box_loss': 0.014647055,
           'class_loss': 0.0063285776,
           'conf_loss': 0.027597388,
           'precision50': 0.5034414,
           'recall50': 0.14357156},
     '4': {'avg_iou': 0.763838,
           'avg_obj': 0.39781561,
           'box_loss': 0.01039999,
           'class_loss': 0.005106113,
           'conf_loss': 0.02335514,
           'precision50': 0.71358484,
           'recall50': 0.3788457},
     '5': {'avg_iou': 0.82400525,
           'avg_obj': 0.5389964,
           'box_loss': 0.007989573,
           'class_loss': 0.004180475,
           'conf_loss': 0.014549614,
           'precision50': 0.80283123,
           'recall50': 0.58773357},
     'global': {'total_loss': 0.9132297},
     'learning_rate': 0.00201441,
     'training_loss': 0.9132297}
I0523 00:52:49.228367 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-360000.
I0523 00:52:49.234996 140256446252864 controller.py:252]  eval | step:  360000 | running 625 steps of evaluation...
I0523 00:56:49.067346 140256446252864 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0523 01:00:57.552205 140256446252864 controller.py:261]  eval | step:  360000 | eval time:  488.3 sec | output: 
    {'3': {'avg_iou': 0.47770244,
           'avg_obj': 0.16736567,
           'box_loss': 0.010402972,
           'class_loss': 0.0039254143,
           'conf_loss': 0.018082336,
           'precision50': 0.36486626,
           'recall50': 0.13911146},
     '4': {'avg_iou': 0.7026711,
           'avg_obj': 0.36054936,
           'box_loss': 0.009459604,
           'class_loss': 0.0038860673,
           'conf_loss': 0.01621778,
           'precision50': 0.6111162,
           'recall50': 0.36582637},
     '5': {'avg_iou': 0.7878035,
           'avg_obj': 0.52629304,
           'box_loss': 0.007943594,
           'class_loss': 0.003600736,
           'conf_loss': 0.012426778,
           'precision50': 0.73684007,
           'recall50': 0.570361},
     'AP': 0.35429522,
     'AP50': 0.53657305,
     'AP75': 0.37592962,
     'APl': 0.5158137,
     'APm': 0.3611903,
     'APs': 0.13308567,
     'ARl': 0.7017672,
     'ARm': 0.5690607,
     'ARmax1': 0.30587038,
     'ARmax10': 0.4949813,
     'ARmax100': 0.5363187,
     'ARs': 0.2967062,
     'global': {'total_loss': 0.085945256},
     'validation_loss': 0.085945256}
I0523 01:01:21.209938 140256446252864 controller.py:211] train | step:  360000 | training until step 375000...
I0523 02:29:28.625579 140256446252864 controller.py:425] train | step:  370000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.62949455,
           'avg_obj': 0.22943118,
           'box_loss': 0.014593082,
           'class_loss': 0.0062770084,
           'conf_loss': 0.02749627,
           'precision50': 0.5040305,
           'recall50': 0.14423594},
     '4': {'avg_iou': 0.76438034,
           'avg_obj': 0.3990248,
           'box_loss': 0.010361857,
           'class_loss': 0.0050609745,
           'conf_loss': 0.023289965,
           'precision50': 0.71360016,
           'recall50': 0.38019928},
     '5': {'avg_iou': 0.8245473,
           'avg_obj': 0.5403132,
           'box_loss': 0.007958315,
           'class_loss': 0.0041513713,
           'conf_loss': 0.014516013,
           'precision50': 0.80308175,
           'recall50': 0.5891122},
     'global': {'total_loss': 0.90963817},
     'learning_rate': 0.002,
     'training_loss': 0.90963817}
I0523 02:30:15.994308 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-370000.
I0523 03:17:30.726302 140256446252864 controller.py:425] train | step:  375000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6297961,
           'avg_obj': 0.23028108,
           'box_loss': 0.014583129,
           'class_loss': 0.006254701,
           'conf_loss': 0.027417146,
           'precision50': 0.50518143,
           'recall50': 0.14523728},
     '4': {'avg_iou': 0.76495993,
           'avg_obj': 0.40058354,
           'box_loss': 0.010347185,
           'class_loss': 0.0050385944,
           'conf_loss': 0.023213737,
           'precision50': 0.71479553,
           'recall50': 0.3821624},
     '5': {'avg_iou': 0.8250919,
           'avg_obj': 0.54148674,
           'box_loss': 0.00792981,
           'class_loss': 0.0041353977,
           'conf_loss': 0.014476027,
           'precision50': 0.8042296,
           'recall50': 0.59124714},
     'global': {'total_loss': 0.9071652},
     'learning_rate': 0.002,
     'training_loss': 0.9071652}
I0523 03:17:43.277236 140256446252864 controller.py:252]  eval | step:  375000 | running 625 steps of evaluation...
I0523 03:21:50.868110 140256446252864 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0523 03:25:50.872582 140256446252864 controller.py:261]  eval | step:  375000 | eval time:  487.6 sec | output: 
    {'3': {'avg_iou': 0.4782608,
           'avg_obj': 0.17044158,
           'box_loss': 0.010374696,
           'class_loss': 0.0038822857,
           'conf_loss': 0.01807134,
           'precision50': 0.36891896,
           'recall50': 0.14260301},
     '4': {'avg_iou': 0.70329756,
           'avg_obj': 0.36321622,
           'box_loss': 0.009429746,
           'class_loss': 0.0038728355,
           'conf_loss': 0.016239818,
           'precision50': 0.60986245,
           'recall50': 0.36963627},
     '5': {'avg_iou': 0.78859144,
           'avg_obj': 0.5278148,
           'box_loss': 0.007904729,
           'class_loss': 0.0036037655,
           'conf_loss': 0.012430039,
           'precision50': 0.73940355,
           'recall50': 0.5726361},
     'AP': 0.35706204,
     'AP50': 0.5397714,
     'AP75': 0.3771,
     'APl': 0.5180741,
     'APm': 0.3627059,
     'APs': 0.13136959,
     'ARl': 0.7011838,
     'ARm': 0.570764,
     'ARmax1': 0.3078639,
     'ARmax10': 0.49689057,
     'ARmax100': 0.5379568,
     'ARs': 0.29813814,
     'global': {'total_loss': 0.08580927},
     'validation_loss': 0.08580927}

train | step:  340000 | training until step 360000...
train | step:  350000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.62817776,
           'avg_obj': 0.22734888,
           'box_loss': 0.014660587,
           'class_loss': 0.006350614,
           'conf_loss': 0.027601156,
           'precision50': 0.50196075,
           'recall50': 0.1421959},
     '4': {'avg_iou': 0.76324713,
           'avg_obj': 0.3964893,
           'box_loss': 0.010427721,
           'class_loss': 0.005136278,
           'conf_loss': 0.023392398,
           'precision50': 0.7122231,
           'recall50': 0.37674165},
     '5': {'avg_iou': 0.8235503,
           'avg_obj': 0.5374765,
           'box_loss': 0.008013967,
           'class_loss': 0.0042094905,
           'conf_loss': 0.014593533,
           'precision50': 0.8015463,
           'recall50': 0.5855608},
     'global': {'total_loss': 0.91508675},
     'learning_rate': 0.0020575363,
     'training_loss': 0.91508675}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-350000.
train | step:  360000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6285857,
           'avg_obj': 0.22873628,
           'box_loss': 0.014647055,
           'class_loss': 0.0063285776,
           'conf_loss': 0.027597388,
           'precision50': 0.5034414,
           'recall50': 0.14357156},
     '4': {'avg_iou': 0.763838,
           'avg_obj': 0.39781561,
           'box_loss': 0.01039999,
           'class_loss': 0.005106113,
           'conf_loss': 0.02335514,
           'precision50': 0.71358484,
           'recall50': 0.3788457},
     '5': {'avg_iou': 0.82400525,
           'avg_obj': 0.5389964,
           'box_loss': 0.007989573,
           'class_loss': 0.004180475,
           'conf_loss': 0.014549614,
           'precision50': 0.80283123,
           'recall50': 0.58773357},
     'global': {'total_loss': 0.9132297},
     'learning_rate': 0.00201441,
     'training_loss': 0.9132297}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-360000.
 eval | step:  360000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.49s).
Accumulating evaluation results...
DONE (t=14.88s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.354
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.537
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.376
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.133
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.361
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.516
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.306
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.495
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.536
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.297
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.569
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.702
 eval | step:  360000 | eval time:  488.3 sec | output: 
    {'3': {'avg_iou': 0.47770244,
           'avg_obj': 0.16736567,
           'box_loss': 0.010402972,
           'class_loss': 0.0039254143,
           'conf_loss': 0.018082336,
           'precision50': 0.36486626,
           'recall50': 0.13911146},
     '4': {'avg_iou': 0.7026711,
           'avg_obj': 0.36054936,
           'box_loss': 0.009459604,
           'class_loss': 0.0038860673,
           'conf_loss': 0.01621778,
           'precision50': 0.6111162,
           'recall50': 0.36582637},
     '5': {'avg_iou': 0.7878035,
           'avg_obj': 0.52629304,
           'box_loss': 0.007943594,
           'class_loss': 0.003600736,
           'conf_loss': 0.012426778,
           'precision50': 0.73684007,
           'recall50': 0.570361},
     'AP': 0.35429522,
     'AP50': 0.53657305,
     'AP75': 0.37592962,
     'APl': 0.5158137,
     'APm': 0.3611903,
     'APs': 0.13308567,
     'ARl': 0.7017672,
     'ARm': 0.5690607,
     'ARmax1': 0.30587038,
     'ARmax10': 0.4949813,
     'ARmax100': 0.5363187,
     'ARs': 0.2967062,
     'global': {'total_loss': 0.085945256},
     'validation_loss': 0.085945256}
train | step:  360000 | training until step 375000...
train | step:  370000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.62949455,
           'avg_obj': 0.22943118,
           'box_loss': 0.014593082,
           'class_loss': 0.0062770084,
           'conf_loss': 0.02749627,
           'precision50': 0.5040305,
           'recall50': 0.14423594},
     '4': {'avg_iou': 0.76438034,
           'avg_obj': 0.3990248,
           'box_loss': 0.010361857,
           'class_loss': 0.0050609745,
           'conf_loss': 0.023289965,
           'precision50': 0.71360016,
           'recall50': 0.38019928},
     '5': {'avg_iou': 0.8245473,
           'avg_obj': 0.5403132,
           'box_loss': 0.007958315,
           'class_loss': 0.0041513713,
           'conf_loss': 0.014516013,
           'precision50': 0.80308175,
           'recall50': 0.5891122},
     'global': {'total_loss': 0.90963817},
     'learning_rate': 0.002,
     'training_loss': 0.90963817}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-370000.
train | step:  375000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6297961,
           'avg_obj': 0.23028108,
           'box_loss': 0.014583129,
           'class_loss': 0.006254701,
           'conf_loss': 0.027417146,
           'precision50': 0.50518143,
           'recall50': 0.14523728},
     '4': {'avg_iou': 0.76495993,
           'avg_obj': 0.40058354,
           'box_loss': 0.010347185,
           'class_loss': 0.0050385944,
           'conf_loss': 0.023213737,
           'precision50': 0.71479553,
           'recall50': 0.3821624},
     '5': {'avg_iou': 0.8250919,
           'avg_obj': 0.54148674,
           'box_loss': 0.00792981,
           'class_loss': 0.0041353977,
           'conf_loss': 0.014476027,
           'precision50': 0.8042296,
           'recall50': 0.59124714},
     'global': {'total_loss': 0.9071652},
     'learning_rate': 0.002,
     'training_loss': 0.9071652}
 eval | step:  375000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=172.79s).
Accumulating evaluation results...
DONE (t=15.07s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.357
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.540
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.377
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.131
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.363
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.518
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.308
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.497
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.538
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.298
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.571
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.701
 eval | step:  375000 | eval time:  487.6 sec | output: 
    {'3': {'avg_iou': 0.4782608,
           'avg_obj': 0.17044158,
           'box_loss': 0.010374696,
           'class_loss': 0.0038822857,
           'conf_loss': 0.01807134,
           'precision50': 0.36891896,
           'recall50': 0.14260301},
     '4': {'avg_iou': 0.70329756,
           'avg_obj': 0.36321622,
           'box_loss': 0.009429746,
           'class_loss': 0.0038728355,
           'conf_loss': 0.016239818,
           'precision50': 0.60986245,
           'recall50': 0.36963627},
     '5': {'avg_iou': 0.78859144,
           'avg_obj': 0.5278148,
           'box_loss': 0.007904729,
           'class_loss': 0.0036037655,
           'conf_loss': 0.012430039,
           'precision50': 0.73940355,
           'recall50': 0.5726361},
     'AP': 0.35706204,
     'AP50': 0.5397714,
     'AP75': 0.3771,
     'APl': 0.5180741,
     'APm': 0.3627059,
     'APs': 0.13136959,
     'ARl': 0.7011838,
     'ARm': 0.570764,
     'ARmax1': 0.3078639,
     'ARmax10': 0.49689057,
     'ARmax100': 0.5379568,
     'ARs': 0.29813814,
     'global': {'total_loss': 0.08580927},
     'validation_loss': 0.08580927}I0523 03:26:45.521057 140256446252864 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-375000.
I0523 03:26:45.537484 140256446252864 train_lib.py:123] Number of trainable params in model: 53.066944 Millions.

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-19/ckpt-375000.
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     12   1253 --:--:-- --:--:-- --:--:--  1272
okRequest issued for: [node-4]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-23T03:33:25.178164410Z'
  endTime: '2021-05-23T03:34:13.528966943Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621740805167-5c2f6f49c1a02-94bb360a-d09dd560
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.117.66.216/29
  createTime: '2021-03-13T04:41:22.291533178Z'
  health: HEALTHY
  ipAddress: 10.117.66.218
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.117.66.218
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621740805167-5c2f6f49c1a02-94bb360a-d09dd560] to complete...
............................................................................................................................................................................................................................................................................done.
