cat: .experiment_zone: No such file or directory
Request issued for: [node-7]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620971779114-5c243e715c5b8-2dd57579-7b3975d6] to complete...
...........................................................................................failed.
ERROR: (gcloud.compute.tpus.start) {
  "code": 8,
  "message": "There is no more capacity in the zone \"europe-west4-a\"; you can try in another zone where Cloud TPU Nodes are offered (see https://cloud.google.com/tpu/docs/regions) [EID: 0x5cacb63e9508fdc5]"
}
europe-west4-a
I0514 05:51:26.731743 140190123194176 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0514 05:51:26.732933 140190123194176 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/params.yaml
I0514 05:51:28.366577 140190123194176 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0514 05:51:28.989915 140190123194176 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0514 05:51:28.990243 140190123194176 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-7" is not yet ready; state: "STOPPED"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     12   1268 --:--:-- --:--:-- --:--:--  1288
okRequest issued for: [node-7]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-14T05:56:44.333179211Z'
  endTime: '2021-05-14T05:56:55.500130949Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620971804319-5c243e8966049-7daf2ed6-a1757695
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.124.160.48/29
  createTime: '2021-03-18T03:10:27.166064884Z'
  health: HEALTHY
  ipAddress: 10.124.160.50
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.124.160.50
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620971804319-5c243e8966049-7daf2ed6-a1757695] to complete...
................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-7]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-14T05:57:12.524308340Z'
  endTime: '2021-05-14T05:57:48.325095528Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620971832510-5c243ea4489c6-9b4d9432-01f2da73
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.124.160.48/29
  createTime: '2021-03-18T03:10:27.166064884Z'
  health: HEALTHY
  ipAddress: 10.124.160.50
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.124.160.50
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620971832510-5c243ea4489c6-9b4d9432-01f2da73] to complete...
...............................................................................................................................................................................................done.
europe-west4-a
I0514 05:52:39.698886 140402429237056 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0514 05:52:39.699782 140402429237056 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/params.yaml
I0514 05:52:40.525517 140402429237056 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0514 05:52:40.668730 140402429237056 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0514 05:52:40.668985 140402429237056 transport.py:157] Attempting refresh to obtain initial access_token
I0514 05:52:40.729749 140402429237056 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0514 05:52:41.349073 140402429237056 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0514 05:52:41.349362 140402429237056 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-14 05:52:41.408721: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0514 05:52:41.409508 140402429237056 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0514 05:52:41.546842 140402429237056 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0514 05:52:41.547338 140402429237056 transport.py:157] Attempting refresh to obtain initial access_token
I0514 05:52:41.611073 140402429237056 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0514 05:52:41.752511 140402429237056 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0514 05:52:41.752782 140402429237056 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-14 05:52:41.799585: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-14 05:52:41.825391: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.124.160.50:8470}
2021-05-14 05:52:41.825471: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:49498}
2021-05-14 05:53:20.269403: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.124.160.50:8470}
2021-05-14 05:53:20.269561: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:49498}
2021-05-14 05:53:20.270127: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:49498
I0514 05:53:20.271028 140402429237056 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-7
I0514 05:53:20.272316 140402429237056 tpu_strategy_util.py:74] Initializing the TPU system: node-7
INFO:tensorflow:Clearing out eager caches
I0514 05:53:27.456049 140402429237056 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0514 05:53:27.458059 140402429237056 tpu_strategy_util.py:133] Finished initializing TPU system.
I0514 05:53:27.459351 140402429237056 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0514 05:53:28.076623 140402429237056 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0514 05:53:28.076991 140402429237056 transport.py:157] Attempting refresh to obtain initial access_token
I0514 05:53:28.159225 140402429237056 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0514 05:53:28.302913 140402429237056 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0514 05:53:28.303162 140402429237056 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0514 05:53:28.348498 140402429237056 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0514 05:53:28.348745 140402429237056 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0514 05:53:28.349022 140402429237056 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0514 05:53:28.349075 140402429237056 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0514 05:53:28.349128 140402429237056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0514 05:53:28.349262 140402429237056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0514 05:53:28.349312 140402429237056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0514 05:53:28.349379 140402429237056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0514 05:53:28.349423 140402429237056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0514 05:53:28.349466 140402429237056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0514 05:53:28.349512 140402429237056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0514 05:53:28.349557 140402429237056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0514 05:53:28.349600 140402429237056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0514 05:53:28.349645 140402429237056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0514 05:53:28.349690 140402429237056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0514 05:53:28.349736 140402429237056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0514 05:53:28.351304 140402429237056 train_utils.py:214] Running default trainer.
2021-05-14 05:53:28.380511: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7fb19415d710>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________
yolo_fpn (YoloFPN)              {'5': (None, 16, 16, 9626112     input_2[0][0]                    
                                                                 input_3[0][0]                    I0514 05:54:14.926826 140402429237056 controller.py:362] restoring or initializing model...
I0514 05:54:22.678491 140402429237056 yolo.py:542] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0514 05:54:22.680572 140402429237056 controller.py:368] initialized model.
I0514 05:54:22.680778 140402429237056 train_lib.py:96] Starts to execute mode: train_and_eval
I0514 05:54:22.685858 140402429237056 controller.py:211] train | step:      0 | training until step 20000...
I0514 05:54:28.798012 140402429237056 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0514 05:55:15.103835 140402429237056 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
cat: .experiment_zone: No such file or directory
Request issued for: [node-3]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-14T06:02:31.140750955Z'
  endTime: '2021-05-14T06:03:07.646771311Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620972151127-5c243fd423e46-5a983ed4-fb45d187
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620972151127-5c243fd423e46-5a983ed4-fb45d187] to complete...
...................................................................................................................................................................................................done.
europe-west4-a
I0514 05:57:59.458762 139707232925504 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[12.0, 16.0]',
                              '[19.0, 36.0]',
                              '[40.0, 28.0]',
                              '[36.0, 75.0]',
                              '[76.0, 55.0]',
                              '[72.0, 146.0]',
                              '[142.0, 110.0]',
                              '[192.0, 243.0]',
                              '[459.0, 401.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'input_size': [512, 512, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.1,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 2.0,
                                    'aug_scale_min': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 2.0,
                                         'aug_scale_min': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0514 05:57:59.460175 139707232925504 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/params.yaml
I0514 05:58:00.417077 139707232925504 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0514 05:58:00.559644 139707232925504 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0514 05:58:00.559966 139707232925504 transport.py:157] Attempting refresh to obtain initial access_token
I0514 05:58:00.620777 139707232925504 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0514 05:58:00.762030 139707232925504 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0514 05:58:00.762290 139707232925504 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-14 05:58:00.826222: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0514 05:58:00.826834 139707232925504 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0514 05:58:00.966262 139707232925504 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0514 05:58:00.966522 139707232925504 transport.py:157] Attempting refresh to obtain initial access_token
I0514 05:58:01.021279 139707232925504 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0514 05:58:01.164820 139707232925504 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0514 05:58:01.165329 139707232925504 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-14 05:58:01.209902: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-14 05:58:01.220947: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-05-14 05:58:01.221238: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:49748}
/home/cam2tensorflow/.experiment_start.sh: line 22: 19748 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4-$5
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   208    0     0  100   208      0   1004 --:--:-- --:--:-- --:--:--  1000100   210    0     2  100   208      7    796 --:--:-- --:--:-- --:--:--   804
okRequest issued for: [node-3]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-14T06:04:05.197013060Z'
  endTime: '2021-05-14T06:04:28.962482068Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620972245182-5c24402dd670f-3884bde3-811f65be
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620972245182-5c24402dd670f-3884bde3-811f65be] to complete...
..................................................................................................................................done.
I0514 07:53:51.288202 140402429237056 controller.py:425] train | step:  10000 | steps/sec:    1.4 | output: 
    {'3': {'avg_iou': 0.5014832,
           'avg_obj': 0.11076238,
           'box_loss': 1.241021,
           'class_loss': 0.05944851,
           'conf_loss': 0.19802256,
           'precision50': 0.174492,
           'recall50': 0.03738284},
     '4': {'avg_iou': 0.5760543,
           'avg_obj': 0.18141332,
           'box_loss': 1.0056105,
           'class_loss': 0.066450626,
           'conf_loss': 0.068336956,
           'precision50': 0.368936,
           'recall50': 0.09250813},
     '5': {'avg_iou': 0.59321886,
           'avg_obj': 0.25510854,
           'box_loss': 0.48321053,
           'class_loss': 0.057742592,
           'conf_loss': 0.039582174,
           'precision50': 0.46851015,
           'recall50': 0.18177252},
     'global': {'total_loss': 25.755388},
     'learning_rate': 0.009985589,
     'training_loss': 25.755388}
I0514 07:54:43.355730 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-10000.
I0514 09:35:03.488577 140402429237056 controller.py:425] train | step:  20000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.45186305,
           'avg_obj': 0.01756393,
           'box_loss': 1.351501,
           'class_loss': 0.020657888,
           'conf_loss': 0.038650993,
           'precision50': 0.002871076,
           'recall50': 0.00013783475},
     '4': {'avg_iou': 0.5302165,
           'avg_obj': 0.04821172,
           'box_loss': 1.1118516,
           'class_loss': 0.023087004,
           'conf_loss': 0.035349738,
           'precision50': 0.025170296,
           'recall50': 0.0019851273},
     '5': {'avg_iou': 0.5844421,
           'avg_obj': 0.10234291,
           'box_loss': 0.49356937,
           'class_loss': 0.022468565,
           'conf_loss': 0.025015688,
           'precision50': 0.10166444,
           'recall50': 0.0128558865},
     'global': {'total_loss': 24.97717},
     'learning_rate': 0.009942464,
     'training_loss': 24.97717}
I0514 09:35:48.280200 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-20000.
I0514 09:35:48.285461 140402429237056 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0514 09:35:49.044188 140402429237056 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0514 09:36:08.279520 140402429237056 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0514 09:41:01.016058 140402429237056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0514 09:43:56.413214 140402429237056 controller.py:261]  eval | step:  20000 | eval time:  488.1 sec | output: 
    {'3': {'avg_iou': 0.3496708,
           'avg_obj': 0.007615742,
           'box_loss': 0.72675896,
           'class_loss': 0.016481733,
           'conf_loss': 0.025373472,
           'precision50': 0.0,
           'recall50': 0.0},
     '4': {'avg_iou': 0.49674454,
           'avg_obj': 0.011629013,
           'box_loss': 0.6949358,
           'class_loss': 0.022079641,
           'conf_loss': 0.02663655,
           'precision50': 0.0,
           'recall50': 0.0},
     '5': {'avg_iou': 0.5459004,
           'avg_obj': 0.021886732,
           'box_loss': 0.39170852,
           'class_loss': 0.022119282,
           'conf_loss': 0.022537468,
           'precision50': 0.0,
           'recall50': 0.0},
     'AP': 0.0012687204,
     'AP50': 0.0030777017,
     'AP75': 0.0009903173,
     'APl': 0.0034016152,
     'APm': 0.0014268095,
     'APs': 0.0010552097,
     'ARl': 0.039799966,
     'ARm': 0.016885297,
     'ARmax1': 0.016791034,
     'ARmax10': 0.028408183,
     'ARmax100': 0.030221574,
     'ARs': 0.00638964,
     'global': {'total_loss': 1.9486308},
     'validation_loss': 1.9486308}

                                                                 input_4[0][0]                    
__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'3': (None, 64, 64, 16271360    yolo_fpn[0][0]                   
                                                                 yolo_fpn[0][1]                   
                                                                 yolo_fpn[0][2]                   
==================================================================================================
Total params: 25,897,472
Trainable params: 25,867,520
Non-trainable params: 29,952
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 400, 8), 5: (8, 200, 8)}, inds: {3: (8, 600, 3), 4: (8, 400, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
train | step:  10000 | steps/sec:    1.4 | output: 
    {'3': {'avg_iou': 0.5014832,
           'avg_obj': 0.11076238,
           'box_loss': 1.241021,
           'class_loss': 0.05944851,
           'conf_loss': 0.19802256,
           'precision50': 0.174492,
           'recall50': 0.03738284},
     '4': {'avg_iou': 0.5760543,
           'avg_obj': 0.18141332,
           'box_loss': 1.0056105,
           'class_loss': 0.066450626,
           'conf_loss': 0.068336956,
           'precision50': 0.368936,
           'recall50': 0.09250813},
     '5': {'avg_iou': 0.59321886,
           'avg_obj': 0.25510854,
           'box_loss': 0.48321053,
           'class_loss': 0.057742592,
           'conf_loss': 0.039582174,
           'precision50': 0.46851015,
           'recall50': 0.18177252},
     'global': {'total_loss': 25.755388},
     'learning_rate': 0.009985589,
     'training_loss': 25.755388}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-10000.
train | step:  20000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.45186305,
           'avg_obj': 0.01756393,
           'box_loss': 1.351501,
           'class_loss': 0.020657888,
           'conf_loss': 0.038650993,
           'precision50': 0.002871076,
           'recall50': 0.00013783475},
     '4': {'avg_iou': 0.5302165,
           'avg_obj': 0.04821172,
           'box_loss': 1.1118516,
           'class_loss': 0.023087004,
           'conf_loss': 0.035349738,
           'precision50': 0.025170296,
           'recall50': 0.0019851273},
     '5': {'avg_iou': 0.5844421,
           'avg_obj': 0.10234291,
           'box_loss': 0.49356937,
           'class_loss': 0.022468565,
           'conf_loss': 0.025015688,
           'precision50': 0.10166444,
           'recall50': 0.0128558865},
     'global': {'total_loss': 24.97717},
     'learning_rate': 0.009942464,
     'training_loss': 24.97717}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-20000.
 eval | step:  20000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=104.32s).
Accumulating evaluation results...
DONE (t=15.94s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.001
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.003
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.001
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.001
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.001
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.003
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.017
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.028
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.030
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.006
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.017
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.040
 eval | step:  20000 | eval time:  488.1 sec | output: 
    {'3': {'avg_iou': 0.3496708,
           'avg_obj': 0.007615742,
           'box_loss': 0.72675896,
           'class_loss': 0.016481733,
           'conf_loss': 0.025373472,
           'precision50': 0.0,
           'recall50': 0.0},
     '4': {'avg_iou': 0.49674454,
           'avg_obj': 0.011629013,
           'box_loss': 0.6949358,
           'class_loss': 0.022079641,
           'conf_loss': 0.02663655,
           'precision50': 0.0,
           'recall50': 0.0},
     '5': {'avg_iou': 0.5459004,
           'avg_obj': 0.021886732,
           'box_loss': 0.39170852,
           'class_loss': 0.022119282,
           'conf_loss': 0.022537468,
           'precision50': 0.0,
           'recall50': 0.0},
     'AP': 0.0012687204,
     'AP50': 0.0030777017,
     'AP75': 0.0009903173,
     'APl': 0.0034016152,
     'APm': 0.0014268095,
     'APs': 0.0010552097,
     'ARl': 0.039799966,
     'ARm': 0.016885297,
     'ARmax1': 0.016791034,
     'ARmax10': 0.028408183,
     'ARmax100': 0.030221574,
     'ARs': 0.00638964,
     'global': {'total_loss': 1.9486308},
     'validation_loss': 1.9486308}I0514 09:44:19.612460 140402429237056 controller.py:211] train | step:  20000 | training until step 40000...
I0514 11:21:16.045863 140402429237056 controller.py:425] train | step:  30000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.5023529,
           'avg_obj': 0.040773794,
           'box_loss': 1.2354503,
           'class_loss': 0.020024884,
           'conf_loss': 0.03735317,
           'precision50': 0.03095504,
           'recall50': 0.0017607807},
     '4': {'avg_iou': 0.59984845,
           'avg_obj': 0.099195115,
           'box_loss': 0.9515572,
           'class_loss': 0.022005504,
           'conf_loss': 0.03424535,
           'precision50': 0.18549685,
           'recall50': 0.020215547},
     '5': {'avg_iou': 0.6512726,
           'avg_obj': 0.17812847,
           'box_loss': 0.41520956,
           'class_loss': 0.020631319,
           'conf_loss': 0.023463733,
           'precision50': 0.3648479,
           'recall50': 0.072860986},
     'global': {'total_loss': 22.079535},
     'learning_rate': 0.0098709315,
     'training_loss': 22.079535}
I0514 11:22:01.552607 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-30000.
I0514 12:57:13.353170 140402429237056 controller.py:425] train | step:  40000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5221929,
           'avg_obj': 0.055137675,
           'box_loss': 1.1897407,
           'class_loss': 0.01949586,
           'conf_loss': 0.036734723,
           'precision50': 0.080563195,
           'recall50': 0.0053887526},
     '4': {'avg_iou': 0.62496036,
           'avg_obj': 0.12635043,
           'box_loss': 0.8937456,
           'class_loss': 0.021089494,
           'conf_loss': 0.03345975,
           'precision50': 0.301052,
           'recall50': 0.04032334},
     '5': {'avg_iou': 0.67596877,
           'avg_obj': 0.21322292,
           'box_loss': 0.3868536,
           'class_loss': 0.019280229,
           'conf_loss': 0.022766875,
           'precision50': 0.46208575,
           'recall50': 0.120055065},
     'global': {'total_loss': 20.985353},
     'learning_rate': 0.00977151,
     'training_loss': 20.985353}
I0514 12:58:00.332267 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-40000.
I0514 12:58:00.338227 140402429237056 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0514 13:02:12.412282 140402429237056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0514 13:06:21.057606 140402429237056 controller.py:261]  eval | step:  40000 | eval time:  500.7 sec | output: 
    {'3': {'avg_iou': 0.40375352,
           'avg_obj': 0.030490912,
           'box_loss': 0.63621765,
           'class_loss': 0.0154246325,
           'conf_loss': 0.024017738,
           'precision50': 0.034092616,
           'recall50': 0.0021990892},
     '4': {'avg_iou': 0.5840286,
           'avg_obj': 0.08405018,
           'box_loss': 0.5615735,
           'class_loss': 0.019772002,
           'conf_loss': 0.023062635,
           'precision50': 0.13810895,
           'recall50': 0.022169592},
     '5': {'avg_iou': 0.6500044,
           'avg_obj': 0.13819286,
           'box_loss': 0.29844996,
           'class_loss': 0.018364279,
           'conf_loss': 0.01911911,
           'precision50': 0.21381794,
           'recall50': 0.056828424},
     'AP': 0.014254141,
     'AP50': 0.026600223,
     'AP75': 0.013588854,
     'APl': 0.024615575,
     'APm': 0.012256885,
     'APs': 0.003069506,
     'ARl': 0.22316132,
     'ARm': 0.13983825,
     'ARmax1': 0.07895108,
     'ARmax10': 0.14807658,
     'ARmax100': 0.15116228,
     'ARs': 0.025235338,
     'global': {'total_loss': 1.6160018},
     'validation_loss': 1.6160018}
I0514 13:06:42.451105 140402429237056 controller.py:211] train | step:  40000 | training until step 60000...
I0514 14:41:16.851227 140402429237056 controller.py:425] train | step:  50000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.53427505,
           'avg_obj': 0.06536658,
           'box_loss': 1.1601573,
           'class_loss': 0.019093761,
           'conf_loss': 0.03621784,
           'precision50': 0.122250795,
           'recall50': 0.009140414},
     '4': {'avg_iou': 0.64143884,
           'avg_obj': 0.1461776,
           'box_loss': 0.85366875,
           'class_loss': 0.020121343,
           'conf_loss': 0.03279796,
           'precision50': 0.37142983,
           'recall50': 0.059028808},
     '5': {'avg_iou': 0.6922606,
           'avg_obj': 0.23812768,
           'box_loss': 0.36698943,
           'class_loss': 0.018200153,
           'conf_loss': 0.022211486,
           'precision50': 0.51213425,
           'recall50': 0.15605828},
     'global': {'total_loss': 20.235735},
     'learning_rate': 0.0096449135,
     'training_loss': 20.235735}
I0514 14:42:03.918250 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-50000.
I0514 16:16:46.617377 140402429237056 controller.py:425] train | step:  60000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.54318786,
           'avg_obj': 0.07363272,
           'box_loss': 1.1398072,
           'class_loss': 0.018708182,
           'conf_loss': 0.035868254,
           'precision50': 0.15601373,
           'recall50': 0.013009251},
     '4': {'avg_iou': 0.652716,
           'avg_obj': 0.16063379,
           'box_loss': 0.828051,
           'class_loss': 0.019334491,
           'conf_loss': 0.032385416,
           'precision50': 0.4123676,
           'recall50': 0.07429881},
     '5': {'avg_iou': 0.70364773,
           'avg_obj': 0.25587627,
           'box_loss': 0.35360497,
           'class_loss': 0.017338723,
           'conf_loss': 0.02185361,
           'precision50': 0.54178756,
           'recall50': 0.18246935},
     'global': {'total_loss': 19.735657},
     'learning_rate': 0.009492056,
     'training_loss': 19.735657}
I0514 16:17:33.670256 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-60000.
I0514 16:17:33.675992 140402429237056 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0514 16:21:38.161197 140402429237056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0514 16:25:48.215372 140402429237056 controller.py:261]  eval | step:  60000 | eval time:  494.5 sec | output: 
    {'3': {'avg_iou': 0.42142338,
           'avg_obj': 0.046167966,
           'box_loss': 0.60507864,
           'class_loss': 0.014599836,
           'conf_loss': 0.023285098,
           'precision50': 0.092413634,
           'recall50': 0.010050141},
     '4': {'avg_iou': 0.6163837,
           'avg_obj': 0.12236505,
           'box_loss': 0.5162462,
           'class_loss': 0.017749721,
           'conf_loss': 0.022077687,
           'precision50': 0.25283402,
           'recall50': 0.057553504},
     '5': {'avg_iou': 0.6838032,
           'avg_obj': 0.20261502,
           'box_loss': 0.26749757,
           'class_loss': 0.016057098,
           'conf_loss': 0.018126095,
           'precision50': 0.36026362,
           'recall50': 0.12819324},
     'AP': 0.03443899,
     'AP50': 0.057829864,
     'AP75': 0.035347797,
     'APl': 0.057541784,
     'APm': 0.02630665,
     'APs': 0.0042538675,
     'ARl': 0.31616873,
     'ARm': 0.20605427,
     'ARmax1': 0.11259094,
     'ARmax10': 0.20858586,
     'ARmax100': 0.21478525,
     'ARs': 0.04110038,
     'global': {'total_loss': 1.5007176},
     'validation_loss': 1.5007176}

train | step:  20000 | training until step 40000...
train | step:  30000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.5023529,
           'avg_obj': 0.040773794,
           'box_loss': 1.2354503,
           'class_loss': 0.020024884,
           'conf_loss': 0.03735317,
           'precision50': 0.03095504,
           'recall50': 0.0017607807},
     '4': {'avg_iou': 0.59984845,
           'avg_obj': 0.099195115,
           'box_loss': 0.9515572,
           'class_loss': 0.022005504,
           'conf_loss': 0.03424535,
           'precision50': 0.18549685,
           'recall50': 0.020215547},
     '5': {'avg_iou': 0.6512726,
           'avg_obj': 0.17812847,
           'box_loss': 0.41520956,
           'class_loss': 0.020631319,
           'conf_loss': 0.023463733,
           'precision50': 0.3648479,
           'recall50': 0.072860986},
     'global': {'total_loss': 22.079535},
     'learning_rate': 0.0098709315,
     'training_loss': 22.079535}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-30000.
train | step:  40000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5221929,
           'avg_obj': 0.055137675,
           'box_loss': 1.1897407,
           'class_loss': 0.01949586,
           'conf_loss': 0.036734723,
           'precision50': 0.080563195,
           'recall50': 0.0053887526},
     '4': {'avg_iou': 0.62496036,
           'avg_obj': 0.12635043,
           'box_loss': 0.8937456,
           'class_loss': 0.021089494,
           'conf_loss': 0.03345975,
           'precision50': 0.301052,
           'recall50': 0.04032334},
     '5': {'avg_iou': 0.67596877,
           'avg_obj': 0.21322292,
           'box_loss': 0.3868536,
           'class_loss': 0.019280229,
           'conf_loss': 0.022766875,
           'precision50': 0.46208575,
           'recall50': 0.120055065},
     'global': {'total_loss': 20.985353},
     'learning_rate': 0.00977151,
     'training_loss': 20.985353}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-40000.
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=158.18s).
Accumulating evaluation results...
DONE (t=31.32s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.014
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.027
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.014
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.003
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.012
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.025
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.079
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.148
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.151
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.025
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.140
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.223
 eval | step:  40000 | eval time:  500.7 sec | output: 
    {'3': {'avg_iou': 0.40375352,
           'avg_obj': 0.030490912,
           'box_loss': 0.63621765,
           'class_loss': 0.0154246325,
           'conf_loss': 0.024017738,
           'precision50': 0.034092616,
           'recall50': 0.0021990892},
     '4': {'avg_iou': 0.5840286,
           'avg_obj': 0.08405018,
           'box_loss': 0.5615735,
           'class_loss': 0.019772002,
           'conf_loss': 0.023062635,
           'precision50': 0.13810895,
           'recall50': 0.022169592},
     '5': {'avg_iou': 0.6500044,
           'avg_obj': 0.13819286,
           'box_loss': 0.29844996,
           'class_loss': 0.018364279,
           'conf_loss': 0.01911911,
           'precision50': 0.21381794,
           'recall50': 0.056828424},
     'AP': 0.014254141,
     'AP50': 0.026600223,
     'AP75': 0.013588854,
     'APl': 0.024615575,
     'APm': 0.012256885,
     'APs': 0.003069506,
     'ARl': 0.22316132,
     'ARm': 0.13983825,
     'ARmax1': 0.07895108,
     'ARmax10': 0.14807658,
     'ARmax100': 0.15116228,
     'ARs': 0.025235338,
     'global': {'total_loss': 1.6160018},
     'validation_loss': 1.6160018}
train | step:  40000 | training until step 60000...
train | step:  50000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.53427505,
           'avg_obj': 0.06536658,
           'box_loss': 1.1601573,
           'class_loss': 0.019093761,
           'conf_loss': 0.03621784,
           'precision50': 0.122250795,
           'recall50': 0.009140414},
     '4': {'avg_iou': 0.64143884,
           'avg_obj': 0.1461776,
           'box_loss': 0.85366875,
           'class_loss': 0.020121343,
           'conf_loss': 0.03279796,
           'precision50': 0.37142983,
           'recall50': 0.059028808},
     '5': {'avg_iou': 0.6922606,
           'avg_obj': 0.23812768,
           'box_loss': 0.36698943,
           'class_loss': 0.018200153,
           'conf_loss': 0.022211486,
           'precision50': 0.51213425,
           'recall50': 0.15605828},
     'global': {'total_loss': 20.235735},
     'learning_rate': 0.0096449135,
     'training_loss': 20.235735}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-50000.
train | step:  60000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.54318786,
           'avg_obj': 0.07363272,
           'box_loss': 1.1398072,
           'class_loss': 0.018708182,
           'conf_loss': 0.035868254,
           'precision50': 0.15601373,
           'recall50': 0.013009251},
     '4': {'avg_iou': 0.652716,
           'avg_obj': 0.16063379,
           'box_loss': 0.828051,
           'class_loss': 0.019334491,
           'conf_loss': 0.032385416,
           'precision50': 0.4123676,
           'recall50': 0.07429881},
     '5': {'avg_iou': 0.70364773,
           'avg_obj': 0.25587627,
           'box_loss': 0.35360497,
           'class_loss': 0.017338723,
           'conf_loss': 0.02185361,
           'precision50': 0.54178756,
           'recall50': 0.18246935},
     'global': {'total_loss': 19.735657},
     'learning_rate': 0.009492056,
     'training_loss': 19.735657}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-60000.
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=161.69s).
Accumulating evaluation results...
DONE (t=34.92s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.034
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.058
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.035
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.004
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.026
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.058
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.113
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.209
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.215
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.041
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.206
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.316
 eval | step:  60000 | eval time:  494.5 sec | output: 
    {'3': {'avg_iou': 0.42142338,
           'avg_obj': 0.046167966,
           'box_loss': 0.60507864,
           'class_loss': 0.014599836,
           'conf_loss': 0.023285098,
           'precision50': 0.092413634,
           'recall50': 0.010050141},
     '4': {'avg_iou': 0.6163837,
           'avg_obj': 0.12236505,
           'box_loss': 0.5162462,
           'class_loss': 0.017749721,
           'conf_loss': 0.022077687,
           'precision50': 0.25283402,
           'recall50': 0.057553504},
     '5': {'avg_iou': 0.6838032,
           'avg_obj': 0.20261502,
           'box_loss': 0.26749757,
           'class_loss': 0.016057098,
           'conf_loss': 0.018126095,
           'precision50': 0.36026362,
           'recall50': 0.12819324},
     'AP': 0.03443899,
     'AP50': 0.057829864,
     'AP75': 0.035347797,
     'APl': 0.057541784,
     'APm': 0.02630665,
     'APs': 0.0042538675,
     'ARl': 0.31616873,
     'ARm': 0.20605427,
     'ARmax1': 0.11259094,
     'ARmax10': 0.20858586,
     'ARmax100': 0.21478525,
     'ARs': 0.04110038,
     'global': {'total_loss': 1.5007176},
     'validation_loss': 1.5007176}I0514 16:26:10.408122 140402429237056 controller.py:211] train | step:  60000 | training until step 80000...
I0514 17:57:56.006859 140402429237056 controller.py:425] train | step:  70000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.5499098,
           'avg_obj': 0.080653585,
           'box_loss': 1.1222545,
           'class_loss': 0.018181162,
           'conf_loss': 0.03541849,
           'precision50': 0.17968108,
           'recall50': 0.016483283},
     '4': {'avg_iou': 0.6615132,
           'avg_obj': 0.17256327,
           'box_loss': 0.80717766,
           'class_loss': 0.01855757,
           'conf_loss': 0.03199331,
           'precision50': 0.44187114,
           'recall50': 0.08776508},
     '5': {'avg_iou': 0.71281314,
           'avg_obj': 0.27080417,
           'box_loss': 0.34330657,
           'class_loss': 0.01655066,
           'conf_loss': 0.021565165,
           'precision50': 0.5634644,
           'recall50': 0.20486277},
     'global': {'total_loss': 19.319998},
     'learning_rate': 0.009314038,
     'training_loss': 19.319998}
I0514 17:58:46.788865 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-70000.
I0514 19:32:31.093552 140402429237056 controller.py:425] train | step:  80000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5556467,
           'avg_obj': 0.08669787,
           'box_loss': 1.1077658,
           'class_loss': 0.017628679,
           'conf_loss': 0.03506,
           'precision50': 0.1987658,
           'recall50': 0.019555645},
     '4': {'avg_iou': 0.66879934,
           'avg_obj': 0.18285982,
           'box_loss': 0.7892829,
           'class_loss': 0.017931033,
           'conf_loss': 0.0316375,
           'precision50': 0.46289653,
           'recall50': 0.09917506},
     '5': {'avg_iou': 0.71989954,
           'avg_obj': 0.2834415,
           'box_loss': 0.33451903,
           'class_loss': 0.015934225,
           'conf_loss': 0.021248326,
           'precision50': 0.5810019,
           'recall50': 0.22418818},
     'global': {'total_loss': 18.968008},
     'learning_rate': 0.009112143,
     'training_loss': 18.968008}
I0514 19:33:19.178295 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-80000.
I0514 19:33:19.183773 140402429237056 controller.py:252]  eval | step:  80000 | running 625 steps of evaluation...
I0514 19:37:31.344011 140402429237056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0514 19:41:38.304728 140402429237056 controller.py:261]  eval | step:  80000 | eval time:  499.1 sec | output: 
    {'3': {'avg_iou': 0.43242645,
           'avg_obj': 0.061241962,
           'box_loss': 0.5838255,
           'class_loss': 0.0134976795,
           'conf_loss': 0.022772705,
           'precision50': 0.14225018,
           'recall50': 0.019963158},
     '4': {'avg_iou': 0.6342877,
           'avg_obj': 0.15918373,
           'box_loss': 0.48843554,
           'class_loss': 0.016051682,
           'conf_loss': 0.021358214,
           'precision50': 0.33219588,
           'recall50': 0.09701035},
     '5': {'avg_iou': 0.7035305,
           'avg_obj': 0.25582892,
           'box_loss': 0.2488684,
           'class_loss': 0.014377902,
           'conf_loss': 0.01838028,
           'precision50': 0.46164116,
           'recall50': 0.19898584},
     'AP': 0.05332441,
     'AP50': 0.0884963,
     'AP75': 0.055356264,
     'APl': 0.087564215,
     'APm': 0.040372923,
     'APs': 0.007370564,
     'ARl': 0.38421607,
     'ARm': 0.2567247,
     'ARmax1': 0.13421991,
     'ARmax10': 0.24995543,
     'ARmax100': 0.25954062,
     'ARs': 0.05487145,
     'global': {'total_loss': 1.4275675},
     'validation_loss': 1.4275675}
I0514 19:41:54.856375 140402429237056 controller.py:211] train | step:  80000 | training until step 100000...
I0514 21:16:33.583039 140402429237056 controller.py:425] train | step:  90000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.5591699,
           'avg_obj': 0.09068842,
           'box_loss': 1.1019152,
           'class_loss': 0.017223965,
           'conf_loss': 0.034916278,
           'precision50': 0.21282756,
           'recall50': 0.02221076},
     '4': {'avg_iou': 0.6737974,
           'avg_obj': 0.1897665,
           'box_loss': 0.7780412,
           'class_loss': 0.01747341,
           'conf_loss': 0.031443015,
           'precision50': 0.47684833,
           'recall50': 0.10781352},
     '5': {'avg_iou': 0.72514766,
           'avg_obj': 0.29197416,
           'box_loss': 0.32853636,
           'class_loss': 0.0154806655,
           'conf_loss': 0.021087576,
           'precision50': 0.59201837,
           'recall50': 0.23740879},
     'global': {'total_loss': 18.76894},
     'learning_rate': 0.008887824,
     'training_loss': 18.76894}
I0514 21:17:26.132673 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-90000.
I0514 22:54:24.237079 140402429237056 controller.py:425] train | step:  100000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5592364,
           'avg_obj': 0.09090442,
           'box_loss': 1.1011873,
           'class_loss': 0.017002665,
           'conf_loss': 0.034933336,
           'precision50': 0.21203811,
           'recall50': 0.022475658},
     '4': {'avg_iou': 0.67473936,
           'avg_obj': 0.1910205,
           'box_loss': 0.77597946,
           'class_loss': 0.017205078,
           'conf_loss': 0.031427417,
           'precision50': 0.47710752,
           'recall50': 0.10995694},
     '5': {'avg_iou': 0.7274003,
           'avg_obj': 0.29431432,
           'box_loss': 0.326055,
           'class_loss': 0.015278731,
           'conf_loss': 0.02107311,
           'precision50': 0.592213,
           'recall50': 0.24136801},
     'global': {'total_loss': 18.72117},
     'learning_rate': 0.008642699,
     'training_loss': 18.72117}
I0514 22:55:11.972350 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-100000.
I0514 22:55:11.978246 140402429237056 controller.py:252]  eval | step:  100000 | running 625 steps of evaluation...
I0514 22:59:31.039116 140402429237056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0514 23:03:38.850684 140402429237056 controller.py:261]  eval | step:  100000 | eval time:  506.9 sec | output: 
    {'3': {'avg_iou': 0.4246148,
           'avg_obj': 0.06226731,
           'box_loss': 0.5959921,
           'class_loss': 0.01340227,
           'conf_loss': 0.023781415,
           'precision50': 0.13555263,
           'recall50': 0.022482185},
     '4': {'avg_iou': 0.61911434,
           'avg_obj': 0.13210768,
           'box_loss': 0.5167518,
           'class_loss': 0.01662371,
           'conf_loss': 0.02247046,
           'precision50': 0.2746265,
           'recall50': 0.077665366},
     '5': {'avg_iou': 0.6850128,
           'avg_obj': 0.19154671,
           'box_loss': 0.26955795,
           'class_loss': 0.015617435,
           'conf_loss': 0.018847369,
           'precision50': 0.34071216,
           'recall50': 0.13118708},
     'AP': 0.042061433,
     'AP50': 0.07009328,
     'AP75': 0.043223385,
     'APl': 0.06537776,
     'APm': 0.036648475,
     'APs': 0.007971255,
     'ARl': 0.30393088,
     'ARm': 0.2218527,
     'ARmax1': 0.11367165,
     'ARmax10': 0.20906852,
     'ARmax100': 0.21801524,
     'ARs': 0.06340781,
     'global': {'total_loss': 1.4930439},
     'validation_loss': 1.4930439}

train | step:  60000 | training until step 80000...
train | step:  70000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.5499098,
           'avg_obj': 0.080653585,
           'box_loss': 1.1222545,
           'class_loss': 0.018181162,
           'conf_loss': 0.03541849,
           'precision50': 0.17968108,
           'recall50': 0.016483283},
     '4': {'avg_iou': 0.6615132,
           'avg_obj': 0.17256327,
           'box_loss': 0.80717766,
           'class_loss': 0.01855757,
           'conf_loss': 0.03199331,
           'precision50': 0.44187114,
           'recall50': 0.08776508},
     '5': {'avg_iou': 0.71281314,
           'avg_obj': 0.27080417,
           'box_loss': 0.34330657,
           'class_loss': 0.01655066,
           'conf_loss': 0.021565165,
           'precision50': 0.5634644,
           'recall50': 0.20486277},
     'global': {'total_loss': 19.319998},
     'learning_rate': 0.009314038,
     'training_loss': 19.319998}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-70000.
train | step:  80000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5556467,
           'avg_obj': 0.08669787,
           'box_loss': 1.1077658,
           'class_loss': 0.017628679,
           'conf_loss': 0.03506,
           'precision50': 0.1987658,
           'recall50': 0.019555645},
     '4': {'avg_iou': 0.66879934,
           'avg_obj': 0.18285982,
           'box_loss': 0.7892829,
           'class_loss': 0.017931033,
           'conf_loss': 0.0316375,
           'precision50': 0.46289653,
           'recall50': 0.09917506},
     '5': {'avg_iou': 0.71989954,
           'avg_obj': 0.2834415,
           'box_loss': 0.33451903,
           'class_loss': 0.015934225,
           'conf_loss': 0.021248326,
           'precision50': 0.5810019,
           'recall50': 0.22418818},
     'global': {'total_loss': 18.968008},
     'learning_rate': 0.009112143,
     'training_loss': 18.968008}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-80000.
 eval | step:  80000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=162.33s).
Accumulating evaluation results...
DONE (t=30.86s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.053
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.088
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.055
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.007
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.040
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.088
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.134
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.250
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.260
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.055
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.257
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.384
 eval | step:  80000 | eval time:  499.1 sec | output: 
    {'3': {'avg_iou': 0.43242645,
           'avg_obj': 0.061241962,
           'box_loss': 0.5838255,
           'class_loss': 0.0134976795,
           'conf_loss': 0.022772705,
           'precision50': 0.14225018,
           'recall50': 0.019963158},
     '4': {'avg_iou': 0.6342877,
           'avg_obj': 0.15918373,
           'box_loss': 0.48843554,
           'class_loss': 0.016051682,
           'conf_loss': 0.021358214,
           'precision50': 0.33219588,
           'recall50': 0.09701035},
     '5': {'avg_iou': 0.7035305,
           'avg_obj': 0.25582892,
           'box_loss': 0.2488684,
           'class_loss': 0.014377902,
           'conf_loss': 0.01838028,
           'precision50': 0.46164116,
           'recall50': 0.19898584},
     'AP': 0.05332441,
     'AP50': 0.0884963,
     'AP75': 0.055356264,
     'APl': 0.087564215,
     'APm': 0.040372923,
     'APs': 0.007370564,
     'ARl': 0.38421607,
     'ARm': 0.2567247,
     'ARmax1': 0.13421991,
     'ARmax10': 0.24995543,
     'ARmax100': 0.25954062,
     'ARs': 0.05487145,
     'global': {'total_loss': 1.4275675},
     'validation_loss': 1.4275675}
train | step:  80000 | training until step 100000...
train | step:  90000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.5591699,
           'avg_obj': 0.09068842,
           'box_loss': 1.1019152,
           'class_loss': 0.017223965,
           'conf_loss': 0.034916278,
           'precision50': 0.21282756,
           'recall50': 0.02221076},
     '4': {'avg_iou': 0.6737974,
           'avg_obj': 0.1897665,
           'box_loss': 0.7780412,
           'class_loss': 0.01747341,
           'conf_loss': 0.031443015,
           'precision50': 0.47684833,
           'recall50': 0.10781352},
     '5': {'avg_iou': 0.72514766,
           'avg_obj': 0.29197416,
           'box_loss': 0.32853636,
           'class_loss': 0.0154806655,
           'conf_loss': 0.021087576,
           'precision50': 0.59201837,
           'recall50': 0.23740879},
     'global': {'total_loss': 18.76894},
     'learning_rate': 0.008887824,
     'training_loss': 18.76894}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-90000.
train | step:  100000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5592364,
           'avg_obj': 0.09090442,
           'box_loss': 1.1011873,
           'class_loss': 0.017002665,
           'conf_loss': 0.034933336,
           'precision50': 0.21203811,
           'recall50': 0.022475658},
     '4': {'avg_iou': 0.67473936,
           'avg_obj': 0.1910205,
           'box_loss': 0.77597946,
           'class_loss': 0.017205078,
           'conf_loss': 0.031427417,
           'precision50': 0.47710752,
           'recall50': 0.10995694},
     '5': {'avg_iou': 0.7274003,
           'avg_obj': 0.29431432,
           'box_loss': 0.326055,
           'class_loss': 0.015278731,
           'conf_loss': 0.02107311,
           'precision50': 0.592213,
           'recall50': 0.24136801},
     'global': {'total_loss': 18.72117},
     'learning_rate': 0.008642699,
     'training_loss': 18.72117}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-100000.
 eval | step:  100000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=158.21s).
Accumulating evaluation results...
DONE (t=28.90s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.042
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.070
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.043
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.008
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.037
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.065
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.114
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.209
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.218
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.063
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.222
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.304
 eval | step:  100000 | eval time:  506.9 sec | output: 
    {'3': {'avg_iou': 0.4246148,
           'avg_obj': 0.06226731,
           'box_loss': 0.5959921,
           'class_loss': 0.01340227,
           'conf_loss': 0.023781415,
           'precision50': 0.13555263,
           'recall50': 0.022482185},
     '4': {'avg_iou': 0.61911434,
           'avg_obj': 0.13210768,
           'box_loss': 0.5167518,
           'class_loss': 0.01662371,
           'conf_loss': 0.02247046,
           'precision50': 0.2746265,
           'recall50': 0.077665366},
     '5': {'avg_iou': 0.6850128,
           'avg_obj': 0.19154671,
           'box_loss': 0.26955795,
           'class_loss': 0.015617435,
           'conf_loss': 0.018847369,
           'precision50': 0.34071216,
           'recall50': 0.13118708},
     'AP': 0.042061433,
     'AP50': 0.07009328,
     'AP75': 0.043223385,
     'APl': 0.06537776,
     'APm': 0.036648475,
     'APs': 0.007971255,
     'ARl': 0.30393088,
     'ARm': 0.2218527,
     'ARmax1': 0.11367165,
     'ARmax10': 0.20906852,
     'ARmax100': 0.21801524,
     'ARs': 0.06340781,
     'global': {'total_loss': 1.4930439},
     'validation_loss': 1.4930439}I0514 23:03:55.421116 140402429237056 controller.py:211] train | step:  100000 | training until step 120000...
I0515 00:35:40.757506 140402429237056 controller.py:425] train | step:  110000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.5655311,
           'avg_obj': 0.09720719,
           'box_loss': 1.0844374,
           'class_loss': 0.016596848,
           'conf_loss': 0.03457656,
           'precision50': 0.23193325,
           'recall50': 0.025998205},
     '4': {'avg_iou': 0.6821595,
           'avg_obj': 0.20176417,
           'box_loss': 0.7596235,
           'class_loss': 0.01672176,
           'conf_loss': 0.031100027,
           'precision50': 0.5008873,
           'recall50': 0.121701255},
     '5': {'avg_iou': 0.73436177,
           'avg_obj': 0.3076324,
           'box_loss': 0.31813678,
           'class_loss': 0.014767566,
           'conf_loss': 0.020767419,
           'precision50': 0.6129094,
           'recall50': 0.2613262},
     'global': {'total_loss': 18.373825},
     'learning_rate': 0.008378533,
     'training_loss': 18.373825}
I0515 00:36:27.368676 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-110000.
I0515 02:07:54.591902 140402429237056 controller.py:425] train | step:  120000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5697781,
           'avg_obj': 0.102042764,
           'box_loss': 1.0770812,
           'class_loss': 0.016255707,
           'conf_loss': 0.03440335,
           'precision50': 0.24624217,
           'recall50': 0.028960992},
     '4': {'avg_iou': 0.68738157,
           'avg_obj': 0.21021341,
           'box_loss': 0.74698323,
           'class_loss': 0.016302045,
           'conf_loss': 0.030782828,
           'precision50': 0.5155362,
           'recall50': 0.1317768},
     '5': {'avg_iou': 0.73964876,
           'avg_obj': 0.31789714,
           'box_loss': 0.31147975,
           'class_loss': 0.014384041,
           'conf_loss': 0.020495612,
           'precision50': 0.6248037,
           'recall50': 0.2765376},
     'global': {'total_loss': 18.14533},
     'learning_rate': 0.008097229,
     'training_loss': 18.14533}
I0515 02:08:42.101070 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-120000.
I0515 02:08:42.107248 140402429237056 controller.py:252]  eval | step:  120000 | running 625 steps of evaluation...
I0515 02:12:47.170157 140402429237056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0515 02:17:03.164112 140402429237056 controller.py:261]  eval | step:  120000 | eval time:  501.1 sec | output: 
    {'3': {'avg_iou': 0.4417219,
           'avg_obj': 0.07393355,
           'box_loss': 0.5648959,
           'class_loss': 0.01212527,
           'conf_loss': 0.022373889,
           'precision50': 0.16581137,
           'recall50': 0.029704597},
     '4': {'avg_iou': 0.6494919,
           'avg_obj': 0.18765613,
           'box_loss': 0.46365768,
           'class_loss': 0.014272738,
           'conf_loss': 0.020726053,
           'precision50': 0.39499092,
           'recall50': 0.12949756},
     '5': {'avg_iou': 0.71778613,
           'avg_obj': 0.2972486,
           'box_loss': 0.23366664,
           'class_loss': 0.013345898,
           'conf_loss': 0.016914962,
           'precision50': 0.5329954,
           'recall50': 0.25637472},
     'AP': 0.0777654,
     'AP50': 0.1250456,
     'AP75': 0.08226409,
     'APl': 0.12731625,
     'APm': 0.061104134,
     'APs': 0.012082951,
     'ARl': 0.44252318,
     'ARm': 0.31137526,
     'ARmax1': 0.15760754,
     'ARmax10': 0.29099554,
     'ARmax100': 0.30643895,
     'ARs': 0.09166242,
     'global': {'total_loss': 1.3619792},
     'validation_loss': 1.3619792}
I0515 02:17:19.719130 140402429237056 controller.py:211] train | step:  120000 | training until step 140000...
I0515 03:41:56.748754 140402429237056 controller.py:425] train | step:  130000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5726991,
           'avg_obj': 0.10595923,
           'box_loss': 1.0722535,
           'class_loss': 0.015976295,
           'conf_loss': 0.034289446,
           'precision50': 0.25733927,
           'recall50': 0.031672243},
     '4': {'avg_iou': 0.6918162,
           'avg_obj': 0.21690977,
           'box_loss': 0.7378749,
           'class_loss': 0.01598813,
           'conf_loss': 0.030629853,
           'precision50': 0.5272299,
           'recall50': 0.14005922},
     '5': {'avg_iou': 0.7440476,
           'avg_obj': 0.32586026,
           'box_loss': 0.30686843,
           'class_loss': 0.014066436,
           'conf_loss': 0.020357437,
           'precision50': 0.63520586,
           'recall50': 0.28896716},
     'global': {'total_loss': 17.986465},
     'learning_rate': 0.007800815,
     'training_loss': 17.986465}
I0515 03:42:42.237059 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-130000.
I0515 05:11:11.701787 140402429237056 controller.py:425] train | step:  140000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.575245,
           'avg_obj': 0.108982705,
           'box_loss': 1.0642756,
           'class_loss': 0.015720546,
           'conf_loss': 0.034082066,
           'precision50': 0.26382774,
           'recall50': 0.033781722},
     '4': {'avg_iou': 0.6952956,
           'avg_obj': 0.22183484,
           'box_loss': 0.72876376,
           'class_loss': 0.01567612,
           'conf_loss': 0.03043778,
           'precision50': 0.5348497,
           'recall50': 0.1463219},
     '5': {'avg_iou': 0.74732476,
           'avg_obj': 0.3317987,
           'box_loss': 0.30319998,
           'class_loss': 0.013798247,
           'conf_loss': 0.02023258,
           'precision50': 0.6409043,
           'recall50': 0.29796904},
     'global': {'total_loss': 17.809505},
     'learning_rate': 0.007491425,
     'training_loss': 17.809505}
I0515 05:11:58.840279 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-140000.
I0515 05:11:58.846765 140402429237056 controller.py:252]  eval | step:  140000 | running 625 steps of evaluation...
I0515 05:16:05.534553 140402429237056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0515 05:20:13.853820 140402429237056 controller.py:261]  eval | step:  140000 | eval time:  495.0 sec | output: 
    {'3': {'avg_iou': 0.44503936,
           'avg_obj': 0.078287914,
           'box_loss': 0.55738837,
           'class_loss': 0.011732706,
           'conf_loss': 0.022285108,
           'precision50': 0.17758094,
           'recall50': 0.03298267},
     '4': {'avg_iou': 0.65546566,
           'avg_obj': 0.19795728,
           'box_loss': 0.45326334,
           'class_loss': 0.013708171,
           'conf_loss': 0.020393299,
           'precision50': 0.41044667,
           'recall50': 0.14409214},
     '5': {'avg_iou': 0.72242767,
           'avg_obj': 0.31446558,
           'box_loss': 0.2279092,
           'class_loss': 0.014128914,
           'conf_loss': 0.016481083,
           'precision50': 0.5539464,
           'recall50': 0.28093535},
     'AP': 0.079988346,
     'AP50': 0.12665845,
     'AP75': 0.08469265,
     'APl': 0.13793297,
     'APm': 0.06945843,
     'APs': 0.013326858,
     'ARl': 0.46718487,
     'ARm': 0.3323567,
     'ARmax1': 0.17096022,
     'ARmax10': 0.3090377,
     'ARmax100': 0.3257149,
     'ARs': 0.09804018,
     'global': {'total_loss': 1.3372911},
     'validation_loss': 1.3372911}

train | step:  100000 | training until step 120000...
train | step:  110000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.5655311,
           'avg_obj': 0.09720719,
           'box_loss': 1.0844374,
           'class_loss': 0.016596848,
           'conf_loss': 0.03457656,
           'precision50': 0.23193325,
           'recall50': 0.025998205},
     '4': {'avg_iou': 0.6821595,
           'avg_obj': 0.20176417,
           'box_loss': 0.7596235,
           'class_loss': 0.01672176,
           'conf_loss': 0.031100027,
           'precision50': 0.5008873,
           'recall50': 0.121701255},
     '5': {'avg_iou': 0.73436177,
           'avg_obj': 0.3076324,
           'box_loss': 0.31813678,
           'class_loss': 0.014767566,
           'conf_loss': 0.020767419,
           'precision50': 0.6129094,
           'recall50': 0.2613262},
     'global': {'total_loss': 18.373825},
     'learning_rate': 0.008378533,
     'training_loss': 18.373825}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-110000.
train | step:  120000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5697781,
           'avg_obj': 0.102042764,
           'box_loss': 1.0770812,
           'class_loss': 0.016255707,
           'conf_loss': 0.03440335,
           'precision50': 0.24624217,
           'recall50': 0.028960992},
     '4': {'avg_iou': 0.68738157,
           'avg_obj': 0.21021341,
           'box_loss': 0.74698323,
           'class_loss': 0.016302045,
           'conf_loss': 0.030782828,
           'precision50': 0.5155362,
           'recall50': 0.1317768},
     '5': {'avg_iou': 0.73964876,
           'avg_obj': 0.31789714,
           'box_loss': 0.31147975,
           'class_loss': 0.014384041,
           'conf_loss': 0.020495612,
           'precision50': 0.6248037,
           'recall50': 0.2765376},
     'global': {'total_loss': 18.14533},
     'learning_rate': 0.008097229,
     'training_loss': 18.14533}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-120000.
 eval | step:  120000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=170.11s).
Accumulating evaluation results...
DONE (t=32.81s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.078
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.125
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.082
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.012
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.061
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.127
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.158
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.291
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.306
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.092
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.311
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.443
 eval | step:  120000 | eval time:  501.1 sec | output: 
    {'3': {'avg_iou': 0.4417219,
           'avg_obj': 0.07393355,
           'box_loss': 0.5648959,
           'class_loss': 0.01212527,
           'conf_loss': 0.022373889,
           'precision50': 0.16581137,
           'recall50': 0.029704597},
     '4': {'avg_iou': 0.6494919,
           'avg_obj': 0.18765613,
           'box_loss': 0.46365768,
           'class_loss': 0.014272738,
           'conf_loss': 0.020726053,
           'precision50': 0.39499092,
           'recall50': 0.12949756},
     '5': {'avg_iou': 0.71778613,
           'avg_obj': 0.2972486,
           'box_loss': 0.23366664,
           'class_loss': 0.013345898,
           'conf_loss': 0.016914962,
           'precision50': 0.5329954,
           'recall50': 0.25637472},
     'AP': 0.0777654,
     'AP50': 0.1250456,
     'AP75': 0.08226409,
     'APl': 0.12731625,
     'APm': 0.061104134,
     'APs': 0.012082951,
     'ARl': 0.44252318,
     'ARm': 0.31137526,
     'ARmax1': 0.15760754,
     'ARmax10': 0.29099554,
     'ARmax100': 0.30643895,
     'ARs': 0.09166242,
     'global': {'total_loss': 1.3619792},
     'validation_loss': 1.3619792}
train | step:  120000 | training until step 140000...
train | step:  130000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5726991,
           'avg_obj': 0.10595923,
           'box_loss': 1.0722535,
           'class_loss': 0.015976295,
           'conf_loss': 0.034289446,
           'precision50': 0.25733927,
           'recall50': 0.031672243},
     '4': {'avg_iou': 0.6918162,
           'avg_obj': 0.21690977,
           'box_loss': 0.7378749,
           'class_loss': 0.01598813,
           'conf_loss': 0.030629853,
           'precision50': 0.5272299,
           'recall50': 0.14005922},
     '5': {'avg_iou': 0.7440476,
           'avg_obj': 0.32586026,
           'box_loss': 0.30686843,
           'class_loss': 0.014066436,
           'conf_loss': 0.020357437,
           'precision50': 0.63520586,
           'recall50': 0.28896716},
     'global': {'total_loss': 17.986465},
     'learning_rate': 0.007800815,
     'training_loss': 17.986465}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-130000.
train | step:  140000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.575245,
           'avg_obj': 0.108982705,
           'box_loss': 1.0642756,
           'class_loss': 0.015720546,
           'conf_loss': 0.034082066,
           'precision50': 0.26382774,
           'recall50': 0.033781722},
     '4': {'avg_iou': 0.6952956,
           'avg_obj': 0.22183484,
           'box_loss': 0.72876376,
           'class_loss': 0.01567612,
           'conf_loss': 0.03043778,
           'precision50': 0.5348497,
           'recall50': 0.1463219},
     '5': {'avg_iou': 0.74732476,
           'avg_obj': 0.3317987,
           'box_loss': 0.30319998,
           'class_loss': 0.013798247,
           'conf_loss': 0.02023258,
           'precision50': 0.6409043,
           'recall50': 0.29796904},
     'global': {'total_loss': 17.809505},
     'learning_rate': 0.007491425,
     'training_loss': 17.809505}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-140000.
 eval | step:  140000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=164.85s).
Accumulating evaluation results...
DONE (t=27.63s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.080
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.127
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.085
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.013
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.069
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.138
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.171
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.309
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.326
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.098
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.332
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.467
 eval | step:  140000 | eval time:  495.0 sec | output: 
    {'3': {'avg_iou': 0.44503936,
           'avg_obj': 0.078287914,
           'box_loss': 0.55738837,
           'class_loss': 0.011732706,
           'conf_loss': 0.022285108,
           'precision50': 0.17758094,
           'recall50': 0.03298267},
     '4': {'avg_iou': 0.65546566,
           'avg_obj': 0.19795728,
           'box_loss': 0.45326334,
           'class_loss': 0.013708171,
           'conf_loss': 0.020393299,
           'precision50': 0.41044667,
           'recall50': 0.14409214},
     '5': {'avg_iou': 0.72242767,
           'avg_obj': 0.31446558,
           'box_loss': 0.2279092,
           'class_loss': 0.014128914,
           'conf_loss': 0.016481083,
           'precision50': 0.5539464,
           'recall50': 0.28093535},
     'AP': 0.079988346,
     'AP50': 0.12665845,
     'AP75': 0.08469265,
     'APl': 0.13793297,
     'APm': 0.06945843,
     'APs': 0.013326858,
     'ARl': 0.46718487,
     'ARm': 0.3323567,
     'ARmax1': 0.17096022,
     'ARmax10': 0.3090377,
     'ARmax100': 0.3257149,
     'ARs': 0.09804018,
     'global': {'total_loss': 1.3372911},
     'validation_loss': 1.3372911}I0515 05:20:34.107970 140402429237056 controller.py:211] train | step:  140000 | training until step 160000...
I0515 06:45:50.505788 140402429237056 controller.py:425] train | step:  150000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5783567,
           'avg_obj': 0.11286033,
           'box_loss': 1.0564473,
           'class_loss': 0.015459723,
           'conf_loss': 0.033891357,
           'precision50': 0.2736075,
           'recall50': 0.03644045},
     '4': {'avg_iou': 0.69920015,
           'avg_obj': 0.22781892,
           'box_loss': 0.7202204,
           'class_loss': 0.015382791,
           'conf_loss': 0.030272428,
           'precision50': 0.5442616,
           'recall50': 0.15383314},
     '5': {'avg_iou': 0.7510546,
           'avg_obj': 0.3385117,
           'box_loss': 0.29886854,
           'class_loss': 0.013505231,
           'conf_loss': 0.02008328,
           'precision50': 0.6494023,
           'recall50': 0.30827358},
     'global': {'total_loss': 17.633093},
     'learning_rate': 0.007171291,
     'training_loss': 17.633093}
I0515 06:46:38.692209 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-150000.
I0515 08:17:14.488084 140402429237056 controller.py:425] train | step:  160000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.58059436,
           'avg_obj': 0.11562183,
           'box_loss': 1.051434,
           'class_loss': 0.015240958,
           'conf_loss': 0.033797316,
           'precision50': 0.28063464,
           'recall50': 0.038451415},
     '4': {'avg_iou': 0.7019714,
           'avg_obj': 0.2323657,
           'box_loss': 0.7132766,
           'class_loss': 0.015136493,
           'conf_loss': 0.030118726,
           'precision50': 0.55146664,
           'recall50': 0.15997224},
     '5': {'avg_iou': 0.75418586,
           'avg_obj': 0.34411803,
           'box_loss': 0.2952583,
           'class_loss': 0.013288231,
           'conf_loss': 0.01996643,
           'precision50': 0.6550324,
           'recall50': 0.31700668},
     'global': {'total_loss': 17.500116},
     'learning_rate': 0.0068427175,
     'training_loss': 17.500116}
I0515 08:18:03.177466 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-160000.
I0515 08:18:03.183228 140402429237056 controller.py:252]  eval | step:  160000 | running 625 steps of evaluation...
I0515 08:22:07.949358 140402429237056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0515 08:26:15.700856 140402429237056 controller.py:261]  eval | step:  160000 | eval time:  492.5 sec | output: 
    {'3': {'avg_iou': 0.4497923,
           'avg_obj': 0.084910214,
           'box_loss': 0.54941946,
           'class_loss': 0.011051933,
           'conf_loss': 0.021725422,
           'precision50': 0.19704163,
           'recall50': 0.040147465},
     '4': {'avg_iou': 0.66333705,
           'avg_obj': 0.21290627,
           'box_loss': 0.44297963,
           'class_loss': 0.012850113,
           'conf_loss': 0.020068817,
           'precision50': 0.4382895,
           'recall50': 0.162885},
     '5': {'avg_iou': 0.7364723,
           'avg_obj': 0.33445728,
           'box_loss': 0.2193703,
           'class_loss': 0.011144771,
           'conf_loss': 0.015828297,
           'precision50': 0.5866935,
           'recall50': 0.30743712},
     'AP': 0.10861804,
     'AP50': 0.16835795,
     'AP75': 0.116488315,
     'APl': 0.1675237,
     'APm': 0.09069234,
     'APs': 0.020151347,
     'ARl': 0.49603727,
     'ARm': 0.35941508,
     'ARmax1': 0.18509936,
     'ARmax10': 0.328953,
     'ARmax100': 0.34776405,
     'ARs': 0.10996131,
     'global': {'total_loss': 1.3044393},
     'validation_loss': 1.3044393}
I0515 08:26:34.810232 140402429237056 controller.py:211] train | step:  160000 | training until step 180000...
I0515 09:56:44.074067 140402429237056 controller.py:425] train | step:  170000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.58353007,
           'avg_obj': 0.11957099,
           'box_loss': 1.0466363,
           'class_loss': 0.015008482,
           'conf_loss': 0.033676174,
           'precision50': 0.29005712,
           'recall50': 0.041230015},
     '4': {'avg_iou': 0.7056313,
           'avg_obj': 0.23827781,
           'box_loss': 0.7051812,
           'class_loss': 0.014847727,
           'conf_loss': 0.029926557,
           'precision50': 0.5576354,
           'recall50': 0.16633153},
     '5': {'avg_iou': 0.7578365,
           'avg_obj': 0.35102034,
           'box_loss': 0.29072854,
           'class_loss': 0.0130036,
           'conf_loss': 0.019788805,
           'precision50': 0.66138995,
           'recall50': 0.3269361},
     'global': {'total_loss': 17.350365},
     'learning_rate': 0.0065080714,
     'training_loss': 17.350365}
I0515 09:57:32.744743 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-170000.
I0515 11:26:37.188190 140402429237056 controller.py:425] train | step:  180000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.58606845,
           'avg_obj': 0.12216483,
           'box_loss': 1.0394582,
           'class_loss': 0.014817151,
           'conf_loss': 0.033523798,
           'precision50': 0.29685634,
           'recall50': 0.043126293},
     '4': {'avg_iou': 0.70850474,
           'avg_obj': 0.24279782,
           'box_loss': 0.69824463,
           'class_loss': 0.014599148,
           'conf_loss': 0.02977062,
           'precision50': 0.56389517,
           'recall50': 0.17250912},
     '5': {'avg_iou': 0.7608098,
           'avg_obj': 0.3563608,
           'box_loss': 0.28693148,
           'class_loss': 0.0127764195,
           'conf_loss': 0.01965355,
           'precision50': 0.66609776,
           'recall50': 0.33475333},
     'global': {'total_loss': 17.198174},
     'learning_rate': 0.0061697643,
     'training_loss': 17.198174}
I0515 11:27:25.208181 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-180000.
I0515 11:27:25.215250 140402429237056 controller.py:252]  eval | step:  180000 | running 625 steps of evaluation...
I0515 11:31:31.698582 140402429237056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0515 11:35:57.214859 140402429237056 controller.py:261]  eval | step:  180000 | eval time:  512.0 sec | output: 
    {'3': {'avg_iou': 0.45302495,
           'avg_obj': 0.09292554,
           'box_loss': 0.5434088,
           'class_loss': 0.010707168,
           'conf_loss': 0.021792619,
           'precision50': 0.21230257,
           'recall50': 0.047481444},
     '4': {'avg_iou': 0.6676072,
           'avg_obj': 0.2246407,
           'box_loss': 0.43540883,
           'class_loss': 0.012343159,
           'conf_loss': 0.020450175,
           'precision50': 0.45405307,
           'recall50': 0.17747222},
     '5': {'avg_iou': 0.7403818,
           'avg_obj': 0.35045537,
           'box_loss': 0.21524043,
           'class_loss': 0.010790791,
           'conf_loss': 0.016090756,
           'precision50': 0.5984234,
           'recall50': 0.32915738},
     'AP': 0.10154629,
     'AP50': 0.15765454,
     'AP75': 0.107949585,
     'APl': 0.16795619,
     'APm': 0.09679807,
     'APs': 0.018911716,
     'ARl': 0.5086642,
     'ARm': 0.3699044,
     'ARmax1': 0.18994161,
     'ARmax10': 0.33877853,
     'ARmax100': 0.3593149,
     'ARs': 0.121167675,
     'global': {'total_loss': 1.2862327},
     'validation_loss': 1.2862327}

train | step:  140000 | training until step 160000...
train | step:  150000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5783567,
           'avg_obj': 0.11286033,
           'box_loss': 1.0564473,
           'class_loss': 0.015459723,
           'conf_loss': 0.033891357,
           'precision50': 0.2736075,
           'recall50': 0.03644045},
     '4': {'avg_iou': 0.69920015,
           'avg_obj': 0.22781892,
           'box_loss': 0.7202204,
           'class_loss': 0.015382791,
           'conf_loss': 0.030272428,
           'precision50': 0.5442616,
           'recall50': 0.15383314},
     '5': {'avg_iou': 0.7510546,
           'avg_obj': 0.3385117,
           'box_loss': 0.29886854,
           'class_loss': 0.013505231,
           'conf_loss': 0.02008328,
           'precision50': 0.6494023,
           'recall50': 0.30827358},
     'global': {'total_loss': 17.633093},
     'learning_rate': 0.007171291,
     'training_loss': 17.633093}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-150000.
train | step:  160000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.58059436,
           'avg_obj': 0.11562183,
           'box_loss': 1.051434,
           'class_loss': 0.015240958,
           'conf_loss': 0.033797316,
           'precision50': 0.28063464,
           'recall50': 0.038451415},
     '4': {'avg_iou': 0.7019714,
           'avg_obj': 0.2323657,
           'box_loss': 0.7132766,
           'class_loss': 0.015136493,
           'conf_loss': 0.030118726,
           'precision50': 0.55146664,
           'recall50': 0.15997224},
     '5': {'avg_iou': 0.75418586,
           'avg_obj': 0.34411803,
           'box_loss': 0.2952583,
           'class_loss': 0.013288231,
           'conf_loss': 0.01996643,
           'precision50': 0.6550324,
           'recall50': 0.31700668},
     'global': {'total_loss': 17.500116},
     'learning_rate': 0.0068427175,
     'training_loss': 17.500116}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-160000.
 eval | step:  160000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=167.06s).
Accumulating evaluation results...
DONE (t=28.22s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.109
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.168
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.116
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.020
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.091
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.168
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.185
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.329
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.348
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.110
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.359
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.496
 eval | step:  160000 | eval time:  492.5 sec | output: 
    {'3': {'avg_iou': 0.4497923,
           'avg_obj': 0.084910214,
           'box_loss': 0.54941946,
           'class_loss': 0.011051933,
           'conf_loss': 0.021725422,
           'precision50': 0.19704163,
           'recall50': 0.040147465},
     '4': {'avg_iou': 0.66333705,
           'avg_obj': 0.21290627,
           'box_loss': 0.44297963,
           'class_loss': 0.012850113,
           'conf_loss': 0.020068817,
           'precision50': 0.4382895,
           'recall50': 0.162885},
     '5': {'avg_iou': 0.7364723,
           'avg_obj': 0.33445728,
           'box_loss': 0.2193703,
           'class_loss': 0.011144771,
           'conf_loss': 0.015828297,
           'precision50': 0.5866935,
           'recall50': 0.30743712},
     'AP': 0.10861804,
     'AP50': 0.16835795,
     'AP75': 0.116488315,
     'APl': 0.1675237,
     'APm': 0.09069234,
     'APs': 0.020151347,
     'ARl': 0.49603727,
     'ARm': 0.35941508,
     'ARmax1': 0.18509936,
     'ARmax10': 0.328953,
     'ARmax100': 0.34776405,
     'ARs': 0.10996131,
     'global': {'total_loss': 1.3044393},
     'validation_loss': 1.3044393}
train | step:  160000 | training until step 180000...
train | step:  170000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.58353007,
           'avg_obj': 0.11957099,
           'box_loss': 1.0466363,
           'class_loss': 0.015008482,
           'conf_loss': 0.033676174,
           'precision50': 0.29005712,
           'recall50': 0.041230015},
     '4': {'avg_iou': 0.7056313,
           'avg_obj': 0.23827781,
           'box_loss': 0.7051812,
           'class_loss': 0.014847727,
           'conf_loss': 0.029926557,
           'precision50': 0.5576354,
           'recall50': 0.16633153},
     '5': {'avg_iou': 0.7578365,
           'avg_obj': 0.35102034,
           'box_loss': 0.29072854,
           'class_loss': 0.0130036,
           'conf_loss': 0.019788805,
           'precision50': 0.66138995,
           'recall50': 0.3269361},
     'global': {'total_loss': 17.350365},
     'learning_rate': 0.0065080714,
     'training_loss': 17.350365}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-170000.
train | step:  180000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.58606845,
           'avg_obj': 0.12216483,
           'box_loss': 1.0394582,
           'class_loss': 0.014817151,
           'conf_loss': 0.033523798,
           'precision50': 0.29685634,
           'recall50': 0.043126293},
     '4': {'avg_iou': 0.70850474,
           'avg_obj': 0.24279782,
           'box_loss': 0.69824463,
           'class_loss': 0.014599148,
           'conf_loss': 0.02977062,
           'precision50': 0.56389517,
           'recall50': 0.17250912},
     '5': {'avg_iou': 0.7608098,
           'avg_obj': 0.3563608,
           'box_loss': 0.28693148,
           'class_loss': 0.0127764195,
           'conf_loss': 0.01965355,
           'precision50': 0.66609776,
           'recall50': 0.33475333},
     'global': {'total_loss': 17.198174},
     'learning_rate': 0.0061697643,
     'training_loss': 17.198174}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-180000.
 eval | step:  180000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=179.25s).
Accumulating evaluation results...
DONE (t=27.70s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.102
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.158
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.108
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.019
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.097
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.168
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.190
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.339
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.359
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.121
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.370
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.509
 eval | step:  180000 | eval time:  512.0 sec | output: 
    {'3': {'avg_iou': 0.45302495,
           'avg_obj': 0.09292554,
           'box_loss': 0.5434088,
           'class_loss': 0.010707168,
           'conf_loss': 0.021792619,
           'precision50': 0.21230257,
           'recall50': 0.047481444},
     '4': {'avg_iou': 0.6676072,
           'avg_obj': 0.2246407,
           'box_loss': 0.43540883,
           'class_loss': 0.012343159,
           'conf_loss': 0.020450175,
           'precision50': 0.45405307,
           'recall50': 0.17747222},
     '5': {'avg_iou': 0.7403818,
           'avg_obj': 0.35045537,
           'box_loss': 0.21524043,
           'class_loss': 0.010790791,
           'conf_loss': 0.016090756,
           'precision50': 0.5984234,
           'recall50': 0.32915738},
     'AP': 0.10154629,
     'AP50': 0.15765454,
     'AP75': 0.107949585,
     'APl': 0.16795619,
     'APm': 0.09679807,
     'APs': 0.018911716,
     'ARl': 0.5086642,
     'ARm': 0.3699044,
     'ARmax1': 0.18994161,
     'ARmax10': 0.33877853,
     'ARmax100': 0.3593149,
     'ARs': 0.121167675,
     'global': {'total_loss': 1.2862327},
     'validation_loss': 1.2862327}I0515 11:36:15.082501 140402429237056 controller.py:211] train | step:  180000 | training until step 200000...
I0515 13:00:13.555767 140402429237056 controller.py:425] train | step:  190000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.58766174,
           'avg_obj': 0.123995736,
           'box_loss': 1.0361282,
           'class_loss': 0.01468184,
           'conf_loss': 0.033489726,
           'precision50': 0.3019023,
           'recall50': 0.044775113},
     '4': {'avg_iou': 0.71049184,
           'avg_obj': 0.24591646,
           'box_loss': 0.6940729,
           'class_loss': 0.01441766,
           'conf_loss': 0.029711554,
           'precision50': 0.5681114,
           'recall50': 0.1765769},
     '5': {'avg_iou': 0.76287645,
           'avg_obj': 0.36006865,
           'box_loss': 0.28470507,
           'class_loss': 0.01260702,
           'conf_loss': 0.019583179,
           'precision50': 0.67017263,
           'recall50': 0.3405657},
     'global': {'total_loss': 17.115187},
     'learning_rate': 0.0058302353,
     'training_loss': 17.115187}
I0515 13:01:02.407328 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-190000.
I0515 14:32:52.876815 140402429237056 controller.py:425] train | step:  200000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.59001166,
           'avg_obj': 0.127397,
           'box_loss': 1.0298892,
           'class_loss': 0.014463652,
           'conf_loss': 0.03330422,
           'precision50': 0.30935332,
           'recall50': 0.04721843},
     '4': {'avg_iou': 0.7135613,
           'avg_obj': 0.2506746,
           'box_loss': 0.68548787,
           'class_loss': 0.014175468,
           'conf_loss': 0.029491195,
           'precision50': 0.5743942,
           'recall50': 0.18278691},
     '5': {'avg_iou': 0.7656597,
           'avg_obj': 0.3655608,
           'box_loss': 0.28126317,
           'class_loss': 0.012399341,
           'conf_loss': 0.019450972,
           'precision50': 0.6747083,
           'recall50': 0.34830874},
     'global': {'total_loss': 16.959421},
     'learning_rate': 0.005491929,
     'training_loss': 16.959421}
I0515 14:33:40.023351 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-200000.
I0515 14:33:40.029234 140402429237056 controller.py:252]  eval | step:  200000 | running 625 steps of evaluation...
I0515 14:37:47.890173 140402429237056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0515 14:42:11.283824 140402429237056 controller.py:261]  eval | step:  200000 | eval time:  511.3 sec | output: 
    {'3': {'avg_iou': 0.45590815,
           'avg_obj': 0.09505451,
           'box_loss': 0.53776395,
           'class_loss': 0.010348497,
           'conf_loss': 0.021440933,
           'precision50': 0.22255567,
           'recall50': 0.050740022},
     '4': {'avg_iou': 0.67117107,
           'avg_obj': 0.23360361,
           'box_loss': 0.42861986,
           'class_loss': 0.011861765,
           'conf_loss': 0.019667115,
           'precision50': 0.47089273,
           'recall50': 0.18973173},
     '5': {'avg_iou': 0.7456954,
           'avg_obj': 0.36288092,
           'box_loss': 0.2105158,
           'class_loss': 0.01025103,
           'conf_loss': 0.015389089,
           'precision50': 0.6214962,
           'recall50': 0.34694618},
     'AP': 0.13014224,
     'AP50': 0.19924366,
     'AP75': 0.13955173,
     'APl': 0.19740604,
     'APm': 0.11395719,
     'APs': 0.024524491,
     'ARl': 0.52879995,
     'ARm': 0.3875626,
     'ARmax1': 0.19891204,
     'ARmax10': 0.35185662,
     'ARmax100': 0.3744181,
     'ARs': 0.13002284,
     'global': {'total_loss': 1.2658583},
     'validation_loss': 1.2658583}
I0515 14:42:30.050508 140402429237056 controller.py:211] train | step:  200000 | training until step 220000...
I0515 16:06:21.459599 140402429237056 controller.py:425] train | step:  210000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5923623,
           'avg_obj': 0.13031672,
           'box_loss': 1.0239824,
           'class_loss': 0.01428791,
           'conf_loss': 0.03316416,
           'precision50': 0.3168783,
           'recall50': 0.04961039},
     '4': {'avg_iou': 0.7160164,
           'avg_obj': 0.25511202,
           'box_loss': 0.680109,
           'class_loss': 0.013953383,
           'conf_loss': 0.029353382,
           'precision50': 0.57902634,
           'recall50': 0.18838055},
     '5': {'avg_iou': 0.7683489,
           'avg_obj': 0.37016964,
           'box_loss': 0.27801645,
           'class_loss': 0.0121969255,
           'conf_loss': 0.019341959,
           'precision50': 0.6789582,
           'recall50': 0.35529318},
     'global': {'total_loss': 16.835268},
     'learning_rate': 0.005157283,
     'training_loss': 16.835268}
I0515 16:07:09.521148 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-210000.
I0515 17:35:06.112374 140402429237056 controller.py:425] train | step:  220000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.5942036,
           'avg_obj': 0.13238801,
           'box_loss': 1.0195528,
           'class_loss': 0.014156203,
           'conf_loss': 0.033093505,
           'precision50': 0.32278293,
           'recall50': 0.051350817},
     '4': {'avg_iou': 0.718081,
           'avg_obj': 0.2584109,
           'box_loss': 0.676144,
           'class_loss': 0.013787448,
           'conf_loss': 0.029290423,
           'precision50': 0.5821516,
           'recall50': 0.19275057},
     '5': {'avg_iou': 0.7705443,
           'avg_obj': 0.3741689,
           'box_loss': 0.27591226,
           'class_loss': 0.012050536,
           'conf_loss': 0.019279696,
           'precision50': 0.68222886,
           'recall50': 0.36106548},
     'global': {'total_loss': 16.74617},
     'learning_rate': 0.0048287087,
     'training_loss': 16.74617}
I0515 17:35:53.770251 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-220000.
I0515 17:35:53.777515 140402429237056 controller.py:252]  eval | step:  220000 | running 625 steps of evaluation...
I0515 17:40:07.654322 140402429237056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0515 17:44:32.865889 140402429237056 controller.py:261]  eval | step:  220000 | eval time:  519.1 sec | output: 
    {'3': {'avg_iou': 0.45852402,
           'avg_obj': 0.099231295,
           'box_loss': 0.53291535,
           'class_loss': 0.010091065,
           'conf_loss': 0.021294666,
           'precision50': 0.23294951,
           'recall50': 0.055646863},
     '4': {'avg_iou': 0.67429954,
           'avg_obj': 0.23876777,
           'box_loss': 0.42300966,
           'class_loss': 0.011469688,
           'conf_loss': 0.01949544,
           'precision50': 0.4757747,
           'recall50': 0.19679105},
     '5': {'avg_iou': 0.74864274,
           'avg_obj': 0.36927462,
           'box_loss': 0.20793426,
           'class_loss': 0.009913187,
           'conf_loss': 0.015378177,
           'precision50': 0.6285128,
           'recall50': 0.3558371},
     'AP': 0.13959385,
     'AP50': 0.21380728,
     'AP75': 0.14928238,
     'APl': 0.20907699,
     'APm': 0.12424224,
     'APs': 0.027386228,
     'ARl': 0.5410862,
     'ARm': 0.40022042,
     'ARmax1': 0.20518315,
     'ARmax10': 0.36109436,
     'ARmax100': 0.3839381,
     'ARs': 0.13742188,
     'global': {'total_loss': 1.2515018},
     'validation_loss': 1.2515018}

train | step:  180000 | training until step 200000...
train | step:  190000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.58766174,
           'avg_obj': 0.123995736,
           'box_loss': 1.0361282,
           'class_loss': 0.01468184,
           'conf_loss': 0.033489726,
           'precision50': 0.3019023,
           'recall50': 0.044775113},
     '4': {'avg_iou': 0.71049184,
           'avg_obj': 0.24591646,
           'box_loss': 0.6940729,
           'class_loss': 0.01441766,
           'conf_loss': 0.029711554,
           'precision50': 0.5681114,
           'recall50': 0.1765769},
     '5': {'avg_iou': 0.76287645,
           'avg_obj': 0.36006865,
           'box_loss': 0.28470507,
           'class_loss': 0.01260702,
           'conf_loss': 0.019583179,
           'precision50': 0.67017263,
           'recall50': 0.3405657},
     'global': {'total_loss': 17.115187},
     'learning_rate': 0.0058302353,
     'training_loss': 17.115187}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-190000.
train | step:  200000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.59001166,
           'avg_obj': 0.127397,
           'box_loss': 1.0298892,
           'class_loss': 0.014463652,
           'conf_loss': 0.03330422,
           'precision50': 0.30935332,
           'recall50': 0.04721843},
     '4': {'avg_iou': 0.7135613,
           'avg_obj': 0.2506746,
           'box_loss': 0.68548787,
           'class_loss': 0.014175468,
           'conf_loss': 0.029491195,
           'precision50': 0.5743942,
           'recall50': 0.18278691},
     '5': {'avg_iou': 0.7656597,
           'avg_obj': 0.3655608,
           'box_loss': 0.28126317,
           'class_loss': 0.012399341,
           'conf_loss': 0.019450972,
           'precision50': 0.6747083,
           'recall50': 0.34830874},
     'global': {'total_loss': 16.959421},
     'learning_rate': 0.005491929,
     'training_loss': 16.959421}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-200000.
 eval | step:  200000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=181.03s).
Accumulating evaluation results...
DONE (t=29.00s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.130
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.199
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.140
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.025
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.114
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.197
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.199
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.352
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.374
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.130
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.388
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.529
 eval | step:  200000 | eval time:  511.3 sec | output: 
    {'3': {'avg_iou': 0.45590815,
           'avg_obj': 0.09505451,
           'box_loss': 0.53776395,
           'class_loss': 0.010348497,
           'conf_loss': 0.021440933,
           'precision50': 0.22255567,
           'recall50': 0.050740022},
     '4': {'avg_iou': 0.67117107,
           'avg_obj': 0.23360361,
           'box_loss': 0.42861986,
           'class_loss': 0.011861765,
           'conf_loss': 0.019667115,
           'precision50': 0.47089273,
           'recall50': 0.18973173},
     '5': {'avg_iou': 0.7456954,
           'avg_obj': 0.36288092,
           'box_loss': 0.2105158,
           'class_loss': 0.01025103,
           'conf_loss': 0.015389089,
           'precision50': 0.6214962,
           'recall50': 0.34694618},
     'AP': 0.13014224,
     'AP50': 0.19924366,
     'AP75': 0.13955173,
     'APl': 0.19740604,
     'APm': 0.11395719,
     'APs': 0.024524491,
     'ARl': 0.52879995,
     'ARm': 0.3875626,
     'ARmax1': 0.19891204,
     'ARmax10': 0.35185662,
     'ARmax100': 0.3744181,
     'ARs': 0.13002284,
     'global': {'total_loss': 1.2658583},
     'validation_loss': 1.2658583}
train | step:  200000 | training until step 220000...
train | step:  210000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5923623,
           'avg_obj': 0.13031672,
           'box_loss': 1.0239824,
           'class_loss': 0.01428791,
           'conf_loss': 0.03316416,
           'precision50': 0.3168783,
           'recall50': 0.04961039},
     '4': {'avg_iou': 0.7160164,
           'avg_obj': 0.25511202,
           'box_loss': 0.680109,
           'class_loss': 0.013953383,
           'conf_loss': 0.029353382,
           'precision50': 0.57902634,
           'recall50': 0.18838055},
     '5': {'avg_iou': 0.7683489,
           'avg_obj': 0.37016964,
           'box_loss': 0.27801645,
           'class_loss': 0.0121969255,
           'conf_loss': 0.019341959,
           'precision50': 0.6789582,
           'recall50': 0.35529318},
     'global': {'total_loss': 16.835268},
     'learning_rate': 0.005157283,
     'training_loss': 16.835268}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-210000.
train | step:  220000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.5942036,
           'avg_obj': 0.13238801,
           'box_loss': 1.0195528,
           'class_loss': 0.014156203,
           'conf_loss': 0.033093505,
           'precision50': 0.32278293,
           'recall50': 0.051350817},
     '4': {'avg_iou': 0.718081,
           'avg_obj': 0.2584109,
           'box_loss': 0.676144,
           'class_loss': 0.013787448,
           'conf_loss': 0.029290423,
           'precision50': 0.5821516,
           'recall50': 0.19275057},
     '5': {'avg_iou': 0.7705443,
           'avg_obj': 0.3741689,
           'box_loss': 0.27591226,
           'class_loss': 0.012050536,
           'conf_loss': 0.019279696,
           'precision50': 0.68222886,
           'recall50': 0.36106548},
     'global': {'total_loss': 16.74617},
     'learning_rate': 0.0048287087,
     'training_loss': 16.74617}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-220000.
 eval | step:  220000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=184.14s).
Accumulating evaluation results...
DONE (t=27.36s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.140
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.214
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.149
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.027
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.124
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.209
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.205
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.361
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.384
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.137
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.400
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.541
 eval | step:  220000 | eval time:  519.1 sec | output: 
    {'3': {'avg_iou': 0.45852402,
           'avg_obj': 0.099231295,
           'box_loss': 0.53291535,
           'class_loss': 0.010091065,
           'conf_loss': 0.021294666,
           'precision50': 0.23294951,
           'recall50': 0.055646863},
     '4': {'avg_iou': 0.67429954,
           'avg_obj': 0.23876777,
           'box_loss': 0.42300966,
           'class_loss': 0.011469688,
           'conf_loss': 0.01949544,
           'precision50': 0.4757747,
           'recall50': 0.19679105},
     '5': {'avg_iou': 0.74864274,
           'avg_obj': 0.36927462,
           'box_loss': 0.20793426,
           'class_loss': 0.009913187,
           'conf_loss': 0.015378177,
           'precision50': 0.6285128,
           'recall50': 0.3558371},
     'AP': 0.13959385,
     'AP50': 0.21380728,
     'AP75': 0.14928238,
     'APl': 0.20907699,
     'APm': 0.12424224,
     'APs': 0.027386228,
     'ARl': 0.5410862,
     'ARm': 0.40022042,
     'ARmax1': 0.20518315,
     'ARmax10': 0.36109436,
     'ARmax100': 0.3839381,
     'ARs': 0.13742188,
     'global': {'total_loss': 1.2515018},
     'validation_loss': 1.2515018}I0515 17:44:53.627341 140402429237056 controller.py:211] train | step:  220000 | training until step 240000...
I0515 19:04:55.305619 140402429237056 controller.py:425] train | step:  230000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.5956191,
           'avg_obj': 0.13473688,
           'box_loss': 1.0174456,
           'class_loss': 0.014030922,
           'conf_loss': 0.033004887,
           'precision50': 0.3276774,
           'recall50': 0.053085115},
     '4': {'avg_iou': 0.72028345,
           'avg_obj': 0.26184803,
           'box_loss': 0.6712046,
           'class_loss': 0.013613823,
           'conf_loss': 0.029193716,
           'precision50': 0.58649063,
           'recall50': 0.19703124},
     '5': {'avg_iou': 0.77238995,
           'avg_obj': 0.3781112,
           'box_loss': 0.27395275,
           'class_loss': 0.011887014,
           'conf_loss': 0.019200403,
           'precision50': 0.6859414,
           'recall50': 0.3669446},
     'global': {'total_loss': 16.668243},
     'learning_rate': 0.004508574,
     'training_loss': 16.668243}
I0515 19:05:48.323555 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-230000.
I0515 20:32:50.975670 140402429237056 controller.py:425] train | step:  240000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.5972497,
           'avg_obj': 0.13678849,
           'box_loss': 1.0125494,
           'class_loss': 0.013855081,
           'conf_loss': 0.032874916,
           'precision50': 0.33310026,
           'recall50': 0.054705452},
     '4': {'avg_iou': 0.72195786,
           'avg_obj': 0.26509285,
           'box_loss': 0.66628206,
           'class_loss': 0.013431514,
           'conf_loss': 0.029041171,
           'precision50': 0.5891885,
           'recall50': 0.20103581},
     '5': {'avg_iou': 0.77416784,
           'avg_obj': 0.38126242,
           'box_loss': 0.27118528,
           'class_loss': 0.011743302,
           'conf_loss': 0.019087154,
           'precision50': 0.68733835,
           'recall50': 0.3708561},
     'global': {'total_loss': 16.560373},
     'learning_rate': 0.0041991845,
     'training_loss': 16.560373}
I0515 20:33:37.965383 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-240000.
I0515 20:33:37.970473 140402429237056 controller.py:252]  eval | step:  240000 | running 625 steps of evaluation...
I0515 20:37:38.256079 140402429237056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0515 20:41:56.521659 140402429237056 controller.py:261]  eval | step:  240000 | eval time:  498.6 sec | output: 
    {'3': {'avg_iou': 0.460165,
           'avg_obj': 0.10065955,
           'box_loss': 0.5294502,
           'class_loss': 0.009834275,
           'conf_loss': 0.021165133,
           'precision50': 0.235806,
           'recall50': 0.056800738},
     '4': {'avg_iou': 0.6769058,
           'avg_obj': 0.24490456,
           'box_loss': 0.41882238,
           'class_loss': 0.01112187,
           'conf_loss': 0.019351112,
           'precision50': 0.48304555,
           'recall50': 0.20453827},
     '5': {'avg_iou': 0.75132,
           'avg_obj': 0.377396,
           'box_loss': 0.20540869,
           'class_loss': 0.0096222805,
           'conf_loss': 0.015188346,
           'precision50': 0.6389458,
           'recall50': 0.3666978},
     'AP': 0.14788824,
     'AP50': 0.22551063,
     'AP75': 0.1581122,
     'APl': 0.21892051,
     'APm': 0.13424711,
     'APs': 0.031139486,
     'ARl': 0.54977375,
     'ARm': 0.41200212,
     'ARmax1': 0.20975111,
     'ARmax10': 0.36955327,
     'ARmax100': 0.39347228,
     'ARs': 0.14445998,
     'global': {'total_loss': 1.2399635},
     'validation_loss': 1.2399635}
I0515 20:42:18.334984 140402429237056 controller.py:211] train | step:  240000 | training until step 260000...
I0515 22:02:53.281313 140402429237056 controller.py:425] train | step:  250000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.5987115,
           'avg_obj': 0.13859601,
           'box_loss': 1.007365,
           'class_loss': 0.013725574,
           'conf_loss': 0.032756448,
           'precision50': 0.33670393,
           'recall50': 0.056286298},
     '4': {'avg_iou': 0.7237129,
           'avg_obj': 0.26797602,
           'box_loss': 0.66154623,
           'class_loss': 0.013288474,
           'conf_loss': 0.028915036,
           'precision50': 0.59240466,
           'recall50': 0.20489441},
     '5': {'avg_iou': 0.7761904,
           'avg_obj': 0.38485175,
           'box_loss': 0.26876295,
           'class_loss': 0.011602003,
           'conf_loss': 0.019008053,
           'precision50': 0.6913935,
           'recall50': 0.37625846},
     'global': {'total_loss': 16.455784},
     'learning_rate': 0.0039027706,
     'training_loss': 16.455784}
I0515 22:03:40.281188 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-250000.
I0515 23:31:44.919673 140402429237056 controller.py:425] train | step:  260000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.5999618,
           'avg_obj': 0.1407498,
           'box_loss': 1.0068938,
           'class_loss': 0.013613971,
           'conf_loss': 0.032720737,
           'precision50': 0.3415421,
           'recall50': 0.0579344},
     '4': {'avg_iou': 0.7251914,
           'avg_obj': 0.27097997,
           'box_loss': 0.6588693,
           'class_loss': 0.0131296795,
           'conf_loss': 0.028845584,
           'precision50': 0.5947,
           'recall50': 0.20843704},
     '5': {'avg_iou': 0.77770907,
           'avg_obj': 0.38799903,
           'box_loss': 0.26719645,
           'class_loss': 0.011470411,
           'conf_loss': 0.018936373,
           'precision50': 0.6939904,
           'recall50': 0.3805482},
     'global': {'total_loss': 16.413408},
     'learning_rate': 0.0036214672,
     'training_loss': 16.413408}
I0515 23:32:32.999181 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-260000.
I0515 23:32:33.005076 140402429237056 controller.py:252]  eval | step:  260000 | running 625 steps of evaluation...
I0515 23:36:39.806330 140402429237056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0515 23:40:46.237187 140402429237056 controller.py:261]  eval | step:  260000 | eval time:  493.2 sec | output: 
    {'3': {'avg_iou': 0.46175098,
           'avg_obj': 0.10479023,
           'box_loss': 0.5264867,
           'class_loss': 0.009607276,
           'conf_loss': 0.021091197,
           'precision50': 0.24432373,
           'recall50': 0.061113365},
     '4': {'avg_iou': 0.6790072,
           'avg_obj': 0.25222048,
           'box_loss': 0.41540962,
           'class_loss': 0.010819241,
           'conf_loss': 0.019225061,
           'precision50': 0.4880787,
           'recall50': 0.2145796},
     '5': {'avg_iou': 0.753753,
           'avg_obj': 0.38717875,
           'box_loss': 0.20309328,
           'class_loss': 0.00937027,
           'conf_loss': 0.015004663,
           'precision50': 0.6470084,
           'recall50': 0.38000864},
     'AP': 0.15511353,
     'AP50': 0.23621732,
     'AP75': 0.1672725,
     'APl': 0.22831503,
     'APm': 0.14285438,
     'APs': 0.03222177,
     'ARl': 0.5536096,
     'ARm': 0.42056465,
     'ARmax1': 0.21337482,
     'ARmax10': 0.37531617,
     'ARmax100': 0.3995808,
     'ARs': 0.15025993,
     'global': {'total_loss': 1.2301077},
     'validation_loss': 1.2301077}

train | step:  220000 | training until step 240000...
train | step:  230000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.5956191,
           'avg_obj': 0.13473688,
           'box_loss': 1.0174456,
           'class_loss': 0.014030922,
           'conf_loss': 0.033004887,
           'precision50': 0.3276774,
           'recall50': 0.053085115},
     '4': {'avg_iou': 0.72028345,
           'avg_obj': 0.26184803,
           'box_loss': 0.6712046,
           'class_loss': 0.013613823,
           'conf_loss': 0.029193716,
           'precision50': 0.58649063,
           'recall50': 0.19703124},
     '5': {'avg_iou': 0.77238995,
           'avg_obj': 0.3781112,
           'box_loss': 0.27395275,
           'class_loss': 0.011887014,
           'conf_loss': 0.019200403,
           'precision50': 0.6859414,
           'recall50': 0.3669446},
     'global': {'total_loss': 16.668243},
     'learning_rate': 0.004508574,
     'training_loss': 16.668243}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-230000.
train | step:  240000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.5972497,
           'avg_obj': 0.13678849,
           'box_loss': 1.0125494,
           'class_loss': 0.013855081,
           'conf_loss': 0.032874916,
           'precision50': 0.33310026,
           'recall50': 0.054705452},
     '4': {'avg_iou': 0.72195786,
           'avg_obj': 0.26509285,
           'box_loss': 0.66628206,
           'class_loss': 0.013431514,
           'conf_loss': 0.029041171,
           'precision50': 0.5891885,
           'recall50': 0.20103581},
     '5': {'avg_iou': 0.77416784,
           'avg_obj': 0.38126242,
           'box_loss': 0.27118528,
           'class_loss': 0.011743302,
           'conf_loss': 0.019087154,
           'precision50': 0.68733835,
           'recall50': 0.3708561},
     'global': {'total_loss': 16.560373},
     'learning_rate': 0.0041991845,
     'training_loss': 16.560373}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-240000.
 eval | step:  240000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.35s).
Accumulating evaluation results...
DONE (t=27.94s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.148
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.226
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.158
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.031
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.134
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.219
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.210
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.370
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.393
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.144
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.412
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.550
 eval | step:  240000 | eval time:  498.6 sec | output: 
    {'3': {'avg_iou': 0.460165,
           'avg_obj': 0.10065955,
           'box_loss': 0.5294502,
           'class_loss': 0.009834275,
           'conf_loss': 0.021165133,
           'precision50': 0.235806,
           'recall50': 0.056800738},
     '4': {'avg_iou': 0.6769058,
           'avg_obj': 0.24490456,
           'box_loss': 0.41882238,
           'class_loss': 0.01112187,
           'conf_loss': 0.019351112,
           'precision50': 0.48304555,
           'recall50': 0.20453827},
     '5': {'avg_iou': 0.75132,
           'avg_obj': 0.377396,
           'box_loss': 0.20540869,
           'class_loss': 0.0096222805,
           'conf_loss': 0.015188346,
           'precision50': 0.6389458,
           'recall50': 0.3666978},
     'AP': 0.14788824,
     'AP50': 0.22551063,
     'AP75': 0.1581122,
     'APl': 0.21892051,
     'APm': 0.13424711,
     'APs': 0.031139486,
     'ARl': 0.54977375,
     'ARm': 0.41200212,
     'ARmax1': 0.20975111,
     'ARmax10': 0.36955327,
     'ARmax100': 0.39347228,
     'ARs': 0.14445998,
     'global': {'total_loss': 1.2399635},
     'validation_loss': 1.2399635}
train | step:  240000 | training until step 260000...
train | step:  250000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.5987115,
           'avg_obj': 0.13859601,
           'box_loss': 1.007365,
           'class_loss': 0.013725574,
           'conf_loss': 0.032756448,
           'precision50': 0.33670393,
           'recall50': 0.056286298},
     '4': {'avg_iou': 0.7237129,
           'avg_obj': 0.26797602,
           'box_loss': 0.66154623,
           'class_loss': 0.013288474,
           'conf_loss': 0.028915036,
           'precision50': 0.59240466,
           'recall50': 0.20489441},
     '5': {'avg_iou': 0.7761904,
           'avg_obj': 0.38485175,
           'box_loss': 0.26876295,
           'class_loss': 0.011602003,
           'conf_loss': 0.019008053,
           'precision50': 0.6913935,
           'recall50': 0.37625846},
     'global': {'total_loss': 16.455784},
     'learning_rate': 0.0039027706,
     'training_loss': 16.455784}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-250000.
train | step:  260000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.5999618,
           'avg_obj': 0.1407498,
           'box_loss': 1.0068938,
           'class_loss': 0.013613971,
           'conf_loss': 0.032720737,
           'precision50': 0.3415421,
           'recall50': 0.0579344},
     '4': {'avg_iou': 0.7251914,
           'avg_obj': 0.27097997,
           'box_loss': 0.6588693,
           'class_loss': 0.0131296795,
           'conf_loss': 0.028845584,
           'precision50': 0.5947,
           'recall50': 0.20843704},
     '5': {'avg_iou': 0.77770907,
           'avg_obj': 0.38799903,
           'box_loss': 0.26719645,
           'class_loss': 0.011470411,
           'conf_loss': 0.018936373,
           'precision50': 0.6939904,
           'recall50': 0.3805482},
     'global': {'total_loss': 16.413408},
     'learning_rate': 0.0036214672,
     'training_loss': 16.413408}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-260000.
 eval | step:  260000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=167.41s).
Accumulating evaluation results...
DONE (t=26.09s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.155
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.236
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.167
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.032
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.143
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.228
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.213
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.375
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.400
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.150
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.421
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.554
 eval | step:  260000 | eval time:  493.2 sec | output: 
    {'3': {'avg_iou': 0.46175098,
           'avg_obj': 0.10479023,
           'box_loss': 0.5264867,
           'class_loss': 0.009607276,
           'conf_loss': 0.021091197,
           'precision50': 0.24432373,
           'recall50': 0.061113365},
     '4': {'avg_iou': 0.6790072,
           'avg_obj': 0.25222048,
           'box_loss': 0.41540962,
           'class_loss': 0.010819241,
           'conf_loss': 0.019225061,
           'precision50': 0.4880787,
           'recall50': 0.2145796},
     '5': {'avg_iou': 0.753753,
           'avg_obj': 0.38717875,
           'box_loss': 0.20309328,
           'class_loss': 0.00937027,
           'conf_loss': 0.015004663,
           'precision50': 0.6470084,
           'recall50': 0.38000864},
     'AP': 0.15511353,
     'AP50': 0.23621732,
     'AP75': 0.1672725,
     'APl': 0.22831503,
     'APm': 0.14285438,
     'APs': 0.03222177,
     'ARl': 0.5536096,
     'ARm': 0.42056465,
     'ARmax1': 0.21337482,
     'ARmax10': 0.37531617,
     'ARmax100': 0.3995808,
     'ARs': 0.15025993,
     'global': {'total_loss': 1.2301077},
     'validation_loss': 1.2301077}I0515 23:41:07.724165 140402429237056 controller.py:211] train | step:  260000 | training until step 280000...
I0516 01:01:28.096049 140402429237056 controller.py:425] train | step:  270000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6013983,
           'avg_obj': 0.14209217,
           'box_loss': 1.0016563,
           'class_loss': 0.013485767,
           'conf_loss': 0.0326012,
           'precision50': 0.3442913,
           'recall50': 0.058897827},
     '4': {'avg_iou': 0.72683495,
           'avg_obj': 0.2734545,
           'box_loss': 0.65399855,
           'class_loss': 0.013004284,
           'conf_loss': 0.028713103,
           'precision50': 0.5985503,
           'recall50': 0.21205828},
     '5': {'avg_iou': 0.7791269,
           'avg_obj': 0.39090842,
           'box_loss': 0.26525515,
           'class_loss': 0.011352952,
           'conf_loss': 0.018844588,
           'precision50': 0.69580626,
           'recall50': 0.38461196},
     'global': {'total_loss': 16.311281},
     'learning_rate': 0.003357301,
     'training_loss': 16.311281}
I0516 01:02:15.094424 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-270000.
I0516 02:29:26.881865 140402429237056 controller.py:425] train | step:  280000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.60245943,
           'avg_obj': 0.14384605,
           'box_loss': 0.9987732,
           'class_loss': 0.013378143,
           'conf_loss': 0.032510154,
           'precision50': 0.34693488,
           'recall50': 0.059990857},
     '4': {'avg_iou': 0.7280296,
           'avg_obj': 0.27594543,
           'box_loss': 0.65148467,
           'class_loss': 0.012871947,
           'conf_loss': 0.028639227,
           'precision50': 0.59947723,
           'recall50': 0.21490036},
     '5': {'avg_iou': 0.7804817,
           'avg_obj': 0.39345145,
           'box_loss': 0.26369113,
           'class_loss': 0.011240933,
           'conf_loss': 0.01880351,
           'precision50': 0.6982467,
           'recall50': 0.3885173},
     'global': {'total_loss': 16.251152},
     'learning_rate': 0.003112175,
     'training_loss': 16.251152}
I0516 02:30:15.023257 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-280000.
I0516 02:30:15.030507 140402429237056 controller.py:252]  eval | step:  280000 | running 625 steps of evaluation...
I0516 02:34:22.858731 140402429237056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0516 02:38:31.262278 140402429237056 controller.py:261]  eval | step:  280000 | eval time:  496.2 sec | output: 
    {'3': {'avg_iou': 0.46330646,
           'avg_obj': 0.10470495,
           'box_loss': 0.523409,
           'class_loss': 0.00939564,
           'conf_loss': 0.020929664,
           'precision50': 0.24437495,
           'recall50': 0.060759053},
     '4': {'avg_iou': 0.6809594,
           'avg_obj': 0.2549908,
           'box_loss': 0.41180253,
           'class_loss': 0.0105580455,
           'conf_loss': 0.019073287,
           'precision50': 0.4959658,
           'recall50': 0.21867734},
     '5': {'avg_iou': 0.7561188,
           'avg_obj': 0.38966107,
           'box_loss': 0.20093323,
           'class_loss': 0.009142083,
           'conf_loss': 0.014884457,
           'precision50': 0.65120816,
           'recall50': 0.38437805},
     'AP': 0.16138619,
     'AP50': 0.24506316,
     'AP75': 0.17339922,
     'APl': 0.23860699,
     'APm': 0.1490576,
     'APs': 0.03535188,
     'ARl': 0.56220233,
     'ARm': 0.42975143,
     'ARmax1': 0.21625121,
     'ARmax10': 0.38148737,
     'ARmax100': 0.4068696,
     'ARs': 0.15576701,
     'global': {'total_loss': 1.2201282},
     'validation_loss': 1.2201282}
I0516 02:38:49.560477 140402429237056 controller.py:211] train | step:  280000 | training until step 300000...
I0516 03:59:12.202146 140402429237056 controller.py:425] train | step:  290000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6034885,
           'avg_obj': 0.14541213,
           'box_loss': 0.99820065,
           'class_loss': 0.013276918,
           'conf_loss': 0.03249773,
           'precision50': 0.35159445,
           'recall50': 0.061630506},
     '4': {'avg_iou': 0.72947544,
           'avg_obj': 0.27822608,
           'box_loss': 0.6493405,
           'class_loss': 0.012758337,
           'conf_loss': 0.028613867,
           'precision50': 0.6028887,
           'recall50': 0.21793792},
     '5': {'avg_iou': 0.7818033,
           'avg_obj': 0.39614782,
           'box_loss': 0.2626825,
           'class_loss': 0.011129671,
           'conf_loss': 0.018765535,
           'precision50': 0.6998191,
           'recall50': 0.39182672},
     'global': {'total_loss': 16.21806},
     'learning_rate': 0.002887857,
     'training_loss': 16.21806}
I0516 03:59:58.866913 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-290000.
I0516 05:27:54.762301 140402429237056 controller.py:425] train | step:  300000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6043325,
           'avg_obj': 0.146652,
           'box_loss': 0.99607694,
           'class_loss': 0.013165594,
           'conf_loss': 0.03244356,
           'precision50': 0.3536151,
           'recall50': 0.06263617},
     '4': {'avg_iou': 0.7304351,
           'avg_obj': 0.2800854,
           'box_loss': 0.6462577,
           'class_loss': 0.012646343,
           'conf_loss': 0.028522186,
           'precision50': 0.60436726,
           'recall50': 0.22034802},
     '5': {'avg_iou': 0.782904,
           'avg_obj': 0.3981298,
           'box_loss': 0.26113847,
           'class_loss': 0.011035798,
           'conf_loss': 0.018710932,
           'precision50': 0.70157135,
           'recall50': 0.3948346},
     'global': {'total_loss': 16.160013},
     'learning_rate': 0.002685961,
     'training_loss': 16.160013}
I0516 05:28:42.192809 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-300000.
I0516 05:28:42.198719 140402429237056 controller.py:252]  eval | step:  300000 | running 625 steps of evaluation...
I0516 05:32:48.297899 140402429237056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0516 05:36:57.062001 140402429237056 controller.py:261]  eval | step:  300000 | eval time:  494.9 sec | output: 
    {'3': {'avg_iou': 0.4643789,
           'avg_obj': 0.108020104,
           'box_loss': 0.5208539,
           'class_loss': 0.009220845,
           'conf_loss': 0.020843701,
           'precision50': 0.24995142,
           'recall50': 0.06454349},
     '4': {'avg_iou': 0.68245596,
           'avg_obj': 0.2614546,
           'box_loss': 0.40926355,
           'class_loss': 0.010316667,
           'conf_loss': 0.018972935,
           'precision50': 0.50660694,
           'recall50': 0.22703469},
     '5': {'avg_iou': 0.75774574,
           'avg_obj': 0.39799184,
           'box_loss': 0.199549,
           'class_loss': 0.008944173,
           'conf_loss': 0.014815765,
           'precision50': 0.6603453,
           'recall50': 0.39617845},
     'AP': 0.16783449,
     'AP50': 0.25501356,
     'AP75': 0.17990278,
     'APl': 0.2467198,
     'APm': 0.15668027,
     'APs': 0.035974987,
     'ARl': 0.5711227,
     'ARm': 0.43438077,
     'ARmax1': 0.22053261,
     'ARmax10': 0.3870818,
     'ARmax100': 0.41295454,
     'ARs': 0.16193837,
     'global': {'total_loss': 1.2127805},
     'validation_loss': 1.2127805}

train | step:  260000 | training until step 280000...
train | step:  270000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6013983,
           'avg_obj': 0.14209217,
           'box_loss': 1.0016563,
           'class_loss': 0.013485767,
           'conf_loss': 0.0326012,
           'precision50': 0.3442913,
           'recall50': 0.058897827},
     '4': {'avg_iou': 0.72683495,
           'avg_obj': 0.2734545,
           'box_loss': 0.65399855,
           'class_loss': 0.013004284,
           'conf_loss': 0.028713103,
           'precision50': 0.5985503,
           'recall50': 0.21205828},
     '5': {'avg_iou': 0.7791269,
           'avg_obj': 0.39090842,
           'box_loss': 0.26525515,
           'class_loss': 0.011352952,
           'conf_loss': 0.018844588,
           'precision50': 0.69580626,
           'recall50': 0.38461196},
     'global': {'total_loss': 16.311281},
     'learning_rate': 0.003357301,
     'training_loss': 16.311281}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-270000.
train | step:  280000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.60245943,
           'avg_obj': 0.14384605,
           'box_loss': 0.9987732,
           'class_loss': 0.013378143,
           'conf_loss': 0.032510154,
           'precision50': 0.34693488,
           'recall50': 0.059990857},
     '4': {'avg_iou': 0.7280296,
           'avg_obj': 0.27594543,
           'box_loss': 0.65148467,
           'class_loss': 0.012871947,
           'conf_loss': 0.028639227,
           'precision50': 0.59947723,
           'recall50': 0.21490036},
     '5': {'avg_iou': 0.7804817,
           'avg_obj': 0.39345145,
           'box_loss': 0.26369113,
           'class_loss': 0.011240933,
           'conf_loss': 0.01880351,
           'precision50': 0.6982467,
           'recall50': 0.3885173},
     'global': {'total_loss': 16.251152},
     'learning_rate': 0.003112175,
     'training_loss': 16.251152}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-280000.
 eval | step:  280000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=165.99s).
Accumulating evaluation results...
DONE (t=26.97s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.161
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.245
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.173
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.035
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.149
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.239
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.216
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.381
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.407
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.156
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.430
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.562
 eval | step:  280000 | eval time:  496.2 sec | output: 
    {'3': {'avg_iou': 0.46330646,
           'avg_obj': 0.10470495,
           'box_loss': 0.523409,
           'class_loss': 0.00939564,
           'conf_loss': 0.020929664,
           'precision50': 0.24437495,
           'recall50': 0.060759053},
     '4': {'avg_iou': 0.6809594,
           'avg_obj': 0.2549908,
           'box_loss': 0.41180253,
           'class_loss': 0.0105580455,
           'conf_loss': 0.019073287,
           'precision50': 0.4959658,
           'recall50': 0.21867734},
     '5': {'avg_iou': 0.7561188,
           'avg_obj': 0.38966107,
           'box_loss': 0.20093323,
           'class_loss': 0.009142083,
           'conf_loss': 0.014884457,
           'precision50': 0.65120816,
           'recall50': 0.38437805},
     'AP': 0.16138619,
     'AP50': 0.24506316,
     'AP75': 0.17339922,
     'APl': 0.23860699,
     'APm': 0.1490576,
     'APs': 0.03535188,
     'ARl': 0.56220233,
     'ARm': 0.42975143,
     'ARmax1': 0.21625121,
     'ARmax10': 0.38148737,
     'ARmax100': 0.4068696,
     'ARs': 0.15576701,
     'global': {'total_loss': 1.2201282},
     'validation_loss': 1.2201282}
train | step:  280000 | training until step 300000...
train | step:  290000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6034885,
           'avg_obj': 0.14541213,
           'box_loss': 0.99820065,
           'class_loss': 0.013276918,
           'conf_loss': 0.03249773,
           'precision50': 0.35159445,
           'recall50': 0.061630506},
     '4': {'avg_iou': 0.72947544,
           'avg_obj': 0.27822608,
           'box_loss': 0.6493405,
           'class_loss': 0.012758337,
           'conf_loss': 0.028613867,
           'precision50': 0.6028887,
           'recall50': 0.21793792},
     '5': {'avg_iou': 0.7818033,
           'avg_obj': 0.39614782,
           'box_loss': 0.2626825,
           'class_loss': 0.011129671,
           'conf_loss': 0.018765535,
           'precision50': 0.6998191,
           'recall50': 0.39182672},
     'global': {'total_loss': 16.21806},
     'learning_rate': 0.002887857,
     'training_loss': 16.21806}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-290000.
train | step:  300000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6043325,
           'avg_obj': 0.146652,
           'box_loss': 0.99607694,
           'class_loss': 0.013165594,
           'conf_loss': 0.03244356,
           'precision50': 0.3536151,
           'recall50': 0.06263617},
     '4': {'avg_iou': 0.7304351,
           'avg_obj': 0.2800854,
           'box_loss': 0.6462577,
           'class_loss': 0.012646343,
           'conf_loss': 0.028522186,
           'precision50': 0.60436726,
           'recall50': 0.22034802},
     '5': {'avg_iou': 0.782904,
           'avg_obj': 0.3981298,
           'box_loss': 0.26113847,
           'class_loss': 0.011035798,
           'conf_loss': 0.018710932,
           'precision50': 0.70157135,
           'recall50': 0.3948346},
     'global': {'total_loss': 16.160013},
     'learning_rate': 0.002685961,
     'training_loss': 16.160013}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-300000.
 eval | step:  300000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=166.94s).
Accumulating evaluation results...
DONE (t=25.68s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.168
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.255
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.180
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.036
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.157
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.247
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.221
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.387
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.413
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.162
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.434
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.571
 eval | step:  300000 | eval time:  494.9 sec | output: 
    {'3': {'avg_iou': 0.4643789,
           'avg_obj': 0.108020104,
           'box_loss': 0.5208539,
           'class_loss': 0.009220845,
           'conf_loss': 0.020843701,
           'precision50': 0.24995142,
           'recall50': 0.06454349},
     '4': {'avg_iou': 0.68245596,
           'avg_obj': 0.2614546,
           'box_loss': 0.40926355,
           'class_loss': 0.010316667,
           'conf_loss': 0.018972935,
           'precision50': 0.50660694,
           'recall50': 0.22703469},
     '5': {'avg_iou': 0.75774574,
           'avg_obj': 0.39799184,
           'box_loss': 0.199549,
           'class_loss': 0.008944173,
           'conf_loss': 0.014815765,
           'precision50': 0.6603453,
           'recall50': 0.39617845},
     'AP': 0.16783449,
     'AP50': 0.25501356,
     'AP75': 0.17990278,
     'APl': 0.2467198,
     'APm': 0.15668027,
     'APs': 0.035974987,
     'ARl': 0.5711227,
     'ARm': 0.43438077,
     'ARmax1': 0.22053261,
     'ARmax10': 0.3870818,
     'ARmax100': 0.41295454,
     'ARs': 0.16193837,
     'global': {'total_loss': 1.2127805},
     'validation_loss': 1.2127805}I0516 05:37:15.175028 140402429237056 controller.py:211] train | step:  300000 | training until step 320000...
I0516 07:05:34.232158 140402429237056 controller.py:425] train | step:  310000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6053263,
           'avg_obj': 0.14806339,
           'box_loss': 0.9936352,
           'class_loss': 0.013070152,
           'conf_loss': 0.032351457,
           'precision50': 0.35664544,
           'recall50': 0.06374464},
     '4': {'avg_iou': 0.7318045,
           'avg_obj': 0.28241715,
           'box_loss': 0.64336264,
           'class_loss': 0.012524842,
           'conf_loss': 0.028442403,
           'precision50': 0.60658234,
           'recall50': 0.22345437},
     '5': {'avg_iou': 0.78400505,
           'avg_obj': 0.40036166,
           'box_loss': 0.26001254,
           'class_loss': 0.010919759,
           'conf_loss': 0.018659996,
           'precision50': 0.7032111,
           'recall50': 0.39800984},
     'global': {'total_loss': 16.103874},
     'learning_rate': 0.0025079434,
     'training_loss': 16.103874}
I0516 07:06:23.588750 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-310000.
I0516 08:39:05.742804 140402429237056 controller.py:425] train | step:  320000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6062584,
           'avg_obj': 0.14951438,
           'box_loss': 0.9925955,
           'class_loss': 0.012997539,
           'conf_loss': 0.032329533,
           'precision50': 0.36004928,
           'recall50': 0.06499299},
     '4': {'avg_iou': 0.73259825,
           'avg_obj': 0.2842207,
           'box_loss': 0.6412887,
           'class_loss': 0.0124376435,
           'conf_loss': 0.028369019,
           'precision50': 0.6084703,
           'recall50': 0.22579116},
     '5': {'avg_iou': 0.78487605,
           'avg_obj': 0.4021164,
           'box_loss': 0.25859517,
           'class_loss': 0.010842051,
           'conf_loss': 0.018596383,
           'precision50': 0.7047748,
           'recall50': 0.40057883},
     'global': {'total_loss': 16.06442},
     'learning_rate': 0.002355086,
     'training_loss': 16.06442}
I0516 08:39:55.040798 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-320000.
I0516 08:39:55.046863 140402429237056 controller.py:252]  eval | step:  320000 | running 625 steps of evaluation...
I0516 08:44:07.613044 140402429237056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0516 08:48:27.758063 140402429237056 controller.py:261]  eval | step:  320000 | eval time:  512.7 sec | output: 
    {'3': {'avg_iou': 0.4653842,
           'avg_obj': 0.109582424,
           'box_loss': 0.51886475,
           'class_loss': 0.0090710195,
           'conf_loss': 0.020758506,
           'precision50': 0.25299639,
           'recall50': 0.06624365},
     '4': {'avg_iou': 0.68387365,
           'avg_obj': 0.26303378,
           'box_loss': 0.4071197,
           'class_loss': 0.010135222,
           'conf_loss': 0.018927934,
           'precision50': 0.50850534,
           'recall50': 0.22975747},
     '5': {'avg_iou': 0.75870764,
           'avg_obj': 0.39961162,
           'box_loss': 0.198585,
           'class_loss': 0.008799348,
           'conf_loss': 0.014963968,
           'precision50': 0.6629853,
           'recall50': 0.39979956},
     'AP': 0.17322376,
     'AP50': 0.26234344,
     'AP75': 0.18693765,
     'APl': 0.25269622,
     'APm': 0.16236013,
     'APs': 0.03726811,
     'ARl': 0.5762841,
     'ARm': 0.44033092,
     'ARmax1': 0.22297809,
     'ARmax10': 0.39012733,
     'ARmax100': 0.41648474,
     'ARs': 0.16405606,
     'global': {'total_loss': 1.2072251},
     'validation_loss': 1.2072251}
I0516 08:48:46.327476 140402429237056 controller.py:211] train | step:  320000 | training until step 340000...
I0516 10:12:32.343530 140402429237056 controller.py:425] train | step:  330000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6071044,
           'avg_obj': 0.1507449,
           'box_loss': 0.9889873,
           'class_loss': 0.012918118,
           'conf_loss': 0.032207258,
           'precision50': 0.36209452,
           'recall50': 0.066194035},
     '4': {'avg_iou': 0.7338153,
           'avg_obj': 0.2862579,
           'box_loss': 0.63834035,
           'class_loss': 0.0123417545,
           'conf_loss': 0.028302258,
           'precision50': 0.60943574,
           'recall50': 0.2282447},
     '5': {'avg_iou': 0.786077,
           'avg_obj': 0.40422443,
           'box_loss': 0.2574264,
           'class_loss': 0.010782125,
           'conf_loss': 0.018562347,
           'precision50': 0.7060412,
           'recall50': 0.40318984},
     'global': {'total_loss': 15.998923},
     'learning_rate': 0.0022284898,
     'training_loss': 15.998923}
I0516 10:13:31.638269 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-330000.
I0516 11:44:29.851062 140402429237056 controller.py:425] train | step:  340000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.60805947,
           'avg_obj': 0.15203553,
           'box_loss': 0.98892754,
           'class_loss': 0.012853366,
           'conf_loss': 0.032255866,
           'precision50': 0.36520597,
           'recall50': 0.06703738},
     '4': {'avg_iou': 0.7343582,
           'avg_obj': 0.2875393,
           'box_loss': 0.63848567,
           'class_loss': 0.012258608,
           'conf_loss': 0.028316401,
           'precision50': 0.61207825,
           'recall50': 0.23022477},
     '5': {'avg_iou': 0.7865643,
           'avg_obj': 0.40566957,
           'box_loss': 0.25693807,
           'class_loss': 0.010693698,
           'conf_loss': 0.018524501,
           'precision50': 0.70800847,
           'recall50': 0.4055853},
     'global': {'total_loss': 15.99403},
     'learning_rate': 0.0021290681,
     'training_loss': 15.99403}
I0516 11:45:16.866206 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-340000.
I0516 11:45:16.873457 140402429237056 controller.py:252]  eval | step:  340000 | running 625 steps of evaluation...
I0516 11:49:30.361826 140402429237056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0516 11:53:49.411474 140402429237056 controller.py:261]  eval | step:  340000 | eval time:  512.5 sec | output: 
    {'3': {'avg_iou': 0.4661417,
           'avg_obj': 0.11220633,
           'box_loss': 0.51710504,
           'class_loss': 0.008933798,
           'conf_loss': 0.020702476,
           'precision50': 0.25991696,
           'recall50': 0.069141805},
     '4': {'avg_iou': 0.68499464,
           'avg_obj': 0.26784164,
           'box_loss': 0.40505618,
           'class_loss': 0.009966171,
           'conf_loss': 0.01886268,
           'precision50': 0.5115906,
           'recall50': 0.23688604},
     '5': {'avg_iou': 0.7598202,
           'avg_obj': 0.4036871,
           'box_loss': 0.19748874,
           'class_loss': 0.008650309,
           'conf_loss': 0.014842926,
           'precision50': 0.66669047,
           'recall50': 0.40571633},
     'AP': 0.17827246,
     'AP50': 0.26987132,
     'AP75': 0.19141541,
     'APl': 0.26074043,
     'APm': 0.1664394,
     'APs': 0.039419353,
     'ARl': 0.58083564,
     'ARm': 0.44672456,
     'ARmax1': 0.22528642,
     'ARmax10': 0.39369032,
     'ARmax100': 0.4212831,
     'ARs': 0.16713431,
     'global': {'total_loss': 1.2016077},
     'validation_loss': 1.2016077}

train | step:  300000 | training until step 320000...
train | step:  310000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6053263,
           'avg_obj': 0.14806339,
           'box_loss': 0.9936352,
           'class_loss': 0.013070152,
           'conf_loss': 0.032351457,
           'precision50': 0.35664544,
           'recall50': 0.06374464},
     '4': {'avg_iou': 0.7318045,
           'avg_obj': 0.28241715,
           'box_loss': 0.64336264,
           'class_loss': 0.012524842,
           'conf_loss': 0.028442403,
           'precision50': 0.60658234,
           'recall50': 0.22345437},
     '5': {'avg_iou': 0.78400505,
           'avg_obj': 0.40036166,
           'box_loss': 0.26001254,
           'class_loss': 0.010919759,
           'conf_loss': 0.018659996,
           'precision50': 0.7032111,
           'recall50': 0.39800984},
     'global': {'total_loss': 16.103874},
     'learning_rate': 0.0025079434,
     'training_loss': 16.103874}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-310000.
train | step:  320000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6062584,
           'avg_obj': 0.14951438,
           'box_loss': 0.9925955,
           'class_loss': 0.012997539,
           'conf_loss': 0.032329533,
           'precision50': 0.36004928,
           'recall50': 0.06499299},
     '4': {'avg_iou': 0.73259825,
           'avg_obj': 0.2842207,
           'box_loss': 0.6412887,
           'class_loss': 0.0124376435,
           'conf_loss': 0.028369019,
           'precision50': 0.6084703,
           'recall50': 0.22579116},
     '5': {'avg_iou': 0.78487605,
           'avg_obj': 0.4021164,
           'box_loss': 0.25859517,
           'class_loss': 0.010842051,
           'conf_loss': 0.018596383,
           'precision50': 0.7047748,
           'recall50': 0.40057883},
     'global': {'total_loss': 16.06442},
     'learning_rate': 0.002355086,
     'training_loss': 16.06442}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-320000.
 eval | step:  320000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=172.76s).
Accumulating evaluation results...
DONE (t=28.20s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.173
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.262
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.187
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.037
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.162
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.253
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.223
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.390
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.416
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.164
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.440
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.576
 eval | step:  320000 | eval time:  512.7 sec | output: 
    {'3': {'avg_iou': 0.4653842,
           'avg_obj': 0.109582424,
           'box_loss': 0.51886475,
           'class_loss': 0.0090710195,
           'conf_loss': 0.020758506,
           'precision50': 0.25299639,
           'recall50': 0.06624365},
     '4': {'avg_iou': 0.68387365,
           'avg_obj': 0.26303378,
           'box_loss': 0.4071197,
           'class_loss': 0.010135222,
           'conf_loss': 0.018927934,
           'precision50': 0.50850534,
           'recall50': 0.22975747},
     '5': {'avg_iou': 0.75870764,
           'avg_obj': 0.39961162,
           'box_loss': 0.198585,
           'class_loss': 0.008799348,
           'conf_loss': 0.014963968,
           'precision50': 0.6629853,
           'recall50': 0.39979956},
     'AP': 0.17322376,
     'AP50': 0.26234344,
     'AP75': 0.18693765,
     'APl': 0.25269622,
     'APm': 0.16236013,
     'APs': 0.03726811,
     'ARl': 0.5762841,
     'ARm': 0.44033092,
     'ARmax1': 0.22297809,
     'ARmax10': 0.39012733,
     'ARmax100': 0.41648474,
     'ARs': 0.16405606,
     'global': {'total_loss': 1.2072251},
     'validation_loss': 1.2072251}
train | step:  320000 | training until step 340000...
train | step:  330000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6071044,
           'avg_obj': 0.1507449,
           'box_loss': 0.9889873,
           'class_loss': 0.012918118,
           'conf_loss': 0.032207258,
           'precision50': 0.36209452,
           'recall50': 0.066194035},
     '4': {'avg_iou': 0.7338153,
           'avg_obj': 0.2862579,
           'box_loss': 0.63834035,
           'class_loss': 0.0123417545,
           'conf_loss': 0.028302258,
           'precision50': 0.60943574,
           'recall50': 0.2282447},
     '5': {'avg_iou': 0.786077,
           'avg_obj': 0.40422443,
           'box_loss': 0.2574264,
           'class_loss': 0.010782125,
           'conf_loss': 0.018562347,
           'precision50': 0.7060412,
           'recall50': 0.40318984},
     'global': {'total_loss': 15.998923},
     'learning_rate': 0.0022284898,
     'training_loss': 15.998923}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-330000.
train | step:  340000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.60805947,
           'avg_obj': 0.15203553,
           'box_loss': 0.98892754,
           'class_loss': 0.012853366,
           'conf_loss': 0.032255866,
           'precision50': 0.36520597,
           'recall50': 0.06703738},
     '4': {'avg_iou': 0.7343582,
           'avg_obj': 0.2875393,
           'box_loss': 0.63848567,
           'class_loss': 0.012258608,
           'conf_loss': 0.028316401,
           'precision50': 0.61207825,
           'recall50': 0.23022477},
     '5': {'avg_iou': 0.7865643,
           'avg_obj': 0.40566957,
           'box_loss': 0.25693807,
           'class_loss': 0.010693698,
           'conf_loss': 0.018524501,
           'precision50': 0.70800847,
           'recall50': 0.4055853},
     'global': {'total_loss': 15.99403},
     'learning_rate': 0.0021290681,
     'training_loss': 15.99403}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-340000.
 eval | step:  340000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=174.70s).
Accumulating evaluation results...
DONE (t=26.87s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.178
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.270
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.191
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.039
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.166
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.261
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.225
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.394
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.421
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.167
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.447
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.581
 eval | step:  340000 | eval time:  512.5 sec | output: 
    {'3': {'avg_iou': 0.4661417,
           'avg_obj': 0.11220633,
           'box_loss': 0.51710504,
           'class_loss': 0.008933798,
           'conf_loss': 0.020702476,
           'precision50': 0.25991696,
           'recall50': 0.069141805},
     '4': {'avg_iou': 0.68499464,
           'avg_obj': 0.26784164,
           'box_loss': 0.40505618,
           'class_loss': 0.009966171,
           'conf_loss': 0.01886268,
           'precision50': 0.5115906,
           'recall50': 0.23688604},
     '5': {'avg_iou': 0.7598202,
           'avg_obj': 0.4036871,
           'box_loss': 0.19748874,
           'class_loss': 0.008650309,
           'conf_loss': 0.014842926,
           'precision50': 0.66669047,
           'recall50': 0.40571633},
     'AP': 0.17827246,
     'AP50': 0.26987132,
     'AP75': 0.19141541,
     'APl': 0.26074043,
     'APm': 0.1664394,
     'APs': 0.039419353,
     'ARl': 0.58083564,
     'ARm': 0.44672456,
     'ARmax1': 0.22528642,
     'ARmax10': 0.39369032,
     'ARmax100': 0.4212831,
     'ARs': 0.16713431,
     'global': {'total_loss': 1.2016077},
     'validation_loss': 1.2016077}I0516 11:54:09.626044 140402429237056 controller.py:211] train | step:  340000 | training until step 360000...
I0516 13:15:09.905393 140402429237056 controller.py:425] train | step:  350000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6084664,
           'avg_obj': 0.15260889,
           'box_loss': 0.9887495,
           'class_loss': 0.012788452,
           'conf_loss': 0.032242842,
           'precision50': 0.3663505,
           'recall50': 0.06763275},
     '4': {'avg_iou': 0.7351899,
           'avg_obj': 0.28890613,
           'box_loss': 0.63696235,
           'class_loss': 0.012203518,
           'conf_loss': 0.028275482,
           'precision50': 0.6133091,
           'recall50': 0.23207466},
     '5': {'avg_iou': 0.7871962,
           'avg_obj': 0.40728095,
           'box_loss': 0.25644538,
           'class_loss': 0.010631677,
           'conf_loss': 0.0185047,
           'precision50': 0.7093302,
           'recall50': 0.40799353},
     'global': {'total_loss': 15.974408},
     'learning_rate': 0.0020575363,
     'training_loss': 15.974408}
I0516 13:15:57.077232 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-350000.
I0516 14:43:40.642631 140402429237056 controller.py:425] train | step:  360000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.60960495,
           'avg_obj': 0.15385,
           'box_loss': 0.9826082,
           'class_loss': 0.012737338,
           'conf_loss': 0.03209805,
           'precision50': 0.3679555,
           'recall50': 0.068496175},
     '4': {'avg_iou': 0.73590815,
           'avg_obj': 0.2901552,
           'box_loss': 0.6331902,
           'class_loss': 0.0121244015,
           'conf_loss': 0.028162733,
           'precision50': 0.61320865,
           'recall50': 0.23326641},
     '5': {'avg_iou': 0.78780925,
           'avg_obj': 0.40828022,
           'box_loss': 0.2552489,
           'class_loss': 0.010567342,
           'conf_loss': 0.018457603,
           'precision50': 0.7099368,
           'recall50': 0.40916774},
     'global': {'total_loss': 15.881505},
     'learning_rate': 0.00201441,
     'training_loss': 15.881505}
I0516 14:44:27.573356 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-360000.
I0516 14:44:27.579444 140402429237056 controller.py:252]  eval | step:  360000 | running 625 steps of evaluation...
I0516 14:48:37.039031 140402429237056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0516 14:52:56.140677 140402429237056 controller.py:261]  eval | step:  360000 | eval time:  508.6 sec | output: 
    {'3': {'avg_iou': 0.46692792,
           'avg_obj': 0.11224536,
           'box_loss': 0.5151473,
           'class_loss': 0.008838367,
           'conf_loss': 0.020636449,
           'precision50': 0.25763446,
           'recall50': 0.068939656},
     '4': {'avg_iou': 0.6860682,
           'avg_obj': 0.27056044,
           'box_loss': 0.40321162,
           'class_loss': 0.009823621,
           'conf_loss': 0.018804383,
           'precision50': 0.51459926,
           'recall50': 0.23904625},
     '5': {'avg_iou': 0.760801,
           'avg_obj': 0.40674144,
           'box_loss': 0.19658077,
           'class_loss': 0.008529872,
           'conf_loss': 0.014796428,
           'precision50': 0.66870916,
           'recall50': 0.40820727},
     'AP': 0.18152727,
     'AP50': 0.27421856,
     'AP75': 0.19419082,
     'APl': 0.26591158,
     'APm': 0.17010567,
     'APs': 0.0400483,
     'ARl': 0.58149904,
     'ARm': 0.45155016,
     'ARmax1': 0.22672744,
     'ARmax10': 0.39663082,
     'ARmax100': 0.42444485,
     'ARs': 0.16971849,
     'global': {'total_loss': 1.1963689},
     'validation_loss': 1.1963689}
I0516 14:53:13.964186 140402429237056 controller.py:211] train | step:  360000 | training until step 375000...
I0516 16:14:52.779866 140402429237056 controller.py:425] train | step:  370000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6101119,
           'avg_obj': 0.15488723,
           'box_loss': 0.9824701,
           'class_loss': 0.012673495,
           'conf_loss': 0.03208797,
           'precision50': 0.37033477,
           'recall50': 0.06972626},
     '4': {'avg_iou': 0.73652685,
           'avg_obj': 0.29196182,
           'box_loss': 0.63171667,
           'class_loss': 0.012054416,
           'conf_loss': 0.028092569,
           'precision50': 0.615803,
           'recall50': 0.23619209},
     '5': {'avg_iou': 0.7885442,
           'avg_obj': 0.41013604,
           'box_loss': 0.2542907,
           'class_loss': 0.010505598,
           'conf_loss': 0.018393252,
           'precision50': 0.71149766,
           'recall50': 0.41229913},
     'global': {'total_loss': 15.858293},
     'learning_rate': 0.002,
     'training_loss': 15.858293}
I0516 16:15:45.431699 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-370000.
I0516 17:00:14.076722 140402429237056 controller.py:425] train | step:  375000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6104754,
           'avg_obj': 0.15514985,
           'box_loss': 0.9783293,
           'class_loss': 0.012624693,
           'conf_loss': 0.031961415,
           'precision50': 0.36972067,
           'recall50': 0.069701284},
     '4': {'avg_iou': 0.73694646,
           'avg_obj': 0.2921285,
           'box_loss': 0.6290959,
           'class_loss': 0.011998326,
           'conf_loss': 0.028018154,
           'precision50': 0.614706,
           'recall50': 0.23569505},
     '5': {'avg_iou': 0.7889333,
           'avg_obj': 0.41079125,
           'box_loss': 0.2535162,
           'class_loss': 0.010471474,
           'conf_loss': 0.01836374,
           'precision50': 0.7118428,
           'recall50': 0.4130344},
     'global': {'total_loss': 15.794995},
     'learning_rate': 0.002,
     'training_loss': 15.794995}
I0516 17:00:26.395182 140402429237056 controller.py:252]  eval | step:  375000 | running 625 steps of evaluation...
I0516 17:04:33.848783 140402429237056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0516 17:08:45.139872 140402429237056 controller.py:261]  eval | step:  375000 | eval time:  498.7 sec | output: 
    {'3': {'avg_iou': 0.4675075,
           'avg_obj': 0.11267281,
           'box_loss': 0.5141845,
           'class_loss': 0.008764692,
           'conf_loss': 0.020577747,
           'precision50': 0.25858063,
           'recall50': 0.06921694},
     '4': {'avg_iou': 0.68659705,
           'avg_obj': 0.2707028,
           'box_loss': 0.402015,
           'class_loss': 0.009752863,
           'conf_loss': 0.018738056,
           'precision50': 0.5159044,
           'recall50': 0.23957703},
     '5': {'avg_iou': 0.76168597,
           'avg_obj': 0.40966952,
           'box_loss': 0.19576661,
           'class_loss': 0.008454758,
           'conf_loss': 0.01471975,
           'precision50': 0.6706231,
           'recall50': 0.4122792},
     'AP': 0.1835668,
     'AP50': 0.27755597,
     'AP75': 0.19553539,
     'APl': 0.26706478,
     'APm': 0.17149062,
     'APs': 0.0397927,
     'ARl': 0.5841069,
     'ARm': 0.4519152,
     'ARmax1': 0.22932746,
     'ARmax10': 0.39723614,
     'ARmax100': 0.42584616,
     'ARs': 0.17084229,
     'global': {'total_loss': 1.192974},
     'validation_loss': 1.192974}

train | step:  340000 | training until step 360000...
train | step:  350000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6084664,
           'avg_obj': 0.15260889,
           'box_loss': 0.9887495,
           'class_loss': 0.012788452,
           'conf_loss': 0.032242842,
           'precision50': 0.3663505,
           'recall50': 0.06763275},
     '4': {'avg_iou': 0.7351899,
           'avg_obj': 0.28890613,
           'box_loss': 0.63696235,
           'class_loss': 0.012203518,
           'conf_loss': 0.028275482,
           'precision50': 0.6133091,
           'recall50': 0.23207466},
     '5': {'avg_iou': 0.7871962,
           'avg_obj': 0.40728095,
           'box_loss': 0.25644538,
           'class_loss': 0.010631677,
           'conf_loss': 0.0185047,
           'precision50': 0.7093302,
           'recall50': 0.40799353},
     'global': {'total_loss': 15.974408},
     'learning_rate': 0.0020575363,
     'training_loss': 15.974408}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-350000.
train | step:  360000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.60960495,
           'avg_obj': 0.15385,
           'box_loss': 0.9826082,
           'class_loss': 0.012737338,
           'conf_loss': 0.03209805,
           'precision50': 0.3679555,
           'recall50': 0.068496175},
     '4': {'avg_iou': 0.73590815,
           'avg_obj': 0.2901552,
           'box_loss': 0.6331902,
           'class_loss': 0.0121244015,
           'conf_loss': 0.028162733,
           'precision50': 0.61320865,
           'recall50': 0.23326641},
     '5': {'avg_iou': 0.78780925,
           'avg_obj': 0.40828022,
           'box_loss': 0.2552489,
           'class_loss': 0.010567342,
           'conf_loss': 0.018457603,
           'precision50': 0.7099368,
           'recall50': 0.40916774},
     'global': {'total_loss': 15.881505},
     'learning_rate': 0.00201441,
     'training_loss': 15.881505}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-360000.
 eval | step:  360000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=173.12s).
Accumulating evaluation results...
DONE (t=26.79s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.182
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.274
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.194
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.040
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.170
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.266
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.227
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.397
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.424
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.170
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.452
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.581
 eval | step:  360000 | eval time:  508.6 sec | output: 
    {'3': {'avg_iou': 0.46692792,
           'avg_obj': 0.11224536,
           'box_loss': 0.5151473,
           'class_loss': 0.008838367,
           'conf_loss': 0.020636449,
           'precision50': 0.25763446,
           'recall50': 0.068939656},
     '4': {'avg_iou': 0.6860682,
           'avg_obj': 0.27056044,
           'box_loss': 0.40321162,
           'class_loss': 0.009823621,
           'conf_loss': 0.018804383,
           'precision50': 0.51459926,
           'recall50': 0.23904625},
     '5': {'avg_iou': 0.760801,
           'avg_obj': 0.40674144,
           'box_loss': 0.19658077,
           'class_loss': 0.008529872,
           'conf_loss': 0.014796428,
           'precision50': 0.66870916,
           'recall50': 0.40820727},
     'AP': 0.18152727,
     'AP50': 0.27421856,
     'AP75': 0.19419082,
     'APl': 0.26591158,
     'APm': 0.17010567,
     'APs': 0.0400483,
     'ARl': 0.58149904,
     'ARm': 0.45155016,
     'ARmax1': 0.22672744,
     'ARmax10': 0.39663082,
     'ARmax100': 0.42444485,
     'ARs': 0.16971849,
     'global': {'total_loss': 1.1963689},
     'validation_loss': 1.1963689}
train | step:  360000 | training until step 375000...
train | step:  370000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6101119,
           'avg_obj': 0.15488723,
           'box_loss': 0.9824701,
           'class_loss': 0.012673495,
           'conf_loss': 0.03208797,
           'precision50': 0.37033477,
           'recall50': 0.06972626},
     '4': {'avg_iou': 0.73652685,
           'avg_obj': 0.29196182,
           'box_loss': 0.63171667,
           'class_loss': 0.012054416,
           'conf_loss': 0.028092569,
           'precision50': 0.615803,
           'recall50': 0.23619209},
     '5': {'avg_iou': 0.7885442,
           'avg_obj': 0.41013604,
           'box_loss': 0.2542907,
           'class_loss': 0.010505598,
           'conf_loss': 0.018393252,
           'precision50': 0.71149766,
           'recall50': 0.41229913},
     'global': {'total_loss': 15.858293},
     'learning_rate': 0.002,
     'training_loss': 15.858293}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-370000.
train | step:  375000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6104754,
           'avg_obj': 0.15514985,
           'box_loss': 0.9783293,
           'class_loss': 0.012624693,
           'conf_loss': 0.031961415,
           'precision50': 0.36972067,
           'recall50': 0.069701284},
     '4': {'avg_iou': 0.73694646,
           'avg_obj': 0.2921285,
           'box_loss': 0.6290959,
           'class_loss': 0.011998326,
           'conf_loss': 0.028018154,
           'precision50': 0.614706,
           'recall50': 0.23569505},
     '5': {'avg_iou': 0.7889333,
           'avg_obj': 0.41079125,
           'box_loss': 0.2535162,
           'class_loss': 0.010471474,
           'conf_loss': 0.01836374,
           'precision50': 0.7118428,
           'recall50': 0.4130344},
     'global': {'total_loss': 15.794995},
     'learning_rate': 0.002,
     'training_loss': 15.794995}
 eval | step:  375000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=168.94s).
Accumulating evaluation results...
DONE (t=26.61s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.184
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.278
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.196
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.040
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.171
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.267
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.229
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.397
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.426
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.171
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.452
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.584
 eval | step:  375000 | eval time:  498.7 sec | output: 
    {'3': {'avg_iou': 0.4675075,
           'avg_obj': 0.11267281,
           'box_loss': 0.5141845,
           'class_loss': 0.008764692,
           'conf_loss': 0.020577747,
           'precision50': 0.25858063,
           'recall50': 0.06921694},
     '4': {'avg_iou': 0.68659705,
           'avg_obj': 0.2707028,
           'box_loss': 0.402015,
           'class_loss': 0.009752863,
           'conf_loss': 0.018738056,
           'precision50': 0.5159044,
           'recall50': 0.23957703},
     '5': {'avg_iou': 0.76168597,
           'avg_obj': 0.40966952,
           'box_loss': 0.19576661,
           'class_loss': 0.008454758,
           'conf_loss': 0.01471975,
           'precision50': 0.6706231,
           'recall50': 0.4122792},
     'AP': 0.1835668,
     'AP50': 0.27755597,
     'AP75': 0.19553539,
     'APl': 0.26706478,
     'APm': 0.17149062,
     'APs': 0.0397927,
     'ARl': 0.5841069,
     'ARm': 0.4519152,
     'ARmax1': 0.22932746,
     'ARmax10': 0.39723614,
     'ARmax100': 0.42584616,
     'ARs': 0.17084229,
     'global': {'total_loss': 1.192974},
     'validation_loss': 1.192974}I0516 17:09:37.272348 140402429237056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-375000.
I0516 17:09:37.289436 140402429237056 train_lib.py:123] Number of trainable params in model: 53.066944 Millions.

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-5/ckpt-375000.
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     11   1209 --:--:-- --:--:-- --:--:--  1220
okRequest issued for: [node-7]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-16T17:15:25.435852073Z'
  endTime: '2021-05-16T17:16:18.746666587Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621185325420-5c2759f6fd0cb-0f305c35-576d88c6
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.124.160.48/29
  createTime: '2021-03-18T03:10:27.166064884Z'
  health: HEALTHY
  ipAddress: 10.124.160.50
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.124.160.50
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621185325420-5c2759f6fd0cb-0f305c35-576d88c6] to complete...
.............................................................................................................................................................................................................................................................................................................................................................................................done.
