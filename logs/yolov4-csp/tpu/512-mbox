cat: .experiment_zone: No such file or directory
Request issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-05T01:46:44.999977220Z'
  endTime: '2021-05-05T01:47:21.091023982Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620179204985-5c18b5dfc523c-55226d48-50609d07
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T05:45:10.821112479Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T05:44:59.159875+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T19:29:05.781890630Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T19:28:54.243943+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620179204985-5c18b5dfc523c-55226d48-50609d07] to complete...
............................................................................................................................................................................................done.
europe-west4-a
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 115, in main
    params = train_utils.parse_configuration(FLAGS)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_utils.py", line 249, in parse_configuration
    params, config_file, is_strict=True)
  File "/home/cam2tensorflow/TensorFlowModels/official/modeling/hyperparams/params_dict.py", line 441, in override_params_dict
    params.override(yaml.load(f, Loader=yaml.FullLoader), is_strict)
  File "/usr/local/lib/python3.7/dist-packages/yaml/__init__.py", line 112, in load
    loader = Loader(stream)
  File "/usr/local/lib/python3.7/dist-packages/yaml/loader.py", line 24, in __init__
    Reader.__init__(self, stream)
  File "/usr/local/lib/python3.7/dist-packages/yaml/reader.py", line 85, in __init__
    self.determine_encoding()
  File "/usr/local/lib/python3.7/dist-packages/yaml/reader.py", line 124, in determine_encoding
    self.update_raw()
  File "/usr/local/lib/python3.7/dist-packages/yaml/reader.py", line 178, in update_raw
    data = self.stream.read(size)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/lib/io/file_io.py", line 117, in read
    self._preread_check()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/lib/io/file_io.py", line 80, in _preread_check
    compat.path_to_str(self.__name), 1024 * 512)
tensorflow.python.framework.errors_impl.NotFoundError: yolo/configs/experiments/yolov4-csp/tpu/512-mbox.yaml; No such file or directory
yolo_custom
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   209    0     2  100   207     12   1310 --:--:-- --:--:-- --:--:--  1322
okRequest issued for: [node-1]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620179247955-5c18b608bfcc8-e14f4225-46280d6e] to complete...
................................................................................................................................................................................................................................................................................................aborted by ctrl-c.
ERROR: (gcloud.compute.tpus.stop) Aborting wait for operation https://tpu.googleapis.com/v1alpha1/projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620179247955-5c18b608bfcc8-e14f4225-46280d6e.

cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is STOPPING
europe-west4-a
I0505 01:44:35.588631 140554959824704 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.666,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.5, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [240000,
                                                                                260000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.001,
                                                                            0.0001,
                                                                            1e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0505 01:44:35.589930 140554959824704 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-mbox/params.yaml
I0505 01:44:37.319032 140554959824704 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0505 01:44:37.939676 140554959824704 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0505 01:44:37.940038 140554959824704 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-1" is not yet ready; state: "STOPPING"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.5, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [240000, 260000], 'values': [0.001, 0.0001, 1e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   204    0     2  100   202      7    782 --:--:-- --:--:-- --:--:--   790
okRequest issued for: [node-1]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620179319637-5c18b64d1c5df-40a23c22-6d9fd98a] to complete...
.......................................................aborted by ctrl-c.
ERROR: (gcloud.compute.tpus.stop) Aborting wait for operation https://tpu.googleapis.com/v1alpha1/projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620179319637-5c18b64d1c5df-40a23c22-6d9fd98a.

cat: .experiment_zone: No such file or directory
Request issued for: [node-2]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-05T01:48:56.290645393Z'
  endTime: '2021-05-05T01:49:32.296668254Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620179336277-5c18b65cfacc3-9494e6ba-5eeee4d5
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.73.142.64/29
  createTime: '2021-03-13T00:10:24.868252445Z'
  health: HEALTHY
  ipAddress: 10.73.142.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.73.142.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-25T19:28:21.704126002Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T19:28:19Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-03-28T21:10:24.483577115Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:10:19Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T02:18:59.164603377Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T02:18:30.044758+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-30T05:32:54.575339610Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-30T05:32:31.628489+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620179336277-5c18b65cfacc3-9494e6ba-5eeee4d5] to complete...
.................................................................................................................................................................................................done.
europe-west4-a
I0505 01:45:37.734269 139820604045120 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.666,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.5, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.666,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [240000,
                                                                                260000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.001,
                                                                            0.0001,
                                                                            1e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0505 01:45:37.736087 139820604045120 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-mbox/params.yaml
I0505 01:45:38.586173 139820604045120 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0505 01:45:39.208680 139820604045120 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2?alt=json
I0505 01:45:39.210841 139820604045120 transport.py:157] Attempting refresh to obtain initial access_token
I0505 01:45:39.267967 139820604045120 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0505 01:45:39.886953 139820604045120 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2?alt=json
I0505 01:45:39.887434 139820604045120 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-05 01:45:39.932476: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0505 01:45:39.933139 139820604045120 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0505 01:45:40.076374 139820604045120 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2?alt=json
I0505 01:45:40.076651 139820604045120 transport.py:157] Attempting refresh to obtain initial access_token
I0505 01:45:40.139302 139820604045120 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0505 01:45:40.756082 139820604045120 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2?alt=json
I0505 01:45:40.756372 139820604045120 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-05 01:45:40.807682: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-05 01:45:40.823589: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.73.142.66:8470}
2021-05-05 01:45:40.823671: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:34453}
2021-05-05 01:46:16.261308: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.73.142.66:8470}
2021-05-05 01:46:16.261433: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:34453}
2021-05-05 01:46:16.262598: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:34453
I0505 01:46:16.263999 139820604045120 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-2
I0505 01:46:16.265243 139820604045120 tpu_strategy_util.py:74] Initializing the TPU system: node-2
INFO:tensorflow:Clearing out eager caches
I0505 01:46:24.379297 139820604045120 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0505 01:46:24.381649 139820604045120 tpu_strategy_util.py:133] Finished initializing TPU system.
I0505 01:46:24.383099 139820604045120 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0505 01:46:25.000155 139820604045120 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2?alt=json
I0505 01:46:25.000470 139820604045120 transport.py:157] Attempting refresh to obtain initial access_token
I0505 01:46:25.067218 139820604045120 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0505 01:46:25.682664 139820604045120 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2?alt=json
I0505 01:46:25.682923 139820604045120 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0505 01:46:25.758204 139820604045120 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0505 01:46:25.758513 139820604045120 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0505 01:46:25.758932 139820604045120 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0505 01:46:25.759070 139820604045120 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0505 01:46:25.759216 139820604045120 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0505 01:46:25.759547 139820604045120 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0505 01:46:25.759649 139820604045120 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0505 01:46:25.759765 139820604045120 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0505 01:46:25.759923 139820604045120 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0505 01:46:25.760106 139820604045120 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0505 01:46:25.760242 139820604045120 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0505 01:46:25.760386 139820604045120 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0505 01:46:25.760538 139820604045120 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0505 01:46:25.760688 139820604045120 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0505 01:46:25.760820 139820604045120 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0505 01:46:25.760957 139820604045120 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0505 01:46:25.762770 139820604045120 train_utils.py:214] Running default trainer.
2021-05-05 01:46:25.784869: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.5, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.666, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [240000, 260000], 'values': [0.001, 0.0001, 1e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f2a1c1ca978>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________
yolo_fpn (YoloFPN)              {'5': (None, 16, 16, 9626112     input_2[0][0]                    
                                                                 input_3[0][0]                    I0505 01:47:15.734672 139820604045120 controller.py:362] restoring or initializing model...
I0505 01:47:25.395206 139820604045120 yolo.py:542] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0505 01:47:25.398175 139820604045120 controller.py:368] initialized model.
I0505 01:47:25.398426 139820604045120 train_lib.py:96] Starts to execute mode: train_and_eval
I0505 01:47:25.405283 139820604045120 controller.py:211] train | step:      0 | training until step 20000...
I0505 01:47:33.433092 139820604045120 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0505 01:48:40.972209 139820604045120 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0505 03:02:37.585474 139820604045120 controller.py:425] train | step:  10000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.5262848,
           'avg_obj': 0.066369675,
           'box_loss': 23.099834,
           'class_loss': 61.72755,
           'conf_loss': 159.40186,
           'precision50': 0.11269419,
           'recall50': 0.033394393},
     '4': {'avg_iou': 0.6033231,
           'avg_obj': 0.15483424,
           'box_loss': 19.154795,
           'class_loss': 59.704906,
           'conf_loss': 25.730106,
           'precision50': 0.23159121,
           'recall50': 0.12196767},
     '5': {'avg_iou': 0.6288178,
           'avg_obj': 0.21866854,
           'box_loss': 9.076931,
           'class_loss': 30.206009,
           'conf_loss': 4.4523163,
           'precision50': 0.312747,
           'recall50': 0.19170766},
     'global': {'total_loss': 392.55527},
     'learning_rate': 0.001,
     'training_loss': 392.55527}
I0505 03:03:33.545355 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-10000.
I0505 04:07:19.527033 139820604045120 controller.py:425] train | step:  20000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.5920325,
           'avg_obj': 0.14083092,
           'box_loss': 19.993107,
           'class_loss': 21.395819,
           'conf_loss': 53.28172,
           'precision50': 0.20413566,
           'recall50': 0.096922494},
     '4': {'avg_iou': 0.68601906,
           'avg_obj': 0.28941333,
           'box_loss': 15.205206,
           'class_loss': 18.453083,
           'conf_loss': 17.442978,
           'precision50': 0.31632948,
           'recall50': 0.2765393},
     '5': {'avg_iou': 0.7192827,
           'avg_obj': 0.38721877,
           'box_loss': 6.850614,
           'class_loss': 9.1135645,
           'conf_loss': 3.32119,
           'precision50': 0.4279291,
           'recall50': 0.41574618},
     'global': {'total_loss': 165.0568},
     'learning_rate': 0.001,
     'training_loss': 165.0568}
I0505 04:08:11.716246 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-20000.
I0505 04:08:11.722658 139820604045120 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0505 04:08:12.511719 139820604045120 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0505 04:08:31.174924 139820604045120 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0505 04:13:37.075991 139820604045120 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0505 04:18:32.534289 139820604045120 controller.py:261]  eval | step:  20000 | eval time:  620.8 sec | output: 
    {'3': {'avg_iou': 0.46223232,
           'avg_obj': 0.15898779,
           'box_loss': 10.178243,
           'class_loss': 8.78604,
           'conf_loss': 41.807434,
           'precision50': 0.17132322,
           'recall50': 0.14830628},
     '4': {'avg_iou': 0.667879,
           'avg_obj': 0.3617851,
           'box_loss': 8.31532,
           'class_loss': 7.6572437,
           'conf_loss': 12.519759,
           'precision50': 0.27604437,
           'recall50': 0.38614824},
     '5': {'avg_iou': 0.72387624,
           'avg_obj': 0.4813897,
           'box_loss': 4.418247,
           'class_loss': 4.3396044,
           'conf_loss': 2.4783897,
           'precision50': 0.39104265,
           'recall50': 0.5366126},
     'AP': 0.24954477,
     'AP50': 0.40441442,
     'AP75': 0.27060252,
     'APl': 0.33321306,
     'APm': 0.26732233,
     'APs': 0.082222454,
     'ARl': 0.5504269,
     'ARm': 0.4649304,
     'ARmax1': 0.23024246,
     'ARmax10': 0.3856807,
     'ARmax100': 0.42436168,
     'ARs': 0.19410107,
     'global': {'total_loss': 100.500305},
     'validation_loss': 100.500305}

                                                                 input_4[0][0]                    
__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'3': (None, 64, 64, 16271360    yolo_fpn[0][0]                   
                                                                 yolo_fpn[0][1]                   
                                                                 yolo_fpn[0][2]                   
==================================================================================================
Total params: 25,897,472
Trainable params: 25,867,520
Non-trainable params: 29,952
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 400, 8), 5: (8, 200, 8)}, inds: {3: (8, 600, 3), 4: (8, 400, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
train | step:  10000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.5262848,
           'avg_obj': 0.066369675,
           'box_loss': 23.099834,
           'class_loss': 61.72755,
           'conf_loss': 159.40186,
           'precision50': 0.11269419,
           'recall50': 0.033394393},
     '4': {'avg_iou': 0.6033231,
           'avg_obj': 0.15483424,
           'box_loss': 19.154795,
           'class_loss': 59.704906,
           'conf_loss': 25.730106,
           'precision50': 0.23159121,
           'recall50': 0.12196767},
     '5': {'avg_iou': 0.6288178,
           'avg_obj': 0.21866854,
           'box_loss': 9.076931,
           'class_loss': 30.206009,
           'conf_loss': 4.4523163,
           'precision50': 0.312747,
           'recall50': 0.19170766},
     'global': {'total_loss': 392.55527},
     'learning_rate': 0.001,
     'training_loss': 392.55527}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-10000.
train | step:  20000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.5920325,
           'avg_obj': 0.14083092,
           'box_loss': 19.993107,
           'class_loss': 21.395819,
           'conf_loss': 53.28172,
           'precision50': 0.20413566,
           'recall50': 0.096922494},
     '4': {'avg_iou': 0.68601906,
           'avg_obj': 0.28941333,
           'box_loss': 15.205206,
           'class_loss': 18.453083,
           'conf_loss': 17.442978,
           'precision50': 0.31632948,
           'recall50': 0.2765393},
     '5': {'avg_iou': 0.7192827,
           'avg_obj': 0.38721877,
           'box_loss': 6.850614,
           'class_loss': 9.1135645,
           'conf_loss': 3.32119,
           'precision50': 0.4279291,
           'recall50': 0.41574618},
     'global': {'total_loss': 165.0568},
     'learning_rate': 0.001,
     'training_loss': 165.0568}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-20000.
 eval | step:  20000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=202.30s).
Accumulating evaluation results...
DONE (t=33.60s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.250
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.404
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.271
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.082
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.267
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.333
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.230
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.386
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.424
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.194
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.465
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.550
 eval | step:  20000 | eval time:  620.8 sec | output: 
    {'3': {'avg_iou': 0.46223232,
           'avg_obj': 0.15898779,
           'box_loss': 10.178243,
           'class_loss': 8.78604,
           'conf_loss': 41.807434,
           'precision50': 0.17132322,
           'recall50': 0.14830628},
     '4': {'avg_iou': 0.667879,
           'avg_obj': 0.3617851,
           'box_loss': 8.31532,
           'class_loss': 7.6572437,
           'conf_loss': 12.519759,
           'precision50': 0.27604437,
           'recall50': 0.38614824},
     '5': {'avg_iou': 0.72387624,
           'avg_obj': 0.4813897,
           'box_loss': 4.418247,
           'class_loss': 4.3396044,
           'conf_loss': 2.4783897,
           'precision50': 0.39104265,
           'recall50': 0.5366126},
     'AP': 0.24954477,
     'AP50': 0.40441442,
     'AP75': 0.27060252,
     'APl': 0.33321306,
     'APm': 0.26732233,
     'APs': 0.082222454,
     'ARl': 0.5504269,
     'ARm': 0.4649304,
     'ARmax1': 0.23024246,
     'ARmax10': 0.3856807,
     'ARmax100': 0.42436168,
     'ARs': 0.19410107,
     'global': {'total_loss': 100.500305},
     'validation_loss': 100.500305}I0505 04:18:56.236055 139820604045120 controller.py:211] train | step:  20000 | training until step 40000...
I0505 05:21:48.913469 139820604045120 controller.py:425] train | step:  30000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.60997635,
           'avg_obj': 0.17640416,
           'box_loss': 19.159296,
           'class_loss': 18.561148,
           'conf_loss': 59.51337,
           'precision50': 0.21816891,
           'recall50': 0.13343152},
     '4': {'avg_iou': 0.7093425,
           'avg_obj': 0.34433204,
           'box_loss': 14.078965,
           'class_loss': 15.564014,
           'conf_loss': 18.492369,
           'precision50': 0.31769696,
           'recall50': 0.34521195},
     '5': {'avg_iou': 0.7422704,
           'avg_obj': 0.44707787,
           'box_loss': 6.2832227,
           'class_loss': 7.6827955,
           'conf_loss': 3.377318,
           'precision50': 0.4244206,
           'recall50': 0.49628448},
     'global': {'total_loss': 162.71251},
     'learning_rate': 0.001,
     'training_loss': 162.71251}
I0505 05:22:37.292665 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-30000.
I0505 06:29:59.184895 139820604045120 controller.py:425] train | step:  40000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6206807,
           'avg_obj': 0.19821976,
           'box_loss': 18.63093,
           'class_loss': 16.972357,
           'conf_loss': 61.71652,
           'precision50': 0.22624792,
           'recall50': 0.15645124},
     '4': {'avg_iou': 0.7226521,
           'avg_obj': 0.37720475,
           'box_loss': 13.426019,
           'class_loss': 13.946693,
           'conf_loss': 18.805553,
           'precision50': 0.31654993,
           'recall50': 0.38635314},
     '5': {'avg_iou': 0.7554765,
           'avg_obj': 0.48189327,
           'box_loss': 5.949683,
           'class_loss': 6.8663306,
           'conf_loss': 3.3719032,
           'precision50': 0.4202311,
           'recall50': 0.5409856},
     'global': {'total_loss': 159.68585},
     'learning_rate': 0.001,
     'training_loss': 159.68585}
I0505 06:30:45.142878 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-40000.
I0505 06:30:45.148573 139820604045120 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0505 06:35:03.307729 139820604045120 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0505 06:39:59.610143 139820604045120 controller.py:261]  eval | step:  40000 | eval time:  554.5 sec | output: 
    {'3': {'avg_iou': 0.4750503,
           'avg_obj': 0.19328065,
           'box_loss': 9.666979,
           'class_loss': 7.3935695,
           'conf_loss': 44.773396,
           'precision50': 0.18062796,
           'recall50': 0.19056024},
     '4': {'avg_iou': 0.688161,
           'avg_obj': 0.4224387,
           'box_loss': 7.6513124,
           'class_loss': 6.294232,
           'conf_loss': 13.167438,
           'precision50': 0.27269876,
           'recall50': 0.46196944},
     '5': {'avg_iou': 0.74831545,
           'avg_obj': 0.54726934,
           'box_loss': 3.9754183,
           'class_loss': 3.5789888,
           'conf_loss': 2.5360146,
           'precision50': 0.37274966,
           'recall50': 0.6129029},
     'AP': 0.30381715,
     'AP50': 0.47007117,
     'AP75': 0.33794585,
     'APl': 0.41262144,
     'APm': 0.3272744,
     'APs': 0.10899775,
     'ARl': 0.6054671,
     'ARm': 0.5188545,
     'ARmax1': 0.26013517,
     'ARmax10': 0.43206924,
     'ARmax100': 0.4732463,
     'ARs': 0.23903508,
     'global': {'total_loss': 99.037384},
     'validation_loss': 99.037384}
I0505 06:40:16.541810 139820604045120 controller.py:211] train | step:  40000 | training until step 60000...
I0505 07:48:40.407084 139820604045120 controller.py:425] train | step:  50000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.62815523,
           'avg_obj': 0.21446936,
           'box_loss': 18.290579,
           'class_loss': 15.908252,
           'conf_loss': 62.643837,
           'precision50': 0.2342672,
           'recall50': 0.1737388},
     '4': {'avg_iou': 0.7315536,
           'avg_obj': 0.399811,
           'box_loss': 13.006501,
           'class_loss': 12.92889,
           'conf_loss': 18.856432,
           'precision50': 0.31725386,
           'recall50': 0.41381654},
     '5': {'avg_iou': 0.7646565,
           'avg_obj': 0.5057018,
           'box_loss': 5.723008,
           'class_loss': 6.3567834,
           'conf_loss': 3.3531485,
           'precision50': 0.41741207,
           'recall50': 0.5699949},
     'global': {'total_loss': 157.06723},
     'learning_rate': 0.001,
     'training_loss': 157.06723}
I0505 07:49:27.872462 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-50000.
I0505 08:49:51.524721 139820604045120 controller.py:425] train | step:  60000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6334977,
           'avg_obj': 0.2272493,
           'box_loss': 18.059748,
           'class_loss': 15.123903,
           'conf_loss': 63.154068,
           'precision50': 0.2382796,
           'recall50': 0.18752222},
     '4': {'avg_iou': 0.73844737,
           'avg_obj': 0.4180453,
           'box_loss': 12.687207,
           'class_loss': 12.148318,
           'conf_loss': 18.744738,
           'precision50': 0.31867525,
           'recall50': 0.43559146},
     '5': {'avg_iou': 0.7715575,
           'avg_obj': 0.5240989,
           'box_loss': 5.553382,
           'class_loss': 5.970867,
           'conf_loss': 3.3258145,
           'precision50': 0.414785,
           'recall50': 0.59229094},
     'global': {'total_loss': 154.76836},
     'learning_rate': 0.001,
     'training_loss': 154.76836}
I0505 08:50:42.364053 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-60000.
I0505 08:50:42.369924 139820604045120 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0505 08:54:56.058647 139820604045120 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0505 09:00:07.101515 139820604045120 controller.py:261]  eval | step:  60000 | eval time:  564.7 sec | output: 
    {'3': {'avg_iou': 0.48107755,
           'avg_obj': 0.21022637,
           'box_loss': 9.414492,
           'class_loss': 6.839229,
           'conf_loss': 45.91917,
           'precision50': 0.18591966,
           'recall50': 0.21183491},
     '4': {'avg_iou': 0.69648415,
           'avg_obj': 0.44962442,
           'box_loss': 7.365482,
           'class_loss': 5.7765293,
           'conf_loss': 13.299461,
           'precision50': 0.27482763,
           'recall50': 0.49489078},
     '5': {'avg_iou': 0.7593874,
           'avg_obj': 0.57850593,
           'box_loss': 3.7761536,
           'class_loss': 3.2555578,
           'conf_loss': 2.5320985,
           'precision50': 0.3673643,
           'recall50': 0.6498911},
     'AP': 0.32990083,
     'AP50': 0.49992535,
     'AP75': 0.3647349,
     'APl': 0.44788477,
     'APm': 0.35178602,
     'APs': 0.12812017,
     'ARl': 0.6306133,
     'ARm': 0.54288083,
     'ARmax1': 0.27435026,
     'ARmax10': 0.4556345,
     'ARmax100': 0.4974799,
     'ARs': 0.26673388,
     'global': {'total_loss': 98.17818},
     'validation_loss': 98.17818}

train | step:  20000 | training until step 40000...
train | step:  30000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.60997635,
           'avg_obj': 0.17640416,
           'box_loss': 19.159296,
           'class_loss': 18.561148,
           'conf_loss': 59.51337,
           'precision50': 0.21816891,
           'recall50': 0.13343152},
     '4': {'avg_iou': 0.7093425,
           'avg_obj': 0.34433204,
           'box_loss': 14.078965,
           'class_loss': 15.564014,
           'conf_loss': 18.492369,
           'precision50': 0.31769696,
           'recall50': 0.34521195},
     '5': {'avg_iou': 0.7422704,
           'avg_obj': 0.44707787,
           'box_loss': 6.2832227,
           'class_loss': 7.6827955,
           'conf_loss': 3.377318,
           'precision50': 0.4244206,
           'recall50': 0.49628448},
     'global': {'total_loss': 162.71251},
     'learning_rate': 0.001,
     'training_loss': 162.71251}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-30000.
train | step:  40000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6206807,
           'avg_obj': 0.19821976,
           'box_loss': 18.63093,
           'class_loss': 16.972357,
           'conf_loss': 61.71652,
           'precision50': 0.22624792,
           'recall50': 0.15645124},
     '4': {'avg_iou': 0.7226521,
           'avg_obj': 0.37720475,
           'box_loss': 13.426019,
           'class_loss': 13.946693,
           'conf_loss': 18.805553,
           'precision50': 0.31654993,
           'recall50': 0.38635314},
     '5': {'avg_iou': 0.7554765,
           'avg_obj': 0.48189327,
           'box_loss': 5.949683,
           'class_loss': 6.8663306,
           'conf_loss': 3.3719032,
           'precision50': 0.4202311,
           'recall50': 0.5409856},
     'global': {'total_loss': 159.68585},
     'learning_rate': 0.001,
     'training_loss': 159.68585}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-40000.
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=202.05s).
Accumulating evaluation results...
DONE (t=32.97s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.304
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.470
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.338
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.109
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.327
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.413
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.260
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.432
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.473
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.239
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.519
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.605
 eval | step:  40000 | eval time:  554.5 sec | output: 
    {'3': {'avg_iou': 0.4750503,
           'avg_obj': 0.19328065,
           'box_loss': 9.666979,
           'class_loss': 7.3935695,
           'conf_loss': 44.773396,
           'precision50': 0.18062796,
           'recall50': 0.19056024},
     '4': {'avg_iou': 0.688161,
           'avg_obj': 0.4224387,
           'box_loss': 7.6513124,
           'class_loss': 6.294232,
           'conf_loss': 13.167438,
           'precision50': 0.27269876,
           'recall50': 0.46196944},
     '5': {'avg_iou': 0.74831545,
           'avg_obj': 0.54726934,
           'box_loss': 3.9754183,
           'class_loss': 3.5789888,
           'conf_loss': 2.5360146,
           'precision50': 0.37274966,
           'recall50': 0.6129029},
     'AP': 0.30381715,
     'AP50': 0.47007117,
     'AP75': 0.33794585,
     'APl': 0.41262144,
     'APm': 0.3272744,
     'APs': 0.10899775,
     'ARl': 0.6054671,
     'ARm': 0.5188545,
     'ARmax1': 0.26013517,
     'ARmax10': 0.43206924,
     'ARmax100': 0.4732463,
     'ARs': 0.23903508,
     'global': {'total_loss': 99.037384},
     'validation_loss': 99.037384}
train | step:  40000 | training until step 60000...
train | step:  50000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.62815523,
           'avg_obj': 0.21446936,
           'box_loss': 18.290579,
           'class_loss': 15.908252,
           'conf_loss': 62.643837,
           'precision50': 0.2342672,
           'recall50': 0.1737388},
     '4': {'avg_iou': 0.7315536,
           'avg_obj': 0.399811,
           'box_loss': 13.006501,
           'class_loss': 12.92889,
           'conf_loss': 18.856432,
           'precision50': 0.31725386,
           'recall50': 0.41381654},
     '5': {'avg_iou': 0.7646565,
           'avg_obj': 0.5057018,
           'box_loss': 5.723008,
           'class_loss': 6.3567834,
           'conf_loss': 3.3531485,
           'precision50': 0.41741207,
           'recall50': 0.5699949},
     'global': {'total_loss': 157.06723},
     'learning_rate': 0.001,
     'training_loss': 157.06723}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-50000.
train | step:  60000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6334977,
           'avg_obj': 0.2272493,
           'box_loss': 18.059748,
           'class_loss': 15.123903,
           'conf_loss': 63.154068,
           'precision50': 0.2382796,
           'recall50': 0.18752222},
     '4': {'avg_iou': 0.73844737,
           'avg_obj': 0.4180453,
           'box_loss': 12.687207,
           'class_loss': 12.148318,
           'conf_loss': 18.744738,
           'precision50': 0.31867525,
           'recall50': 0.43559146},
     '5': {'avg_iou': 0.7715575,
           'avg_obj': 0.5240989,
           'box_loss': 5.553382,
           'class_loss': 5.970867,
           'conf_loss': 3.3258145,
           'precision50': 0.414785,
           'recall50': 0.59229094},
     'global': {'total_loss': 154.76836},
     'learning_rate': 0.001,
     'training_loss': 154.76836}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-60000.
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=213.48s).
Accumulating evaluation results...
DONE (t=35.04s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.330
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.500
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.365
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.128
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.352
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.448
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.274
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.456
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.497
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.267
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.543
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.631
 eval | step:  60000 | eval time:  564.7 sec | output: 
    {'3': {'avg_iou': 0.48107755,
           'avg_obj': 0.21022637,
           'box_loss': 9.414492,
           'class_loss': 6.839229,
           'conf_loss': 45.91917,
           'precision50': 0.18591966,
           'recall50': 0.21183491},
     '4': {'avg_iou': 0.69648415,
           'avg_obj': 0.44962442,
           'box_loss': 7.365482,
           'class_loss': 5.7765293,
           'conf_loss': 13.299461,
           'precision50': 0.27482763,
           'recall50': 0.49489078},
     '5': {'avg_iou': 0.7593874,
           'avg_obj': 0.57850593,
           'box_loss': 3.7761536,
           'class_loss': 3.2555578,
           'conf_loss': 2.5320985,
           'precision50': 0.3673643,
           'recall50': 0.6498911},
     'AP': 0.32990083,
     'AP50': 0.49992535,
     'AP75': 0.3647349,
     'APl': 0.44788477,
     'APm': 0.35178602,
     'APs': 0.12812017,
     'ARl': 0.6306133,
     'ARm': 0.54288083,
     'ARmax1': 0.27435026,
     'ARmax10': 0.4556345,
     'ARmax100': 0.4974799,
     'ARs': 0.26673388,
     'global': {'total_loss': 98.17818},
     'validation_loss': 98.17818}I0505 09:00:25.513474 139820604045120 controller.py:211] train | step:  60000 | training until step 80000...
I0505 10:03:01.425701 139820604045120 controller.py:425] train | step:  70000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.63808274,
           'avg_obj': 0.23826863,
           'box_loss': 17.79789,
           'class_loss': 14.422689,
           'conf_loss': 62.83121,
           'precision50': 0.24521506,
           'recall50': 0.19956826},
     '4': {'avg_iou': 0.7439731,
           'avg_obj': 0.43289384,
           'box_loss': 12.408387,
           'class_loss': 11.50222,
           'conf_loss': 18.66624,
           'precision50': 0.31997555,
           'recall50': 0.4542969},
     '5': {'avg_iou': 0.7773226,
           'avg_obj': 0.53851366,
           'box_loss': 5.419718,
           'class_loss': 5.6680565,
           'conf_loss': 3.302993,
           'precision50': 0.4137717,
           'recall50': 0.6090404},
     'global': {'total_loss': 152.0192},
     'learning_rate': 0.001,
     'training_loss': 152.0192}
I0505 10:03:51.197538 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-70000.
I0505 11:08:37.191768 139820604045120 controller.py:425] train | step:  80000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6420869,
           'avg_obj': 0.24791104,
           'box_loss': 17.599865,
           'class_loss': 13.887723,
           'conf_loss': 62.91509,
           'precision50': 0.24847212,
           'recall50': 0.21011612},
     '4': {'avg_iou': 0.7484973,
           'avg_obj': 0.44590023,
           'box_loss': 12.173111,
           'class_loss': 10.991057,
           'conf_loss': 18.51816,
           'precision50': 0.32135528,
           'recall50': 0.4690193},
     '5': {'avg_iou': 0.78175414,
           'avg_obj': 0.5507612,
           'box_loss': 5.299294,
           'class_loss': 5.4162445,
           'conf_loss': 3.2787077,
           'precision50': 0.41222167,
           'recall50': 0.62338984},
     'global': {'total_loss': 150.079},
     'learning_rate': 0.001,
     'training_loss': 150.079}
I0505 11:09:26.646264 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-80000.
I0505 11:09:26.652022 139820604045120 controller.py:252]  eval | step:  80000 | running 625 steps of evaluation...
I0505 11:13:44.977958 139820604045120 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0505 11:18:37.202588 139820604045120 controller.py:261]  eval | step:  80000 | eval time:  550.5 sec | output: 
    {'3': {'avg_iou': 0.485505,
           'avg_obj': 0.2209862,
           'box_loss': 9.249994,
           'class_loss': 6.549765,
           'conf_loss': 46.843903,
           'precision50': 0.19213022,
           'recall50': 0.22436619},
     '4': {'avg_iou': 0.70189553,
           'avg_obj': 0.4674625,
           'box_loss': 7.1898947,
           'class_loss': 5.471881,
           'conf_loss': 13.4890175,
           'precision50': 0.27312106,
           'recall50': 0.5145538},
     '5': {'avg_iou': 0.7656454,
           'avg_obj': 0.5955558,
           'box_loss': 3.6539278,
           'class_loss': 3.0649545,
           'conf_loss': 2.544942,
           'precision50': 0.3600897,
           'recall50': 0.6673608},
     'AP': 0.3446582,
     'AP50': 0.5151552,
     'AP75': 0.37994057,
     'APl': 0.47034547,
     'APm': 0.36399823,
     'APs': 0.13923334,
     'ARl': 0.64559615,
     'ARm': 0.5549375,
     'ARmax1': 0.285516,
     'ARmax10': 0.46742582,
     'ARmax100': 0.50966537,
     'ARs': 0.27364784,
     'global': {'total_loss': 98.05826},
     'validation_loss': 98.05826}
I0505 11:18:54.342855 139820604045120 controller.py:211] train | step:  80000 | training until step 100000...
I0505 12:20:42.764110 139820604045120 controller.py:425] train | step:  90000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.64519334,
           'avg_obj': 0.256236,
           'box_loss': 17.450182,
           'class_loss': 13.47298,
           'conf_loss': 62.732975,
           'precision50': 0.2512489,
           'recall50': 0.21915147},
     '4': {'avg_iou': 0.7523058,
           'avg_obj': 0.456364,
           'box_loss': 11.985624,
           'class_loss': 10.581865,
           'conf_loss': 18.346214,
           'precision50': 0.32190412,
           'recall50': 0.4816386},
     '5': {'avg_iou': 0.7856686,
           'avg_obj': 0.5612019,
           'box_loss': 5.1985846,
           'class_loss': 5.195586,
           'conf_loss': 3.2474396,
           'precision50': 0.41082916,
           'recall50': 0.6354642},
     'global': {'total_loss': 148.21124},
     'learning_rate': 0.001,
     'training_loss': 148.21124}
I0505 12:21:30.302824 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-90000.
I0505 13:22:14.473029 139820604045120 controller.py:425] train | step:  100000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6479822,
           'avg_obj': 0.2643644,
           'box_loss': 17.359201,
           'class_loss': 13.113034,
           'conf_loss': 62.619312,
           'precision50': 0.25350067,
           'recall50': 0.22786906},
     '4': {'avg_iou': 0.7557292,
           'avg_obj': 0.46655136,
           'box_loss': 11.832874,
           'class_loss': 10.226574,
           'conf_loss': 18.248283,
           'precision50': 0.32218373,
           'recall50': 0.49316406},
     '5': {'avg_iou': 0.78905153,
           'avg_obj': 0.5702409,
           'box_loss': 5.1197944,
           'class_loss': 5.0327387,
           'conf_loss': 3.2206218,
           'precision50': 0.41058007,
           'recall50': 0.6459814},
     'global': {'total_loss': 146.77214},
     'learning_rate': 0.001,
     'training_loss': 146.77214}
I0505 13:23:06.540657 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-100000.
I0505 13:23:06.547160 139820604045120 controller.py:252]  eval | step:  100000 | running 625 steps of evaluation...
I0505 13:27:26.355073 139820604045120 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0505 13:32:20.162301 139820604045120 controller.py:261]  eval | step:  100000 | eval time:  553.6 sec | output: 
    {'3': {'avg_iou': 0.48816,
           'avg_obj': 0.22699565,
           'box_loss': 9.1441555,
           'class_loss': 6.368741,
           'conf_loss': 47.611095,
           'precision50': 0.19176193,
           'recall50': 0.23263045},
     '4': {'avg_iou': 0.70555955,
           'avg_obj': 0.47746953,
           'box_loss': 7.090922,
           'class_loss': 5.4004674,
           'conf_loss': 13.698625,
           'precision50': 0.27166933,
           'recall50': 0.52618694},
     '5': {'avg_iou': 0.76918656,
           'avg_obj': 0.60598874,
           'box_loss': 3.5863616,
           'class_loss': 3.0157118,
           'conf_loss': 2.5657177,
           'precision50': 0.35906732,
           'recall50': 0.6778493},
     'AP': 0.35210785,
     'AP50': 0.5239341,
     'AP75': 0.3887743,
     'APl': 0.48002008,
     'APm': 0.3734987,
     'APs': 0.14665525,
     'ARl': 0.65004164,
     'ARm': 0.55580056,
     'ARmax1': 0.28824675,
     'ARmax10': 0.4736595,
     'ARmax100': 0.5152129,
     'ARs': 0.28491005,
     'global': {'total_loss': 98.48182},
     'validation_loss': 98.48182}

train | step:  60000 | training until step 80000...
train | step:  70000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.63808274,
           'avg_obj': 0.23826863,
           'box_loss': 17.79789,
           'class_loss': 14.422689,
           'conf_loss': 62.83121,
           'precision50': 0.24521506,
           'recall50': 0.19956826},
     '4': {'avg_iou': 0.7439731,
           'avg_obj': 0.43289384,
           'box_loss': 12.408387,
           'class_loss': 11.50222,
           'conf_loss': 18.66624,
           'precision50': 0.31997555,
           'recall50': 0.4542969},
     '5': {'avg_iou': 0.7773226,
           'avg_obj': 0.53851366,
           'box_loss': 5.419718,
           'class_loss': 5.6680565,
           'conf_loss': 3.302993,
           'precision50': 0.4137717,
           'recall50': 0.6090404},
     'global': {'total_loss': 152.0192},
     'learning_rate': 0.001,
     'training_loss': 152.0192}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-70000.
train | step:  80000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6420869,
           'avg_obj': 0.24791104,
           'box_loss': 17.599865,
           'class_loss': 13.887723,
           'conf_loss': 62.91509,
           'precision50': 0.24847212,
           'recall50': 0.21011612},
     '4': {'avg_iou': 0.7484973,
           'avg_obj': 0.44590023,
           'box_loss': 12.173111,
           'class_loss': 10.991057,
           'conf_loss': 18.51816,
           'precision50': 0.32135528,
           'recall50': 0.4690193},
     '5': {'avg_iou': 0.78175414,
           'avg_obj': 0.5507612,
           'box_loss': 5.299294,
           'class_loss': 5.4162445,
           'conf_loss': 3.2787077,
           'precision50': 0.41222167,
           'recall50': 0.62338984},
     'global': {'total_loss': 150.079},
     'learning_rate': 0.001,
     'training_loss': 150.079}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-80000.
 eval | step:  80000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=202.74s).
Accumulating evaluation results...
DONE (t=32.99s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.345
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.515
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.380
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.139
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.364
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.470
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.286
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.467
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.510
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.274
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.555
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.646
 eval | step:  80000 | eval time:  550.5 sec | output: 
    {'3': {'avg_iou': 0.485505,
           'avg_obj': 0.2209862,
           'box_loss': 9.249994,
           'class_loss': 6.549765,
           'conf_loss': 46.843903,
           'precision50': 0.19213022,
           'recall50': 0.22436619},
     '4': {'avg_iou': 0.70189553,
           'avg_obj': 0.4674625,
           'box_loss': 7.1898947,
           'class_loss': 5.471881,
           'conf_loss': 13.4890175,
           'precision50': 0.27312106,
           'recall50': 0.5145538},
     '5': {'avg_iou': 0.7656454,
           'avg_obj': 0.5955558,
           'box_loss': 3.6539278,
           'class_loss': 3.0649545,
           'conf_loss': 2.544942,
           'precision50': 0.3600897,
           'recall50': 0.6673608},
     'AP': 0.3446582,
     'AP50': 0.5151552,
     'AP75': 0.37994057,
     'APl': 0.47034547,
     'APm': 0.36399823,
     'APs': 0.13923334,
     'ARl': 0.64559615,
     'ARm': 0.5549375,
     'ARmax1': 0.285516,
     'ARmax10': 0.46742582,
     'ARmax100': 0.50966537,
     'ARs': 0.27364784,
     'global': {'total_loss': 98.05826},
     'validation_loss': 98.05826}
train | step:  80000 | training until step 100000...
train | step:  90000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.64519334,
           'avg_obj': 0.256236,
           'box_loss': 17.450182,
           'class_loss': 13.47298,
           'conf_loss': 62.732975,
           'precision50': 0.2512489,
           'recall50': 0.21915147},
     '4': {'avg_iou': 0.7523058,
           'avg_obj': 0.456364,
           'box_loss': 11.985624,
           'class_loss': 10.581865,
           'conf_loss': 18.346214,
           'precision50': 0.32190412,
           'recall50': 0.4816386},
     '5': {'avg_iou': 0.7856686,
           'avg_obj': 0.5612019,
           'box_loss': 5.1985846,
           'class_loss': 5.195586,
           'conf_loss': 3.2474396,
           'precision50': 0.41082916,
           'recall50': 0.6354642},
     'global': {'total_loss': 148.21124},
     'learning_rate': 0.001,
     'training_loss': 148.21124}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-90000.
train | step:  100000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6479822,
           'avg_obj': 0.2643644,
           'box_loss': 17.359201,
           'class_loss': 13.113034,
           'conf_loss': 62.619312,
           'precision50': 0.25350067,
           'recall50': 0.22786906},
     '4': {'avg_iou': 0.7557292,
           'avg_obj': 0.46655136,
           'box_loss': 11.832874,
           'class_loss': 10.226574,
           'conf_loss': 18.248283,
           'precision50': 0.32218373,
           'recall50': 0.49316406},
     '5': {'avg_iou': 0.78905153,
           'avg_obj': 0.5702409,
           'box_loss': 5.1197944,
           'class_loss': 5.0327387,
           'conf_loss': 3.2206218,
           'precision50': 0.41058007,
           'recall50': 0.6459814},
     'global': {'total_loss': 146.77214},
     'learning_rate': 0.001,
     'training_loss': 146.77214}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-100000.
 eval | step:  100000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=201.46s).
Accumulating evaluation results...
DONE (t=33.13s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.352
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.524
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.389
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.147
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.373
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.480
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.288
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.474
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.515
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.285
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.556
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.650
 eval | step:  100000 | eval time:  553.6 sec | output: 
    {'3': {'avg_iou': 0.48816,
           'avg_obj': 0.22699565,
           'box_loss': 9.1441555,
           'class_loss': 6.368741,
           'conf_loss': 47.611095,
           'precision50': 0.19176193,
           'recall50': 0.23263045},
     '4': {'avg_iou': 0.70555955,
           'avg_obj': 0.47746953,
           'box_loss': 7.090922,
           'class_loss': 5.4004674,
           'conf_loss': 13.698625,
           'precision50': 0.27166933,
           'recall50': 0.52618694},
     '5': {'avg_iou': 0.76918656,
           'avg_obj': 0.60598874,
           'box_loss': 3.5863616,
           'class_loss': 3.0157118,
           'conf_loss': 2.5657177,
           'precision50': 0.35906732,
           'recall50': 0.6778493},
     'AP': 0.35210785,
     'AP50': 0.5239341,
     'AP75': 0.3887743,
     'APl': 0.48002008,
     'APm': 0.3734987,
     'APs': 0.14665525,
     'ARl': 0.65004164,
     'ARm': 0.55580056,
     'ARmax1': 0.28824675,
     'ARmax10': 0.4736595,
     'ARmax100': 0.5152129,
     'ARs': 0.28491005,
     'global': {'total_loss': 98.48182},
     'validation_loss': 98.48182}I0505 13:32:37.032601 139820604045120 controller.py:211] train | step:  100000 | training until step 120000...
I0505 14:36:16.694248 139820604045120 controller.py:425] train | step:  110000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.65066475,
           'avg_obj': 0.27128264,
           'box_loss': 17.182863,
           'class_loss': 12.745357,
           'conf_loss': 62.562737,
           'precision50': 0.2542301,
           'recall50': 0.2357417},
     '4': {'avg_iou': 0.7586453,
           'avg_obj': 0.47534966,
           'box_loss': 11.67766,
           'class_loss': 9.93417,
           'conf_loss': 18.0589,
           'precision50': 0.32221857,
           'recall50': 0.5029654},
     '5': {'avg_iou': 0.7920544,
           'avg_obj': 0.5783863,
           'box_loss': 5.0443673,
           'class_loss': 4.880529,
           'conf_loss': 3.193826,
           'precision50': 0.41032818,
           'recall50': 0.6548768},
     'global': {'total_loss': 145.28053},
     'learning_rate': 0.001,
     'training_loss': 145.28053}
I0505 14:37:03.409901 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-110000.
I0505 15:46:38.420777 139820604045120 controller.py:425] train | step:  120000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.65271455,
           'avg_obj': 0.2775735,
           'box_loss': 17.080317,
           'class_loss': 12.441015,
           'conf_loss': 62.42574,
           'precision50': 0.25519902,
           'recall50': 0.24270836},
     '4': {'avg_iou': 0.761284,
           'avg_obj': 0.4832886,
           'box_loss': 11.543719,
           'class_loss': 9.643494,
           'conf_loss': 17.890257,
           'precision50': 0.3229243,
           'recall50': 0.51188517},
     '5': {'avg_iou': 0.7947136,
           'avg_obj': 0.58565307,
           'box_loss': 4.971836,
           'class_loss': 4.7357335,
           'conf_loss': 3.1737888,
           'precision50': 0.40860683,
           'recall50': 0.6623152},
     'global': {'total_loss': 143.90578},
     'learning_rate': 0.001,
     'training_loss': 143.90578}
I0505 15:47:41.252284 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-120000.
I0505 15:47:41.258920 139820604045120 controller.py:252]  eval | step:  120000 | running 625 steps of evaluation...
I0505 15:52:00.065988 139820604045120 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0505 15:56:52.382241 139820604045120 controller.py:261]  eval | step:  120000 | eval time:  551.1 sec | output: 
    {'3': {'avg_iou': 0.48980087,
           'avg_obj': 0.23296125,
           'box_loss': 9.069593,
           'class_loss': 6.287953,
           'conf_loss': 48.57299,
           'precision50': 0.19134735,
           'recall50': 0.23979895},
     '4': {'avg_iou': 0.70772254,
           'avg_obj': 0.48689917,
           'box_loss': 7.0171666,
           'class_loss': 5.332156,
           'conf_loss': 13.762926,
           'precision50': 0.2706453,
           'recall50': 0.53638196},
     '5': {'avg_iou': 0.77248347,
           'avg_obj': 0.61567336,
           'box_loss': 3.524741,
           'class_loss': 2.9685218,
           'conf_loss': 2.5825536,
           'precision50': 0.35479596,
           'recall50': 0.6875541},
     'AP': 0.35710633,
     'AP50': 0.5281678,
     'AP75': 0.39202565,
     'APl': 0.48797593,
     'APm': 0.37516662,
     'APs': 0.15308875,
     'ARl': 0.6566624,
     'ARm': 0.5598435,
     'ARmax1': 0.29155836,
     'ARmax10': 0.4791099,
     'ARmax100': 0.5199743,
     'ARs': 0.30320626,
     'global': {'total_loss': 99.11861},
     'validation_loss': 99.11861}
I0505 15:57:09.388794 139820604045120 controller.py:211] train | step:  120000 | training until step 140000...
I0505 16:53:58.675596 139820604045120 controller.py:425] train | step:  130000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6550228,
           'avg_obj': 0.28418675,
           'box_loss': 17.021894,
           'class_loss': 12.223136,
           'conf_loss': 62.455826,
           'precision50': 0.25598636,
           'recall50': 0.25017655},
     '4': {'avg_iou': 0.76360464,
           'avg_obj': 0.49071163,
           'box_loss': 11.450636,
           'class_loss': 9.415453,
           'conf_loss': 17.750994,
           'precision50': 0.323961,
           'recall50': 0.5207802},
     '5': {'avg_iou': 0.7969797,
           'avg_obj': 0.59227383,
           'box_loss': 4.9209924,
           'class_loss': 4.621726,
           'conf_loss': 3.142159,
           'precision50': 0.4093599,
           'recall50': 0.67028415},
     'global': {'total_loss': 143.00232},
     'learning_rate': 0.001,
     'training_loss': 143.00232}
I0505 16:54:45.594527 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-130000.
I0505 17:59:51.483188 139820604045120 controller.py:425] train | step:  140000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6568207,
           'avg_obj': 0.28982797,
           'box_loss': 16.903206,
           'class_loss': 11.9475,
           'conf_loss': 61.98086,
           'precision50': 0.2571347,
           'recall50': 0.25615352},
     '4': {'avg_iou': 0.7658598,
           'avg_obj': 0.49780443,
           'box_loss': 11.3368025,
           'class_loss': 9.183159,
           'conf_loss': 17.589027,
           'precision50': 0.32487604,
           'recall50': 0.528911},
     '5': {'avg_iou': 0.79912937,
           'avg_obj': 0.598523,
           'box_loss': 4.87212,
           'class_loss': 4.518346,
           'conf_loss': 3.1224813,
           'precision50': 0.40839148,
           'recall50': 0.6768352},
     'global': {'total_loss': 141.45377},
     'learning_rate': 0.001,
     'training_loss': 141.45377}
I0505 18:00:39.830757 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-140000.
I0505 18:00:39.836880 139820604045120 controller.py:252]  eval | step:  140000 | running 625 steps of evaluation...
I0505 18:05:00.203388 139820604045120 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0505 18:09:56.195609 139820604045120 controller.py:261]  eval | step:  140000 | eval time:  556.4 sec | output: 
    {'3': {'avg_iou': 0.49107718,
           'avg_obj': 0.23695248,
           'box_loss': 9.008886,
           'class_loss': 6.1874027,
           'conf_loss': 49.634003,
           'precision50': 0.18909477,
           'recall50': 0.24507348},
     '4': {'avg_iou': 0.70856225,
           'avg_obj': 0.49171177,
           'box_loss': 6.971911,
           'class_loss': 5.2611265,
           'conf_loss': 13.957655,
           'precision50': 0.2695655,
           'recall50': 0.5417247},
     '5': {'avg_iou': 0.7736184,
           'avg_obj': 0.62097514,
           'box_loss': 3.4967437,
           'class_loss': 2.9737625,
           'conf_loss': 2.6284714,
           'precision50': 0.35331923,
           'recall50': 0.69292605},
     'AP': 0.35942498,
     'AP50': 0.5303535,
     'AP75': 0.3954926,
     'APl': 0.49188635,
     'APm': 0.3782086,
     'APs': 0.15486386,
     'ARl': 0.6623165,
     'ARm': 0.5642992,
     'ARmax1': 0.29193017,
     'ARmax10': 0.48043045,
     'ARmax100': 0.5233407,
     'ARs': 0.30298638,
     'global': {'total_loss': 100.11998},
     'validation_loss': 100.11998}

train | step:  100000 | training until step 120000...
train | step:  110000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.65066475,
           'avg_obj': 0.27128264,
           'box_loss': 17.182863,
           'class_loss': 12.745357,
           'conf_loss': 62.562737,
           'precision50': 0.2542301,
           'recall50': 0.2357417},
     '4': {'avg_iou': 0.7586453,
           'avg_obj': 0.47534966,
           'box_loss': 11.67766,
           'class_loss': 9.93417,
           'conf_loss': 18.0589,
           'precision50': 0.32221857,
           'recall50': 0.5029654},
     '5': {'avg_iou': 0.7920544,
           'avg_obj': 0.5783863,
           'box_loss': 5.0443673,
           'class_loss': 4.880529,
           'conf_loss': 3.193826,
           'precision50': 0.41032818,
           'recall50': 0.6548768},
     'global': {'total_loss': 145.28053},
     'learning_rate': 0.001,
     'training_loss': 145.28053}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-110000.
train | step:  120000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.65271455,
           'avg_obj': 0.2775735,
           'box_loss': 17.080317,
           'class_loss': 12.441015,
           'conf_loss': 62.42574,
           'precision50': 0.25519902,
           'recall50': 0.24270836},
     '4': {'avg_iou': 0.761284,
           'avg_obj': 0.4832886,
           'box_loss': 11.543719,
           'class_loss': 9.643494,
           'conf_loss': 17.890257,
           'precision50': 0.3229243,
           'recall50': 0.51188517},
     '5': {'avg_iou': 0.7947136,
           'avg_obj': 0.58565307,
           'box_loss': 4.971836,
           'class_loss': 4.7357335,
           'conf_loss': 3.1737888,
           'precision50': 0.40860683,
           'recall50': 0.6623152},
     'global': {'total_loss': 143.90578},
     'learning_rate': 0.001,
     'training_loss': 143.90578}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-120000.
 eval | step:  120000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=201.41s).
Accumulating evaluation results...
DONE (t=33.64s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.357
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.528
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.392
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.153
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.375
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.488
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.292
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.479
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.520
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.303
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.560
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.657
 eval | step:  120000 | eval time:  551.1 sec | output: 
    {'3': {'avg_iou': 0.48980087,
           'avg_obj': 0.23296125,
           'box_loss': 9.069593,
           'class_loss': 6.287953,
           'conf_loss': 48.57299,
           'precision50': 0.19134735,
           'recall50': 0.23979895},
     '4': {'avg_iou': 0.70772254,
           'avg_obj': 0.48689917,
           'box_loss': 7.0171666,
           'class_loss': 5.332156,
           'conf_loss': 13.762926,
           'precision50': 0.2706453,
           'recall50': 0.53638196},
     '5': {'avg_iou': 0.77248347,
           'avg_obj': 0.61567336,
           'box_loss': 3.524741,
           'class_loss': 2.9685218,
           'conf_loss': 2.5825536,
           'precision50': 0.35479596,
           'recall50': 0.6875541},
     'AP': 0.35710633,
     'AP50': 0.5281678,
     'AP75': 0.39202565,
     'APl': 0.48797593,
     'APm': 0.37516662,
     'APs': 0.15308875,
     'ARl': 0.6566624,
     'ARm': 0.5598435,
     'ARmax1': 0.29155836,
     'ARmax10': 0.4791099,
     'ARmax100': 0.5199743,
     'ARs': 0.30320626,
     'global': {'total_loss': 99.11861},
     'validation_loss': 99.11861}
train | step:  120000 | training until step 140000...
train | step:  130000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6550228,
           'avg_obj': 0.28418675,
           'box_loss': 17.021894,
           'class_loss': 12.223136,
           'conf_loss': 62.455826,
           'precision50': 0.25598636,
           'recall50': 0.25017655},
     '4': {'avg_iou': 0.76360464,
           'avg_obj': 0.49071163,
           'box_loss': 11.450636,
           'class_loss': 9.415453,
           'conf_loss': 17.750994,
           'precision50': 0.323961,
           'recall50': 0.5207802},
     '5': {'avg_iou': 0.7969797,
           'avg_obj': 0.59227383,
           'box_loss': 4.9209924,
           'class_loss': 4.621726,
           'conf_loss': 3.142159,
           'precision50': 0.4093599,
           'recall50': 0.67028415},
     'global': {'total_loss': 143.00232},
     'learning_rate': 0.001,
     'training_loss': 143.00232}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-130000.
train | step:  140000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6568207,
           'avg_obj': 0.28982797,
           'box_loss': 16.903206,
           'class_loss': 11.9475,
           'conf_loss': 61.98086,
           'precision50': 0.2571347,
           'recall50': 0.25615352},
     '4': {'avg_iou': 0.7658598,
           'avg_obj': 0.49780443,
           'box_loss': 11.3368025,
           'class_loss': 9.183159,
           'conf_loss': 17.589027,
           'precision50': 0.32487604,
           'recall50': 0.528911},
     '5': {'avg_iou': 0.79912937,
           'avg_obj': 0.598523,
           'box_loss': 4.87212,
           'class_loss': 4.518346,
           'conf_loss': 3.1224813,
           'precision50': 0.40839148,
           'recall50': 0.6768352},
     'global': {'total_loss': 141.45377},
     'learning_rate': 0.001,
     'training_loss': 141.45377}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-140000.
 eval | step:  140000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=202.02s).
Accumulating evaluation results...
DONE (t=33.41s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.359
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.530
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.395
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.155
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.378
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.492
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.292
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.480
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.523
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.303
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.564
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.662
 eval | step:  140000 | eval time:  556.4 sec | output: 
    {'3': {'avg_iou': 0.49107718,
           'avg_obj': 0.23695248,
           'box_loss': 9.008886,
           'class_loss': 6.1874027,
           'conf_loss': 49.634003,
           'precision50': 0.18909477,
           'recall50': 0.24507348},
     '4': {'avg_iou': 0.70856225,
           'avg_obj': 0.49171177,
           'box_loss': 6.971911,
           'class_loss': 5.2611265,
           'conf_loss': 13.957655,
           'precision50': 0.2695655,
           'recall50': 0.5417247},
     '5': {'avg_iou': 0.7736184,
           'avg_obj': 0.62097514,
           'box_loss': 3.4967437,
           'class_loss': 2.9737625,
           'conf_loss': 2.6284714,
           'precision50': 0.35331923,
           'recall50': 0.69292605},
     'AP': 0.35942498,
     'AP50': 0.5303535,
     'AP75': 0.3954926,
     'APl': 0.49188635,
     'APm': 0.3782086,
     'APs': 0.15486386,
     'ARl': 0.6623165,
     'ARm': 0.5642992,
     'ARmax1': 0.29193017,
     'ARmax10': 0.48043045,
     'ARmax100': 0.5233407,
     'ARs': 0.30298638,
     'global': {'total_loss': 100.11998},
     'validation_loss': 100.11998}I0505 18:10:13.025604 139820604045120 controller.py:211] train | step:  140000 | training until step 160000...
I0505 19:06:42.801906 139820604045120 controller.py:425] train | step:  150000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.65880275,
           'avg_obj': 0.29542297,
           'box_loss': 16.886726,
           'class_loss': 11.762277,
           'conf_loss': 61.88492,
           'precision50': 0.25746316,
           'recall50': 0.26170206},
     '4': {'avg_iou': 0.76777214,
           'avg_obj': 0.50400656,
           'box_loss': 11.261927,
           'class_loss': 8.999701,
           'conf_loss': 17.521982,
           'precision50': 0.3243552,
           'recall50': 0.53554183},
     '5': {'avg_iou': 0.80101347,
           'avg_obj': 0.6039347,
           'box_loss': 4.8288326,
           'class_loss': 4.422347,
           'conf_loss': 3.1044438,
           'precision50': 0.40778294,
           'recall50': 0.6822183},
     'global': {'total_loss': 140.6735},
     'learning_rate': 0.001,
     'training_loss': 140.6735}
I0505 19:07:34.376317 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-150000.
I0505 20:07:35.564469 139820604045120 controller.py:425] train | step:  160000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.66039217,
           'avg_obj': 0.3011576,
           'box_loss': 16.755806,
           'class_loss': 11.5263605,
           'conf_loss': 61.302532,
           'precision50': 0.2588152,
           'recall50': 0.2678404},
     '4': {'avg_iou': 0.769803,
           'avg_obj': 0.51072896,
           'box_loss': 11.142568,
           'class_loss': 8.791024,
           'conf_loss': 17.302113,
           'precision50': 0.32453468,
           'recall50': 0.5431287},
     '5': {'avg_iou': 0.8031731,
           'avg_obj': 0.61006206,
           'box_loss': 4.7670484,
           'class_loss': 4.3058467,
           'conf_loss': 3.063492,
           'precision50': 0.4081423,
           'recall50': 0.68893933},
     'global': {'total_loss': 138.9564},
     'learning_rate': 0.001,
     'training_loss': 138.9564}
I0505 20:08:21.627393 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-160000.
I0505 20:08:21.633086 139820604045120 controller.py:252]  eval | step:  160000 | running 625 steps of evaluation...
I0505 20:12:41.094441 139820604045120 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0505 20:17:38.558930 139820604045120 controller.py:261]  eval | step:  160000 | eval time:  556.9 sec | output: 
    {'3': {'avg_iou': 0.49220097,
           'avg_obj': 0.24014387,
           'box_loss': 8.9672365,
           'class_loss': 6.150597,
           'conf_loss': 49.674114,
           'precision50': 0.18950973,
           'recall50': 0.2512051},
     '4': {'avg_iou': 0.70999676,
           'avg_obj': 0.4948442,
           'box_loss': 6.94525,
           'class_loss': 5.229664,
           'conf_loss': 14.097274,
           'precision50': 0.2673681,
           'recall50': 0.54654485},
     '5': {'avg_iou': 0.77500105,
           'avg_obj': 0.6260297,
           'box_loss': 3.47239,
           'class_loss': 2.925371,
           'conf_loss': 2.6284423,
           'precision50': 0.34977174,
           'recall50': 0.6965872},
     'AP': 0.3624697,
     'AP50': 0.5328663,
     'AP75': 0.39769748,
     'APl': 0.49223503,
     'APm': 0.38323897,
     'APs': 0.15743563,
     'ARl': 0.66160804,
     'ARm': 0.56370765,
     'ARmax1': 0.2938028,
     'ARmax10': 0.48279956,
     'ARmax100': 0.5243942,
     'ARs': 0.30369323,
     'global': {'total_loss': 100.09028},
     'validation_loss': 100.09028}
I0505 20:17:55.020001 139820604045120 controller.py:211] train | step:  160000 | training until step 180000...
I0505 21:11:21.959513 139820604045120 controller.py:425] train | step:  170000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6620263,
           'avg_obj': 0.3059388,
           'box_loss': 16.658943,
           'class_loss': 11.343972,
           'conf_loss': 60.87538,
           'precision50': 0.26043937,
           'recall50': 0.273223},
     '4': {'avg_iou': 0.77148,
           'avg_obj': 0.5161911,
           'box_loss': 11.043632,
           'class_loss': 8.611483,
           'conf_loss': 17.132822,
           'precision50': 0.3252671,
           'recall50': 0.5489854},
     '5': {'avg_iou': 0.80480534,
           'avg_obj': 0.61463255,
           'box_loss': 4.718481,
           'class_loss': 4.2188706,
           'conf_loss': 3.0434833,
           'precision50': 0.40749192,
           'recall50': 0.69378006},
     'global': {'total_loss': 137.64665},
     'learning_rate': 0.001,
     'training_loss': 137.64665}
I0505 21:12:10.833003 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-170000.
I0505 22:12:56.467928 139820604045120 controller.py:425] train | step:  180000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.66323984,
           'avg_obj': 0.31052136,
           'box_loss': 16.618212,
           'class_loss': 11.165065,
           'conf_loss': 60.66179,
           'precision50': 0.26083976,
           'recall50': 0.2783259},
     '4': {'avg_iou': 0.77283674,
           'avg_obj': 0.521223,
           'box_loss': 10.982937,
           'class_loss': 8.470411,
           'conf_loss': 17.058027,
           'precision50': 0.32462445,
           'recall50': 0.5540357},
     '5': {'avg_iou': 0.80619437,
           'avg_obj': 0.61907923,
           'box_loss': 4.6860814,
           'class_loss': 4.137712,
           'conf_loss': 3.0193093,
           'precision50': 0.40747225,
           'recall50': 0.698197},
     'global': {'total_loss': 136.79967},
     'learning_rate': 0.001,
     'training_loss': 136.79967}
I0505 22:13:45.591613 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-180000.
I0505 22:13:45.597684 139820604045120 controller.py:252]  eval | step:  180000 | running 625 steps of evaluation...
I0505 22:18:07.361923 139820604045120 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0505 22:23:08.850822 139820604045120 controller.py:261]  eval | step:  180000 | eval time:  563.3 sec | output: 
    {'3': {'avg_iou': 0.49281964,
           'avg_obj': 0.24205552,
           'box_loss': 8.935207,
           'class_loss': 6.16424,
           'conf_loss': 50.32626,
           'precision50': 0.18900487,
           'recall50': 0.25333273},
     '4': {'avg_iou': 0.71037227,
           'avg_obj': 0.49807885,
           'box_loss': 6.930434,
           'class_loss': 5.310294,
           'conf_loss': 14.282687,
           'precision50': 0.26551723,
           'recall50': 0.5494985},
     '5': {'avg_iou': 0.77626574,
           'avg_obj': 0.6293222,
           'box_loss': 3.4498937,
           'class_loss': 2.9438293,
           'conf_loss': 2.6410217,
           'precision50': 0.34992853,
           'recall50': 0.6994617},
     'AP': 0.36263868,
     'AP50': 0.53279305,
     'AP75': 0.39877808,
     'APl': 0.4964342,
     'APm': 0.37945178,
     'APs': 0.15650754,
     'ARl': 0.6664915,
     'ARm': 0.56336164,
     'ARmax1': 0.29487786,
     'ARmax10': 0.4850233,
     'ARmax100': 0.5263163,
     'ARs': 0.3071581,
     'global': {'total_loss': 100.98388},
     'validation_loss': 100.98388}

train | step:  140000 | training until step 160000...
train | step:  150000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.65880275,
           'avg_obj': 0.29542297,
           'box_loss': 16.886726,
           'class_loss': 11.762277,
           'conf_loss': 61.88492,
           'precision50': 0.25746316,
           'recall50': 0.26170206},
     '4': {'avg_iou': 0.76777214,
           'avg_obj': 0.50400656,
           'box_loss': 11.261927,
           'class_loss': 8.999701,
           'conf_loss': 17.521982,
           'precision50': 0.3243552,
           'recall50': 0.53554183},
     '5': {'avg_iou': 0.80101347,
           'avg_obj': 0.6039347,
           'box_loss': 4.8288326,
           'class_loss': 4.422347,
           'conf_loss': 3.1044438,
           'precision50': 0.40778294,
           'recall50': 0.6822183},
     'global': {'total_loss': 140.6735},
     'learning_rate': 0.001,
     'training_loss': 140.6735}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-150000.
train | step:  160000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.66039217,
           'avg_obj': 0.3011576,
           'box_loss': 16.755806,
           'class_loss': 11.5263605,
           'conf_loss': 61.302532,
           'precision50': 0.2588152,
           'recall50': 0.2678404},
     '4': {'avg_iou': 0.769803,
           'avg_obj': 0.51072896,
           'box_loss': 11.142568,
           'class_loss': 8.791024,
           'conf_loss': 17.302113,
           'precision50': 0.32453468,
           'recall50': 0.5431287},
     '5': {'avg_iou': 0.8031731,
           'avg_obj': 0.61006206,
           'box_loss': 4.7670484,
           'class_loss': 4.3058467,
           'conf_loss': 3.063492,
           'precision50': 0.4081423,
           'recall50': 0.68893933},
     'global': {'total_loss': 138.9564},
     'learning_rate': 0.001,
     'training_loss': 138.9564}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-160000.
 eval | step:  160000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=204.38s).
Accumulating evaluation results...
DONE (t=33.45s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.362
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.533
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.398
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.157
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.383
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.492
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.294
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.483
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.524
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.304
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.564
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.662
 eval | step:  160000 | eval time:  556.9 sec | output: 
    {'3': {'avg_iou': 0.49220097,
           'avg_obj': 0.24014387,
           'box_loss': 8.9672365,
           'class_loss': 6.150597,
           'conf_loss': 49.674114,
           'precision50': 0.18950973,
           'recall50': 0.2512051},
     '4': {'avg_iou': 0.70999676,
           'avg_obj': 0.4948442,
           'box_loss': 6.94525,
           'class_loss': 5.229664,
           'conf_loss': 14.097274,
           'precision50': 0.2673681,
           'recall50': 0.54654485},
     '5': {'avg_iou': 0.77500105,
           'avg_obj': 0.6260297,
           'box_loss': 3.47239,
           'class_loss': 2.925371,
           'conf_loss': 2.6284423,
           'precision50': 0.34977174,
           'recall50': 0.6965872},
     'AP': 0.3624697,
     'AP50': 0.5328663,
     'AP75': 0.39769748,
     'APl': 0.49223503,
     'APm': 0.38323897,
     'APs': 0.15743563,
     'ARl': 0.66160804,
     'ARm': 0.56370765,
     'ARmax1': 0.2938028,
     'ARmax10': 0.48279956,
     'ARmax100': 0.5243942,
     'ARs': 0.30369323,
     'global': {'total_loss': 100.09028},
     'validation_loss': 100.09028}
train | step:  160000 | training until step 180000...
train | step:  170000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6620263,
           'avg_obj': 0.3059388,
           'box_loss': 16.658943,
           'class_loss': 11.343972,
           'conf_loss': 60.87538,
           'precision50': 0.26043937,
           'recall50': 0.273223},
     '4': {'avg_iou': 0.77148,
           'avg_obj': 0.5161911,
           'box_loss': 11.043632,
           'class_loss': 8.611483,
           'conf_loss': 17.132822,
           'precision50': 0.3252671,
           'recall50': 0.5489854},
     '5': {'avg_iou': 0.80480534,
           'avg_obj': 0.61463255,
           'box_loss': 4.718481,
           'class_loss': 4.2188706,
           'conf_loss': 3.0434833,
           'precision50': 0.40749192,
           'recall50': 0.69378006},
     'global': {'total_loss': 137.64665},
     'learning_rate': 0.001,
     'training_loss': 137.64665}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-170000.
train | step:  180000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.66323984,
           'avg_obj': 0.31052136,
           'box_loss': 16.618212,
           'class_loss': 11.165065,
           'conf_loss': 60.66179,
           'precision50': 0.26083976,
           'recall50': 0.2783259},
     '4': {'avg_iou': 0.77283674,
           'avg_obj': 0.521223,
           'box_loss': 10.982937,
           'class_loss': 8.470411,
           'conf_loss': 17.058027,
           'precision50': 0.32462445,
           'recall50': 0.5540357},
     '5': {'avg_iou': 0.80619437,
           'avg_obj': 0.61907923,
           'box_loss': 4.6860814,
           'class_loss': 4.137712,
           'conf_loss': 3.0193093,
           'precision50': 0.40747225,
           'recall50': 0.698197},
     'global': {'total_loss': 136.79967},
     'learning_rate': 0.001,
     'training_loss': 136.79967}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-180000.
 eval | step:  180000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=204.53s).
Accumulating evaluation results...
DONE (t=33.23s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.363
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.533
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.399
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.157
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.379
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.496
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.295
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.526
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.307
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.563
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.666
 eval | step:  180000 | eval time:  563.3 sec | output: 
    {'3': {'avg_iou': 0.49281964,
           'avg_obj': 0.24205552,
           'box_loss': 8.935207,
           'class_loss': 6.16424,
           'conf_loss': 50.32626,
           'precision50': 0.18900487,
           'recall50': 0.25333273},
     '4': {'avg_iou': 0.71037227,
           'avg_obj': 0.49807885,
           'box_loss': 6.930434,
           'class_loss': 5.310294,
           'conf_loss': 14.282687,
           'precision50': 0.26551723,
           'recall50': 0.5494985},
     '5': {'avg_iou': 0.77626574,
           'avg_obj': 0.6293222,
           'box_loss': 3.4498937,
           'class_loss': 2.9438293,
           'conf_loss': 2.6410217,
           'precision50': 0.34992853,
           'recall50': 0.6994617},
     'AP': 0.36263868,
     'AP50': 0.53279305,
     'AP75': 0.39877808,
     'APl': 0.4964342,
     'APm': 0.37945178,
     'APs': 0.15650754,
     'ARl': 0.6664915,
     'ARm': 0.56336164,
     'ARmax1': 0.29487786,
     'ARmax10': 0.4850233,
     'ARmax100': 0.5263163,
     'ARs': 0.3071581,
     'global': {'total_loss': 100.98388},
     'validation_loss': 100.98388}I0505 22:23:25.962738 139820604045120 controller.py:211] train | step:  180000 | training until step 200000...
I0505 23:15:26.246260 139820604045120 controller.py:425] train | step:  190000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.66467,
           'avg_obj': 0.31484517,
           'box_loss': 16.56853,
           'class_loss': 11.037604,
           'conf_loss': 60.421894,
           'precision50': 0.2627676,
           'recall50': 0.28309512},
     '4': {'avg_iou': 0.7742801,
           'avg_obj': 0.5261734,
           'box_loss': 10.930203,
           'class_loss': 8.338531,
           'conf_loss': 16.969515,
           'precision50': 0.32345176,
           'recall50': 0.559413},
     '5': {'avg_iou': 0.8077891,
           'avg_obj': 0.6237622,
           'box_loss': 4.6529756,
           'class_loss': 4.0669236,
           'conf_loss': 3.0000348,
           'precision50': 0.40755504,
           'recall50': 0.7033642},
     'global': {'total_loss': 135.98601},
     'learning_rate': 0.001,
     'training_loss': 135.98601}
I0505 23:16:15.206270 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-190000.
I0506 00:16:21.039364 139820604045120 controller.py:425] train | step:  200000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6661964,
           'avg_obj': 0.3194407,
           'box_loss': 16.466183,
           'class_loss': 10.848688,
           'conf_loss': 59.872143,
           'precision50': 0.26441854,
           'recall50': 0.28792763},
     '4': {'avg_iou': 0.7759447,
           'avg_obj': 0.5315763,
           'box_loss': 10.841269,
           'class_loss': 8.181889,
           'conf_loss': 16.807415,
           'precision50': 0.32321575,
           'recall50': 0.56534165},
     '5': {'avg_iou': 0.8090961,
           'avg_obj': 0.6281831,
           'box_loss': 4.6238565,
           'class_loss': 3.9904668,
           'conf_loss': 2.9703007,
           'precision50': 0.4079405,
           'recall50': 0.7088064},
     'global': {'total_loss': 134.60219},
     'learning_rate': 0.001,
     'training_loss': 134.60219}
I0506 00:17:09.469886 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-200000.
I0506 00:17:09.475596 139820604045120 controller.py:252]  eval | step:  200000 | running 625 steps of evaluation...
I0506 00:21:28.665336 139820604045120 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0506 00:26:24.648469 139820604045120 controller.py:261]  eval | step:  200000 | eval time:  555.2 sec | output: 
    {'3': {'avg_iou': 0.49383605,
           'avg_obj': 0.24445249,
           'box_loss': 8.910268,
           'class_loss': 6.1019645,
           'conf_loss': 50.46361,
           'precision50': 0.19067022,
           'recall50': 0.25674242},
     '4': {'avg_iou': 0.71149963,
           'avg_obj': 0.50144774,
           'box_loss': 6.904757,
           'class_loss': 5.255128,
           'conf_loss': 14.342614,
           'precision50': 0.2633415,
           'recall50': 0.55300915},
     '5': {'avg_iou': 0.7770793,
           'avg_obj': 0.6331835,
           'box_loss': 3.4297993,
           'class_loss': 2.948203,
           'conf_loss': 2.6492476,
           'precision50': 0.34906203,
           'recall50': 0.7024138},
     'AP': 0.36446118,
     'AP50': 0.5333494,
     'AP75': 0.40027007,
     'APl': 0.5012658,
     'APm': 0.37957954,
     'APs': 0.16015954,
     'ARl': 0.663579,
     'ARm': 0.56513935,
     'ARmax1': 0.2956408,
     'ARmax10': 0.4849383,
     'ARmax100': 0.52615094,
     'ARs': 0.30483177,
     'global': {'total_loss': 101.005585},
     'validation_loss': 101.005585}
I0506 00:26:43.950269 139820604045120 controller.py:211] train | step:  200000 | training until step 220000...
I0506 01:20:18.752889 139820604045120 controller.py:425] train | step:  210000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6672149,
           'avg_obj': 0.323673,
           'box_loss': 16.437063,
           'class_loss': 10.721525,
           'conf_loss': 59.50005,
           'precision50': 0.26492748,
           'recall50': 0.29231593},
     '4': {'avg_iou': 0.7772628,
           'avg_obj': 0.53587145,
           'box_loss': 10.78717,
           'class_loss': 8.071707,
           'conf_loss': 16.68841,
           'precision50': 0.3237346,
           'recall50': 0.57008225},
     '5': {'avg_iou': 0.81030226,
           'avg_obj': 0.63146144,
           'box_loss': 4.5937233,
           'class_loss': 3.9391177,
           'conf_loss': 2.9600837,
           'precision50': 0.4077841,
           'recall50': 0.7108539},
     'global': {'total_loss': 133.6988},
     'learning_rate': 0.001,
     'training_loss': 133.6988}
I0506 01:21:06.049985 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-210000.
I0506 02:21:33.423353 139820604045120 controller.py:425] train | step:  220000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6686689,
           'avg_obj': 0.32785404,
           'box_loss': 16.36415,
           'class_loss': 10.570884,
           'conf_loss': 59.120583,
           'precision50': 0.26674244,
           'recall50': 0.2970605},
     '4': {'avg_iou': 0.7784818,
           'avg_obj': 0.5403872,
           'box_loss': 10.722772,
           'class_loss': 7.9298677,
           'conf_loss': 16.548721,
           'precision50': 0.32407764,
           'recall50': 0.57564205},
     '5': {'avg_iou': 0.811734,
           'avg_obj': 0.6359192,
           'box_loss': 4.5534368,
           'class_loss': 3.857712,
           'conf_loss': 2.9294965,
           'precision50': 0.40779337,
           'recall50': 0.7157388},
     'global': {'total_loss': 132.59747},
     'learning_rate': 0.001,
     'training_loss': 132.59747}
I0506 02:22:25.121897 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-220000.
I0506 02:22:25.129070 139820604045120 controller.py:252]  eval | step:  220000 | running 625 steps of evaluation...
I0506 02:26:43.708513 139820604045120 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0506 02:31:50.448102 139820604045120 controller.py:261]  eval | step:  220000 | eval time:  565.3 sec | output: 
    {'3': {'avg_iou': 0.49341232,
           'avg_obj': 0.24543059,
           'box_loss': 8.911702,
           'class_loss': 6.0736585,
           'conf_loss': 50.71003,
           'precision50': 0.1879586,
           'recall50': 0.2561695},
     '4': {'avg_iou': 0.7114721,
           'avg_obj': 0.5035249,
           'box_loss': 6.9075975,
           'class_loss': 5.268578,
           'conf_loss': 14.449155,
           'precision50': 0.26263338,
           'recall50': 0.5544046},
     '5': {'avg_iou': 0.778089,
           'avg_obj': 0.6362046,
           'box_loss': 3.4206526,
           'class_loss': 2.9096088,
           'conf_loss': 2.6560688,
           'precision50': 0.35028577,
           'recall50': 0.7060986},
     'AP': 0.36510167,
     'AP50': 0.53362435,
     'AP75': 0.40202793,
     'APl': 0.50462234,
     'APm': 0.37806022,
     'APs': 0.16237287,
     'ARl': 0.6662419,
     'ARm': 0.56299746,
     'ARmax1': 0.29670122,
     'ARmax10': 0.48604414,
     'ARmax100': 0.52736104,
     'ARs': 0.30775914,
     'global': {'total_loss': 101.30711},
     'validation_loss': 101.30711}

train | step:  180000 | training until step 200000...
train | step:  190000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.66467,
           'avg_obj': 0.31484517,
           'box_loss': 16.56853,
           'class_loss': 11.037604,
           'conf_loss': 60.421894,
           'precision50': 0.2627676,
           'recall50': 0.28309512},
     '4': {'avg_iou': 0.7742801,
           'avg_obj': 0.5261734,
           'box_loss': 10.930203,
           'class_loss': 8.338531,
           'conf_loss': 16.969515,
           'precision50': 0.32345176,
           'recall50': 0.559413},
     '5': {'avg_iou': 0.8077891,
           'avg_obj': 0.6237622,
           'box_loss': 4.6529756,
           'class_loss': 4.0669236,
           'conf_loss': 3.0000348,
           'precision50': 0.40755504,
           'recall50': 0.7033642},
     'global': {'total_loss': 135.98601},
     'learning_rate': 0.001,
     'training_loss': 135.98601}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-190000.
train | step:  200000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6661964,
           'avg_obj': 0.3194407,
           'box_loss': 16.466183,
           'class_loss': 10.848688,
           'conf_loss': 59.872143,
           'precision50': 0.26441854,
           'recall50': 0.28792763},
     '4': {'avg_iou': 0.7759447,
           'avg_obj': 0.5315763,
           'box_loss': 10.841269,
           'class_loss': 8.181889,
           'conf_loss': 16.807415,
           'precision50': 0.32321575,
           'recall50': 0.56534165},
     '5': {'avg_iou': 0.8090961,
           'avg_obj': 0.6281831,
           'box_loss': 4.6238565,
           'class_loss': 3.9904668,
           'conf_loss': 2.9703007,
           'precision50': 0.4079405,
           'recall50': 0.7088064},
     'global': {'total_loss': 134.60219},
     'learning_rate': 0.001,
     'training_loss': 134.60219}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-200000.
 eval | step:  200000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=200.69s).
Accumulating evaluation results...
DONE (t=33.27s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.364
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.533
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.400
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.160
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.380
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.501
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.296
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.526
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.305
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.565
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.664
 eval | step:  200000 | eval time:  555.2 sec | output: 
    {'3': {'avg_iou': 0.49383605,
           'avg_obj': 0.24445249,
           'box_loss': 8.910268,
           'class_loss': 6.1019645,
           'conf_loss': 50.46361,
           'precision50': 0.19067022,
           'recall50': 0.25674242},
     '4': {'avg_iou': 0.71149963,
           'avg_obj': 0.50144774,
           'box_loss': 6.904757,
           'class_loss': 5.255128,
           'conf_loss': 14.342614,
           'precision50': 0.2633415,
           'recall50': 0.55300915},
     '5': {'avg_iou': 0.7770793,
           'avg_obj': 0.6331835,
           'box_loss': 3.4297993,
           'class_loss': 2.948203,
           'conf_loss': 2.6492476,
           'precision50': 0.34906203,
           'recall50': 0.7024138},
     'AP': 0.36446118,
     'AP50': 0.5333494,
     'AP75': 0.40027007,
     'APl': 0.5012658,
     'APm': 0.37957954,
     'APs': 0.16015954,
     'ARl': 0.663579,
     'ARm': 0.56513935,
     'ARmax1': 0.2956408,
     'ARmax10': 0.4849383,
     'ARmax100': 0.52615094,
     'ARs': 0.30483177,
     'global': {'total_loss': 101.005585},
     'validation_loss': 101.005585}
train | step:  200000 | training until step 220000...
train | step:  210000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6672149,
           'avg_obj': 0.323673,
           'box_loss': 16.437063,
           'class_loss': 10.721525,
           'conf_loss': 59.50005,
           'precision50': 0.26492748,
           'recall50': 0.29231593},
     '4': {'avg_iou': 0.7772628,
           'avg_obj': 0.53587145,
           'box_loss': 10.78717,
           'class_loss': 8.071707,
           'conf_loss': 16.68841,
           'precision50': 0.3237346,
           'recall50': 0.57008225},
     '5': {'avg_iou': 0.81030226,
           'avg_obj': 0.63146144,
           'box_loss': 4.5937233,
           'class_loss': 3.9391177,
           'conf_loss': 2.9600837,
           'precision50': 0.4077841,
           'recall50': 0.7108539},
     'global': {'total_loss': 133.6988},
     'learning_rate': 0.001,
     'training_loss': 133.6988}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-210000.
train | step:  220000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6686689,
           'avg_obj': 0.32785404,
           'box_loss': 16.36415,
           'class_loss': 10.570884,
           'conf_loss': 59.120583,
           'precision50': 0.26674244,
           'recall50': 0.2970605},
     '4': {'avg_iou': 0.7784818,
           'avg_obj': 0.5403872,
           'box_loss': 10.722772,
           'class_loss': 7.9298677,
           'conf_loss': 16.548721,
           'precision50': 0.32407764,
           'recall50': 0.57564205},
     '5': {'avg_iou': 0.811734,
           'avg_obj': 0.6359192,
           'box_loss': 4.5534368,
           'class_loss': 3.857712,
           'conf_loss': 2.9294965,
           'precision50': 0.40779337,
           'recall50': 0.7157388},
     'global': {'total_loss': 132.59747},
     'learning_rate': 0.001,
     'training_loss': 132.59747}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-220000.
 eval | step:  220000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=206.21s).
Accumulating evaluation results...
DONE (t=32.91s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.365
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.534
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.402
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.162
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.378
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.505
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.297
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.486
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.527
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.308
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.563
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.666
 eval | step:  220000 | eval time:  565.3 sec | output: 
    {'3': {'avg_iou': 0.49341232,
           'avg_obj': 0.24543059,
           'box_loss': 8.911702,
           'class_loss': 6.0736585,
           'conf_loss': 50.71003,
           'precision50': 0.1879586,
           'recall50': 0.2561695},
     '4': {'avg_iou': 0.7114721,
           'avg_obj': 0.5035249,
           'box_loss': 6.9075975,
           'class_loss': 5.268578,
           'conf_loss': 14.449155,
           'precision50': 0.26263338,
           'recall50': 0.5544046},
     '5': {'avg_iou': 0.778089,
           'avg_obj': 0.6362046,
           'box_loss': 3.4206526,
           'class_loss': 2.9096088,
           'conf_loss': 2.6560688,
           'precision50': 0.35028577,
           'recall50': 0.7060986},
     'AP': 0.36510167,
     'AP50': 0.53362435,
     'AP75': 0.40202793,
     'APl': 0.50462234,
     'APm': 0.37806022,
     'APs': 0.16237287,
     'ARl': 0.6662419,
     'ARm': 0.56299746,
     'ARmax1': 0.29670122,
     'ARmax10': 0.48604414,
     'ARmax100': 0.52736104,
     'ARs': 0.30775914,
     'global': {'total_loss': 101.30711},
     'validation_loss': 101.30711}I0506 02:32:10.798336 139820604045120 controller.py:211] train | step:  220000 | training until step 240000...
I0506 03:23:07.647080 139820604045120 controller.py:425] train | step:  230000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.66955703,
           'avg_obj': 0.33159468,
           'box_loss': 16.331621,
           'class_loss': 10.468928,
           'conf_loss': 58.95315,
           'precision50': 0.26679796,
           'recall50': 0.30053866},
     '4': {'avg_iou': 0.77964324,
           'avg_obj': 0.54436976,
           'box_loss': 10.675573,
           'class_loss': 7.8441806,
           'conf_loss': 16.436415,
           'precision50': 0.32456595,
           'recall50': 0.5791181},
     '5': {'avg_iou': 0.81268954,
           'avg_obj': 0.6390206,
           'box_loss': 4.5344634,
           'class_loss': 3.8207703,
           'conf_loss': 2.916286,
           'precision50': 0.40662652,
           'recall50': 0.71880394},
     'global': {'total_loss': 131.98119},
     'learning_rate': 0.001,
     'training_loss': 131.98119}
I0506 03:24:00.703249 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-230000.
I0506 04:24:46.557507 139820604045120 controller.py:425] train | step:  240000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.67039114,
           'avg_obj': 0.33460653,
           'box_loss': 16.29119,
           'class_loss': 10.339028,
           'conf_loss': 58.514957,
           'precision50': 0.26805177,
           'recall50': 0.3038661},
     '4': {'avg_iou': 0.780989,
           'avg_obj': 0.5483313,
           'box_loss': 10.604224,
           'class_loss': 7.7391086,
           'conf_loss': 16.343729,
           'precision50': 0.32417575,
           'recall50': 0.5834386},
     '5': {'avg_iou': 0.8140049,
           'avg_obj': 0.6427071,
           'box_loss': 4.4988294,
           'class_loss': 3.7555668,
           'conf_loss': 2.8919046,
           'precision50': 0.4071532,
           'recall50': 0.7229625},
     'global': {'total_loss': 130.97845},
     'learning_rate': 0.001,
     'training_loss': 130.97845}
I0506 04:25:35.472940 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-240000.
I0506 04:25:35.478940 139820604045120 controller.py:252]  eval | step:  240000 | running 625 steps of evaluation...
I0506 04:29:53.290100 139820604045120 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0506 04:34:58.741863 139820604045120 controller.py:261]  eval | step:  240000 | eval time:  563.3 sec | output: 
    {'3': {'avg_iou': 0.49433488,
           'avg_obj': 0.24670345,
           'box_loss': 8.886784,
           'class_loss': 6.101109,
           'conf_loss': 51.151333,
           'precision50': 0.18946981,
           'recall50': 0.26022634},
     '4': {'avg_iou': 0.7121767,
           'avg_obj': 0.5059388,
           'box_loss': 6.8958797,
           'class_loss': 5.301124,
           'conf_loss': 14.604197,
           'precision50': 0.26153296,
           'recall50': 0.5598368},
     '5': {'avg_iou': 0.7788433,
           'avg_obj': 0.6389263,
           'box_loss': 3.4060621,
           'class_loss': 2.9288821,
           'conf_loss': 2.6857266,
           'precision50': 0.3482944,
           'recall50': 0.70934886},
     'AP': 0.36505765,
     'AP50': 0.53248596,
     'AP75': 0.40031046,
     'APl': 0.50676966,
     'APm': 0.3772848,
     'APs': 0.15714829,
     'ARl': 0.6676375,
     'ARm': 0.5640654,
     'ARmax1': 0.29661775,
     'ARmax10': 0.48780397,
     'ARmax100': 0.5301724,
     'ARs': 0.3106233,
     'global': {'total_loss': 101.96112},
     'validation_loss': 101.96112}
I0506 04:35:16.117099 139820604045120 controller.py:211] train | step:  240000 | training until step 260000...
I0506 05:26:40.261276 139820604045120 controller.py:425] train | step:  250000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6784653,
           'avg_obj': 0.35836408,
           'box_loss': 15.855639,
           'class_loss': 9.509591,
           'conf_loss': 56.477943,
           'precision50': 0.26928547,
           'recall50': 0.32685632},
     '4': {'avg_iou': 0.79004365,
           'avg_obj': 0.57491916,
           'box_loss': 10.141845,
           'class_loss': 6.9778733,
           'conf_loss': 15.539936,
           'precision50': 0.32180104,
           'recall50': 0.6105411},
     '5': {'avg_iou': 0.82419103,
           'avg_obj': 0.6676211,
           'box_loss': 4.2410254,
           'class_loss': 3.3300765,
           'conf_loss': 2.7440932,
           'precision50': 0.40443683,
           'recall50': 0.74532473},
     'global': {'total_loss': 124.81786},
     'learning_rate': 1e-04,
     'training_loss': 124.81786}
I0506 05:27:26.423174 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-250000.
I0506 06:27:45.593785 139820604045120 controller.py:425] train | step:  260000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.68030554,
           'avg_obj': 0.36554816,
           'box_loss': 15.803211,
           'class_loss': 9.288599,
           'conf_loss': 56.090588,
           'precision50': 0.2690563,
           'recall50': 0.33486047},
     '4': {'avg_iou': 0.7923202,
           'avg_obj': 0.5832435,
           'box_loss': 10.053728,
           'class_loss': 6.7813945,
           'conf_loss': 15.293064,
           'precision50': 0.32253376,
           'recall50': 0.6188737},
     '5': {'avg_iou': 0.8262545,
           'avg_obj': 0.6752501,
           'box_loss': 4.1921806,
           'class_loss': 3.215468,
           'conf_loss': 2.6920712,
           'precision50': 0.4036131,
           'recall50': 0.7523653},
     'global': {'total_loss': 123.41021},
     'learning_rate': 1e-04,
     'training_loss': 123.41021}
I0506 06:28:32.798065 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-260000.
I0506 06:28:32.804349 139820604045120 controller.py:252]  eval | step:  260000 | running 625 steps of evaluation...
I0506 06:32:54.960263 139820604045120 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0506 06:37:58.689983 139820604045120 controller.py:261]  eval | step:  260000 | eval time:  565.9 sec | output: 
    {'3': {'avg_iou': 0.49304262,
           'avg_obj': 0.24440649,
           'box_loss': 8.939632,
           'class_loss': 6.2645783,
           'conf_loss': 51.79203,
           'precision50': 0.18609886,
           'recall50': 0.25718394},
     '4': {'avg_iou': 0.7101944,
           'avg_obj': 0.50348425,
           'box_loss': 6.9714627,
           'class_loss': 5.450097,
           'conf_loss': 14.746632,
           'precision50': 0.2591613,
           'recall50': 0.55311286},
     '5': {'avg_iou': 0.7769538,
           'avg_obj': 0.6392371,
           'box_loss': 3.4475808,
           'class_loss': 2.9976628,
           'conf_loss': 2.7004008,
           'precision50': 0.34806752,
           'recall50': 0.70423216},
     'AP': 0.3593264,
     'AP50': 0.52645624,
     'AP75': 0.393218,
     'APl': 0.49782494,
     'APm': 0.37096786,
     'APs': 0.15480742,
     'ARl': 0.6643273,
     'ARm': 0.5589161,
     'ARmax1': 0.29415107,
     'ARmax10': 0.48209444,
     'ARmax100': 0.5254281,
     'ARs': 0.30367342,
     'global': {'total_loss': 103.31005},
     'validation_loss': 103.31005}

train | step:  220000 | training until step 240000...
train | step:  230000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.66955703,
           'avg_obj': 0.33159468,
           'box_loss': 16.331621,
           'class_loss': 10.468928,
           'conf_loss': 58.95315,
           'precision50': 0.26679796,
           'recall50': 0.30053866},
     '4': {'avg_iou': 0.77964324,
           'avg_obj': 0.54436976,
           'box_loss': 10.675573,
           'class_loss': 7.8441806,
           'conf_loss': 16.436415,
           'precision50': 0.32456595,
           'recall50': 0.5791181},
     '5': {'avg_iou': 0.81268954,
           'avg_obj': 0.6390206,
           'box_loss': 4.5344634,
           'class_loss': 3.8207703,
           'conf_loss': 2.916286,
           'precision50': 0.40662652,
           'recall50': 0.71880394},
     'global': {'total_loss': 131.98119},
     'learning_rate': 0.001,
     'training_loss': 131.98119}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-230000.
train | step:  240000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.67039114,
           'avg_obj': 0.33460653,
           'box_loss': 16.29119,
           'class_loss': 10.339028,
           'conf_loss': 58.514957,
           'precision50': 0.26805177,
           'recall50': 0.3038661},
     '4': {'avg_iou': 0.780989,
           'avg_obj': 0.5483313,
           'box_loss': 10.604224,
           'class_loss': 7.7391086,
           'conf_loss': 16.343729,
           'precision50': 0.32417575,
           'recall50': 0.5834386},
     '5': {'avg_iou': 0.8140049,
           'avg_obj': 0.6427071,
           'box_loss': 4.4988294,
           'class_loss': 3.7555668,
           'conf_loss': 2.8919046,
           'precision50': 0.4071532,
           'recall50': 0.7229625},
     'global': {'total_loss': 130.97845},
     'learning_rate': 0.001,
     'training_loss': 130.97845}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-240000.
 eval | step:  240000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=203.25s).
Accumulating evaluation results...
DONE (t=32.94s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.365
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.532
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.400
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.157
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.377
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.507
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.297
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.488
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.530
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.311
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.564
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.668
 eval | step:  240000 | eval time:  563.3 sec | output: 
    {'3': {'avg_iou': 0.49433488,
           'avg_obj': 0.24670345,
           'box_loss': 8.886784,
           'class_loss': 6.101109,
           'conf_loss': 51.151333,
           'precision50': 0.18946981,
           'recall50': 0.26022634},
     '4': {'avg_iou': 0.7121767,
           'avg_obj': 0.5059388,
           'box_loss': 6.8958797,
           'class_loss': 5.301124,
           'conf_loss': 14.604197,
           'precision50': 0.26153296,
           'recall50': 0.5598368},
     '5': {'avg_iou': 0.7788433,
           'avg_obj': 0.6389263,
           'box_loss': 3.4060621,
           'class_loss': 2.9288821,
           'conf_loss': 2.6857266,
           'precision50': 0.3482944,
           'recall50': 0.70934886},
     'AP': 0.36505765,
     'AP50': 0.53248596,
     'AP75': 0.40031046,
     'APl': 0.50676966,
     'APm': 0.3772848,
     'APs': 0.15714829,
     'ARl': 0.6676375,
     'ARm': 0.5640654,
     'ARmax1': 0.29661775,
     'ARmax10': 0.48780397,
     'ARmax100': 0.5301724,
     'ARs': 0.3106233,
     'global': {'total_loss': 101.96112},
     'validation_loss': 101.96112}
train | step:  240000 | training until step 260000...
train | step:  250000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6784653,
           'avg_obj': 0.35836408,
           'box_loss': 15.855639,
           'class_loss': 9.509591,
           'conf_loss': 56.477943,
           'precision50': 0.26928547,
           'recall50': 0.32685632},
     '4': {'avg_iou': 0.79004365,
           'avg_obj': 0.57491916,
           'box_loss': 10.141845,
           'class_loss': 6.9778733,
           'conf_loss': 15.539936,
           'precision50': 0.32180104,
           'recall50': 0.6105411},
     '5': {'avg_iou': 0.82419103,
           'avg_obj': 0.6676211,
           'box_loss': 4.2410254,
           'class_loss': 3.3300765,
           'conf_loss': 2.7440932,
           'precision50': 0.40443683,
           'recall50': 0.74532473},
     'global': {'total_loss': 124.81786},
     'learning_rate': 1e-04,
     'training_loss': 124.81786}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-250000.
train | step:  260000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.68030554,
           'avg_obj': 0.36554816,
           'box_loss': 15.803211,
           'class_loss': 9.288599,
           'conf_loss': 56.090588,
           'precision50': 0.2690563,
           'recall50': 0.33486047},
     '4': {'avg_iou': 0.7923202,
           'avg_obj': 0.5832435,
           'box_loss': 10.053728,
           'class_loss': 6.7813945,
           'conf_loss': 15.293064,
           'precision50': 0.32253376,
           'recall50': 0.6188737},
     '5': {'avg_iou': 0.8262545,
           'avg_obj': 0.6752501,
           'box_loss': 4.1921806,
           'class_loss': 3.215468,
           'conf_loss': 2.6920712,
           'precision50': 0.4036131,
           'recall50': 0.7523653},
     'global': {'total_loss': 123.41021},
     'learning_rate': 1e-04,
     'training_loss': 123.41021}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-260000.
 eval | step:  260000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=203.06s).
Accumulating evaluation results...
DONE (t=32.25s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.359
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.526
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.393
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.155
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.371
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.498
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.294
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.482
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.525
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.304
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.559
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.664
 eval | step:  260000 | eval time:  565.9 sec | output: 
    {'3': {'avg_iou': 0.49304262,
           'avg_obj': 0.24440649,
           'box_loss': 8.939632,
           'class_loss': 6.2645783,
           'conf_loss': 51.79203,
           'precision50': 0.18609886,
           'recall50': 0.25718394},
     '4': {'avg_iou': 0.7101944,
           'avg_obj': 0.50348425,
           'box_loss': 6.9714627,
           'class_loss': 5.450097,
           'conf_loss': 14.746632,
           'precision50': 0.2591613,
           'recall50': 0.55311286},
     '5': {'avg_iou': 0.7769538,
           'avg_obj': 0.6392371,
           'box_loss': 3.4475808,
           'class_loss': 2.9976628,
           'conf_loss': 2.7004008,
           'precision50': 0.34806752,
           'recall50': 0.70423216},
     'AP': 0.3593264,
     'AP50': 0.52645624,
     'AP75': 0.393218,
     'APl': 0.49782494,
     'APm': 0.37096786,
     'APs': 0.15480742,
     'ARl': 0.6643273,
     'ARm': 0.5589161,
     'ARmax1': 0.29415107,
     'ARmax10': 0.48209444,
     'ARmax100': 0.5254281,
     'ARs': 0.30367342,
     'global': {'total_loss': 103.31005},
     'validation_loss': 103.31005}I0506 06:38:20.854739 139820604045120 controller.py:211] train | step:  260000 | training until step 280000...
I0506 07:29:15.298504 139820604045120 controller.py:425] train | step:  270000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.68129164,
           'avg_obj': 0.36878583,
           'box_loss': 15.732997,
           'class_loss': 9.162497,
           'conf_loss': 55.585056,
           'precision50': 0.26920143,
           'recall50': 0.3371847},
     '4': {'avg_iou': 0.7933124,
           'avg_obj': 0.5863594,
           'box_loss': 9.978164,
           'class_loss': 6.6676507,
           'conf_loss': 15.185743,
           'precision50': 0.3216355,
           'recall50': 0.6218628},
     '5': {'avg_iou': 0.82750183,
           'avg_obj': 0.67811996,
           'box_loss': 4.1550064,
           'class_loss': 3.1579397,
           'conf_loss': 2.6707876,
           'precision50': 0.40305063,
           'recall50': 0.75528014},
     'global': {'total_loss': 122.29562},
     'learning_rate': 1e-05,
     'training_loss': 122.29562}
I0506 07:30:07.017590 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-270000.
I0506 08:31:09.351737 139820604045120 controller.py:425] train | step:  280000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.681444,
           'avg_obj': 0.36939687,
           'box_loss': 15.759159,
           'class_loss': 9.157872,
           'conf_loss': 55.78835,
           'precision50': 0.26931086,
           'recall50': 0.3386317},
     '4': {'avg_iou': 0.7934941,
           'avg_obj': 0.58752304,
           'box_loss': 9.993148,
           'class_loss': 6.64709,
           'conf_loss': 15.176657,
           'precision50': 0.3219127,
           'recall50': 0.62341654},
     '5': {'avg_iou': 0.8278662,
           'avg_obj': 0.67930114,
           'box_loss': 4.154171,
           'class_loss': 3.1447036,
           'conf_loss': 2.6686037,
           'precision50': 0.4025361,
           'recall50': 0.75583994},
     'global': {'total_loss': 122.489685},
     'learning_rate': 1e-05,
     'training_loss': 122.489685}
I0506 08:31:58.473367 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-280000.
I0506 08:31:58.479867 139820604045120 controller.py:252]  eval | step:  280000 | running 625 steps of evaluation...
I0506 08:36:18.202722 139820604045120 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0506 08:41:21.104481 139820604045120 controller.py:261]  eval | step:  280000 | eval time:  562.6 sec | output: 
    {'3': {'avg_iou': 0.4928419,
           'avg_obj': 0.24495545,
           'box_loss': 8.945393,
           'class_loss': 6.292268,
           'conf_loss': 51.960205,
           'precision50': 0.18546638,
           'recall50': 0.25838074},
     '4': {'avg_iou': 0.7100175,
           'avg_obj': 0.5041459,
           'box_loss': 6.9808154,
           'class_loss': 5.466774,
           'conf_loss': 14.792474,
           'precision50': 0.25847933,
           'recall50': 0.5537259},
     '5': {'avg_iou': 0.7768941,
           'avg_obj': 0.6404238,
           'box_loss': 3.4500477,
           'class_loss': 3.0025647,
           'conf_loss': 2.7118876,
           'precision50': 0.3470296,
           'recall50': 0.7050208},
     'AP': 0.35930276,
     'AP50': 0.5260562,
     'AP75': 0.3930947,
     'APl': 0.49697897,
     'APm': 0.37107286,
     'APs': 0.15374503,
     'ARl': 0.66260237,
     'ARm': 0.5587201,
     'ARmax1': 0.29393044,
     'ARmax10': 0.48214307,
     'ARmax100': 0.5253884,
     'ARs': 0.30360472,
     'global': {'total_loss': 103.60242},
     'validation_loss': 103.60242}
I0506 08:41:43.040138 139820604045120 controller.py:211] train | step:  280000 | training until step 300000...
I0506 09:32:54.935018 139820604045120 controller.py:425] train | step:  290000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6816132,
           'avg_obj': 0.3701851,
           'box_loss': 15.711327,
           'class_loss': 9.114804,
           'conf_loss': 55.6295,
           'precision50': 0.26812643,
           'recall50': 0.33842096},
     '4': {'avg_iou': 0.7938569,
           'avg_obj': 0.58833396,
           'box_loss': 9.961528,
           'class_loss': 6.6318445,
           'conf_loss': 15.135794,
           'precision50': 0.32165128,
           'recall50': 0.6241034},
     '5': {'avg_iou': 0.82796335,
           'avg_obj': 0.6798991,
           'box_loss': 4.148159,
           'class_loss': 3.1372433,
           'conf_loss': 2.6628165,
           'precision50': 0.4027991,
           'recall50': 0.7566151},
     'global': {'total_loss': 122.13334},
     'learning_rate': 1e-05,
     'training_loss': 122.13334}
I0506 09:33:42.757004 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-290000.
I0506 10:34:32.645905 139820604045120 controller.py:425] train | step:  300000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6820307,
           'avg_obj': 0.3708743,
           'box_loss': 15.709506,
           'class_loss': 9.096825,
           'conf_loss': 55.738564,
           'precision50': 0.26792848,
           'recall50': 0.338539},
     '4': {'avg_iou': 0.79382575,
           'avg_obj': 0.5885202,
           'box_loss': 9.976967,
           'class_loss': 6.626664,
           'conf_loss': 15.128573,
           'precision50': 0.32142234,
           'recall50': 0.62393147},
     '5': {'avg_iou': 0.82800907,
           'avg_obj': 0.6803188,
           'box_loss': 4.152602,
           'class_loss': 3.1376138,
           'conf_loss': 2.658903,
           'precision50': 0.40289357,
           'recall50': 0.7568358},
     'global': {'total_loss': 122.22594},
     'learning_rate': 1e-05,
     'training_loss': 122.22594}
I0506 10:35:20.001662 139820604045120 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-300000.
I0506 10:35:20.007988 139820604045120 controller.py:252]  eval | step:  300000 | running 625 steps of evaluation...
I0506 10:39:39.945783 139820604045120 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0506 10:44:49.564686 139820604045120 controller.py:261]  eval | step:  300000 | eval time:  569.6 sec | output: 
    {'3': {'avg_iou': 0.4928849,
           'avg_obj': 0.24504954,
           'box_loss': 8.943591,
           'class_loss': 6.2905674,
           'conf_loss': 52.09933,
           'precision50': 0.18508595,
           'recall50': 0.25913644},
     '4': {'avg_iou': 0.71004987,
           'avg_obj': 0.5045643,
           'box_loss': 6.9805546,
           'class_loss': 5.468864,
           'conf_loss': 14.803014,
           'precision50': 0.25823778,
           'recall50': 0.5541497},
     '5': {'avg_iou': 0.7769856,
           'avg_obj': 0.6410788,
           'box_loss': 3.4493685,
           'class_loss': 2.9989269,
           'conf_loss': 2.7121658,
           'precision50': 0.3475479,
           'recall50': 0.70618105},
     'AP': 0.35967192,
     'AP50': 0.52640945,
     'AP75': 0.3939847,
     'APl': 0.49769074,
     'APm': 0.3716996,
     'APs': 0.15395954,
     'ARl': 0.6626661,
     'ARm': 0.5599859,
     'ARmax1': 0.29399204,
     'ARmax10': 0.4823314,
     'ARmax100': 0.52546906,
     'ARs': 0.3031497,
     'global': {'total_loss': 103.746346},
     'validation_loss': 103.746346}

train | step:  260000 | training until step 280000...
train | step:  270000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.68129164,
           'avg_obj': 0.36878583,
           'box_loss': 15.732997,
           'class_loss': 9.162497,
           'conf_loss': 55.585056,
           'precision50': 0.26920143,
           'recall50': 0.3371847},
     '4': {'avg_iou': 0.7933124,
           'avg_obj': 0.5863594,
           'box_loss': 9.978164,
           'class_loss': 6.6676507,
           'conf_loss': 15.185743,
           'precision50': 0.3216355,
           'recall50': 0.6218628},
     '5': {'avg_iou': 0.82750183,
           'avg_obj': 0.67811996,
           'box_loss': 4.1550064,
           'class_loss': 3.1579397,
           'conf_loss': 2.6707876,
           'precision50': 0.40305063,
           'recall50': 0.75528014},
     'global': {'total_loss': 122.29562},
     'learning_rate': 1e-05,
     'training_loss': 122.29562}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-270000.
train | step:  280000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.681444,
           'avg_obj': 0.36939687,
           'box_loss': 15.759159,
           'class_loss': 9.157872,
           'conf_loss': 55.78835,
           'precision50': 0.26931086,
           'recall50': 0.3386317},
     '4': {'avg_iou': 0.7934941,
           'avg_obj': 0.58752304,
           'box_loss': 9.993148,
           'class_loss': 6.64709,
           'conf_loss': 15.176657,
           'precision50': 0.3219127,
           'recall50': 0.62341654},
     '5': {'avg_iou': 0.8278662,
           'avg_obj': 0.67930114,
           'box_loss': 4.154171,
           'class_loss': 3.1447036,
           'conf_loss': 2.6686037,
           'precision50': 0.4025361,
           'recall50': 0.75583994},
     'global': {'total_loss': 122.489685},
     'learning_rate': 1e-05,
     'training_loss': 122.489685}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-280000.
 eval | step:  280000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=201.20s).
Accumulating evaluation results...
DONE (t=32.34s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.359
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.526
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.393
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.154
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.371
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.497
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.294
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.482
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.525
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.304
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.559
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.663
 eval | step:  280000 | eval time:  562.6 sec | output: 
    {'3': {'avg_iou': 0.4928419,
           'avg_obj': 0.24495545,
           'box_loss': 8.945393,
           'class_loss': 6.292268,
           'conf_loss': 51.960205,
           'precision50': 0.18546638,
           'recall50': 0.25838074},
     '4': {'avg_iou': 0.7100175,
           'avg_obj': 0.5041459,
           'box_loss': 6.9808154,
           'class_loss': 5.466774,
           'conf_loss': 14.792474,
           'precision50': 0.25847933,
           'recall50': 0.5537259},
     '5': {'avg_iou': 0.7768941,
           'avg_obj': 0.6404238,
           'box_loss': 3.4500477,
           'class_loss': 3.0025647,
           'conf_loss': 2.7118876,
           'precision50': 0.3470296,
           'recall50': 0.7050208},
     'AP': 0.35930276,
     'AP50': 0.5260562,
     'AP75': 0.3930947,
     'APl': 0.49697897,
     'APm': 0.37107286,
     'APs': 0.15374503,
     'ARl': 0.66260237,
     'ARm': 0.5587201,
     'ARmax1': 0.29393044,
     'ARmax10': 0.48214307,
     'ARmax100': 0.5253884,
     'ARs': 0.30360472,
     'global': {'total_loss': 103.60242},
     'validation_loss': 103.60242}
train | step:  280000 | training until step 300000...
train | step:  290000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6816132,
           'avg_obj': 0.3701851,
           'box_loss': 15.711327,
           'class_loss': 9.114804,
           'conf_loss': 55.6295,
           'precision50': 0.26812643,
           'recall50': 0.33842096},
     '4': {'avg_iou': 0.7938569,
           'avg_obj': 0.58833396,
           'box_loss': 9.961528,
           'class_loss': 6.6318445,
           'conf_loss': 15.135794,
           'precision50': 0.32165128,
           'recall50': 0.6241034},
     '5': {'avg_iou': 0.82796335,
           'avg_obj': 0.6798991,
           'box_loss': 4.148159,
           'class_loss': 3.1372433,
           'conf_loss': 2.6628165,
           'precision50': 0.4027991,
           'recall50': 0.7566151},
     'global': {'total_loss': 122.13334},
     'learning_rate': 1e-05,
     'training_loss': 122.13334}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-290000.
train | step:  300000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6820307,
           'avg_obj': 0.3708743,
           'box_loss': 15.709506,
           'class_loss': 9.096825,
           'conf_loss': 55.738564,
           'precision50': 0.26792848,
           'recall50': 0.338539},
     '4': {'avg_iou': 0.79382575,
           'avg_obj': 0.5885202,
           'box_loss': 9.976967,
           'class_loss': 6.626664,
           'conf_loss': 15.128573,
           'precision50': 0.32142234,
           'recall50': 0.62393147},
     '5': {'avg_iou': 0.82800907,
           'avg_obj': 0.6803188,
           'box_loss': 4.152602,
           'class_loss': 3.1376138,
           'conf_loss': 2.658903,
           'precision50': 0.40289357,
           'recall50': 0.7568358},
     'global': {'total_loss': 122.22594},
     'learning_rate': 1e-05,
     'training_loss': 122.22594}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-mbox/ckpt-300000.
 eval | step:  300000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=204.88s).
Accumulating evaluation results...
DONE (t=31.85s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.360
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.526
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.394
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.154
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.372
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.498
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.294
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.482
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.525
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.303
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.560
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.663
 eval | step:  300000 | eval time:  569.6 sec | output: 
    {'3': {'avg_iou': 0.4928849,
           'avg_obj': 0.24504954,
           'box_loss': 8.943591,
           'class_loss': 6.2905674,
           'conf_loss': 52.09933,
           'precision50': 0.18508595,
           'recall50': 0.25913644},
     '4': {'avg_iou': 0.71004987,
           'avg_obj': 0.5045643,
           'box_loss': 6.9805546,
           'class_loss': 5.468864,
           'conf_loss': 14.803014,
           'precision50': 0.25823778,
           'recall50': 0.5541497},
     '5': {'avg_iou': 0.7769856,
           'avg_obj': 0.6410788,
           'box_loss': 3.4493685,
           'class_loss': 2.9989269,
           'conf_loss': 2.7121658,
           'precision50': 0.3475479,
           'recall50': 0.70618105},
     'AP': 0.35967192,
     'AP50': 0.52640945,
     'AP75': 0.3939847,
     'APl': 0.49769074,
     'APm': 0.3716996,
     'APs': 0.15395954,
     'ARl': 0.6626661,
     'ARm': 0.5599859,
     'ARmax1': 0.29399204,
     'ARmax10': 0.4823314,
     'ARmax100': 0.52546906,
     'ARs': 0.3031497,
     'global': {'total_loss': 103.746346},
     'validation_loss': 103.746346}I0506 10:45:08.428104 139820604045120 train_lib.py:123] Number of trainable params in model: 53.066944 Millions.

  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   204    0     2  100   202      9    961 --:--:-- --:--:-- --:--:--   971
okRequest issued for: [node-2]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-06T10:49:40.808929337Z'
  endTime: '2021-05-06T10:50:37.472688730Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620298180796-5c1a7117f21bc-e1aba61b-45bf42a7
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.73.142.64/29
  createTime: '2021-03-13T00:10:24.868252445Z'
  health: HEALTHY
  ipAddress: 10.73.142.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.73.142.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-25T19:28:21.704126002Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T19:28:19Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-03-28T21:10:24.483577115Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:10:19Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T02:18:59.164603377Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T02:18:30.044758+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-30T05:32:54.575339610Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-30T05:32:31.628489+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620298180796-5c1a7117f21bc-e1aba61b-45bf42a7] to complete...
...............................................................................................................................................................................................................................................................................................................................................................................................done.
