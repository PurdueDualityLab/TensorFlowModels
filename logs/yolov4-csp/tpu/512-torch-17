cat: .experiment_zone: No such file or directory
Request issued for: [node-5]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-20T02:52:39.948301675Z'
  endTime: '2021-05-20T02:53:15.314183338Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621479159936-5c2ba0956b434-80d3d38d-79a6ac67
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621479159936-5c2ba0956b434-80d3d38d-79a6ac67] to complete...
...............................................................................................................................................................................................done.
europe-west4-a
I0520 02:47:20.689033 140216733652800 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[12.0, 16.0]',
                              '[19.0, 36.0]',
                              '[40.0, 28.0]',
                              '[36.0, 75.0]',
                              '[76.0, 55.0]',
                              '[72.0, 146.0]',
                              '[142.0, 110.0]',
                              '[192.0, 243.0]',
                              '[459.0, 401.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_scaled_loss': True},
                    'input_size': [512, 512, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.0,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.5,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'random_pad': False,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.5,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.5,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'random_pad': False,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 02:47:20.690033 140216733652800 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/params.yaml
I0520 02:47:22.275889 140216733652800 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 02:47:22.896522 140216733652800 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0520 02:47:22.896796 140216733652800 transport.py:157] Attempting refresh to obtain initial access_token
I0520 02:47:22.956584 140216733652800 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 02:47:23.097025 140216733652800 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0520 02:47:23.097537 140216733652800 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-20 02:47:23.153612: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0520 02:47:23.154512 140216733652800 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 02:47:23.774709 140216733652800 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0520 02:47:23.775227 140216733652800 transport.py:157] Attempting refresh to obtain initial access_token
I0520 02:47:23.818997 140216733652800 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 02:47:23.962697 140216733652800 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0520 02:47:23.963196 140216733652800 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-20 02:47:24.008779: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-20 02:47:24.038356: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.56.217.90:8470}
2021-05-20 02:47:24.038452: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:62180}
/home/cam2tensorflow/.experiment_start.sh: line 22: 32180 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4-$5
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208      9    981 --:--:-- --:--:-- --:--:--   990
okRequest issued for: [node-5]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-20T04:21:51.500546837Z'
  endTime: '2021-05-20T04:22:25.201746480Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621484511487-5c2bb4850e464-9ad3409c-953ba9e1
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621484511487-5c2bb4850e464-9ad3409c-953ba9e1] to complete...
...................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-3]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621484626715-5c2bb4f2f23d4-eb747bda-ef9ace77] to complete...
.........................................................................................failed.
ERROR: (gcloud.compute.tpus.start) {
  "code": 8,
  "message": "There is no more capacity in the zone \"europe-west4-a\"; you can try in another zone where Cloud TPU Nodes are offered (see https://cloud.google.com/tpu/docs/regions) [EID: 0xe71e03d34cf88145]"
}
europe-west4-a
I0520 04:18:07.323122 140267565303616 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[12.0, 16.0]',
                              '[19.0, 36.0]',
                              '[40.0, 28.0]',
                              '[36.0, 75.0]',
                              '[76.0, 55.0]',
                              '[72.0, 146.0]',
                              '[142.0, 110.0]',
                              '[192.0, 243.0]',
                              '[459.0, 401.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_scaled_loss': True},
                    'input_size': [512, 512, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.0,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.5,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'random_pad': False,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.5,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.5,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'random_pad': False,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 04:18:07.324685 140267565303616 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/params.yaml
I0520 04:18:08.106742 140267565303616 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 04:18:08.249101 140267565303616 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0520 04:18:08.249378 140267565303616 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-3" is not yet ready; state: "STOPPED"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, 'input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_scaled_loss': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.0, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.5, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'random_pad': False, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.5, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'random_pad': False, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     12   1333 --:--:-- --:--:-- --:--:--  1346
okRequest issued for: [node-3]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-20T04:24:11.108713654Z'
  endTime: '2021-05-20T04:24:22.363243145Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621484651086-5c2bb50a303f5-d5d964ce-19cb546b
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621484651086-5c2bb50a303f5-d5d964ce-19cb546b] to complete...
..............................................................done.
cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is STOPPING
europe-west4-a
I0520 04:20:37.165100 140409103120192 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[12.0, 16.0]',
                              '[19.0, 36.0]',
                              '[40.0, 28.0]',
                              '[36.0, 75.0]',
                              '[76.0, 55.0]',
                              '[72.0, 146.0]',
                              '[142.0, 110.0]',
                              '[192.0, 243.0]',
                              '[459.0, 401.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_scaled_loss': True},
                    'input_size': [512, 512, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.0,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.5,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'random_pad': False,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.5,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.5,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'random_pad': False,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 04:20:37.166217 140409103120192 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/params.yaml
I0520 04:20:37.965796 140409103120192 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 04:20:38.289750 140409103120192 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2?alt=json
I0520 04:20:38.290038 140409103120192 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-2" is not yet ready; state: "STOPPING"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, 'input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_scaled_loss': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.0, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.5, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'random_pad': False, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.5, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'random_pad': False, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     12   1268 --:--:-- --:--:-- --:--:--  1280
okRequest issued for: [node-2]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-20T04:26:41.171913338Z'
  endTime: '2021-05-20T04:27:29.986018372Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621484801158-5c2bb5994ec20-fd22bcad-f1be4426
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.73.142.64/29
  createTime: '2021-03-13T00:10:24.868252445Z'
  health: HEALTHY
  ipAddress: 10.73.142.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.73.142.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-25T19:28:21.704126002Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T19:28:19Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-03-28T21:10:24.483577115Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:10:19Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T02:18:59.164603377Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T02:18:30.044758+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-30T05:32:54.575339610Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-30T05:32:31.628489+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621484801158-5c2bb5994ec20-fd22bcad-f1be4426] to complete...
..............................................................................................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-2]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621484862571-5c2bb5d3e05a4-9f8b79fb-0fad83d2] to complete...
.............................................................................................failed.
ERROR: (gcloud.compute.tpus.start) {
  "code": 8,
  "message": "There is no more capacity in the zone \"europe-west4-a\"; you can try in another zone where Cloud TPU Nodes are offered (see https://cloud.google.com/tpu/docs/regions) [EID: 0xa55a3778c6b4911e]"
}
europe-west4-a
I0520 04:22:02.755383 140000678766400 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[12.0, 16.0]',
                              '[19.0, 36.0]',
                              '[40.0, 28.0]',
                              '[36.0, 75.0]',
                              '[76.0, 55.0]',
                              '[72.0, 146.0]',
                              '[142.0, 110.0]',
                              '[192.0, 243.0]',
                              '[459.0, 401.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_scaled_loss': True},
                    'input_size': [512, 512, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.0,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.5,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'random_pad': False,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.5,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.5,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'random_pad': False,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 04:22:02.757295 140000678766400 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/params.yaml
I0520 04:22:03.596797 140000678766400 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 04:22:03.741810 140000678766400 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2?alt=json
I0520 04:22:03.742214 140000678766400 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-2" is not yet ready; state: "STOPPED"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, 'input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_scaled_loss': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.0, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.5, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'random_pad': False, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.5, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'random_pad': False, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208      7    806 --:--:-- --:--:-- --:--:--   810100   210    0     2  100   208      7    803 --:--:-- --:--:-- --:--:--   807
okRequest issued for: [node-2]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621484886673-5c2bb5eadc70a-8bf53aac-4ed0ea14] to complete...
..............................................aborted by ctrl-c.
ERROR: (gcloud.compute.tpus.stop) Aborting wait for operation https://tpu.googleapis.com/v1alpha1/projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621484886673-5c2bb5eadc70a-8bf53aac-4ed0ea14.

cat: .experiment_zone: No such file or directory
Request issued for: [node-2]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621484900083-5c2bb5f7a672f-59c393a9-114a1d81] to complete...
...........................................................................................failed.
ERROR: (gcloud.compute.tpus.start) {
  "code": 8,
  "message": "There is no more capacity in the zone \"europe-west4-a\"; you can try in another zone where Cloud TPU Nodes are offered (see https://cloud.google.com/tpu/docs/regions) [EID: 0x11581c3cd834ca80]"
}
europe-west4-a
I0520 04:22:39.837379 140240260691776 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[12.0, 16.0]',
                              '[19.0, 36.0]',
                              '[40.0, 28.0]',
                              '[36.0, 75.0]',
                              '[76.0, 55.0]',
                              '[72.0, 146.0]',
                              '[142.0, 110.0]',
                              '[192.0, 243.0]',
                              '[459.0, 401.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_scaled_loss': True},
                    'input_size': [512, 512, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.0,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.5,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'random_pad': False,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.5,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.5,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'random_pad': False,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 04:22:39.838943 140240260691776 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/params.yaml
I0520 04:22:40.686324 140240260691776 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 04:22:41.302148 140240260691776 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-2?alt=json
I0520 04:22:41.302470 140240260691776 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-2" is not yet ready; state: "STOPPED"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, 'input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_scaled_loss': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.0, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.5, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'random_pad': False, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.5, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'random_pad': False, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     12   1253 --:--:-- --:--:-- --:--:--  1265
okRequest issued for: [node-2]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621484924194-5c2bb60ea5053-269d05db-6ddedf13] to complete...
.............aborted by ctrl-c.
ERROR: (gcloud.compute.tpus.stop) Aborting wait for operation https://tpu.googleapis.com/v1alpha1/projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621484924194-5c2bb60ea5053-269d05db-6ddedf13.

cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is STOPPING
europe-west4-a
I0520 04:23:53.225510 140715734603584 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[12.0, 16.0]',
                              '[19.0, 36.0]',
                              '[40.0, 28.0]',
                              '[36.0, 75.0]',
                              '[76.0, 55.0]',
                              '[72.0, 146.0]',
                              '[142.0, 110.0]',
                              '[192.0, 243.0]',
                              '[459.0, 401.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_scaled_loss': True},
                    'input_size': [512, 512, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.0,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.5,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'random_pad': False,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.5,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.5,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'random_pad': False,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 04:23:53.226450 140715734603584 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/params.yaml
I0520 04:23:54.041224 140715734603584 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 04:23:54.183499 140715734603584 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0520 04:23:54.183900 140715734603584 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-1" is not yet ready; state: "STOPPING"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, 'input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_scaled_loss': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.0, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.5, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'random_pad': False, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.5, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'random_pad': False, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     12   1260 --:--:-- --:--:-- --:--:--  1272
okRequest issued for: [node-1]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621484997071-5c2bb6542526b-0bfce96c-7e7e040d] to complete...
.....................................................................................................................aborted by ctrl-c.
ERROR: (gcloud.compute.tpus.stop) Aborting wait for operation https://tpu.googleapis.com/v1alpha1/projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621484997071-5c2bb6542526b-0bfce96c-7e7e040d.

cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is STOPPING
europe-west4-a
I0520 04:24:25.527518 140051773896512 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[12.0, 16.0]',
                              '[19.0, 36.0]',
                              '[40.0, 28.0]',
                              '[36.0, 75.0]',
                              '[76.0, 55.0]',
                              '[72.0, 146.0]',
                              '[142.0, 110.0]',
                              '[192.0, 243.0]',
                              '[459.0, 401.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_scaled_loss': True},
                    'input_size': [512, 512, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.0,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.5,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'random_pad': False,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.5,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.5,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'random_pad': False,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 04:24:25.528747 140051773896512 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/params.yaml
I0520 04:24:26.339390 140051773896512 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 04:24:26.963408 140051773896512 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0520 04:24:26.964174 140051773896512 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-1" is not yet ready; state: "STOPPING"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, 'input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_scaled_loss': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.0, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.5, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'random_pad': False, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.5, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'random_pad': False, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208      7    745 --:--:-- --:--:-- --:--:--   752
okERROR: (gcloud.compute.tpus.stop) ABORTED: unable to queue the operation
- '@type': type.googleapis.com/google.rpc.ResourceInfo
  resourceName: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
cat: .experiment_zone: No such file or directory
Request issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-20T04:30:44.739394086Z'
  endTime: '2021-05-20T04:31:21.094555714Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621485044711-5c2bb681941d9-de4e8f46-42fc3df2
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T05:45:10.821112479Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T05:44:59.159875+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T19:29:05.781890630Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T19:28:54.243943+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621485044711-5c2bb681941d9-de4e8f46-42fc3df2] to complete...
..................................................................................................................................................................................................done.
europe-west4-a
I0520 04:25:24.946254 139680122042176 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[12.0, 16.0]',
                              '[19.0, 36.0]',
                              '[40.0, 28.0]',
                              '[36.0, 75.0]',
                              '[76.0, 55.0]',
                              '[72.0, 146.0]',
                              '[142.0, 110.0]',
                              '[192.0, 243.0]',
                              '[459.0, 401.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_scaled_loss': True},
                    'input_size': [512, 512, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.0,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.5,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'random_pad': False,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.5,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.5,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'random_pad': False,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 04:25:24.948146 139680122042176 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/params.yaml
I0520 04:25:25.760176 139680122042176 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 04:25:25.906195 139680122042176 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0520 04:25:25.906454 139680122042176 transport.py:157] Attempting refresh to obtain initial access_token
I0520 04:25:25.976718 139680122042176 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 04:25:26.126087 139680122042176 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0520 04:25:26.126490 139680122042176 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-20 04:25:26.175457: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0520 04:25:26.176473 139680122042176 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 04:25:26.801429 139680122042176 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0520 04:25:26.801879 139680122042176 transport.py:157] Attempting refresh to obtain initial access_token
I0520 04:25:26.874426 139680122042176 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 04:25:27.495139 139680122042176 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0520 04:25:27.495614 139680122042176 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-20 04:25:27.551004: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-20 04:25:27.608975: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-05-20 04:25:27.609094: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:32040}
2021-05-20 04:26:08.684534: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-05-20 04:26:08.684669: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:32040}
2021-05-20 04:26:08.685491: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:32040
I0520 04:26:08.686195 139680122042176 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-1
I0520 04:26:08.687374 139680122042176 tpu_strategy_util.py:74] Initializing the TPU system: node-1
INFO:tensorflow:Clearing out eager caches
I0520 04:26:16.764138 139680122042176 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0520 04:26:16.766545 139680122042176 tpu_strategy_util.py:133] Finished initializing TPU system.
I0520 04:26:16.768174 139680122042176 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 04:26:16.919691 139680122042176 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0520 04:26:16.920009 139680122042176 transport.py:157] Attempting refresh to obtain initial access_token
I0520 04:26:17.012785 139680122042176 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 04:26:17.152421 139680122042176 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0520 04:26:17.152864 139680122042176 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0520 04:26:17.208076 139680122042176 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0520 04:26:17.208318 139680122042176 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0520 04:26:17.208575 139680122042176 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0520 04:26:17.208657 139680122042176 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0520 04:26:17.208712 139680122042176 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0520 04:26:17.208841 139680122042176 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0520 04:26:17.208894 139680122042176 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0520 04:26:17.208945 139680122042176 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0520 04:26:17.208994 139680122042176 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0520 04:26:17.209042 139680122042176 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0520 04:26:17.209089 139680122042176 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0520 04:26:17.209143 139680122042176 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0520 04:26:17.209191 139680122042176 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0520 04:26:17.209243 139680122042176 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0520 04:26:17.209290 139680122042176 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0520 04:26:17.209340 139680122042176 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0520 04:26:17.210649 139680122042176 train_utils.py:214] Running default trainer.
2021-05-20 04:26:17.222367: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, 'input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_scaled_loss': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.0, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.5, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'random_pad': False, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.5, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'random_pad': False, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
heheheeheheheheheheheh:  [[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, 'input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_scaled_loss': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f0968227278>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________I0520 04:27:04.236992 139680122042176 controller.py:362] restoring or initializing model...
I0520 04:27:13.960870 139680122042176 yolo.py:536] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0520 04:27:13.962493 139680122042176 controller.py:368] initialized model.
I0520 04:27:13.962719 139680122042176 train_lib.py:96] Starts to execute mode: train_and_eval
I0520 04:27:13.967293 139680122042176 controller.py:211] train | step:      0 | training until step 20000...
I0520 04:27:22.005169 139680122042176 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0520 04:28:03.973821 139680122042176 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0520 06:14:05.235482 139680122042176 controller.py:425] train | step:  10000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.4191077,
           'avg_obj': 0.059408184,
           'box_loss': 0.1927812,
           'class_loss': 0.40608034,
           'conf_loss': 1.2642684,
           'precision50': 0.04739954,
           'recall50': 0.016113948},
     '4': {'avg_iou': 0.48904052,
           'avg_obj': 0.10786205,
           'box_loss': 0.19588667,
           'class_loss': 0.44354928,
           'conf_loss': 0.5111723,
           'precision50': 0.14328147,
           'recall50': 0.039586507},
     '5': {'avg_iou': 0.5145432,
           'avg_obj': 0.15646198,
           'box_loss': 0.19600978,
           'class_loss': 0.4300619,
           'conf_loss': 0.27133834,
           'precision50': 0.19063619,
           'recall50': 0.06846184},
     'global': {'total_loss': 3.9111366},
     'learning_rate': 0.009985589,
     'training_loss': 3.9111366}
I0520 06:15:08.785963 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-10000.
I0520 07:51:35.566099 139680122042176 controller.py:425] train | step:  20000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.46169463,
           'avg_obj': 0.025488319,
           'box_loss': 0.17478387,
           'class_loss': 0.14664228,
           'conf_loss': 0.21212234,
           'precision50': 0.010819496,
           'recall50': 0.0010026798},
     '4': {'avg_iou': 0.5376142,
           'avg_obj': 0.05852104,
           'box_loss': 0.17451032,
           'class_loss': 0.16925244,
           'conf_loss': 0.1985293,
           'precision50': 0.024556989,
           'recall50': 0.003011036},
     '5': {'avg_iou': 0.57990885,
           'avg_obj': 0.100664765,
           'box_loss': 0.1698176,
           'class_loss': 0.17296001,
           'conf_loss': 0.1356497,
           'precision50': 0.032599036,
           'recall50': 0.004639332},
     'global': {'total_loss': 1.5542684},
     'learning_rate': 0.009942464,
     'training_loss': 1.5542684}
I0520 07:52:35.508123 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-20000.
I0520 07:52:35.514806 139680122042176 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0520 07:52:36.218838 139680122042176 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0520 07:52:52.874569 139680122042176 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0520 07:57:52.177192 139680122042176 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0520 08:01:12.862884 139680122042176 controller.py:261]  eval | step:  20000 | eval time:  517.3 sec | output: 
    {'3': {'avg_iou': 0.3677556,
           'avg_obj': 0.017592797,
           'box_loss': 0.0164993,
           'class_loss': 0.0133744385,
           'conf_loss': 0.02399045,
           'precision50': 0.013525,
           'recall50': 0.0010672509},
     '4': {'avg_iou': 0.4955475,
           'avg_obj': 0.044465806,
           'box_loss': 0.020470051,
           'class_loss': 0.01834717,
           'conf_loss': 0.023629101,
           'precision50': 0.026412433,
           'recall50': 0.004629281},
     '5': {'avg_iou': 0.5026069,
           'avg_obj': 0.08946966,
           'box_loss': 0.023160681,
           'class_loss': 0.020381734,
           'conf_loss': 0.022116074,
           'precision50': 0.0024,
           'recall50': 0.00058487395},
     'AP': 0.0081871245,
     'AP50': 0.020973563,
     'AP75': 0.005392632,
     'APl': 0.010824125,
     'APm': 0.01230732,
     'APs': 0.0038575311,
     'ARl': 0.1011793,
     'ARm': 0.095139116,
     'ARmax1': 0.038478076,
     'ARmax10': 0.08121981,
     'ARmax100': 0.087675475,
     'ARs': 0.021882314,
     'global': {'total_loss': 0.1819689},
     'validation_loss': 0.1819689}

yolo_pan (YoloPAN)              {'5': (None, 16, 16, 57800704    input_2[0][0]                    
                                                                 input_3[0][0]                    
                                                                 input_4[0][0]                    
==================================================================================================
Total params: 57,800,704
Trainable params: 57,768,960
Non-trainable params: 31,744
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'5': (None, 16, 16, 2048 57800704  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  1033056   
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 85,486,272
Trainable params: 85,419,200
Non-trainable params: 67,072
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 400, 8), 5: (8, 200, 8)}, inds: {3: (8, 600, 3), 4: (8, 400, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
train | step:  10000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.4191077,
           'avg_obj': 0.059408184,
           'box_loss': 0.1927812,
           'class_loss': 0.40608034,
           'conf_loss': 1.2642684,
           'precision50': 0.04739954,
           'recall50': 0.016113948},
     '4': {'avg_iou': 0.48904052,
           'avg_obj': 0.10786205,
           'box_loss': 0.19588667,
           'class_loss': 0.44354928,
           'conf_loss': 0.5111723,
           'precision50': 0.14328147,
           'recall50': 0.039586507},
     '5': {'avg_iou': 0.5145432,
           'avg_obj': 0.15646198,
           'box_loss': 0.19600978,
           'class_loss': 0.4300619,
           'conf_loss': 0.27133834,
           'precision50': 0.19063619,
           'recall50': 0.06846184},
     'global': {'total_loss': 3.9111366},
     'learning_rate': 0.009985589,
     'training_loss': 3.9111366}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-10000.
train | step:  20000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.46169463,
           'avg_obj': 0.025488319,
           'box_loss': 0.17478387,
           'class_loss': 0.14664228,
           'conf_loss': 0.21212234,
           'precision50': 0.010819496,
           'recall50': 0.0010026798},
     '4': {'avg_iou': 0.5376142,
           'avg_obj': 0.05852104,
           'box_loss': 0.17451032,
           'class_loss': 0.16925244,
           'conf_loss': 0.1985293,
           'precision50': 0.024556989,
           'recall50': 0.003011036},
     '5': {'avg_iou': 0.57990885,
           'avg_obj': 0.100664765,
           'box_loss': 0.1698176,
           'class_loss': 0.17296001,
           'conf_loss': 0.1356497,
           'precision50': 0.032599036,
           'recall50': 0.004639332},
     'global': {'total_loss': 1.5542684},
     'learning_rate': 0.009942464,
     'training_loss': 1.5542684}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-20000.
 eval | step:  20000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=125.30s).
Accumulating evaluation results...
DONE (t=21.12s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.008
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.021
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.005
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.004
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.012
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.011
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.038
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.081
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.088
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.022
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.095
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.101
 eval | step:  20000 | eval time:  517.3 sec | output: 
    {'3': {'avg_iou': 0.3677556,
           'avg_obj': 0.017592797,
           'box_loss': 0.0164993,
           'class_loss': 0.0133744385,
           'conf_loss': 0.02399045,
           'precision50': 0.013525,
           'recall50': 0.0010672509},
     '4': {'avg_iou': 0.4955475,
           'avg_obj': 0.044465806,
           'box_loss': 0.020470051,
           'class_loss': 0.01834717,
           'conf_loss': 0.023629101,
           'precision50': 0.026412433,
           'recall50': 0.004629281},
     '5': {'avg_iou': 0.5026069,
           'avg_obj': 0.08946966,
           'box_loss': 0.023160681,
           'class_loss': 0.020381734,
           'conf_loss': 0.022116074,
           'precision50': 0.0024,
           'recall50': 0.00058487395},
     'AP': 0.0081871245,
     'AP50': 0.020973563,
     'AP75': 0.005392632,
     'APl': 0.010824125,
     'APm': 0.01230732,
     'APs': 0.0038575311,
     'ARl': 0.1011793,
     'ARm': 0.095139116,
     'ARmax1': 0.038478076,
     'ARmax10': 0.08121981,
     'ARmax100': 0.087675475,
     'ARs': 0.021882314,
     'global': {'total_loss': 0.1819689},
     'validation_loss': 0.1819689}I0520 08:01:41.131358 139680122042176 controller.py:211] train | step:  20000 | training until step 40000...
I0520 09:37:36.551747 139680122042176 controller.py:425] train | step:  30000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.48895365,
           'avg_obj': 0.041387253,
           'box_loss': 0.16564053,
           'class_loss': 0.13238156,
           'conf_loss': 0.20724368,
           'precision50': 0.038529504,
           'recall50': 0.003727785},
     '4': {'avg_iou': 0.57418454,
           'avg_obj': 0.08955965,
           'box_loss': 0.16009153,
           'class_loss': 0.1492678,
           'conf_loss': 0.19378315,
           'precision50': 0.102749124,
           'recall50': 0.013159859},
     '5': {'avg_iou': 0.61904365,
           'avg_obj': 0.14820701,
           'box_loss': 0.1531319,
           'class_loss': 0.15147838,
           'conf_loss': 0.12993096,
           'precision50': 0.16791059,
           'recall50': 0.029314484},
     'global': {'total_loss': 1.4429492},
     'learning_rate': 0.0098709315,
     'training_loss': 1.4429492}
I0520 09:38:39.671747 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-30000.
I0520 11:14:49.836490 139680122042176 controller.py:425] train | step:  40000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.505308,
           'avg_obj': 0.05381137,
           'box_loss': 0.16000146,
           'class_loss': 0.12329087,
           'conf_loss': 0.20401578,
           'precision50': 0.06801347,
           'recall50': 0.007241972},
     '4': {'avg_iou': 0.5932837,
           'avg_obj': 0.10965151,
           'box_loss': 0.15226606,
           'class_loss': 0.13756335,
           'conf_loss': 0.19067748,
           'precision50': 0.17857121,
           'recall50': 0.024959952},
     '5': {'avg_iou': 0.6395372,
           'avg_obj': 0.17690149,
           'box_loss': 0.14436902,
           'class_loss': 0.13963713,
           'conf_loss': 0.12657872,
           'precision50': 0.2713661,
           'recall50': 0.057568487},
     'global': {'total_loss': 1.3784025},
     'learning_rate': 0.00977151,
     'training_loss': 1.3784025}
I0520 11:15:47.088567 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-40000.
I0520 11:15:47.094826 139680122042176 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0520 11:20:01.217946 139680122042176 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0520 11:23:52.226213 139680122042176 controller.py:261]  eval | step:  40000 | eval time:  485.1 sec | output: 
    {'3': {'avg_iou': 0.3975469,
           'avg_obj': 0.039008148,
           'box_loss': 0.014961883,
           'class_loss': 0.010555114,
           'conf_loss': 0.022912908,
           'precision50': 0.072496004,
           'recall50': 0.010014581},
     '4': {'avg_iou': 0.5476359,
           'avg_obj': 0.087039,
           'box_loss': 0.017804783,
           'class_loss': 0.014102659,
           'conf_loss': 0.022244602,
           'precision50': 0.13030854,
           'recall50': 0.026257342},
     '5': {'avg_iou': 0.5782659,
           'avg_obj': 0.13878474,
           'box_loss': 0.019254202,
           'class_loss': 0.015624255,
           'conf_loss': 0.019351589,
           'precision50': 0.1381784,
           'recall50': 0.034014184},
     'AP': 0.037042167,
     'AP50': 0.08096391,
     'AP75': 0.029126817,
     'APl': 0.0471785,
     'APm': 0.04510391,
     'APs': 0.0128361145,
     'ARl': 0.25344604,
     'ARm': 0.2124395,
     'ARmax1': 0.08686833,
     'ARmax10': 0.17855234,
     'ARmax100': 0.1987005,
     'ARs': 0.066013776,
     'global': {'total_loss': 0.1568119},
     'validation_loss': 0.1568119}
I0520 11:24:15.515366 139680122042176 controller.py:211] train | step:  40000 | training until step 60000...
I0520 12:57:37.807264 139680122042176 controller.py:425] train | step:  50000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.5164227,
           'avg_obj': 0.06336694,
           'box_loss': 0.15639192,
           'class_loss': 0.117166825,
           'conf_loss': 0.20180482,
           'precision50': 0.091799356,
           'recall50': 0.01054882},
     '4': {'avg_iou': 0.606409,
           'avg_obj': 0.1248033,
           'box_loss': 0.14706682,
           'class_loss': 0.12952568,
           'conf_loss': 0.18821928,
           'precision50': 0.23843847,
           'recall50': 0.03662203},
     '5': {'avg_iou': 0.65397674,
           'avg_obj': 0.19987158,
           'box_loss': 0.13826902,
           'class_loss': 0.13137923,
           'conf_loss': 0.123959325,
           'precision50': 0.34656313,
           'recall50': 0.08553232},
     'global': {'total_loss': 1.3337815},
     'learning_rate': 0.0096449135,
     'training_loss': 1.3337815}
I0520 12:58:37.402577 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-50000.
I0520 14:34:19.724941 139680122042176 controller.py:425] train | step:  60000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5251409,
           'avg_obj': 0.07147873,
           'box_loss': 0.15341458,
           'class_loss': 0.11218021,
           'conf_loss': 0.19963941,
           'precision50': 0.11363052,
           'recall50': 0.014015791},
     '4': {'avg_iou': 0.61671823,
           'avg_obj': 0.13772249,
           'box_loss': 0.14280203,
           'class_loss': 0.12312835,
           'conf_loss': 0.18567821,
           'precision50': 0.28559098,
           'recall50': 0.048216715},
     '5': {'avg_iou': 0.6653058,
           'avg_obj': 0.21778502,
           'box_loss': 0.13340303,
           'class_loss': 0.124870814,
           'conf_loss': 0.121656165,
           'precision50': 0.39842898,
           'recall50': 0.109796084},
     'global': {'total_loss': 1.2967733},
     'learning_rate': 0.009492056,
     'training_loss': 1.2967733}
I0520 14:35:26.872133 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-60000.
I0520 14:35:26.878940 139680122042176 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0520 14:39:30.455293 139680122042176 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0520 14:43:20.677644 139680122042176 controller.py:261]  eval | step:  60000 | eval time:  473.8 sec | output: 
    {'3': {'avg_iou': 0.41218272,
           'avg_obj': 0.055966936,
           'box_loss': 0.014204585,
           'class_loss': 0.009187913,
           'conf_loss': 0.022303713,
           'precision50': 0.112611376,
           'recall50': 0.02126462},
     '4': {'avg_iou': 0.5719852,
           'avg_obj': 0.114321165,
           'box_loss': 0.016556114,
           'class_loss': 0.012078909,
           'conf_loss': 0.02153181,
           'precision50': 0.21032356,
           'recall50': 0.05134023},
     '5': {'avg_iou': 0.61438113,
           'avg_obj': 0.17833206,
           'box_loss': 0.017380869,
           'class_loss': 0.013379251,
           'conf_loss': 0.018362423,
           'precision50': 0.26381326,
           'recall50': 0.07737831},
     'AP': 0.065542184,
     'AP50': 0.13700339,
     'AP75': 0.05675163,
     'APl': 0.084334955,
     'APm': 0.07424117,
     'APs': 0.022482734,
     'ARl': 0.3259387,
     'ARm': 0.2679729,
     'ARmax1': 0.11718393,
     'ARmax10': 0.22642913,
     'ARmax100': 0.2526384,
     'ARs': 0.09477204,
     'global': {'total_loss': 0.14498551},
     'validation_loss': 0.14498551}

train | step:  20000 | training until step 40000...
train | step:  30000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.48895365,
           'avg_obj': 0.041387253,
           'box_loss': 0.16564053,
           'class_loss': 0.13238156,
           'conf_loss': 0.20724368,
           'precision50': 0.038529504,
           'recall50': 0.003727785},
     '4': {'avg_iou': 0.57418454,
           'avg_obj': 0.08955965,
           'box_loss': 0.16009153,
           'class_loss': 0.1492678,
           'conf_loss': 0.19378315,
           'precision50': 0.102749124,
           'recall50': 0.013159859},
     '5': {'avg_iou': 0.61904365,
           'avg_obj': 0.14820701,
           'box_loss': 0.1531319,
           'class_loss': 0.15147838,
           'conf_loss': 0.12993096,
           'precision50': 0.16791059,
           'recall50': 0.029314484},
     'global': {'total_loss': 1.4429492},
     'learning_rate': 0.0098709315,
     'training_loss': 1.4429492}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-30000.
train | step:  40000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.505308,
           'avg_obj': 0.05381137,
           'box_loss': 0.16000146,
           'class_loss': 0.12329087,
           'conf_loss': 0.20401578,
           'precision50': 0.06801347,
           'recall50': 0.007241972},
     '4': {'avg_iou': 0.5932837,
           'avg_obj': 0.10965151,
           'box_loss': 0.15226606,
           'class_loss': 0.13756335,
           'conf_loss': 0.19067748,
           'precision50': 0.17857121,
           'recall50': 0.024959952},
     '5': {'avg_iou': 0.6395372,
           'avg_obj': 0.17690149,
           'box_loss': 0.14436902,
           'class_loss': 0.13963713,
           'conf_loss': 0.12657872,
           'precision50': 0.2713661,
           'recall50': 0.057568487},
     'global': {'total_loss': 1.3784025},
     'learning_rate': 0.00977151,
     'training_loss': 1.3784025}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-40000.
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=151.90s).
Accumulating evaluation results...
DONE (t=24.55s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.037
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.081
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.029
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.013
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.045
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.047
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.087
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.179
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.199
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.066
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.212
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.253
 eval | step:  40000 | eval time:  485.1 sec | output: 
    {'3': {'avg_iou': 0.3975469,
           'avg_obj': 0.039008148,
           'box_loss': 0.014961883,
           'class_loss': 0.010555114,
           'conf_loss': 0.022912908,
           'precision50': 0.072496004,
           'recall50': 0.010014581},
     '4': {'avg_iou': 0.5476359,
           'avg_obj': 0.087039,
           'box_loss': 0.017804783,
           'class_loss': 0.014102659,
           'conf_loss': 0.022244602,
           'precision50': 0.13030854,
           'recall50': 0.026257342},
     '5': {'avg_iou': 0.5782659,
           'avg_obj': 0.13878474,
           'box_loss': 0.019254202,
           'class_loss': 0.015624255,
           'conf_loss': 0.019351589,
           'precision50': 0.1381784,
           'recall50': 0.034014184},
     'AP': 0.037042167,
     'AP50': 0.08096391,
     'AP75': 0.029126817,
     'APl': 0.0471785,
     'APm': 0.04510391,
     'APs': 0.0128361145,
     'ARl': 0.25344604,
     'ARm': 0.2124395,
     'ARmax1': 0.08686833,
     'ARmax10': 0.17855234,
     'ARmax100': 0.1987005,
     'ARs': 0.066013776,
     'global': {'total_loss': 0.1568119},
     'validation_loss': 0.1568119}
train | step:  40000 | training until step 60000...
train | step:  50000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.5164227,
           'avg_obj': 0.06336694,
           'box_loss': 0.15639192,
           'class_loss': 0.117166825,
           'conf_loss': 0.20180482,
           'precision50': 0.091799356,
           'recall50': 0.01054882},
     '4': {'avg_iou': 0.606409,
           'avg_obj': 0.1248033,
           'box_loss': 0.14706682,
           'class_loss': 0.12952568,
           'conf_loss': 0.18821928,
           'precision50': 0.23843847,
           'recall50': 0.03662203},
     '5': {'avg_iou': 0.65397674,
           'avg_obj': 0.19987158,
           'box_loss': 0.13826902,
           'class_loss': 0.13137923,
           'conf_loss': 0.123959325,
           'precision50': 0.34656313,
           'recall50': 0.08553232},
     'global': {'total_loss': 1.3337815},
     'learning_rate': 0.0096449135,
     'training_loss': 1.3337815}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-50000.
train | step:  60000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5251409,
           'avg_obj': 0.07147873,
           'box_loss': 0.15341458,
           'class_loss': 0.11218021,
           'conf_loss': 0.19963941,
           'precision50': 0.11363052,
           'recall50': 0.014015791},
     '4': {'avg_iou': 0.61671823,
           'avg_obj': 0.13772249,
           'box_loss': 0.14280203,
           'class_loss': 0.12312835,
           'conf_loss': 0.18567821,
           'precision50': 0.28559098,
           'recall50': 0.048216715},
     '5': {'avg_iou': 0.6653058,
           'avg_obj': 0.21778502,
           'box_loss': 0.13340303,
           'class_loss': 0.124870814,
           'conf_loss': 0.121656165,
           'precision50': 0.39842898,
           'recall50': 0.109796084},
     'global': {'total_loss': 1.2967733},
     'learning_rate': 0.009492056,
     'training_loss': 1.2967733}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-60000.
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=152.91s).
Accumulating evaluation results...
DONE (t=22.70s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.066
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.137
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.057
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.022
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.074
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.084
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.117
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.226
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.253
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.095
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.268
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.326
 eval | step:  60000 | eval time:  473.8 sec | output: 
    {'3': {'avg_iou': 0.41218272,
           'avg_obj': 0.055966936,
           'box_loss': 0.014204585,
           'class_loss': 0.009187913,
           'conf_loss': 0.022303713,
           'precision50': 0.112611376,
           'recall50': 0.02126462},
     '4': {'avg_iou': 0.5719852,
           'avg_obj': 0.114321165,
           'box_loss': 0.016556114,
           'class_loss': 0.012078909,
           'conf_loss': 0.02153181,
           'precision50': 0.21032356,
           'recall50': 0.05134023},
     '5': {'avg_iou': 0.61438113,
           'avg_obj': 0.17833206,
           'box_loss': 0.017380869,
           'class_loss': 0.013379251,
           'conf_loss': 0.018362423,
           'precision50': 0.26381326,
           'recall50': 0.07737831},
     'AP': 0.065542184,
     'AP50': 0.13700339,
     'AP75': 0.05675163,
     'APl': 0.084334955,
     'APm': 0.07424117,
     'APs': 0.022482734,
     'ARl': 0.3259387,
     'ARm': 0.2679729,
     'ARmax1': 0.11718393,
     'ARmax10': 0.22642913,
     'ARmax100': 0.2526384,
     'ARs': 0.09477204,
     'global': {'total_loss': 0.14498551},
     'validation_loss': 0.14498551}I0520 14:43:45.882073 139680122042176 controller.py:211] train | step:  60000 | training until step 80000...
I0520 16:16:59.362640 139680122042176 controller.py:425] train | step:  70000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.53338456,
           'avg_obj': 0.079163596,
           'box_loss': 0.15064083,
           'class_loss': 0.10754764,
           'conf_loss': 0.19775051,
           'precision50': 0.13364974,
           'recall50': 0.017414806},
     '4': {'avg_iou': 0.6258174,
           'avg_obj': 0.14943732,
           'box_loss': 0.13911214,
           'class_loss': 0.11753849,
           'conf_loss': 0.1836926,
           'precision50': 0.32497522,
           'recall50': 0.059585545},
     '5': {'avg_iou': 0.6748655,
           'avg_obj': 0.23333697,
           'box_loss': 0.1292368,
           'class_loss': 0.11908372,
           'conf_loss': 0.11997129,
           'precision50': 0.4388414,
           'recall50': 0.13232988},
     'global': {'total_loss': 1.2645714},
     'learning_rate': 0.009314038,
     'training_loss': 1.2645714}
I0520 16:17:59.921513 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-70000.
I0520 17:50:59.568489 139680122042176 controller.py:425] train | step:  80000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5398982,
           'avg_obj': 0.08579809,
           'box_loss': 0.14856099,
           'class_loss': 0.10402671,
           'conf_loss': 0.19621626,
           'precision50': 0.15042949,
           'recall50': 0.02054246},
     '4': {'avg_iou': 0.63350034,
           'avg_obj': 0.15953921,
           'box_loss': 0.13603778,
           'class_loss': 0.11286921,
           'conf_loss': 0.18202214,
           'precision50': 0.35653183,
           'recall50': 0.0700805},
     '5': {'avg_iou': 0.68282735,
           'avg_obj': 0.24668081,
           'box_loss': 0.12586215,
           'class_loss': 0.11424059,
           'conf_loss': 0.11843465,
           'precision50': 0.46994478,
           'recall50': 0.1518102},
     'global': {'total_loss': 1.2382745},
     'learning_rate': 0.009112143,
     'training_loss': 1.2382745}
I0520 17:52:09.963152 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-80000.
I0520 17:52:09.969650 139680122042176 controller.py:252]  eval | step:  80000 | running 625 steps of evaluation...
I0520 17:56:25.679369 139680122042176 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0520 18:00:39.577187 139680122042176 controller.py:261]  eval | step:  80000 | eval time:  509.6 sec | output: 
    {'3': {'avg_iou': 0.42328197,
           'avg_obj': 0.06895198,
           'box_loss': 0.013631603,
           'class_loss': 0.008151439,
           'conf_loss': 0.02175679,
           'precision50': 0.14329919,
           'recall50': 0.030272644},
     '4': {'avg_iou': 0.5903285,
           'avg_obj': 0.13933548,
           'box_loss': 0.015611557,
           'class_loss': 0.010499236,
           'conf_loss': 0.020969542,
           'precision50': 0.28283176,
           'recall50': 0.07558094},
     '5': {'avg_iou': 0.63901436,
           'avg_obj': 0.21235308,
           'box_loss': 0.016104659,
           'class_loss': 0.011630568,
           'conf_loss': 0.017717669,
           'precision50': 0.36466065,
           'recall50': 0.123095304},
     'AP': 0.09432329,
     'AP50': 0.18728316,
     'AP75': 0.08511583,
     'APl': 0.12410464,
     'APm': 0.10381873,
     'APs': 0.032572586,
     'ARl': 0.38216302,
     'ARm': 0.31475613,
     'ARmax1': 0.14105383,
     'ARmax10': 0.26548713,
     'ARmax100': 0.2959097,
     'ARs': 0.12680209,
     'global': {'total_loss': 0.1360732},
     'validation_loss': 0.1360732}
I0520 18:00:56.357752 139680122042176 controller.py:211] train | step:  80000 | training until step 100000...
I0520 19:33:57.933322 139680122042176 controller.py:425] train | step:  90000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.5448864,
           'avg_obj': 0.09116929,
           'box_loss': 0.14673346,
           'class_loss': 0.101132795,
           'conf_loss': 0.19438718,
           'precision50': 0.16416374,
           'recall50': 0.023457937},
     '4': {'avg_iou': 0.6393377,
           'avg_obj': 0.16804348,
           'box_loss': 0.13358219,
           'class_loss': 0.108920045,
           'conf_loss': 0.18000056,
           'precision50': 0.3806282,
           'recall50': 0.079411566},
     '5': {'avg_iou': 0.6894161,
           'avg_obj': 0.25823942,
           'box_loss': 0.123075284,
           'class_loss': 0.11000836,
           'conf_loss': 0.11703218,
           'precision50': 0.4952168,
           'recall50': 0.1696779},
     'global': {'total_loss': 1.2148728},
     'learning_rate': 0.008887824,
     'training_loss': 1.2148728}
I0520 19:34:58.387798 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-90000.
I0520 21:05:41.306922 139680122042176 controller.py:425] train | step:  100000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.54899246,
           'avg_obj': 0.096130796,
           'box_loss': 0.14557387,
           'class_loss': 0.09862004,
           'conf_loss': 0.1940832,
           'precision50': 0.17874582,
           'recall50': 0.026410569},
     '4': {'avg_iou': 0.64540666,
           'avg_obj': 0.17675833,
           'box_loss': 0.13125946,
           'class_loss': 0.10538396,
           'conf_loss': 0.17909445,
           'precision50': 0.4038179,
           'recall50': 0.08922285},
     '5': {'avg_iou': 0.69516087,
           'avg_obj': 0.26854828,
           'box_loss': 0.12061753,
           'class_loss': 0.10614579,
           'conf_loss': 0.115854554,
           'precision50': 0.51494086,
           'recall50': 0.18540132},
     'global': {'total_loss': 1.1966344},
     'learning_rate': 0.008642699,
     'training_loss': 1.1966344}
I0520 21:06:40.528863 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-100000.
I0520 21:06:40.535457 139680122042176 controller.py:252]  eval | step:  100000 | running 625 steps of evaluation...
I0520 21:10:54.759810 139680122042176 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0520 21:15:01.882438 139680122042176 controller.py:261]  eval | step:  100000 | eval time:  501.3 sec | output: 
    {'3': {'avg_iou': 0.42971283,
           'avg_obj': 0.078494504,
           'box_loss': 0.013295639,
           'class_loss': 0.0075336616,
           'conf_loss': 0.021442246,
           'precision50': 0.1739494,
           'recall50': 0.037782755},
     '4': {'avg_iou': 0.60233366,
           'avg_obj': 0.15790306,
           'box_loss': 0.014990526,
           'class_loss': 0.0095218755,
           'conf_loss': 0.020535853,
           'precision50': 0.32727772,
           'recall50': 0.09561213},
     '5': {'avg_iou': 0.65420467,
           'avg_obj': 0.2369283,
           'box_loss': 0.015319341,
           'class_loss': 0.010519927,
           'conf_loss': 0.017251207,
           'precision50': 0.42427504,
           'recall50': 0.15673019},
     'AP': 0.116155684,
     'AP50': 0.22457357,
     'AP75': 0.10851254,
     'APl': 0.15402824,
     'APm': 0.12337919,
     'APs': 0.045631647,
     'ARl': 0.42178234,
     'ARm': 0.33966458,
     'ARmax1': 0.15727004,
     'ARmax10': 0.28960064,
     'ARmax100': 0.32309964,
     'ARs': 0.14729503,
     'global': {'total_loss': 0.1304103},
     'validation_loss': 0.1304103}

train | step:  60000 | training until step 80000...
train | step:  70000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.53338456,
           'avg_obj': 0.079163596,
           'box_loss': 0.15064083,
           'class_loss': 0.10754764,
           'conf_loss': 0.19775051,
           'precision50': 0.13364974,
           'recall50': 0.017414806},
     '4': {'avg_iou': 0.6258174,
           'avg_obj': 0.14943732,
           'box_loss': 0.13911214,
           'class_loss': 0.11753849,
           'conf_loss': 0.1836926,
           'precision50': 0.32497522,
           'recall50': 0.059585545},
     '5': {'avg_iou': 0.6748655,
           'avg_obj': 0.23333697,
           'box_loss': 0.1292368,
           'class_loss': 0.11908372,
           'conf_loss': 0.11997129,
           'precision50': 0.4388414,
           'recall50': 0.13232988},
     'global': {'total_loss': 1.2645714},
     'learning_rate': 0.009314038,
     'training_loss': 1.2645714}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-70000.
train | step:  80000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5398982,
           'avg_obj': 0.08579809,
           'box_loss': 0.14856099,
           'class_loss': 0.10402671,
           'conf_loss': 0.19621626,
           'precision50': 0.15042949,
           'recall50': 0.02054246},
     '4': {'avg_iou': 0.63350034,
           'avg_obj': 0.15953921,
           'box_loss': 0.13603778,
           'class_loss': 0.11286921,
           'conf_loss': 0.18202214,
           'precision50': 0.35653183,
           'recall50': 0.0700805},
     '5': {'avg_iou': 0.68282735,
           'avg_obj': 0.24668081,
           'box_loss': 0.12586215,
           'class_loss': 0.11424059,
           'conf_loss': 0.11843465,
           'precision50': 0.46994478,
           'recall50': 0.1518102},
     'global': {'total_loss': 1.2382745},
     'learning_rate': 0.009112143,
     'training_loss': 1.2382745}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-80000.
 eval | step:  80000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=167.25s).
Accumulating evaluation results...
DONE (t=23.28s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.094
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.187
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.085
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.033
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.104
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.124
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.141
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.265
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.296
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.127
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.315
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.382
 eval | step:  80000 | eval time:  509.6 sec | output: 
    {'3': {'avg_iou': 0.42328197,
           'avg_obj': 0.06895198,
           'box_loss': 0.013631603,
           'class_loss': 0.008151439,
           'conf_loss': 0.02175679,
           'precision50': 0.14329919,
           'recall50': 0.030272644},
     '4': {'avg_iou': 0.5903285,
           'avg_obj': 0.13933548,
           'box_loss': 0.015611557,
           'class_loss': 0.010499236,
           'conf_loss': 0.020969542,
           'precision50': 0.28283176,
           'recall50': 0.07558094},
     '5': {'avg_iou': 0.63901436,
           'avg_obj': 0.21235308,
           'box_loss': 0.016104659,
           'class_loss': 0.011630568,
           'conf_loss': 0.017717669,
           'precision50': 0.36466065,
           'recall50': 0.123095304},
     'AP': 0.09432329,
     'AP50': 0.18728316,
     'AP75': 0.08511583,
     'APl': 0.12410464,
     'APm': 0.10381873,
     'APs': 0.032572586,
     'ARl': 0.38216302,
     'ARm': 0.31475613,
     'ARmax1': 0.14105383,
     'ARmax10': 0.26548713,
     'ARmax100': 0.2959097,
     'ARs': 0.12680209,
     'global': {'total_loss': 0.1360732},
     'validation_loss': 0.1360732}
train | step:  80000 | training until step 100000...
train | step:  90000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.5448864,
           'avg_obj': 0.09116929,
           'box_loss': 0.14673346,
           'class_loss': 0.101132795,
           'conf_loss': 0.19438718,
           'precision50': 0.16416374,
           'recall50': 0.023457937},
     '4': {'avg_iou': 0.6393377,
           'avg_obj': 0.16804348,
           'box_loss': 0.13358219,
           'class_loss': 0.108920045,
           'conf_loss': 0.18000056,
           'precision50': 0.3806282,
           'recall50': 0.079411566},
     '5': {'avg_iou': 0.6894161,
           'avg_obj': 0.25823942,
           'box_loss': 0.123075284,
           'class_loss': 0.11000836,
           'conf_loss': 0.11703218,
           'precision50': 0.4952168,
           'recall50': 0.1696779},
     'global': {'total_loss': 1.2148728},
     'learning_rate': 0.008887824,
     'training_loss': 1.2148728}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-90000.
train | step:  100000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.54899246,
           'avg_obj': 0.096130796,
           'box_loss': 0.14557387,
           'class_loss': 0.09862004,
           'conf_loss': 0.1940832,
           'precision50': 0.17874582,
           'recall50': 0.026410569},
     '4': {'avg_iou': 0.64540666,
           'avg_obj': 0.17675833,
           'box_loss': 0.13125946,
           'class_loss': 0.10538396,
           'conf_loss': 0.17909445,
           'precision50': 0.4038179,
           'recall50': 0.08922285},
     '5': {'avg_iou': 0.69516087,
           'avg_obj': 0.26854828,
           'box_loss': 0.12061753,
           'class_loss': 0.10614579,
           'conf_loss': 0.115854554,
           'precision50': 0.51494086,
           'recall50': 0.18540132},
     'global': {'total_loss': 1.1966344},
     'learning_rate': 0.008642699,
     'training_loss': 1.1966344}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-100000.
 eval | step:  100000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=164.93s).
Accumulating evaluation results...
DONE (t=22.59s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.116
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.225
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.109
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.046
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.123
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.154
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.157
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.290
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.323
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.147
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.340
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.422
 eval | step:  100000 | eval time:  501.3 sec | output: 
    {'3': {'avg_iou': 0.42971283,
           'avg_obj': 0.078494504,
           'box_loss': 0.013295639,
           'class_loss': 0.0075336616,
           'conf_loss': 0.021442246,
           'precision50': 0.1739494,
           'recall50': 0.037782755},
     '4': {'avg_iou': 0.60233366,
           'avg_obj': 0.15790306,
           'box_loss': 0.014990526,
           'class_loss': 0.0095218755,
           'conf_loss': 0.020535853,
           'precision50': 0.32727772,
           'recall50': 0.09561213},
     '5': {'avg_iou': 0.65420467,
           'avg_obj': 0.2369283,
           'box_loss': 0.015319341,
           'class_loss': 0.010519927,
           'conf_loss': 0.017251207,
           'precision50': 0.42427504,
           'recall50': 0.15673019},
     'AP': 0.116155684,
     'AP50': 0.22457357,
     'AP75': 0.10851254,
     'APl': 0.15402824,
     'APm': 0.12337919,
     'APs': 0.045631647,
     'ARl': 0.42178234,
     'ARm': 0.33966458,
     'ARmax1': 0.15727004,
     'ARmax10': 0.28960064,
     'ARmax100': 0.32309964,
     'ARs': 0.14729503,
     'global': {'total_loss': 0.1304103},
     'validation_loss': 0.1304103}I0520 21:15:24.218298 139680122042176 controller.py:211] train | step:  100000 | training until step 120000...
I0520 22:46:11.861085 139680122042176 controller.py:425] train | step:  110000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5530621,
           'avg_obj': 0.10058931,
           'box_loss': 0.14399381,
           'class_loss': 0.09623704,
           'conf_loss': 0.19246781,
           'precision50': 0.18976332,
           'recall50': 0.028853236},
     '4': {'avg_iou': 0.65001494,
           'avg_obj': 0.1836246,
           'box_loss': 0.12950157,
           'class_loss': 0.10244221,
           'conf_loss': 0.17744955,
           'precision50': 0.42070273,
           'recall50': 0.09738844},
     '5': {'avg_iou': 0.69991374,
           'avg_obj': 0.2772166,
           'box_loss': 0.11857104,
           'class_loss': 0.10300121,
           'conf_loss': 0.11462532,
           'precision50': 0.5309618,
           'recall50': 0.19883896},
     'global': {'total_loss': 1.1782902},
     'learning_rate': 0.008378533,
     'training_loss': 1.1782902}
I0520 22:47:12.793378 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-110000.
I0521 00:22:01.573336 139680122042176 controller.py:425] train | step:  120000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.55707484,
           'avg_obj': 0.10510372,
           'box_loss': 0.1427575,
           'class_loss': 0.094149075,
           'conf_loss': 0.19146325,
           'precision50': 0.20178255,
           'recall50': 0.03208632},
     '4': {'avg_iou': 0.65463006,
           'avg_obj': 0.1905233,
           'box_loss': 0.12751928,
           'class_loss': 0.09949159,
           'conf_loss': 0.17618947,
           'precision50': 0.4366009,
           'recall50': 0.1051765},
     '5': {'avg_iou': 0.70446837,
           'avg_obj': 0.285565,
           'box_loss': 0.11665218,
           'class_loss': 0.099988356,
           'conf_loss': 0.11361608,
           'precision50': 0.54553455,
           'recall50': 0.21186279},
     'global': {'total_loss': 1.1618237},
     'learning_rate': 0.008097229,
     'training_loss': 1.1618237}
I0521 00:23:02.625161 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-120000.
I0521 00:23:02.630973 139680122042176 controller.py:252]  eval | step:  120000 | running 625 steps of evaluation...
I0521 00:27:14.704816 139680122042176 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0521 00:31:16.872475 139680122042176 controller.py:261]  eval | step:  120000 | eval time:  494.2 sec | output: 
    {'3': {'avg_iou': 0.4351132,
           'avg_obj': 0.0860405,
           'box_loss': 0.0130154705,
           'class_loss': 0.007079445,
           'conf_loss': 0.021133943,
           'precision50': 0.19115219,
           'recall50': 0.04416529},
     '4': {'avg_iou': 0.61190677,
           'avg_obj': 0.17267065,
           'box_loss': 0.014495293,
           'class_loss': 0.008838513,
           'conf_loss': 0.020161508,
           'precision50': 0.36245263,
           'recall50': 0.111840785},
     '5': {'avg_iou': 0.665511,
           'avg_obj': 0.2574879,
           'box_loss': 0.014732064,
           'class_loss': 0.009726242,
           'conf_loss': 0.016896568,
           'precision50': 0.47877812,
           'recall50': 0.1900272},
     'AP': 0.13427012,
     'AP50': 0.25508484,
     'AP75': 0.1256069,
     'APl': 0.17839895,
     'APm': 0.13966677,
     'APs': 0.051318474,
     'ARl': 0.448566,
     'ARm': 0.3637633,
     'ARmax1': 0.17101522,
     'ARmax10': 0.31000084,
     'ARmax100': 0.34515676,
     'ARs': 0.16256456,
     'global': {'total_loss': 0.12607895},
     'validation_loss': 0.12607895}
I0521 00:31:34.251640 139680122042176 controller.py:211] train | step:  120000 | training until step 140000...
I0521 02:00:55.347990 139680122042176 controller.py:425] train | step:  130000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.56112033,
           'avg_obj': 0.10916063,
           'box_loss': 0.1412756,
           'class_loss': 0.09233207,
           'conf_loss': 0.19048092,
           'precision50': 0.21203434,
           'recall50': 0.034579292},
     '4': {'avg_iou': 0.65913135,
           'avg_obj': 0.19682541,
           'box_loss': 0.12581876,
           'class_loss': 0.09710752,
           'conf_loss': 0.17517866,
           'precision50': 0.4499319,
           'recall50': 0.112669945},
     '5': {'avg_iou': 0.708483,
           'avg_obj': 0.29267398,
           'box_loss': 0.11489447,
           'class_loss': 0.09738371,
           'conf_loss': 0.11285425,
           'precision50': 0.55662465,
           'recall50': 0.22253555},
     'global': {'total_loss': 1.1473266},
     'learning_rate': 0.007800815,
     'training_loss': 1.1473266}
I0521 02:02:02.910973 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-130000.
I0521 03:37:30.204324 139680122042176 controller.py:425] train | step:  140000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5635607,
           'avg_obj': 0.1127361,
           'box_loss': 0.14036395,
           'class_loss': 0.09059781,
           'conf_loss': 0.18951882,
           'precision50': 0.22091503,
           'recall50': 0.036862664},
     '4': {'avg_iou': 0.6626621,
           'avg_obj': 0.20222993,
           'box_loss': 0.12432397,
           'class_loss': 0.09479602,
           'conf_loss': 0.17410739,
           'precision50': 0.46173587,
           'recall50': 0.11957217},
     '5': {'avg_iou': 0.71245706,
           'avg_obj': 0.2991882,
           'box_loss': 0.11338511,
           'class_loss': 0.09505102,
           'conf_loss': 0.1122204,
           'precision50': 0.56707907,
           'recall50': 0.23280756},
     'global': {'total_loss': 1.1343639},
     'learning_rate': 0.007491425,
     'training_loss': 1.1343639}
I0521 03:38:30.524133 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-140000.
I0521 03:38:30.531590 139680122042176 controller.py:252]  eval | step:  140000 | running 625 steps of evaluation...
I0521 03:42:43.694437 139680122042176 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0521 03:46:50.424954 139680122042176 controller.py:261]  eval | step:  140000 | eval time:  499.9 sec | output: 
    {'3': {'avg_iou': 0.43945688,
           'avg_obj': 0.09278868,
           'box_loss': 0.012789425,
           'class_loss': 0.0067381044,
           'conf_loss': 0.02088749,
           'precision50': 0.20753276,
           'recall50': 0.05099026},
     '4': {'avg_iou': 0.6193387,
           'avg_obj': 0.18539265,
           'box_loss': 0.0141111035,
           'class_loss': 0.008269805,
           'conf_loss': 0.019860044,
           'precision50': 0.38641605,
           'recall50': 0.12770365},
     '5': {'avg_iou': 0.6739108,
           'avg_obj': 0.27347535,
           'box_loss': 0.014293065,
           'class_loss': 0.009092416,
           'conf_loss': 0.016601011,
           'precision50': 0.5090621,
           'recall50': 0.21292971},
     'AP': 0.14938205,
     'AP50': 0.27884278,
     'AP75': 0.14056684,
     'APl': 0.19992924,
     'APm': 0.15411957,
     'APs': 0.058253743,
     'ARl': 0.470665,
     'ARm': 0.3850346,
     'ARmax1': 0.1813825,
     'ARmax10': 0.3271402,
     'ARmax100': 0.3632776,
     'ARs': 0.17237759,
     'global': {'total_loss': 0.12264252},
     'validation_loss': 0.12264252}

train | step:  100000 | training until step 120000...
train | step:  110000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5530621,
           'avg_obj': 0.10058931,
           'box_loss': 0.14399381,
           'class_loss': 0.09623704,
           'conf_loss': 0.19246781,
           'precision50': 0.18976332,
           'recall50': 0.028853236},
     '4': {'avg_iou': 0.65001494,
           'avg_obj': 0.1836246,
           'box_loss': 0.12950157,
           'class_loss': 0.10244221,
           'conf_loss': 0.17744955,
           'precision50': 0.42070273,
           'recall50': 0.09738844},
     '5': {'avg_iou': 0.69991374,
           'avg_obj': 0.2772166,
           'box_loss': 0.11857104,
           'class_loss': 0.10300121,
           'conf_loss': 0.11462532,
           'precision50': 0.5309618,
           'recall50': 0.19883896},
     'global': {'total_loss': 1.1782902},
     'learning_rate': 0.008378533,
     'training_loss': 1.1782902}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-110000.
train | step:  120000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.55707484,
           'avg_obj': 0.10510372,
           'box_loss': 0.1427575,
           'class_loss': 0.094149075,
           'conf_loss': 0.19146325,
           'precision50': 0.20178255,
           'recall50': 0.03208632},
     '4': {'avg_iou': 0.65463006,
           'avg_obj': 0.1905233,
           'box_loss': 0.12751928,
           'class_loss': 0.09949159,
           'conf_loss': 0.17618947,
           'precision50': 0.4366009,
           'recall50': 0.1051765},
     '5': {'avg_iou': 0.70446837,
           'avg_obj': 0.285565,
           'box_loss': 0.11665218,
           'class_loss': 0.099988356,
           'conf_loss': 0.11361608,
           'precision50': 0.54553455,
           'recall50': 0.21186279},
     'global': {'total_loss': 1.1618237},
     'learning_rate': 0.008097229,
     'training_loss': 1.1618237}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-120000.
 eval | step:  120000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=162.67s).
Accumulating evaluation results...
DONE (t=25.27s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.134
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.255
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.126
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.051
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.140
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.178
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.171
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.310
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.345
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.163
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.364
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.449
 eval | step:  120000 | eval time:  494.2 sec | output: 
    {'3': {'avg_iou': 0.4351132,
           'avg_obj': 0.0860405,
           'box_loss': 0.0130154705,
           'class_loss': 0.007079445,
           'conf_loss': 0.021133943,
           'precision50': 0.19115219,
           'recall50': 0.04416529},
     '4': {'avg_iou': 0.61190677,
           'avg_obj': 0.17267065,
           'box_loss': 0.014495293,
           'class_loss': 0.008838513,
           'conf_loss': 0.020161508,
           'precision50': 0.36245263,
           'recall50': 0.111840785},
     '5': {'avg_iou': 0.665511,
           'avg_obj': 0.2574879,
           'box_loss': 0.014732064,
           'class_loss': 0.009726242,
           'conf_loss': 0.016896568,
           'precision50': 0.47877812,
           'recall50': 0.1900272},
     'AP': 0.13427012,
     'AP50': 0.25508484,
     'AP75': 0.1256069,
     'APl': 0.17839895,
     'APm': 0.13966677,
     'APs': 0.051318474,
     'ARl': 0.448566,
     'ARm': 0.3637633,
     'ARmax1': 0.17101522,
     'ARmax10': 0.31000084,
     'ARmax100': 0.34515676,
     'ARs': 0.16256456,
     'global': {'total_loss': 0.12607895},
     'validation_loss': 0.12607895}
train | step:  120000 | training until step 140000...
train | step:  130000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.56112033,
           'avg_obj': 0.10916063,
           'box_loss': 0.1412756,
           'class_loss': 0.09233207,
           'conf_loss': 0.19048092,
           'precision50': 0.21203434,
           'recall50': 0.034579292},
     '4': {'avg_iou': 0.65913135,
           'avg_obj': 0.19682541,
           'box_loss': 0.12581876,
           'class_loss': 0.09710752,
           'conf_loss': 0.17517866,
           'precision50': 0.4499319,
           'recall50': 0.112669945},
     '5': {'avg_iou': 0.708483,
           'avg_obj': 0.29267398,
           'box_loss': 0.11489447,
           'class_loss': 0.09738371,
           'conf_loss': 0.11285425,
           'precision50': 0.55662465,
           'recall50': 0.22253555},
     'global': {'total_loss': 1.1473266},
     'learning_rate': 0.007800815,
     'training_loss': 1.1473266}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-130000.
train | step:  140000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5635607,
           'avg_obj': 0.1127361,
           'box_loss': 0.14036395,
           'class_loss': 0.09059781,
           'conf_loss': 0.18951882,
           'precision50': 0.22091503,
           'recall50': 0.036862664},
     '4': {'avg_iou': 0.6626621,
           'avg_obj': 0.20222993,
           'box_loss': 0.12432397,
           'class_loss': 0.09479602,
           'conf_loss': 0.17410739,
           'precision50': 0.46173587,
           'recall50': 0.11957217},
     '5': {'avg_iou': 0.71245706,
           'avg_obj': 0.2991882,
           'box_loss': 0.11338511,
           'class_loss': 0.09505102,
           'conf_loss': 0.1122204,
           'precision50': 0.56707907,
           'recall50': 0.23280756},
     'global': {'total_loss': 1.1343639},
     'learning_rate': 0.007491425,
     'training_loss': 1.1343639}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-140000.
 eval | step:  140000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=168.95s).
Accumulating evaluation results...
DONE (t=21.28s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.149
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.279
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.141
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.058
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.154
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.200
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.181
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.327
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.363
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.172
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.385
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.471
 eval | step:  140000 | eval time:  499.9 sec | output: 
    {'3': {'avg_iou': 0.43945688,
           'avg_obj': 0.09278868,
           'box_loss': 0.012789425,
           'class_loss': 0.0067381044,
           'conf_loss': 0.02088749,
           'precision50': 0.20753276,
           'recall50': 0.05099026},
     '4': {'avg_iou': 0.6193387,
           'avg_obj': 0.18539265,
           'box_loss': 0.0141111035,
           'class_loss': 0.008269805,
           'conf_loss': 0.019860044,
           'precision50': 0.38641605,
           'recall50': 0.12770365},
     '5': {'avg_iou': 0.6739108,
           'avg_obj': 0.27347535,
           'box_loss': 0.014293065,
           'class_loss': 0.009092416,
           'conf_loss': 0.016601011,
           'precision50': 0.5090621,
           'recall50': 0.21292971},
     'AP': 0.14938205,
     'AP50': 0.27884278,
     'AP75': 0.14056684,
     'APl': 0.19992924,
     'APm': 0.15411957,
     'APs': 0.058253743,
     'ARl': 0.470665,
     'ARm': 0.3850346,
     'ARmax1': 0.1813825,
     'ARmax10': 0.3271402,
     'ARmax100': 0.3632776,
     'ARs': 0.17237759,
     'global': {'total_loss': 0.12264252},
     'validation_loss': 0.12264252}I0521 03:47:06.949526 139680122042176 controller.py:211] train | step:  140000 | training until step 160000...
I0521 05:14:18.031092 139680122042176 controller.py:425] train | step:  150000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5663185,
           'avg_obj': 0.11587394,
           'box_loss': 0.1396128,
           'class_loss': 0.08919501,
           'conf_loss': 0.1883212,
           'precision50': 0.2284927,
           'recall50': 0.03891284},
     '4': {'avg_iou': 0.6659805,
           'avg_obj': 0.20739838,
           'box_loss': 0.12307938,
           'class_loss': 0.0927328,
           'conf_loss': 0.1730153,
           'precision50': 0.47201422,
           'recall50': 0.12582818},
     '5': {'avg_iou': 0.7151799,
           'avg_obj': 0.30498767,
           'box_loss': 0.11223463,
           'class_loss': 0.09302914,
           'conf_loss': 0.11143411,
           'precision50': 0.5757537,
           'recall50': 0.2421313},
     'global': {'total_loss': 1.122652},
     'learning_rate': 0.007171291,
     'training_loss': 1.122652}
I0521 05:15:17.457515 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-150000.
I0521 06:47:39.229449 139680122042176 controller.py:425] train | step:  160000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5692967,
           'avg_obj': 0.119556494,
           'box_loss': 0.13851245,
           'class_loss': 0.087584645,
           'conf_loss': 0.18833387,
           'precision50': 0.23850393,
           'recall50': 0.04187696},
     '4': {'avg_iou': 0.6690269,
           'avg_obj': 0.21247053,
           'box_loss': 0.12178032,
           'class_loss': 0.0908689,
           'conf_loss': 0.1725028,
           'precision50': 0.4820715,
           'recall50': 0.13192882},
     '5': {'avg_iou': 0.7183829,
           'avg_obj': 0.3110432,
           'box_loss': 0.11082007,
           'class_loss': 0.09090443,
           'conf_loss': 0.11062651,
           'precision50': 0.5839022,
           'recall50': 0.25075904},
     'global': {'total_loss': 1.1119319},
     'learning_rate': 0.0068427175,
     'training_loss': 1.1119319}
I0521 06:48:44.000509 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-160000.
I0521 06:48:44.007100 139680122042176 controller.py:252]  eval | step:  160000 | running 625 steps of evaluation...
I0521 06:52:52.117232 139680122042176 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0521 06:56:51.830157 139680122042176 controller.py:261]  eval | step:  160000 | eval time:  487.8 sec | output: 
    {'3': {'avg_iou': 0.4426073,
           'avg_obj': 0.09843757,
           'box_loss': 0.012626448,
           'class_loss': 0.006477853,
           'conf_loss': 0.02067888,
           'precision50': 0.22557198,
           'recall50': 0.05760003},
     '4': {'avg_iou': 0.6248092,
           'avg_obj': 0.19617729,
           'box_loss': 0.013825909,
           'class_loss': 0.007840278,
           'conf_loss': 0.019624528,
           'precision50': 0.41032836,
           'recall50': 0.14004986},
     '5': {'avg_iou': 0.6807847,
           'avg_obj': 0.28776193,
           'box_loss': 0.013935672,
           'class_loss': 0.008582785,
           'conf_loss': 0.016402498,
           'precision50': 0.5383848,
           'recall50': 0.23434131},
     'AP': 0.1620272,
     'AP50': 0.29721978,
     'AP75': 0.15679625,
     'APl': 0.21758689,
     'APm': 0.16637814,
     'APs': 0.06505231,
     'ARl': 0.48902875,
     'ARm': 0.3978243,
     'ARmax1': 0.19086511,
     'ARmax10': 0.33801034,
     'ARmax100': 0.37592828,
     'ARs': 0.18158536,
     'global': {'total_loss': 0.11999479},
     'validation_loss': 0.11999479}
I0521 06:57:14.305509 139680122042176 controller.py:211] train | step:  160000 | training until step 180000...
I0521 08:20:07.750203 139680122042176 controller.py:425] train | step:  170000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.57163465,
           'avg_obj': 0.122522704,
           'box_loss': 0.1376898,
           'class_loss': 0.08637263,
           'conf_loss': 0.18714729,
           'precision50': 0.2455463,
           'recall50': 0.04366316},
     '4': {'avg_iou': 0.6720645,
           'avg_obj': 0.21697758,
           'box_loss': 0.120531335,
           'class_loss': 0.08907512,
           'conf_loss': 0.17122117,
           'precision50': 0.49040025,
           'recall50': 0.13757119},
     '5': {'avg_iou': 0.72162116,
           'avg_obj': 0.3166703,
           'box_loss': 0.10941604,
           'class_loss': 0.089013174,
           'conf_loss': 0.109809205,
           'precision50': 0.59178233,
           'recall50': 0.2599661},
     'global': {'total_loss': 1.1002773},
     'learning_rate': 0.0065080714,
     'training_loss': 1.1002773}
I0521 08:21:06.166656 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-170000.
I0521 09:50:53.046963 139680122042176 controller.py:425] train | step:  180000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5741189,
           'avg_obj': 0.12549448,
           'box_loss': 0.13699612,
           'class_loss': 0.08521573,
           'conf_loss': 0.18687543,
           'precision50': 0.25220877,
           'recall50': 0.04586434},
     '4': {'avg_iou': 0.6747768,
           'avg_obj': 0.22119036,
           'box_loss': 0.11951205,
           'class_loss': 0.08738133,
           'conf_loss': 0.17087406,
           'precision50': 0.49869025,
           'recall50': 0.1431614},
     '5': {'avg_iou': 0.72382724,
           'avg_obj': 0.32102686,
           'box_loss': 0.10850324,
           'class_loss': 0.08733157,
           'conf_loss': 0.10941181,
           'precision50': 0.5974289,
           'recall50': 0.26622564},
     'global': {'total_loss': 1.0921034},
     'learning_rate': 0.0061697643,
     'training_loss': 1.0921034}
I0521 09:51:52.574291 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-180000.
I0521 09:51:52.580855 139680122042176 controller.py:252]  eval | step:  180000 | running 625 steps of evaluation...
I0521 09:56:14.566857 139680122042176 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0521 10:00:28.167110 139680122042176 controller.py:261]  eval | step:  180000 | eval time:  515.6 sec | output: 
    {'3': {'avg_iou': 0.44574517,
           'avg_obj': 0.10255711,
           'box_loss': 0.012464656,
           'class_loss': 0.0062596193,
           'conf_loss': 0.020498745,
           'precision50': 0.23239909,
           'recall50': 0.061680354},
     '4': {'avg_iou': 0.6294865,
           'avg_obj': 0.20393132,
           'box_loss': 0.013582608,
           'class_loss': 0.007505994,
           'conf_loss': 0.019408735,
           'precision50': 0.4301006,
           'recall50': 0.1511371},
     '5': {'avg_iou': 0.6862223,
           'avg_obj': 0.29710475,
           'box_loss': 0.01365309,
           'class_loss': 0.00818167,
           'conf_loss': 0.016176805,
           'precision50': 0.55647826,
           'recall50': 0.24871597},
     'AP': 0.17336792,
     'AP50': 0.31375444,
     'AP75': 0.17150372,
     'APl': 0.23433444,
     'APm': 0.17820562,
     'APs': 0.06983049,
     'ARl': 0.5034151,
     'ARm': 0.40827632,
     'ARmax1': 0.19860621,
     'ARmax10': 0.34820443,
     'ARmax100': 0.38607132,
     'ARs': 0.18676066,
     'global': {'total_loss': 0.11773192},
     'validation_loss': 0.11773192}

train | step:  140000 | training until step 160000...
train | step:  150000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5663185,
           'avg_obj': 0.11587394,
           'box_loss': 0.1396128,
           'class_loss': 0.08919501,
           'conf_loss': 0.1883212,
           'precision50': 0.2284927,
           'recall50': 0.03891284},
     '4': {'avg_iou': 0.6659805,
           'avg_obj': 0.20739838,
           'box_loss': 0.12307938,
           'class_loss': 0.0927328,
           'conf_loss': 0.1730153,
           'precision50': 0.47201422,
           'recall50': 0.12582818},
     '5': {'avg_iou': 0.7151799,
           'avg_obj': 0.30498767,
           'box_loss': 0.11223463,
           'class_loss': 0.09302914,
           'conf_loss': 0.11143411,
           'precision50': 0.5757537,
           'recall50': 0.2421313},
     'global': {'total_loss': 1.122652},
     'learning_rate': 0.007171291,
     'training_loss': 1.122652}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-150000.
train | step:  160000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5692967,
           'avg_obj': 0.119556494,
           'box_loss': 0.13851245,
           'class_loss': 0.087584645,
           'conf_loss': 0.18833387,
           'precision50': 0.23850393,
           'recall50': 0.04187696},
     '4': {'avg_iou': 0.6690269,
           'avg_obj': 0.21247053,
           'box_loss': 0.12178032,
           'class_loss': 0.0908689,
           'conf_loss': 0.1725028,
           'precision50': 0.4820715,
           'recall50': 0.13192882},
     '5': {'avg_iou': 0.7183829,
           'avg_obj': 0.3110432,
           'box_loss': 0.11082007,
           'class_loss': 0.09090443,
           'conf_loss': 0.11062651,
           'precision50': 0.5839022,
           'recall50': 0.25075904},
     'global': {'total_loss': 1.1119319},
     'learning_rate': 0.0068427175,
     'training_loss': 1.1119319}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-160000.
 eval | step:  160000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=167.87s).
Accumulating evaluation results...
DONE (t=21.77s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.162
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.297
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.157
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.065
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.166
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.218
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.191
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.338
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.376
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.182
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.398
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.489
 eval | step:  160000 | eval time:  487.8 sec | output: 
    {'3': {'avg_iou': 0.4426073,
           'avg_obj': 0.09843757,
           'box_loss': 0.012626448,
           'class_loss': 0.006477853,
           'conf_loss': 0.02067888,
           'precision50': 0.22557198,
           'recall50': 0.05760003},
     '4': {'avg_iou': 0.6248092,
           'avg_obj': 0.19617729,
           'box_loss': 0.013825909,
           'class_loss': 0.007840278,
           'conf_loss': 0.019624528,
           'precision50': 0.41032836,
           'recall50': 0.14004986},
     '5': {'avg_iou': 0.6807847,
           'avg_obj': 0.28776193,
           'box_loss': 0.013935672,
           'class_loss': 0.008582785,
           'conf_loss': 0.016402498,
           'precision50': 0.5383848,
           'recall50': 0.23434131},
     'AP': 0.1620272,
     'AP50': 0.29721978,
     'AP75': 0.15679625,
     'APl': 0.21758689,
     'APm': 0.16637814,
     'APs': 0.06505231,
     'ARl': 0.48902875,
     'ARm': 0.3978243,
     'ARmax1': 0.19086511,
     'ARmax10': 0.33801034,
     'ARmax100': 0.37592828,
     'ARs': 0.18158536,
     'global': {'total_loss': 0.11999479},
     'validation_loss': 0.11999479}
train | step:  160000 | training until step 180000...
train | step:  170000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.57163465,
           'avg_obj': 0.122522704,
           'box_loss': 0.1376898,
           'class_loss': 0.08637263,
           'conf_loss': 0.18714729,
           'precision50': 0.2455463,
           'recall50': 0.04366316},
     '4': {'avg_iou': 0.6720645,
           'avg_obj': 0.21697758,
           'box_loss': 0.120531335,
           'class_loss': 0.08907512,
           'conf_loss': 0.17122117,
           'precision50': 0.49040025,
           'recall50': 0.13757119},
     '5': {'avg_iou': 0.72162116,
           'avg_obj': 0.3166703,
           'box_loss': 0.10941604,
           'class_loss': 0.089013174,
           'conf_loss': 0.109809205,
           'precision50': 0.59178233,
           'recall50': 0.2599661},
     'global': {'total_loss': 1.1002773},
     'learning_rate': 0.0065080714,
     'training_loss': 1.1002773}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-170000.
train | step:  180000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5741189,
           'avg_obj': 0.12549448,
           'box_loss': 0.13699612,
           'class_loss': 0.08521573,
           'conf_loss': 0.18687543,
           'precision50': 0.25220877,
           'recall50': 0.04586434},
     '4': {'avg_iou': 0.6747768,
           'avg_obj': 0.22119036,
           'box_loss': 0.11951205,
           'class_loss': 0.08738133,
           'conf_loss': 0.17087406,
           'precision50': 0.49869025,
           'recall50': 0.1431614},
     '5': {'avg_iou': 0.72382724,
           'avg_obj': 0.32102686,
           'box_loss': 0.10850324,
           'class_loss': 0.08733157,
           'conf_loss': 0.10941181,
           'precision50': 0.5974289,
           'recall50': 0.26622564},
     'global': {'total_loss': 1.0921034},
     'learning_rate': 0.0061697643,
     'training_loss': 1.0921034}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-180000.
 eval | step:  180000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=172.66s).
Accumulating evaluation results...
DONE (t=21.53s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.173
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.314
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.172
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.070
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.178
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.234
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.199
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.348
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.386
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.187
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.408
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.503
 eval | step:  180000 | eval time:  515.6 sec | output: 
    {'3': {'avg_iou': 0.44574517,
           'avg_obj': 0.10255711,
           'box_loss': 0.012464656,
           'class_loss': 0.0062596193,
           'conf_loss': 0.020498745,
           'precision50': 0.23239909,
           'recall50': 0.061680354},
     '4': {'avg_iou': 0.6294865,
           'avg_obj': 0.20393132,
           'box_loss': 0.013582608,
           'class_loss': 0.007505994,
           'conf_loss': 0.019408735,
           'precision50': 0.4301006,
           'recall50': 0.1511371},
     '5': {'avg_iou': 0.6862223,
           'avg_obj': 0.29710475,
           'box_loss': 0.01365309,
           'class_loss': 0.00818167,
           'conf_loss': 0.016176805,
           'precision50': 0.55647826,
           'recall50': 0.24871597},
     'AP': 0.17336792,
     'AP50': 0.31375444,
     'AP75': 0.17150372,
     'APl': 0.23433444,
     'APm': 0.17820562,
     'APs': 0.06983049,
     'ARl': 0.5034151,
     'ARm': 0.40827632,
     'ARmax1': 0.19860621,
     'ARmax10': 0.34820443,
     'ARmax100': 0.38607132,
     'ARs': 0.18676066,
     'global': {'total_loss': 0.11773192},
     'validation_loss': 0.11773192}I0521 10:00:47.165282 139680122042176 controller.py:211] train | step:  180000 | training until step 200000...
I0521 11:23:43.500193 139680122042176 controller.py:425] train | step:  190000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.57644194,
           'avg_obj': 0.12787311,
           'box_loss': 0.1359697,
           'class_loss': 0.08403065,
           'conf_loss': 0.18590038,
           'precision50': 0.25810796,
           'recall50': 0.047648046},
     '4': {'avg_iou': 0.6773221,
           'avg_obj': 0.22502102,
           'box_loss': 0.11844119,
           'class_loss': 0.08593586,
           'conf_loss': 0.16993032,
           'precision50': 0.5052427,
           'recall50': 0.14807482},
     '5': {'avg_iou': 0.7264248,
           'avg_obj': 0.32604852,
           'box_loss': 0.1073875,
           'class_loss': 0.085759036,
           'conf_loss': 0.10873394,
           'precision50': 0.6037968,
           'recall50': 0.27387857},
     'global': {'total_loss': 1.0820882},
     'learning_rate': 0.0058302353,
     'training_loss': 1.0820882}
I0521 11:24:44.119244 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-190000.
I0521 12:54:56.956618 139680122042176 controller.py:425] train | step:  200000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5784738,
           'avg_obj': 0.13057089,
           'box_loss': 0.13530536,
           'class_loss': 0.0828233,
           'conf_loss': 0.18549085,
           'precision50': 0.26387858,
           'recall50': 0.049704414},
     '4': {'avg_iou': 0.6797949,
           'avg_obj': 0.22891682,
           'box_loss': 0.11750394,
           'class_loss': 0.08436802,
           'conf_loss': 0.16939875,
           'precision50': 0.51167375,
           'recall50': 0.1525057},
     '5': {'avg_iou': 0.72871745,
           'avg_obj': 0.32965162,
           'box_loss': 0.10645948,
           'class_loss': 0.08426408,
           'conf_loss': 0.1083679,
           'precision50': 0.60767776,
           'recall50': 0.27896208},
     'global': {'total_loss': 1.0739844},
     'learning_rate': 0.005491929,
     'training_loss': 1.0739844}
I0521 12:55:55.524090 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-200000.
I0521 12:55:55.530515 139680122042176 controller.py:252]  eval | step:  200000 | running 625 steps of evaluation...
I0521 13:00:17.048257 139680122042176 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0521 13:04:29.390705 139680122042176 controller.py:261]  eval | step:  200000 | eval time:  513.9 sec | output: 
    {'3': {'avg_iou': 0.44851598,
           'avg_obj': 0.106576145,
           'box_loss': 0.012320746,
           'class_loss': 0.0060761604,
           'conf_loss': 0.02034985,
           'precision50': 0.24379158,
           'recall50': 0.06574791},
     '4': {'avg_iou': 0.6331975,
           'avg_obj': 0.21217683,
           'box_loss': 0.013389172,
           'class_loss': 0.007202791,
           'conf_loss': 0.019242393,
           'precision50': 0.44515365,
           'recall50': 0.16137588},
     '5': {'avg_iou': 0.69073313,
           'avg_obj': 0.30635244,
           'box_loss': 0.013416991,
           'class_loss': 0.007855816,
           'conf_loss': 0.015998513,
           'precision50': 0.5702567,
           'recall50': 0.26320636},
     'AP': 0.1831477,
     'AP50': 0.32951337,
     'AP75': 0.18030167,
     'APl': 0.25005198,
     'APm': 0.18720429,
     'APs': 0.07565516,
     'ARl': 0.5144826,
     'ARm': 0.41752192,
     'ARmax1': 0.20457481,
     'ARmax10': 0.35602126,
     'ARmax100': 0.39496055,
     'ARs': 0.19718105,
     'global': {'total_loss': 0.115852416},
     'validation_loss': 0.115852416}
I0521 13:04:47.510469 139680122042176 controller.py:211] train | step:  200000 | training until step 220000...
I0521 14:27:43.529621 139680122042176 controller.py:425] train | step:  210000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.579883,
           'avg_obj': 0.13291323,
           'box_loss': 0.13487174,
           'class_loss': 0.08189521,
           'conf_loss': 0.18521398,
           'precision50': 0.26948535,
           'recall50': 0.051474474},
     '4': {'avg_iou': 0.68165964,
           'avg_obj': 0.23220618,
           'box_loss': 0.11681683,
           'class_loss': 0.08314159,
           'conf_loss': 0.16904126,
           'precision50': 0.5180663,
           'recall50': 0.15703149},
     '5': {'avg_iou': 0.73088807,
           'avg_obj': 0.33396864,
           'box_loss': 0.10558186,
           'class_loss': 0.082970686,
           'conf_loss': 0.10802117,
           'precision50': 0.6140127,
           'recall50': 0.2858304},
     'global': {'total_loss': 1.0675541},
     'learning_rate': 0.005157283,
     'training_loss': 1.0675541}
I0521 14:28:43.009897 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-210000.
I0521 15:58:44.615593 139680122042176 controller.py:425] train | step:  220000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.58176,
           'avg_obj': 0.13521026,
           'box_loss': 0.13433449,
           'class_loss': 0.08100906,
           'conf_loss': 0.18426685,
           'precision50': 0.27434406,
           'recall50': 0.053290173},
     '4': {'avg_iou': 0.6841275,
           'avg_obj': 0.23569651,
           'box_loss': 0.115781285,
           'class_loss': 0.08196645,
           'conf_loss': 0.16808942,
           'precision50': 0.52320135,
           'recall50': 0.16159293},
     '5': {'avg_iou': 0.73311484,
           'avg_obj': 0.33772996,
           'box_loss': 0.104553185,
           'class_loss': 0.081707604,
           'conf_loss': 0.10740427,
           'precision50': 0.617112,
           'recall50': 0.29135975},
     'global': {'total_loss': 1.059112},
     'learning_rate': 0.0048287087,
     'training_loss': 1.059112}
I0521 15:59:45.348592 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-220000.
I0521 15:59:45.354573 139680122042176 controller.py:252]  eval | step:  220000 | running 625 steps of evaluation...
I0521 16:04:00.468235 139680122042176 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0521 16:08:08.603899 139680122042176 controller.py:261]  eval | step:  220000 | eval time:  503.2 sec | output: 
    {'3': {'avg_iou': 0.45075226,
           'avg_obj': 0.10943196,
           'box_loss': 0.012206624,
           'class_loss': 0.0059182635,
           'conf_loss': 0.020238051,
           'precision50': 0.2527618,
           'recall50': 0.06919302},
     '4': {'avg_iou': 0.63660353,
           'avg_obj': 0.21873584,
           'box_loss': 0.013212553,
           'class_loss': 0.006981623,
           'conf_loss': 0.019102417,
           'precision50': 0.45547545,
           'recall50': 0.16983773},
     '5': {'avg_iou': 0.6945763,
           'avg_obj': 0.31439146,
           'box_loss': 0.013216452,
           'class_loss': 0.007582575,
           'conf_loss': 0.015868409,
           'precision50': 0.5819317,
           'recall50': 0.2737173},
     'AP': 0.19116673,
     'AP50': 0.34168512,
     'AP75': 0.1878422,
     'APl': 0.2621724,
     'APm': 0.19496723,
     'APs': 0.07498858,
     'ARl': 0.5216117,
     'ARm': 0.4233621,
     'ARmax1': 0.20835987,
     'ARmax10': 0.36101615,
     'ARmax100': 0.40141433,
     'ARs': 0.20128928,
     'global': {'total_loss': 0.11432692},
     'validation_loss': 0.11432692}

train | step:  180000 | training until step 200000...
train | step:  190000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.57644194,
           'avg_obj': 0.12787311,
           'box_loss': 0.1359697,
           'class_loss': 0.08403065,
           'conf_loss': 0.18590038,
           'precision50': 0.25810796,
           'recall50': 0.047648046},
     '4': {'avg_iou': 0.6773221,
           'avg_obj': 0.22502102,
           'box_loss': 0.11844119,
           'class_loss': 0.08593586,
           'conf_loss': 0.16993032,
           'precision50': 0.5052427,
           'recall50': 0.14807482},
     '5': {'avg_iou': 0.7264248,
           'avg_obj': 0.32604852,
           'box_loss': 0.1073875,
           'class_loss': 0.085759036,
           'conf_loss': 0.10873394,
           'precision50': 0.6037968,
           'recall50': 0.27387857},
     'global': {'total_loss': 1.0820882},
     'learning_rate': 0.0058302353,
     'training_loss': 1.0820882}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-190000.
train | step:  200000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5784738,
           'avg_obj': 0.13057089,
           'box_loss': 0.13530536,
           'class_loss': 0.0828233,
           'conf_loss': 0.18549085,
           'precision50': 0.26387858,
           'recall50': 0.049704414},
     '4': {'avg_iou': 0.6797949,
           'avg_obj': 0.22891682,
           'box_loss': 0.11750394,
           'class_loss': 0.08436802,
           'conf_loss': 0.16939875,
           'precision50': 0.51167375,
           'recall50': 0.1525057},
     '5': {'avg_iou': 0.72871745,
           'avg_obj': 0.32965162,
           'box_loss': 0.10645948,
           'class_loss': 0.08426408,
           'conf_loss': 0.1083679,
           'precision50': 0.60767776,
           'recall50': 0.27896208},
     'global': {'total_loss': 1.0739844},
     'learning_rate': 0.005491929,
     'training_loss': 1.0739844}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-200000.
 eval | step:  200000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=173.77s).
Accumulating evaluation results...
DONE (t=21.24s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.183
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.330
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.180
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.076
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.187
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.250
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.205
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.356
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.395
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.197
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.418
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.514
 eval | step:  200000 | eval time:  513.9 sec | output: 
    {'3': {'avg_iou': 0.44851598,
           'avg_obj': 0.106576145,
           'box_loss': 0.012320746,
           'class_loss': 0.0060761604,
           'conf_loss': 0.02034985,
           'precision50': 0.24379158,
           'recall50': 0.06574791},
     '4': {'avg_iou': 0.6331975,
           'avg_obj': 0.21217683,
           'box_loss': 0.013389172,
           'class_loss': 0.007202791,
           'conf_loss': 0.019242393,
           'precision50': 0.44515365,
           'recall50': 0.16137588},
     '5': {'avg_iou': 0.69073313,
           'avg_obj': 0.30635244,
           'box_loss': 0.013416991,
           'class_loss': 0.007855816,
           'conf_loss': 0.015998513,
           'precision50': 0.5702567,
           'recall50': 0.26320636},
     'AP': 0.1831477,
     'AP50': 0.32951337,
     'AP75': 0.18030167,
     'APl': 0.25005198,
     'APm': 0.18720429,
     'APs': 0.07565516,
     'ARl': 0.5144826,
     'ARm': 0.41752192,
     'ARmax1': 0.20457481,
     'ARmax10': 0.35602126,
     'ARmax100': 0.39496055,
     'ARs': 0.19718105,
     'global': {'total_loss': 0.115852416},
     'validation_loss': 0.115852416}
train | step:  200000 | training until step 220000...
train | step:  210000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.579883,
           'avg_obj': 0.13291323,
           'box_loss': 0.13487174,
           'class_loss': 0.08189521,
           'conf_loss': 0.18521398,
           'precision50': 0.26948535,
           'recall50': 0.051474474},
     '4': {'avg_iou': 0.68165964,
           'avg_obj': 0.23220618,
           'box_loss': 0.11681683,
           'class_loss': 0.08314159,
           'conf_loss': 0.16904126,
           'precision50': 0.5180663,
           'recall50': 0.15703149},
     '5': {'avg_iou': 0.73088807,
           'avg_obj': 0.33396864,
           'box_loss': 0.10558186,
           'class_loss': 0.082970686,
           'conf_loss': 0.10802117,
           'precision50': 0.6140127,
           'recall50': 0.2858304},
     'global': {'total_loss': 1.0675541},
     'learning_rate': 0.005157283,
     'training_loss': 1.0675541}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-210000.
train | step:  220000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.58176,
           'avg_obj': 0.13521026,
           'box_loss': 0.13433449,
           'class_loss': 0.08100906,
           'conf_loss': 0.18426685,
           'precision50': 0.27434406,
           'recall50': 0.053290173},
     '4': {'avg_iou': 0.6841275,
           'avg_obj': 0.23569651,
           'box_loss': 0.115781285,
           'class_loss': 0.08196645,
           'conf_loss': 0.16808942,
           'precision50': 0.52320135,
           'recall50': 0.16159293},
     '5': {'avg_iou': 0.73311484,
           'avg_obj': 0.33772996,
           'box_loss': 0.104553185,
           'class_loss': 0.081707604,
           'conf_loss': 0.10740427,
           'precision50': 0.617112,
           'recall50': 0.29135975},
     'global': {'total_loss': 1.059112},
     'learning_rate': 0.0048287087,
     'training_loss': 1.059112}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-220000.
 eval | step:  220000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=169.70s).
Accumulating evaluation results...
DONE (t=20.23s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.191
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.342
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.188
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.075
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.195
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.262
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.208
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.361
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.401
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.201
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.423
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.522
 eval | step:  220000 | eval time:  503.2 sec | output: 
    {'3': {'avg_iou': 0.45075226,
           'avg_obj': 0.10943196,
           'box_loss': 0.012206624,
           'class_loss': 0.0059182635,
           'conf_loss': 0.020238051,
           'precision50': 0.2527618,
           'recall50': 0.06919302},
     '4': {'avg_iou': 0.63660353,
           'avg_obj': 0.21873584,
           'box_loss': 0.013212553,
           'class_loss': 0.006981623,
           'conf_loss': 0.019102417,
           'precision50': 0.45547545,
           'recall50': 0.16983773},
     '5': {'avg_iou': 0.6945763,
           'avg_obj': 0.31439146,
           'box_loss': 0.013216452,
           'class_loss': 0.007582575,
           'conf_loss': 0.015868409,
           'precision50': 0.5819317,
           'recall50': 0.2737173},
     'AP': 0.19116673,
     'AP50': 0.34168512,
     'AP75': 0.1878422,
     'APl': 0.2621724,
     'APm': 0.19496723,
     'APs': 0.07498858,
     'ARl': 0.5216117,
     'ARm': 0.4233621,
     'ARmax1': 0.20835987,
     'ARmax10': 0.36101615,
     'ARmax100': 0.40141433,
     'ARs': 0.20128928,
     'global': {'total_loss': 0.11432692},
     'validation_loss': 0.11432692}I0521 16:08:32.554023 139680122042176 controller.py:211] train | step:  220000 | training until step 240000...
I0521 17:31:50.587072 139680122042176 controller.py:425] train | step:  230000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5834764,
           'avg_obj': 0.13780291,
           'box_loss': 0.13363498,
           'class_loss': 0.08000521,
           'conf_loss': 0.18392643,
           'precision50': 0.28083703,
           'recall50': 0.05542447},
     '4': {'avg_iou': 0.6861975,
           'avg_obj': 0.2388778,
           'box_loss': 0.11501664,
           'class_loss': 0.08084884,
           'conf_loss': 0.1674779,
           'precision50': 0.5279844,
           'recall50': 0.16572547},
     '5': {'avg_iou': 0.7351567,
           'avg_obj': 0.34141633,
           'box_loss': 0.10367494,
           'class_loss': 0.08053558,
           'conf_loss': 0.106890745,
           'precision50': 0.621564,
           'recall50': 0.29681823},
     'global': {'total_loss': 1.0520111},
     'learning_rate': 0.004508574,
     'training_loss': 1.0520111}
I0521 17:32:50.079481 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-230000.
I0521 19:02:33.043748 139680122042176 controller.py:425] train | step:  240000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.58536226,
           'avg_obj': 0.13940564,
           'box_loss': 0.1329797,
           'class_loss': 0.07909064,
           'conf_loss': 0.18332413,
           'precision50': 0.28434628,
           'recall50': 0.056304168},
     '4': {'avg_iou': 0.6875242,
           'avg_obj': 0.24182531,
           'box_loss': 0.11435593,
           'class_loss': 0.07964174,
           'conf_loss': 0.16705854,
           'precision50': 0.53232056,
           'recall50': 0.16904369},
     '5': {'avg_iou': 0.73663986,
           'avg_obj': 0.34472024,
           'box_loss': 0.10312276,
           'class_loss': 0.07939429,
           'conf_loss': 0.10656001,
           'precision50': 0.62555385,
           'recall50': 0.30167186},
     'global': {'total_loss': 1.0455265},
     'learning_rate': 0.0041991845,
     'training_loss': 1.0455265}
I0521 19:03:31.417584 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-240000.
I0521 19:03:31.424607 139680122042176 controller.py:252]  eval | step:  240000 | running 625 steps of evaluation...
I0521 19:07:41.228169 139680122042176 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0521 19:11:48.925392 139680122042176 controller.py:261]  eval | step:  240000 | eval time:  497.5 sec | output: 
    {'3': {'avg_iou': 0.45247203,
           'avg_obj': 0.11242559,
           'box_loss': 0.012116711,
           'class_loss': 0.005788347,
           'conf_loss': 0.020121535,
           'precision50': 0.25778893,
           'recall50': 0.07261572},
     '4': {'avg_iou': 0.63922924,
           'avg_obj': 0.22420962,
           'box_loss': 0.013074865,
           'class_loss': 0.0067853243,
           'conf_loss': 0.018964965,
           'precision50': 0.46327528,
           'recall50': 0.17828071},
     '5': {'avg_iou': 0.6979501,
           'avg_obj': 0.3215913,
           'box_loss': 0.013039806,
           'class_loss': 0.007367842,
           'conf_loss': 0.015736008,
           'precision50': 0.5918824,
           'recall50': 0.28457493},
     'AP': 0.19812028,
     'AP50': 0.35249063,
     'AP75': 0.19771096,
     'APl': 0.27215144,
     'APm': 0.20029445,
     'APs': 0.07710998,
     'ARl': 0.52950805,
     'ARm': 0.43140578,
     'ARmax1': 0.21607538,
     'ARmax10': 0.3679683,
     'ARmax100': 0.40769857,
     'ARs': 0.20423003,
     'global': {'total_loss': 0.11299541},
     'validation_loss': 0.11299541}
I0521 19:12:11.405834 139680122042176 controller.py:211] train | step:  240000 | training until step 260000...
I0521 20:34:31.553163 139680122042176 controller.py:425] train | step:  250000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.58617234,
           'avg_obj': 0.14134143,
           'box_loss': 0.13267581,
           'class_loss': 0.078572966,
           'conf_loss': 0.18334502,
           'precision50': 0.2890744,
           'recall50': 0.057930134},
     '4': {'avg_iou': 0.6893697,
           'avg_obj': 0.2447031,
           'box_loss': 0.11377764,
           'class_loss': 0.078829415,
           'conf_loss': 0.16646598,
           'precision50': 0.5381746,
           'recall50': 0.1731115},
     '5': {'avg_iou': 0.7386237,
           'avg_obj': 0.34805644,
           'box_loss': 0.10223774,
           'class_loss': 0.07833705,
           'conf_loss': 0.10604165,
           'precision50': 0.62916744,
           'recall50': 0.3065779},
     'global': {'total_loss': 1.0402834},
     'learning_rate': 0.0039027706,
     'training_loss': 1.0402834}
I0521 20:35:30.007628 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-250000.
I0521 22:03:53.043217 139680122042176 controller.py:425] train | step:  260000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.5881399,
           'avg_obj': 0.14351906,
           'box_loss': 0.13195477,
           'class_loss': 0.07758943,
           'conf_loss': 0.18223648,
           'precision50': 0.29328805,
           'recall50': 0.059857372},
     '4': {'avg_iou': 0.6912602,
           'avg_obj': 0.24754436,
           'box_loss': 0.11293565,
           'class_loss': 0.077724144,
           'conf_loss': 0.16567679,
           'precision50': 0.5420463,
           'recall50': 0.17692737},
     '5': {'avg_iou': 0.7401679,
           'avg_obj': 0.3510283,
           'box_loss': 0.10163031,
           'class_loss': 0.07741849,
           'conf_loss': 0.10557312,
           'precision50': 0.63189197,
           'recall50': 0.31093264},
     'global': {'total_loss': 1.0327398},
     'learning_rate': 0.0036214672,
     'training_loss': 1.0327398}
I0521 22:05:02.719121 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-260000.
I0521 22:05:02.725109 139680122042176 controller.py:252]  eval | step:  260000 | running 625 steps of evaluation...
I0521 22:09:15.498893 139680122042176 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0521 22:13:16.451925 139680122042176 controller.py:261]  eval | step:  260000 | eval time:  493.7 sec | output: 
    {'3': {'avg_iou': 0.45381987,
           'avg_obj': 0.11503488,
           'box_loss': 0.01204753,
           'class_loss': 0.005683207,
           'conf_loss': 0.02007602,
           'precision50': 0.26521283,
           'recall50': 0.075574614},
     '4': {'avg_iou': 0.64127326,
           'avg_obj': 0.22970986,
           'box_loss': 0.012970009,
           'class_loss': 0.0066476204,
           'conf_loss': 0.018885009,
           'precision50': 0.47409502,
           'recall50': 0.18524577},
     '5': {'avg_iou': 0.7003161,
           'avg_obj': 0.3280932,
           'box_loss': 0.012917529,
           'class_loss': 0.007211851,
           'conf_loss': 0.015651783,
           'precision50': 0.6014608,
           'recall50': 0.29359484},
     'AP': 0.20335713,
     'AP50': 0.36080685,
     'AP75': 0.20219105,
     'APl': 0.2855299,
     'APm': 0.20555076,
     'APs': 0.079159394,
     'ARl': 0.53629464,
     'ARm': 0.43774948,
     'ARmax1': 0.21791956,
     'ARmax10': 0.37293792,
     'ARmax100': 0.41287684,
     'ARs': 0.20903803,
     'global': {'total_loss': 0.11209055},
     'validation_loss': 0.11209055}

train | step:  220000 | training until step 240000...
train | step:  230000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5834764,
           'avg_obj': 0.13780291,
           'box_loss': 0.13363498,
           'class_loss': 0.08000521,
           'conf_loss': 0.18392643,
           'precision50': 0.28083703,
           'recall50': 0.05542447},
     '4': {'avg_iou': 0.6861975,
           'avg_obj': 0.2388778,
           'box_loss': 0.11501664,
           'class_loss': 0.08084884,
           'conf_loss': 0.1674779,
           'precision50': 0.5279844,
           'recall50': 0.16572547},
     '5': {'avg_iou': 0.7351567,
           'avg_obj': 0.34141633,
           'box_loss': 0.10367494,
           'class_loss': 0.08053558,
           'conf_loss': 0.106890745,
           'precision50': 0.621564,
           'recall50': 0.29681823},
     'global': {'total_loss': 1.0520111},
     'learning_rate': 0.004508574,
     'training_loss': 1.0520111}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-230000.
train | step:  240000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.58536226,
           'avg_obj': 0.13940564,
           'box_loss': 0.1329797,
           'class_loss': 0.07909064,
           'conf_loss': 0.18332413,
           'precision50': 0.28434628,
           'recall50': 0.056304168},
     '4': {'avg_iou': 0.6875242,
           'avg_obj': 0.24182531,
           'box_loss': 0.11435593,
           'class_loss': 0.07964174,
           'conf_loss': 0.16705854,
           'precision50': 0.53232056,
           'recall50': 0.16904369},
     '5': {'avg_iou': 0.73663986,
           'avg_obj': 0.34472024,
           'box_loss': 0.10312276,
           'class_loss': 0.07939429,
           'conf_loss': 0.10656001,
           'precision50': 0.62555385,
           'recall50': 0.30167186},
     'global': {'total_loss': 1.0455265},
     'learning_rate': 0.0041991845,
     'training_loss': 1.0455265}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-240000.
 eval | step:  240000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=174.05s).
Accumulating evaluation results...
DONE (t=20.68s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.198
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.352
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.198
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.077
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.200
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.272
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.216
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.368
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.408
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.204
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.431
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.530
 eval | step:  240000 | eval time:  497.5 sec | output: 
    {'3': {'avg_iou': 0.45247203,
           'avg_obj': 0.11242559,
           'box_loss': 0.012116711,
           'class_loss': 0.005788347,
           'conf_loss': 0.020121535,
           'precision50': 0.25778893,
           'recall50': 0.07261572},
     '4': {'avg_iou': 0.63922924,
           'avg_obj': 0.22420962,
           'box_loss': 0.013074865,
           'class_loss': 0.0067853243,
           'conf_loss': 0.018964965,
           'precision50': 0.46327528,
           'recall50': 0.17828071},
     '5': {'avg_iou': 0.6979501,
           'avg_obj': 0.3215913,
           'box_loss': 0.013039806,
           'class_loss': 0.007367842,
           'conf_loss': 0.015736008,
           'precision50': 0.5918824,
           'recall50': 0.28457493},
     'AP': 0.19812028,
     'AP50': 0.35249063,
     'AP75': 0.19771096,
     'APl': 0.27215144,
     'APm': 0.20029445,
     'APs': 0.07710998,
     'ARl': 0.52950805,
     'ARm': 0.43140578,
     'ARmax1': 0.21607538,
     'ARmax10': 0.3679683,
     'ARmax100': 0.40769857,
     'ARs': 0.20423003,
     'global': {'total_loss': 0.11299541},
     'validation_loss': 0.11299541}
train | step:  240000 | training until step 260000...
train | step:  250000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.58617234,
           'avg_obj': 0.14134143,
           'box_loss': 0.13267581,
           'class_loss': 0.078572966,
           'conf_loss': 0.18334502,
           'precision50': 0.2890744,
           'recall50': 0.057930134},
     '4': {'avg_iou': 0.6893697,
           'avg_obj': 0.2447031,
           'box_loss': 0.11377764,
           'class_loss': 0.078829415,
           'conf_loss': 0.16646598,
           'precision50': 0.5381746,
           'recall50': 0.1731115},
     '5': {'avg_iou': 0.7386237,
           'avg_obj': 0.34805644,
           'box_loss': 0.10223774,
           'class_loss': 0.07833705,
           'conf_loss': 0.10604165,
           'precision50': 0.62916744,
           'recall50': 0.3065779},
     'global': {'total_loss': 1.0402834},
     'learning_rate': 0.0039027706,
     'training_loss': 1.0402834}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-250000.
train | step:  260000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.5881399,
           'avg_obj': 0.14351906,
           'box_loss': 0.13195477,
           'class_loss': 0.07758943,
           'conf_loss': 0.18223648,
           'precision50': 0.29328805,
           'recall50': 0.059857372},
     '4': {'avg_iou': 0.6912602,
           'avg_obj': 0.24754436,
           'box_loss': 0.11293565,
           'class_loss': 0.077724144,
           'conf_loss': 0.16567679,
           'precision50': 0.5420463,
           'recall50': 0.17692737},
     '5': {'avg_iou': 0.7401679,
           'avg_obj': 0.3510283,
           'box_loss': 0.10163031,
           'class_loss': 0.07741849,
           'conf_loss': 0.10557312,
           'precision50': 0.63189197,
           'recall50': 0.31093264},
     'global': {'total_loss': 1.0327398},
     'learning_rate': 0.0036214672,
     'training_loss': 1.0327398}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-260000.
 eval | step:  260000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=168.72s).
Accumulating evaluation results...
DONE (t=19.70s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.203
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.361
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.202
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.079
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.206
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.286
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.218
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.373
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.413
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.209
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.438
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.536
 eval | step:  260000 | eval time:  493.7 sec | output: 
    {'3': {'avg_iou': 0.45381987,
           'avg_obj': 0.11503488,
           'box_loss': 0.01204753,
           'class_loss': 0.005683207,
           'conf_loss': 0.02007602,
           'precision50': 0.26521283,
           'recall50': 0.075574614},
     '4': {'avg_iou': 0.64127326,
           'avg_obj': 0.22970986,
           'box_loss': 0.012970009,
           'class_loss': 0.0066476204,
           'conf_loss': 0.018885009,
           'precision50': 0.47409502,
           'recall50': 0.18524577},
     '5': {'avg_iou': 0.7003161,
           'avg_obj': 0.3280932,
           'box_loss': 0.012917529,
           'class_loss': 0.007211851,
           'conf_loss': 0.015651783,
           'precision50': 0.6014608,
           'recall50': 0.29359484},
     'AP': 0.20335713,
     'AP50': 0.36080685,
     'AP75': 0.20219105,
     'APl': 0.2855299,
     'APm': 0.20555076,
     'APs': 0.079159394,
     'ARl': 0.53629464,
     'ARm': 0.43774948,
     'ARmax1': 0.21791956,
     'ARmax10': 0.37293792,
     'ARmax100': 0.41287684,
     'ARs': 0.20903803,
     'global': {'total_loss': 0.11209055},
     'validation_loss': 0.11209055}I0521 22:13:35.876676 139680122042176 controller.py:211] train | step:  260000 | training until step 280000...
I0521 23:35:33.808011 139680122042176 controller.py:425] train | step:  270000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5893638,
           'avg_obj': 0.1449326,
           'box_loss': 0.13165644,
           'class_loss': 0.0771117,
           'conf_loss': 0.18182592,
           'precision50': 0.29605743,
           'recall50': 0.060850877},
     '4': {'avg_iou': 0.6927856,
           'avg_obj': 0.24973284,
           'box_loss': 0.11232593,
           'class_loss': 0.07687159,
           'conf_loss': 0.16533332,
           'precision50': 0.5456958,
           'recall50': 0.17994842},
     '5': {'avg_iou': 0.7417394,
           'avg_obj': 0.35398373,
           'box_loss': 0.10090724,
           'class_loss': 0.07647566,
           'conf_loss': 0.10526847,
           'precision50': 0.63558435,
           'recall50': 0.31569064},
     'global': {'total_loss': 1.027777},
     'learning_rate': 0.003357301,
     'training_loss': 1.027777}
I0521 23:36:36.609214 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-270000.
I0522 01:04:29.251774 139680122042176 controller.py:425] train | step:  280000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.59043384,
           'avg_obj': 0.14639097,
           'box_loss': 0.13138835,
           'class_loss': 0.076398075,
           'conf_loss': 0.18167172,
           'precision50': 0.29950565,
           'recall50': 0.061891235},
     '4': {'avg_iou': 0.69389564,
           'avg_obj': 0.2516291,
           'box_loss': 0.11188752,
           'class_loss': 0.07615437,
           'conf_loss': 0.16521962,
           'precision50': 0.54884285,
           'recall50': 0.18219155},
     '5': {'avg_iou': 0.7429344,
           'avg_obj': 0.35603762,
           'box_loss': 0.10047014,
           'class_loss': 0.07579065,
           'conf_loss': 0.10522851,
           'precision50': 0.6378735,
           'recall50': 0.31838006},
     'global': {'total_loss': 1.0242088},
     'learning_rate': 0.003112175,
     'training_loss': 1.0242088}
I0522 01:05:28.383002 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-280000.
I0522 01:05:28.388815 139680122042176 controller.py:252]  eval | step:  280000 | running 625 steps of evaluation...
I0522 01:09:46.257543 139680122042176 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0522 01:13:57.359612 139680122042176 controller.py:261]  eval | step:  280000 | eval time:  509.0 sec | output: 
    {'3': {'avg_iou': 0.4551211,
           'avg_obj': 0.11696556,
           'box_loss': 0.011978081,
           'class_loss': 0.0055912766,
           'conf_loss': 0.020007484,
           'precision50': 0.2720714,
           'recall50': 0.077913836},
     '4': {'avg_iou': 0.6433376,
           'avg_obj': 0.23307551,
           'box_loss': 0.012863025,
           'class_loss': 0.006520264,
           'conf_loss': 0.018799514,
           'precision50': 0.48205727,
           'recall50': 0.19040288},
     '5': {'avg_iou': 0.70258474,
           'avg_obj': 0.33295387,
           'box_loss': 0.012799483,
           'class_loss': 0.0070601786,
           'conf_loss': 0.015577823,
           'precision50': 0.60422546,
           'recall50': 0.29931575},
     'AP': 0.20876504,
     'AP50': 0.36742428,
     'AP75': 0.21005605,
     'APl': 0.29225978,
     'APm': 0.21157046,
     'APs': 0.08232977,
     'ARl': 0.5427116,
     'ARm': 0.44278654,
     'ARmax1': 0.2206781,
     'ARmax10': 0.3768311,
     'ARmax100': 0.41742867,
     'ARs': 0.21193625,
     'global': {'total_loss': 0.11119709},
     'validation_loss': 0.11119709}
I0522 01:14:15.920176 139680122042176 controller.py:211] train | step:  280000 | training until step 300000...
I0522 02:37:14.912661 139680122042176 controller.py:425] train | step:  290000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.59149706,
           'avg_obj': 0.14795859,
           'box_loss': 0.13088146,
           'class_loss': 0.07590982,
           'conf_loss': 0.18147317,
           'precision50': 0.30246705,
           'recall50': 0.06324305},
     '4': {'avg_iou': 0.69529164,
           'avg_obj': 0.25420225,
           'box_loss': 0.111313514,
           'class_loss': 0.07531524,
           'conf_loss': 0.1647704,
           'precision50': 0.55235034,
           'recall50': 0.18534674},
     '5': {'avg_iou': 0.74453497,
           'avg_obj': 0.35873085,
           'box_loss': 0.099920996,
           'class_loss': 0.07499076,
           'conf_loss': 0.104802966,
           'precision50': 0.63979274,
           'recall50': 0.32208583},
     'global': {'total_loss': 1.019379},
     'learning_rate': 0.002887857,
     'training_loss': 1.019379}
I0522 02:38:17.684190 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-290000.
I0522 04:08:07.156635 139680122042176 controller.py:425] train | step:  300000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.59242845,
           'avg_obj': 0.149505,
           'box_loss': 0.13065588,
           'class_loss': 0.07534279,
           'conf_loss': 0.18119235,
           'precision50': 0.3061797,
           'recall50': 0.06460409},
     '4': {'avg_iou': 0.6963558,
           'avg_obj': 0.25578314,
           'box_loss': 0.110922314,
           'class_loss': 0.07472197,
           'conf_loss': 0.16441812,
           'precision50': 0.5538626,
           'recall50': 0.18757194},
     '5': {'avg_iou': 0.7454911,
           'avg_obj': 0.36071962,
           'box_loss': 0.0993981,
           'class_loss': 0.07440288,
           'conf_loss': 0.10463038,
           'precision50': 0.6428065,
           'recall50': 0.32507434},
     'global': {'total_loss': 1.0156827},
     'learning_rate': 0.002685961,
     'training_loss': 1.0156827}
I0522 04:09:06.545411 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-300000.
I0522 04:09:06.552773 139680122042176 controller.py:252]  eval | step:  300000 | running 625 steps of evaluation...
I0522 04:13:32.651599 139680122042176 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0522 04:17:42.248772 139680122042176 controller.py:261]  eval | step:  300000 | eval time:  515.7 sec | output: 
    {'3': {'avg_iou': 0.45651895,
           'avg_obj': 0.11844387,
           'box_loss': 0.011906575,
           'class_loss': 0.0054964507,
           'conf_loss': 0.01992834,
           'precision50': 0.27378172,
           'recall50': 0.07917328},
     '4': {'avg_iou': 0.64514303,
           'avg_obj': 0.23609522,
           'box_loss': 0.012769718,
           'class_loss': 0.0063827364,
           'conf_loss': 0.018711928,
           'precision50': 0.4885966,
           'recall50': 0.19488852},
     '5': {'avg_iou': 0.70437396,
           'avg_obj': 0.33672684,
           'box_loss': 0.012705635,
           'class_loss': 0.0069139586,
           'conf_loss': 0.015486694,
           'precision50': 0.60910964,
           'recall50': 0.30598688},
     'AP': 0.2133818,
     'AP50': 0.37442002,
     'AP75': 0.21471958,
     'APl': 0.2959439,
     'APm': 0.21620813,
     'APs': 0.08670263,
     'ARl': 0.5475327,
     'ARm': 0.4471107,
     'ARmax1': 0.2234448,
     'ARmax10': 0.379316,
     'ARmax100': 0.4212218,
     'ARs': 0.21432506,
     'global': {'total_loss': 0.11030209},
     'validation_loss': 0.11030209}

train | step:  260000 | training until step 280000...
train | step:  270000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5893638,
           'avg_obj': 0.1449326,
           'box_loss': 0.13165644,
           'class_loss': 0.0771117,
           'conf_loss': 0.18182592,
           'precision50': 0.29605743,
           'recall50': 0.060850877},
     '4': {'avg_iou': 0.6927856,
           'avg_obj': 0.24973284,
           'box_loss': 0.11232593,
           'class_loss': 0.07687159,
           'conf_loss': 0.16533332,
           'precision50': 0.5456958,
           'recall50': 0.17994842},
     '5': {'avg_iou': 0.7417394,
           'avg_obj': 0.35398373,
           'box_loss': 0.10090724,
           'class_loss': 0.07647566,
           'conf_loss': 0.10526847,
           'precision50': 0.63558435,
           'recall50': 0.31569064},
     'global': {'total_loss': 1.027777},
     'learning_rate': 0.003357301,
     'training_loss': 1.027777}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-270000.
train | step:  280000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.59043384,
           'avg_obj': 0.14639097,
           'box_loss': 0.13138835,
           'class_loss': 0.076398075,
           'conf_loss': 0.18167172,
           'precision50': 0.29950565,
           'recall50': 0.061891235},
     '4': {'avg_iou': 0.69389564,
           'avg_obj': 0.2516291,
           'box_loss': 0.11188752,
           'class_loss': 0.07615437,
           'conf_loss': 0.16521962,
           'precision50': 0.54884285,
           'recall50': 0.18219155},
     '5': {'avg_iou': 0.7429344,
           'avg_obj': 0.35603762,
           'box_loss': 0.10047014,
           'class_loss': 0.07579065,
           'conf_loss': 0.10522851,
           'precision50': 0.6378735,
           'recall50': 0.31838006},
     'global': {'total_loss': 1.0242088},
     'learning_rate': 0.003112175,
     'training_loss': 1.0242088}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-280000.
 eval | step:  280000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=170.05s).
Accumulating evaluation results...
DONE (t=19.92s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.209
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.367
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.210
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.082
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.212
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.292
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.221
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.377
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.417
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.212
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.443
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.543
 eval | step:  280000 | eval time:  509.0 sec | output: 
    {'3': {'avg_iou': 0.4551211,
           'avg_obj': 0.11696556,
           'box_loss': 0.011978081,
           'class_loss': 0.0055912766,
           'conf_loss': 0.020007484,
           'precision50': 0.2720714,
           'recall50': 0.077913836},
     '4': {'avg_iou': 0.6433376,
           'avg_obj': 0.23307551,
           'box_loss': 0.012863025,
           'class_loss': 0.006520264,
           'conf_loss': 0.018799514,
           'precision50': 0.48205727,
           'recall50': 0.19040288},
     '5': {'avg_iou': 0.70258474,
           'avg_obj': 0.33295387,
           'box_loss': 0.012799483,
           'class_loss': 0.0070601786,
           'conf_loss': 0.015577823,
           'precision50': 0.60422546,
           'recall50': 0.29931575},
     'AP': 0.20876504,
     'AP50': 0.36742428,
     'AP75': 0.21005605,
     'APl': 0.29225978,
     'APm': 0.21157046,
     'APs': 0.08232977,
     'ARl': 0.5427116,
     'ARm': 0.44278654,
     'ARmax1': 0.2206781,
     'ARmax10': 0.3768311,
     'ARmax100': 0.41742867,
     'ARs': 0.21193625,
     'global': {'total_loss': 0.11119709},
     'validation_loss': 0.11119709}
train | step:  280000 | training until step 300000...
train | step:  290000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.59149706,
           'avg_obj': 0.14795859,
           'box_loss': 0.13088146,
           'class_loss': 0.07590982,
           'conf_loss': 0.18147317,
           'precision50': 0.30246705,
           'recall50': 0.06324305},
     '4': {'avg_iou': 0.69529164,
           'avg_obj': 0.25420225,
           'box_loss': 0.111313514,
           'class_loss': 0.07531524,
           'conf_loss': 0.1647704,
           'precision50': 0.55235034,
           'recall50': 0.18534674},
     '5': {'avg_iou': 0.74453497,
           'avg_obj': 0.35873085,
           'box_loss': 0.099920996,
           'class_loss': 0.07499076,
           'conf_loss': 0.104802966,
           'precision50': 0.63979274,
           'recall50': 0.32208583},
     'global': {'total_loss': 1.019379},
     'learning_rate': 0.002887857,
     'training_loss': 1.019379}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-290000.
train | step:  300000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.59242845,
           'avg_obj': 0.149505,
           'box_loss': 0.13065588,
           'class_loss': 0.07534279,
           'conf_loss': 0.18119235,
           'precision50': 0.3061797,
           'recall50': 0.06460409},
     '4': {'avg_iou': 0.6963558,
           'avg_obj': 0.25578314,
           'box_loss': 0.110922314,
           'class_loss': 0.07472197,
           'conf_loss': 0.16441812,
           'precision50': 0.5538626,
           'recall50': 0.18757194},
     '5': {'avg_iou': 0.7454911,
           'avg_obj': 0.36071962,
           'box_loss': 0.0993981,
           'class_loss': 0.07440288,
           'conf_loss': 0.10463038,
           'precision50': 0.6428065,
           'recall50': 0.32507434},
     'global': {'total_loss': 1.0156827},
     'learning_rate': 0.002685961,
     'training_loss': 1.0156827}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-300000.
 eval | step:  300000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=173.61s).
Accumulating evaluation results...
DONE (t=19.97s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.213
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.374
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.215
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.087
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.216
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.296
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.223
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.379
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.421
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.214
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.447
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.548
 eval | step:  300000 | eval time:  515.7 sec | output: 
    {'3': {'avg_iou': 0.45651895,
           'avg_obj': 0.11844387,
           'box_loss': 0.011906575,
           'class_loss': 0.0054964507,
           'conf_loss': 0.01992834,
           'precision50': 0.27378172,
           'recall50': 0.07917328},
     '4': {'avg_iou': 0.64514303,
           'avg_obj': 0.23609522,
           'box_loss': 0.012769718,
           'class_loss': 0.0063827364,
           'conf_loss': 0.018711928,
           'precision50': 0.4885966,
           'recall50': 0.19488852},
     '5': {'avg_iou': 0.70437396,
           'avg_obj': 0.33672684,
           'box_loss': 0.012705635,
           'class_loss': 0.0069139586,
           'conf_loss': 0.015486694,
           'precision50': 0.60910964,
           'recall50': 0.30598688},
     'AP': 0.2133818,
     'AP50': 0.37442002,
     'AP75': 0.21471958,
     'APl': 0.2959439,
     'APm': 0.21620813,
     'APs': 0.08670263,
     'ARl': 0.5475327,
     'ARm': 0.4471107,
     'ARmax1': 0.2234448,
     'ARmax10': 0.379316,
     'ARmax100': 0.4212218,
     'ARs': 0.21432506,
     'global': {'total_loss': 0.11030209},
     'validation_loss': 0.11030209}I0522 04:18:01.373665 139680122042176 controller.py:211] train | step:  300000 | training until step 320000...
I0522 05:40:43.649198 139680122042176 controller.py:425] train | step:  310000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5936844,
           'avg_obj': 0.15067355,
           'box_loss': 0.13003138,
           'class_loss': 0.074663974,
           'conf_loss': 0.18052799,
           'precision50': 0.3086983,
           'recall50': 0.06571363},
     '4': {'avg_iou': 0.69745344,
           'avg_obj': 0.25747404,
           'box_loss': 0.11044503,
           'class_loss': 0.07392606,
           'conf_loss': 0.1640299,
           'precision50': 0.5561059,
           'recall50': 0.18994252},
     '5': {'avg_iou': 0.7465254,
           'avg_obj': 0.36247736,
           'box_loss': 0.09899769,
           'class_loss': 0.07355675,
           'conf_loss': 0.10438744,
           'precision50': 0.6444936,
           'recall50': 0.32766086},
     'global': {'total_loss': 1.0105685},
     'learning_rate': 0.0025079434,
     'training_loss': 1.0105685}
I0522 05:41:45.498818 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-310000.
I0522 07:14:26.242621 139680122042176 controller.py:425] train | step:  320000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.59427893,
           'avg_obj': 0.15217316,
           'box_loss': 0.13006242,
           'class_loss': 0.07435953,
           'conf_loss': 0.1811202,
           'precision50': 0.31241336,
           'recall50': 0.066736184},
     '4': {'avg_iou': 0.6982733,
           'avg_obj': 0.259425,
           'box_loss': 0.11017781,
           'class_loss': 0.07346959,
           'conf_loss': 0.16422571,
           'precision50': 0.5606988,
           'recall50': 0.19244988},
     '5': {'avg_iou': 0.74738073,
           'avg_obj': 0.3647133,
           'box_loss': 0.09865707,
           'class_loss': 0.073041625,
           'conf_loss': 0.10421216,
           'precision50': 0.64612997,
           'recall50': 0.3305699},
     'global': {'total_loss': 1.0093251},
     'learning_rate': 0.002355086,
     'training_loss': 1.0093251}
I0522 07:15:25.159735 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-320000.
I0522 07:15:25.166397 139680122042176 controller.py:252]  eval | step:  320000 | running 625 steps of evaluation...
I0522 07:19:39.827208 139680122042176 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0522 07:23:42.432189 139680122042176 controller.py:261]  eval | step:  320000 | eval time:  497.3 sec | output: 
    {'3': {'avg_iou': 0.4571873,
           'avg_obj': 0.12054168,
           'box_loss': 0.011871191,
           'class_loss': 0.0054399846,
           'conf_loss': 0.019910244,
           'precision50': 0.27444178,
           'recall50': 0.08070768},
     '4': {'avg_iou': 0.64657307,
           'avg_obj': 0.24007063,
           'box_loss': 0.0126959365,
           'class_loss': 0.0063085374,
           'conf_loss': 0.01866852,
           'precision50': 0.49133652,
           'recall50': 0.19834496},
     '5': {'avg_iou': 0.7060409,
           'avg_obj': 0.34060025,
           'box_loss': 0.012618624,
           'class_loss': 0.0068241563,
           'conf_loss': 0.015443443,
           'precision50': 0.61703855,
           'recall50': 0.3122236},
     'AP': 0.2164652,
     'AP50': 0.37815034,
     'AP75': 0.21885921,
     'APl': 0.3031896,
     'APm': 0.21832451,
     'APs': 0.08726047,
     'ARl': 0.5490883,
     'ARm': 0.44929823,
     'ARmax1': 0.22562823,
     'ARmax10': 0.38175583,
     'ARmax100': 0.42367458,
     'ARs': 0.21886122,
     'global': {'total_loss': 0.10978062},
     'validation_loss': 0.10978062}
I0522 07:24:00.439007 139680122042176 controller.py:211] train | step:  320000 | training until step 340000...
I0522 08:51:00.350353 139680122042176 controller.py:425] train | step:  330000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5952001,
           'avg_obj': 0.15308282,
           'box_loss': 0.12956241,
           'class_loss': 0.07372244,
           'conf_loss': 0.18030001,
           'precision50': 0.31346846,
           'recall50': 0.06751246},
     '4': {'avg_iou': 0.69931406,
           'avg_obj': 0.26112425,
           'box_loss': 0.10968025,
           'class_loss': 0.072747745,
           'conf_loss': 0.16333736,
           'precision50': 0.5607395,
           'recall50': 0.19398414},
     '5': {'avg_iou': 0.7485985,
           'avg_obj': 0.36688703,
           'box_loss': 0.098081626,
           'class_loss': 0.07240261,
           'conf_loss': 0.103681654,
           'precision50': 0.6489792,
           'recall50': 0.33415285},
     'global': {'total_loss': 1.0035151},
     'learning_rate': 0.0022284898,
     'training_loss': 1.0035151}
I0522 08:51:58.623914 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-330000.
I0522 10:22:26.987016 139680122042176 controller.py:425] train | step:  340000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.59608436,
           'avg_obj': 0.1539371,
           'box_loss': 0.1293432,
           'class_loss': 0.07332874,
           'conf_loss': 0.1802216,
           'precision50': 0.31531253,
           'recall50': 0.06841914},
     '4': {'avg_iou': 0.7000153,
           'avg_obj': 0.26249486,
           'box_loss': 0.10937806,
           'class_loss': 0.07233728,
           'conf_loss': 0.16328113,
           'precision50': 0.56330395,
           'recall50': 0.19624229},
     '5': {'avg_iou': 0.7491515,
           'avg_obj': 0.36812282,
           'box_loss': 0.09788844,
           'class_loss': 0.07207592,
           'conf_loss': 0.10355454,
           'precision50': 0.6491492,
           'recall50': 0.33545384},
     'global': {'total_loss': 1.0014085},
     'learning_rate': 0.0021290681,
     'training_loss': 1.0014085}
I0522 10:23:25.287180 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-340000.
I0522 10:23:25.293841 139680122042176 controller.py:252]  eval | step:  340000 | running 625 steps of evaluation...
I0522 10:27:46.189619 139680122042176 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0522 10:32:00.788564 139680122042176 controller.py:261]  eval | step:  340000 | eval time:  515.5 sec | output: 
    {'3': {'avg_iou': 0.45793217,
           'avg_obj': 0.12116039,
           'box_loss': 0.011833062,
           'class_loss': 0.0053937444,
           'conf_loss': 0.019868517,
           'precision50': 0.27888447,
           'recall50': 0.08233555},
     '4': {'avg_iou': 0.64784366,
           'avg_obj': 0.24227974,
           'box_loss': 0.012630853,
           'class_loss': 0.0062491586,
           'conf_loss': 0.018599987,
           'precision50': 0.49401972,
           'recall50': 0.20154689},
     '5': {'avg_iou': 0.7076639,
           'avg_obj': 0.34427777,
           'box_loss': 0.012533551,
           'class_loss': 0.00673321,
           'conf_loss': 0.015378952,
           'precision50': 0.62152797,
           'recall50': 0.3171401},
     'AP': 0.22021982,
     'AP50': 0.38387161,
     'AP75': 0.22306506,
     'APl': 0.309365,
     'APm': 0.22227606,
     'APs': 0.089169875,
     'ARl': 0.55538374,
     'ARm': 0.45180294,
     'ARmax1': 0.22676682,
     'ARmax10': 0.3861336,
     'ARmax100': 0.42757627,
     'ARs': 0.21879512,
     'global': {'total_loss': 0.109221034},
     'validation_loss': 0.109221034}

train | step:  300000 | training until step 320000...
train | step:  310000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5936844,
           'avg_obj': 0.15067355,
           'box_loss': 0.13003138,
           'class_loss': 0.074663974,
           'conf_loss': 0.18052799,
           'precision50': 0.3086983,
           'recall50': 0.06571363},
     '4': {'avg_iou': 0.69745344,
           'avg_obj': 0.25747404,
           'box_loss': 0.11044503,
           'class_loss': 0.07392606,
           'conf_loss': 0.1640299,
           'precision50': 0.5561059,
           'recall50': 0.18994252},
     '5': {'avg_iou': 0.7465254,
           'avg_obj': 0.36247736,
           'box_loss': 0.09899769,
           'class_loss': 0.07355675,
           'conf_loss': 0.10438744,
           'precision50': 0.6444936,
           'recall50': 0.32766086},
     'global': {'total_loss': 1.0105685},
     'learning_rate': 0.0025079434,
     'training_loss': 1.0105685}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-310000.
train | step:  320000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.59427893,
           'avg_obj': 0.15217316,
           'box_loss': 0.13006242,
           'class_loss': 0.07435953,
           'conf_loss': 0.1811202,
           'precision50': 0.31241336,
           'recall50': 0.066736184},
     '4': {'avg_iou': 0.6982733,
           'avg_obj': 0.259425,
           'box_loss': 0.11017781,
           'class_loss': 0.07346959,
           'conf_loss': 0.16422571,
           'precision50': 0.5606988,
           'recall50': 0.19244988},
     '5': {'avg_iou': 0.74738073,
           'avg_obj': 0.3647133,
           'box_loss': 0.09865707,
           'class_loss': 0.073041625,
           'conf_loss': 0.10421216,
           'precision50': 0.64612997,
           'recall50': 0.3305699},
     'global': {'total_loss': 1.0093251},
     'learning_rate': 0.002355086,
     'training_loss': 1.0093251}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-320000.
 eval | step:  320000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=168.41s).
Accumulating evaluation results...
DONE (t=19.56s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.216
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.378
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.219
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.087
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.218
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.303
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.226
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.382
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.424
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.219
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.449
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.549
 eval | step:  320000 | eval time:  497.3 sec | output: 
    {'3': {'avg_iou': 0.4571873,
           'avg_obj': 0.12054168,
           'box_loss': 0.011871191,
           'class_loss': 0.0054399846,
           'conf_loss': 0.019910244,
           'precision50': 0.27444178,
           'recall50': 0.08070768},
     '4': {'avg_iou': 0.64657307,
           'avg_obj': 0.24007063,
           'box_loss': 0.0126959365,
           'class_loss': 0.0063085374,
           'conf_loss': 0.01866852,
           'precision50': 0.49133652,
           'recall50': 0.19834496},
     '5': {'avg_iou': 0.7060409,
           'avg_obj': 0.34060025,
           'box_loss': 0.012618624,
           'class_loss': 0.0068241563,
           'conf_loss': 0.015443443,
           'precision50': 0.61703855,
           'recall50': 0.3122236},
     'AP': 0.2164652,
     'AP50': 0.37815034,
     'AP75': 0.21885921,
     'APl': 0.3031896,
     'APm': 0.21832451,
     'APs': 0.08726047,
     'ARl': 0.5490883,
     'ARm': 0.44929823,
     'ARmax1': 0.22562823,
     'ARmax10': 0.38175583,
     'ARmax100': 0.42367458,
     'ARs': 0.21886122,
     'global': {'total_loss': 0.10978062},
     'validation_loss': 0.10978062}
train | step:  320000 | training until step 340000...
train | step:  330000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5952001,
           'avg_obj': 0.15308282,
           'box_loss': 0.12956241,
           'class_loss': 0.07372244,
           'conf_loss': 0.18030001,
           'precision50': 0.31346846,
           'recall50': 0.06751246},
     '4': {'avg_iou': 0.69931406,
           'avg_obj': 0.26112425,
           'box_loss': 0.10968025,
           'class_loss': 0.072747745,
           'conf_loss': 0.16333736,
           'precision50': 0.5607395,
           'recall50': 0.19398414},
     '5': {'avg_iou': 0.7485985,
           'avg_obj': 0.36688703,
           'box_loss': 0.098081626,
           'class_loss': 0.07240261,
           'conf_loss': 0.103681654,
           'precision50': 0.6489792,
           'recall50': 0.33415285},
     'global': {'total_loss': 1.0035151},
     'learning_rate': 0.0022284898,
     'training_loss': 1.0035151}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-330000.
train | step:  340000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.59608436,
           'avg_obj': 0.1539371,
           'box_loss': 0.1293432,
           'class_loss': 0.07332874,
           'conf_loss': 0.1802216,
           'precision50': 0.31531253,
           'recall50': 0.06841914},
     '4': {'avg_iou': 0.7000153,
           'avg_obj': 0.26249486,
           'box_loss': 0.10937806,
           'class_loss': 0.07233728,
           'conf_loss': 0.16328113,
           'precision50': 0.56330395,
           'recall50': 0.19624229},
     '5': {'avg_iou': 0.7491515,
           'avg_obj': 0.36812282,
           'box_loss': 0.09788844,
           'class_loss': 0.07207592,
           'conf_loss': 0.10355454,
           'precision50': 0.6491492,
           'recall50': 0.33545384},
     'global': {'total_loss': 1.0014085},
     'learning_rate': 0.0021290681,
     'training_loss': 1.0014085}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-340000.
 eval | step:  340000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.10s).
Accumulating evaluation results...
DONE (t=19.40s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.220
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.384
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.223
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.089
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.222
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.309
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.227
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.386
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.428
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.219
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.452
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.555
 eval | step:  340000 | eval time:  515.5 sec | output: 
    {'3': {'avg_iou': 0.45793217,
           'avg_obj': 0.12116039,
           'box_loss': 0.011833062,
           'class_loss': 0.0053937444,
           'conf_loss': 0.019868517,
           'precision50': 0.27888447,
           'recall50': 0.08233555},
     '4': {'avg_iou': 0.64784366,
           'avg_obj': 0.24227974,
           'box_loss': 0.012630853,
           'class_loss': 0.0062491586,
           'conf_loss': 0.018599987,
           'precision50': 0.49401972,
           'recall50': 0.20154689},
     '5': {'avg_iou': 0.7076639,
           'avg_obj': 0.34427777,
           'box_loss': 0.012533551,
           'class_loss': 0.00673321,
           'conf_loss': 0.015378952,
           'precision50': 0.62152797,
           'recall50': 0.3171401},
     'AP': 0.22021982,
     'AP50': 0.38387161,
     'AP75': 0.22306506,
     'APl': 0.309365,
     'APm': 0.22227606,
     'APs': 0.089169875,
     'ARl': 0.55538374,
     'ARm': 0.45180294,
     'ARmax1': 0.22676682,
     'ARmax10': 0.3861336,
     'ARmax100': 0.42757627,
     'ARs': 0.21879512,
     'global': {'total_loss': 0.109221034},
     'validation_loss': 0.109221034}I0522 10:32:18.896959 139680122042176 controller.py:211] train | step:  340000 | training until step 360000...
I0522 11:54:27.329632 139680122042176 controller.py:425] train | step:  350000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.59630716,
           'avg_obj': 0.15508261,
           'box_loss': 0.12916614,
           'class_loss': 0.072944514,
           'conf_loss': 0.17988999,
           'precision50': 0.31804714,
           'recall50': 0.06934365},
     '4': {'avg_iou': 0.7008201,
           'avg_obj': 0.26386568,
           'box_loss': 0.10908321,
           'class_loss': 0.071852066,
           'conf_loss': 0.16299786,
           'precision50': 0.5657349,
           'recall50': 0.19831026},
     '5': {'avg_iou': 0.7499545,
           'avg_obj': 0.36968553,
           'box_loss': 0.097516954,
           'class_loss': 0.07152272,
           'conf_loss': 0.10347996,
           'precision50': 0.6521792,
           'recall50': 0.33837253},
     'global': {'total_loss': 0.99845684},
     'learning_rate': 0.0020575363,
     'training_loss': 0.99845684}
I0522 11:55:25.489183 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-350000.
I0522 13:24:24.036704 139680122042176 controller.py:425] train | step:  360000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.5974272,
           'avg_obj': 0.15603371,
           'box_loss': 0.12897174,
           'class_loss': 0.072685644,
           'conf_loss': 0.17947236,
           'precision50': 0.31895038,
           'recall50': 0.06991538},
     '4': {'avg_iou': 0.70148015,
           'avg_obj': 0.26481453,
           'box_loss': 0.10876227,
           'class_loss': 0.07130049,
           'conf_loss': 0.16258764,
           'precision50': 0.56602985,
           'recall50': 0.19941644},
     '5': {'avg_iou': 0.7503282,
           'avg_obj': 0.37043026,
           'box_loss': 0.09725003,
           'class_loss': 0.07094802,
           'conf_loss': 0.103304334,
           'precision50': 0.65144986,
           'recall50': 0.33917627},
     'global': {'total_loss': 0.9952834},
     'learning_rate': 0.00201441,
     'training_loss': 0.9952834}
I0522 13:25:25.214108 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-360000.
I0522 13:25:25.221179 139680122042176 controller.py:252]  eval | step:  360000 | running 625 steps of evaluation...
I0522 13:29:37.168070 139680122042176 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0522 13:33:41.444663 139680122042176 controller.py:261]  eval | step:  360000 | eval time:  496.2 sec | output: 
    {'3': {'avg_iou': 0.45839867,
           'avg_obj': 0.12262208,
           'box_loss': 0.01180875,
           'class_loss': 0.0053625535,
           'conf_loss': 0.019845469,
           'precision50': 0.2802082,
           'recall50': 0.0835754},
     '4': {'avg_iou': 0.6487368,
           'avg_obj': 0.24392399,
           'box_loss': 0.01258652,
           'class_loss': 0.0061979005,
           'conf_loss': 0.018566312,
           'precision50': 0.49807206,
           'recall50': 0.20553237},
     '5': {'avg_iou': 0.7089151,
           'avg_obj': 0.34613422,
           'box_loss': 0.012468668,
           'class_loss': 0.0066668587,
           'conf_loss': 0.015339496,
           'precision50': 0.62239414,
           'recall50': 0.32070413},
     'AP': 0.22172022,
     'AP50': 0.38534692,
     'AP75': 0.22261553,
     'APl': 0.31322733,
     'APm': 0.22505523,
     'APs': 0.0878197,
     'ARl': 0.5579409,
     'ARm': 0.45263252,
     'ARmax1': 0.22816075,
     'ARmax10': 0.3860652,
     'ARmax100': 0.4276979,
     'ARs': 0.21913572,
     'global': {'total_loss': 0.10884253},
     'validation_loss': 0.10884253}
I0522 13:34:02.325239 139680122042176 controller.py:211] train | step:  360000 | training until step 375000...
I0522 14:57:44.447807 139680122042176 controller.py:425] train | step:  370000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5974782,
           'avg_obj': 0.15660788,
           'box_loss': 0.12900159,
           'class_loss': 0.072484165,
           'conf_loss': 0.17966187,
           'precision50': 0.3217626,
           'recall50': 0.070643015},
     '4': {'avg_iou': 0.7020862,
           'avg_obj': 0.2661833,
           'box_loss': 0.108572446,
           'class_loss': 0.0710678,
           'conf_loss': 0.16259015,
           'precision50': 0.5686188,
           'recall50': 0.20145108},
     '5': {'avg_iou': 0.751152,
           'avg_obj': 0.3725841,
           'box_loss': 0.09710164,
           'class_loss': 0.0707048,
           'conf_loss': 0.10306081,
           'precision50': 0.654708,
           'recall50': 0.34240022},
     'global': {'total_loss': 0.99424696},
     'learning_rate': 0.002,
     'training_loss': 0.99424696}
I0522 14:58:45.060364 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-370000.
I0522 15:42:52.394930 139680122042176 controller.py:425] train | step:  375000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.59795976,
           'avg_obj': 0.157209,
           'box_loss': 0.12843531,
           'class_loss': 0.072178975,
           'conf_loss': 0.17897363,
           'precision50': 0.32133406,
           'recall50': 0.07078939},
     '4': {'avg_iou': 0.702487,
           'avg_obj': 0.266699,
           'box_loss': 0.108378604,
           'class_loss': 0.070601925,
           'conf_loss': 0.16229613,
           'precision50': 0.5705438,
           'recall50': 0.20184614},
     '5': {'avg_iou': 0.7511815,
           'avg_obj': 0.37269774,
           'box_loss': 0.0969708,
           'class_loss': 0.07041327,
           'conf_loss': 0.103065796,
           'precision50': 0.6541281,
           'recall50': 0.3426837},
     'global': {'total_loss': 0.99131465},
     'learning_rate': 0.002,
     'training_loss': 0.99131465}
I0522 15:43:05.385636 139680122042176 controller.py:252]  eval | step:  375000 | running 625 steps of evaluation...
I0522 15:47:26.232590 139680122042176 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0522 15:51:26.453489 139680122042176 controller.py:261]  eval | step:  375000 | eval time:  501.1 sec | output: 
    {'3': {'avg_iou': 0.45876503,
           'avg_obj': 0.12351137,
           'box_loss': 0.011789652,
           'class_loss': 0.0053442838,
           'conf_loss': 0.01982517,
           'precision50': 0.2825094,
           'recall50': 0.084711544},
     '4': {'avg_iou': 0.6492673,
           'avg_obj': 0.24599287,
           'box_loss': 0.012556914,
           'class_loss': 0.006151508,
           'conf_loss': 0.018530857,
           'precision50': 0.50113493,
           'recall50': 0.20714988},
     '5': {'avg_iou': 0.7095172,
           'avg_obj': 0.34777987,
           'box_loss': 0.012435825,
           'class_loss': 0.006618672,
           'conf_loss': 0.015319189,
           'precision50': 0.6234516,
           'recall50': 0.3218618},
     'AP': 0.22451061,
     'AP50': 0.38866693,
     'AP75': 0.2272408,
     'APl': 0.31734645,
     'APm': 0.2270325,
     'APs': 0.0896272,
     'ARl': 0.5611421,
     'ARm': 0.45483878,
     'ARmax1': 0.22854044,
     'ARmax10': 0.387971,
     'ARmax100': 0.43097705,
     'ARs': 0.22206493,
     'global': {'total_loss': 0.108572},
     'validation_loss': 0.108572}

train | step:  340000 | training until step 360000...
train | step:  350000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.59630716,
           'avg_obj': 0.15508261,
           'box_loss': 0.12916614,
           'class_loss': 0.072944514,
           'conf_loss': 0.17988999,
           'precision50': 0.31804714,
           'recall50': 0.06934365},
     '4': {'avg_iou': 0.7008201,
           'avg_obj': 0.26386568,
           'box_loss': 0.10908321,
           'class_loss': 0.071852066,
           'conf_loss': 0.16299786,
           'precision50': 0.5657349,
           'recall50': 0.19831026},
     '5': {'avg_iou': 0.7499545,
           'avg_obj': 0.36968553,
           'box_loss': 0.097516954,
           'class_loss': 0.07152272,
           'conf_loss': 0.10347996,
           'precision50': 0.6521792,
           'recall50': 0.33837253},
     'global': {'total_loss': 0.99845684},
     'learning_rate': 0.0020575363,
     'training_loss': 0.99845684}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-350000.
train | step:  360000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.5974272,
           'avg_obj': 0.15603371,
           'box_loss': 0.12897174,
           'class_loss': 0.072685644,
           'conf_loss': 0.17947236,
           'precision50': 0.31895038,
           'recall50': 0.06991538},
     '4': {'avg_iou': 0.70148015,
           'avg_obj': 0.26481453,
           'box_loss': 0.10876227,
           'class_loss': 0.07130049,
           'conf_loss': 0.16258764,
           'precision50': 0.56602985,
           'recall50': 0.19941644},
     '5': {'avg_iou': 0.7503282,
           'avg_obj': 0.37043026,
           'box_loss': 0.09725003,
           'class_loss': 0.07094802,
           'conf_loss': 0.103304334,
           'precision50': 0.65144986,
           'recall50': 0.33917627},
     'global': {'total_loss': 0.9952834},
     'learning_rate': 0.00201441,
     'training_loss': 0.9952834}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-360000.
 eval | step:  360000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=167.03s).
Accumulating evaluation results...
DONE (t=19.47s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.222
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.385
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.223
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.088
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.225
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.313
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.228
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.386
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.428
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.219
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.453
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.558
 eval | step:  360000 | eval time:  496.2 sec | output: 
    {'3': {'avg_iou': 0.45839867,
           'avg_obj': 0.12262208,
           'box_loss': 0.01180875,
           'class_loss': 0.0053625535,
           'conf_loss': 0.019845469,
           'precision50': 0.2802082,
           'recall50': 0.0835754},
     '4': {'avg_iou': 0.6487368,
           'avg_obj': 0.24392399,
           'box_loss': 0.01258652,
           'class_loss': 0.0061979005,
           'conf_loss': 0.018566312,
           'precision50': 0.49807206,
           'recall50': 0.20553237},
     '5': {'avg_iou': 0.7089151,
           'avg_obj': 0.34613422,
           'box_loss': 0.012468668,
           'class_loss': 0.0066668587,
           'conf_loss': 0.015339496,
           'precision50': 0.62239414,
           'recall50': 0.32070413},
     'AP': 0.22172022,
     'AP50': 0.38534692,
     'AP75': 0.22261553,
     'APl': 0.31322733,
     'APm': 0.22505523,
     'APs': 0.0878197,
     'ARl': 0.5579409,
     'ARm': 0.45263252,
     'ARmax1': 0.22816075,
     'ARmax10': 0.3860652,
     'ARmax100': 0.4276979,
     'ARs': 0.21913572,
     'global': {'total_loss': 0.10884253},
     'validation_loss': 0.10884253}
train | step:  360000 | training until step 375000...
train | step:  370000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5974782,
           'avg_obj': 0.15660788,
           'box_loss': 0.12900159,
           'class_loss': 0.072484165,
           'conf_loss': 0.17966187,
           'precision50': 0.3217626,
           'recall50': 0.070643015},
     '4': {'avg_iou': 0.7020862,
           'avg_obj': 0.2661833,
           'box_loss': 0.108572446,
           'class_loss': 0.0710678,
           'conf_loss': 0.16259015,
           'precision50': 0.5686188,
           'recall50': 0.20145108},
     '5': {'avg_iou': 0.751152,
           'avg_obj': 0.3725841,
           'box_loss': 0.09710164,
           'class_loss': 0.0707048,
           'conf_loss': 0.10306081,
           'precision50': 0.654708,
           'recall50': 0.34240022},
     'global': {'total_loss': 0.99424696},
     'learning_rate': 0.002,
     'training_loss': 0.99424696}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-370000.
train | step:  375000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.59795976,
           'avg_obj': 0.157209,
           'box_loss': 0.12843531,
           'class_loss': 0.072178975,
           'conf_loss': 0.17897363,
           'precision50': 0.32133406,
           'recall50': 0.07078939},
     '4': {'avg_iou': 0.702487,
           'avg_obj': 0.266699,
           'box_loss': 0.108378604,
           'class_loss': 0.070601925,
           'conf_loss': 0.16229613,
           'precision50': 0.5705438,
           'recall50': 0.20184614},
     '5': {'avg_iou': 0.7511815,
           'avg_obj': 0.37269774,
           'box_loss': 0.0969708,
           'class_loss': 0.07041327,
           'conf_loss': 0.103065796,
           'precision50': 0.6541281,
           'recall50': 0.3426837},
     'global': {'total_loss': 0.99131465},
     'learning_rate': 0.002,
     'training_loss': 0.99131465}
 eval | step:  375000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=165.80s).
Accumulating evaluation results...
DONE (t=20.23s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.225
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.389
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.227
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.090
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.227
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.317
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.229
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.388
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.431
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.222
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.455
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.561
 eval | step:  375000 | eval time:  501.1 sec | output: 
    {'3': {'avg_iou': 0.45876503,
           'avg_obj': 0.12351137,
           'box_loss': 0.011789652,
           'class_loss': 0.0053442838,
           'conf_loss': 0.01982517,
           'precision50': 0.2825094,
           'recall50': 0.084711544},
     '4': {'avg_iou': 0.6492673,
           'avg_obj': 0.24599287,
           'box_loss': 0.012556914,
           'class_loss': 0.006151508,
           'conf_loss': 0.018530857,
           'precision50': 0.50113493,
           'recall50': 0.20714988},
     '5': {'avg_iou': 0.7095172,
           'avg_obj': 0.34777987,
           'box_loss': 0.012435825,
           'class_loss': 0.006618672,
           'conf_loss': 0.015319189,
           'precision50': 0.6234516,
           'recall50': 0.3218618},
     'AP': 0.22451061,
     'AP50': 0.38866693,
     'AP75': 0.2272408,
     'APl': 0.31734645,
     'APm': 0.2270325,
     'APs': 0.0896272,
     'ARl': 0.5611421,
     'ARm': 0.45483878,
     'ARmax1': 0.22854044,
     'ARmax10': 0.387971,
     'ARmax100': 0.43097705,
     'ARs': 0.22206493,
     'global': {'total_loss': 0.108572},
     'validation_loss': 0.108572}I0522 15:52:31.629338 139680122042176 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-375000.
I0522 15:52:31.643205 139680122042176 train_lib.py:123] Number of trainable params in model: 85.486272 Millions.

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-17/ckpt-375000.
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     10   1130 --:--:-- --:--:-- --:--:--  1141
okRequest issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-22T15:59:06.079908874Z'
  endTime: '2021-05-22T15:59:59.268769623Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621699146061-5c2ed4188973f-807615a2-2dc63c9a
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T05:45:10.821112479Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T05:44:59.159875+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T19:29:05.781890630Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T19:28:54.243943+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621699146061-5c2ed4188973f-807615a2-2dc63c9a] to complete...
.................................................................................................................................................................................................................................................................................done.
