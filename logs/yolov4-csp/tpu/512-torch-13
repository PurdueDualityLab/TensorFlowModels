cat: .experiment_zone: No such file or directory
Request issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-17T19:18:10.387838229Z'
  endTime: '2021-05-17T19:18:47.010179012Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621279090370-5c28b74436615-3529d3d9-98829b3d
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T05:45:10.821112479Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T05:44:59.159875+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T19:29:05.781890630Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T19:28:54.243943+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621279090370-5c28b74436615-3529d3d9-98829b3d] to complete...
..........................................................................................................................................................................................................................................................................done.
europe-west4-a
I0517 19:13:25.314561 140478930741056 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[12.0, 16.0]',
                              '[19.0, 36.0]',
                              '[40.0, 28.0]',
                              '[36.0, 75.0]',
                              '[76.0, 55.0]',
                              '[72.0, 146.0]',
                              '[142.0, 110.0]',
                              '[192.0, 243.0]',
                              '[459.0, 401.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'input_size': [512, 512, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.0,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.1,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 2.0,
                                         'aug_scale_min': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0517 19:13:25.315778 140478930741056 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/params.yaml
I0517 19:13:26.941975 140478930741056 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:13:27.090012 140478930741056 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0517 19:13:27.092159 140478930741056 transport.py:157] Attempting refresh to obtain initial access_token
I0517 19:13:27.152180 140478930741056 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:13:27.302874 140478930741056 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0517 19:13:27.303285 140478930741056 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-17 19:13:27.371083: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0517 19:13:27.371983 140478930741056 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:13:27.993667 140478930741056 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0517 19:13:27.994176 140478930741056 transport.py:157] Attempting refresh to obtain initial access_token
I0517 19:13:28.042266 140478930741056 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:13:28.206479 140478930741056 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0517 19:13:28.206763 140478930741056 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-17 19:13:28.253856: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-17 19:13:28.272451: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-05-17 19:13:28.272539: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:49666}
2021-05-17 19:13:46.309750: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-05-17 19:13:46.309843: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:49666}
2021-05-17 19:13:46.310708: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:49666
I0517 19:13:46.311963 140478930741056 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-1
I0517 19:13:46.312893 140478930741056 tpu_strategy_util.py:74] Initializing the TPU system: node-1
INFO:tensorflow:Clearing out eager caches
I0517 19:13:54.633935 140478930741056 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0517 19:13:54.636680 140478930741056 tpu_strategy_util.py:133] Finished initializing TPU system.
I0517 19:13:54.638390 140478930741056 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:13:55.264765 140478930741056 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0517 19:13:55.265148 140478930741056 transport.py:157] Attempting refresh to obtain initial access_token
I0517 19:13:55.317306 140478930741056 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:13:55.940894 140478930741056 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0517 19:13:55.941164 140478930741056 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0517 19:13:56.005436 140478930741056 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0517 19:13:56.006014 140478930741056 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0517 19:13:56.006528 140478930741056 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0517 19:13:56.006780 140478930741056 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0517 19:13:56.007013 140478930741056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0517 19:13:56.007364 140478930741056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0517 19:13:56.007589 140478930741056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0517 19:13:56.007826 140478930741056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0517 19:13:56.007939 140478930741056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0517 19:13:56.008000 140478930741056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0517 19:13:56.008046 140478930741056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0517 19:13:56.008090 140478930741056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0517 19:13:56.008157 140478930741056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0517 19:13:56.008203 140478930741056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0517 19:13:56.008248 140478930741056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0517 19:13:56.008296 140478930741056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0517 19:13:56.009642 140478930741056 train_utils.py:214] Running default trainer.
2021-05-17 19:13:56.026663: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, 'input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.0, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.1, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
heheheeheheheheheheheh:  [[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, 'input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7fc36870d588>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'5': (None, 16, 16, 57800704    input_2[0][0]                    
                                                                 input_3[0][0]                    
                                                                 input_4[0][0]                    
==================================================================================================I0517 19:14:45.008681 140478930741056 controller.py:362] restoring or initializing model...
I0517 19:14:54.033660 140478930741056 yolo.py:537] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0517 19:14:54.035576 140478930741056 controller.py:368] initialized model.
I0517 19:14:54.035799 140478930741056 train_lib.py:96] Starts to execute mode: train_and_eval
I0517 19:14:54.040565 140478930741056 controller.py:211] train | step:      0 | training until step 20000...
I0517 19:15:02.045376 140478930741056 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 149, in main
    model_dir=model_dir)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_lib.py", line 104, in run_experiment
    eval_interval=params.trainer.validation_interval)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 303, in train_and_evaluate
    self.train(steps=num_steps, checkpoint_at_completion=False)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 215, in train
    self._train_n_steps(num_steps)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 410, in _train_n_steps
    train_output = self.trainer.train(num_steps_tensor)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/standard_runner.py", line 141, in train
    self._train_loop_fn(self._train_iter, num_steps)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py", line 828, in __call__
    result = self._call(*args, **kwds)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py", line 871, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py", line 726, in _initialize
    *args, **kwds))
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py", line 2969, in _get_concrete_function_internal_garbage_collected
    graph_function, _ = self._maybe_define_function(args, kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py", line 3361, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py", line 3206, in _create_graph_function
    capture_by_value=self._capture_by_value),
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/func_graph.py", line 990, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py", line 634, in wrapped_fn
    out = weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/func_graph.py", line 977, in wrapper
    raise e.ag_error_metadata.to_exception(e)
ValueError: in user code:

    /home/cam2tensorflow/TensorFlowModels/orbit/utils/loop_fns.py:118 loop_fn  *
        step_fn(iterator)
    /home/cam2tensorflow/TensorFlowModels/official/core/base_trainer.py:292 step_fn  *
        logs = self.task.train_step(
    /home/cam2tensorflow/TensorFlowModels/yolo/tasks/yolo.py:254 train_step  *
        scaled_loss, loss_metrics = self.build_losses(
    /home/cam2tensorflow/TensorFlowModels/yolo/tasks/yolo.py:203 build_losses  *
        (_loss, _loss_box, _loss_conf, _loss_class, _avg_iou, _avg_obj, _recall50,
    /home/cam2tensorflow/TensorFlowModels/yolo/losses/yolo_loss.py:807 __call__  *
        y_pred)
    /home/cam2tensorflow/TensorFlowModels/yolo/losses/yolo_loss.py:647 call_scaled  *
        smoothed_iou = ((1 - self._objectness_smooth) * tf.cast(ind_mask, iou.dtype)) + self._objectness_smooth * iou
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/math_ops.py:1180 binary_op_wrapper
        raise e
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/math_ops.py:1164 binary_op_wrapper
        return func(x, y, name=name)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/util/dispatch.py:201 wrapper
        return target(*args, **kwargs)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/math_ops.py:1486 _add_dispatch
        return gen_math_ops.add_v2(x, y, name=name)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_math_ops.py:482 add_v2
        "AddV2", x=x, y=y, name=name)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/op_def_library.py:750 _apply_op_helper
        attrs=attr_protos, op_def=op_def)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/func_graph.py:592 _create_op_internal
        compute_device)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py:3536 _create_op_internal
        op_def=op_def)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py:2016 __init__
        control_input_ops, op_def)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py:1856 _create_c_op
        raise ValueError(str(e))

    ValueError: Dimensions must be equal, but are 600 and 8 for '{{node add_1}} = AddV2[T=DT_FLOAT](mul_12, mul_13)' with input shapes: [8,600,1], [8,600].


Total params: 57,800,704
Trainable params: 57,768,960
Non-trainable params: 31,744
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'5': (None, 16, 16, 2048 57800704  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  1033056   
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 85,486,272
Trainable params: 85,419,200
Non-trainable params: 67,072
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 400, 8), 5: (8, 200, 8)}, inds: {3: (8, 600, 3), 4: (8, 400, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     13   1368 --:--:-- --:--:-- --:--:--  1381
okRequest issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-17T19:21:01.250299069Z'
  endTime: '2021-05-17T19:21:37.648232517Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621279261234-5c28b7e7296ed-3c9e81ca-16633332
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T05:45:10.821112479Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T05:44:59.159875+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T19:29:05.781890630Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T19:28:54.243943+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621279261234-5c28b7e7296ed-3c9e81ca-16633332] to complete...
............................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-17T19:23:35.138089466Z'
  endTime: '2021-05-17T19:24:12.639133769Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621279415125-5c28b879ec48c-642de8c4-0cda5001
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T05:45:10.821112479Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T05:44:59.159875+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T19:29:05.781890630Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T19:28:54.243943+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621279415125-5c28b879ec48c-642de8c4-0cda5001] to complete...
................................................................................................................................................................................................................................................................................done.
europe-west4-a
I0517 19:18:49.759761 140670048900928 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[12.0, 16.0]',
                              '[19.0, 36.0]',
                              '[40.0, 28.0]',
                              '[36.0, 75.0]',
                              '[76.0, 55.0]',
                              '[72.0, 146.0]',
                              '[142.0, 110.0]',
                              '[192.0, 243.0]',
                              '[459.0, 401.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'input_size': [512, 512, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.0,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.1,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 2.0,
                                         'aug_scale_min': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0517 19:18:49.761050 140670048900928 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/params.yaml
I0517 19:18:50.576146 140670048900928 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:18:51.199797 140670048900928 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0517 19:18:51.200102 140670048900928 transport.py:157] Attempting refresh to obtain initial access_token
I0517 19:18:51.261695 140670048900928 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:18:51.889288 140670048900928 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0517 19:18:51.889588 140670048900928 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-17 19:18:51.940473: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0517 19:18:51.941335 140670048900928 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:18:52.088340 140670048900928 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0517 19:18:52.088612 140670048900928 transport.py:157] Attempting refresh to obtain initial access_token
I0517 19:18:52.142817 140670048900928 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:18:52.763247 140670048900928 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0517 19:18:52.763581 140670048900928 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-17 19:18:52.807295: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-17 19:18:52.818290: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-05-17 19:18:52.818608: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:49912}
2021-05-17 19:19:12.485993: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-05-17 19:19:12.486081: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:49912}
2021-05-17 19:19:12.486680: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:49912
I0517 19:19:12.487643 140670048900928 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-1
I0517 19:19:12.490255 140670048900928 tpu_strategy_util.py:74] Initializing the TPU system: node-1
INFO:tensorflow:Clearing out eager caches
I0517 19:19:20.406608 140670048900928 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0517 19:19:20.408896 140670048900928 tpu_strategy_util.py:133] Finished initializing TPU system.
I0517 19:19:20.410394 140670048900928 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:19:20.556611 140670048900928 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0517 19:19:20.556881 140670048900928 transport.py:157] Attempting refresh to obtain initial access_token
I0517 19:19:20.617309 140670048900928 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:19:21.235761 140670048900928 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0517 19:19:21.236127 140670048900928 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0517 19:19:21.293961 140670048900928 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0517 19:19:21.294357 140670048900928 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0517 19:19:21.294805 140670048900928 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0517 19:19:21.294991 140670048900928 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0517 19:19:21.295132 140670048900928 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0517 19:19:21.295413 140670048900928 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0517 19:19:21.295540 140670048900928 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0517 19:19:21.295638 140670048900928 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0517 19:19:21.295763 140670048900928 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0517 19:19:21.295877 140670048900928 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0517 19:19:21.295979 140670048900928 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0517 19:19:21.296077 140670048900928 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0517 19:19:21.296164 140670048900928 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0517 19:19:21.296257 140670048900928 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0517 19:19:21.296332 140670048900928 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0517 19:19:21.296420 140670048900928 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0517 19:19:21.297831 140670048900928 train_utils.py:214] Running default trainer.
2021-05-17 19:19:21.313767: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, 'input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.0, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.1, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
heheheeheheheheheheheh:  [[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, 'input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7fefe478a828>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'5': (None, 16, 16, 57800704    input_2[0][0]                    
                                                                 input_3[0][0]                    
                                                                 input_4[0][0]                    
==================================================================================================I0517 19:20:07.595824 140670048900928 controller.py:362] restoring or initializing model...
I0517 19:20:15.823450 140670048900928 yolo.py:537] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0517 19:20:15.825596 140670048900928 controller.py:368] initialized model.
I0517 19:20:15.825864 140670048900928 train_lib.py:96] Starts to execute mode: train_and_eval
I0517 19:20:15.831275 140670048900928 controller.py:211] train | step:      0 | training until step 20000...
I0517 19:20:22.900433 140670048900928 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 149, in main
    model_dir=model_dir)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_lib.py", line 104, in run_experiment
    eval_interval=params.trainer.validation_interval)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 303, in train_and_evaluate
    self.train(steps=num_steps, checkpoint_at_completion=False)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 215, in train
    self._train_n_steps(num_steps)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 410, in _train_n_steps
    train_output = self.trainer.train(num_steps_tensor)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/standard_runner.py", line 141, in train
    self._train_loop_fn(self._train_iter, num_steps)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py", line 828, in __call__
    result = self._call(*args, **kwds)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py", line 871, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py", line 726, in _initialize
    *args, **kwds))
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py", line 2969, in _get_concrete_function_internal_garbage_collected
    graph_function, _ = self._maybe_define_function(args, kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py", line 3361, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py", line 3206, in _create_graph_function
    capture_by_value=self._capture_by_value),
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/func_graph.py", line 990, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py", line 634, in wrapped_fn
    out = weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/func_graph.py", line 977, in wrapper
    raise e.ag_error_metadata.to_exception(e)
ValueError: in user code:

    /home/cam2tensorflow/TensorFlowModels/orbit/utils/loop_fns.py:118 loop_fn  *
        step_fn(iterator)
    /home/cam2tensorflow/TensorFlowModels/official/core/base_trainer.py:292 step_fn  *
        logs = self.task.train_step(
    /home/cam2tensorflow/TensorFlowModels/yolo/tasks/yolo.py:254 train_step  *
        scaled_loss, loss_metrics = self.build_losses(
    /home/cam2tensorflow/TensorFlowModels/yolo/tasks/yolo.py:203 build_losses  *
        (_loss, _loss_box, _loss_conf, _loss_class, _avg_iou, _avg_obj, _recall50,
    /home/cam2tensorflow/TensorFlowModels/yolo/losses/yolo_loss.py:807 __call__  *
        y_pred)
    /home/cam2tensorflow/TensorFlowModels/yolo/losses/yolo_loss.py:647 call_scaled  *
        smoothed_iou = ((1 - self._objectness_smooth) * tf.cast(ind_mask, iou.dtype)) + self._objectness_smooth * iou
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/math_ops.py:1180 binary_op_wrapper
        raise e
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/math_ops.py:1164 binary_op_wrapper
        return func(x, y, name=name)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/util/dispatch.py:201 wrapper
        return target(*args, **kwargs)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/math_ops.py:1486 _add_dispatch
        return gen_math_ops.add_v2(x, y, name=name)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_math_ops.py:482 add_v2
        "AddV2", x=x, y=y, name=name)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/op_def_library.py:750 _apply_op_helper
        attrs=attr_protos, op_def=op_def)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/func_graph.py:592 _create_op_internal
        compute_device)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py:3536 _create_op_internal
        op_def=op_def)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py:2016 __init__
        control_input_ops, op_def)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py:1856 _create_c_op
        raise ValueError(str(e))

    ValueError: Dimensions must be equal, but are 600 and 8 for '{{node add_1}} = AddV2[T=DT_FLOAT](mul_12, mul_13)' with input shapes: [8,600,1], [8,600].


Total params: 57,800,704
Trainable params: 57,768,960
Non-trainable params: 31,744
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'5': (None, 16, 16, 2048 57800704  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  1033056   
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 85,486,272
Trainable params: 85,419,200
Non-trainable params: 67,072
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 400, 8), 5: (8, 200, 8)}, inds: {3: (8, 600, 3), 4: (8, 400, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     11   1209 --:--:-- --:--:-- --:--:--  1220
okRequest issued for: [node-1]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621279581947-5c28b919047d3-0283d1fe-e135e8db] to complete...
..................................aborted by ctrl-c.
ERROR: (gcloud.compute.tpus.stop) Aborting wait for operation https://tpu.googleapis.com/v1alpha1/projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621279581947-5c28b919047d3-0283d1fe-e135e8db.

cat: .experiment_zone: No such file or directory
Request issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-17T19:47:47.347718447Z'
  endTime: '2021-05-17T19:49:36.514425212Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621280867338-5c28bde2dc753-d3405689-4e264539
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T05:45:10.821112479Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T05:44:59.159875+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T19:29:05.781890630Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T19:28:54.243943+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621280867338-5c28bde2dc753-d3405689-4e264539] to complete...
.................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................done.
europe-west4-a
I0517 19:44:34.844444 139627049523008 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[12.0, 16.0]',
                              '[19.0, 36.0]',
                              '[40.0, 28.0]',
                              '[36.0, 75.0]',
                              '[76.0, 55.0]',
                              '[72.0, 146.0]',
                              '[142.0, 110.0]',
                              '[192.0, 243.0]',
                              '[459.0, 401.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'input_size': [512, 512, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.0,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.1,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 2.0,
                                         'aug_scale_min': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0517 19:44:34.845660 139627049523008 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/params.yaml
I0517 19:44:35.671540 139627049523008 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:44:36.295155 139627049523008 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0517 19:44:36.295423 139627049523008 transport.py:157] Attempting refresh to obtain initial access_token
I0517 19:44:36.359340 139627049523008 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:44:36.505817 139627049523008 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0517 19:44:36.506118 139627049523008 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-17 19:44:36.552218: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0517 19:44:36.553085 139627049523008 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:44:37.178372 139627049523008 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0517 19:44:37.178865 139627049523008 transport.py:157] Attempting refresh to obtain initial access_token
I0517 19:44:37.235673 139627049523008 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:44:37.385200 139627049523008 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0517 19:44:37.385458 139627049523008 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-17 19:44:37.443047: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-17 19:44:37.464753: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-05-17 19:44:37.464840: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:50512}
2021-05-17 19:44:37.486477: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-05-17 19:44:37.486563: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:50512}
2021-05-17 19:44:37.487123: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:50512
I0517 19:44:37.487876 139627049523008 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-1
I0517 19:44:37.488854 139627049523008 tpu_strategy_util.py:74] Initializing the TPU system: node-1
INFO:tensorflow:Clearing out eager caches
I0517 19:44:45.429187 139627049523008 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0517 19:44:45.431315 139627049523008 tpu_strategy_util.py:133] Finished initializing TPU system.
I0517 19:44:45.432598 139627049523008 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:44:46.054579 139627049523008 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0517 19:44:46.054859 139627049523008 transport.py:157] Attempting refresh to obtain initial access_token
I0517 19:44:46.098415 139627049523008 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:44:46.721740 139627049523008 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0517 19:44:46.722027 139627049523008 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0517 19:44:46.766954 139627049523008 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0517 19:44:46.767558 139627049523008 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0517 19:44:46.768005 139627049523008 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0517 19:44:46.768119 139627049523008 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0517 19:44:46.768178 139627049523008 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0517 19:44:46.768348 139627049523008 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0517 19:44:46.768400 139627049523008 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0517 19:44:46.768483 139627049523008 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0517 19:44:46.768530 139627049523008 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0517 19:44:46.768574 139627049523008 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0517 19:44:46.768621 139627049523008 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0517 19:44:46.768667 139627049523008 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0517 19:44:46.768714 139627049523008 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0517 19:44:46.768760 139627049523008 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0517 19:44:46.768805 139627049523008 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0517 19:44:46.768852 139627049523008 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0517 19:44:46.770104 139627049523008 train_utils.py:214] Running default trainer.
2021-05-17 19:44:46.785175: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, 'input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.0, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.1, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
heheheeheheheheheheheh:  [[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, 'input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7efd0c5c8e80>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'5': (None, 16, 16, 57800704    input_2[0][0]                    
                                                                 input_3[0][0]                    
                                                                 input_4[0][0]                    
==================================================================================================I0517 19:45:33.637205 139627049523008 controller.py:362] restoring or initializing model...
I0517 19:45:41.767997 139627049523008 yolo.py:537] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0517 19:45:41.769712 139627049523008 controller.py:368] initialized model.
I0517 19:45:41.770056 139627049523008 train_lib.py:96] Starts to execute mode: train_and_eval
I0517 19:45:41.774830 139627049523008 controller.py:211] train | step:      0 | training until step 20000...
I0517 19:45:49.329899 139627049523008 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0517 19:46:31.920428 139627049523008 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0517 21:30:01.331408 139627049523008 controller.py:425] train | step:  10000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.4614224,
           'avg_obj': 0.11413964,
           'box_loss': 0.17808874,
           'class_loss': 0.38110343,
           'conf_loss': 1.4050078,
           'precision50': 0.19698434,
           'recall50': 0.042930983},
     '4': {'avg_iou': 0.5378298,
           'avg_obj': 0.19562319,
           'box_loss': 0.17309147,
           'class_loss': 0.38981104,
           'conf_loss': 0.5478459,
           'precision50': 0.40803218,
           'recall50': 0.1141943},
     '5': {'avg_iou': 0.5429564,
           'avg_obj': 0.25077435,
           'box_loss': 0.176962,
           'class_loss': 0.34377405,
           'conf_loss': 0.2842277,
           'precision50': 0.49461412,
           'recall50': 0.17385806},
     'global': {'total_loss': 3.879919},
     'learning_rate': 0.009985589,
     'training_loss': 3.879919}
I0517 21:31:05.386008 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-10000.
I0517 23:11:37.646292 139627049523008 controller.py:425] train | step:  20000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.57319725,
           'avg_obj': 0.1708379,
           'box_loss': 0.13767038,
           'class_loss': 0.062076952,
           'conf_loss': 0.22461313,
           'precision50': 0.416596,
           'recall50': 0.08311012},
     '4': {'avg_iou': 0.6726714,
           'avg_obj': 0.2888024,
           'box_loss': 0.119439185,
           'class_loss': 0.05289956,
           'conf_loss': 0.19871053,
           'precision50': 0.6554976,
           'recall50': 0.23405495},
     '5': {'avg_iou': 0.70336574,
           'avg_obj': 0.37759328,
           'box_loss': 0.11213122,
           'class_loss': 0.0478537,
           'conf_loss': 0.1340117,
           'precision50': 0.7446946,
           'recall50': 0.3737468},
     'global': {'total_loss': 1.0894046},
     'learning_rate': 0.009942464,
     'training_loss': 1.0894046}
I0517 23:12:35.421120 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-20000.
I0517 23:12:35.426630 139627049523008 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0517 23:12:36.070585 139627049523008 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0517 23:12:51.107224 139627049523008 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0517 23:17:39.807672 139627049523008 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0517 23:21:39.751923 139627049523008 controller.py:261]  eval | step:  20000 | eval time:  544.3 sec | output: 
    {'3': {'avg_iou': 0.46221113,
           'avg_obj': 0.15386593,
           'box_loss': 0.011180623,
           'class_loss': 0.003729441,
           'conf_loss': 0.017844448,
           'precision50': 0.34660873,
           'recall50': 0.113533884},
     '4': {'avg_iou': 0.6687002,
           'avg_obj': 0.30851376,
           'box_loss': 0.011168024,
           'class_loss': 0.0036329005,
           'conf_loss': 0.01623489,
           'precision50': 0.605975,
           'recall50': 0.29223996},
     '5': {'avg_iou': 0.73537004,
           'avg_obj': 0.4171724,
           'box_loss': 0.010573765,
           'class_loss': 0.0036164406,
           'conf_loss': 0.013126572,
           'precision50': 0.7297972,
           'recall50': 0.43962765},
     'AP': 0.3011237,
     'AP50': 0.5127639,
     'AP75': 0.3130491,
     'APl': 0.43177328,
     'APm': 0.3094118,
     'APs': 0.10834069,
     'ARl': 0.60903376,
     'ARm': 0.5101383,
     'ARmax1': 0.26386228,
     'ARmax10': 0.4281859,
     'ARmax100': 0.4720163,
     'ARs': 0.24828045,
     'global': {'total_loss': 0.09110713},
     'validation_loss': 0.09110713}
I0517 23:22:02.840301 139627049523008 controller.py:211] train | step:  20000 | training until step 40000...
I0518 01:05:22.647815 139627049523008 controller.py:425] train | step:  30000 | steps/sec:    1.5 | output: 
    {'3': {'avg_iou': 0.59527653,
           'avg_obj': 0.19812486,
           'box_loss': 0.13013159,
           'class_loss': 0.05362234,
           'conf_loss': 0.21907078,
           'precision50': 0.462717,
           'recall50': 0.11063022},
     '4': {'avg_iou': 0.6989013,
           'avg_obj': 0.3262678,
           'box_loss': 0.109168395,
           'class_loss': 0.044359487,
           'conf_loss': 0.19169262,
           'precision50': 0.68731797,
           'recall50': 0.2880997},
     '5': {'avg_iou': 0.73342603,
           'avg_obj': 0.42186168,
           'box_loss': 0.10004487,
           'class_loss': 0.040123828,
           'conf_loss': 0.12796105,
           'precision50': 0.76988614,
           'recall50': 0.44002464},
     'global': {'total_loss': 1.0161735},
     'learning_rate': 0.0098709315,
     'training_loss': 1.0161735}

Total params: 57,800,704
Trainable params: 57,768,960
Non-trainable params: 31,744
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'5': (None, 16, 16, 2048 57800704  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  1033056   
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 85,486,272
Trainable params: 85,419,200
Non-trainable params: 67,072
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 400, 8), 5: (8, 200, 8)}, inds: {3: (8, 600, 3), 4: (8, 400, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
train | step:  10000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.4614224,
           'avg_obj': 0.11413964,
           'box_loss': 0.17808874,
           'class_loss': 0.38110343,
           'conf_loss': 1.4050078,
           'precision50': 0.19698434,
           'recall50': 0.042930983},
     '4': {'avg_iou': 0.5378298,
           'avg_obj': 0.19562319,
           'box_loss': 0.17309147,
           'class_loss': 0.38981104,
           'conf_loss': 0.5478459,
           'precision50': 0.40803218,
           'recall50': 0.1141943},
     '5': {'avg_iou': 0.5429564,
           'avg_obj': 0.25077435,
           'box_loss': 0.176962,
           'class_loss': 0.34377405,
           'conf_loss': 0.2842277,
           'precision50': 0.49461412,
           'recall50': 0.17385806},
     'global': {'total_loss': 3.879919},
     'learning_rate': 0.009985589,
     'training_loss': 3.879919}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-10000.
train | step:  20000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.57319725,
           'avg_obj': 0.1708379,
           'box_loss': 0.13767038,
           'class_loss': 0.062076952,
           'conf_loss': 0.22461313,
           'precision50': 0.416596,
           'recall50': 0.08311012},
     '4': {'avg_iou': 0.6726714,
           'avg_obj': 0.2888024,
           'box_loss': 0.119439185,
           'class_loss': 0.05289956,
           'conf_loss': 0.19871053,
           'precision50': 0.6554976,
           'recall50': 0.23405495},
     '5': {'avg_iou': 0.70336574,
           'avg_obj': 0.37759328,
           'box_loss': 0.11213122,
           'class_loss': 0.0478537,
           'conf_loss': 0.1340117,
           'precision50': 0.7446946,
           'recall50': 0.3737468},
     'global': {'total_loss': 1.0894046},
     'learning_rate': 0.009942464,
     'training_loss': 1.0894046}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-20000.
 eval | step:  20000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=172.25s).
Accumulating evaluation results...
DONE (t=17.02s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.301
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.513
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.313
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.108
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.309
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.432
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.264
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.428
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.472
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.248
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.510
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.609
 eval | step:  20000 | eval time:  544.3 sec | output: 
    {'3': {'avg_iou': 0.46221113,
           'avg_obj': 0.15386593,
           'box_loss': 0.011180623,
           'class_loss': 0.003729441,
           'conf_loss': 0.017844448,
           'precision50': 0.34660873,
           'recall50': 0.113533884},
     '4': {'avg_iou': 0.6687002,
           'avg_obj': 0.30851376,
           'box_loss': 0.011168024,
           'class_loss': 0.0036329005,
           'conf_loss': 0.01623489,
           'precision50': 0.605975,
           'recall50': 0.29223996},
     '5': {'avg_iou': 0.73537004,
           'avg_obj': 0.4171724,
           'box_loss': 0.010573765,
           'class_loss': 0.0036164406,
           'conf_loss': 0.013126572,
           'precision50': 0.7297972,
           'recall50': 0.43962765},
     'AP': 0.3011237,
     'AP50': 0.5127639,
     'AP75': 0.3130491,
     'APl': 0.43177328,
     'APm': 0.3094118,
     'APs': 0.10834069,
     'ARl': 0.60903376,
     'ARm': 0.5101383,
     'ARmax1': 0.26386228,
     'ARmax10': 0.4281859,
     'ARmax100': 0.4720163,
     'ARs': 0.24828045,
     'global': {'total_loss': 0.09110713},
     'validation_loss': 0.09110713}
train | step:  20000 | training until step 40000...
train | step:  30000 | steps/sec:    1.5 | output: 
    {'3': {'avg_iou': 0.59527653,
           'avg_obj': 0.19812486,
           'box_loss': 0.13013159,
           'class_loss': 0.05362234,
           'conf_loss': 0.21907078,
           'precision50': 0.462717,
           'recall50': 0.11063022},
     '4': {'avg_iou': 0.6989013,
           'avg_obj': 0.3262678,
           'box_loss': 0.109168395,
           'class_loss': 0.044359487,
           'conf_loss': 0.19169262,
           'precision50': 0.68731797,
           'recall50': 0.2880997},
     '5': {'avg_iou': 0.73342603,
           'avg_obj': 0.42186168,
           'box_loss': 0.10004487,
           'class_loss': 0.040123828,
           'conf_loss': 0.12796105,
           'precision50': 0.76988614,
           'recall50': 0.44002464},
     'global': {'total_loss': 1.0161735},
     'learning_rate': 0.0098709315,
     'training_loss': 1.0161735}I0518 01:06:24.096881 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-30000.
I0518 02:42:45.927063 139627049523008 controller.py:425] train | step:  40000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.60760325,
           'avg_obj': 0.21467644,
           'box_loss': 0.12570351,
           'class_loss': 0.04885729,
           'conf_loss': 0.21467046,
           'precision50': 0.48592985,
           'recall50': 0.1278849},
     '4': {'avg_iou': 0.71332395,
           'avg_obj': 0.34891757,
           'box_loss': 0.10332653,
           'class_loss': 0.03949953,
           'conf_loss': 0.18664536,
           'precision50': 0.7022249,
           'recall50': 0.31994474},
     '5': {'avg_iou': 0.74909705,
           'avg_obj': 0.4473389,
           'box_loss': 0.09367006,
           'class_loss': 0.03586757,
           'conf_loss': 0.12397937,
           'precision50': 0.7814416,
           'recall50': 0.47590113},
     'global': {'total_loss': 0.9722198},
     'learning_rate': 0.00977151,
     'training_loss': 0.9722198}
I0518 02:43:43.671922 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-40000.
I0518 02:43:43.678518 139627049523008 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0518 02:47:50.262950 139627049523008 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0518 02:51:51.630624 139627049523008 controller.py:261]  eval | step:  40000 | eval time:  488.0 sec | output: 
    {'3': {'avg_iou': 0.47693354,
           'avg_obj': 0.17930274,
           'box_loss': 0.010437131,
           'class_loss': 0.003181786,
           'conf_loss': 0.01743403,
           'precision50': 0.38265765,
           'recall50': 0.14774866},
     '4': {'avg_iou': 0.68736184,
           'avg_obj': 0.34999418,
           'box_loss': 0.010225515,
           'class_loss': 0.0030701407,
           'conf_loss': 0.015689773,
           'precision50': 0.63092154,
           'recall50': 0.35155678},
     '5': {'avg_iou': 0.7549543,
           'avg_obj': 0.46569252,
           'box_loss': 0.009583327,
           'class_loss': 0.0031193828,
           'conf_loss': 0.012558811,
           'precision50': 0.7472738,
           'recall50': 0.50774163},
     'AP': 0.34506756,
     'AP50': 0.5600606,
     'AP75': 0.3666162,
     'APl': 0.48575252,
     'APm': 0.35862973,
     'APs': 0.13794164,
     'ARl': 0.651204,
     'ARm': 0.55156446,
     'ARmax1': 0.28980508,
     'ARmax10': 0.46920815,
     'ARmax100': 0.513965,
     'ARs': 0.28727272,
     'global': {'total_loss': 0.08529994},
     'validation_loss': 0.08529994}
I0518 02:52:14.467514 139627049523008 controller.py:211] train | step:  40000 | training until step 60000...
I0518 04:26:52.749035 139627049523008 controller.py:425] train | step:  50000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.615781,
           'avg_obj': 0.22703843,
           'box_loss': 0.12288033,
           'class_loss': 0.045682687,
           'conf_loss': 0.21133284,
           'precision50': 0.50069153,
           'recall50': 0.14106807},
     '4': {'avg_iou': 0.72280896,
           'avg_obj': 0.36539668,
           'box_loss': 0.09962603,
           'class_loss': 0.036392745,
           'conf_loss': 0.18278514,
           'precision50': 0.7128334,
           'recall50': 0.34244916},
     '5': {'avg_iou': 0.7591995,
           'avg_obj': 0.46544108,
           'box_loss': 0.08967631,
           'class_loss': 0.033130843,
           'conf_loss': 0.12094618,
           'precision50': 0.7889384,
           'recall50': 0.5001093},
     'global': {'total_loss': 0.94245255},
     'learning_rate': 0.0096449135,
     'training_loss': 0.94245255}
I0518 04:27:50.935519 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-50000.
I0518 06:05:27.499784 139627049523008 controller.py:425] train | step:  60000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6216424,
           'avg_obj': 0.23591308,
           'box_loss': 0.12089655,
           'class_loss': 0.043733556,
           'conf_loss': 0.20953304,
           'precision50': 0.51179874,
           'recall50': 0.15054156},
     '4': {'avg_iou': 0.72931033,
           'avg_obj': 0.37630513,
           'box_loss': 0.097146615,
           'class_loss': 0.034574617,
           'conf_loss': 0.1805718,
           'precision50': 0.71883756,
           'recall50': 0.357013},
     '5': {'avg_iou': 0.7658497,
           'avg_obj': 0.47644088,
           'box_loss': 0.08697214,
           'class_loss': 0.0316027,
           'conf_loss': 0.11931212,
           'precision50': 0.7928191,
           'recall50': 0.514358},
     'global': {'total_loss': 0.924343},
     'learning_rate': 0.009492056,
     'training_loss': 0.924343}
I0518 06:06:26.850460 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-60000.
I0518 06:06:26.856614 139627049523008 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0518 06:10:37.964901 139627049523008 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0518 06:14:44.608921 139627049523008 controller.py:261]  eval | step:  60000 | eval time:  497.8 sec | output: 
    {'3': {'avg_iou': 0.48334342,
           'avg_obj': 0.18875547,
           'box_loss': 0.0101117585,
           'class_loss': 0.0029835405,
           'conf_loss': 0.017266944,
           'precision50': 0.39478996,
           'recall50': 0.16136016},
     '4': {'avg_iou': 0.6948356,
           'avg_obj': 0.3678442,
           'box_loss': 0.009847472,
           'class_loss': 0.002882826,
           'conf_loss': 0.015469749,
           'precision50': 0.6392496,
           'recall50': 0.37778878},
     '5': {'avg_iou': 0.76197386,
           'avg_obj': 0.48386747,
           'box_loss': 0.009227274,
           'class_loss': 0.002987714,
           'conf_loss': 0.012281538,
           'precision50': 0.75094646,
           'recall50': 0.530753},
     'AP': 0.36226916,
     'AP50': 0.57664794,
     'AP75': 0.38373163,
     'APl': 0.50779206,
     'APm': 0.3772268,
     'APs': 0.151541,
     'ARl': 0.6647574,
     'ARm': 0.5680223,
     'ARmax1': 0.29936048,
     'ARmax10': 0.4831689,
     'ARmax100': 0.52768004,
     'ARs': 0.30597287,
     'global': {'total_loss': 0.08305882},
     'validation_loss': 0.08305882}
I0518 06:15:01.221345 139627049523008 controller.py:211] train | step:  60000 | training until step 80000...
I0518 07:49:31.477117 139627049523008 controller.py:425] train | step:  70000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.6274375,
           'avg_obj': 0.24518816,
           'box_loss': 0.11876609,
           'class_loss': 0.04139602,
           'conf_loss': 0.20669357,
           'precision50': 0.5223044,
           'recall50': 0.16049895},
     '4': {'avg_iou': 0.73565865,
           'avg_obj': 0.38866103,
           'box_loss': 0.09455766,
           'class_loss': 0.03236925,
           'conf_loss': 0.17736948,
           'precision50': 0.72648007,
           'recall50': 0.3738484},
     '5': {'avg_iou': 0.7727776,
           'avg_obj': 0.49066436,
           'box_loss': 0.08422404,
           'class_loss': 0.029522143,
           'conf_loss': 0.11668618,
           'precision50': 0.79937994,
           'recall50': 0.53285},
     'global': {'total_loss': 0.9015839},
     'learning_rate': 0.009314038,
     'training_loss': 0.9015839}

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-30000.
train | step:  40000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.60760325,
           'avg_obj': 0.21467644,
           'box_loss': 0.12570351,
           'class_loss': 0.04885729,
           'conf_loss': 0.21467046,
           'precision50': 0.48592985,
           'recall50': 0.1278849},
     '4': {'avg_iou': 0.71332395,
           'avg_obj': 0.34891757,
           'box_loss': 0.10332653,
           'class_loss': 0.03949953,
           'conf_loss': 0.18664536,
           'precision50': 0.7022249,
           'recall50': 0.31994474},
     '5': {'avg_iou': 0.74909705,
           'avg_obj': 0.4473389,
           'box_loss': 0.09367006,
           'class_loss': 0.03586757,
           'conf_loss': 0.12397937,
           'precision50': 0.7814416,
           'recall50': 0.47590113},
     'global': {'total_loss': 0.9722198},
     'learning_rate': 0.00977151,
     'training_loss': 0.9722198}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-40000.
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=171.80s).
Accumulating evaluation results...
DONE (t=16.30s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.345
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.560
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.367
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.138
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.359
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.486
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.290
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.469
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.514
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.287
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.552
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.651
 eval | step:  40000 | eval time:  488.0 sec | output: 
    {'3': {'avg_iou': 0.47693354,
           'avg_obj': 0.17930274,
           'box_loss': 0.010437131,
           'class_loss': 0.003181786,
           'conf_loss': 0.01743403,
           'precision50': 0.38265765,
           'recall50': 0.14774866},
     '4': {'avg_iou': 0.68736184,
           'avg_obj': 0.34999418,
           'box_loss': 0.010225515,
           'class_loss': 0.0030701407,
           'conf_loss': 0.015689773,
           'precision50': 0.63092154,
           'recall50': 0.35155678},
     '5': {'avg_iou': 0.7549543,
           'avg_obj': 0.46569252,
           'box_loss': 0.009583327,
           'class_loss': 0.0031193828,
           'conf_loss': 0.012558811,
           'precision50': 0.7472738,
           'recall50': 0.50774163},
     'AP': 0.34506756,
     'AP50': 0.5600606,
     'AP75': 0.3666162,
     'APl': 0.48575252,
     'APm': 0.35862973,
     'APs': 0.13794164,
     'ARl': 0.651204,
     'ARm': 0.55156446,
     'ARmax1': 0.28980508,
     'ARmax10': 0.46920815,
     'ARmax100': 0.513965,
     'ARs': 0.28727272,
     'global': {'total_loss': 0.08529994},
     'validation_loss': 0.08529994}
train | step:  40000 | training until step 60000...
train | step:  50000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.615781,
           'avg_obj': 0.22703843,
           'box_loss': 0.12288033,
           'class_loss': 0.045682687,
           'conf_loss': 0.21133284,
           'precision50': 0.50069153,
           'recall50': 0.14106807},
     '4': {'avg_iou': 0.72280896,
           'avg_obj': 0.36539668,
           'box_loss': 0.09962603,
           'class_loss': 0.036392745,
           'conf_loss': 0.18278514,
           'precision50': 0.7128334,
           'recall50': 0.34244916},
     '5': {'avg_iou': 0.7591995,
           'avg_obj': 0.46544108,
           'box_loss': 0.08967631,
           'class_loss': 0.033130843,
           'conf_loss': 0.12094618,
           'precision50': 0.7889384,
           'recall50': 0.5001093},
     'global': {'total_loss': 0.94245255},
     'learning_rate': 0.0096449135,
     'training_loss': 0.94245255}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-50000.
train | step:  60000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6216424,
           'avg_obj': 0.23591308,
           'box_loss': 0.12089655,
           'class_loss': 0.043733556,
           'conf_loss': 0.20953304,
           'precision50': 0.51179874,
           'recall50': 0.15054156},
     '4': {'avg_iou': 0.72931033,
           'avg_obj': 0.37630513,
           'box_loss': 0.097146615,
           'class_loss': 0.034574617,
           'conf_loss': 0.1805718,
           'precision50': 0.71883756,
           'recall50': 0.357013},
     '5': {'avg_iou': 0.7658497,
           'avg_obj': 0.47644088,
           'box_loss': 0.08697214,
           'class_loss': 0.0316027,
           'conf_loss': 0.11931212,
           'precision50': 0.7928191,
           'recall50': 0.514358},
     'global': {'total_loss': 0.924343},
     'learning_rate': 0.009492056,
     'training_loss': 0.924343}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-60000.
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=174.78s).
Accumulating evaluation results...
DONE (t=14.32s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.362
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.577
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.384
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.152
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.377
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.508
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.299
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.483
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.528
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.306
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.568
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.665
 eval | step:  60000 | eval time:  497.8 sec | output: 
    {'3': {'avg_iou': 0.48334342,
           'avg_obj': 0.18875547,
           'box_loss': 0.0101117585,
           'class_loss': 0.0029835405,
           'conf_loss': 0.017266944,
           'precision50': 0.39478996,
           'recall50': 0.16136016},
     '4': {'avg_iou': 0.6948356,
           'avg_obj': 0.3678442,
           'box_loss': 0.009847472,
           'class_loss': 0.002882826,
           'conf_loss': 0.015469749,
           'precision50': 0.6392496,
           'recall50': 0.37778878},
     '5': {'avg_iou': 0.76197386,
           'avg_obj': 0.48386747,
           'box_loss': 0.009227274,
           'class_loss': 0.002987714,
           'conf_loss': 0.012281538,
           'precision50': 0.75094646,
           'recall50': 0.530753},
     'AP': 0.36226916,
     'AP50': 0.57664794,
     'AP75': 0.38373163,
     'APl': 0.50779206,
     'APm': 0.3772268,
     'APs': 0.151541,
     'ARl': 0.6647574,
     'ARm': 0.5680223,
     'ARmax1': 0.29936048,
     'ARmax10': 0.4831689,
     'ARmax100': 0.52768004,
     'ARs': 0.30597287,
     'global': {'total_loss': 0.08305882},
     'validation_loss': 0.08305882}
train | step:  60000 | training until step 80000...
train | step:  70000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.6274375,
           'avg_obj': 0.24518816,
           'box_loss': 0.11876609,
           'class_loss': 0.04139602,
           'conf_loss': 0.20669357,
           'precision50': 0.5223044,
           'recall50': 0.16049895},
     '4': {'avg_iou': 0.73565865,
           'avg_obj': 0.38866103,
           'box_loss': 0.09455766,
           'class_loss': 0.03236925,
           'conf_loss': 0.17736948,
           'precision50': 0.72648007,
           'recall50': 0.3738484},
     '5': {'avg_iou': 0.7727776,
           'avg_obj': 0.49066436,
           'box_loss': 0.08422404,
           'class_loss': 0.029522143,
           'conf_loss': 0.11668618,
           'precision50': 0.79937994,
           'recall50': 0.53285},
     'global': {'total_loss': 0.9015839},
     'learning_rate': 0.009314038,
     'training_loss': 0.9015839}I0518 07:50:31.200116 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-70000.
I0518 09:25:14.774132 139627049523008 controller.py:425] train | step:  80000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.63190085,
           'avg_obj': 0.2528116,
           'box_loss': 0.11736347,
           'class_loss': 0.03975531,
           'conf_loss': 0.20439231,
           'precision50': 0.531108,
           'recall50': 0.1690789},
     '4': {'avg_iou': 0.7405464,
           'avg_obj': 0.3985714,
           'box_loss': 0.09270209,
           'class_loss': 0.030870771,
           'conf_loss': 0.17474374,
           'precision50': 0.73212117,
           'recall50': 0.38717815},
     '5': {'avg_iou': 0.77778685,
           'avg_obj': 0.5010421,
           'box_loss': 0.082182355,
           'class_loss': 0.028180948,
           'conf_loss': 0.11462819,
           'precision50': 0.80341357,
           'recall50': 0.54600835},
     'global': {'total_loss': 0.884819},
     'learning_rate': 0.009112143,
     'training_loss': 0.884819}
I0518 09:26:15.040904 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-80000.
I0518 09:26:15.048691 139627049523008 controller.py:252]  eval | step:  80000 | running 625 steps of evaluation...
I0518 09:30:26.399502 139627049523008 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0518 09:34:33.463474 139627049523008 controller.py:261]  eval | step:  80000 | eval time:  498.4 sec | output: 
    {'3': {'avg_iou': 0.48718873,
           'avg_obj': 0.19820167,
           'box_loss': 0.009919277,
           'class_loss': 0.0029255915,
           'conf_loss': 0.017303253,
           'precision50': 0.40591314,
           'recall50': 0.1771518},
     '4': {'avg_iou': 0.6995381,
           'avg_obj': 0.3815547,
           'box_loss': 0.009610136,
           'class_loss': 0.002899813,
           'conf_loss': 0.015521884,
           'precision50': 0.6422829,
           'recall50': 0.39880648},
     '5': {'avg_iou': 0.7671658,
           'avg_obj': 0.50030726,
           'box_loss': 0.0089662345,
           'class_loss': 0.00296801,
           'conf_loss': 0.012295765,
           'precision50': 0.7483899,
           'recall50': 0.5506944},
     'AP': 0.37237504,
     'AP50': 0.58773255,
     'AP75': 0.3969505,
     'APl': 0.5215998,
     'APm': 0.38632736,
     'APs': 0.15991725,
     'ARl': 0.6743438,
     'ARm': 0.57001185,
     'ARmax1': 0.30559182,
     'ARmax10': 0.49283937,
     'ARmax100': 0.53694195,
     'ARs': 0.3256439,
     'global': {'total_loss': 0.08240995},
     'validation_loss': 0.08240995}
I0518 09:34:50.734410 139627049523008 controller.py:211] train | step:  80000 | training until step 100000...
I0518 11:08:08.874879 139627049523008 controller.py:425] train | step:  90000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.63564247,
           'avg_obj': 0.25975546,
           'box_loss': 0.11621195,
           'class_loss': 0.038514458,
           'conf_loss': 0.20260562,
           'precision50': 0.5380556,
           'recall50': 0.17643985},
     '4': {'avg_iou': 0.74488026,
           'avg_obj': 0.40736595,
           'box_loss': 0.091022864,
           'class_loss': 0.029612299,
           'conf_loss': 0.17266333,
           'precision50': 0.73649246,
           'recall50': 0.39876744},
     '5': {'avg_iou': 0.7824418,
           'avg_obj': 0.5108159,
           'box_loss': 0.08032193,
           'class_loss': 0.027051086,
           'conf_loss': 0.11289963,
           'precision50': 0.8065179,
           'recall50': 0.5582123},
     'global': {'total_loss': 0.8709044},
     'learning_rate': 0.008887824,
     'training_loss': 0.8709044}
I0518 11:09:10.042415 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-90000.
I0518 12:39:55.607345 139627049523008 controller.py:425] train | step:  100000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.63886064,
           'avg_obj': 0.26637584,
           'box_loss': 0.11491449,
           'class_loss': 0.037228215,
           'conf_loss': 0.20085874,
           'precision50': 0.5455913,
           'recall50': 0.18402745},
     '4': {'avg_iou': 0.74871004,
           'avg_obj': 0.41580278,
           'box_loss': 0.08957095,
           'class_loss': 0.028553396,
           'conf_loss': 0.17065692,
           'precision50': 0.7416497,
           'recall50': 0.41002303},
     '5': {'avg_iou': 0.7865769,
           'avg_obj': 0.5196557,
           'box_loss': 0.07870033,
           'class_loss': 0.026100986,
           'conf_loss': 0.11134348,
           'precision50': 0.81076336,
           'recall50': 0.56958395},
     'global': {'total_loss': 0.8579288},
     'learning_rate': 0.008642699,
     'training_loss': 0.8579288}
I0518 12:40:55.748456 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-100000.
I0518 12:40:55.754340 139627049523008 controller.py:252]  eval | step:  100000 | running 625 steps of evaluation...
I0518 12:45:08.666965 139627049523008 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0518 12:49:07.159725 139627049523008 controller.py:261]  eval | step:  100000 | eval time:  491.4 sec | output: 
    {'3': {'avg_iou': 0.4895587,
           'avg_obj': 0.20167883,
           'box_loss': 0.009803437,
           'class_loss': 0.0028951725,
           'conf_loss': 0.017385723,
           'precision50': 0.40590304,
           'recall50': 0.1833765},
     '4': {'avg_iou': 0.70192266,
           'avg_obj': 0.38941702,
           'box_loss': 0.009491278,
           'class_loss': 0.0029113148,
           'conf_loss': 0.015595659,
           'precision50': 0.64151466,
           'recall50': 0.41033092},
     '5': {'avg_iou': 0.7697318,
           'avg_obj': 0.50891,
           'box_loss': 0.0088386005,
           'class_loss': 0.0029613338,
           'conf_loss': 0.012251611,
           'precision50': 0.7460086,
           'recall50': 0.56257683},
     'AP': 0.37812594,
     'AP50': 0.58926034,
     'AP75': 0.4030471,
     'APl': 0.52986026,
     'APm': 0.3922118,
     'APs': 0.1629903,
     'ARl': 0.67723256,
     'ARm': 0.57343704,
     'ARmax1': 0.31065872,
     'ARmax10': 0.49727488,
     'ARmax100': 0.539995,
     'ARs': 0.33238593,
     'global': {'total_loss': 0.08213419},
     'validation_loss': 0.08213419}
I0518 12:49:28.782079 139627049523008 controller.py:211] train | step:  100000 | training until step 120000...
I0518 14:19:18.631070 139627049523008 controller.py:425] train | step:  110000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6419223,
           'avg_obj': 0.27227345,
           'box_loss': 0.11381596,
           'class_loss': 0.03607041,
           'conf_loss': 0.19889319,
           'precision50': 0.55122066,
           'recall50': 0.19053197},
     '4': {'avg_iou': 0.7520122,
           'avg_obj': 0.42314848,
           'box_loss': 0.08822373,
           'class_loss': 0.027526861,
           'conf_loss': 0.16852608,
           'precision50': 0.7458037,
           'recall50': 0.41950762},
     '5': {'avg_iou': 0.79019713,
           'avg_obj': 0.5272345,
           'box_loss': 0.07721854,
           'class_loss': 0.025193714,
           'conf_loss': 0.1098375,
           'precision50': 0.8133898,
           'recall50': 0.5782758},
     'global': {'total_loss': 0.84530526},
     'learning_rate': 0.008378533,
     'training_loss': 0.84530526}

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-70000.
train | step:  80000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.63190085,
           'avg_obj': 0.2528116,
           'box_loss': 0.11736347,
           'class_loss': 0.03975531,
           'conf_loss': 0.20439231,
           'precision50': 0.531108,
           'recall50': 0.1690789},
     '4': {'avg_iou': 0.7405464,
           'avg_obj': 0.3985714,
           'box_loss': 0.09270209,
           'class_loss': 0.030870771,
           'conf_loss': 0.17474374,
           'precision50': 0.73212117,
           'recall50': 0.38717815},
     '5': {'avg_iou': 0.77778685,
           'avg_obj': 0.5010421,
           'box_loss': 0.082182355,
           'class_loss': 0.028180948,
           'conf_loss': 0.11462819,
           'precision50': 0.80341357,
           'recall50': 0.54600835},
     'global': {'total_loss': 0.884819},
     'learning_rate': 0.009112143,
     'training_loss': 0.884819}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-80000.
 eval | step:  80000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=174.60s).
Accumulating evaluation results...
DONE (t=14.72s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.372
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.588
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.397
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.160
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.386
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.522
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.306
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.493
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.537
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.326
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.570
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.674
 eval | step:  80000 | eval time:  498.4 sec | output: 
    {'3': {'avg_iou': 0.48718873,
           'avg_obj': 0.19820167,
           'box_loss': 0.009919277,
           'class_loss': 0.0029255915,
           'conf_loss': 0.017303253,
           'precision50': 0.40591314,
           'recall50': 0.1771518},
     '4': {'avg_iou': 0.6995381,
           'avg_obj': 0.3815547,
           'box_loss': 0.009610136,
           'class_loss': 0.002899813,
           'conf_loss': 0.015521884,
           'precision50': 0.6422829,
           'recall50': 0.39880648},
     '5': {'avg_iou': 0.7671658,
           'avg_obj': 0.50030726,
           'box_loss': 0.0089662345,
           'class_loss': 0.00296801,
           'conf_loss': 0.012295765,
           'precision50': 0.7483899,
           'recall50': 0.5506944},
     'AP': 0.37237504,
     'AP50': 0.58773255,
     'AP75': 0.3969505,
     'APl': 0.5215998,
     'APm': 0.38632736,
     'APs': 0.15991725,
     'ARl': 0.6743438,
     'ARm': 0.57001185,
     'ARmax1': 0.30559182,
     'ARmax10': 0.49283937,
     'ARmax100': 0.53694195,
     'ARs': 0.3256439,
     'global': {'total_loss': 0.08240995},
     'validation_loss': 0.08240995}
train | step:  80000 | training until step 100000...
train | step:  90000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.63564247,
           'avg_obj': 0.25975546,
           'box_loss': 0.11621195,
           'class_loss': 0.038514458,
           'conf_loss': 0.20260562,
           'precision50': 0.5380556,
           'recall50': 0.17643985},
     '4': {'avg_iou': 0.74488026,
           'avg_obj': 0.40736595,
           'box_loss': 0.091022864,
           'class_loss': 0.029612299,
           'conf_loss': 0.17266333,
           'precision50': 0.73649246,
           'recall50': 0.39876744},
     '5': {'avg_iou': 0.7824418,
           'avg_obj': 0.5108159,
           'box_loss': 0.08032193,
           'class_loss': 0.027051086,
           'conf_loss': 0.11289963,
           'precision50': 0.8065179,
           'recall50': 0.5582123},
     'global': {'total_loss': 0.8709044},
     'learning_rate': 0.008887824,
     'training_loss': 0.8709044}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-90000.
train | step:  100000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.63886064,
           'avg_obj': 0.26637584,
           'box_loss': 0.11491449,
           'class_loss': 0.037228215,
           'conf_loss': 0.20085874,
           'precision50': 0.5455913,
           'recall50': 0.18402745},
     '4': {'avg_iou': 0.74871004,
           'avg_obj': 0.41580278,
           'box_loss': 0.08957095,
           'class_loss': 0.028553396,
           'conf_loss': 0.17065692,
           'precision50': 0.7416497,
           'recall50': 0.41002303},
     '5': {'avg_iou': 0.7865769,
           'avg_obj': 0.5196557,
           'box_loss': 0.07870033,
           'class_loss': 0.026100986,
           'conf_loss': 0.11134348,
           'precision50': 0.81076336,
           'recall50': 0.56958395},
     'global': {'total_loss': 0.8579288},
     'learning_rate': 0.008642699,
     'training_loss': 0.8579288}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-100000.
 eval | step:  100000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=173.77s).
Accumulating evaluation results...
DONE (t=12.75s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.378
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.589
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.403
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.163
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.392
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.530
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.311
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.497
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.540
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.332
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.573
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.677
 eval | step:  100000 | eval time:  491.4 sec | output: 
    {'3': {'avg_iou': 0.4895587,
           'avg_obj': 0.20167883,
           'box_loss': 0.009803437,
           'class_loss': 0.0028951725,
           'conf_loss': 0.017385723,
           'precision50': 0.40590304,
           'recall50': 0.1833765},
     '4': {'avg_iou': 0.70192266,
           'avg_obj': 0.38941702,
           'box_loss': 0.009491278,
           'class_loss': 0.0029113148,
           'conf_loss': 0.015595659,
           'precision50': 0.64151466,
           'recall50': 0.41033092},
     '5': {'avg_iou': 0.7697318,
           'avg_obj': 0.50891,
           'box_loss': 0.0088386005,
           'class_loss': 0.0029613338,
           'conf_loss': 0.012251611,
           'precision50': 0.7460086,
           'recall50': 0.56257683},
     'AP': 0.37812594,
     'AP50': 0.58926034,
     'AP75': 0.4030471,
     'APl': 0.52986026,
     'APm': 0.3922118,
     'APs': 0.1629903,
     'ARl': 0.67723256,
     'ARm': 0.57343704,
     'ARmax1': 0.31065872,
     'ARmax10': 0.49727488,
     'ARmax100': 0.539995,
     'ARs': 0.33238593,
     'global': {'total_loss': 0.08213419},
     'validation_loss': 0.08213419}
train | step:  100000 | training until step 120000...
train | step:  110000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6419223,
           'avg_obj': 0.27227345,
           'box_loss': 0.11381596,
           'class_loss': 0.03607041,
           'conf_loss': 0.19889319,
           'precision50': 0.55122066,
           'recall50': 0.19053197},
     '4': {'avg_iou': 0.7520122,
           'avg_obj': 0.42314848,
           'box_loss': 0.08822373,
           'class_loss': 0.027526861,
           'conf_loss': 0.16852608,
           'precision50': 0.7458037,
           'recall50': 0.41950762},
     '5': {'avg_iou': 0.79019713,
           'avg_obj': 0.5272345,
           'box_loss': 0.07721854,
           'class_loss': 0.025193714,
           'conf_loss': 0.1098375,
           'precision50': 0.8133898,
           'recall50': 0.5782758},
     'global': {'total_loss': 0.84530526},
     'learning_rate': 0.008378533,
     'training_loss': 0.84530526}I0518 14:20:17.154007 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-110000.
I0518 15:50:07.832175 139627049523008 controller.py:425] train | step:  120000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6443539,
           'avg_obj': 0.27789235,
           'box_loss': 0.11296836,
           'class_loss': 0.035184175,
           'conf_loss': 0.19734687,
           'precision50': 0.5570583,
           'recall50': 0.19683726},
     '4': {'avg_iou': 0.75507087,
           'avg_obj': 0.43033546,
           'box_loss': 0.08702237,
           'class_loss': 0.026632305,
           'conf_loss': 0.1667147,
           'precision50': 0.74935746,
           'recall50': 0.42896095},
     '5': {'avg_iou': 0.7932197,
           'avg_obj': 0.53490585,
           'box_loss': 0.07597826,
           'class_loss': 0.02445493,
           'conf_loss': 0.10819168,
           'precision50': 0.816105,
           'recall50': 0.5877773},
     'global': {'total_loss': 0.83449286},
     'learning_rate': 0.008097229,
     'training_loss': 0.83449286}
I0518 15:51:05.650241 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-120000.
I0518 15:51:05.656000 139627049523008 controller.py:252]  eval | step:  120000 | running 625 steps of evaluation...
I0518 15:55:14.201179 139627049523008 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0518 15:59:21.037684 139627049523008 controller.py:261]  eval | step:  120000 | eval time:  495.4 sec | output: 
    {'3': {'avg_iou': 0.49074137,
           'avg_obj': 0.20558919,
           'box_loss': 0.009744543,
           'class_loss': 0.002898745,
           'conf_loss': 0.01755363,
           'precision50': 0.40868795,
           'recall50': 0.19096135},
     '4': {'avg_iou': 0.7025618,
           'avg_obj': 0.39511472,
           'box_loss': 0.009459559,
           'class_loss': 0.0029681923,
           'conf_loss': 0.015804866,
           'precision50': 0.6381675,
           'recall50': 0.41936857},
     '5': {'avg_iou': 0.77081513,
           'avg_obj': 0.51609236,
           'box_loss': 0.008788113,
           'class_loss': 0.002993176,
           'conf_loss': 0.012408503,
           'precision50': 0.7438937,
           'recall50': 0.56869715},
     'AP': 0.37942883,
     'AP50': 0.59126556,
     'AP75': 0.40240538,
     'APl': 0.5297534,
     'APm': 0.39505732,
     'APs': 0.16748801,
     'ARl': 0.6712362,
     'ARm': 0.57321864,
     'ARmax1': 0.3102608,
     'ARmax10': 0.4962942,
     'ARmax100': 0.538582,
     'ARs': 0.33100435,
     'global': {'total_loss': 0.082619354},
     'validation_loss': 0.082619354}
I0518 15:59:43.473611 139627049523008 controller.py:211] train | step:  120000 | training until step 140000...
I0518 17:24:37.640109 139627049523008 controller.py:425] train | step:  130000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.646995,
           'avg_obj': 0.28338134,
           'box_loss': 0.11208302,
           'class_loss': 0.03421695,
           'conf_loss': 0.19589236,
           'precision50': 0.56223106,
           'recall50': 0.203128},
     '4': {'avg_iou': 0.7577978,
           'avg_obj': 0.4366188,
           'box_loss': 0.08594562,
           'class_loss': 0.02587869,
           'conf_loss': 0.16467574,
           'precision50': 0.75273913,
           'recall50': 0.43689418},
     '5': {'avg_iou': 0.7962517,
           'avg_obj': 0.5414376,
           'box_loss': 0.074796446,
           'class_loss': 0.023734309,
           'conf_loss': 0.10676681,
           'precision50': 0.81840247,
           'recall50': 0.5951472},
     'global': {'total_loss': 0.8239905},
     'learning_rate': 0.007800815,
     'training_loss': 0.8239905}
I0518 17:25:38.659898 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-130000.
I0518 18:53:15.510285 139627049523008 controller.py:425] train | step:  140000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6493784,
           'avg_obj': 0.2880718,
           'box_loss': 0.111168444,
           'class_loss': 0.03345735,
           'conf_loss': 0.1939247,
           'precision50': 0.5668328,
           'recall50': 0.20891482},
     '4': {'avg_iou': 0.7606564,
           'avg_obj': 0.44327924,
           'box_loss': 0.084913604,
           'class_loss': 0.025183698,
           'conf_loss': 0.16303271,
           'precision50': 0.75676113,
           'recall50': 0.4461764},
     '5': {'avg_iou': 0.7993448,
           'avg_obj': 0.548309,
           'box_loss': 0.07361423,
           'class_loss': 0.023065774,
           'conf_loss': 0.10567534,
           'precision50': 0.8209127,
           'recall50': 0.60342604},
     'global': {'total_loss': 0.8140345},
     'learning_rate': 0.007491425,
     'training_loss': 0.8140345}
I0518 18:54:14.838672 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-140000.
I0518 18:54:14.845003 139627049523008 controller.py:252]  eval | step:  140000 | running 625 steps of evaluation...
I0518 18:58:24.757531 139627049523008 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0518 19:02:38.187425 139627049523008 controller.py:261]  eval | step:  140000 | eval time:  503.3 sec | output: 
    {'3': {'avg_iou': 0.4914957,
           'avg_obj': 0.20685613,
           'box_loss': 0.00970713,
           'class_loss': 0.002983658,
           'conf_loss': 0.017641777,
           'precision50': 0.411804,
           'recall50': 0.19311185},
     '4': {'avg_iou': 0.70285887,
           'avg_obj': 0.39777648,
           'box_loss': 0.009445354,
           'class_loss': 0.003040571,
           'conf_loss': 0.015900377,
           'precision50': 0.6380341,
           'recall50': 0.42344502},
     '5': {'avg_iou': 0.77216214,
           'avg_obj': 0.5196012,
           'box_loss': 0.008717855,
           'class_loss': 0.0030357686,
           'conf_loss': 0.01249595,
           'precision50': 0.74292016,
           'recall50': 0.5730079},
     'AP': 0.38071015,
     'AP50': 0.5904141,
     'AP75': 0.40507194,
     'APl': 0.53105533,
     'APm': 0.3959289,
     'APs': 0.17118004,
     'ARl': 0.67250764,
     'ARm': 0.5735308,
     'ARmax1': 0.31021369,
     'ARmax10': 0.49566668,
     'ARmax100': 0.5390067,
     'ARs': 0.33556607,
     'global': {'total_loss': 0.08296852},
     'validation_loss': 0.08296852}
I0518 19:02:55.145503 139627049523008 controller.py:211] train | step:  140000 | training until step 160000...
I0518 20:28:18.968941 139627049523008 controller.py:425] train | step:  150000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.65144026,
           'avg_obj': 0.29339626,
           'box_loss': 0.110533975,
           'class_loss': 0.032644447,
           'conf_loss': 0.19273064,
           'precision50': 0.5722984,
           'recall50': 0.21485771},
     '4': {'avg_iou': 0.76314527,
           'avg_obj': 0.44939154,
           'box_loss': 0.08389822,
           'class_loss': 0.024563543,
           'conf_loss': 0.16166651,
           'precision50': 0.75968635,
           'recall50': 0.45393926},
     '5': {'avg_iou': 0.80174047,
           'avg_obj': 0.55461335,
           'box_loss': 0.072640665,
           'class_loss': 0.022522798,
           'conf_loss': 0.10445668,
           'precision50': 0.82325244,
           'recall50': 0.6105252},
     'global': {'total_loss': 0.80565584},
     'learning_rate': 0.007171291,
     'training_loss': 0.80565584}

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-110000.
train | step:  120000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6443539,
           'avg_obj': 0.27789235,
           'box_loss': 0.11296836,
           'class_loss': 0.035184175,
           'conf_loss': 0.19734687,
           'precision50': 0.5570583,
           'recall50': 0.19683726},
     '4': {'avg_iou': 0.75507087,
           'avg_obj': 0.43033546,
           'box_loss': 0.08702237,
           'class_loss': 0.026632305,
           'conf_loss': 0.1667147,
           'precision50': 0.74935746,
           'recall50': 0.42896095},
     '5': {'avg_iou': 0.7932197,
           'avg_obj': 0.53490585,
           'box_loss': 0.07597826,
           'class_loss': 0.02445493,
           'conf_loss': 0.10819168,
           'precision50': 0.816105,
           'recall50': 0.5877773},
     'global': {'total_loss': 0.83449286},
     'learning_rate': 0.008097229,
     'training_loss': 0.83449286}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-120000.
 eval | step:  120000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.45s).
Accumulating evaluation results...
DONE (t=12.69s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.379
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.591
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.402
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.167
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.395
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.530
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.310
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.496
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.539
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.331
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.573
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.671
 eval | step:  120000 | eval time:  495.4 sec | output: 
    {'3': {'avg_iou': 0.49074137,
           'avg_obj': 0.20558919,
           'box_loss': 0.009744543,
           'class_loss': 0.002898745,
           'conf_loss': 0.01755363,
           'precision50': 0.40868795,
           'recall50': 0.19096135},
     '4': {'avg_iou': 0.7025618,
           'avg_obj': 0.39511472,
           'box_loss': 0.009459559,
           'class_loss': 0.0029681923,
           'conf_loss': 0.015804866,
           'precision50': 0.6381675,
           'recall50': 0.41936857},
     '5': {'avg_iou': 0.77081513,
           'avg_obj': 0.51609236,
           'box_loss': 0.008788113,
           'class_loss': 0.002993176,
           'conf_loss': 0.012408503,
           'precision50': 0.7438937,
           'recall50': 0.56869715},
     'AP': 0.37942883,
     'AP50': 0.59126556,
     'AP75': 0.40240538,
     'APl': 0.5297534,
     'APm': 0.39505732,
     'APs': 0.16748801,
     'ARl': 0.6712362,
     'ARm': 0.57321864,
     'ARmax1': 0.3102608,
     'ARmax10': 0.4962942,
     'ARmax100': 0.538582,
     'ARs': 0.33100435,
     'global': {'total_loss': 0.082619354},
     'validation_loss': 0.082619354}
train | step:  120000 | training until step 140000...
train | step:  130000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.646995,
           'avg_obj': 0.28338134,
           'box_loss': 0.11208302,
           'class_loss': 0.03421695,
           'conf_loss': 0.19589236,
           'precision50': 0.56223106,
           'recall50': 0.203128},
     '4': {'avg_iou': 0.7577978,
           'avg_obj': 0.4366188,
           'box_loss': 0.08594562,
           'class_loss': 0.02587869,
           'conf_loss': 0.16467574,
           'precision50': 0.75273913,
           'recall50': 0.43689418},
     '5': {'avg_iou': 0.7962517,
           'avg_obj': 0.5414376,
           'box_loss': 0.074796446,
           'class_loss': 0.023734309,
           'conf_loss': 0.10676681,
           'precision50': 0.81840247,
           'recall50': 0.5951472},
     'global': {'total_loss': 0.8239905},
     'learning_rate': 0.007800815,
     'training_loss': 0.8239905}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-130000.
train | step:  140000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6493784,
           'avg_obj': 0.2880718,
           'box_loss': 0.111168444,
           'class_loss': 0.03345735,
           'conf_loss': 0.1939247,
           'precision50': 0.5668328,
           'recall50': 0.20891482},
     '4': {'avg_iou': 0.7606564,
           'avg_obj': 0.44327924,
           'box_loss': 0.084913604,
           'class_loss': 0.025183698,
           'conf_loss': 0.16303271,
           'precision50': 0.75676113,
           'recall50': 0.4461764},
     '5': {'avg_iou': 0.7993448,
           'avg_obj': 0.548309,
           'box_loss': 0.07361423,
           'class_loss': 0.023065774,
           'conf_loss': 0.10567534,
           'precision50': 0.8209127,
           'recall50': 0.60342604},
     'global': {'total_loss': 0.8140345},
     'learning_rate': 0.007491425,
     'training_loss': 0.8140345}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-140000.
 eval | step:  140000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=187.35s).
Accumulating evaluation results...
DONE (t=12.00s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.381
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.590
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.405
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.171
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.396
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.531
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.310
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.496
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.539
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.336
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.574
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.673
 eval | step:  140000 | eval time:  503.3 sec | output: 
    {'3': {'avg_iou': 0.4914957,
           'avg_obj': 0.20685613,
           'box_loss': 0.00970713,
           'class_loss': 0.002983658,
           'conf_loss': 0.017641777,
           'precision50': 0.411804,
           'recall50': 0.19311185},
     '4': {'avg_iou': 0.70285887,
           'avg_obj': 0.39777648,
           'box_loss': 0.009445354,
           'class_loss': 0.003040571,
           'conf_loss': 0.015900377,
           'precision50': 0.6380341,
           'recall50': 0.42344502},
     '5': {'avg_iou': 0.77216214,
           'avg_obj': 0.5196012,
           'box_loss': 0.008717855,
           'class_loss': 0.0030357686,
           'conf_loss': 0.01249595,
           'precision50': 0.74292016,
           'recall50': 0.5730079},
     'AP': 0.38071015,
     'AP50': 0.5904141,
     'AP75': 0.40507194,
     'APl': 0.53105533,
     'APm': 0.3959289,
     'APs': 0.17118004,
     'ARl': 0.67250764,
     'ARm': 0.5735308,
     'ARmax1': 0.31021369,
     'ARmax10': 0.49566668,
     'ARmax100': 0.5390067,
     'ARs': 0.33556607,
     'global': {'total_loss': 0.08296852},
     'validation_loss': 0.08296852}
train | step:  140000 | training until step 160000...
train | step:  150000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.65144026,
           'avg_obj': 0.29339626,
           'box_loss': 0.110533975,
           'class_loss': 0.032644447,
           'conf_loss': 0.19273064,
           'precision50': 0.5722984,
           'recall50': 0.21485771},
     '4': {'avg_iou': 0.76314527,
           'avg_obj': 0.44939154,
           'box_loss': 0.08389822,
           'class_loss': 0.024563543,
           'conf_loss': 0.16166651,
           'precision50': 0.75968635,
           'recall50': 0.45393926},
     '5': {'avg_iou': 0.80174047,
           'avg_obj': 0.55461335,
           'box_loss': 0.072640665,
           'class_loss': 0.022522798,
           'conf_loss': 0.10445668,
           'precision50': 0.82325244,
           'recall50': 0.6105252},
     'global': {'total_loss': 0.80565584},
     'learning_rate': 0.007171291,
     'training_loss': 0.80565584}I0518 20:29:18.129284 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-150000.
I0518 21:59:25.862948 139627049523008 controller.py:425] train | step:  160000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6535503,
           'avg_obj': 0.2979819,
           'box_loss': 0.10973268,
           'class_loss': 0.03197645,
           'conf_loss': 0.19066049,
           'precision50': 0.5748081,
           'recall50': 0.22006482},
     '4': {'avg_iou': 0.7654064,
           'avg_obj': 0.45492724,
           'box_loss': 0.082915716,
           'class_loss': 0.023922348,
           'conf_loss': 0.15969422,
           'precision50': 0.76183337,
           'recall50': 0.4611388},
     '5': {'avg_iou': 0.8043849,
           'avg_obj': 0.5603859,
           'box_loss': 0.07151485,
           'class_loss': 0.022026012,
           'conf_loss': 0.1030805,
           'precision50': 0.82522947,
           'recall50': 0.61715317},
     'global': {'total_loss': 0.7955256},
     'learning_rate': 0.0068427175,
     'training_loss': 0.7955256}
I0518 22:00:23.289582 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-160000.
I0518 22:00:23.296303 139627049523008 controller.py:252]  eval | step:  160000 | running 625 steps of evaluation...
I0518 22:04:35.095871 139627049523008 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0518 22:08:50.375060 139627049523008 controller.py:261]  eval | step:  160000 | eval time:  507.1 sec | output: 
    {'3': {'avg_iou': 0.4916375,
           'avg_obj': 0.20885141,
           'box_loss': 0.00969941,
           'class_loss': 0.0030547902,
           'conf_loss': 0.017848097,
           'precision50': 0.41138512,
           'recall50': 0.19797625},
     '4': {'avg_iou': 0.7025698,
           'avg_obj': 0.4017453,
           'box_loss': 0.009459954,
           'class_loss': 0.0031054532,
           'conf_loss': 0.016166016,
           'precision50': 0.63545036,
           'recall50': 0.4309872},
     '5': {'avg_iou': 0.7720013,
           'avg_obj': 0.52406156,
           'box_loss': 0.008727467,
           'class_loss': 0.0030939907,
           'conf_loss': 0.012661539,
           'precision50': 0.73938715,
           'recall50': 0.5787632},
     'AP': 0.38061467,
     'AP50': 0.5890805,
     'AP75': 0.40674877,
     'APl': 0.5319899,
     'APm': 0.39443883,
     'APs': 0.16817388,
     'ARl': 0.6725605,
     'ARm': 0.5669666,
     'ARmax1': 0.3091106,
     'ARmax10': 0.49546087,
     'ARmax100': 0.5371166,
     'ARs': 0.3359736,
     'global': {'total_loss': 0.083816774},
     'validation_loss': 0.083816774}
I0518 22:09:08.461164 139627049523008 controller.py:211] train | step:  160000 | training until step 180000...
I0518 23:35:12.402819 139627049523008 controller.py:425] train | step:  170000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.65566194,
           'avg_obj': 0.30241966,
           'box_loss': 0.10898959,
           'class_loss': 0.031386472,
           'conf_loss': 0.18972579,
           'precision50': 0.57968146,
           'recall50': 0.22499992},
     '4': {'avg_iou': 0.7676557,
           'avg_obj': 0.46041358,
           'box_loss': 0.08201281,
           'class_loss': 0.023466874,
           'conf_loss': 0.15851095,
           'precision50': 0.76449716,
           'recall50': 0.46787867},
     '5': {'avg_iou': 0.8066772,
           'avg_obj': 0.56596166,
           'box_loss': 0.07064061,
           'class_loss': 0.021541009,
           'conf_loss': 0.10198154,
           'precision50': 0.8272957,
           'recall50': 0.6236696},
     'global': {'total_loss': 0.7882579},
     'learning_rate': 0.0065080714,
     'training_loss': 0.7882579}
I0518 23:36:11.127265 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-170000.
I0519 01:07:51.006846 139627049523008 controller.py:425] train | step:  180000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6571893,
           'avg_obj': 0.30681357,
           'box_loss': 0.10848143,
           'class_loss': 0.030892618,
           'conf_loss': 0.18841879,
           'precision50': 0.5839926,
           'recall50': 0.23063652},
     '4': {'avg_iou': 0.7696019,
           'avg_obj': 0.46550617,
           'box_loss': 0.08130532,
           'class_loss': 0.022953661,
           'conf_loss': 0.1570307,
           'precision50': 0.7675758,
           'recall50': 0.4744408},
     '5': {'avg_iou': 0.80891174,
           'avg_obj': 0.57137567,
           'box_loss': 0.0697817,
           'class_loss': 0.02110712,
           'conf_loss': 0.100964814,
           'precision50': 0.8293437,
           'recall50': 0.6297674},
     'global': {'total_loss': 0.78093755},
     'learning_rate': 0.0061697643,
     'training_loss': 0.78093755}
I0519 01:08:50.403882 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-180000.
I0519 01:08:50.410148 139627049523008 controller.py:252]  eval | step:  180000 | running 625 steps of evaluation...
I0519 01:13:00.553925 139627049523008 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0519 01:17:04.244845 139627049523008 controller.py:261]  eval | step:  180000 | eval time:  493.8 sec | output: 
    {'3': {'avg_iou': 0.49151534,
           'avg_obj': 0.21064067,
           'box_loss': 0.009708618,
           'class_loss': 0.0031106141,
           'conf_loss': 0.01808664,
           'precision50': 0.41059926,
           'recall50': 0.20201686},
     '4': {'avg_iou': 0.7018954,
           'avg_obj': 0.40287238,
           'box_loss': 0.009495343,
           'class_loss': 0.0031886753,
           'conf_loss': 0.016499696,
           'precision50': 0.6354043,
           'recall50': 0.43310165},
     '5': {'avg_iou': 0.7718679,
           'avg_obj': 0.52785486,
           'box_loss': 0.008736264,
           'class_loss': 0.0031793185,
           'conf_loss': 0.012894702,
           'precision50': 0.738842,
           'recall50': 0.58261395},
     'AP': 0.37900078,
     'AP50': 0.58719474,
     'AP75': 0.40401736,
     'APl': 0.5267001,
     'APm': 0.3929685,
     'APs': 0.16347633,
     'ARl': 0.66778326,
     'ARm': 0.56157106,
     'ARmax1': 0.31090337,
     'ARmax10': 0.49344602,
     'ARmax100': 0.53544366,
     'ARs': 0.33289897,
     'global': {'total_loss': 0.08489988},
     'validation_loss': 0.08489988}
I0519 01:17:23.826787 139627049523008 controller.py:211] train | step:  180000 | training until step 200000...
I0519 02:42:58.933600 139627049523008 controller.py:425] train | step:  190000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6589379,
           'avg_obj': 0.3108571,
           'box_loss': 0.10791098,
           'class_loss': 0.030330902,
           'conf_loss': 0.187418,
           'precision50': 0.5884453,
           'recall50': 0.23548163},
     '4': {'avg_iou': 0.7717891,
           'avg_obj': 0.4708899,
           'box_loss': 0.080520004,
           'class_loss': 0.022572843,
           'conf_loss': 0.15589803,
           'precision50': 0.7697616,
           'recall50': 0.481097},
     '5': {'avg_iou': 0.8109194,
           'avg_obj': 0.5768747,
           'box_loss': 0.069002084,
           'class_loss': 0.020706704,
           'conf_loss': 0.099872135,
           'precision50': 0.83144933,
           'recall50': 0.63584965},
     'global': {'total_loss': 0.7742335},
     'learning_rate': 0.0058302353,
     'training_loss': 0.7742335}

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-150000.
train | step:  160000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6535503,
           'avg_obj': 0.2979819,
           'box_loss': 0.10973268,
           'class_loss': 0.03197645,
           'conf_loss': 0.19066049,
           'precision50': 0.5748081,
           'recall50': 0.22006482},
     '4': {'avg_iou': 0.7654064,
           'avg_obj': 0.45492724,
           'box_loss': 0.082915716,
           'class_loss': 0.023922348,
           'conf_loss': 0.15969422,
           'precision50': 0.76183337,
           'recall50': 0.4611388},
     '5': {'avg_iou': 0.8043849,
           'avg_obj': 0.5603859,
           'box_loss': 0.07151485,
           'class_loss': 0.022026012,
           'conf_loss': 0.1030805,
           'precision50': 0.82522947,
           'recall50': 0.61715317},
     'global': {'total_loss': 0.7955256},
     'learning_rate': 0.0068427175,
     'training_loss': 0.7955256}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-160000.
 eval | step:  160000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=191.96s).
Accumulating evaluation results...
DONE (t=11.39s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.381
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.589
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.407
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.168
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.394
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.532
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.309
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.495
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.537
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.336
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.567
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.673
 eval | step:  160000 | eval time:  507.1 sec | output: 
    {'3': {'avg_iou': 0.4916375,
           'avg_obj': 0.20885141,
           'box_loss': 0.00969941,
           'class_loss': 0.0030547902,
           'conf_loss': 0.017848097,
           'precision50': 0.41138512,
           'recall50': 0.19797625},
     '4': {'avg_iou': 0.7025698,
           'avg_obj': 0.4017453,
           'box_loss': 0.009459954,
           'class_loss': 0.0031054532,
           'conf_loss': 0.016166016,
           'precision50': 0.63545036,
           'recall50': 0.4309872},
     '5': {'avg_iou': 0.7720013,
           'avg_obj': 0.52406156,
           'box_loss': 0.008727467,
           'class_loss': 0.0030939907,
           'conf_loss': 0.012661539,
           'precision50': 0.73938715,
           'recall50': 0.5787632},
     'AP': 0.38061467,
     'AP50': 0.5890805,
     'AP75': 0.40674877,
     'APl': 0.5319899,
     'APm': 0.39443883,
     'APs': 0.16817388,
     'ARl': 0.6725605,
     'ARm': 0.5669666,
     'ARmax1': 0.3091106,
     'ARmax10': 0.49546087,
     'ARmax100': 0.5371166,
     'ARs': 0.3359736,
     'global': {'total_loss': 0.083816774},
     'validation_loss': 0.083816774}
train | step:  160000 | training until step 180000...
train | step:  170000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.65566194,
           'avg_obj': 0.30241966,
           'box_loss': 0.10898959,
           'class_loss': 0.031386472,
           'conf_loss': 0.18972579,
           'precision50': 0.57968146,
           'recall50': 0.22499992},
     '4': {'avg_iou': 0.7676557,
           'avg_obj': 0.46041358,
           'box_loss': 0.08201281,
           'class_loss': 0.023466874,
           'conf_loss': 0.15851095,
           'precision50': 0.76449716,
           'recall50': 0.46787867},
     '5': {'avg_iou': 0.8066772,
           'avg_obj': 0.56596166,
           'box_loss': 0.07064061,
           'class_loss': 0.021541009,
           'conf_loss': 0.10198154,
           'precision50': 0.8272957,
           'recall50': 0.6236696},
     'global': {'total_loss': 0.7882579},
     'learning_rate': 0.0065080714,
     'training_loss': 0.7882579}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-170000.
train | step:  180000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6571893,
           'avg_obj': 0.30681357,
           'box_loss': 0.10848143,
           'class_loss': 0.030892618,
           'conf_loss': 0.18841879,
           'precision50': 0.5839926,
           'recall50': 0.23063652},
     '4': {'avg_iou': 0.7696019,
           'avg_obj': 0.46550617,
           'box_loss': 0.08130532,
           'class_loss': 0.022953661,
           'conf_loss': 0.1570307,
           'precision50': 0.7675758,
           'recall50': 0.4744408},
     '5': {'avg_iou': 0.80891174,
           'avg_obj': 0.57137567,
           'box_loss': 0.0697817,
           'class_loss': 0.02110712,
           'conf_loss': 0.100964814,
           'precision50': 0.8293437,
           'recall50': 0.6297674},
     'global': {'total_loss': 0.78093755},
     'learning_rate': 0.0061697643,
     'training_loss': 0.78093755}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-180000.
 eval | step:  180000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=181.32s).
Accumulating evaluation results...
DONE (t=11.99s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.379
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.587
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.404
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.163
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.393
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.527
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.311
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.493
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.535
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.333
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.562
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.668
 eval | step:  180000 | eval time:  493.8 sec | output: 
    {'3': {'avg_iou': 0.49151534,
           'avg_obj': 0.21064067,
           'box_loss': 0.009708618,
           'class_loss': 0.0031106141,
           'conf_loss': 0.01808664,
           'precision50': 0.41059926,
           'recall50': 0.20201686},
     '4': {'avg_iou': 0.7018954,
           'avg_obj': 0.40287238,
           'box_loss': 0.009495343,
           'class_loss': 0.0031886753,
           'conf_loss': 0.016499696,
           'precision50': 0.6354043,
           'recall50': 0.43310165},
     '5': {'avg_iou': 0.7718679,
           'avg_obj': 0.52785486,
           'box_loss': 0.008736264,
           'class_loss': 0.0031793185,
           'conf_loss': 0.012894702,
           'precision50': 0.738842,
           'recall50': 0.58261395},
     'AP': 0.37900078,
     'AP50': 0.58719474,
     'AP75': 0.40401736,
     'APl': 0.5267001,
     'APm': 0.3929685,
     'APs': 0.16347633,
     'ARl': 0.66778326,
     'ARm': 0.56157106,
     'ARmax1': 0.31090337,
     'ARmax10': 0.49344602,
     'ARmax100': 0.53544366,
     'ARs': 0.33289897,
     'global': {'total_loss': 0.08489988},
     'validation_loss': 0.08489988}
train | step:  180000 | training until step 200000...
train | step:  190000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6589379,
           'avg_obj': 0.3108571,
           'box_loss': 0.10791098,
           'class_loss': 0.030330902,
           'conf_loss': 0.187418,
           'precision50': 0.5884453,
           'recall50': 0.23548163},
     '4': {'avg_iou': 0.7717891,
           'avg_obj': 0.4708899,
           'box_loss': 0.080520004,
           'class_loss': 0.022572843,
           'conf_loss': 0.15589803,
           'precision50': 0.7697616,
           'recall50': 0.481097},
     '5': {'avg_iou': 0.8109194,
           'avg_obj': 0.5768747,
           'box_loss': 0.069002084,
           'class_loss': 0.020706704,
           'conf_loss': 0.099872135,
           'precision50': 0.83144933,
           'recall50': 0.63584965},
     'global': {'total_loss': 0.7742335},
     'learning_rate': 0.0058302353,
     'training_loss': 0.7742335}I0519 02:43:58.004534 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-190000.
I0519 04:16:58.461047 139627049523008 controller.py:425] train | step:  200000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6608193,
           'avg_obj': 0.3152731,
           'box_loss': 0.1073457,
           'class_loss': 0.02975191,
           'conf_loss': 0.18603069,
           'precision50': 0.59217376,
           'recall50': 0.24087796},
     '4': {'avg_iou': 0.7736923,
           'avg_obj': 0.4758332,
           'box_loss': 0.079738684,
           'class_loss': 0.021998944,
           'conf_loss': 0.15444408,
           'precision50': 0.7717584,
           'recall50': 0.4871621},
     '5': {'avg_iou': 0.81313217,
           'avg_obj': 0.58166337,
           'box_loss': 0.06808941,
           'class_loss': 0.020273315,
           'conf_loss': 0.09895836,
           'precision50': 0.83262444,
           'recall50': 0.6411302},
     'global': {'total_loss': 0.76663},
     'learning_rate': 0.005491929,
     'training_loss': 0.76663}
I0519 04:17:56.239244 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-200000.
I0519 04:17:56.246346 139627049523008 controller.py:252]  eval | step:  200000 | running 625 steps of evaluation...
I0519 04:22:08.287169 139627049523008 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0519 04:27:23.600125 139627049523008 controller.py:261]  eval | step:  200000 | eval time:  567.4 sec | output: 
    {'3': {'avg_iou': 0.49117047,
           'avg_obj': 0.2109796,
           'box_loss': 0.00972677,
           'class_loss': 0.0032102657,
           'conf_loss': 0.018358063,
           'precision50': 0.41047198,
           'recall50': 0.20265725},
     '4': {'avg_iou': 0.70151687,
           'avg_obj': 0.4054342,
           'box_loss': 0.009515485,
           'class_loss': 0.0032892292,
           'conf_loss': 0.016825713,
           'precision50': 0.6293003,
           'recall50': 0.43692374},
     '5': {'avg_iou': 0.7714515,
           'avg_obj': 0.53108215,
           'box_loss': 0.008762062,
           'class_loss': 0.003250165,
           'conf_loss': 0.013109889,
           'precision50': 0.73653644,
           'recall50': 0.58491576},
     'AP': 0.3775579,
     'AP50': 0.5870568,
     'AP75': 0.40061563,
     'APl': 0.5245655,
     'APm': 0.39120844,
     'APs': 0.16716917,
     'ARl': 0.6628215,
     'ARm': 0.55771005,
     'ARmax1': 0.30830917,
     'ARmax10': 0.49049157,
     'ARmax100': 0.53098,
     'ARs': 0.33147347,
     'global': {'total_loss': 0.086047664},
     'validation_loss': 0.086047664}
I0519 04:27:47.365877 139627049523008 controller.py:211] train | step:  200000 | training until step 220000...
I0519 05:49:38.939402 139627049523008 controller.py:425] train | step:  210000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.66254705,
           'avg_obj': 0.31960285,
           'box_loss': 0.10667764,
           'class_loss': 0.02924605,
           'conf_loss': 0.18461004,
           'precision50': 0.5945223,
           'recall50': 0.2455123},
     '4': {'avg_iou': 0.77540106,
           'avg_obj': 0.4803525,
           'box_loss': 0.079034515,
           'class_loss': 0.021595567,
           'conf_loss': 0.15312052,
           'precision50': 0.7741721,
           'recall50': 0.49339375},
     '5': {'avg_iou': 0.81502604,
           'avg_obj': 0.58612406,
           'box_loss': 0.06732779,
           'class_loss': 0.019882988,
           'conf_loss': 0.09806162,
           'precision50': 0.834633,
           'recall50': 0.6461422},
     'global': {'total_loss': 0.7595561},
     'learning_rate': 0.005157283,
     'training_loss': 0.7595561}
I0519 05:50:37.832411 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-210000.
I0519 07:22:09.213061 139627049523008 controller.py:425] train | step:  220000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6640197,
           'avg_obj': 0.32325348,
           'box_loss': 0.10626185,
           'class_loss': 0.028869089,
           'conf_loss': 0.18349339,
           'precision50': 0.5973418,
           'recall50': 0.24982394},
     '4': {'avg_iou': 0.777192,
           'avg_obj': 0.48457667,
           'box_loss': 0.07835019,
           'class_loss': 0.021295883,
           'conf_loss': 0.15198636,
           'precision50': 0.775827,
           'recall50': 0.4983119},
     '5': {'avg_iou': 0.8167642,
           'avg_obj': 0.59060353,
           'box_loss': 0.06664095,
           'class_loss': 0.019603588,
           'conf_loss': 0.09714805,
           'precision50': 0.83630615,
           'recall50': 0.6513415},
     'global': {'total_loss': 0.75364786},
     'learning_rate': 0.0048287087,
     'training_loss': 0.75364786}
I0519 07:23:10.125098 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-220000.
I0519 07:23:10.131293 139627049523008 controller.py:252]  eval | step:  220000 | running 625 steps of evaluation...
I0519 07:27:23.225816 139627049523008 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0519 07:32:28.321585 139627049523008 controller.py:261]  eval | step:  220000 | eval time:  558.2 sec | output: 
    {'3': {'avg_iou': 0.4907596,
           'avg_obj': 0.21156059,
           'box_loss': 0.009749094,
           'class_loss': 0.003287742,
           'conf_loss': 0.018570516,
           'precision50': 0.4087908,
           'recall50': 0.20455737},
     '4': {'avg_iou': 0.70083064,
           'avg_obj': 0.40736964,
           'box_loss': 0.00955205,
           'class_loss': 0.0033785664,
           'conf_loss': 0.01707961,
           'precision50': 0.629172,
           'recall50': 0.43877286},
     '5': {'avg_iou': 0.7715825,
           'avg_obj': 0.533831,
           'box_loss': 0.008751529,
           'class_loss': 0.003328477,
           'conf_loss': 0.013281929,
           'precision50': 0.7354184,
           'recall50': 0.5863349},
     'AP': 0.37866277,
     'AP50': 0.5841785,
     'AP75': 0.40388525,
     'APl': 0.52805847,
     'APm': 0.39040348,
     'APs': 0.16689034,
     'ARl': 0.6584742,
     'ARm': 0.5550578,
     'ARmax1': 0.3092964,
     'ARmax10': 0.48889533,
     'ARmax100': 0.52858096,
     'ARs': 0.3280793,
     'global': {'total_loss': 0.08697952},
     'validation_loss': 0.08697952}
I0519 07:32:51.412011 139627049523008 controller.py:211] train | step:  220000 | training until step 240000...
I0519 08:53:25.377772 139627049523008 controller.py:425] train | step:  230000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.66522014,
           'avg_obj': 0.32720873,
           'box_loss': 0.105513185,
           'class_loss': 0.028294953,
           'conf_loss': 0.18198375,
           'precision50': 0.601328,
           'recall50': 0.25521466},
     '4': {'avg_iou': 0.7790008,
           'avg_obj': 0.48954883,
           'box_loss': 0.07763469,
           'class_loss': 0.020864686,
           'conf_loss': 0.1503313,
           'precision50': 0.77808934,
           'recall50': 0.50485176},
     '5': {'avg_iou': 0.81859905,
           'avg_obj': 0.595287,
           'box_loss': 0.06592359,
           'class_loss': 0.01920169,
           'conf_loss': 0.09599861,
           'precision50': 0.8379602,
           'recall50': 0.6566395},
     'global': {'total_loss': 0.7457479},
     'learning_rate': 0.004508574,
     'training_loss': 0.7457479}

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-190000.
train | step:  200000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6608193,
           'avg_obj': 0.3152731,
           'box_loss': 0.1073457,
           'class_loss': 0.02975191,
           'conf_loss': 0.18603069,
           'precision50': 0.59217376,
           'recall50': 0.24087796},
     '4': {'avg_iou': 0.7736923,
           'avg_obj': 0.4758332,
           'box_loss': 0.079738684,
           'class_loss': 0.021998944,
           'conf_loss': 0.15444408,
           'precision50': 0.7717584,
           'recall50': 0.4871621},
     '5': {'avg_iou': 0.81313217,
           'avg_obj': 0.58166337,
           'box_loss': 0.06808941,
           'class_loss': 0.020273315,
           'conf_loss': 0.09895836,
           'precision50': 0.83262444,
           'recall50': 0.6411302},
     'global': {'total_loss': 0.76663},
     'learning_rate': 0.005491929,
     'training_loss': 0.76663}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-200000.
 eval | step:  200000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=234.47s).
Accumulating evaluation results...
DONE (t=20.00s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.378
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.587
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.401
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.167
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.391
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.525
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.308
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.490
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.531
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.331
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.558
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.663
 eval | step:  200000 | eval time:  567.4 sec | output: 
    {'3': {'avg_iou': 0.49117047,
           'avg_obj': 0.2109796,
           'box_loss': 0.00972677,
           'class_loss': 0.0032102657,
           'conf_loss': 0.018358063,
           'precision50': 0.41047198,
           'recall50': 0.20265725},
     '4': {'avg_iou': 0.70151687,
           'avg_obj': 0.4054342,
           'box_loss': 0.009515485,
           'class_loss': 0.0032892292,
           'conf_loss': 0.016825713,
           'precision50': 0.6293003,
           'recall50': 0.43692374},
     '5': {'avg_iou': 0.7714515,
           'avg_obj': 0.53108215,
           'box_loss': 0.008762062,
           'class_loss': 0.003250165,
           'conf_loss': 0.013109889,
           'precision50': 0.73653644,
           'recall50': 0.58491576},
     'AP': 0.3775579,
     'AP50': 0.5870568,
     'AP75': 0.40061563,
     'APl': 0.5245655,
     'APm': 0.39120844,
     'APs': 0.16716917,
     'ARl': 0.6628215,
     'ARm': 0.55771005,
     'ARmax1': 0.30830917,
     'ARmax10': 0.49049157,
     'ARmax100': 0.53098,
     'ARs': 0.33147347,
     'global': {'total_loss': 0.086047664},
     'validation_loss': 0.086047664}
train | step:  200000 | training until step 220000...
train | step:  210000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.66254705,
           'avg_obj': 0.31960285,
           'box_loss': 0.10667764,
           'class_loss': 0.02924605,
           'conf_loss': 0.18461004,
           'precision50': 0.5945223,
           'recall50': 0.2455123},
     '4': {'avg_iou': 0.77540106,
           'avg_obj': 0.4803525,
           'box_loss': 0.079034515,
           'class_loss': 0.021595567,
           'conf_loss': 0.15312052,
           'precision50': 0.7741721,
           'recall50': 0.49339375},
     '5': {'avg_iou': 0.81502604,
           'avg_obj': 0.58612406,
           'box_loss': 0.06732779,
           'class_loss': 0.019882988,
           'conf_loss': 0.09806162,
           'precision50': 0.834633,
           'recall50': 0.6461422},
     'global': {'total_loss': 0.7595561},
     'learning_rate': 0.005157283,
     'training_loss': 0.7595561}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-210000.
train | step:  220000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6640197,
           'avg_obj': 0.32325348,
           'box_loss': 0.10626185,
           'class_loss': 0.028869089,
           'conf_loss': 0.18349339,
           'precision50': 0.5973418,
           'recall50': 0.24982394},
     '4': {'avg_iou': 0.777192,
           'avg_obj': 0.48457667,
           'box_loss': 0.07835019,
           'class_loss': 0.021295883,
           'conf_loss': 0.15198636,
           'precision50': 0.775827,
           'recall50': 0.4983119},
     '5': {'avg_iou': 0.8167642,
           'avg_obj': 0.59060353,
           'box_loss': 0.06664095,
           'class_loss': 0.019603588,
           'conf_loss': 0.09714805,
           'precision50': 0.83630615,
           'recall50': 0.6513415},
     'global': {'total_loss': 0.75364786},
     'learning_rate': 0.0048287087,
     'training_loss': 0.75364786}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-220000.
 eval | step:  220000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=224.87s).
Accumulating evaluation results...
DONE (t=15.37s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.379
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.584
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.404
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.167
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.390
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.528
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.309
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.489
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.529
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.328
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.555
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.658
 eval | step:  220000 | eval time:  558.2 sec | output: 
    {'3': {'avg_iou': 0.4907596,
           'avg_obj': 0.21156059,
           'box_loss': 0.009749094,
           'class_loss': 0.003287742,
           'conf_loss': 0.018570516,
           'precision50': 0.4087908,
           'recall50': 0.20455737},
     '4': {'avg_iou': 0.70083064,
           'avg_obj': 0.40736964,
           'box_loss': 0.00955205,
           'class_loss': 0.0033785664,
           'conf_loss': 0.01707961,
           'precision50': 0.629172,
           'recall50': 0.43877286},
     '5': {'avg_iou': 0.7715825,
           'avg_obj': 0.533831,
           'box_loss': 0.008751529,
           'class_loss': 0.003328477,
           'conf_loss': 0.013281929,
           'precision50': 0.7354184,
           'recall50': 0.5863349},
     'AP': 0.37866277,
     'AP50': 0.5841785,
     'AP75': 0.40388525,
     'APl': 0.52805847,
     'APm': 0.39040348,
     'APs': 0.16689034,
     'ARl': 0.6584742,
     'ARm': 0.5550578,
     'ARmax1': 0.3092964,
     'ARmax10': 0.48889533,
     'ARmax100': 0.52858096,
     'ARs': 0.3280793,
     'global': {'total_loss': 0.08697952},
     'validation_loss': 0.08697952}
train | step:  220000 | training until step 240000...
train | step:  230000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.66522014,
           'avg_obj': 0.32720873,
           'box_loss': 0.105513185,
           'class_loss': 0.028294953,
           'conf_loss': 0.18198375,
           'precision50': 0.601328,
           'recall50': 0.25521466},
     '4': {'avg_iou': 0.7790008,
           'avg_obj': 0.48954883,
           'box_loss': 0.07763469,
           'class_loss': 0.020864686,
           'conf_loss': 0.1503313,
           'precision50': 0.77808934,
           'recall50': 0.50485176},
     '5': {'avg_iou': 0.81859905,
           'avg_obj': 0.595287,
           'box_loss': 0.06592359,
           'class_loss': 0.01920169,
           'conf_loss': 0.09599861,
           'precision50': 0.8379602,
           'recall50': 0.6566395},
     'global': {'total_loss': 0.7457479},
     'learning_rate': 0.004508574,
     'training_loss': 0.7457479}I0519 08:54:24.803114 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-230000.
I0519 10:23:02.788802 139627049523008 controller.py:425] train | step:  240000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6666041,
           'avg_obj': 0.33070046,
           'box_loss': 0.10530645,
           'class_loss': 0.027998574,
           'conf_loss': 0.18126439,
           'precision50': 0.6039427,
           'recall50': 0.25885502},
     '4': {'avg_iou': 0.7803135,
           'avg_obj': 0.49331918,
           'box_loss': 0.077126935,
           'class_loss': 0.020613492,
           'conf_loss': 0.1496314,
           'precision50': 0.780404,
           'recall50': 0.5099597},
     '5': {'avg_iou': 0.8201172,
           'avg_obj': 0.5991957,
           'box_loss': 0.065254636,
           'class_loss': 0.018933207,
           'conf_loss': 0.09525199,
           'precision50': 0.8387828,
           'recall50': 0.66030574},
     'global': {'total_loss': 0.7413796},
     'learning_rate': 0.0041991845,
     'training_loss': 0.7413796}
I0519 10:24:04.573189 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-240000.
I0519 10:24:04.579271 139627049523008 controller.py:252]  eval | step:  240000 | running 625 steps of evaluation...
I0519 10:28:15.787328 139627049523008 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0519 10:32:29.174569 139627049523008 controller.py:261]  eval | step:  240000 | eval time:  504.6 sec | output: 
    {'3': {'avg_iou': 0.49026734,
           'avg_obj': 0.2122407,
           'box_loss': 0.009775071,
           'class_loss': 0.0033630477,
           'conf_loss': 0.018819794,
           'precision50': 0.4083555,
           'recall50': 0.2076667},
     '4': {'avg_iou': 0.6998824,
           'avg_obj': 0.40850633,
           'box_loss': 0.009600246,
           'class_loss': 0.0034903137,
           'conf_loss': 0.017348882,
           'precision50': 0.62497026,
           'recall50': 0.4415635},
     '5': {'avg_iou': 0.7707164,
           'avg_obj': 0.5351783,
           'box_loss': 0.008796615,
           'class_loss': 0.0034189194,
           'conf_loss': 0.013428447,
           'precision50': 0.73194534,
           'recall50': 0.58569974},
     'AP': 0.37611756,
     'AP50': 0.58187187,
     'AP75': 0.40181074,
     'APl': 0.52479136,
     'APm': 0.3864658,
     'APs': 0.16696547,
     'ARl': 0.6545444,
     'ARm': 0.54804015,
     'ARmax1': 0.3066057,
     'ARmax10': 0.4858275,
     'ARmax100': 0.5240928,
     'ARs': 0.3245899,
     'global': {'total_loss': 0.08804126},
     'validation_loss': 0.08804126}
I0519 10:32:47.474858 139627049523008 controller.py:211] train | step:  240000 | training until step 260000...
I0519 11:55:36.660955 139627049523008 controller.py:425] train | step:  250000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6680218,
           'avg_obj': 0.33460805,
           'box_loss': 0.10477274,
           'class_loss': 0.027537039,
           'conf_loss': 0.1803571,
           'precision50': 0.60726917,
           'recall50': 0.26352942},
     '4': {'avg_iou': 0.78206396,
           'avg_obj': 0.4974369,
           'box_loss': 0.07645907,
           'class_loss': 0.020284725,
           'conf_loss': 0.1486285,
           'precision50': 0.7815914,
           'recall50': 0.5141896},
     '5': {'avg_iou': 0.82176423,
           'avg_obj': 0.6033747,
           'box_loss': 0.06464445,
           'class_loss': 0.018692138,
           'conf_loss': 0.094386816,
           'precision50': 0.84002197,
           'recall50': 0.6643797},
     'global': {'total_loss': 0.73576194},
     'learning_rate': 0.0039027706,
     'training_loss': 0.73576194}
I0519 11:56:34.738548 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-250000.
I0519 13:25:13.248371 139627049523008 controller.py:425] train | step:  260000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.669222,
           'avg_obj': 0.33770028,
           'box_loss': 0.1042618,
           'class_loss': 0.027222525,
           'conf_loss': 0.17921114,
           'precision50': 0.609354,
           'recall50': 0.26716876},
     '4': {'avg_iou': 0.7834312,
           'avg_obj': 0.5012355,
           'box_loss': 0.0759547,
           'class_loss': 0.02004919,
           'conf_loss': 0.14747131,
           'precision50': 0.78315085,
           'recall50': 0.51906383},
     '5': {'avg_iou': 0.8232377,
           'avg_obj': 0.60693884,
           'box_loss': 0.06403867,
           'class_loss': 0.018430637,
           'conf_loss': 0.09366692,
           'precision50': 0.84104705,
           'recall50': 0.6684898},
     'global': {'total_loss': 0.7303068},
     'learning_rate': 0.0036214672,
     'training_loss': 0.7303068}
I0519 13:26:14.106850 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-260000.
I0519 13:26:14.112976 139627049523008 controller.py:252]  eval | step:  260000 | running 625 steps of evaluation...
I0519 13:30:24.943353 139627049523008 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0519 13:34:31.501027 139627049523008 controller.py:261]  eval | step:  260000 | eval time:  497.4 sec | output: 
    {'3': {'avg_iou': 0.4893834,
           'avg_obj': 0.21149772,
           'box_loss': 0.009824079,
           'class_loss': 0.0033964599,
           'conf_loss': 0.018991323,
           'precision50': 0.40571553,
           'recall50': 0.20765552},
     '4': {'avg_iou': 0.6996307,
           'avg_obj': 0.40908766,
           'box_loss': 0.0096154325,
           'class_loss': 0.0035242122,
           'conf_loss': 0.017547822,
           'precision50': 0.6224339,
           'recall50': 0.4395105},
     '5': {'avg_iou': 0.77098435,
           'avg_obj': 0.53630155,
           'box_loss': 0.008783879,
           'class_loss': 0.0034585723,
           'conf_loss': 0.013570685,
           'precision50': 0.7310825,
           'recall50': 0.5875737},
     'AP': 0.3753529,
     'AP50': 0.5801621,
     'AP75': 0.39854655,
     'APl': 0.5265104,
     'APm': 0.38631162,
     'APs': 0.1654541,
     'ARl': 0.65340924,
     'ARm': 0.5449914,
     'ARmax1': 0.3067139,
     'ARmax10': 0.4828859,
     'ARmax100': 0.52123535,
     'ARs': 0.32122448,
     'global': {'total_loss': 0.088712424},
     'validation_loss': 0.088712424}
I0519 13:34:53.962948 139627049523008 controller.py:211] train | step:  260000 | training until step 280000...
I0519 14:58:54.600544 139627049523008 controller.py:425] train | step:  270000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.67057854,
           'avg_obj': 0.34106132,
           'box_loss': 0.10386021,
           'class_loss': 0.026864083,
           'conf_loss': 0.17829634,
           'precision50': 0.61133957,
           'recall50': 0.2710187},
     '4': {'avg_iou': 0.7844902,
           'avg_obj': 0.504577,
           'box_loss': 0.075549096,
           'class_loss': 0.019784892,
           'conf_loss': 0.14657623,
           'precision50': 0.7851429,
           'recall50': 0.5237451},
     '5': {'avg_iou': 0.82446843,
           'avg_obj': 0.6102393,
           'box_loss': 0.06355636,
           'class_loss': 0.018167874,
           'conf_loss': 0.09298101,
           'precision50': 0.84262747,
           'recall50': 0.6724078},
     'global': {'total_loss': 0.725636},
     'learning_rate': 0.003357301,
     'training_loss': 0.725636}

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-230000.
train | step:  240000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6666041,
           'avg_obj': 0.33070046,
           'box_loss': 0.10530645,
           'class_loss': 0.027998574,
           'conf_loss': 0.18126439,
           'precision50': 0.6039427,
           'recall50': 0.25885502},
     '4': {'avg_iou': 0.7803135,
           'avg_obj': 0.49331918,
           'box_loss': 0.077126935,
           'class_loss': 0.020613492,
           'conf_loss': 0.1496314,
           'precision50': 0.780404,
           'recall50': 0.5099597},
     '5': {'avg_iou': 0.8201172,
           'avg_obj': 0.5991957,
           'box_loss': 0.065254636,
           'class_loss': 0.018933207,
           'conf_loss': 0.09525199,
           'precision50': 0.8387828,
           'recall50': 0.66030574},
     'global': {'total_loss': 0.7413796},
     'learning_rate': 0.0041991845,
     'training_loss': 0.7413796}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-240000.
 eval | step:  240000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=182.80s).
Accumulating evaluation results...
DONE (t=12.02s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.376
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.582
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.402
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.167
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.386
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.525
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.307
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.486
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.524
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.325
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.548
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.655
 eval | step:  240000 | eval time:  504.6 sec | output: 
    {'3': {'avg_iou': 0.49026734,
           'avg_obj': 0.2122407,
           'box_loss': 0.009775071,
           'class_loss': 0.0033630477,
           'conf_loss': 0.018819794,
           'precision50': 0.4083555,
           'recall50': 0.2076667},
     '4': {'avg_iou': 0.6998824,
           'avg_obj': 0.40850633,
           'box_loss': 0.009600246,
           'class_loss': 0.0034903137,
           'conf_loss': 0.017348882,
           'precision50': 0.62497026,
           'recall50': 0.4415635},
     '5': {'avg_iou': 0.7707164,
           'avg_obj': 0.5351783,
           'box_loss': 0.008796615,
           'class_loss': 0.0034189194,
           'conf_loss': 0.013428447,
           'precision50': 0.73194534,
           'recall50': 0.58569974},
     'AP': 0.37611756,
     'AP50': 0.58187187,
     'AP75': 0.40181074,
     'APl': 0.52479136,
     'APm': 0.3864658,
     'APs': 0.16696547,
     'ARl': 0.6545444,
     'ARm': 0.54804015,
     'ARmax1': 0.3066057,
     'ARmax10': 0.4858275,
     'ARmax100': 0.5240928,
     'ARs': 0.3245899,
     'global': {'total_loss': 0.08804126},
     'validation_loss': 0.08804126}
train | step:  240000 | training until step 260000...
train | step:  250000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6680218,
           'avg_obj': 0.33460805,
           'box_loss': 0.10477274,
           'class_loss': 0.027537039,
           'conf_loss': 0.1803571,
           'precision50': 0.60726917,
           'recall50': 0.26352942},
     '4': {'avg_iou': 0.78206396,
           'avg_obj': 0.4974369,
           'box_loss': 0.07645907,
           'class_loss': 0.020284725,
           'conf_loss': 0.1486285,
           'precision50': 0.7815914,
           'recall50': 0.5141896},
     '5': {'avg_iou': 0.82176423,
           'avg_obj': 0.6033747,
           'box_loss': 0.06464445,
           'class_loss': 0.018692138,
           'conf_loss': 0.094386816,
           'precision50': 0.84002197,
           'recall50': 0.6643797},
     'global': {'total_loss': 0.73576194},
     'learning_rate': 0.0039027706,
     'training_loss': 0.73576194}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-250000.
train | step:  260000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.669222,
           'avg_obj': 0.33770028,
           'box_loss': 0.1042618,
           'class_loss': 0.027222525,
           'conf_loss': 0.17921114,
           'precision50': 0.609354,
           'recall50': 0.26716876},
     '4': {'avg_iou': 0.7834312,
           'avg_obj': 0.5012355,
           'box_loss': 0.0759547,
           'class_loss': 0.02004919,
           'conf_loss': 0.14747131,
           'precision50': 0.78315085,
           'recall50': 0.51906383},
     '5': {'avg_iou': 0.8232377,
           'avg_obj': 0.60693884,
           'box_loss': 0.06403867,
           'class_loss': 0.018430637,
           'conf_loss': 0.09366692,
           'precision50': 0.84104705,
           'recall50': 0.6684898},
     'global': {'total_loss': 0.7303068},
     'learning_rate': 0.0036214672,
     'training_loss': 0.7303068}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-260000.
 eval | step:  260000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=181.89s).
Accumulating evaluation results...
DONE (t=10.33s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.375
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.580
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.399
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.165
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.386
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.527
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.307
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.483
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.521
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.321
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.545
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.653
 eval | step:  260000 | eval time:  497.4 sec | output: 
    {'3': {'avg_iou': 0.4893834,
           'avg_obj': 0.21149772,
           'box_loss': 0.009824079,
           'class_loss': 0.0033964599,
           'conf_loss': 0.018991323,
           'precision50': 0.40571553,
           'recall50': 0.20765552},
     '4': {'avg_iou': 0.6996307,
           'avg_obj': 0.40908766,
           'box_loss': 0.0096154325,
           'class_loss': 0.0035242122,
           'conf_loss': 0.017547822,
           'precision50': 0.6224339,
           'recall50': 0.4395105},
     '5': {'avg_iou': 0.77098435,
           'avg_obj': 0.53630155,
           'box_loss': 0.008783879,
           'class_loss': 0.0034585723,
           'conf_loss': 0.013570685,
           'precision50': 0.7310825,
           'recall50': 0.5875737},
     'AP': 0.3753529,
     'AP50': 0.5801621,
     'AP75': 0.39854655,
     'APl': 0.5265104,
     'APm': 0.38631162,
     'APs': 0.1654541,
     'ARl': 0.65340924,
     'ARm': 0.5449914,
     'ARmax1': 0.3067139,
     'ARmax10': 0.4828859,
     'ARmax100': 0.52123535,
     'ARs': 0.32122448,
     'global': {'total_loss': 0.088712424},
     'validation_loss': 0.088712424}
train | step:  260000 | training until step 280000...
train | step:  270000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.67057854,
           'avg_obj': 0.34106132,
           'box_loss': 0.10386021,
           'class_loss': 0.026864083,
           'conf_loss': 0.17829634,
           'precision50': 0.61133957,
           'recall50': 0.2710187},
     '4': {'avg_iou': 0.7844902,
           'avg_obj': 0.504577,
           'box_loss': 0.075549096,
           'class_loss': 0.019784892,
           'conf_loss': 0.14657623,
           'precision50': 0.7851429,
           'recall50': 0.5237451},
     '5': {'avg_iou': 0.82446843,
           'avg_obj': 0.6102393,
           'box_loss': 0.06355636,
           'class_loss': 0.018167874,
           'conf_loss': 0.09298101,
           'precision50': 0.84262747,
           'recall50': 0.6724078},
     'global': {'total_loss': 0.725636},
     'learning_rate': 0.003357301,
     'training_loss': 0.725636}I0519 14:59:53.804325 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-270000.
I0519 16:29:18.973428 139627049523008 controller.py:425] train | step:  280000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.67197245,
           'avg_obj': 0.34434146,
           'box_loss': 0.10342629,
           'class_loss': 0.026619446,
           'conf_loss': 0.1770148,
           'precision50': 0.6137378,
           'recall50': 0.27486947},
     '4': {'avg_iou': 0.7861165,
           'avg_obj': 0.50816727,
           'box_loss': 0.07488775,
           'class_loss': 0.019496165,
           'conf_loss': 0.14566052,
           'precision50': 0.78596336,
           'recall50': 0.52740455},
     '5': {'avg_iou': 0.8258903,
           'avg_obj': 0.6138196,
           'box_loss': 0.063000925,
           'class_loss': 0.01791078,
           'conf_loss': 0.09232598,
           'precision50': 0.8436319,
           'recall50': 0.6755839},
     'global': {'total_loss': 0.7203421},
     'learning_rate': 0.003112175,
     'training_loss': 0.7203421}
I0519 16:30:27.096395 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-280000.
I0519 16:30:27.101904 139627049523008 controller.py:252]  eval | step:  280000 | running 625 steps of evaluation...
I0519 16:34:36.460274 139627049523008 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0519 16:38:49.160177 139627049523008 controller.py:261]  eval | step:  280000 | eval time:  502.1 sec | output: 
    {'3': {'avg_iou': 0.48904952,
           'avg_obj': 0.21269765,
           'box_loss': 0.009843453,
           'class_loss': 0.003474446,
           'conf_loss': 0.019248635,
           'precision50': 0.40511155,
           'recall50': 0.21015513},
     '4': {'avg_iou': 0.6992391,
           'avg_obj': 0.4111855,
           'box_loss': 0.009634504,
           'class_loss': 0.0035929577,
           'conf_loss': 0.017863685,
           'precision50': 0.6217309,
           'recall50': 0.44335836},
     '5': {'avg_iou': 0.7705658,
           'avg_obj': 0.53807133,
           'box_loss': 0.008805252,
           'class_loss': 0.0034770644,
           'conf_loss': 0.013726903,
           'precision50': 0.7320612,
           'recall50': 0.5899576},
     'AP': 0.37305582,
     'AP50': 0.576979,
     'AP75': 0.39811975,
     'APl': 0.5229907,
     'APm': 0.3831009,
     'APs': 0.16525757,
     'ARl': 0.654837,
     'ARm': 0.5433056,
     'ARmax1': 0.30611658,
     'ARmax10': 0.481322,
     'ARmax100': 0.51977164,
     'ARs': 0.32049024,
     'global': {'total_loss': 0.08966691},
     'validation_loss': 0.08966691}
I0519 16:39:14.945956 139627049523008 controller.py:211] train | step:  280000 | training until step 300000...
I0519 18:01:21.692498 139627049523008 controller.py:425] train | step:  290000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6727158,
           'avg_obj': 0.34698993,
           'box_loss': 0.10304463,
           'class_loss': 0.026268836,
           'conf_loss': 0.17641284,
           'precision50': 0.6153453,
           'recall50': 0.27772313},
     '4': {'avg_iou': 0.7871468,
           'avg_obj': 0.5112681,
           'box_loss': 0.07449686,
           'class_loss': 0.019248351,
           'conf_loss': 0.14470701,
           'precision50': 0.78752434,
           'recall50': 0.53112483},
     '5': {'avg_iou': 0.82700175,
           'avg_obj': 0.6167381,
           'box_loss': 0.062553614,
           'class_loss': 0.017730745,
           'conf_loss': 0.091624916,
           'precision50': 0.84457684,
           'recall50': 0.67872983},
     'global': {'total_loss': 0.7160887},
     'learning_rate': 0.002887857,
     'training_loss': 0.7160887}
I0519 18:02:22.646345 139627049523008 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-13/ckpt-290000.
/home/cam2tensorflow/.experiment_start.sh: line 22: 20512 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4-$5
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208      7    800 --:--:-- --:--:-- --:--:--   807
okRequest issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-19T19:37:56.612919597Z'
  endTime: '2021-05-19T19:38:38.209898731Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621453076596-5c2b3f6a68727-c892b514-5d10a439
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T05:45:10.821112479Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T05:44:59.159875+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T19:29:05.781890630Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T19:28:54.243943+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621453076596-5c2b3f6a68727-c892b514-5d10a439] to complete...
.................................................................................................................................................................................................................................................................................done.
