cat: .experiment_zone: No such file or directory
Request issued for: [node-7]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-25T18:21:16.058833393Z'
  endTime: '2021-04-25T18:21:53.476637815Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619374876044-5c0d0183ead61-843a2fd5-849c2612
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.124.160.48/29
  createTime: '2021-03-18T03:10:27.166064884Z'
  health: HEALTHY
  ipAddress: 10.124.160.50
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.124.160.50
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619374876044-5c0d0183ead61-843a2fd5-849c2612] to complete...
.................................................................................................................................................................................................................................................................................done.
europe-west4-a
I0425 18:19:28.861217 140151679575872 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'diou',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.2,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.5,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.2,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [400000,
                                                                                450000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.001,
                                                                            0.0001,
                                                                            1e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 4000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 500000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0425 18:19:28.862482 140151679575872 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/params.yaml
I0425 18:19:30.407921 140151679575872 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 18:19:31.026323 140151679575872 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0425 18:19:31.026638 140151679575872 transport.py:157] Attempting refresh to obtain initial access_token
I0425 18:19:31.086119 140151679575872 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 18:19:31.228073 140151679575872 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0425 18:19:31.228343 140151679575872 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-25 18:19:31.275231: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0425 18:19:31.276019 140151679575872 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 18:19:31.419365 140151679575872 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0425 18:19:31.419821 140151679575872 transport.py:157] Attempting refresh to obtain initial access_token
I0425 18:19:31.483593 140151679575872 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 18:19:32.096006 140151679575872 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0425 18:19:32.096234 140151679575872 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-25 18:19:32.141863: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-25 18:19:32.154832: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.124.160.50:8470}
2021-04-25 18:19:32.154907: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:44646}
2021-04-25 18:19:51.259532: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.124.160.50:8470}
2021-04-25 18:19:51.259641: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:44646}
2021-04-25 18:19:51.260404: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:44646
I0425 18:19:51.261195 140151679575872 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-7
I0425 18:19:51.262651 140151679575872 tpu_strategy_util.py:74] Initializing the TPU system: node-7
INFO:tensorflow:Clearing out eager caches
I0425 18:19:59.678963 140151679575872 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0425 18:19:59.681603 140151679575872 tpu_strategy_util.py:133] Finished initializing TPU system.
I0425 18:19:59.683187 140151679575872 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 18:19:59.822336 140151679575872 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0425 18:19:59.822606 140151679575872 transport.py:157] Attempting refresh to obtain initial access_token
I0425 18:19:59.894073 140151679575872 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 18:20:00.033282 140151679575872 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0425 18:20:00.033538 140151679575872 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0425 18:20:00.083510 140151679575872 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0425 18:20:00.083799 140151679575872 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0425 18:20:00.084148 140151679575872 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0425 18:20:00.084258 140151679575872 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0425 18:20:00.084355 140151679575872 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0425 18:20:00.084555 140151679575872 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0425 18:20:00.084609 140151679575872 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0425 18:20:00.084659 140151679575872 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0425 18:20:00.084704 140151679575872 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0425 18:20:00.084751 140151679575872 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0425 18:20:00.084807 140151679575872 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0425 18:20:00.084869 140151679575872 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0425 18:20:00.084913 140151679575872 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0425 18:20:00.084959 140151679575872 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0425 18:20:00.085002 140151679575872 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0425 18:20:00.085055 140151679575872 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0425 18:20:00.086336 140151679575872 train_utils.py:214] Running default trainer.
2021-04-25 18:20:00.106126: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'diou', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.2, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.2, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [400000, 450000], 'values': [0.001, 0.0001, 1e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 4000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 500000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'diou', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f7734404da0>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________
yolo_fpn (YoloFPN)              {'5': (None, 16, 16, 9626112     input_2[0][0]                    
                                                                 input_3[0][0]                    I0425 18:20:46.939679 140151679575872 controller.py:362] restoring or initializing model...
I0425 18:20:55.882124 140151679575872 yolo.py:539] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0425 18:20:55.883763 140151679575872 controller.py:368] initialized model.
I0425 18:20:55.883951 140151679575872 train_lib.py:96] Starts to execute mode: train_and_eval
I0425 18:20:55.888379 140151679575872 controller.py:211] train | step:      0 | training until step 20000...
I0425 18:21:03.001891 140151679575872 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0425 18:22:05.075767 140151679575872 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0425 19:28:01.587473 140151679575872 controller.py:425] train | step:  10000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.53729004,
           'avg_obj': 0.12764022,
           'box_loss': 7.3016634,
           'class_loss': 25.98921,
           'conf_loss': 546.5999,
           'precision50': 0.113883786,
           'recall50': 0.07601904},
     '4': {'avg_iou': 0.6009292,
           'avg_obj': 0.22601613,
           'box_loss': 6.0635786,
           'class_loss': 24.75588,
           'conf_loss': 47.4236,
           'precision50': 0.18228409,
           'recall50': 0.18483892},
     '5': {'avg_iou': 0.6008529,
           'avg_obj': 0.30063683,
           'box_loss': 3.0147147,
           'class_loss': 12.421687,
           'conf_loss': 8.034794,
           'precision50': 0.27871752,
           'recall50': 0.27600956},
     'global': {'total_loss': 681.60474},
     'learning_rate': 0.001,
     'training_loss': 681.60474}
I0425 19:28:53.468459 140151679575872 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-10000.
I0425 20:30:50.822520 140151679575872 controller.py:425] train | step:  20000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.63420606,
           'avg_obj': 0.20849656,
           'box_loss': 5.804985,
           'class_loss': 5.0930014,
           'conf_loss': 62.628456,
           'precision50': 0.17047885,
           'recall50': 0.14499937},
     '4': {'avg_iou': 0.7303955,
           'avg_obj': 0.35043827,
           'box_loss': 4.1103144,
           'class_loss': 4.1354356,
           'conf_loss': 15.350422,
           'precision50': 0.21651953,
           'recall50': 0.34825817},
     '5': {'avg_iou': 0.7565636,
           'avg_obj': 0.44393447,
           'box_loss': 1.8411669,
           'class_loss': 1.6545557,
           'conf_loss': 2.6007063,
           'precision50': 0.3197746,
           'recall50': 0.49240792},
     'global': {'total_loss': 103.21903},
     'learning_rate': 0.001,
     'training_loss': 103.21903}
I0425 20:31:35.883731 140151679575872 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-20000.
I0425 20:31:35.891933 140151679575872 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0425 20:31:39.950824 140151679575872 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0425 20:31:57.904917 140151679575872 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 149, in main
    model_dir=model_dir)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_lib.py", line 104, in run_experiment
    eval_interval=params.trainer.validation_interval)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 304, in train_and_evaluate
    self.evaluate(steps=eval_steps)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 257, in evaluate
    eval_output = self.evaluator.evaluate(steps_tensor)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/standard_runner.py", line 313, in evaluate
    eval_iter, num_steps, state=outputs, reduce_fn=self.eval_reduce)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/utils/loop_fns.py", line 76, in loop_fn
    state = reduce_fn(state, outputs)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/base_trainer.py", line 356, in eval_reduce
    return self.task.aggregate_logs(state, step_outputs)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/tasks/yolo.py", line 367, in aggregate_logs
    step_outputs[self.coco_metric.name][1])
  File "/home/cam2tensorflow/TensorFlowModels/official/vision/beta/evaluation/coco_evaluator.py", line 313, in update_state
    predictions)
  File "/home/cam2tensorflow/TensorFlowModels/official/vision/beta/evaluation/coco_evaluator.py", line 252, in _convert_to_numpy
    labels = tf.nest.map_structure(lambda x: x.numpy(), groundtruths)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/util/nest.py", line 659, in map_structure
    structure[0], [func(*x) for x in entries],
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/util/nest.py", line 659, in <listcomp>
    structure[0], [func(*x) for x in entries],
  File "/home/cam2tensorflow/TensorFlowModels/official/vision/beta/evaluation/coco_evaluator.py", line 252, in <lambda>
    labels = tf.nest.map_structure(lambda x: x.numpy(), groundtruths)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 1071, in numpy
    maybe_arr = self._numpy()  # pylint: disable=protected-access
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 1039, in _numpy
    six.raise_from(core._status_to_exception(e.code, e.message), None)  # pylint: disable=protected-access
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: 4 root error(s) found.
  (0) Invalid argument: {{function_node __inference_eval_step_283661}} Compilation failure: The number of output elements 64512 has to equal to number of input elements that are sliced 1 when input indices are not constant.
	 [[{{node yolo/yolo_layer/nms/while/strided_slice_4}}]]
	 [[yolo/yolo_layer/nms/while]]
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_2270522491083696922/_3]]
	 [[tpu_compile_succeeded_assert/_2270522491083696922/_3/_119]]
  (1) Invalid argument: {{function_node __inference_eval_step_283661}} Compilation failure: The number of output elements 64512 has to equal to number of input elements that are sliced 1 when input indices are not constant.
	 [[{{node yolo/yolo_layer/nms/while/strided_slice_4}}]]
	 [[yolo/yolo_layer/nms/while]]
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_2270522491083696922/_3]]
	 [[cluster_eval_step/control_after/_1/_227]]
  (2) Invalid argument: {{function_node __inference_eval_step_283661}} Compilation failure: The number of output elements 64512 has to equal to number of input elements that are sliced 1 when input indices are not constant.
	 [[{{node yolo/yolo_layer/nms/while/strided_slice_4}}]]
	 [[yolo/yolo_layer/nms/while]]
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_2270522491083696922/_3]]
	 [[cluster_eval_step/control_after/_1/_255]]
  (3) Invalid argument: {{function_node __inference_eval_step_283661}} Compilation failure: The number of output elements 64512 has to equal to number of input elements that are sliced 1 when input indices are not constant.
	 [[{{node yolo/yolo_layer/nms/while/strided_slice_4}}]]
	 [[yolo/yolo_layer/nms/while]]
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_2270522491083696922/_3]]
0 successful operations.
5 derived errors ignored.
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/tpu_strategy.py", line 738, in async_wait
    context.async_wait()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/context.py", line 2330, in async_wait
    context().sync_executors()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/context.py", line 645, in sync_executors
    pywrap_tfe.TFE_ContextSyncExecutors(self._context_handle)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 4 root error(s) found.
  (0) Invalid argument: {{function_node __inference_eval_step_283661}} Compilation failure: The number of output elements 64512 has to equal to number of input elements that are sliced 1 when input indices are not constant.
	 [[{{node yolo/yolo_layer/nms/while/strided_slice_4}}]]
	 [[yolo/yolo_layer/nms/while]]
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_2270522491083696922/_3]]
	 [[tpu_compile_succeeded_assert/_2270522491083696922/_3/_119]]
  (1) Invalid argument: {{function_node __inference_eval_step_283661}} Compilation failure: The number of output elements 64512 has to equal to number of input elements that are sliced 1 when input indices are not constant.
	 [[{{node yolo/yolo_layer/nms/while/strided_slice_4}}]]
	 [[yolo/yolo_layer/nms/while]]
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_2270522491083696922/_3]]
	 [[cluster_eval_step/control_after/_1/_227]]
  (2) Invalid argument: {{function_node __inference_eval_step_283661}} Compilation failure: The number of output elements 64512 has to equal to number of input elements that are sliced 1 when input indices are not constant.
	 [[{{node yolo/yolo_layer/nms/while/strided_slice_4}}]]
	 [[yolo/yolo_layer/nms/while]]
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_2270522491083696922/_3]]
	 [[cluster_eval_step/control_after/_1/_255]]
  (3) Invalid argument: {{function_node __inference_eval_step_283661}} Compilation failure: The number of output elements 64512 has to equal to number of input elements that are sliced 1 when input indices are not constant.
	 [[{{node yolo/yolo_layer/nms/while/strided_slice_4}}]]
	 [[yolo/yolo_layer/nms/while]]
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_2270522491083696922/_3]]
0 successful operations.
5 derived errors ignored.

                                                                 input_4[0][0]                    
__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'3': (None, 64, 64, 16271360    yolo_fpn[0][0]                   
                                                                 yolo_fpn[0][1]                   
                                                                 yolo_fpn[0][2]                   
==================================================================================================
Total params: 25,897,472
Trainable params: 25,867,520
Non-trainable params: 29,952
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 200, 8), 4: (8, 200, 8), 5: (8, 200, 8)}, inds: {3: (8, 200, 3), 4: (8, 200, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
train | step:  10000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.53729004,
           'avg_obj': 0.12764022,
           'box_loss': 7.3016634,
           'class_loss': 25.98921,
           'conf_loss': 546.5999,
           'precision50': 0.113883786,
           'recall50': 0.07601904},
     '4': {'avg_iou': 0.6009292,
           'avg_obj': 0.22601613,
           'box_loss': 6.0635786,
           'class_loss': 24.75588,
           'conf_loss': 47.4236,
           'precision50': 0.18228409,
           'recall50': 0.18483892},
     '5': {'avg_iou': 0.6008529,
           'avg_obj': 0.30063683,
           'box_loss': 3.0147147,
           'class_loss': 12.421687,
           'conf_loss': 8.034794,
           'precision50': 0.27871752,
           'recall50': 0.27600956},
     'global': {'total_loss': 681.60474},
     'learning_rate': 0.001,
     'training_loss': 681.60474}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-10000.
train | step:  20000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.63420606,
           'avg_obj': 0.20849656,
           'box_loss': 5.804985,
           'class_loss': 5.0930014,
           'conf_loss': 62.628456,
           'precision50': 0.17047885,
           'recall50': 0.14499937},
     '4': {'avg_iou': 0.7303955,
           'avg_obj': 0.35043827,
           'box_loss': 4.1103144,
           'class_loss': 4.1354356,
           'conf_loss': 15.350422,
           'precision50': 0.21651953,
           'recall50': 0.34825817},
     '5': {'avg_iou': 0.7565636,
           'avg_obj': 0.44393447,
           'box_loss': 1.8411669,
           'class_loss': 1.6545557,
           'conf_loss': 2.6007063,
           'precision50': 0.3197746,
           'recall50': 0.49240792},
     'global': {'total_loss': 103.21903},
     'learning_rate': 0.001,
     'training_loss': 103.21903}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-20000.
 eval | step:  20000 | running 625 steps of evaluation...
2021-04-25 20:32:21.245903: W ./tensorflow/core/distributed_runtime/eager/destroy_tensor_handle_node.h:57] Ignoring an error encountered when deleting remote tensors handles: Invalid argument: Unable to find the relevant tensor remote_handle: Op ID: 65015, Output num: 332
Additional GRPC error information from remote target /job:worker/replica:0/task:0:
:{"created":"@1619382741.241856330","description":"Error received from peer ipv4:10.124.160.50:8470","file":"external/com_github_grpc_grpc/src/core/lib/surface/call.cc","file_line":1056,"grpc_message":"Unable to find the relevant tensor remote_handle: Op ID: 65015, Output num: 332","grpc_status":3}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   202    0     0  100   202      0    966 --:--:-- --:--:-- --:--:--   961100   204    0     2  100   202      7    779 --:--:-- --:--:-- --:--:--   784
okRequest issued for: [node-7]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-25T20:35:16.441198419Z'
  endTime: '2021-04-25T20:36:07.973921271Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619382916404-5c0d1f77cd467-ce7b4015-b067ae05
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.124.160.48/29
  createTime: '2021-03-18T03:10:27.166064884Z'
  health: HEALTHY
  ipAddress: 10.124.160.50
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.124.160.50
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619382916404-5c0d1f77cd467-ce7b4015-b067ae05] to complete...
........................................................................................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-7]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619383033407-5c0d1fe762880-66f34461-0a1b0f7d] to complete...
...............................................aborted by ctrl-c.
ERROR: (gcloud.compute.tpus.start) Aborting wait for operation https://tpu.googleapis.com/v1alpha1/projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619383033407-5c0d1fe762880-66f34461-0a1b0f7d.

europe-west4-a
I0425 20:34:50.710357 139927804909376 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'diou',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.2,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.5,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.2,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [400000,
                                                                                450000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.001,
                                                                            0.0001,
                                                                            1e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 500000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0425 20:34:50.711311 139927804909376 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/params.yaml
I0425 20:34:51.539834 139927804909376 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 20:34:52.158247 139927804909376 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0425 20:34:52.158489 139927804909376 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-7" is not yet ready; state: "STARTING"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'diou', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.2, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.2, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [400000, 450000], 'values': [0.001, 0.0001, 1e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 500000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   204    0     2  100   202     12   1239 --:--:-- --:--:-- --:--:--  1251
okRequest issued for: [node-7]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-25T20:37:39.610262975Z'
  endTime: '2021-04-25T20:40:58.048378355Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619383059599-5c0d20005d24a-375dcbdb-e58eeb52
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.124.160.48/29
  createTime: '2021-03-18T03:10:27.166064884Z'
  health: HEALTHY
  ipAddress: 10.124.160.50
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.124.160.50
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619383059599-5c0d20005d24a-375dcbdb-e58eeb52] to complete...
.............................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-7]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-25T20:41:28.980072334Z'
  endTime: '2021-04-25T20:42:05.468683892Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619383288966-5c0d20db1ae70-9cc10f24-4bfb7386
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.124.160.48/29
  createTime: '2021-03-18T03:10:27.166064884Z'
  health: HEALTHY
  ipAddress: 10.124.160.50
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.124.160.50
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619383288966-5c0d20db1ae70-9cc10f24-4bfb7386] to complete...
..................................................................................................................................................................................................done.
europe-west4-a
I0425 20:39:25.095691 140249739700032 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.2,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 2.0,
                                         'aug_scale_min': 0.1,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.2,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [400000,
                                                                                450000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.001,
                                                                            0.0001,
                                                                            1e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 500000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0425 20:39:25.096635 140249739700032 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/params.yaml
I0425 20:39:25.889419 140249739700032 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 20:39:26.504595 140249739700032 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0425 20:39:26.504880 140249739700032 transport.py:157] Attempting refresh to obtain initial access_token
I0425 20:39:26.572795 140249739700032 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 20:39:27.191907 140249739700032 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0425 20:39:27.192185 140249739700032 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-25 20:39:27.279069: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0425 20:39:27.279996 140249739700032 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 20:39:27.422597 140249739700032 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0425 20:39:27.423090 140249739700032 transport.py:157] Attempting refresh to obtain initial access_token
I0425 20:39:27.478737 140249739700032 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 20:39:27.618946 140249739700032 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0425 20:39:27.619463 140249739700032 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-25 20:39:27.660392: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-25 20:39:27.688451: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.124.160.50:8470}
2021-04-25 20:39:27.688528: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:46582}
2021-04-25 20:40:00.447747: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.124.160.50:8470}
2021-04-25 20:40:00.447894: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:46582}
2021-04-25 20:40:00.448530: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:46582
I0425 20:40:00.449608 140249739700032 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-7
I0425 20:40:00.450179 140249739700032 tpu_strategy_util.py:74] Initializing the TPU system: node-7
INFO:tensorflow:Clearing out eager caches
I0425 20:40:08.269271 140249739700032 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0425 20:40:08.271681 140249739700032 tpu_strategy_util.py:133] Finished initializing TPU system.
I0425 20:40:08.275194 140249739700032 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 20:40:08.420938 140249739700032 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0425 20:40:08.421451 140249739700032 transport.py:157] Attempting refresh to obtain initial access_token
I0425 20:40:08.491275 140249739700032 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0425 20:40:09.107623 140249739700032 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0425 20:40:09.107954 140249739700032 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0425 20:40:09.163062 140249739700032 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0425 20:40:09.163293 140249739700032 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0425 20:40:09.163575 140249739700032 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0425 20:40:09.163629 140249739700032 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0425 20:40:09.163680 140249739700032 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0425 20:40:09.163790 140249739700032 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0425 20:40:09.163863 140249739700032 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0425 20:40:09.163980 140249739700032 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0425 20:40:09.164073 140249739700032 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0425 20:40:09.164165 140249739700032 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0425 20:40:09.164274 140249739700032 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0425 20:40:09.164384 140249739700032 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0425 20:40:09.164484 140249739700032 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0425 20:40:09.164572 140249739700032 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0425 20:40:09.164711 140249739700032 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0425 20:40:09.164768 140249739700032 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0425 20:40:09.166195 140249739700032 train_utils.py:214] Running default trainer.
2021-04-25 20:40:09.334901: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.2, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.2, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [400000, 450000], 'values': [0.001, 0.0001, 1e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 500000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f8e08147240>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________
yolo_fpn (YoloFPN)              {'5': (None, 16, 16, 9626112     input_2[0][0]                    
                                                                 input_3[0][0]                    I0425 20:41:00.184606 140249739700032 controller.py:362] restoring or initializing model...
I0425 20:41:14.595099 140249739700032 controller.py:366] restored model from gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-20000.
I0425 20:41:14.595374 140249739700032 controller.py:192] restored from checkpoint: gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-20000
I0425 20:41:14.595490 140249739700032 train_lib.py:96] Starts to execute mode: train_and_eval
I0425 20:41:14.599766 140249739700032 controller.py:211] train | step:  20000 | training until step 40000...
I0425 20:41:20.963332 140249739700032 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0425 20:42:34.299965 140249739700032 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0425 21:48:47.508648 140249739700032 controller.py:425] train | step:  30000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6494305,
           'avg_obj': 0.23850103,
           'box_loss': 5.5805063,
           'class_loss': 4.6664505,
           'conf_loss': 62.415474,
           'precision50': 0.17088524,
           'recall50': 0.17718016},
     '4': {'avg_iou': 0.74797356,
           'avg_obj': 0.39204732,
           'box_loss': 3.8493078,
           'class_loss': 3.130349,
           'conf_loss': 15.244581,
           'precision50': 0.20829047,
           'recall50': 0.40147147},
     '5': {'avg_iou': 0.7797776,
           'avg_obj': 0.49290815,
           'box_loss': 1.6650418,
           'class_loss': 1.3889349,
           'conf_loss': 2.5109005,
           'precision50': 0.30222708,
           'recall50': 0.55623025},
     'global': {'total_loss': 100.451515},
     'learning_rate': 0.001,
     'training_loss': 100.451515}
I0425 21:49:35.125777 140249739700032 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-30000.
I0425 22:49:48.918859 140249739700032 controller.py:425] train | step:  40000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6582365,
           'avg_obj': 0.2571575,
           'box_loss': 5.4410253,
           'class_loss': 4.2509203,
           'conf_loss': 61.528393,
           'precision50': 0.17304456,
           'recall50': 0.19725084},
     '4': {'avg_iou': 0.7598201,
           'avg_obj': 0.41858363,
           'box_loss': 3.6649003,
           'class_loss': 2.7305403,
           'conf_loss': 14.953011,
           'precision50': 0.20669743,
           'recall50': 0.43483517},
     '5': {'avg_iou': 0.7926406,
           'avg_obj': 0.521171,
           'box_loss': 1.5688654,
           'class_loss': 1.2527938,
           'conf_loss': 2.4484386,
           'precision50': 0.29405257,
           'recall50': 0.59191746},
     'global': {'total_loss': 97.838776},
     'learning_rate': 0.001,
     'training_loss': 97.838776}
I0425 22:50:33.605629 140249739700032 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-40000.
I0425 22:50:33.611966 140249739700032 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0425 22:50:34.405355 140249739700032 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0425 22:50:52.454325 140249739700032 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0425 22:55:48.365829 140249739700032 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
/home/cam2tensorflow/.experiment_start.sh: line 22: 16582 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4-$5
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   204    0     2  100   202      4    490 --:--:-- --:--:-- --:--:--   493100   204    0     2  100   202      4    490 --:--:-- --:--:-- --:--:--   493
okRequest issued for: [node-7]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-25T23:06:10.448129343Z'
  endTime: '2021-04-25T23:06:47.651068320Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619391970434-5c0d413265ca4-75eef837-8d951b1a
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.124.160.48/29
  createTime: '2021-03-18T03:10:27.166064884Z'
  health: HEALTHY
  ipAddress: 10.124.160.50
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.124.160.50
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619391970434-5c0d413265ca4-75eef837-8d951b1a] to complete...
..........................................................................................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-7]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-26T00:29:28.137267216Z'
  endTime: '2021-04-26T00:30:02.837702586Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619396968125-5c0d53d09130e-09ad414c-7eac19e2
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.124.160.48/29
  createTime: '2021-03-18T03:10:27.166064884Z'
  health: HEALTHY
  ipAddress: 10.124.160.50
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.124.160.50
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619396968125-5c0d53d09130e-09ad414c-7eac19e2] to complete...
..................................................................................................................................................................................................done.
europe-west4-a
I0426 00:27:33.645975 139713351477056 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.2,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 2.0,
                                         'aug_scale_min': 0.1,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.2,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [400000,
                                                                                450000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.001,
                                                                            0.0001,
                                                                            1e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 500000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0426 00:27:33.647266 139713351477056 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/params.yaml
I0426 00:27:34.442932 139713351477056 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0426 00:27:34.587380 139713351477056 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0426 00:27:34.587646 139713351477056 transport.py:157] Attempting refresh to obtain initial access_token
I0426 00:27:34.647630 139713351477056 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0426 00:27:34.792497 139713351477056 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0426 00:27:34.792735 139713351477056 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-26 00:27:34.856079: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0426 00:27:34.857114 139713351477056 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0426 00:27:35.472911 139713351477056 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0426 00:27:35.473148 139713351477056 transport.py:157] Attempting refresh to obtain initial access_token
I0426 00:27:35.519829 139713351477056 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0426 00:27:36.129430 139713351477056 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0426 00:27:36.129660 139713351477056 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-26 00:27:36.193558: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-26 00:27:36.230037: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.124.160.50:8470}
2021-04-26 00:27:36.230115: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:49639}
2021-04-26 00:28:00.189450: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.124.160.50:8470}
2021-04-26 00:28:00.189533: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:49639}
2021-04-26 00:28:00.190669: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:49639
I0426 00:28:00.191381 139713351477056 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-7
I0426 00:28:00.191751 139713351477056 tpu_strategy_util.py:74] Initializing the TPU system: node-7
INFO:tensorflow:Clearing out eager caches
I0426 00:28:07.816430 139713351477056 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0426 00:28:07.818931 139713351477056 tpu_strategy_util.py:133] Finished initializing TPU system.
I0426 00:28:07.823529 139713351477056 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0426 00:28:08.441253 139713351477056 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0426 00:28:08.441496 139713351477056 transport.py:157] Attempting refresh to obtain initial access_token
I0426 00:28:08.485741 139713351477056 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0426 00:28:08.625050 139713351477056 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0426 00:28:08.625507 139713351477056 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0426 00:28:08.672520 139713351477056 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0426 00:28:08.672763 139713351477056 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0426 00:28:08.673032 139713351477056 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0426 00:28:08.673095 139713351477056 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0426 00:28:08.673143 139713351477056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0426 00:28:08.673317 139713351477056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0426 00:28:08.673364 139713351477056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0426 00:28:08.673408 139713351477056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0426 00:28:08.673455 139713351477056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0426 00:28:08.673507 139713351477056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0426 00:28:08.673551 139713351477056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0426 00:28:08.673596 139713351477056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0426 00:28:08.673640 139713351477056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0426 00:28:08.673684 139713351477056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0426 00:28:08.673727 139713351477056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0426 00:28:08.673772 139713351477056 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0426 00:28:08.675100 139713351477056 train_utils.py:214] Running default trainer.
2021-04-26 00:28:08.793660: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.2, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.2, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [400000, 450000], 'values': [0.001, 0.0001, 1e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 500000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f112459a550>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________
yolo_fpn (YoloFPN)              {'5': (None, 16, 16, 9626112     input_2[0][0]                    
                                                                 input_3[0][0]                    I0426 00:28:59.075400 139713351477056 controller.py:362] restoring or initializing model...
I0426 00:29:13.435763 139713351477056 controller.py:366] restored model from gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-40000.
I0426 00:29:13.436269 139713351477056 controller.py:192] restored from checkpoint: gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-40000
I0426 00:29:13.436422 139713351477056 train_lib.py:96] Starts to execute mode: train_and_eval
I0426 00:29:13.440718 139713351477056 controller.py:211] train | step:  40000 | training until step 60000...
I0426 00:29:19.372223 139713351477056 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0426 00:30:30.985983 139713351477056 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0426 01:37:44.877275 139713351477056 controller.py:425] train | step:  50000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6643264,
           'avg_obj': 0.27148148,
           'box_loss': 5.3365173,
           'class_loss': 3.8263867,
           'conf_loss': 60.641106,
           'precision50': 0.17815056,
           'recall50': 0.21379729},
     '4': {'avg_iou': 0.7677206,
           'avg_obj': 0.43800968,
           'box_loss': 3.5434911,
           'class_loss': 2.505879,
           'conf_loss': 14.746277,
           'precision50': 0.20648345,
           'recall50': 0.45896074},
     '5': {'avg_iou': 0.8012046,
           'avg_obj': 0.54031473,
           'box_loss': 1.502384,
           'class_loss': 1.1649158,
           'conf_loss': 2.3900096,
           'precision50': 0.2902871,
           'recall50': 0.61367327},
     'global': {'total_loss': 95.65702},
     'learning_rate': 0.001,
     'training_loss': 95.65702}
I0426 01:38:34.524628 139713351477056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-50000.
I0426 02:38:31.236548 139713351477056 controller.py:425] train | step:  60000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.66941404,
           'avg_obj': 0.28299266,
           'box_loss': 5.258714,
           'class_loss': 3.4709742,
           'conf_loss': 59.988693,
           'precision50': 0.17957242,
           'recall50': 0.2262771},
     '4': {'avg_iou': 0.7739183,
           'avg_obj': 0.45296982,
           'box_loss': 3.4494612,
           'class_loss': 2.3571682,
           'conf_loss': 14.563673,
           'precision50': 0.20343049,
           'recall50': 0.47655278},
     '5': {'avg_iou': 0.807783,
           'avg_obj': 0.5556651,
           'box_loss': 1.4538126,
           'class_loss': 1.0998142,
           'conf_loss': 2.3392818,
           'precision50': 0.28871593,
           'recall50': 0.6305912},
     'global': {'total_loss': 93.98162},
     'learning_rate': 0.001,
     'training_loss': 93.98162}
I0426 02:39:16.364758 139713351477056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-60000.
I0426 02:39:16.371070 139713351477056 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0426 02:39:17.108524 139713351477056 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0426 02:39:34.704203 139713351477056 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0426 02:44:29.337287 139713351477056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0426 02:49:32.437941 139713351477056 controller.py:261]  eval | step:  60000 | eval time:  616.1 sec | output: 
    {'3': {'avg_iou': 0.50428593,
           'avg_obj': 0.24610862,
           'box_loss': 2.7228708,
           'class_loss': 1.6064665,
           'conf_loss': 40.080967,
           'precision50': 0.13757554,
           'recall50': 0.25225386},
     '4': {'avg_iou': 0.72213984,
           'avg_obj': 0.47973716,
           'box_loss': 2.1178467,
           'class_loss': 1.1360358,
           'conf_loss': 10.447663,
           'precision50': 0.16975555,
           'recall50': 0.52843624},
     '5': {'avg_iou': 0.78182024,
           'avg_obj': 0.6022224,
           'box_loss': 1.104424,
           'class_loss': 0.62328976,
           'conf_loss': 1.94541,
           'precision50': 0.24111085,
           'recall50': 0.6736911},
     'AP': 0.31810525,
     'AP50': 0.48356244,
     'AP75': 0.34999475,
     'APl': 0.43663275,
     'APm': 0.33540663,
     'APs': 0.11573498,
     'ARl': 0.6154044,
     'ARm': 0.5101445,
     'ARmax1': 0.27049077,
     'ARmax10': 0.44097465,
     'ARmax100': 0.47497797,
     'ARs': 0.22672725,
     'global': {'total_loss': 61.784924},
     'validation_loss': 61.784924}

                                                                 input_4[0][0]                    
__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'3': (None, 64, 64, 16271360    yolo_fpn[0][0]                   
                                                                 yolo_fpn[0][1]                   
                                                                 yolo_fpn[0][2]                   
==================================================================================================
Total params: 25,897,472
Trainable params: 25,867,520
Non-trainable params: 29,952
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 200, 8), 4: (8, 200, 8), 5: (8, 200, 8)}, inds: {3: (8, 200, 3), 4: (8, 200, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
restored model from gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-40000.
restored from checkpoint: gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-40000
train | step:  40000 | training until step 60000...
train | step:  50000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6643264,
           'avg_obj': 0.27148148,
           'box_loss': 5.3365173,
           'class_loss': 3.8263867,
           'conf_loss': 60.641106,
           'precision50': 0.17815056,
           'recall50': 0.21379729},
     '4': {'avg_iou': 0.7677206,
           'avg_obj': 0.43800968,
           'box_loss': 3.5434911,
           'class_loss': 2.505879,
           'conf_loss': 14.746277,
           'precision50': 0.20648345,
           'recall50': 0.45896074},
     '5': {'avg_iou': 0.8012046,
           'avg_obj': 0.54031473,
           'box_loss': 1.502384,
           'class_loss': 1.1649158,
           'conf_loss': 2.3900096,
           'precision50': 0.2902871,
           'recall50': 0.61367327},
     'global': {'total_loss': 95.65702},
     'learning_rate': 0.001,
     'training_loss': 95.65702}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-50000.
train | step:  60000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.66941404,
           'avg_obj': 0.28299266,
           'box_loss': 5.258714,
           'class_loss': 3.4709742,
           'conf_loss': 59.988693,
           'precision50': 0.17957242,
           'recall50': 0.2262771},
     '4': {'avg_iou': 0.7739183,
           'avg_obj': 0.45296982,
           'box_loss': 3.4494612,
           'class_loss': 2.3571682,
           'conf_loss': 14.563673,
           'precision50': 0.20343049,
           'recall50': 0.47655278},
     '5': {'avg_iou': 0.807783,
           'avg_obj': 0.5556651,
           'box_loss': 1.4538126,
           'class_loss': 1.0998142,
           'conf_loss': 2.3392818,
           'precision50': 0.28871593,
           'recall50': 0.6305912},
     'global': {'total_loss': 93.98162},
     'learning_rate': 0.001,
     'training_loss': 93.98162}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-60000.
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=203.75s).
Accumulating evaluation results...
DONE (t=40.81s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.318
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.484
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.350
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.116
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.335
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.437
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.270
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.441
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.475
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.227
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.510
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.615
 eval | step:  60000 | eval time:  616.1 sec | output: 
    {'3': {'avg_iou': 0.50428593,
           'avg_obj': 0.24610862,
           'box_loss': 2.7228708,
           'class_loss': 1.6064665,
           'conf_loss': 40.080967,
           'precision50': 0.13757554,
           'recall50': 0.25225386},
     '4': {'avg_iou': 0.72213984,
           'avg_obj': 0.47973716,
           'box_loss': 2.1178467,
           'class_loss': 1.1360358,
           'conf_loss': 10.447663,
           'precision50': 0.16975555,
           'recall50': 0.52843624},
     '5': {'avg_iou': 0.78182024,
           'avg_obj': 0.6022224,
           'box_loss': 1.104424,
           'class_loss': 0.62328976,
           'conf_loss': 1.94541,
           'precision50': 0.24111085,
           'recall50': 0.6736911},
     'AP': 0.31810525,
     'AP50': 0.48356244,
     'AP75': 0.34999475,
     'APl': 0.43663275,
     'APm': 0.33540663,
     'APs': 0.11573498,
     'ARl': 0.6154044,
     'ARm': 0.5101445,
     'ARmax1': 0.27049077,
     'ARmax10': 0.44097465,
     'ARmax100': 0.47497797,
     'ARs': 0.22672725,
     'global': {'total_loss': 61.784924},
     'validation_loss': 61.784924}I0426 02:49:55.300652 139713351477056 controller.py:211] train | step:  60000 | training until step 80000...
I0426 03:50:06.990797 139713351477056 controller.py:425] train | step:  70000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6725793,
           'avg_obj': 0.29194003,
           'box_loss': 5.1994658,
           'class_loss': 3.2370617,
           'conf_loss': 59.197914,
           'precision50': 0.17990331,
           'recall50': 0.2358423},
     '4': {'avg_iou': 0.7788214,
           'avg_obj': 0.46496367,
           'box_loss': 3.3653035,
           'class_loss': 2.2462022,
           'conf_loss': 14.274914,
           'precision50': 0.20501824,
           'recall50': 0.4909851},
     '5': {'avg_iou': 0.8130184,
           'avg_obj': 0.5676533,
           'box_loss': 1.4103752,
           'class_loss': 1.0515847,
           'conf_loss': 2.2957842,
           'precision50': 0.28784698,
           'recall50': 0.6437007},
     'global': {'total_loss': 92.27879},
     'learning_rate': 0.001,
     'training_loss': 92.27879}
I0426 03:50:57.945447 139713351477056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-70000.
I0426 04:51:42.499530 139713351477056 controller.py:425] train | step:  80000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6759362,
           'avg_obj': 0.3000834,
           'box_loss': 5.1538258,
           'class_loss': 3.0751173,
           'conf_loss': 58.924927,
           'precision50': 0.18021673,
           'recall50': 0.24526305},
     '4': {'avg_iou': 0.78283316,
           'avg_obj': 0.47527695,
           'box_loss': 3.3101804,
           'class_loss': 2.163556,
           'conf_loss': 14.105716,
           'precision50': 0.20572454,
           'recall50': 0.5030514},
     '5': {'avg_iou': 0.8171201,
           'avg_obj': 0.5777812,
           'box_loss': 1.3803705,
           'class_loss': 1.0131669,
           'conf_loss': 2.2565577,
           'precision50': 0.28786245,
           'recall50': 0.6544688},
     'global': {'total_loss': 91.383354},
     'learning_rate': 0.001,
     'training_loss': 91.383354}
I0426 04:52:32.910344 139713351477056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-80000.
I0426 04:52:32.916997 139713351477056 controller.py:252]  eval | step:  80000 | running 625 steps of evaluation...
I0426 04:56:51.001507 139713351477056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0426 05:02:00.025508 139713351477056 controller.py:261]  eval | step:  80000 | eval time:  567.1 sec | output: 
    {'3': {'avg_iou': 0.5076263,
           'avg_obj': 0.2518112,
           'box_loss': 2.6756349,
           'class_loss': 1.3699815,
           'conf_loss': 40.288704,
           'precision50': 0.1356026,
           'recall50': 0.2578661},
     '4': {'avg_iou': 0.72655857,
           'avg_obj': 0.4914257,
           'box_loss': 2.0744216,
           'class_loss': 1.052276,
           'conf_loss': 10.366948,
           'precision50': 0.17010427,
           'recall50': 0.5411099},
     '5': {'avg_iou': 0.7883876,
           'avg_obj': 0.61507785,
           'box_loss': 1.0639523,
           'class_loss': 0.5891483,
           'conf_loss': 1.9181828,
           'precision50': 0.23888299,
           'recall50': 0.6864015},
     'AP': 0.3335265,
     'AP50': 0.5035774,
     'AP75': 0.36569715,
     'APl': 0.45430952,
     'APm': 0.34906432,
     'APs': 0.1315584,
     'ARl': 0.63105386,
     'ARm': 0.52664703,
     'ARmax1': 0.2803839,
     'ARmax10': 0.45771733,
     'ARmax100': 0.4927107,
     'ARs': 0.25154313,
     'global': {'total_loss': 61.399242},
     'validation_loss': 61.399242}
I0426 05:02:17.707003 139713351477056 controller.py:211] train | step:  80000 | training until step 100000...
I0426 06:01:43.309621 139713351477056 controller.py:425] train | step:  90000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.678986,
           'avg_obj': 0.30797786,
           'box_loss': 5.1070967,
           'class_loss': 2.95351,
           'conf_loss': 58.164707,
           'precision50': 0.18237102,
           'recall50': 0.2536026},
     '4': {'avg_iou': 0.7862281,
           'avg_obj': 0.4848649,
           'box_loss': 3.2568643,
           'class_loss': 2.094928,
           'conf_loss': 13.903771,
           'precision50': 0.20652173,
           'recall50': 0.5137796},
     '5': {'avg_iou': 0.82076544,
           'avg_obj': 0.58693016,
           'box_loss': 1.3546376,
           'class_loss': 0.98311955,
           'conf_loss': 2.233711,
           'precision50': 0.28655276,
           'recall50': 0.66410124},
     'global': {'total_loss': 90.05255},
     'learning_rate': 0.001,
     'training_loss': 90.05255}
I0426 06:02:33.581361 139713351477056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-90000.
I0426 07:09:14.765458 139713351477056 controller.py:425] train | step:  100000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6819183,
           'avg_obj': 0.31556228,
           'box_loss': 5.068745,
           'class_loss': 2.858513,
           'conf_loss': 57.394573,
           'precision50': 0.18656373,
           'recall50': 0.2624691},
     '4': {'avg_iou': 0.78943133,
           'avg_obj': 0.49396837,
           'box_loss': 3.2149177,
           'class_loss': 2.035651,
           'conf_loss': 13.681545,
           'precision50': 0.20859186,
           'recall50': 0.52472305},
     '5': {'avg_iou': 0.8240467,
           'avg_obj': 0.59551764,
           'box_loss': 1.32979,
           'class_loss': 0.95410323,
           'conf_loss': 2.205977,
           'precision50': 0.28502393,
           'recall50': 0.6733174},
     'global': {'total_loss': 88.74375},
     'learning_rate': 0.001,
     'training_loss': 88.74375}
I0426 07:10:02.354449 139713351477056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-100000.
I0426 07:10:02.360526 139713351477056 controller.py:252]  eval | step:  100000 | running 625 steps of evaluation...
I0426 07:14:18.162029 139713351477056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0426 07:19:30.869343 139713351477056 controller.py:261]  eval | step:  100000 | eval time:  568.5 sec | output: 
    {'3': {'avg_iou': 0.510711,
           'avg_obj': 0.2558913,
           'box_loss': 2.6399097,
           'class_loss': 1.2711043,
           'conf_loss': 39.660828,
           'precision50': 0.13971938,
           'recall50': 0.2644907},
     '4': {'avg_iou': 0.7285935,
           'avg_obj': 0.5010344,
           'box_loss': 2.0499115,
           'class_loss': 1.0081064,
           'conf_loss': 10.294449,
           'precision50': 0.17308365,
           'recall50': 0.5511128},
     '5': {'avg_iou': 0.79216444,
           'avg_obj': 0.6268502,
           'box_loss': 1.0397023,
           'class_loss': 0.5636444,
           'conf_loss': 1.9308299,
           'precision50': 0.23420478,
           'recall50': 0.69738334},
     'AP': 0.34415343,
     'AP50': 0.51699764,
     'AP75': 0.37505436,
     'APl': 0.46510276,
     'APm': 0.36152753,
     'APs': 0.13911666,
     'ARl': 0.64347893,
     'ARm': 0.5362639,
     'ARmax1': 0.2860365,
     'ARmax10': 0.4672707,
     'ARmax100': 0.5028147,
     'ARs': 0.27188194,
     'global': {'total_loss': 60.45849},
     'validation_loss': 60.45849}

train | step:  60000 | training until step 80000...
train | step:  70000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6725793,
           'avg_obj': 0.29194003,
           'box_loss': 5.1994658,
           'class_loss': 3.2370617,
           'conf_loss': 59.197914,
           'precision50': 0.17990331,
           'recall50': 0.2358423},
     '4': {'avg_iou': 0.7788214,
           'avg_obj': 0.46496367,
           'box_loss': 3.3653035,
           'class_loss': 2.2462022,
           'conf_loss': 14.274914,
           'precision50': 0.20501824,
           'recall50': 0.4909851},
     '5': {'avg_iou': 0.8130184,
           'avg_obj': 0.5676533,
           'box_loss': 1.4103752,
           'class_loss': 1.0515847,
           'conf_loss': 2.2957842,
           'precision50': 0.28784698,
           'recall50': 0.6437007},
     'global': {'total_loss': 92.27879},
     'learning_rate': 0.001,
     'training_loss': 92.27879}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-70000.
train | step:  80000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6759362,
           'avg_obj': 0.3000834,
           'box_loss': 5.1538258,
           'class_loss': 3.0751173,
           'conf_loss': 58.924927,
           'precision50': 0.18021673,
           'recall50': 0.24526305},
     '4': {'avg_iou': 0.78283316,
           'avg_obj': 0.47527695,
           'box_loss': 3.3101804,
           'class_loss': 2.163556,
           'conf_loss': 14.105716,
           'precision50': 0.20572454,
           'recall50': 0.5030514},
     '5': {'avg_iou': 0.8171201,
           'avg_obj': 0.5777812,
           'box_loss': 1.3803705,
           'class_loss': 1.0131669,
           'conf_loss': 2.2565577,
           'precision50': 0.28786245,
           'recall50': 0.6544688},
     'global': {'total_loss': 91.383354},
     'learning_rate': 0.001,
     'training_loss': 91.383354}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-80000.
 eval | step:  80000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=213.42s).
Accumulating evaluation results...
DONE (t=37.62s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.334
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.504
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.366
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.132
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.349
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.454
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.280
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.458
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.493
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.252
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.527
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.631
 eval | step:  80000 | eval time:  567.1 sec | output: 
    {'3': {'avg_iou': 0.5076263,
           'avg_obj': 0.2518112,
           'box_loss': 2.6756349,
           'class_loss': 1.3699815,
           'conf_loss': 40.288704,
           'precision50': 0.1356026,
           'recall50': 0.2578661},
     '4': {'avg_iou': 0.72655857,
           'avg_obj': 0.4914257,
           'box_loss': 2.0744216,
           'class_loss': 1.052276,
           'conf_loss': 10.366948,
           'precision50': 0.17010427,
           'recall50': 0.5411099},
     '5': {'avg_iou': 0.7883876,
           'avg_obj': 0.61507785,
           'box_loss': 1.0639523,
           'class_loss': 0.5891483,
           'conf_loss': 1.9181828,
           'precision50': 0.23888299,
           'recall50': 0.6864015},
     'AP': 0.3335265,
     'AP50': 0.5035774,
     'AP75': 0.36569715,
     'APl': 0.45430952,
     'APm': 0.34906432,
     'APs': 0.1315584,
     'ARl': 0.63105386,
     'ARm': 0.52664703,
     'ARmax1': 0.2803839,
     'ARmax10': 0.45771733,
     'ARmax100': 0.4927107,
     'ARs': 0.25154313,
     'global': {'total_loss': 61.399242},
     'validation_loss': 61.399242}
train | step:  80000 | training until step 100000...
train | step:  90000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.678986,
           'avg_obj': 0.30797786,
           'box_loss': 5.1070967,
           'class_loss': 2.95351,
           'conf_loss': 58.164707,
           'precision50': 0.18237102,
           'recall50': 0.2536026},
     '4': {'avg_iou': 0.7862281,
           'avg_obj': 0.4848649,
           'box_loss': 3.2568643,
           'class_loss': 2.094928,
           'conf_loss': 13.903771,
           'precision50': 0.20652173,
           'recall50': 0.5137796},
     '5': {'avg_iou': 0.82076544,
           'avg_obj': 0.58693016,
           'box_loss': 1.3546376,
           'class_loss': 0.98311955,
           'conf_loss': 2.233711,
           'precision50': 0.28655276,
           'recall50': 0.66410124},
     'global': {'total_loss': 90.05255},
     'learning_rate': 0.001,
     'training_loss': 90.05255}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-90000.
train | step:  100000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6819183,
           'avg_obj': 0.31556228,
           'box_loss': 5.068745,
           'class_loss': 2.858513,
           'conf_loss': 57.394573,
           'precision50': 0.18656373,
           'recall50': 0.2624691},
     '4': {'avg_iou': 0.78943133,
           'avg_obj': 0.49396837,
           'box_loss': 3.2149177,
           'class_loss': 2.035651,
           'conf_loss': 13.681545,
           'precision50': 0.20859186,
           'recall50': 0.52472305},
     '5': {'avg_iou': 0.8240467,
           'avg_obj': 0.59551764,
           'box_loss': 1.32979,
           'class_loss': 0.95410323,
           'conf_loss': 2.205977,
           'precision50': 0.28502393,
           'recall50': 0.6733174},
     'global': {'total_loss': 88.74375},
     'learning_rate': 0.001,
     'training_loss': 88.74375}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-100000.
 eval | step:  100000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=209.82s).
Accumulating evaluation results...
DONE (t=39.88s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.344
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.517
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.375
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.139
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.362
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.465
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.286
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.467
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.503
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.272
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.536
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.643
 eval | step:  100000 | eval time:  568.5 sec | output: 
    {'3': {'avg_iou': 0.510711,
           'avg_obj': 0.2558913,
           'box_loss': 2.6399097,
           'class_loss': 1.2711043,
           'conf_loss': 39.660828,
           'precision50': 0.13971938,
           'recall50': 0.2644907},
     '4': {'avg_iou': 0.7285935,
           'avg_obj': 0.5010344,
           'box_loss': 2.0499115,
           'class_loss': 1.0081064,
           'conf_loss': 10.294449,
           'precision50': 0.17308365,
           'recall50': 0.5511128},
     '5': {'avg_iou': 0.79216444,
           'avg_obj': 0.6268502,
           'box_loss': 1.0397023,
           'class_loss': 0.5636444,
           'conf_loss': 1.9308299,
           'precision50': 0.23420478,
           'recall50': 0.69738334},
     'AP': 0.34415343,
     'AP50': 0.51699764,
     'AP75': 0.37505436,
     'APl': 0.46510276,
     'APm': 0.36152753,
     'APs': 0.13911666,
     'ARl': 0.64347893,
     'ARm': 0.5362639,
     'ARmax1': 0.2860365,
     'ARmax10': 0.4672707,
     'ARmax100': 0.5028147,
     'ARs': 0.27188194,
     'global': {'total_loss': 60.45849},
     'validation_loss': 60.45849}I0426 07:19:47.597693 139713351477056 controller.py:211] train | step:  100000 | training until step 120000...
I0426 08:22:16.316837 139713351477056 controller.py:425] train | step:  110000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6840479,
           'avg_obj': 0.32181606,
           'box_loss': 5.0343122,
           'class_loss': 2.7816856,
           'conf_loss': 56.86775,
           'precision50': 0.18780352,
           'recall50': 0.2697632},
     '4': {'avg_iou': 0.7920334,
           'avg_obj': 0.501278,
           'box_loss': 3.1756434,
           'class_loss': 1.992056,
           'conf_loss': 13.531509,
           'precision50': 0.20882574,
           'recall50': 0.5331109},
     '5': {'avg_iou': 0.8267245,
           'avg_obj': 0.6021068,
           'box_loss': 1.3103801,
           'class_loss': 0.93205947,
           'conf_loss': 2.1813538,
           'precision50': 0.28494066,
           'recall50': 0.68045664},
     'global': {'total_loss': 87.806816},
     'learning_rate': 0.001,
     'training_loss': 87.806816}
I0426 08:23:07.745046 139713351477056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-110000.
I0426 09:23:28.144440 139713351477056 controller.py:425] train | step:  120000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6862054,
           'avg_obj': 0.32766527,
           'box_loss': 4.9992123,
           'class_loss': 2.7108996,
           'conf_loss': 56.070606,
           'precision50': 0.19220221,
           'recall50': 0.2761389},
     '4': {'avg_iou': 0.7943925,
           'avg_obj': 0.50831604,
           'box_loss': 3.1386726,
           'class_loss': 1.9421846,
           'conf_loss': 13.367373,
           'precision50': 0.20889941,
           'recall50': 0.5412364},
     '5': {'avg_iou': 0.82920754,
           'avg_obj': 0.6091567,
           'box_loss': 1.2902474,
           'class_loss': 0.91089094,
           'conf_loss': 2.155626,
           'precision50': 0.28429097,
           'recall50': 0.6879389},
     'global': {'total_loss': 86.58568},
     'learning_rate': 0.001,
     'training_loss': 86.58568}
I0426 09:24:17.418453 139713351477056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-120000.
I0426 09:24:17.424445 139713351477056 controller.py:252]  eval | step:  120000 | running 625 steps of evaluation...
I0426 09:28:39.522693 139713351477056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0426 09:33:47.213356 139713351477056 controller.py:261]  eval | step:  120000 | eval time:  569.8 sec | output: 
    {'3': {'avg_iou': 0.51203775,
           'avg_obj': 0.26099628,
           'box_loss': 2.6142519,
           'class_loss': 1.2249284,
           'conf_loss': 39.296776,
           'precision50': 0.14104357,
           'recall50': 0.27214321},
     '4': {'avg_iou': 0.73060846,
           'avg_obj': 0.5066538,
           'box_loss': 2.0256147,
           'class_loss': 0.9865588,
           'conf_loss': 10.315975,
           'precision50': 0.17144977,
           'recall50': 0.557475},
     '5': {'avg_iou': 0.7946409,
           'avg_obj': 0.63342005,
           'box_loss': 1.0227716,
           'class_loss': 0.54726046,
           'conf_loss': 1.926175,
           'precision50': 0.23364682,
           'recall50': 0.70334035},
     'AP': 0.35102323,
     'AP50': 0.5243753,
     'AP75': 0.38328266,
     'APl': 0.48039612,
     'APm': 0.36663276,
     'APs': 0.14175335,
     'ARl': 0.64831495,
     'ARm': 0.5439999,
     'ARmax1': 0.29134783,
     'ARmax10': 0.4737077,
     'ARmax100': 0.5102283,
     'ARs': 0.27841294,
     'global': {'total_loss': 59.96031},
     'validation_loss': 59.96031}
I0426 09:34:04.364988 139713351477056 controller.py:211] train | step:  120000 | training until step 140000...
I0426 10:37:36.116960 139713351477056 controller.py:425] train | step:  130000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.68828475,
           'avg_obj': 0.33302072,
           'box_loss': 4.964147,
           'class_loss': 2.6529763,
           'conf_loss': 55.934933,
           'precision50': 0.190151,
           'recall50': 0.2811839},
     '4': {'avg_iou': 0.79628986,
           'avg_obj': 0.51447475,
           'box_loss': 3.1055396,
           'class_loss': 1.9035742,
           'conf_loss': 13.235203,
           'precision50': 0.2094748,
           'recall50': 0.5473071},
     '5': {'avg_iou': 0.8312343,
           'avg_obj': 0.61454725,
           'box_loss': 1.2734005,
           'class_loss': 0.8936573,
           'conf_loss': 2.1307733,
           'precision50': 0.28434575,
           'recall50': 0.692973},
     'global': {'total_loss': 86.09405},
     'learning_rate': 0.001,
     'training_loss': 86.09405}
I0426 10:38:23.224652 139713351477056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-130000.
I0426 11:49:17.941074 139713351477056 controller.py:425] train | step:  140000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6894461,
           'avg_obj': 0.33783817,
           'box_loss': 4.953433,
           'class_loss': 2.6112194,
           'conf_loss': 55.81123,
           'precision50': 0.18869326,
           'recall50': 0.2874736},
     '4': {'avg_iou': 0.79795635,
           'avg_obj': 0.5198115,
           'box_loss': 3.084236,
           'class_loss': 1.8779621,
           'conf_loss': 13.120758,
           'precision50': 0.2100858,
           'recall50': 0.5536406},
     '5': {'avg_iou': 0.8329073,
           'avg_obj': 0.6186892,
           'box_loss': 1.2627928,
           'class_loss': 0.8819632,
           'conf_loss': 2.1192858,
           'precision50': 0.283735,
           'recall50': 0.69797045},
     'global': {'total_loss': 85.72278},
     'learning_rate': 0.001,
     'training_loss': 85.72278}
I0426 11:50:05.288308 139713351477056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-140000.
I0426 11:50:05.294306 139713351477056 controller.py:252]  eval | step:  140000 | running 625 steps of evaluation...
I0426 11:54:27.761319 139713351477056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0426 11:59:36.435354 139713351477056 controller.py:261]  eval | step:  140000 | eval time:  571.1 sec | output: 
    {'3': {'avg_iou': 0.5129226,
           'avg_obj': 0.26263192,
           'box_loss': 2.6030035,
           'class_loss': 1.1918975,
           'conf_loss': 39.954693,
           'precision50': 0.13585894,
           'recall50': 0.27292016},
     '4': {'avg_iou': 0.7321083,
           'avg_obj': 0.50992453,
           'box_loss': 2.0081117,
           'class_loss': 0.967625,
           'conf_loss': 10.387479,
           'precision50': 0.16962035,
           'recall50': 0.5596884},
     '5': {'avg_iou': 0.79622185,
           'avg_obj': 0.6389396,
           'box_loss': 1.0141064,
           'class_loss': 0.53549707,
           'conf_loss': 1.93039,
           'precision50': 0.23227121,
           'recall50': 0.70846194},
     'AP': 0.35308528,
     'AP50': 0.5271192,
     'AP75': 0.38565317,
     'APl': 0.48448306,
     'APm': 0.37012124,
     'APs': 0.14567105,
     'ARl': 0.64843976,
     'ARm': 0.54504853,
     'ARmax1': 0.2904283,
     'ARmax10': 0.474355,
     'ARmax100': 0.51065373,
     'ARs': 0.28336808,
     'global': {'total_loss': 60.59281},
     'validation_loss': 60.59281}

train | step:  100000 | training until step 120000...
train | step:  110000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6840479,
           'avg_obj': 0.32181606,
           'box_loss': 5.0343122,
           'class_loss': 2.7816856,
           'conf_loss': 56.86775,
           'precision50': 0.18780352,
           'recall50': 0.2697632},
     '4': {'avg_iou': 0.7920334,
           'avg_obj': 0.501278,
           'box_loss': 3.1756434,
           'class_loss': 1.992056,
           'conf_loss': 13.531509,
           'precision50': 0.20882574,
           'recall50': 0.5331109},
     '5': {'avg_iou': 0.8267245,
           'avg_obj': 0.6021068,
           'box_loss': 1.3103801,
           'class_loss': 0.93205947,
           'conf_loss': 2.1813538,
           'precision50': 0.28494066,
           'recall50': 0.68045664},
     'global': {'total_loss': 87.806816},
     'learning_rate': 0.001,
     'training_loss': 87.806816}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-110000.
train | step:  120000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6862054,
           'avg_obj': 0.32766527,
           'box_loss': 4.9992123,
           'class_loss': 2.7108996,
           'conf_loss': 56.070606,
           'precision50': 0.19220221,
           'recall50': 0.2761389},
     '4': {'avg_iou': 0.7943925,
           'avg_obj': 0.50831604,
           'box_loss': 3.1386726,
           'class_loss': 1.9421846,
           'conf_loss': 13.367373,
           'precision50': 0.20889941,
           'recall50': 0.5412364},
     '5': {'avg_iou': 0.82920754,
           'avg_obj': 0.6091567,
           'box_loss': 1.2902474,
           'class_loss': 0.91089094,
           'conf_loss': 2.155626,
           'precision50': 0.28429097,
           'recall50': 0.6879389},
     'global': {'total_loss': 86.58568},
     'learning_rate': 0.001,
     'training_loss': 86.58568}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-120000.
 eval | step:  120000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=208.29s).
Accumulating evaluation results...
DONE (t=37.34s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.351
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.524
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.383
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.142
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.367
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.480
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.291
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.474
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.510
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.278
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.544
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.648
 eval | step:  120000 | eval time:  569.8 sec | output: 
    {'3': {'avg_iou': 0.51203775,
           'avg_obj': 0.26099628,
           'box_loss': 2.6142519,
           'class_loss': 1.2249284,
           'conf_loss': 39.296776,
           'precision50': 0.14104357,
           'recall50': 0.27214321},
     '4': {'avg_iou': 0.73060846,
           'avg_obj': 0.5066538,
           'box_loss': 2.0256147,
           'class_loss': 0.9865588,
           'conf_loss': 10.315975,
           'precision50': 0.17144977,
           'recall50': 0.557475},
     '5': {'avg_iou': 0.7946409,
           'avg_obj': 0.63342005,
           'box_loss': 1.0227716,
           'class_loss': 0.54726046,
           'conf_loss': 1.926175,
           'precision50': 0.23364682,
           'recall50': 0.70334035},
     'AP': 0.35102323,
     'AP50': 0.5243753,
     'AP75': 0.38328266,
     'APl': 0.48039612,
     'APm': 0.36663276,
     'APs': 0.14175335,
     'ARl': 0.64831495,
     'ARm': 0.5439999,
     'ARmax1': 0.29134783,
     'ARmax10': 0.4737077,
     'ARmax100': 0.5102283,
     'ARs': 0.27841294,
     'global': {'total_loss': 59.96031},
     'validation_loss': 59.96031}
train | step:  120000 | training until step 140000...
train | step:  130000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.68828475,
           'avg_obj': 0.33302072,
           'box_loss': 4.964147,
           'class_loss': 2.6529763,
           'conf_loss': 55.934933,
           'precision50': 0.190151,
           'recall50': 0.2811839},
     '4': {'avg_iou': 0.79628986,
           'avg_obj': 0.51447475,
           'box_loss': 3.1055396,
           'class_loss': 1.9035742,
           'conf_loss': 13.235203,
           'precision50': 0.2094748,
           'recall50': 0.5473071},
     '5': {'avg_iou': 0.8312343,
           'avg_obj': 0.61454725,
           'box_loss': 1.2734005,
           'class_loss': 0.8936573,
           'conf_loss': 2.1307733,
           'precision50': 0.28434575,
           'recall50': 0.692973},
     'global': {'total_loss': 86.09405},
     'learning_rate': 0.001,
     'training_loss': 86.09405}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-130000.
train | step:  140000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6894461,
           'avg_obj': 0.33783817,
           'box_loss': 4.953433,
           'class_loss': 2.6112194,
           'conf_loss': 55.81123,
           'precision50': 0.18869326,
           'recall50': 0.2874736},
     '4': {'avg_iou': 0.79795635,
           'avg_obj': 0.5198115,
           'box_loss': 3.084236,
           'class_loss': 1.8779621,
           'conf_loss': 13.120758,
           'precision50': 0.2100858,
           'recall50': 0.5536406},
     '5': {'avg_iou': 0.8329073,
           'avg_obj': 0.6186892,
           'box_loss': 1.2627928,
           'class_loss': 0.8819632,
           'conf_loss': 2.1192858,
           'precision50': 0.283735,
           'recall50': 0.69797045},
     'global': {'total_loss': 85.72278},
     'learning_rate': 0.001,
     'training_loss': 85.72278}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-140000.
 eval | step:  140000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=210.82s).
Accumulating evaluation results...
DONE (t=37.27s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.353
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.527
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.386
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.146
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.370
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.484
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.290
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.474
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.511
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.283
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.545
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.648
 eval | step:  140000 | eval time:  571.1 sec | output: 
    {'3': {'avg_iou': 0.5129226,
           'avg_obj': 0.26263192,
           'box_loss': 2.6030035,
           'class_loss': 1.1918975,
           'conf_loss': 39.954693,
           'precision50': 0.13585894,
           'recall50': 0.27292016},
     '4': {'avg_iou': 0.7321083,
           'avg_obj': 0.50992453,
           'box_loss': 2.0081117,
           'class_loss': 0.967625,
           'conf_loss': 10.387479,
           'precision50': 0.16962035,
           'recall50': 0.5596884},
     '5': {'avg_iou': 0.79622185,
           'avg_obj': 0.6389396,
           'box_loss': 1.0141064,
           'class_loss': 0.53549707,
           'conf_loss': 1.93039,
           'precision50': 0.23227121,
           'recall50': 0.70846194},
     'AP': 0.35308528,
     'AP50': 0.5271192,
     'AP75': 0.38565317,
     'APl': 0.48448306,
     'APm': 0.37012124,
     'APs': 0.14567105,
     'ARl': 0.64843976,
     'ARm': 0.54504853,
     'ARmax1': 0.2904283,
     'ARmax10': 0.474355,
     'ARmax100': 0.51065373,
     'ARs': 0.28336808,
     'global': {'total_loss': 60.59281},
     'validation_loss': 60.59281}I0426 11:59:52.860183 139713351477056 controller.py:211] train | step:  140000 | training until step 160000...
I0426 12:59:53.877420 139713351477056 controller.py:425] train | step:  150000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6907384,
           'avg_obj': 0.34299594,
           'box_loss': 4.9281335,
           'class_loss': 2.565976,
           'conf_loss': 55.523457,
           'precision50': 0.18803245,
           'recall50': 0.29277503},
     '4': {'avg_iou': 0.7997013,
           'avg_obj': 0.52574974,
           'box_loss': 3.0531335,
           'class_loss': 1.8411813,
           'conf_loss': 12.903084,
           'precision50': 0.21090376,
           'recall50': 0.56038487},
     '5': {'avg_iou': 0.83482224,
           'avg_obj': 0.6245484,
           'box_loss': 1.2468532,
           'class_loss': 0.8634878,
           'conf_loss': 2.0903625,
           'precision50': 0.284025,
           'recall50': 0.70354086},
     'global': {'total_loss': 85.015686},
     'learning_rate': 0.001,
     'training_loss': 85.015686}
I0426 13:00:44.967361 139713351477056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-150000.
I0426 14:09:58.047588 139713351477056 controller.py:425] train | step:  160000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.69189405,
           'avg_obj': 0.34680513,
           'box_loss': 4.917424,
           'class_loss': 2.5342097,
           'conf_loss': 55.588375,
           'precision50': 0.18757093,
           'recall50': 0.29749095},
     '4': {'avg_iou': 0.80128443,
           'avg_obj': 0.53046566,
           'box_loss': 3.0321386,
           'class_loss': 1.817571,
           'conf_loss': 12.769801,
           'precision50': 0.21109411,
           'recall50': 0.5658868},
     '5': {'avg_iou': 0.8366889,
           'avg_obj': 0.6290219,
           'box_loss': 1.2338239,
           'class_loss': 0.85187286,
           'conf_loss': 2.0720804,
           'precision50': 0.28366747,
           'recall50': 0.7076985},
     'global': {'total_loss': 84.817375},
     'learning_rate': 0.001,
     'training_loss': 84.817375}
I0426 14:10:45.615422 139713351477056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-160000.
I0426 14:10:45.621687 139713351477056 controller.py:252]  eval | step:  160000 | running 625 steps of evaluation...
I0426 14:15:08.143000 139713351477056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0426 14:20:22.302995 139713351477056 controller.py:261]  eval | step:  160000 | eval time:  576.7 sec | output: 
    {'3': {'avg_iou': 0.5141758,
           'avg_obj': 0.26530498,
           'box_loss': 2.5891297,
           'class_loss': 1.1709019,
           'conf_loss': 40.46297,
           'precision50': 0.13573317,
           'recall50': 0.27686834},
     '4': {'avg_iou': 0.73361635,
           'avg_obj': 0.51524615,
           'box_loss': 1.9973408,
           'class_loss': 0.94887316,
           'conf_loss': 10.343394,
           'precision50': 0.16989085,
           'recall50': 0.56588215},
     '5': {'avg_iou': 0.798008,
           'avg_obj': 0.64500856,
           'box_loss': 1.002738,
           'class_loss': 0.52857184,
           'conf_loss': 1.9184588,
           'precision50': 0.23092674,
           'recall50': 0.7135624},
     'AP': 0.35814995,
     'AP50': 0.5313933,
     'AP75': 0.39019036,
     'APl': 0.49252528,
     'APm': 0.37840182,
     'APs': 0.14631464,
     'ARl': 0.6589302,
     'ARm': 0.55101144,
     'ARmax1': 0.29395515,
     'ARmax10': 0.479748,
     'ARmax100': 0.5166116,
     'ARs': 0.29323125,
     'global': {'total_loss': 60.962376},
     'validation_loss': 60.962376}
I0426 14:20:39.250373 139713351477056 controller.py:211] train | step:  160000 | training until step 180000...
I0426 15:19:51.225081 139713351477056 controller.py:425] train | step:  170000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.69306743,
           'avg_obj': 0.35094076,
           'box_loss': 4.8922896,
           'class_loss': 2.5002131,
           'conf_loss': 55.09852,
           'precision50': 0.19043863,
           'recall50': 0.30176258},
     '4': {'avg_iou': 0.80269533,
           'avg_obj': 0.53536326,
           'box_loss': 3.0063477,
           'class_loss': 1.7921867,
           'conf_loss': 12.667596,
           'precision50': 0.21120332,
           'recall50': 0.5709455},
     '5': {'avg_iou': 0.8379365,
           'avg_obj': 0.63316536,
           'box_loss': 1.2230378,
           'class_loss': 0.84081316,
           'conf_loss': 2.0565493,
           'precision50': 0.28272808,
           'recall50': 0.71223444},
     'global': {'total_loss': 84.07746},
     'learning_rate': 0.001,
     'training_loss': 84.07746}
I0426 15:20:41.336993 139713351477056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-170000.
I0426 16:21:28.097241 139713351477056 controller.py:425] train | step:  180000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6942049,
           'avg_obj': 0.3550896,
           'box_loss': 4.8721714,
           'class_loss': 2.4626927,
           'conf_loss': 54.881138,
           'precision50': 0.19167535,
           'recall50': 0.30676273},
     '4': {'avg_iou': 0.80416936,
           'avg_obj': 0.5400037,
           'box_loss': 2.9862876,
           'class_loss': 1.769576,
           'conf_loss': 12.56222,
           'precision50': 0.21200898,
           'recall50': 0.57605183},
     '5': {'avg_iou': 0.8396666,
           'avg_obj': 0.6377921,
           'box_loss': 1.2109967,
           'class_loss': 0.8294829,
           'conf_loss': 2.0366316,
           'precision50': 0.28259277,
           'recall50': 0.71678823},
     'global': {'total_loss': 83.611015},
     'learning_rate': 0.001,
     'training_loss': 83.611015}
I0426 16:22:17.738929 139713351477056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-180000.
I0426 16:22:17.745406 139713351477056 controller.py:252]  eval | step:  180000 | running 625 steps of evaluation...
I0426 16:26:39.181646 139713351477056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0426 16:31:45.686671 139713351477056 controller.py:261]  eval | step:  180000 | eval time:  567.9 sec | output: 
    {'3': {'avg_iou': 0.51440847,
           'avg_obj': 0.26489845,
           'box_loss': 2.581927,
           'class_loss': 1.1544425,
           'conf_loss': 40.340885,
           'precision50': 0.13694501,
           'recall50': 0.27832192},
     '4': {'avg_iou': 0.7339836,
           'avg_obj': 0.51536596,
           'box_loss': 1.9926015,
           'class_loss': 0.9399256,
           'conf_loss': 10.350573,
           'precision50': 0.17058946,
           'recall50': 0.5666169},
     '5': {'avg_iou': 0.79899335,
           'avg_obj': 0.64637595,
           'box_loss': 0.998978,
           'class_loss': 0.5291256,
           'conf_loss': 1.9476492,
           'precision50': 0.22927798,
           'recall50': 0.7146134},
     'AP': 0.36081752,
     'AP50': 0.53509504,
     'AP75': 0.3925847,
     'APl': 0.4908343,
     'APm': 0.37918478,
     'APs': 0.14812332,
     'ARl': 0.6592628,
     'ARm': 0.55103296,
     'ARmax1': 0.29544455,
     'ARmax10': 0.48192513,
     'ARmax100': 0.51852185,
     'ARs': 0.29340696,
     'global': {'total_loss': 60.8361},
     'validation_loss': 60.8361}

train | step:  140000 | training until step 160000...
train | step:  150000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6907384,
           'avg_obj': 0.34299594,
           'box_loss': 4.9281335,
           'class_loss': 2.565976,
           'conf_loss': 55.523457,
           'precision50': 0.18803245,
           'recall50': 0.29277503},
     '4': {'avg_iou': 0.7997013,
           'avg_obj': 0.52574974,
           'box_loss': 3.0531335,
           'class_loss': 1.8411813,
           'conf_loss': 12.903084,
           'precision50': 0.21090376,
           'recall50': 0.56038487},
     '5': {'avg_iou': 0.83482224,
           'avg_obj': 0.6245484,
           'box_loss': 1.2468532,
           'class_loss': 0.8634878,
           'conf_loss': 2.0903625,
           'precision50': 0.284025,
           'recall50': 0.70354086},
     'global': {'total_loss': 85.015686},
     'learning_rate': 0.001,
     'training_loss': 85.015686}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-150000.
train | step:  160000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.69189405,
           'avg_obj': 0.34680513,
           'box_loss': 4.917424,
           'class_loss': 2.5342097,
           'conf_loss': 55.588375,
           'precision50': 0.18757093,
           'recall50': 0.29749095},
     '4': {'avg_iou': 0.80128443,
           'avg_obj': 0.53046566,
           'box_loss': 3.0321386,
           'class_loss': 1.817571,
           'conf_loss': 12.769801,
           'precision50': 0.21109411,
           'recall50': 0.5658868},
     '5': {'avg_iou': 0.8366889,
           'avg_obj': 0.6290219,
           'box_loss': 1.2338239,
           'class_loss': 0.85187286,
           'conf_loss': 2.0720804,
           'precision50': 0.28366747,
           'recall50': 0.7076985},
     'global': {'total_loss': 84.817375},
     'learning_rate': 0.001,
     'training_loss': 84.817375}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-160000.
 eval | step:  160000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=216.44s).
Accumulating evaluation results...
DONE (t=37.95s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.358
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.531
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.390
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.146
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.378
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.493
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.294
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.480
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.517
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.293
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.551
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.659
 eval | step:  160000 | eval time:  576.7 sec | output: 
    {'3': {'avg_iou': 0.5141758,
           'avg_obj': 0.26530498,
           'box_loss': 2.5891297,
           'class_loss': 1.1709019,
           'conf_loss': 40.46297,
           'precision50': 0.13573317,
           'recall50': 0.27686834},
     '4': {'avg_iou': 0.73361635,
           'avg_obj': 0.51524615,
           'box_loss': 1.9973408,
           'class_loss': 0.94887316,
           'conf_loss': 10.343394,
           'precision50': 0.16989085,
           'recall50': 0.56588215},
     '5': {'avg_iou': 0.798008,
           'avg_obj': 0.64500856,
           'box_loss': 1.002738,
           'class_loss': 0.52857184,
           'conf_loss': 1.9184588,
           'precision50': 0.23092674,
           'recall50': 0.7135624},
     'AP': 0.35814995,
     'AP50': 0.5313933,
     'AP75': 0.39019036,
     'APl': 0.49252528,
     'APm': 0.37840182,
     'APs': 0.14631464,
     'ARl': 0.6589302,
     'ARm': 0.55101144,
     'ARmax1': 0.29395515,
     'ARmax10': 0.479748,
     'ARmax100': 0.5166116,
     'ARs': 0.29323125,
     'global': {'total_loss': 60.962376},
     'validation_loss': 60.962376}
train | step:  160000 | training until step 180000...
train | step:  170000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.69306743,
           'avg_obj': 0.35094076,
           'box_loss': 4.8922896,
           'class_loss': 2.5002131,
           'conf_loss': 55.09852,
           'precision50': 0.19043863,
           'recall50': 0.30176258},
     '4': {'avg_iou': 0.80269533,
           'avg_obj': 0.53536326,
           'box_loss': 3.0063477,
           'class_loss': 1.7921867,
           'conf_loss': 12.667596,
           'precision50': 0.21120332,
           'recall50': 0.5709455},
     '5': {'avg_iou': 0.8379365,
           'avg_obj': 0.63316536,
           'box_loss': 1.2230378,
           'class_loss': 0.84081316,
           'conf_loss': 2.0565493,
           'precision50': 0.28272808,
           'recall50': 0.71223444},
     'global': {'total_loss': 84.07746},
     'learning_rate': 0.001,
     'training_loss': 84.07746}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-170000.
train | step:  180000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6942049,
           'avg_obj': 0.3550896,
           'box_loss': 4.8721714,
           'class_loss': 2.4626927,
           'conf_loss': 54.881138,
           'precision50': 0.19167535,
           'recall50': 0.30676273},
     '4': {'avg_iou': 0.80416936,
           'avg_obj': 0.5400037,
           'box_loss': 2.9862876,
           'class_loss': 1.769576,
           'conf_loss': 12.56222,
           'precision50': 0.21200898,
           'recall50': 0.57605183},
     '5': {'avg_iou': 0.8396666,
           'avg_obj': 0.6377921,
           'box_loss': 1.2109967,
           'class_loss': 0.8294829,
           'conf_loss': 2.0366316,
           'precision50': 0.28259277,
           'recall50': 0.71678823},
     'global': {'total_loss': 83.611015},
     'learning_rate': 0.001,
     'training_loss': 83.611015}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-180000.
 eval | step:  180000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=207.96s).
Accumulating evaluation results...
DONE (t=41.09s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.361
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.535
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.393
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.148
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.379
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.295
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.482
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.519
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.293
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.551
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.659
 eval | step:  180000 | eval time:  567.9 sec | output: 
    {'3': {'avg_iou': 0.51440847,
           'avg_obj': 0.26489845,
           'box_loss': 2.581927,
           'class_loss': 1.1544425,
           'conf_loss': 40.340885,
           'precision50': 0.13694501,
           'recall50': 0.27832192},
     '4': {'avg_iou': 0.7339836,
           'avg_obj': 0.51536596,
           'box_loss': 1.9926015,
           'class_loss': 0.9399256,
           'conf_loss': 10.350573,
           'precision50': 0.17058946,
           'recall50': 0.5666169},
     '5': {'avg_iou': 0.79899335,
           'avg_obj': 0.64637595,
           'box_loss': 0.998978,
           'class_loss': 0.5291256,
           'conf_loss': 1.9476492,
           'precision50': 0.22927798,
           'recall50': 0.7146134},
     'AP': 0.36081752,
     'AP50': 0.53509504,
     'AP75': 0.3925847,
     'APl': 0.4908343,
     'APm': 0.37918478,
     'APs': 0.14812332,
     'ARl': 0.6592628,
     'ARm': 0.55103296,
     'ARmax1': 0.29544455,
     'ARmax10': 0.48192513,
     'ARmax100': 0.51852185,
     'ARs': 0.29340696,
     'global': {'total_loss': 60.8361},
     'validation_loss': 60.8361}I0426 16:32:02.485600 139713351477056 controller.py:211] train | step:  180000 | training until step 200000...
I0426 17:27:53.618908 139713351477056 controller.py:425] train | step:  190000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6952308,
           'avg_obj': 0.3591959,
           'box_loss': 4.8567533,
           'class_loss': 2.4219174,
           'conf_loss': 53.871624,
           'precision50': 0.20055504,
           'recall50': 0.3101892},
     '4': {'avg_iou': 0.8057347,
           'avg_obj': 0.54573035,
           'box_loss': 2.9613726,
           'class_loss': 1.7381225,
           'conf_loss': 12.392131,
           'precision50': 0.21268076,
           'recall50': 0.5821296},
     '5': {'avg_iou': 0.8410935,
           'avg_obj': 0.64239883,
           'box_loss': 1.1979259,
           'class_loss': 0.8143933,
           'conf_loss': 2.0101843,
           'precision50': 0.28221694,
           'recall50': 0.7215417},
     'global': {'total_loss': 82.26418},
     'learning_rate': 0.001,
     'training_loss': 82.26418}
I0426 17:28:41.056947 139713351477056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-190000.
I0426 18:27:57.392967 139713351477056 controller.py:425] train | step:  200000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.69587326,
           'avg_obj': 0.36256486,
           'box_loss': 4.845955,
           'class_loss': 2.3982778,
           'conf_loss': 53.3791,
           'precision50': 0.20323604,
           'recall50': 0.31449568},
     '4': {'avg_iou': 0.8066285,
           'avg_obj': 0.549175,
           'box_loss': 2.949357,
           'class_loss': 1.7218555,
           'conf_loss': 12.314872,
           'precision50': 0.21387964,
           'recall50': 0.58639157},
     '5': {'avg_iou': 0.842052,
           'avg_obj': 0.64566183,
           'box_loss': 1.1921871,
           'class_loss': 0.8058398,
           'conf_loss': 1.9967096,
           'precision50': 0.2834887,
           'recall50': 0.72488815},
     'global': {'total_loss': 81.60417},
     'learning_rate': 0.001,
     'training_loss': 81.60417}
I0426 18:28:44.659739 139713351477056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-200000.
I0426 18:28:44.665898 139713351477056 controller.py:252]  eval | step:  200000 | running 625 steps of evaluation...
I0426 18:33:03.514469 139713351477056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0426 18:37:59.831213 139713351477056 controller.py:261]  eval | step:  200000 | eval time:  555.2 sec | output: 
    {'3': {'avg_iou': 0.51446223,
           'avg_obj': 0.26573917,
           'box_loss': 2.580671,
           'class_loss': 1.1357214,
           'conf_loss': 39.767536,
           'precision50': 0.14439338,
           'recall50': 0.27931806},
     '4': {'avg_iou': 0.7344807,
           'avg_obj': 0.5168583,
           'box_loss': 1.9837356,
           'class_loss': 0.930129,
           'conf_loss': 10.316847,
           'precision50': 0.1705414,
           'recall50': 0.5688497},
     '5': {'avg_iou': 0.8000588,
           'avg_obj': 0.649371,
           'box_loss': 0.9931743,
           'class_loss': 0.51616174,
           'conf_loss': 1.937133,
           'precision50': 0.22791001,
           'recall50': 0.71796036},
     'AP': 0.36233276,
     'AP50': 0.53662324,
     'AP75': 0.39470574,
     'APl': 0.496802,
     'APm': 0.37836993,
     'APs': 0.15007776,
     'ARl': 0.66027606,
     'ARm': 0.5512203,
     'ARmax1': 0.29648125,
     'ARmax10': 0.48284277,
     'ARmax100': 0.51998156,
     'ARs': 0.29820457,
     'global': {'total_loss': 60.161118},
     'validation_loss': 60.161118}
I0426 18:38:16.694298 139713351477056 controller.py:211] train | step:  200000 | training until step 220000...
I0426 19:36:27.146776 139713351477056 controller.py:425] train | step:  210000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6969428,
           'avg_obj': 0.36610293,
           'box_loss': 4.8374853,
           'class_loss': 2.3724084,
           'conf_loss': 52.7894,
           'precision50': 0.20621003,
           'recall50': 0.3186692},
     '4': {'avg_iou': 0.8079509,
           'avg_obj': 0.55309963,
           'box_loss': 2.9311175,
           'class_loss': 1.7016544,
           'conf_loss': 12.201366,
           'precision50': 0.2145741,
           'recall50': 0.59085727},
     '5': {'avg_iou': 0.84335536,
           'avg_obj': 0.64925027,
           'box_loss': 1.1820244,
           'class_loss': 0.7954152,
           'conf_loss': 1.9788445,
           'precision50': 0.2828087,
           'recall50': 0.7283354},
     'global': {'total_loss': 80.79003},
     'learning_rate': 0.001,
     'training_loss': 80.79003}
I0426 19:37:14.773482 139713351477056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-210000.
I0426 20:36:31.771616 139713351477056 controller.py:425] train | step:  220000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6973018,
           'avg_obj': 0.3701136,
           'box_loss': 4.829981,
           'class_loss': 2.3479648,
           'conf_loss': 52.647987,
           'precision50': 0.20428564,
           'recall50': 0.3232032},
     '4': {'avg_iou': 0.8090839,
           'avg_obj': 0.5568768,
           'box_loss': 2.9144692,
           'class_loss': 1.6856638,
           'conf_loss': 12.117374,
           'precision50': 0.21451621,
           'recall50': 0.5947272},
     '5': {'avg_iou': 0.8444082,
           'avg_obj': 0.6526843,
           'box_loss': 1.1749487,
           'class_loss': 0.78703064,
           'conf_loss': 1.965593,
           'precision50': 0.2814384,
           'recall50': 0.73131496},
     'global': {'total_loss': 80.471},
     'learning_rate': 0.001,
     'training_loss': 80.471}
I0426 20:37:24.924736 139713351477056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-220000.
I0426 20:37:24.931800 139713351477056 controller.py:252]  eval | step:  220000 | running 625 steps of evaluation...
I0426 20:41:42.988577 139713351477056 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0426 20:46:40.687303 139713351477056 controller.py:261]  eval | step:  220000 | eval time:  555.8 sec | output: 
    {'3': {'avg_iou': 0.5140659,
           'avg_obj': 0.26729158,
           'box_loss': 2.5765803,
           'class_loss': 1.1255634,
           'conf_loss': 39.69995,
           'precision50': 0.14292721,
           'recall50': 0.2816008},
     '4': {'avg_iou': 0.734912,
           'avg_obj': 0.51966184,
           'box_loss': 1.9737277,
           'class_loss': 0.9345244,
           'conf_loss': 10.372388,
           'precision50': 0.17163572,
           'recall50': 0.5717366},
     '5': {'avg_iou': 0.80128515,
           'avg_obj': 0.65196013,
           'box_loss': 0.9877049,
           'class_loss': 0.51976067,
           'conf_loss': 1.9631469,
           'precision50': 0.22757758,
           'recall50': 0.71946585},
     'AP': 0.36294115,
     'AP50': 0.5359407,
     'AP75': 0.39493144,
     'APl': 0.49911708,
     'APm': 0.3785107,
     'APs': 0.1497418,
     'ARl': 0.66239554,
     'ARm': 0.55235875,
     'ARmax1': 0.2963078,
     'ARmax10': 0.48271802,
     'ARmax100': 0.520886,
     'ARs': 0.30073032,
     'global': {'total_loss': 60.15339},
     'validation_loss': 60.15339}

train | step:  180000 | training until step 200000...
train | step:  190000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6952308,
           'avg_obj': 0.3591959,
           'box_loss': 4.8567533,
           'class_loss': 2.4219174,
           'conf_loss': 53.871624,
           'precision50': 0.20055504,
           'recall50': 0.3101892},
     '4': {'avg_iou': 0.8057347,
           'avg_obj': 0.54573035,
           'box_loss': 2.9613726,
           'class_loss': 1.7381225,
           'conf_loss': 12.392131,
           'precision50': 0.21268076,
           'recall50': 0.5821296},
     '5': {'avg_iou': 0.8410935,
           'avg_obj': 0.64239883,
           'box_loss': 1.1979259,
           'class_loss': 0.8143933,
           'conf_loss': 2.0101843,
           'precision50': 0.28221694,
           'recall50': 0.7215417},
     'global': {'total_loss': 82.26418},
     'learning_rate': 0.001,
     'training_loss': 82.26418}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-190000.
train | step:  200000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.69587326,
           'avg_obj': 0.36256486,
           'box_loss': 4.845955,
           'class_loss': 2.3982778,
           'conf_loss': 53.3791,
           'precision50': 0.20323604,
           'recall50': 0.31449568},
     '4': {'avg_iou': 0.8066285,
           'avg_obj': 0.549175,
           'box_loss': 2.949357,
           'class_loss': 1.7218555,
           'conf_loss': 12.314872,
           'precision50': 0.21387964,
           'recall50': 0.58639157},
     '5': {'avg_iou': 0.842052,
           'avg_obj': 0.64566183,
           'box_loss': 1.1921871,
           'class_loss': 0.8058398,
           'conf_loss': 1.9967096,
           'precision50': 0.2834887,
           'recall50': 0.72488815},
     'global': {'total_loss': 81.60417},
     'learning_rate': 0.001,
     'training_loss': 81.60417}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-200000.
 eval | step:  200000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=209.39s).
Accumulating evaluation results...
DONE (t=35.40s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.362
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.537
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.395
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.150
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.378
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.497
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.296
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.483
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.520
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.298
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.551
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.660
 eval | step:  200000 | eval time:  555.2 sec | output: 
    {'3': {'avg_iou': 0.51446223,
           'avg_obj': 0.26573917,
           'box_loss': 2.580671,
           'class_loss': 1.1357214,
           'conf_loss': 39.767536,
           'precision50': 0.14439338,
           'recall50': 0.27931806},
     '4': {'avg_iou': 0.7344807,
           'avg_obj': 0.5168583,
           'box_loss': 1.9837356,
           'class_loss': 0.930129,
           'conf_loss': 10.316847,
           'precision50': 0.1705414,
           'recall50': 0.5688497},
     '5': {'avg_iou': 0.8000588,
           'avg_obj': 0.649371,
           'box_loss': 0.9931743,
           'class_loss': 0.51616174,
           'conf_loss': 1.937133,
           'precision50': 0.22791001,
           'recall50': 0.71796036},
     'AP': 0.36233276,
     'AP50': 0.53662324,
     'AP75': 0.39470574,
     'APl': 0.496802,
     'APm': 0.37836993,
     'APs': 0.15007776,
     'ARl': 0.66027606,
     'ARm': 0.5512203,
     'ARmax1': 0.29648125,
     'ARmax10': 0.48284277,
     'ARmax100': 0.51998156,
     'ARs': 0.29820457,
     'global': {'total_loss': 60.161118},
     'validation_loss': 60.161118}
train | step:  200000 | training until step 220000...
train | step:  210000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6969428,
           'avg_obj': 0.36610293,
           'box_loss': 4.8374853,
           'class_loss': 2.3724084,
           'conf_loss': 52.7894,
           'precision50': 0.20621003,
           'recall50': 0.3186692},
     '4': {'avg_iou': 0.8079509,
           'avg_obj': 0.55309963,
           'box_loss': 2.9311175,
           'class_loss': 1.7016544,
           'conf_loss': 12.201366,
           'precision50': 0.2145741,
           'recall50': 0.59085727},
     '5': {'avg_iou': 0.84335536,
           'avg_obj': 0.64925027,
           'box_loss': 1.1820244,
           'class_loss': 0.7954152,
           'conf_loss': 1.9788445,
           'precision50': 0.2828087,
           'recall50': 0.7283354},
     'global': {'total_loss': 80.79003},
     'learning_rate': 0.001,
     'training_loss': 80.79003}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-210000.
train | step:  220000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6973018,
           'avg_obj': 0.3701136,
           'box_loss': 4.829981,
           'class_loss': 2.3479648,
           'conf_loss': 52.647987,
           'precision50': 0.20428564,
           'recall50': 0.3232032},
     '4': {'avg_iou': 0.8090839,
           'avg_obj': 0.5568768,
           'box_loss': 2.9144692,
           'class_loss': 1.6856638,
           'conf_loss': 12.117374,
           'precision50': 0.21451621,
           'recall50': 0.5947272},
     '5': {'avg_iou': 0.8444082,
           'avg_obj': 0.6526843,
           'box_loss': 1.1749487,
           'class_loss': 0.78703064,
           'conf_loss': 1.965593,
           'precision50': 0.2814384,
           'recall50': 0.73131496},
     'global': {'total_loss': 80.471},
     'learning_rate': 0.001,
     'training_loss': 80.471}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-220000.
 eval | step:  220000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=203.49s).
Accumulating evaluation results...
DONE (t=37.03s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.363
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.536
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.395
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.150
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.379
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.499
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.296
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.483
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.521
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.301
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.552
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.662
 eval | step:  220000 | eval time:  555.8 sec | output: 
    {'3': {'avg_iou': 0.5140659,
           'avg_obj': 0.26729158,
           'box_loss': 2.5765803,
           'class_loss': 1.1255634,
           'conf_loss': 39.69995,
           'precision50': 0.14292721,
           'recall50': 0.2816008},
     '4': {'avg_iou': 0.734912,
           'avg_obj': 0.51966184,
           'box_loss': 1.9737277,
           'class_loss': 0.9345244,
           'conf_loss': 10.372388,
           'precision50': 0.17163572,
           'recall50': 0.5717366},
     '5': {'avg_iou': 0.80128515,
           'avg_obj': 0.65196013,
           'box_loss': 0.9877049,
           'class_loss': 0.51976067,
           'conf_loss': 1.9631469,
           'precision50': 0.22757758,
           'recall50': 0.71946585},
     'AP': 0.36294115,
     'AP50': 0.5359407,
     'AP75': 0.39493144,
     'APl': 0.49911708,
     'APm': 0.3785107,
     'APs': 0.1497418,
     'ARl': 0.66239554,
     'ARm': 0.55235875,
     'ARmax1': 0.2963078,
     'ARmax10': 0.48271802,
     'ARmax100': 0.520886,
     'ARs': 0.30073032,
     'global': {'total_loss': 60.15339},
     'validation_loss': 60.15339}I0426 20:46:57.539561 139713351477056 controller.py:211] train | step:  220000 | training until step 240000...
I0426 21:39:30.038142 139713351477056 controller.py:425] train | step:  230000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.69824713,
           'avg_obj': 0.37358713,
           'box_loss': 4.816926,
           'class_loss': 2.329237,
           'conf_loss': 52.67822,
           'precision50': 0.19963577,
           'recall50': 0.32685554},
     '4': {'avg_iou': 0.810062,
           'avg_obj': 0.5609073,
           'box_loss': 2.8967354,
           'class_loss': 1.6669817,
           'conf_loss': 12.0321245,
           'precision50': 0.21412845,
           'recall50': 0.5992878},
     '5': {'avg_iou': 0.84534675,
           'avg_obj': 0.6557951,
           'box_loss': 1.1667769,
           'class_loss': 0.7792802,
           'conf_loss': 1.9508715,
           'precision50': 0.28204238,
           'recall50': 0.7344667},
     'global': {'total_loss': 80.317474},
     'learning_rate': 0.001,
     'training_loss': 80.317474}
I0426 21:40:17.050010 139713351477056 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-prop-sig-2x-jitter-diounms/ckpt-230000.
/home/cam2tensorflow/.experiment_start.sh: line 22: 19639 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4-$5
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   204    0     2  100   202     10   1097 --:--:-- --:--:-- --:--:--  1108
okRequest issued for: [node-7]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-26T22:02:31.897967756Z'
  endTime: '2021-04-26T22:03:29.664696465Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619474551885-5c0e74d634d13-3c61399b-1ab9e2ae
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.124.160.48/29
  createTime: '2021-03-18T03:10:27.166064884Z'
  health: HEALTHY
  ipAddress: 10.124.160.50
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.124.160.50
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619474551885-5c0e74d634d13-3c61399b-1ab9e2ae] to complete...
..........................................................................................................................................................................................................................................................................................................................................................................................done.
