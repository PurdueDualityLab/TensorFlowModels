cat: .experiment_zone: No such file or directory
Request issued for: [node-6]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621279253959-5c28b7e039254-97ac6c6c-b82fa603] to complete...
..................................................................................................................................................aborted by ctrl-c.
ERROR: (gcloud.compute.tpus.start) Aborting wait for operation https://tpu.googleapis.com/v1alpha1/projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621279253959-5c28b7e039254-97ac6c6c-b82fa603.

europe-west4-a
I0517 19:15:43.581776 140644265961280 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[12.0, 16.0]',
                              '[19.0, 36.0]',
                              '[40.0, 28.0]',
                              '[36.0, 75.0]',
                              '[76.0, 55.0]',
                              '[72.0, 146.0]',
                              '[142.0, 110.0]',
                              '[192.0, 243.0]',
                              '[459.0, 401.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 640,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'input_size': [640, 640, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.0,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.1,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 2.0,
                                         'aug_scale_min': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0517 19:15:43.582687 140644265961280 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/params.yaml
I0517 19:15:45.130002 140644265961280 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:15:45.756080 140644265961280 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0517 19:15:45.756367 140644265961280 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-6" is not yet ready; state: "STARTING"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, 'input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 640, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.0, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.1, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     12   1253 --:--:-- --:--:-- --:--:--  1257100   210    0     2  100   208     12   1253 --:--:-- --:--:-- --:--:--  1257
okRequest issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-17T19:21:29.605561691Z'
  endTime: '2021-05-17T19:24:44.037681932Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621279289588-5c28b80233aa7-0e48b501-44f93061
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-04-28T09:49:15.232857330Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-28T09:48:54.136196+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621279289588-5c28b80233aa7-0e48b501-44f93061] to complete...
........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-17T19:26:36.679843290Z'
  endTime: '2021-05-17T19:27:33.602505115Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621279596664-5c28b9270d4e5-8234217d-960df8aa
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-04-28T09:49:15.232857330Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-28T09:48:54.136196+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621279596664-5c28b9270d4e5-8234217d-960df8aa] to complete...
...............................................................................................................................................................................................................................................................................................................................................................................................done.
europe-west4-a
I0517 19:22:13.825150 140513721280320 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[12.0, 16.0]',
                              '[19.0, 36.0]',
                              '[40.0, 28.0]',
                              '[36.0, 75.0]',
                              '[76.0, 55.0]',
                              '[72.0, 146.0]',
                              '[142.0, 110.0]',
                              '[192.0, 243.0]',
                              '[459.0, 401.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 640,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'input_size': [640, 640, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.0,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.1,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 2.0,
                                         'aug_scale_min': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0517 19:22:13.826536 140513721280320 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/params.yaml
I0517 19:22:14.660978 140513721280320 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:22:14.817088 140513721280320 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0517 19:22:14.817381 140513721280320 transport.py:157] Attempting refresh to obtain initial access_token
I0517 19:22:14.871915 140513721280320 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:22:15.017943 140513721280320 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0517 19:22:15.018234 140513721280320 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-17 19:22:15.085354: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0517 19:22:15.086083 140513721280320 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:22:15.708009 140513721280320 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0517 19:22:15.708270 140513721280320 transport.py:157] Attempting refresh to obtain initial access_token
I0517 19:22:15.750592 140513721280320 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:22:15.999201 140513721280320 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0517 19:22:15.999503 140513721280320 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-17 19:22:16.055818: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-17 19:22:16.083871: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-05-17 19:22:16.083957: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:50119}
2021-05-17 19:22:35.904610: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-05-17 19:22:35.904701: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:50119}
2021-05-17 19:22:35.905228: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:50119
I0517 19:22:35.906056 140513721280320 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-6
I0517 19:22:35.907874 140513721280320 tpu_strategy_util.py:74] Initializing the TPU system: node-6
INFO:tensorflow:Clearing out eager caches
I0517 19:22:43.715493 140513721280320 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0517 19:22:43.717777 140513721280320 tpu_strategy_util.py:133] Finished initializing TPU system.
I0517 19:22:43.719139 140513721280320 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:22:44.346156 140513721280320 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0517 19:22:44.346431 140513721280320 transport.py:157] Attempting refresh to obtain initial access_token
I0517 19:22:44.395565 140513721280320 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0517 19:22:45.013757 140513721280320 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0517 19:22:45.014049 140513721280320 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0517 19:22:45.060652 140513721280320 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0517 19:22:45.060998 140513721280320 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0517 19:22:45.061347 140513721280320 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0517 19:22:45.061440 140513721280320 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0517 19:22:45.061494 140513721280320 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0517 19:22:45.061685 140513721280320 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0517 19:22:45.061781 140513721280320 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0517 19:22:45.061831 140513721280320 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0517 19:22:45.061877 140513721280320 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0517 19:22:45.061923 140513721280320 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0517 19:22:45.061968 140513721280320 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0517 19:22:45.062010 140513721280320 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0517 19:22:45.062054 140513721280320 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0517 19:22:45.062098 140513721280320 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0517 19:22:45.062142 140513721280320 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0517 19:22:45.062188 140513721280320 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0517 19:22:45.063615 140513721280320 train_utils.py:214] Running default trainer.
2021-05-17 19:22:45.080195: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, 'input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 640, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.0, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.1, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
heheheeheheheheheheheh:  [[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, 'input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 640, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7fcb82211d68>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 80, 80, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 40, 40, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 20, 20, 1024 0                                            
__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'5': (None, 20, 20, 57800704    input_2[0][0]                    
                                                                 input_3[0][0]                    
                                                                 input_4[0][0]                    
==================================================================================================I0517 19:23:32.307229 140513721280320 controller.py:362] restoring or initializing model...
I0517 19:23:39.983460 140513721280320 yolo.py:537] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0517 19:23:39.985169 140513721280320 controller.py:368] initialized model.
I0517 19:23:39.985390 140513721280320 train_lib.py:96] Starts to execute mode: train_and_eval
I0517 19:23:39.990137 140513721280320 controller.py:211] train | step:      0 | training until step 20000...
I0517 19:23:48.030516 140513721280320 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0517 19:24:31.403337 140513721280320 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0517 21:10:06.827733 140513721280320 controller.py:425] train | step:  10000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.45195577,
           'avg_obj': 0.07634275,
           'box_loss': 0.17395872,
           'class_loss': 0.38389185,
           'conf_loss': 1.3929124,
           'precision50': 0.08093184,
           'recall50': 0.025856497},
     '4': {'avg_iou': 0.5100498,
           'avg_obj': 0.12711959,
           'box_loss': 0.18086638,
           'class_loss': 0.4016315,
           'conf_loss': 0.47436678,
           'precision50': 0.23672727,
           'recall50': 0.04896092},
     '5': {'avg_iou': 0.52900076,
           'avg_obj': 0.17768967,
           'box_loss': 0.184331,
           'class_loss': 0.38268563,
           'conf_loss': 0.24958801,
           'precision50': 0.34578377,
           'recall50': 0.08785128},
     'global': {'total_loss': 3.8242333},
     'learning_rate': 0.009985589,
     'training_loss': 3.8242333}
I0517 21:11:24.686868 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-10000.
I0517 22:52:16.045642 140513721280320 controller.py:425] train | step:  20000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.55573654,
           'avg_obj': 0.11090574,
           'box_loss': 0.13768514,
           'class_loss': 0.07543659,
           'conf_loss': 0.15396978,
           'precision50': 0.24984589,
           'recall50': 0.035321437},
     '4': {'avg_iou': 0.6368268,
           'avg_obj': 0.19688378,
           'box_loss': 0.1307082,
           'class_loss': 0.07538245,
           'conf_loss': 0.1541563,
           'precision50': 0.5073346,
           'recall50': 0.11463607},
     '5': {'avg_iou': 0.6733161,
           'avg_obj': 0.27620062,
           'box_loss': 0.12531583,
           'class_loss': 0.07210996,
           'conf_loss': 0.1253871,
           'precision50': 0.6291911,
           'recall50': 0.21949473},
     'global': {'total_loss': 1.0501512},
     'learning_rate': 0.009942464,
     'training_loss': 1.0501512}
I0517 22:53:13.654173 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-20000.
I0517 22:53:13.660441 140513721280320 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0517 22:53:14.420248 140513721280320 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0517 22:53:32.214507 140513721280320 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0517 23:00:12.477373 140513721280320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0517 23:04:20.343766 140513721280320 controller.py:261]  eval | step:  20000 | eval time:  666.7 sec | output: 
    {'3': {'avg_iou': 0.4196082,
           'avg_obj': 0.0988931,
           'box_loss': 0.010981031,
           'class_loss': 0.0047996943,
           'conf_loss': 0.012075444,
           'precision50': 0.22969607,
           'recall50': 0.0581165},
     '4': {'avg_iou': 0.60789406,
           'avg_obj': 0.2058782,
           'box_loss': 0.012347962,
           'class_loss': 0.005622674,
           'conf_loss': 0.012649009,
           'precision50': 0.45412567,
           'recall50': 0.15655936},
     '5': {'avg_iou': 0.71187466,
           'avg_obj': 0.30202323,
           'box_loss': 0.012517492,
           'class_loss': 0.00583517,
           'conf_loss': 0.0121289585,
           'precision50': 0.6018821,
           'recall50': 0.26456964},
     'AP': 0.20945336,
     'AP50': 0.38662916,
     'AP75': 0.20389695,
     'APl': 0.28572106,
     'APm': 0.19833612,
     'APs': 0.06242466,
     'ARl': 0.52074945,
     'ARm': 0.41744637,
     'ARmax1': 0.21405324,
     'ARmax10': 0.36864725,
     'ARmax100': 0.41381434,
     'ARs': 0.19218737,
     'global': {'total_loss': 0.08895741},
     'validation_loss': 0.08895741}
I0517 23:04:55.746670 140513721280320 controller.py:211] train | step:  20000 | training until step 40000...
I0518 00:49:11.550248 140513721280320 controller.py:425] train | step:  30000 | steps/sec:    1.4 | output: 
    {'3': {'avg_iou': 0.5816556,
           'avg_obj': 0.14230667,
           'box_loss': 0.1292326,
           'class_loss': 0.062440056,
           'conf_loss': 0.14769371,
           'precision50': 0.3276263,
           'recall50': 0.057792958},
     '4': {'avg_iou': 0.66761804,
           'avg_obj': 0.2414137,
           'box_loss': 0.11891555,
           'class_loss': 0.059958525,
           'conf_loss': 0.14684027,
           'precision50': 0.57984525,
           'recall50': 0.16977933},
     '5': {'avg_iou': 0.7062949,
           'avg_obj': 0.32754818,
           'box_loss': 0.1117322,
           'class_loss': 0.057134096,
           'conf_loss': 0.11900681,
           'precision50': 0.69018894,
           'recall50': 0.29810643},
     'global': {'total_loss': 0.95295507},
     'learning_rate': 0.0098709315,
     'training_loss': 0.95295507}

Total params: 57,800,704
Trainable params: 57,768,960
Non-trainable params: 31,744
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'5': (None, 20, 20, 2048 57800704  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  1033056   
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 85,486,272
Trainable params: 85,419,200
Non-trainable params: 67,072
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 640, 640, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 400, 8), 5: (8, 200, 8)}, inds: {3: (8, 600, 3), 4: (8, 400, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 80, 80, 3, 1), 4: (8, 40, 40, 3, 1), 5: (8, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 640, 640, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 80, 80, 3, 1), 4: (1, 40, 40, 3, 1), 5: (1, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
train | step:  10000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.45195577,
           'avg_obj': 0.07634275,
           'box_loss': 0.17395872,
           'class_loss': 0.38389185,
           'conf_loss': 1.3929124,
           'precision50': 0.08093184,
           'recall50': 0.025856497},
     '4': {'avg_iou': 0.5100498,
           'avg_obj': 0.12711959,
           'box_loss': 0.18086638,
           'class_loss': 0.4016315,
           'conf_loss': 0.47436678,
           'precision50': 0.23672727,
           'recall50': 0.04896092},
     '5': {'avg_iou': 0.52900076,
           'avg_obj': 0.17768967,
           'box_loss': 0.184331,
           'class_loss': 0.38268563,
           'conf_loss': 0.24958801,
           'precision50': 0.34578377,
           'recall50': 0.08785128},
     'global': {'total_loss': 3.8242333},
     'learning_rate': 0.009985589,
     'training_loss': 3.8242333}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-10000.
train | step:  20000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.55573654,
           'avg_obj': 0.11090574,
           'box_loss': 0.13768514,
           'class_loss': 0.07543659,
           'conf_loss': 0.15396978,
           'precision50': 0.24984589,
           'recall50': 0.035321437},
     '4': {'avg_iou': 0.6368268,
           'avg_obj': 0.19688378,
           'box_loss': 0.1307082,
           'class_loss': 0.07538245,
           'conf_loss': 0.1541563,
           'precision50': 0.5073346,
           'recall50': 0.11463607},
     '5': {'avg_iou': 0.6733161,
           'avg_obj': 0.27620062,
           'box_loss': 0.12531583,
           'class_loss': 0.07210996,
           'conf_loss': 0.1253871,
           'precision50': 0.6291911,
           'recall50': 0.21949473},
     'global': {'total_loss': 1.0501512},
     'learning_rate': 0.009942464,
     'training_loss': 1.0501512}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-20000.
 eval | step:  20000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=172.21s).
Accumulating evaluation results...
DONE (t=19.60s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.209
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.387
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.204
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.062
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.198
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.286
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.214
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.369
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.414
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.192
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.417
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.521
 eval | step:  20000 | eval time:  666.7 sec | output: 
    {'3': {'avg_iou': 0.4196082,
           'avg_obj': 0.0988931,
           'box_loss': 0.010981031,
           'class_loss': 0.0047996943,
           'conf_loss': 0.012075444,
           'precision50': 0.22969607,
           'recall50': 0.0581165},
     '4': {'avg_iou': 0.60789406,
           'avg_obj': 0.2058782,
           'box_loss': 0.012347962,
           'class_loss': 0.005622674,
           'conf_loss': 0.012649009,
           'precision50': 0.45412567,
           'recall50': 0.15655936},
     '5': {'avg_iou': 0.71187466,
           'avg_obj': 0.30202323,
           'box_loss': 0.012517492,
           'class_loss': 0.00583517,
           'conf_loss': 0.0121289585,
           'precision50': 0.6018821,
           'recall50': 0.26456964},
     'AP': 0.20945336,
     'AP50': 0.38662916,
     'AP75': 0.20389695,
     'APl': 0.28572106,
     'APm': 0.19833612,
     'APs': 0.06242466,
     'ARl': 0.52074945,
     'ARm': 0.41744637,
     'ARmax1': 0.21405324,
     'ARmax10': 0.36864725,
     'ARmax100': 0.41381434,
     'ARs': 0.19218737,
     'global': {'total_loss': 0.08895741},
     'validation_loss': 0.08895741}
train | step:  20000 | training until step 40000...
train | step:  30000 | steps/sec:    1.4 | output: 
    {'3': {'avg_iou': 0.5816556,
           'avg_obj': 0.14230667,
           'box_loss': 0.1292326,
           'class_loss': 0.062440056,
           'conf_loss': 0.14769371,
           'precision50': 0.3276263,
           'recall50': 0.057792958},
     '4': {'avg_iou': 0.66761804,
           'avg_obj': 0.2414137,
           'box_loss': 0.11891555,
           'class_loss': 0.059958525,
           'conf_loss': 0.14684027,
           'precision50': 0.57984525,
           'recall50': 0.16977933},
     '5': {'avg_iou': 0.7062949,
           'avg_obj': 0.32754818,
           'box_loss': 0.1117322,
           'class_loss': 0.057134096,
           'conf_loss': 0.11900681,
           'precision50': 0.69018894,
           'recall50': 0.29810643},
     'global': {'total_loss': 0.95295507},
     'learning_rate': 0.0098709315,
     'training_loss': 0.95295507}I0518 00:50:08.274874 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-30000.
I0518 02:29:06.053507 140513721280320 controller.py:425] train | step:  40000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5969326,
           'avg_obj': 0.16180617,
           'box_loss': 0.124441795,
           'class_loss': 0.055563495,
           'conf_loss': 0.14444228,
           'precision50': 0.36824912,
           'recall50': 0.07415527},
     '4': {'avg_iou': 0.684896,
           'avg_obj': 0.2682643,
           'box_loss': 0.11231936,
           'class_loss': 0.052023005,
           'conf_loss': 0.14277692,
           'precision50': 0.6122891,
           'recall50': 0.20485151},
     '5': {'avg_iou': 0.7237042,
           'avg_obj': 0.35698232,
           'box_loss': 0.104601346,
           'class_loss': 0.04973767,
           'conf_loss': 0.11511124,
           'precision50': 0.7163096,
           'recall50': 0.3414803},
     'global': {'total_loss': 0.9010175},
     'learning_rate': 0.00977151,
     'training_loss': 0.9010175}
I0518 02:30:02.555197 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-40000.
I0518 02:30:02.562038 140513721280320 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0518 02:34:35.598370 140513721280320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0518 02:38:38.590968 140513721280320 controller.py:261]  eval | step:  40000 | eval time:  516.0 sec | output: 
    {'3': {'avg_iou': 0.4379346,
           'avg_obj': 0.12833707,
           'box_loss': 0.010049739,
           'class_loss': 0.003690398,
           'conf_loss': 0.011485321,
           'precision50': 0.2871822,
           'recall50': 0.09040959},
     '4': {'avg_iou': 0.634328,
           'avg_obj': 0.2583931,
           'box_loss': 0.011006572,
           'class_loss': 0.004199013,
           'conf_loss': 0.011900167,
           'precision50': 0.52670723,
           'recall50': 0.2306481},
     '5': {'avg_iou': 0.7424468,
           'avg_obj': 0.3704175,
           'box_loss': 0.010968924,
           'class_loss': 0.0043705394,
           'conf_loss': 0.011217171,
           'precision50': 0.67941964,
           'recall50': 0.36205792},
     'AP': 0.28098983,
     'AP50': 0.4842509,
     'AP75': 0.2864425,
     'APl': 0.37900433,
     'APm': 0.2656598,
     'APs': 0.10190074,
     'ARl': 0.5918052,
     'ARm': 0.47946444,
     'ARmax1': 0.25621772,
     'ARmax10': 0.43103048,
     'ARmax100': 0.47765493,
     'ARs': 0.24580926,
     'global': {'total_loss': 0.07888782},
     'validation_loss': 0.07888782}
I0518 02:39:00.270421 140513721280320 controller.py:211] train | step:  40000 | training until step 60000...
I0518 04:15:31.552547 140513721280320 controller.py:425] train | step:  50000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.6071311,
           'avg_obj': 0.17598338,
           'box_loss': 0.12114903,
           'class_loss': 0.05129395,
           'conf_loss': 0.14168824,
           'precision50': 0.39321515,
           'recall50': 0.0862883},
     '4': {'avg_iou': 0.6960439,
           'avg_obj': 0.2863971,
           'box_loss': 0.10814544,
           'class_loss': 0.04732068,
           'conf_loss': 0.13983567,
           'precision50': 0.6303305,
           'recall50': 0.22878523},
     '5': {'avg_iou': 0.7348867,
           'avg_obj': 0.37676534,
           'box_loss': 0.100083366,
           'class_loss': 0.045132976,
           'conf_loss': 0.11252367,
           'precision50': 0.73172355,
           'recall50': 0.37072518},
     'global': {'total_loss': 0.86717296},
     'learning_rate': 0.0096449135,
     'training_loss': 0.86717296}
I0518 04:16:29.300952 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-50000.
I0518 05:54:51.821428 140513721280320 controller.py:425] train | step:  60000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6153529,
           'avg_obj': 0.18844411,
           'box_loss': 0.11845402,
           'class_loss': 0.047652915,
           'conf_loss': 0.13947378,
           'precision50': 0.41333604,
           'recall50': 0.09750966},
     '4': {'avg_iou': 0.70515454,
           'avg_obj': 0.3023261,
           'box_loss': 0.10464579,
           'class_loss': 0.04323248,
           'conf_loss': 0.13696842,
           'precision50': 0.64559054,
           'recall50': 0.24979885},
     '5': {'avg_iou': 0.74378186,
           'avg_obj': 0.3937716,
           'box_loss': 0.09651419,
           'class_loss': 0.041376047,
           'conf_loss': 0.10997495,
           'precision50': 0.74455506,
           'recall50': 0.3952887},
     'global': {'total_loss': 0.83829063},
     'learning_rate': 0.009492056,
     'training_loss': 0.83829063}
I0518 05:55:52.093750 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-60000.
I0518 05:55:52.099949 140513721280320 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0518 06:00:33.509772 140513721280320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0518 06:04:42.031092 140513721280320 controller.py:261]  eval | step:  60000 | eval time:  529.9 sec | output: 
    {'3': {'avg_iou': 0.4468548,
           'avg_obj': 0.14396353,
           'box_loss': 0.0095963795,
           'class_loss': 0.00328406,
           'conf_loss': 0.011237177,
           'precision50': 0.31530583,
           'recall50': 0.10977657},
     '4': {'avg_iou': 0.6451412,
           'avg_obj': 0.28430513,
           'box_loss': 0.010458624,
           'class_loss': 0.0036754275,
           'conf_loss': 0.011544063,
           'precision50': 0.5499485,
           'recall50': 0.26668155},
     '5': {'avg_iou': 0.7555464,
           'avg_obj': 0.4028289,
           'box_loss': 0.010305582,
           'class_loss': 0.003857652,
           'conf_loss': 0.010834224,
           'precision50': 0.7025121,
           'recall50': 0.40956607},
     'AP': 0.31485432,
     'AP50': 0.52544767,
     'AP75': 0.33013746,
     'APl': 0.42797023,
     'APm': 0.2949478,
     'APs': 0.12146276,
     'ARl': 0.62231743,
     'ARm': 0.5057801,
     'ARmax1': 0.2766608,
     'ARmax10': 0.45716894,
     'ARmax100': 0.5030189,
     'ARs': 0.27049142,
     'global': {'total_loss': 0.074793205},
     'validation_loss': 0.074793205}
I0518 06:05:05.674933 140513721280320 controller.py:211] train | step:  60000 | training until step 80000...
I0518 07:40:36.136258 140513721280320 controller.py:425] train | step:  70000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.62183684,
           'avg_obj': 0.19819595,
           'box_loss': 0.11638103,
           'class_loss': 0.04478196,
           'conf_loss': 0.13770752,
           'precision50': 0.42749068,
           'recall50': 0.10668265},
     '4': {'avg_iou': 0.7120995,
           'avg_obj': 0.3148406,
           'box_loss': 0.10196345,
           'class_loss': 0.04018676,
           'conf_loss': 0.13505453,
           'precision50': 0.65448934,
           'recall50': 0.2652605},
     '5': {'avg_iou': 0.7506936,
           'avg_obj': 0.40668315,
           'box_loss': 0.093707986,
           'class_loss': 0.03855778,
           'conf_loss': 0.10831277,
           'precision50': 0.7530781,
           'recall50': 0.4134813},
     'global': {'total_loss': 0.8166559},
     'learning_rate': 0.009314038,
     'training_loss': 0.8166559}

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-30000.
train | step:  40000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5969326,
           'avg_obj': 0.16180617,
           'box_loss': 0.124441795,
           'class_loss': 0.055563495,
           'conf_loss': 0.14444228,
           'precision50': 0.36824912,
           'recall50': 0.07415527},
     '4': {'avg_iou': 0.684896,
           'avg_obj': 0.2682643,
           'box_loss': 0.11231936,
           'class_loss': 0.052023005,
           'conf_loss': 0.14277692,
           'precision50': 0.6122891,
           'recall50': 0.20485151},
     '5': {'avg_iou': 0.7237042,
           'avg_obj': 0.35698232,
           'box_loss': 0.104601346,
           'class_loss': 0.04973767,
           'conf_loss': 0.11511124,
           'precision50': 0.7163096,
           'recall50': 0.3414803},
     'global': {'total_loss': 0.9010175},
     'learning_rate': 0.00977151,
     'training_loss': 0.9010175}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-40000.
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=170.92s).
Accumulating evaluation results...
DONE (t=17.44s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.281
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.484
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.286
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.102
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.266
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.379
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.256
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.431
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.478
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.246
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.479
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.592
 eval | step:  40000 | eval time:  516.0 sec | output: 
    {'3': {'avg_iou': 0.4379346,
           'avg_obj': 0.12833707,
           'box_loss': 0.010049739,
           'class_loss': 0.003690398,
           'conf_loss': 0.011485321,
           'precision50': 0.2871822,
           'recall50': 0.09040959},
     '4': {'avg_iou': 0.634328,
           'avg_obj': 0.2583931,
           'box_loss': 0.011006572,
           'class_loss': 0.004199013,
           'conf_loss': 0.011900167,
           'precision50': 0.52670723,
           'recall50': 0.2306481},
     '5': {'avg_iou': 0.7424468,
           'avg_obj': 0.3704175,
           'box_loss': 0.010968924,
           'class_loss': 0.0043705394,
           'conf_loss': 0.011217171,
           'precision50': 0.67941964,
           'recall50': 0.36205792},
     'AP': 0.28098983,
     'AP50': 0.4842509,
     'AP75': 0.2864425,
     'APl': 0.37900433,
     'APm': 0.2656598,
     'APs': 0.10190074,
     'ARl': 0.5918052,
     'ARm': 0.47946444,
     'ARmax1': 0.25621772,
     'ARmax10': 0.43103048,
     'ARmax100': 0.47765493,
     'ARs': 0.24580926,
     'global': {'total_loss': 0.07888782},
     'validation_loss': 0.07888782}
train | step:  40000 | training until step 60000...
train | step:  50000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.6071311,
           'avg_obj': 0.17598338,
           'box_loss': 0.12114903,
           'class_loss': 0.05129395,
           'conf_loss': 0.14168824,
           'precision50': 0.39321515,
           'recall50': 0.0862883},
     '4': {'avg_iou': 0.6960439,
           'avg_obj': 0.2863971,
           'box_loss': 0.10814544,
           'class_loss': 0.04732068,
           'conf_loss': 0.13983567,
           'precision50': 0.6303305,
           'recall50': 0.22878523},
     '5': {'avg_iou': 0.7348867,
           'avg_obj': 0.37676534,
           'box_loss': 0.100083366,
           'class_loss': 0.045132976,
           'conf_loss': 0.11252367,
           'precision50': 0.73172355,
           'recall50': 0.37072518},
     'global': {'total_loss': 0.86717296},
     'learning_rate': 0.0096449135,
     'training_loss': 0.86717296}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-50000.
train | step:  60000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6153529,
           'avg_obj': 0.18844411,
           'box_loss': 0.11845402,
           'class_loss': 0.047652915,
           'conf_loss': 0.13947378,
           'precision50': 0.41333604,
           'recall50': 0.09750966},
     '4': {'avg_iou': 0.70515454,
           'avg_obj': 0.3023261,
           'box_loss': 0.10464579,
           'class_loss': 0.04323248,
           'conf_loss': 0.13696842,
           'precision50': 0.64559054,
           'recall50': 0.24979885},
     '5': {'avg_iou': 0.74378186,
           'avg_obj': 0.3937716,
           'box_loss': 0.09651419,
           'class_loss': 0.041376047,
           'conf_loss': 0.10997495,
           'precision50': 0.74455506,
           'recall50': 0.3952887},
     'global': {'total_loss': 0.83829063},
     'learning_rate': 0.009492056,
     'training_loss': 0.83829063}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-60000.
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.13s).
Accumulating evaluation results...
DONE (t=17.24s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.315
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.525
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.330
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.121
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.295
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.428
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.277
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.457
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.503
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.270
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.506
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.622
 eval | step:  60000 | eval time:  529.9 sec | output: 
    {'3': {'avg_iou': 0.4468548,
           'avg_obj': 0.14396353,
           'box_loss': 0.0095963795,
           'class_loss': 0.00328406,
           'conf_loss': 0.011237177,
           'precision50': 0.31530583,
           'recall50': 0.10977657},
     '4': {'avg_iou': 0.6451412,
           'avg_obj': 0.28430513,
           'box_loss': 0.010458624,
           'class_loss': 0.0036754275,
           'conf_loss': 0.011544063,
           'precision50': 0.5499485,
           'recall50': 0.26668155},
     '5': {'avg_iou': 0.7555464,
           'avg_obj': 0.4028289,
           'box_loss': 0.010305582,
           'class_loss': 0.003857652,
           'conf_loss': 0.010834224,
           'precision50': 0.7025121,
           'recall50': 0.40956607},
     'AP': 0.31485432,
     'AP50': 0.52544767,
     'AP75': 0.33013746,
     'APl': 0.42797023,
     'APm': 0.2949478,
     'APs': 0.12146276,
     'ARl': 0.62231743,
     'ARm': 0.5057801,
     'ARmax1': 0.2766608,
     'ARmax10': 0.45716894,
     'ARmax100': 0.5030189,
     'ARs': 0.27049142,
     'global': {'total_loss': 0.074793205},
     'validation_loss': 0.074793205}
train | step:  60000 | training until step 80000...
train | step:  70000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.62183684,
           'avg_obj': 0.19819595,
           'box_loss': 0.11638103,
           'class_loss': 0.04478196,
           'conf_loss': 0.13770752,
           'precision50': 0.42749068,
           'recall50': 0.10668265},
     '4': {'avg_iou': 0.7120995,
           'avg_obj': 0.3148406,
           'box_loss': 0.10196345,
           'class_loss': 0.04018676,
           'conf_loss': 0.13505453,
           'precision50': 0.65448934,
           'recall50': 0.2652605},
     '5': {'avg_iou': 0.7506936,
           'avg_obj': 0.40668315,
           'box_loss': 0.093707986,
           'class_loss': 0.03855778,
           'conf_loss': 0.10831277,
           'precision50': 0.7530781,
           'recall50': 0.4134813},
     'global': {'total_loss': 0.8166559},
     'learning_rate': 0.009314038,
     'training_loss': 0.8166559}I0518 07:41:41.450847 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-70000.
I0518 09:17:45.146391 140513721280320 controller.py:425] train | step:  80000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.62750554,
           'avg_obj': 0.20682351,
           'box_loss': 0.1145563,
           'class_loss': 0.042393915,
           'conf_loss': 0.13594261,
           'precision50': 0.43929204,
           'recall50': 0.11448415},
     '4': {'avg_iou': 0.7178946,
           'avg_obj': 0.32557198,
           'box_loss': 0.099768125,
           'class_loss': 0.037714165,
           'conf_loss': 0.13289963,
           'precision50': 0.663311,
           'recall50': 0.27958685},
     '5': {'avg_iou': 0.75637186,
           'avg_obj': 0.4181433,
           'box_loss': 0.09141918,
           'class_loss': 0.03631315,
           'conf_loss': 0.106473036,
           'precision50': 0.7607862,
           'recall50': 0.4295655},
     'global': {'total_loss': 0.79748124},
     'learning_rate': 0.009112143,
     'training_loss': 0.79748124}
I0518 09:18:45.798395 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-80000.
I0518 09:18:45.805837 140513721280320 controller.py:252]  eval | step:  80000 | running 625 steps of evaluation...
I0518 09:23:27.642098 140513721280320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0518 09:27:50.019226 140513721280320 controller.py:261]  eval | step:  80000 | eval time:  544.2 sec | output: 
    {'3': {'avg_iou': 0.4521382,
           'avg_obj': 0.1535593,
           'box_loss': 0.009328242,
           'class_loss': 0.0030714304,
           'conf_loss': 0.011116668,
           'precision50': 0.32717618,
           'recall50': 0.12234017},
     '4': {'avg_iou': 0.65174395,
           'avg_obj': 0.30008072,
           'box_loss': 0.01012337,
           'class_loss': 0.0034462318,
           'conf_loss': 0.011426892,
           'precision50': 0.5594203,
           'recall50': 0.29082936},
     '5': {'avg_iou': 0.762511,
           'avg_obj': 0.42276898,
           'box_loss': 0.009953407,
           'class_loss': 0.0036403958,
           'conf_loss': 0.01065419,
           'precision50': 0.7141588,
           'recall50': 0.43813705},
     'AP': 0.33256045,
     'AP50': 0.54866964,
     'AP75': 0.34697613,
     'APl': 0.4501327,
     'APm': 0.31270885,
     'APs': 0.13207304,
     'ARl': 0.6341056,
     'ARm': 0.5183637,
     'ARmax1': 0.28504577,
     'ARmax10': 0.47001457,
     'ARmax100': 0.51727754,
     'ARs': 0.2856027,
     'global': {'total_loss': 0.07276081},
     'validation_loss': 0.07276081}
I0518 09:28:06.598277 140513721280320 controller.py:211] train | step:  80000 | training until step 100000...
I0518 11:01:24.756336 140513721280320 controller.py:425] train | step:  90000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.63182986,
           'avg_obj': 0.21470691,
           'box_loss': 0.11302346,
           'class_loss': 0.04043782,
           'conf_loss': 0.13421568,
           'precision50': 0.44984913,
           'recall50': 0.12214808},
     '4': {'avg_iou': 0.7226475,
           'avg_obj': 0.33526468,
           'box_loss': 0.09791173,
           'class_loss': 0.035642736,
           'conf_loss': 0.13101396,
           'precision50': 0.67051643,
           'recall50': 0.29216903},
     '5': {'avg_iou': 0.7609164,
           'avg_obj': 0.42779815,
           'box_loss': 0.08948636,
           'class_loss': 0.034472294,
           'conf_loss': 0.10488396,
           'precision50': 0.766497,
           'recall50': 0.44321644},
     'global': {'total_loss': 0.7810888},
     'learning_rate': 0.008887824,
     'training_loss': 0.7810888}
I0518 11:02:31.267603 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-90000.
I0518 12:34:07.922229 140513721280320 controller.py:425] train | step:  100000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.63582844,
           'avg_obj': 0.2214827,
           'box_loss': 0.11191703,
           'class_loss': 0.0387429,
           'conf_loss': 0.1332744,
           'precision50': 0.45964912,
           'recall50': 0.12872696},
     '4': {'avg_iou': 0.7270142,
           'avg_obj': 0.34387922,
           'box_loss': 0.09624479,
           'class_loss': 0.033906247,
           'conf_loss': 0.12975758,
           'precision50': 0.67674553,
           'recall50': 0.3033272},
     '5': {'avg_iou': 0.76517415,
           'avg_obj': 0.43730488,
           'box_loss': 0.087820515,
           'class_loss': 0.032783184,
           'conf_loss': 0.103604905,
           'precision50': 0.77297986,
           'recall50': 0.4560946},
     'global': {'total_loss': 0.7680525},
     'learning_rate': 0.008642699,
     'training_loss': 0.7680525}
I0518 12:35:07.071635 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-100000.
I0518 12:35:07.079408 140513721280320 controller.py:252]  eval | step:  100000 | running 625 steps of evaluation...
I0518 12:39:48.371556 140513721280320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0518 12:44:07.397541 140513721280320 controller.py:261]  eval | step:  100000 | eval time:  540.3 sec | output: 
    {'3': {'avg_iou': 0.4555376,
           'avg_obj': 0.16063157,
           'box_loss': 0.009157816,
           'class_loss': 0.0029550858,
           'conf_loss': 0.011077621,
           'precision50': 0.3382122,
           'recall50': 0.13310361},
     '4': {'avg_iou': 0.6560612,
           'avg_obj': 0.31221524,
           'box_loss': 0.009906088,
           'class_loss': 0.003305339,
           'conf_loss': 0.011345297,
           'precision50': 0.56727344,
           'recall50': 0.30801547},
     '5': {'avg_iou': 0.76692414,
           'avg_obj': 0.4363059,
           'box_loss': 0.009729979,
           'class_loss': 0.003541619,
           'conf_loss': 0.0105294995,
           'precision50': 0.72058034,
           'recall50': 0.45741323},
     'AP': 0.34508762,
     'AP50': 0.5630679,
     'AP75': 0.36429894,
     'APl': 0.46581963,
     'APm': 0.32608828,
     'APs': 0.13663156,
     'ARl': 0.6422466,
     'ARm': 0.5268511,
     'ARmax1': 0.2930992,
     'ARmax10': 0.4791782,
     'ARmax100': 0.52659816,
     'ARs': 0.29446393,
     'global': {'total_loss': 0.07154838},
     'validation_loss': 0.07154838}
I0518 12:44:25.590975 140513721280320 controller.py:211] train | step:  100000 | training until step 120000...
I0518 14:14:28.661419 140513721280320 controller.py:425] train | step:  110000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.63988864,
           'avg_obj': 0.22840762,
           'box_loss': 0.11053174,
           'class_loss': 0.037095983,
           'conf_loss': 0.13154621,
           'precision50': 0.46710137,
           'recall50': 0.13520338},
     '4': {'avg_iou': 0.73083836,
           'avg_obj': 0.35173488,
           'box_loss': 0.09482673,
           'class_loss': 0.03235391,
           'conf_loss': 0.1278065,
           'precision50': 0.68254983,
           'recall50': 0.3138886},
     '5': {'avg_iou': 0.76908916,
           'avg_obj': 0.4450468,
           'box_loss': 0.08623875,
           'class_loss': 0.031425346,
           'conf_loss': 0.10213256,
           'precision50': 0.77759916,
           'recall50': 0.46711063},
     'global': {'total_loss': 0.7539582},
     'learning_rate': 0.008378533,
     'training_loss': 0.7539582}

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-70000.
train | step:  80000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.62750554,
           'avg_obj': 0.20682351,
           'box_loss': 0.1145563,
           'class_loss': 0.042393915,
           'conf_loss': 0.13594261,
           'precision50': 0.43929204,
           'recall50': 0.11448415},
     '4': {'avg_iou': 0.7178946,
           'avg_obj': 0.32557198,
           'box_loss': 0.099768125,
           'class_loss': 0.037714165,
           'conf_loss': 0.13289963,
           'precision50': 0.663311,
           'recall50': 0.27958685},
     '5': {'avg_iou': 0.75637186,
           'avg_obj': 0.4181433,
           'box_loss': 0.09141918,
           'class_loss': 0.03631315,
           'conf_loss': 0.106473036,
           'precision50': 0.7607862,
           'recall50': 0.4295655},
     'global': {'total_loss': 0.79748124},
     'learning_rate': 0.009112143,
     'training_loss': 0.79748124}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-80000.
 eval | step:  80000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=187.27s).
Accumulating evaluation results...
DONE (t=19.49s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.333
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.549
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.347
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.132
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.313
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.450
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.285
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.470
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.517
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.286
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.518
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.634
 eval | step:  80000 | eval time:  544.2 sec | output: 
    {'3': {'avg_iou': 0.4521382,
           'avg_obj': 0.1535593,
           'box_loss': 0.009328242,
           'class_loss': 0.0030714304,
           'conf_loss': 0.011116668,
           'precision50': 0.32717618,
           'recall50': 0.12234017},
     '4': {'avg_iou': 0.65174395,
           'avg_obj': 0.30008072,
           'box_loss': 0.01012337,
           'class_loss': 0.0034462318,
           'conf_loss': 0.011426892,
           'precision50': 0.5594203,
           'recall50': 0.29082936},
     '5': {'avg_iou': 0.762511,
           'avg_obj': 0.42276898,
           'box_loss': 0.009953407,
           'class_loss': 0.0036403958,
           'conf_loss': 0.01065419,
           'precision50': 0.7141588,
           'recall50': 0.43813705},
     'AP': 0.33256045,
     'AP50': 0.54866964,
     'AP75': 0.34697613,
     'APl': 0.4501327,
     'APm': 0.31270885,
     'APs': 0.13207304,
     'ARl': 0.6341056,
     'ARm': 0.5183637,
     'ARmax1': 0.28504577,
     'ARmax10': 0.47001457,
     'ARmax100': 0.51727754,
     'ARs': 0.2856027,
     'global': {'total_loss': 0.07276081},
     'validation_loss': 0.07276081}
train | step:  80000 | training until step 100000...
train | step:  90000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.63182986,
           'avg_obj': 0.21470691,
           'box_loss': 0.11302346,
           'class_loss': 0.04043782,
           'conf_loss': 0.13421568,
           'precision50': 0.44984913,
           'recall50': 0.12214808},
     '4': {'avg_iou': 0.7226475,
           'avg_obj': 0.33526468,
           'box_loss': 0.09791173,
           'class_loss': 0.035642736,
           'conf_loss': 0.13101396,
           'precision50': 0.67051643,
           'recall50': 0.29216903},
     '5': {'avg_iou': 0.7609164,
           'avg_obj': 0.42779815,
           'box_loss': 0.08948636,
           'class_loss': 0.034472294,
           'conf_loss': 0.10488396,
           'precision50': 0.766497,
           'recall50': 0.44321644},
     'global': {'total_loss': 0.7810888},
     'learning_rate': 0.008887824,
     'training_loss': 0.7810888}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-90000.
train | step:  100000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.63582844,
           'avg_obj': 0.2214827,
           'box_loss': 0.11191703,
           'class_loss': 0.0387429,
           'conf_loss': 0.1332744,
           'precision50': 0.45964912,
           'recall50': 0.12872696},
     '4': {'avg_iou': 0.7270142,
           'avg_obj': 0.34387922,
           'box_loss': 0.09624479,
           'class_loss': 0.033906247,
           'conf_loss': 0.12975758,
           'precision50': 0.67674553,
           'recall50': 0.3033272},
     '5': {'avg_iou': 0.76517415,
           'avg_obj': 0.43730488,
           'box_loss': 0.087820515,
           'class_loss': 0.032783184,
           'conf_loss': 0.103604905,
           'precision50': 0.77297986,
           'recall50': 0.4560946},
     'global': {'total_loss': 0.7680525},
     'learning_rate': 0.008642699,
     'training_loss': 0.7680525}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-100000.
 eval | step:  100000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=184.87s).
Accumulating evaluation results...
DONE (t=17.01s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.345
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.563
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.364
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.137
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.326
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.466
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.293
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.479
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.527
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.294
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.527
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.642
 eval | step:  100000 | eval time:  540.3 sec | output: 
    {'3': {'avg_iou': 0.4555376,
           'avg_obj': 0.16063157,
           'box_loss': 0.009157816,
           'class_loss': 0.0029550858,
           'conf_loss': 0.011077621,
           'precision50': 0.3382122,
           'recall50': 0.13310361},
     '4': {'avg_iou': 0.6560612,
           'avg_obj': 0.31221524,
           'box_loss': 0.009906088,
           'class_loss': 0.003305339,
           'conf_loss': 0.011345297,
           'precision50': 0.56727344,
           'recall50': 0.30801547},
     '5': {'avg_iou': 0.76692414,
           'avg_obj': 0.4363059,
           'box_loss': 0.009729979,
           'class_loss': 0.003541619,
           'conf_loss': 0.0105294995,
           'precision50': 0.72058034,
           'recall50': 0.45741323},
     'AP': 0.34508762,
     'AP50': 0.5630679,
     'AP75': 0.36429894,
     'APl': 0.46581963,
     'APm': 0.32608828,
     'APs': 0.13663156,
     'ARl': 0.6422466,
     'ARm': 0.5268511,
     'ARmax1': 0.2930992,
     'ARmax10': 0.4791782,
     'ARmax100': 0.52659816,
     'ARs': 0.29446393,
     'global': {'total_loss': 0.07154838},
     'validation_loss': 0.07154838}
train | step:  100000 | training until step 120000...
train | step:  110000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.63988864,
           'avg_obj': 0.22840762,
           'box_loss': 0.11053174,
           'class_loss': 0.037095983,
           'conf_loss': 0.13154621,
           'precision50': 0.46710137,
           'recall50': 0.13520338},
     '4': {'avg_iou': 0.73083836,
           'avg_obj': 0.35173488,
           'box_loss': 0.09482673,
           'class_loss': 0.03235391,
           'conf_loss': 0.1278065,
           'precision50': 0.68254983,
           'recall50': 0.3138886},
     '5': {'avg_iou': 0.76908916,
           'avg_obj': 0.4450468,
           'box_loss': 0.08623875,
           'class_loss': 0.031425346,
           'conf_loss': 0.10213256,
           'precision50': 0.77759916,
           'recall50': 0.46711063},
     'global': {'total_loss': 0.7539582},
     'learning_rate': 0.008378533,
     'training_loss': 0.7539582}I0518 14:15:28.176576 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-110000.
I0518 15:46:48.183563 140513721280320 controller.py:425] train | step:  120000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.64292794,
           'avg_obj': 0.23438132,
           'box_loss': 0.109440945,
           'class_loss': 0.035698626,
           'conf_loss': 0.13043891,
           'precision50': 0.4746682,
           'recall50': 0.14138126},
     '4': {'avg_iou': 0.73438746,
           'avg_obj': 0.3593699,
           'box_loss': 0.09342325,
           'class_loss': 0.030902505,
           'conf_loss': 0.1265659,
           'precision50': 0.68764484,
           'recall50': 0.32391527},
     '5': {'avg_iou': 0.7723206,
           'avg_obj': 0.45231035,
           'box_loss': 0.08492939,
           'class_loss': 0.030154426,
           'conf_loss': 0.10109043,
           'precision50': 0.78140295,
           'recall50': 0.47668195},
     'global': {'total_loss': 0.74264604},
     'learning_rate': 0.008097229,
     'training_loss': 0.74264604}
I0518 15:47:46.639648 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-120000.
I0518 15:47:46.647004 140513721280320 controller.py:252]  eval | step:  120000 | running 625 steps of evaluation...
I0518 15:52:29.525986 140513721280320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0518 15:56:47.780673 140513721280320 controller.py:261]  eval | step:  120000 | eval time:  541.1 sec | output: 
    {'3': {'avg_iou': 0.45783472,
           'avg_obj': 0.16577384,
           'box_loss': 0.009044257,
           'class_loss': 0.002937513,
           'conf_loss': 0.011108676,
           'precision50': 0.34102374,
           'recall50': 0.14043792},
     '4': {'avg_iou': 0.6583353,
           'avg_obj': 0.3202852,
           'box_loss': 0.009788984,
           'class_loss': 0.0032737798,
           'conf_loss': 0.011353027,
           'precision50': 0.5741557,
           'recall50': 0.3203192},
     '5': {'avg_iou': 0.7697434,
           'avg_obj': 0.44717407,
           'box_loss': 0.009587693,
           'class_loss': 0.003519635,
           'conf_loss': 0.01054306,
           'precision50': 0.72346085,
           'recall50': 0.47309428},
     'AP': 0.3523156,
     'AP50': 0.56971306,
     'AP75': 0.37083563,
     'APl': 0.46962625,
     'APm': 0.33445632,
     'APs': 0.14051925,
     'ARl': 0.645611,
     'ARm': 0.5282524,
     'ARmax1': 0.2957822,
     'ARmax10': 0.4848361,
     'ARmax100': 0.5292997,
     'ARs': 0.29613486,
     'global': {'total_loss': 0.071156606},
     'validation_loss': 0.071156606}
I0518 15:57:10.490836 140513721280320 controller.py:211] train | step:  120000 | training until step 140000...
I0518 17:24:31.693619 140513721280320 controller.py:425] train | step:  130000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6459718,
           'avg_obj': 0.24050896,
           'box_loss': 0.10862967,
           'class_loss': 0.034560565,
           'conf_loss': 0.12919669,
           'precision50': 0.48265883,
           'recall50': 0.14752829},
     '4': {'avg_iou': 0.7376984,
           'avg_obj': 0.36691925,
           'box_loss': 0.09219895,
           'class_loss': 0.029855182,
           'conf_loss': 0.12520288,
           'precision50': 0.69351256,
           'recall50': 0.3333753},
     '5': {'avg_iou': 0.7754269,
           'avg_obj': 0.45958102,
           'box_loss': 0.08365478,
           'class_loss': 0.029148772,
           'conf_loss': 0.100013345,
           'precision50': 0.78578305,
           'recall50': 0.4864397},
     'global': {'total_loss': 0.73246175},
     'learning_rate': 0.007800815,
     'training_loss': 0.73246175}
I0518 17:25:34.344792 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-130000.
I0518 18:58:02.518043 140513721280320 controller.py:425] train | step:  140000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6486256,
           'avg_obj': 0.24594997,
           'box_loss': 0.10746538,
           'class_loss': 0.03347737,
           'conf_loss': 0.12787417,
           'precision50': 0.4885503,
           'recall50': 0.15310343},
     '4': {'avg_iou': 0.74064577,
           'avg_obj': 0.3734363,
           'box_loss': 0.09100481,
           'class_loss': 0.028777441,
           'conf_loss': 0.12389603,
           'precision50': 0.69677615,
           'recall50': 0.34169945},
     '5': {'avg_iou': 0.77821434,
           'avg_obj': 0.465631,
           'box_loss': 0.08246023,
           'class_loss': 0.028179526,
           'conf_loss': 0.09893919,
           'precision50': 0.788655,
           'recall50': 0.4945222},
     'global': {'total_loss': 0.7220742},
     'learning_rate': 0.007491425,
     'training_loss': 0.7220742}
I0518 18:59:03.637521 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-140000.
I0518 18:59:03.644331 140513721280320 controller.py:252]  eval | step:  140000 | running 625 steps of evaluation...
I0518 19:03:47.178588 140513721280320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0518 19:07:52.242878 140513721280320 controller.py:261]  eval | step:  140000 | eval time:  528.6 sec | output: 
    {'3': {'avg_iou': 0.45910123,
           'avg_obj': 0.169166,
           'box_loss': 0.008978615,
           'class_loss': 0.0029644158,
           'conf_loss': 0.011180095,
           'precision50': 0.34532577,
           'recall50': 0.14662759},
     '4': {'avg_iou': 0.6602304,
           'avg_obj': 0.326607,
           'box_loss': 0.0096935015,
           'class_loss': 0.0033091377,
           'conf_loss': 0.011447491,
           'precision50': 0.57542145,
           'recall50': 0.32990125},
     '5': {'avg_iou': 0.7715362,
           'avg_obj': 0.45437217,
           'box_loss': 0.009497678,
           'class_loss': 0.0035004334,
           'conf_loss': 0.010589229,
           'precision50': 0.7238924,
           'recall50': 0.4827987},
     'AP': 0.35631052,
     'AP50': 0.5726322,
     'AP75': 0.37514585,
     'APl': 0.4759324,
     'APm': 0.33943596,
     'APs': 0.14151256,
     'ARl': 0.6488948,
     'ARm': 0.5313131,
     'ARmax1': 0.29958403,
     'ARmax10': 0.4865564,
     'ARmax100': 0.5325057,
     'ARs': 0.3088198,
     'global': {'total_loss': 0.07116059},
     'validation_loss': 0.07116059}
I0518 19:08:08.916321 140513721280320 controller.py:211] train | step:  140000 | training until step 160000...
I0518 20:33:12.805822 140513721280320 controller.py:425] train | step:  150000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6512913,
           'avg_obj': 0.25187927,
           'box_loss': 0.10677709,
           'class_loss': 0.032442305,
           'conf_loss': 0.12700894,
           'precision50': 0.49530938,
           'recall50': 0.15898082},
     '4': {'avg_iou': 0.74330366,
           'avg_obj': 0.3801645,
           'box_loss': 0.09007324,
           'class_loss': 0.027868534,
           'conf_loss': 0.1227005,
           'precision50': 0.70247483,
           'recall50': 0.35111818},
     '5': {'avg_iou': 0.78099436,
           'avg_obj': 0.47231078,
           'box_loss': 0.08141694,
           'class_loss': 0.027308505,
           'conf_loss': 0.09791143,
           'precision50': 0.79260033,
           'recall50': 0.5034205},
     'global': {'total_loss': 0.7135061},
     'learning_rate': 0.007171291,
     'training_loss': 0.7135061}

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-110000.
train | step:  120000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.64292794,
           'avg_obj': 0.23438132,
           'box_loss': 0.109440945,
           'class_loss': 0.035698626,
           'conf_loss': 0.13043891,
           'precision50': 0.4746682,
           'recall50': 0.14138126},
     '4': {'avg_iou': 0.73438746,
           'avg_obj': 0.3593699,
           'box_loss': 0.09342325,
           'class_loss': 0.030902505,
           'conf_loss': 0.1265659,
           'precision50': 0.68764484,
           'recall50': 0.32391527},
     '5': {'avg_iou': 0.7723206,
           'avg_obj': 0.45231035,
           'box_loss': 0.08492939,
           'class_loss': 0.030154426,
           'conf_loss': 0.10109043,
           'precision50': 0.78140295,
           'recall50': 0.47668195},
     'global': {'total_loss': 0.74264604},
     'learning_rate': 0.008097229,
     'training_loss': 0.74264604}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-120000.
 eval | step:  120000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=184.68s).
Accumulating evaluation results...
DONE (t=15.70s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.352
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.570
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.371
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.141
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.334
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.470
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.296
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.529
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.296
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.528
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.646
 eval | step:  120000 | eval time:  541.1 sec | output: 
    {'3': {'avg_iou': 0.45783472,
           'avg_obj': 0.16577384,
           'box_loss': 0.009044257,
           'class_loss': 0.002937513,
           'conf_loss': 0.011108676,
           'precision50': 0.34102374,
           'recall50': 0.14043792},
     '4': {'avg_iou': 0.6583353,
           'avg_obj': 0.3202852,
           'box_loss': 0.009788984,
           'class_loss': 0.0032737798,
           'conf_loss': 0.011353027,
           'precision50': 0.5741557,
           'recall50': 0.3203192},
     '5': {'avg_iou': 0.7697434,
           'avg_obj': 0.44717407,
           'box_loss': 0.009587693,
           'class_loss': 0.003519635,
           'conf_loss': 0.01054306,
           'precision50': 0.72346085,
           'recall50': 0.47309428},
     'AP': 0.3523156,
     'AP50': 0.56971306,
     'AP75': 0.37083563,
     'APl': 0.46962625,
     'APm': 0.33445632,
     'APs': 0.14051925,
     'ARl': 0.645611,
     'ARm': 0.5282524,
     'ARmax1': 0.2957822,
     'ARmax10': 0.4848361,
     'ARmax100': 0.5292997,
     'ARs': 0.29613486,
     'global': {'total_loss': 0.071156606},
     'validation_loss': 0.071156606}
train | step:  120000 | training until step 140000...
train | step:  130000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6459718,
           'avg_obj': 0.24050896,
           'box_loss': 0.10862967,
           'class_loss': 0.034560565,
           'conf_loss': 0.12919669,
           'precision50': 0.48265883,
           'recall50': 0.14752829},
     '4': {'avg_iou': 0.7376984,
           'avg_obj': 0.36691925,
           'box_loss': 0.09219895,
           'class_loss': 0.029855182,
           'conf_loss': 0.12520288,
           'precision50': 0.69351256,
           'recall50': 0.3333753},
     '5': {'avg_iou': 0.7754269,
           'avg_obj': 0.45958102,
           'box_loss': 0.08365478,
           'class_loss': 0.029148772,
           'conf_loss': 0.100013345,
           'precision50': 0.78578305,
           'recall50': 0.4864397},
     'global': {'total_loss': 0.73246175},
     'learning_rate': 0.007800815,
     'training_loss': 0.73246175}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-130000.
train | step:  140000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6486256,
           'avg_obj': 0.24594997,
           'box_loss': 0.10746538,
           'class_loss': 0.03347737,
           'conf_loss': 0.12787417,
           'precision50': 0.4885503,
           'recall50': 0.15310343},
     '4': {'avg_iou': 0.74064577,
           'avg_obj': 0.3734363,
           'box_loss': 0.09100481,
           'class_loss': 0.028777441,
           'conf_loss': 0.12389603,
           'precision50': 0.69677615,
           'recall50': 0.34169945},
     '5': {'avg_iou': 0.77821434,
           'avg_obj': 0.465631,
           'box_loss': 0.08246023,
           'class_loss': 0.028179526,
           'conf_loss': 0.09893919,
           'precision50': 0.788655,
           'recall50': 0.4945222},
     'global': {'total_loss': 0.7220742},
     'learning_rate': 0.007491425,
     'training_loss': 0.7220742}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-140000.
 eval | step:  140000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=175.43s).
Accumulating evaluation results...
DONE (t=15.54s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.356
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.573
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.375
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.142
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.339
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.476
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.300
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.487
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.533
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.309
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.531
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.649
 eval | step:  140000 | eval time:  528.6 sec | output: 
    {'3': {'avg_iou': 0.45910123,
           'avg_obj': 0.169166,
           'box_loss': 0.008978615,
           'class_loss': 0.0029644158,
           'conf_loss': 0.011180095,
           'precision50': 0.34532577,
           'recall50': 0.14662759},
     '4': {'avg_iou': 0.6602304,
           'avg_obj': 0.326607,
           'box_loss': 0.0096935015,
           'class_loss': 0.0033091377,
           'conf_loss': 0.011447491,
           'precision50': 0.57542145,
           'recall50': 0.32990125},
     '5': {'avg_iou': 0.7715362,
           'avg_obj': 0.45437217,
           'box_loss': 0.009497678,
           'class_loss': 0.0035004334,
           'conf_loss': 0.010589229,
           'precision50': 0.7238924,
           'recall50': 0.4827987},
     'AP': 0.35631052,
     'AP50': 0.5726322,
     'AP75': 0.37514585,
     'APl': 0.4759324,
     'APm': 0.33943596,
     'APs': 0.14151256,
     'ARl': 0.6488948,
     'ARm': 0.5313131,
     'ARmax1': 0.29958403,
     'ARmax10': 0.4865564,
     'ARmax100': 0.5325057,
     'ARs': 0.3088198,
     'global': {'total_loss': 0.07116059},
     'validation_loss': 0.07116059}
train | step:  140000 | training until step 160000...
train | step:  150000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6512913,
           'avg_obj': 0.25187927,
           'box_loss': 0.10677709,
           'class_loss': 0.032442305,
           'conf_loss': 0.12700894,
           'precision50': 0.49530938,
           'recall50': 0.15898082},
     '4': {'avg_iou': 0.74330366,
           'avg_obj': 0.3801645,
           'box_loss': 0.09007324,
           'class_loss': 0.027868534,
           'conf_loss': 0.1227005,
           'precision50': 0.70247483,
           'recall50': 0.35111818},
     '5': {'avg_iou': 0.78099436,
           'avg_obj': 0.47231078,
           'box_loss': 0.08141694,
           'class_loss': 0.027308505,
           'conf_loss': 0.09791143,
           'precision50': 0.79260033,
           'recall50': 0.5034205},
     'global': {'total_loss': 0.7135061},
     'learning_rate': 0.007171291,
     'training_loss': 0.7135061}I0518 20:34:12.165412 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-150000.
I0518 22:04:28.103980 140513721280320 controller.py:425] train | step:  160000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.65347624,
           'avg_obj': 0.25699607,
           'box_loss': 0.1060921,
           'class_loss': 0.031578403,
           'conf_loss': 0.12591656,
           'precision50': 0.5028637,
           'recall50': 0.16497697},
     '4': {'avg_iou': 0.745951,
           'avg_obj': 0.38614812,
           'box_loss': 0.08901804,
           'class_loss': 0.027017938,
           'conf_loss': 0.12159574,
           'precision50': 0.70591015,
           'recall50': 0.35865816},
     '5': {'avg_iou': 0.7834526,
           'avg_obj': 0.4778814,
           'box_loss': 0.080382325,
           'class_loss': 0.026477143,
           'conf_loss': 0.097045176,
           'precision50': 0.7956572,
           'recall50': 0.5107761},
     'global': {'total_loss': 0.70512277},
     'learning_rate': 0.0068427175,
     'training_loss': 0.70512277}
I0518 22:05:27.150523 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-160000.
I0518 22:05:27.161133 140513721280320 controller.py:252]  eval | step:  160000 | running 625 steps of evaluation...
I0518 22:10:04.049504 140513721280320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0518 22:14:09.923025 140513721280320 controller.py:261]  eval | step:  160000 | eval time:  522.8 sec | output: 
    {'3': {'avg_iou': 0.460206,
           'avg_obj': 0.17206557,
           'box_loss': 0.008928139,
           'class_loss': 0.00302131,
           'conf_loss': 0.011266472,
           'precision50': 0.35076255,
           'recall50': 0.15329124},
     '4': {'avg_iou': 0.66115314,
           'avg_obj': 0.3306333,
           'box_loss': 0.009646872,
           'class_loss': 0.0033834542,
           'conf_loss': 0.011552582,
           'precision50': 0.5742337,
           'recall50': 0.33675465},
     '5': {'avg_iou': 0.7725489,
           'avg_obj': 0.45907828,
           'box_loss': 0.009445951,
           'class_loss': 0.003565392,
           'conf_loss': 0.0105412835,
           'precision50': 0.7228579,
           'recall50': 0.48911962},
     'AP': 0.35970417,
     'AP50': 0.57477343,
     'AP75': 0.3814047,
     'APl': 0.48220658,
     'APm': 0.34209588,
     'APs': 0.1455335,
     'ARl': 0.65081835,
     'ARm': 0.52989537,
     'ARmax1': 0.30201,
     'ARmax10': 0.4881401,
     'ARmax100': 0.5334748,
     'ARs': 0.30890816,
     'global': {'total_loss': 0.07135142},
     'validation_loss': 0.07135142}
I0518 22:14:28.074651 140513721280320 controller.py:211] train | step:  160000 | training until step 180000...
I0518 23:38:42.784001 140513721280320 controller.py:425] train | step:  170000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6558199,
           'avg_obj': 0.26245278,
           'box_loss': 0.10531677,
           'class_loss': 0.030726496,
           'conf_loss': 0.12470142,
           'precision50': 0.5075905,
           'recall50': 0.17078623},
     '4': {'avg_iou': 0.7482787,
           'avg_obj': 0.39249966,
           'box_loss': 0.08809041,
           'class_loss': 0.026123172,
           'conf_loss': 0.120120876,
           'precision50': 0.7098016,
           'recall50': 0.36708084},
     '5': {'avg_iou': 0.7858635,
           'avg_obj': 0.4835547,
           'box_loss': 0.07939862,
           'class_loss': 0.02568364,
           'conf_loss': 0.09593843,
           'precision50': 0.79799455,
           'recall50': 0.51797},
     'global': {'total_loss': 0.6961002},
     'learning_rate': 0.0065080714,
     'training_loss': 0.6961002}
I0518 23:39:41.153512 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-170000.
I0519 01:10:19.878829 140513721280320 controller.py:425] train | step:  180000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6578973,
           'avg_obj': 0.2672159,
           'box_loss': 0.104431,
           'class_loss': 0.029852234,
           'conf_loss': 0.123619385,
           'precision50': 0.511085,
           'recall50': 0.17483377},
     '4': {'avg_iou': 0.75080854,
           'avg_obj': 0.39823404,
           'box_loss': 0.08710547,
           'class_loss': 0.02537145,
           'conf_loss': 0.11911493,
           'precision50': 0.7128071,
           'recall50': 0.37394342},
     '5': {'avg_iou': 0.78797626,
           'avg_obj': 0.48922285,
           'box_loss': 0.07850741,
           'class_loss': 0.025047194,
           'conf_loss': 0.09504956,
           'precision50': 0.80133086,
           'recall50': 0.52534837},
     'global': {'total_loss': 0.68809783},
     'learning_rate': 0.0061697643,
     'training_loss': 0.68809783}
I0519 01:11:24.318283 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-180000.
I0519 01:11:24.324089 140513721280320 controller.py:252]  eval | step:  180000 | running 625 steps of evaluation...
I0519 01:16:06.093590 140513721280320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0519 01:20:16.049026 140513721280320 controller.py:261]  eval | step:  180000 | eval time:  531.7 sec | output: 
    {'3': {'avg_iou': 0.46026015,
           'avg_obj': 0.1738422,
           'box_loss': 0.008922951,
           'class_loss': 0.0030819103,
           'conf_loss': 0.011408627,
           'precision50': 0.35187036,
           'recall50': 0.15723063},
     '4': {'avg_iou': 0.6615748,
           'avg_obj': 0.33364603,
           'box_loss': 0.009626481,
           'class_loss': 0.0034611207,
           'conf_loss': 0.011741086,
           'precision50': 0.57439,
           'recall50': 0.3429689},
     '5': {'avg_iou': 0.77344435,
           'avg_obj': 0.46387422,
           'box_loss': 0.009401241,
           'class_loss': 0.0035937543,
           'conf_loss': 0.010703228,
           'precision50': 0.7228651,
           'recall50': 0.49609268},
     'AP': 0.35930803,
     'AP50': 0.5733308,
     'AP75': 0.38244075,
     'APl': 0.4840619,
     'APm': 0.3397179,
     'APs': 0.14505683,
     'ARl': 0.65093,
     'ARm': 0.525484,
     'ARmax1': 0.30015144,
     'ARmax10': 0.4868259,
     'ARmax100': 0.530712,
     'ARs': 0.3040108,
     'global': {'total_loss': 0.07194041},
     'validation_loss': 0.07194041}
I0519 01:20:38.845127 140513721280320 controller.py:211] train | step:  180000 | training until step 200000...
I0519 02:44:54.755401 140513721280320 controller.py:425] train | step:  190000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6599194,
           'avg_obj': 0.2723621,
           'box_loss': 0.10398988,
           'class_loss': 0.029207751,
           'conf_loss': 0.122704275,
           'precision50': 0.5184484,
           'recall50': 0.18101609},
     '4': {'avg_iou': 0.7531717,
           'avg_obj': 0.40426412,
           'box_loss': 0.08625133,
           'class_loss': 0.024716273,
           'conf_loss': 0.11803496,
           'precision50': 0.7175994,
           'recall50': 0.38228783},
     '5': {'avg_iou': 0.79024965,
           'avg_obj': 0.49490234,
           'box_loss': 0.07763062,
           'class_loss': 0.024411302,
           'conf_loss': 0.09412485,
           'precision50': 0.80513054,
           'recall50': 0.5331501},
     'global': {'total_loss': 0.68107307},
     'learning_rate': 0.0058302353,
     'training_loss': 0.68107307}

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-150000.
train | step:  160000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.65347624,
           'avg_obj': 0.25699607,
           'box_loss': 0.1060921,
           'class_loss': 0.031578403,
           'conf_loss': 0.12591656,
           'precision50': 0.5028637,
           'recall50': 0.16497697},
     '4': {'avg_iou': 0.745951,
           'avg_obj': 0.38614812,
           'box_loss': 0.08901804,
           'class_loss': 0.027017938,
           'conf_loss': 0.12159574,
           'precision50': 0.70591015,
           'recall50': 0.35865816},
     '5': {'avg_iou': 0.7834526,
           'avg_obj': 0.4778814,
           'box_loss': 0.080382325,
           'class_loss': 0.026477143,
           'conf_loss': 0.097045176,
           'precision50': 0.7956572,
           'recall50': 0.5107761},
     'global': {'total_loss': 0.70512277},
     'learning_rate': 0.0068427175,
     'training_loss': 0.70512277}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-160000.
 eval | step:  160000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=178.68s).
Accumulating evaluation results...
DONE (t=14.31s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.360
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.575
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.381
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.146
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.342
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.482
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.302
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.488
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.533
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.309
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.530
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.651
 eval | step:  160000 | eval time:  522.8 sec | output: 
    {'3': {'avg_iou': 0.460206,
           'avg_obj': 0.17206557,
           'box_loss': 0.008928139,
           'class_loss': 0.00302131,
           'conf_loss': 0.011266472,
           'precision50': 0.35076255,
           'recall50': 0.15329124},
     '4': {'avg_iou': 0.66115314,
           'avg_obj': 0.3306333,
           'box_loss': 0.009646872,
           'class_loss': 0.0033834542,
           'conf_loss': 0.011552582,
           'precision50': 0.5742337,
           'recall50': 0.33675465},
     '5': {'avg_iou': 0.7725489,
           'avg_obj': 0.45907828,
           'box_loss': 0.009445951,
           'class_loss': 0.003565392,
           'conf_loss': 0.0105412835,
           'precision50': 0.7228579,
           'recall50': 0.48911962},
     'AP': 0.35970417,
     'AP50': 0.57477343,
     'AP75': 0.3814047,
     'APl': 0.48220658,
     'APm': 0.34209588,
     'APs': 0.1455335,
     'ARl': 0.65081835,
     'ARm': 0.52989537,
     'ARmax1': 0.30201,
     'ARmax10': 0.4881401,
     'ARmax100': 0.5334748,
     'ARs': 0.30890816,
     'global': {'total_loss': 0.07135142},
     'validation_loss': 0.07135142}
train | step:  160000 | training until step 180000...
train | step:  170000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6558199,
           'avg_obj': 0.26245278,
           'box_loss': 0.10531677,
           'class_loss': 0.030726496,
           'conf_loss': 0.12470142,
           'precision50': 0.5075905,
           'recall50': 0.17078623},
     '4': {'avg_iou': 0.7482787,
           'avg_obj': 0.39249966,
           'box_loss': 0.08809041,
           'class_loss': 0.026123172,
           'conf_loss': 0.120120876,
           'precision50': 0.7098016,
           'recall50': 0.36708084},
     '5': {'avg_iou': 0.7858635,
           'avg_obj': 0.4835547,
           'box_loss': 0.07939862,
           'class_loss': 0.02568364,
           'conf_loss': 0.09593843,
           'precision50': 0.79799455,
           'recall50': 0.51797},
     'global': {'total_loss': 0.6961002},
     'learning_rate': 0.0065080714,
     'training_loss': 0.6961002}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-170000.
train | step:  180000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6578973,
           'avg_obj': 0.2672159,
           'box_loss': 0.104431,
           'class_loss': 0.029852234,
           'conf_loss': 0.123619385,
           'precision50': 0.511085,
           'recall50': 0.17483377},
     '4': {'avg_iou': 0.75080854,
           'avg_obj': 0.39823404,
           'box_loss': 0.08710547,
           'class_loss': 0.02537145,
           'conf_loss': 0.11911493,
           'precision50': 0.7128071,
           'recall50': 0.37394342},
     '5': {'avg_iou': 0.78797626,
           'avg_obj': 0.48922285,
           'box_loss': 0.07850741,
           'class_loss': 0.025047194,
           'conf_loss': 0.09504956,
           'precision50': 0.80133086,
           'recall50': 0.52534837},
     'global': {'total_loss': 0.68809783},
     'learning_rate': 0.0061697643,
     'training_loss': 0.68809783}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-180000.
 eval | step:  180000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=180.29s).
Accumulating evaluation results...
DONE (t=14.67s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.359
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.573
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.382
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.145
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.340
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.484
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.300
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.487
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.531
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.304
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.525
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.651
 eval | step:  180000 | eval time:  531.7 sec | output: 
    {'3': {'avg_iou': 0.46026015,
           'avg_obj': 0.1738422,
           'box_loss': 0.008922951,
           'class_loss': 0.0030819103,
           'conf_loss': 0.011408627,
           'precision50': 0.35187036,
           'recall50': 0.15723063},
     '4': {'avg_iou': 0.6615748,
           'avg_obj': 0.33364603,
           'box_loss': 0.009626481,
           'class_loss': 0.0034611207,
           'conf_loss': 0.011741086,
           'precision50': 0.57439,
           'recall50': 0.3429689},
     '5': {'avg_iou': 0.77344435,
           'avg_obj': 0.46387422,
           'box_loss': 0.009401241,
           'class_loss': 0.0035937543,
           'conf_loss': 0.010703228,
           'precision50': 0.7228651,
           'recall50': 0.49609268},
     'AP': 0.35930803,
     'AP50': 0.5733308,
     'AP75': 0.38244075,
     'APl': 0.4840619,
     'APm': 0.3397179,
     'APs': 0.14505683,
     'ARl': 0.65093,
     'ARm': 0.525484,
     'ARmax1': 0.30015144,
     'ARmax10': 0.4868259,
     'ARmax100': 0.530712,
     'ARs': 0.3040108,
     'global': {'total_loss': 0.07194041},
     'validation_loss': 0.07194041}
train | step:  180000 | training until step 200000...
train | step:  190000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6599194,
           'avg_obj': 0.2723621,
           'box_loss': 0.10398988,
           'class_loss': 0.029207751,
           'conf_loss': 0.122704275,
           'precision50': 0.5184484,
           'recall50': 0.18101609},
     '4': {'avg_iou': 0.7531717,
           'avg_obj': 0.40426412,
           'box_loss': 0.08625133,
           'class_loss': 0.024716273,
           'conf_loss': 0.11803496,
           'precision50': 0.7175994,
           'recall50': 0.38228783},
     '5': {'avg_iou': 0.79024965,
           'avg_obj': 0.49490234,
           'box_loss': 0.07763062,
           'class_loss': 0.024411302,
           'conf_loss': 0.09412485,
           'precision50': 0.80513054,
           'recall50': 0.5331501},
     'global': {'total_loss': 0.68107307},
     'learning_rate': 0.0058302353,
     'training_loss': 0.68107307}I0519 02:45:54.233843 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-190000.
I0519 04:16:57.943297 140513721280320 controller.py:425] train | step:  200000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.66195387,
           'avg_obj': 0.27717993,
           'box_loss': 0.103243075,
           'class_loss': 0.028440317,
           'conf_loss': 0.12163771,
           'precision50': 0.5231979,
           'recall50': 0.18634447},
     '4': {'avg_iou': 0.7551459,
           'avg_obj': 0.40991518,
           'box_loss': 0.085470684,
           'class_loss': 0.024065005,
           'conf_loss': 0.11693545,
           'precision50': 0.7201598,
           'recall50': 0.38957444},
     '5': {'avg_iou': 0.79217005,
           'avg_obj': 0.50004226,
           'box_loss': 0.07678105,
           'class_loss': 0.023805564,
           'conf_loss': 0.09335846,
           'precision50': 0.80684036,
           'recall50': 0.539184},
     'global': {'total_loss': 0.67373604},
     'learning_rate': 0.005491929,
     'training_loss': 0.67373604}
I0519 04:17:57.046997 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-200000.
I0519 04:17:57.052968 140513721280320 controller.py:252]  eval | step:  200000 | running 625 steps of evaluation...
I0519 04:22:46.199359 140513721280320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0519 04:28:05.291077 140513721280320 controller.py:261]  eval | step:  200000 | eval time:  608.2 sec | output: 
    {'3': {'avg_iou': 0.4602207,
           'avg_obj': 0.17418331,
           'box_loss': 0.008929783,
           'class_loss': 0.0031469816,
           'conf_loss': 0.011567468,
           'precision50': 0.35204428,
           'recall50': 0.16004474},
     '4': {'avg_iou': 0.6613666,
           'avg_obj': 0.33586764,
           'box_loss': 0.009638085,
           'class_loss': 0.003530837,
           'conf_loss': 0.011945613,
           'precision50': 0.57227194,
           'recall50': 0.34733915},
     '5': {'avg_iou': 0.77375185,
           'avg_obj': 0.46909332,
           'box_loss': 0.00938644,
           'class_loss': 0.0036801624,
           'conf_loss': 0.010905788,
           'precision50': 0.7205439,
           'recall50': 0.5033808},
     'AP': 0.35893965,
     'AP50': 0.57157385,
     'AP75': 0.38133803,
     'APl': 0.4812909,
     'APm': 0.3401153,
     'APs': 0.14580105,
     'ARl': 0.6468923,
     'ARm': 0.5224196,
     'ARmax1': 0.29983357,
     'ARmax10': 0.48339644,
     'ARmax100': 0.5282228,
     'ARs': 0.30359593,
     'global': {'total_loss': 0.072731204},
     'validation_loss': 0.072731204}
I0519 04:28:28.460617 140513721280320 controller.py:211] train | step:  200000 | training until step 220000...
I0519 05:51:50.668666 140513721280320 controller.py:425] train | step:  210000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6636038,
           'avg_obj': 0.2817544,
           'box_loss': 0.10277727,
           'class_loss': 0.027971694,
           'conf_loss': 0.12111333,
           'precision50': 0.5281562,
           'recall50': 0.19110785},
     '4': {'avg_iou': 0.7571012,
           'avg_obj': 0.4151447,
           'box_loss': 0.08471624,
           'class_loss': 0.023540398,
           'conf_loss': 0.11608137,
           'precision50': 0.72357804,
           'recall50': 0.39605534},
     '5': {'avg_iou': 0.7941454,
           'avg_obj': 0.5049718,
           'box_loss': 0.07598406,
           'class_loss': 0.023353681,
           'conf_loss': 0.09260675,
           'precision50': 0.8094003,
           'recall50': 0.5455157},
     'global': {'total_loss': 0.66814476},
     'learning_rate': 0.005157283,
     'training_loss': 0.66814476}
I0519 05:53:00.193457 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-210000.
I0519 07:24:36.419595 140513721280320 controller.py:425] train | step:  220000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.66572404,
           'avg_obj': 0.286626,
           'box_loss': 0.101918496,
           'class_loss': 0.027357932,
           'conf_loss': 0.11975572,
           'precision50': 0.531472,
           'recall50': 0.19632535},
     '4': {'avg_iou': 0.7592475,
           'avg_obj': 0.42042324,
           'box_loss': 0.08387447,
           'class_loss': 0.02305088,
           'conf_loss': 0.11490302,
           'precision50': 0.72614855,
           'recall50': 0.40290123},
     '5': {'avg_iou': 0.7959673,
           'avg_obj': 0.509371,
           'box_loss': 0.075269334,
           'class_loss': 0.022824073,
           'conf_loss': 0.09175016,
           'precision50': 0.81119853,
           'recall50': 0.5513056},
     'global': {'total_loss': 0.6607052},
     'learning_rate': 0.0048287087,
     'training_loss': 0.6607052}
I0519 07:25:36.416348 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-220000.
I0519 07:25:36.423540 140513721280320 controller.py:252]  eval | step:  220000 | running 625 steps of evaluation...
I0519 07:30:22.774017 140513721280320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0519 07:35:18.726225 140513721280320 controller.py:261]  eval | step:  220000 | eval time:  582.3 sec | output: 
    {'3': {'avg_iou': 0.45954967,
           'avg_obj': 0.17509189,
           'box_loss': 0.008966039,
           'class_loss': 0.0032063941,
           'conf_loss': 0.011715734,
           'precision50': 0.3560279,
           'recall50': 0.16294533},
     '4': {'avg_iou': 0.66112,
           'avg_obj': 0.33811605,
           'box_loss': 0.009651148,
           'class_loss': 0.0036201451,
           'conf_loss': 0.012149716,
           'precision50': 0.5739085,
           'recall50': 0.35076922},
     '5': {'avg_iou': 0.7741754,
           'avg_obj': 0.47203273,
           'box_loss': 0.009365459,
           'class_loss': 0.0037339982,
           'conf_loss': 0.010986094,
           'precision50': 0.7185497,
           'recall50': 0.5064802},
     'AP': 0.35806987,
     'AP50': 0.5696671,
     'AP75': 0.37803283,
     'APl': 0.48088485,
     'APm': 0.33744708,
     'APs': 0.14630975,
     'ARl': 0.6432178,
     'ARm': 0.5186536,
     'ARmax1': 0.3011001,
     'ARmax10': 0.4832852,
     'ARmax100': 0.52544653,
     'ARs': 0.3005941,
     'global': {'total_loss': 0.07339469},
     'validation_loss': 0.07339469}
I0519 07:35:40.946608 140513721280320 controller.py:211] train | step:  220000 | training until step 240000...
I0519 08:58:16.468389 140513721280320 controller.py:425] train | step:  230000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6669491,
           'avg_obj': 0.29046538,
           'box_loss': 0.101508774,
           'class_loss': 0.026813056,
           'conf_loss': 0.1188431,
           'precision50': 0.5351325,
           'recall50': 0.20031191},
     '4': {'avg_iou': 0.7608938,
           'avg_obj': 0.42505673,
           'box_loss': 0.08321156,
           'class_loss': 0.022491263,
           'conf_loss': 0.1137493,
           'precision50': 0.72818136,
           'recall50': 0.4089031},
     '5': {'avg_iou': 0.79755896,
           'avg_obj': 0.5139969,
           'box_loss': 0.07458008,
           'class_loss': 0.022301853,
           'conf_loss': 0.09071122,
           'precision50': 0.81308275,
           'recall50': 0.5566216},
     'global': {'total_loss': 0.65421087},
     'learning_rate': 0.004508574,
     'training_loss': 0.65421087}

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-190000.
train | step:  200000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.66195387,
           'avg_obj': 0.27717993,
           'box_loss': 0.103243075,
           'class_loss': 0.028440317,
           'conf_loss': 0.12163771,
           'precision50': 0.5231979,
           'recall50': 0.18634447},
     '4': {'avg_iou': 0.7551459,
           'avg_obj': 0.40991518,
           'box_loss': 0.085470684,
           'class_loss': 0.024065005,
           'conf_loss': 0.11693545,
           'precision50': 0.7201598,
           'recall50': 0.38957444},
     '5': {'avg_iou': 0.79217005,
           'avg_obj': 0.50004226,
           'box_loss': 0.07678105,
           'class_loss': 0.023805564,
           'conf_loss': 0.09335846,
           'precision50': 0.80684036,
           'recall50': 0.539184},
     'global': {'total_loss': 0.67373604},
     'learning_rate': 0.005491929,
     'training_loss': 0.67373604}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-200000.
 eval | step:  200000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=240.75s).
Accumulating evaluation results...
DONE (t=14.91s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.359
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.572
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.381
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.146
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.340
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.481
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.300
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.483
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.528
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.304
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.522
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.647
 eval | step:  200000 | eval time:  608.2 sec | output: 
    {'3': {'avg_iou': 0.4602207,
           'avg_obj': 0.17418331,
           'box_loss': 0.008929783,
           'class_loss': 0.0031469816,
           'conf_loss': 0.011567468,
           'precision50': 0.35204428,
           'recall50': 0.16004474},
     '4': {'avg_iou': 0.6613666,
           'avg_obj': 0.33586764,
           'box_loss': 0.009638085,
           'class_loss': 0.003530837,
           'conf_loss': 0.011945613,
           'precision50': 0.57227194,
           'recall50': 0.34733915},
     '5': {'avg_iou': 0.77375185,
           'avg_obj': 0.46909332,
           'box_loss': 0.00938644,
           'class_loss': 0.0036801624,
           'conf_loss': 0.010905788,
           'precision50': 0.7205439,
           'recall50': 0.5033808},
     'AP': 0.35893965,
     'AP50': 0.57157385,
     'AP75': 0.38133803,
     'APl': 0.4812909,
     'APm': 0.3401153,
     'APs': 0.14580105,
     'ARl': 0.6468923,
     'ARm': 0.5224196,
     'ARmax1': 0.29983357,
     'ARmax10': 0.48339644,
     'ARmax100': 0.5282228,
     'ARs': 0.30359593,
     'global': {'total_loss': 0.072731204},
     'validation_loss': 0.072731204}
train | step:  200000 | training until step 220000...
train | step:  210000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6636038,
           'avg_obj': 0.2817544,
           'box_loss': 0.10277727,
           'class_loss': 0.027971694,
           'conf_loss': 0.12111333,
           'precision50': 0.5281562,
           'recall50': 0.19110785},
     '4': {'avg_iou': 0.7571012,
           'avg_obj': 0.4151447,
           'box_loss': 0.08471624,
           'class_loss': 0.023540398,
           'conf_loss': 0.11608137,
           'precision50': 0.72357804,
           'recall50': 0.39605534},
     '5': {'avg_iou': 0.7941454,
           'avg_obj': 0.5049718,
           'box_loss': 0.07598406,
           'class_loss': 0.023353681,
           'conf_loss': 0.09260675,
           'precision50': 0.8094003,
           'recall50': 0.5455157},
     'global': {'total_loss': 0.66814476},
     'learning_rate': 0.005157283,
     'training_loss': 0.66814476}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-210000.
train | step:  220000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.66572404,
           'avg_obj': 0.286626,
           'box_loss': 0.101918496,
           'class_loss': 0.027357932,
           'conf_loss': 0.11975572,
           'precision50': 0.531472,
           'recall50': 0.19632535},
     '4': {'avg_iou': 0.7592475,
           'avg_obj': 0.42042324,
           'box_loss': 0.08387447,
           'class_loss': 0.02305088,
           'conf_loss': 0.11490302,
           'precision50': 0.72614855,
           'recall50': 0.40290123},
     '5': {'avg_iou': 0.7959673,
           'avg_obj': 0.509371,
           'box_loss': 0.075269334,
           'class_loss': 0.022824073,
           'conf_loss': 0.09175016,
           'precision50': 0.81119853,
           'recall50': 0.5513056},
     'global': {'total_loss': 0.6607052},
     'learning_rate': 0.0048287087,
     'training_loss': 0.6607052}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-220000.
 eval | step:  220000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=198.96s).
Accumulating evaluation results...
DONE (t=14.11s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.358
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.570
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.378
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.146
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.337
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.481
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.301
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.483
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.525
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.301
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.519
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.643
 eval | step:  220000 | eval time:  582.3 sec | output: 
    {'3': {'avg_iou': 0.45954967,
           'avg_obj': 0.17509189,
           'box_loss': 0.008966039,
           'class_loss': 0.0032063941,
           'conf_loss': 0.011715734,
           'precision50': 0.3560279,
           'recall50': 0.16294533},
     '4': {'avg_iou': 0.66112,
           'avg_obj': 0.33811605,
           'box_loss': 0.009651148,
           'class_loss': 0.0036201451,
           'conf_loss': 0.012149716,
           'precision50': 0.5739085,
           'recall50': 0.35076922},
     '5': {'avg_iou': 0.7741754,
           'avg_obj': 0.47203273,
           'box_loss': 0.009365459,
           'class_loss': 0.0037339982,
           'conf_loss': 0.010986094,
           'precision50': 0.7185497,
           'recall50': 0.5064802},
     'AP': 0.35806987,
     'AP50': 0.5696671,
     'AP75': 0.37803283,
     'APl': 0.48088485,
     'APm': 0.33744708,
     'APs': 0.14630975,
     'ARl': 0.6432178,
     'ARm': 0.5186536,
     'ARmax1': 0.3011001,
     'ARmax10': 0.4832852,
     'ARmax100': 0.52544653,
     'ARs': 0.3005941,
     'global': {'total_loss': 0.07339469},
     'validation_loss': 0.07339469}
train | step:  220000 | training until step 240000...
train | step:  230000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6669491,
           'avg_obj': 0.29046538,
           'box_loss': 0.101508774,
           'class_loss': 0.026813056,
           'conf_loss': 0.1188431,
           'precision50': 0.5351325,
           'recall50': 0.20031191},
     '4': {'avg_iou': 0.7608938,
           'avg_obj': 0.42505673,
           'box_loss': 0.08321156,
           'class_loss': 0.022491263,
           'conf_loss': 0.1137493,
           'precision50': 0.72818136,
           'recall50': 0.4089031},
     '5': {'avg_iou': 0.79755896,
           'avg_obj': 0.5139969,
           'box_loss': 0.07458008,
           'class_loss': 0.022301853,
           'conf_loss': 0.09071122,
           'precision50': 0.81308275,
           'recall50': 0.5566216},
     'global': {'total_loss': 0.65421087},
     'learning_rate': 0.004508574,
     'training_loss': 0.65421087}I0519 08:59:16.434949 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-230000.
I0519 10:29:49.432372 140513721280320 controller.py:425] train | step:  240000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.66866815,
           'avg_obj': 0.294757,
           'box_loss': 0.100909345,
           'class_loss': 0.026321078,
           'conf_loss': 0.11794839,
           'precision50': 0.53890115,
           'recall50': 0.20543113},
     '4': {'avg_iou': 0.7627708,
           'avg_obj': 0.429919,
           'box_loss': 0.08245145,
           'class_loss': 0.02206639,
           'conf_loss': 0.11288106,
           'precision50': 0.73130757,
           'recall50': 0.41520312},
     '5': {'avg_iou': 0.7993883,
           'avg_obj': 0.51871544,
           'box_loss': 0.07378298,
           'class_loss': 0.021909626,
           'conf_loss': 0.090014435,
           'precision50': 0.8156194,
           'recall50': 0.5629324},
     'global': {'total_loss': 0.6482854},
     'learning_rate': 0.0041991845,
     'training_loss': 0.6482854}
I0519 10:30:48.913963 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-240000.
I0519 10:30:48.919809 140513721280320 controller.py:252]  eval | step:  240000 | running 625 steps of evaluation...
I0519 10:35:24.827191 140513721280320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0519 10:39:38.229468 140513721280320 controller.py:261]  eval | step:  240000 | eval time:  529.3 sec | output: 
    {'3': {'avg_iou': 0.45900688,
           'avg_obj': 0.17534257,
           'box_loss': 0.008994716,
           'class_loss': 0.003295956,
           'conf_loss': 0.011865896,
           'precision50': 0.3537023,
           'recall50': 0.16430393},
     '4': {'avg_iou': 0.6607984,
           'avg_obj': 0.33850706,
           'box_loss': 0.009668134,
           'class_loss': 0.0036680005,
           'conf_loss': 0.012362095,
           'precision50': 0.5680508,
           'recall50': 0.35423738},
     '5': {'avg_iou': 0.7740147,
           'avg_obj': 0.47329772,
           'box_loss': 0.009373479,
           'class_loss': 0.0038036017,
           'conf_loss': 0.011061028,
           'precision50': 0.7160962,
           'recall50': 0.5081778},
     'AP': 0.3573159,
     'AP50': 0.5680783,
     'AP75': 0.3791751,
     'APl': 0.4774386,
     'APm': 0.337424,
     'APs': 0.14571163,
     'ARl': 0.64113903,
     'ARm': 0.51644725,
     'ARmax1': 0.2998883,
     'ARmax10': 0.4800148,
     'ARmax100': 0.52261764,
     'ARs': 0.29898375,
     'global': {'total_loss': 0.07409292},
     'validation_loss': 0.07409292}
I0519 10:40:04.033270 140513721280320 controller.py:211] train | step:  240000 | training until step 260000...
I0519 12:03:05.329690 140513721280320 controller.py:425] train | step:  250000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6701359,
           'avg_obj': 0.29886672,
           'box_loss': 0.10063656,
           'class_loss': 0.025964756,
           'conf_loss': 0.11744729,
           'precision50': 0.5439711,
           'recall50': 0.21016905},
     '4': {'avg_iou': 0.7642759,
           'avg_obj': 0.43430507,
           'box_loss': 0.08196703,
           'class_loss': 0.021711351,
           'conf_loss': 0.112311766,
           'precision50': 0.73410064,
           'recall50': 0.4207518},
     '5': {'avg_iou': 0.80108345,
           'avg_obj': 0.5228481,
           'box_loss': 0.073180564,
           'class_loss': 0.021523267,
           'conf_loss': 0.08953255,
           'precision50': 0.81747884,
           'recall50': 0.5677021},
     'global': {'total_loss': 0.6442741},
     'learning_rate': 0.0039027706,
     'training_loss': 0.6442741}
I0519 12:04:03.036146 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-250000.
I0519 13:31:54.197272 140513721280320 controller.py:425] train | step:  260000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6714045,
           'avg_obj': 0.30250427,
           'box_loss': 0.100154445,
           'class_loss': 0.025402183,
           'conf_loss': 0.116738096,
           'precision50': 0.54677117,
           'recall50': 0.21414031},
     '4': {'avg_iou': 0.76590836,
           'avg_obj': 0.43885684,
           'box_loss': 0.08137994,
           'class_loss': 0.02129662,
           'conf_loss': 0.111379184,
           'precision50': 0.7367573,
           'recall50': 0.42683527},
     '5': {'avg_iou': 0.802601,
           'avg_obj': 0.5269706,
           'box_loss': 0.072552346,
           'class_loss': 0.02118334,
           'conf_loss': 0.088762075,
           'precision50': 0.8194646,
           'recall50': 0.57340246},
     'global': {'total_loss': 0.6388498},
     'learning_rate': 0.0036214672,
     'training_loss': 0.6388498}
I0519 13:32:53.751770 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-260000.
I0519 13:32:53.759464 140513721280320 controller.py:252]  eval | step:  260000 | running 625 steps of evaluation...
I0519 13:37:35.414821 140513721280320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0519 13:41:39.923098 140513721280320 controller.py:261]  eval | step:  260000 | eval time:  526.2 sec | output: 
    {'3': {'avg_iou': 0.45841944,
           'avg_obj': 0.1767576,
           'box_loss': 0.009026276,
           'class_loss': 0.0034115056,
           'conf_loss': 0.0120322425,
           'precision50': 0.35248235,
           'recall50': 0.16615821},
     '4': {'avg_iou': 0.6602542,
           'avg_obj': 0.34088713,
           'box_loss': 0.009696027,
           'class_loss': 0.0037556705,
           'conf_loss': 0.012608743,
           'precision50': 0.566576,
           'recall50': 0.35832807},
     '5': {'avg_iou': 0.774334,
           'avg_obj': 0.47651035,
           'box_loss': 0.009358688,
           'class_loss': 0.0038689503,
           'conf_loss': 0.011269152,
           'precision50': 0.7152603,
           'recall50': 0.5121092},
     'AP': 0.35597053,
     'AP50': 0.5653551,
     'AP75': 0.3775889,
     'APl': 0.4794879,
     'APm': 0.33517215,
     'APs': 0.14622378,
     'ARl': 0.6389379,
     'ARm': 0.510358,
     'ARmax1': 0.29852635,
     'ARmax10': 0.47818977,
     'ARmax100': 0.51888967,
     'ARs': 0.29536188,
     'global': {'total_loss': 0.075027205},
     'validation_loss': 0.075027205}
I0519 13:42:04.252245 140513721280320 controller.py:211] train | step:  260000 | training until step 280000...
I0519 15:03:58.687700 140513721280320 controller.py:425] train | step:  270000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6726181,
           'avg_obj': 0.3062472,
           'box_loss': 0.09947482,
           'class_loss': 0.02507245,
           'conf_loss': 0.11592052,
           'precision50': 0.5501805,
           'recall50': 0.21852031},
     '4': {'avg_iou': 0.7673599,
           'avg_obj': 0.4430047,
           'box_loss': 0.080730714,
           'class_loss': 0.020968571,
           'conf_loss': 0.11037963,
           'precision50': 0.73882467,
           'recall50': 0.4321547},
     '5': {'avg_iou': 0.80401087,
           'avg_obj': 0.53087294,
           'box_loss': 0.071945444,
           'class_loss': 0.020804929,
           'conf_loss': 0.087941475,
           'precision50': 0.82141143,
           'recall50': 0.5782013},
     'global': {'total_loss': 0.63324183},
     'learning_rate': 0.003357301,
     'training_loss': 0.63324183}

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-230000.
train | step:  240000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.66866815,
           'avg_obj': 0.294757,
           'box_loss': 0.100909345,
           'class_loss': 0.026321078,
           'conf_loss': 0.11794839,
           'precision50': 0.53890115,
           'recall50': 0.20543113},
     '4': {'avg_iou': 0.7627708,
           'avg_obj': 0.429919,
           'box_loss': 0.08245145,
           'class_loss': 0.02206639,
           'conf_loss': 0.11288106,
           'precision50': 0.73130757,
           'recall50': 0.41520312},
     '5': {'avg_iou': 0.7993883,
           'avg_obj': 0.51871544,
           'box_loss': 0.07378298,
           'class_loss': 0.021909626,
           'conf_loss': 0.090014435,
           'precision50': 0.8156194,
           'recall50': 0.5629324},
     'global': {'total_loss': 0.6482854},
     'learning_rate': 0.0041991845,
     'training_loss': 0.6482854}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-240000.
 eval | step:  240000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=187.68s).
Accumulating evaluation results...
DONE (t=14.98s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.357
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.568
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.379
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.146
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.337
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.477
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.300
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.480
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.523
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.299
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.516
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.641
 eval | step:  240000 | eval time:  529.3 sec | output: 
    {'3': {'avg_iou': 0.45900688,
           'avg_obj': 0.17534257,
           'box_loss': 0.008994716,
           'class_loss': 0.003295956,
           'conf_loss': 0.011865896,
           'precision50': 0.3537023,
           'recall50': 0.16430393},
     '4': {'avg_iou': 0.6607984,
           'avg_obj': 0.33850706,
           'box_loss': 0.009668134,
           'class_loss': 0.0036680005,
           'conf_loss': 0.012362095,
           'precision50': 0.5680508,
           'recall50': 0.35423738},
     '5': {'avg_iou': 0.7740147,
           'avg_obj': 0.47329772,
           'box_loss': 0.009373479,
           'class_loss': 0.0038036017,
           'conf_loss': 0.011061028,
           'precision50': 0.7160962,
           'recall50': 0.5081778},
     'AP': 0.3573159,
     'AP50': 0.5680783,
     'AP75': 0.3791751,
     'APl': 0.4774386,
     'APm': 0.337424,
     'APs': 0.14571163,
     'ARl': 0.64113903,
     'ARm': 0.51644725,
     'ARmax1': 0.2998883,
     'ARmax10': 0.4800148,
     'ARmax100': 0.52261764,
     'ARs': 0.29898375,
     'global': {'total_loss': 0.07409292},
     'validation_loss': 0.07409292}
train | step:  240000 | training until step 260000...
train | step:  250000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6701359,
           'avg_obj': 0.29886672,
           'box_loss': 0.10063656,
           'class_loss': 0.025964756,
           'conf_loss': 0.11744729,
           'precision50': 0.5439711,
           'recall50': 0.21016905},
     '4': {'avg_iou': 0.7642759,
           'avg_obj': 0.43430507,
           'box_loss': 0.08196703,
           'class_loss': 0.021711351,
           'conf_loss': 0.112311766,
           'precision50': 0.73410064,
           'recall50': 0.4207518},
     '5': {'avg_iou': 0.80108345,
           'avg_obj': 0.5228481,
           'box_loss': 0.073180564,
           'class_loss': 0.021523267,
           'conf_loss': 0.08953255,
           'precision50': 0.81747884,
           'recall50': 0.5677021},
     'global': {'total_loss': 0.6442741},
     'learning_rate': 0.0039027706,
     'training_loss': 0.6442741}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-250000.
train | step:  260000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6714045,
           'avg_obj': 0.30250427,
           'box_loss': 0.100154445,
           'class_loss': 0.025402183,
           'conf_loss': 0.116738096,
           'precision50': 0.54677117,
           'recall50': 0.21414031},
     '4': {'avg_iou': 0.76590836,
           'avg_obj': 0.43885684,
           'box_loss': 0.08137994,
           'class_loss': 0.02129662,
           'conf_loss': 0.111379184,
           'precision50': 0.7367573,
           'recall50': 0.42683527},
     '5': {'avg_iou': 0.802601,
           'avg_obj': 0.5269706,
           'box_loss': 0.072552346,
           'class_loss': 0.02118334,
           'conf_loss': 0.088762075,
           'precision50': 0.8194646,
           'recall50': 0.57340246},
     'global': {'total_loss': 0.6388498},
     'learning_rate': 0.0036214672,
     'training_loss': 0.6388498}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-260000.
 eval | step:  260000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.33s).
Accumulating evaluation results...
DONE (t=15.77s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.356
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.565
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.378
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.146
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.335
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.479
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.299
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.478
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.519
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.295
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.510
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.639
 eval | step:  260000 | eval time:  526.2 sec | output: 
    {'3': {'avg_iou': 0.45841944,
           'avg_obj': 0.1767576,
           'box_loss': 0.009026276,
           'class_loss': 0.0034115056,
           'conf_loss': 0.0120322425,
           'precision50': 0.35248235,
           'recall50': 0.16615821},
     '4': {'avg_iou': 0.6602542,
           'avg_obj': 0.34088713,
           'box_loss': 0.009696027,
           'class_loss': 0.0037556705,
           'conf_loss': 0.012608743,
           'precision50': 0.566576,
           'recall50': 0.35832807},
     '5': {'avg_iou': 0.774334,
           'avg_obj': 0.47651035,
           'box_loss': 0.009358688,
           'class_loss': 0.0038689503,
           'conf_loss': 0.011269152,
           'precision50': 0.7152603,
           'recall50': 0.5121092},
     'AP': 0.35597053,
     'AP50': 0.5653551,
     'AP75': 0.3775889,
     'APl': 0.4794879,
     'APm': 0.33517215,
     'APs': 0.14622378,
     'ARl': 0.6389379,
     'ARm': 0.510358,
     'ARmax1': 0.29852635,
     'ARmax10': 0.47818977,
     'ARmax100': 0.51888967,
     'ARs': 0.29536188,
     'global': {'total_loss': 0.075027205},
     'validation_loss': 0.075027205}
train | step:  260000 | training until step 280000...
train | step:  270000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6726181,
           'avg_obj': 0.3062472,
           'box_loss': 0.09947482,
           'class_loss': 0.02507245,
           'conf_loss': 0.11592052,
           'precision50': 0.5501805,
           'recall50': 0.21852031},
     '4': {'avg_iou': 0.7673599,
           'avg_obj': 0.4430047,
           'box_loss': 0.080730714,
           'class_loss': 0.020968571,
           'conf_loss': 0.11037963,
           'precision50': 0.73882467,
           'recall50': 0.4321547},
     '5': {'avg_iou': 0.80401087,
           'avg_obj': 0.53087294,
           'box_loss': 0.071945444,
           'class_loss': 0.020804929,
           'conf_loss': 0.087941475,
           'precision50': 0.82141143,
           'recall50': 0.5782013},
     'global': {'total_loss': 0.63324183},
     'learning_rate': 0.003357301,
     'training_loss': 0.63324183}I0519 15:04:57.705082 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-270000.
I0519 16:34:19.170686 140513721280320 controller.py:425] train | step:  280000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6737842,
           'avg_obj': 0.3096138,
           'box_loss': 0.09924699,
           'class_loss': 0.024795365,
           'conf_loss': 0.11524323,
           'precision50': 0.55287087,
           'recall50': 0.22223464},
     '4': {'avg_iou': 0.7689195,
           'avg_obj': 0.44684586,
           'box_loss': 0.08017533,
           'class_loss': 0.02071846,
           'conf_loss': 0.10992041,
           'precision50': 0.7406718,
           'recall50': 0.43687177},
     '5': {'avg_iou': 0.8053066,
           'avg_obj': 0.5339778,
           'box_loss': 0.07141879,
           'class_loss': 0.020528315,
           'conf_loss': 0.087614164,
           'precision50': 0.8222699,
           'recall50': 0.5817079},
     'global': {'total_loss': 0.6296595},
     'learning_rate': 0.003112175,
     'training_loss': 0.6296595}
I0519 16:35:18.181993 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-280000.
I0519 16:35:18.190164 140513721280320 controller.py:252]  eval | step:  280000 | running 625 steps of evaluation...
I0519 16:39:55.562843 140513721280320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0519 16:43:54.305646 140513721280320 controller.py:261]  eval | step:  280000 | eval time:  516.1 sec | output: 
    {'3': {'avg_iou': 0.45781386,
           'avg_obj': 0.17643748,
           'box_loss': 0.0090595335,
           'class_loss': 0.0035221225,
           'conf_loss': 0.012235683,
           'precision50': 0.34918746,
           'recall50': 0.16780291},
     '4': {'avg_iou': 0.65925735,
           'avg_obj': 0.34082744,
           'box_loss': 0.00974617,
           'class_loss': 0.0038934255,
           'conf_loss': 0.012752382,
           'precision50': 0.5659275,
           'recall50': 0.3586794},
     '5': {'avg_iou': 0.7740423,
           'avg_obj': 0.47896484,
           'box_loss': 0.009373046,
           'class_loss': 0.003955983,
           'conf_loss': 0.011080262,
           'precision50': 0.71602434,
           'recall50': 0.51456356},
     'AP': 0.35482582,
     'AP50': 0.56202376,
     'AP75': 0.37710422,
     'APl': 0.4778822,
     'APm': 0.33187762,
     'APs': 0.13904113,
     'ARl': 0.63348,
     'ARm': 0.5071732,
     'ARmax1': 0.29826853,
     'ARmax10': 0.47517204,
     'ARmax100': 0.5156023,
     'ARs': 0.29055476,
     'global': {'total_loss': 0.07561855},
     'validation_loss': 0.07561855}
I0519 16:44:13.668284 140513721280320 controller.py:211] train | step:  280000 | training until step 300000...
I0519 18:06:28.448725 140513721280320 controller.py:425] train | step:  290000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6752651,
           'avg_obj': 0.31341115,
           'box_loss': 0.09873288,
           'class_loss': 0.024376867,
           'conf_loss': 0.114549294,
           'precision50': 0.5555336,
           'recall50': 0.22621602},
     '4': {'avg_iou': 0.7701979,
           'avg_obj': 0.4508523,
           'box_loss': 0.079647146,
           'class_loss': 0.020388566,
           'conf_loss': 0.10913201,
           'precision50': 0.742391,
           'recall50': 0.44220224},
     '5': {'avg_iou': 0.80652124,
           'avg_obj': 0.5376652,
           'box_loss': 0.07087731,
           'class_loss': 0.020198315,
           'conf_loss': 0.086983636,
           'precision50': 0.8238388,
           'recall50': 0.5859541},
     'global': {'total_loss': 0.6248865},
     'learning_rate': 0.002887857,
     'training_loss': 0.6248865}
I0519 18:07:27.616479 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-290000.
I0519 19:39:10.205174 140513721280320 controller.py:425] train | step:  300000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.67628103,
           'avg_obj': 0.31616974,
           'box_loss': 0.09834632,
           'class_loss': 0.024098897,
           'conf_loss': 0.113868155,
           'precision50': 0.557926,
           'recall50': 0.2292388},
     '4': {'avg_iou': 0.77147734,
           'avg_obj': 0.4542257,
           'box_loss': 0.07914648,
           'class_loss': 0.020089593,
           'conf_loss': 0.108289294,
           'precision50': 0.74387246,
           'recall50': 0.44600782},
     '5': {'avg_iou': 0.80774933,
           'avg_obj': 0.5408159,
           'box_loss': 0.07038266,
           'class_loss': 0.019931206,
           'conf_loss': 0.086279444,
           'precision50': 0.82546824,
           'recall50': 0.5899537},
     'global': {'total_loss': 0.6204313},
     'learning_rate': 0.002685961,
     'training_loss': 0.6204313}
I0519 19:40:15.286452 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-300000.
I0519 19:40:15.292742 140513721280320 controller.py:252]  eval | step:  300000 | running 625 steps of evaluation...
I0519 19:44:57.087647 140513721280320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0519 19:48:59.023223 140513721280320 controller.py:261]  eval | step:  300000 | eval time:  523.7 sec | output: 
    {'3': {'avg_iou': 0.45707744,
           'avg_obj': 0.17705989,
           'box_loss': 0.009098959,
           'class_loss': 0.0035649755,
           'conf_loss': 0.012418342,
           'precision50': 0.3505577,
           'recall50': 0.16975044},
     '4': {'avg_iou': 0.6582856,
           'avg_obj': 0.34229565,
           'box_loss': 0.009796987,
           'class_loss': 0.003930613,
           'conf_loss': 0.013033573,
           'precision50': 0.56414026,
           'recall50': 0.36151394},
     '5': {'avg_iou': 0.7738985,
           'avg_obj': 0.4801837,
           'box_loss': 0.00938138,
           'class_loss': 0.0040109647,
           'conf_loss': 0.011424438,
           'precision50': 0.71096206,
           'recall50': 0.51498485},
     'AP': 0.35289422,
     'AP50': 0.5593859,
     'AP75': 0.3728326,
     'APl': 0.47779408,
     'APm': 0.33135188,
     'APs': 0.13630162,
     'ARl': 0.62875956,
     'ARm': 0.5024208,
     'ARmax1': 0.29650056,
     'ARmax10': 0.4723383,
     'ARmax100': 0.51107544,
     'ARs': 0.2896461,
     'global': {'total_loss': 0.076660216},
     'validation_loss': 0.076660216}
I0519 19:49:21.859188 140513721280320 controller.py:211] train | step:  300000 | training until step 320000...
I0519 21:11:29.881732 140513721280320 controller.py:425] train | step:  310000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.67751896,
           'avg_obj': 0.319461,
           'box_loss': 0.09803223,
           'class_loss': 0.023809474,
           'conf_loss': 0.11324903,
           'precision50': 0.5598351,
           'recall50': 0.23292305},
     '4': {'avg_iou': 0.7725475,
           'avg_obj': 0.45724738,
           'box_loss': 0.07883907,
           'class_loss': 0.01992697,
           'conf_loss': 0.1078249,
           'precision50': 0.7450933,
           'recall50': 0.44959083},
     '5': {'avg_iou': 0.8087462,
           'avg_obj': 0.54334295,
           'box_loss': 0.06997269,
           'class_loss': 0.019766001,
           'conf_loss': 0.08592401,
           'precision50': 0.82614356,
           'recall50': 0.5930087},
     'global': {'total_loss': 0.6173449},
     'learning_rate': 0.0025079434,
     'training_loss': 0.6173449}

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-270000.
train | step:  280000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6737842,
           'avg_obj': 0.3096138,
           'box_loss': 0.09924699,
           'class_loss': 0.024795365,
           'conf_loss': 0.11524323,
           'precision50': 0.55287087,
           'recall50': 0.22223464},
     '4': {'avg_iou': 0.7689195,
           'avg_obj': 0.44684586,
           'box_loss': 0.08017533,
           'class_loss': 0.02071846,
           'conf_loss': 0.10992041,
           'precision50': 0.7406718,
           'recall50': 0.43687177},
     '5': {'avg_iou': 0.8053066,
           'avg_obj': 0.5339778,
           'box_loss': 0.07141879,
           'class_loss': 0.020528315,
           'conf_loss': 0.087614164,
           'precision50': 0.8222699,
           'recall50': 0.5817079},
     'global': {'total_loss': 0.6296595},
     'learning_rate': 0.003112175,
     'training_loss': 0.6296595}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-280000.
 eval | step:  280000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=178.71s).
Accumulating evaluation results...
DONE (t=10.36s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.355
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.562
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.377
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.139
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.332
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.478
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.298
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.475
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.516
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.291
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.507
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.633
 eval | step:  280000 | eval time:  516.1 sec | output: 
    {'3': {'avg_iou': 0.45781386,
           'avg_obj': 0.17643748,
           'box_loss': 0.0090595335,
           'class_loss': 0.0035221225,
           'conf_loss': 0.012235683,
           'precision50': 0.34918746,
           'recall50': 0.16780291},
     '4': {'avg_iou': 0.65925735,
           'avg_obj': 0.34082744,
           'box_loss': 0.00974617,
           'class_loss': 0.0038934255,
           'conf_loss': 0.012752382,
           'precision50': 0.5659275,
           'recall50': 0.3586794},
     '5': {'avg_iou': 0.7740423,
           'avg_obj': 0.47896484,
           'box_loss': 0.009373046,
           'class_loss': 0.003955983,
           'conf_loss': 0.011080262,
           'precision50': 0.71602434,
           'recall50': 0.51456356},
     'AP': 0.35482582,
     'AP50': 0.56202376,
     'AP75': 0.37710422,
     'APl': 0.4778822,
     'APm': 0.33187762,
     'APs': 0.13904113,
     'ARl': 0.63348,
     'ARm': 0.5071732,
     'ARmax1': 0.29826853,
     'ARmax10': 0.47517204,
     'ARmax100': 0.5156023,
     'ARs': 0.29055476,
     'global': {'total_loss': 0.07561855},
     'validation_loss': 0.07561855}
train | step:  280000 | training until step 300000...
train | step:  290000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6752651,
           'avg_obj': 0.31341115,
           'box_loss': 0.09873288,
           'class_loss': 0.024376867,
           'conf_loss': 0.114549294,
           'precision50': 0.5555336,
           'recall50': 0.22621602},
     '4': {'avg_iou': 0.7701979,
           'avg_obj': 0.4508523,
           'box_loss': 0.079647146,
           'class_loss': 0.020388566,
           'conf_loss': 0.10913201,
           'precision50': 0.742391,
           'recall50': 0.44220224},
     '5': {'avg_iou': 0.80652124,
           'avg_obj': 0.5376652,
           'box_loss': 0.07087731,
           'class_loss': 0.020198315,
           'conf_loss': 0.086983636,
           'precision50': 0.8238388,
           'recall50': 0.5859541},
     'global': {'total_loss': 0.6248865},
     'learning_rate': 0.002887857,
     'training_loss': 0.6248865}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-290000.
train | step:  300000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.67628103,
           'avg_obj': 0.31616974,
           'box_loss': 0.09834632,
           'class_loss': 0.024098897,
           'conf_loss': 0.113868155,
           'precision50': 0.557926,
           'recall50': 0.2292388},
     '4': {'avg_iou': 0.77147734,
           'avg_obj': 0.4542257,
           'box_loss': 0.07914648,
           'class_loss': 0.020089593,
           'conf_loss': 0.108289294,
           'precision50': 0.74387246,
           'recall50': 0.44600782},
     '5': {'avg_iou': 0.80774933,
           'avg_obj': 0.5408159,
           'box_loss': 0.07038266,
           'class_loss': 0.019931206,
           'conf_loss': 0.086279444,
           'precision50': 0.82546824,
           'recall50': 0.5899537},
     'global': {'total_loss': 0.6204313},
     'learning_rate': 0.002685961,
     'training_loss': 0.6204313}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-300000.
 eval | step:  300000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=173.80s).
Accumulating evaluation results...
DONE (t=13.37s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.353
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.559
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.373
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.136
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.331
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.478
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.297
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.472
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.511
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.290
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.502
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.629
 eval | step:  300000 | eval time:  523.7 sec | output: 
    {'3': {'avg_iou': 0.45707744,
           'avg_obj': 0.17705989,
           'box_loss': 0.009098959,
           'class_loss': 0.0035649755,
           'conf_loss': 0.012418342,
           'precision50': 0.3505577,
           'recall50': 0.16975044},
     '4': {'avg_iou': 0.6582856,
           'avg_obj': 0.34229565,
           'box_loss': 0.009796987,
           'class_loss': 0.003930613,
           'conf_loss': 0.013033573,
           'precision50': 0.56414026,
           'recall50': 0.36151394},
     '5': {'avg_iou': 0.7738985,
           'avg_obj': 0.4801837,
           'box_loss': 0.00938138,
           'class_loss': 0.0040109647,
           'conf_loss': 0.011424438,
           'precision50': 0.71096206,
           'recall50': 0.51498485},
     'AP': 0.35289422,
     'AP50': 0.5593859,
     'AP75': 0.3728326,
     'APl': 0.47779408,
     'APm': 0.33135188,
     'APs': 0.13630162,
     'ARl': 0.62875956,
     'ARm': 0.5024208,
     'ARmax1': 0.29650056,
     'ARmax10': 0.4723383,
     'ARmax100': 0.51107544,
     'ARs': 0.2896461,
     'global': {'total_loss': 0.076660216},
     'validation_loss': 0.076660216}
train | step:  300000 | training until step 320000...
train | step:  310000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.67751896,
           'avg_obj': 0.319461,
           'box_loss': 0.09803223,
           'class_loss': 0.023809474,
           'conf_loss': 0.11324903,
           'precision50': 0.5598351,
           'recall50': 0.23292305},
     '4': {'avg_iou': 0.7725475,
           'avg_obj': 0.45724738,
           'box_loss': 0.07883907,
           'class_loss': 0.01992697,
           'conf_loss': 0.1078249,
           'precision50': 0.7450933,
           'recall50': 0.44959083},
     '5': {'avg_iou': 0.8087462,
           'avg_obj': 0.54334295,
           'box_loss': 0.06997269,
           'class_loss': 0.019766001,
           'conf_loss': 0.08592401,
           'precision50': 0.82614356,
           'recall50': 0.5930087},
     'global': {'total_loss': 0.6173449},
     'learning_rate': 0.0025079434,
     'training_loss': 0.6173449}I0519 21:12:29.079219 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-310000.
I0519 22:41:58.828938 140513721280320 controller.py:425] train | step:  320000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6782751,
           'avg_obj': 0.3219575,
           'box_loss': 0.097733796,
           'class_loss': 0.023513673,
           'conf_loss': 0.11297909,
           'precision50': 0.56213653,
           'recall50': 0.23566382},
     '4': {'avg_iou': 0.7734826,
           'avg_obj': 0.45988023,
           'box_loss': 0.07845117,
           'class_loss': 0.01963361,
           'conf_loss': 0.10733788,
           'precision50': 0.7465528,
           'recall50': 0.45318046},
     '5': {'avg_iou': 0.8096814,
           'avg_obj': 0.5460814,
           'box_loss': 0.06957993,
           'class_loss': 0.01951897,
           'conf_loss': 0.08548835,
           'precision50': 0.8270808,
           'recall50': 0.5963038},
     'global': {'total_loss': 0.61423504},
     'learning_rate': 0.002355086,
     'training_loss': 0.61423504}
I0519 22:43:00.873151 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-320000.
I0519 22:43:00.880004 140513721280320 controller.py:252]  eval | step:  320000 | running 625 steps of evaluation...
I0519 22:47:39.451779 140513721280320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0519 22:51:50.009582 140513721280320 controller.py:261]  eval | step:  320000 | eval time:  529.1 sec | output: 
    {'3': {'avg_iou': 0.45601332,
           'avg_obj': 0.17722349,
           'box_loss': 0.009153953,
           'class_loss': 0.0036203628,
           'conf_loss': 0.012524303,
           'precision50': 0.35139805,
           'recall50': 0.17104767},
     '4': {'avg_iou': 0.65792996,
           'avg_obj': 0.34292457,
           'box_loss': 0.009815423,
           'class_loss': 0.0040109213,
           'conf_loss': 0.013174599,
           'precision50': 0.5632481,
           'recall50': 0.3638694},
     '5': {'avg_iou': 0.77390486,
           'avg_obj': 0.48184404,
           'box_loss': 0.0093815625,
           'class_loss': 0.0040483084,
           'conf_loss': 0.011601043,
           'precision50': 0.7117636,
           'recall50': 0.51832783},
     'AP': 0.3513837,
     'AP50': 0.5578055,
     'AP75': 0.3714466,
     'APl': 0.4824028,
     'APm': 0.32744983,
     'APs': 0.139074,
     'ARl': 0.63112533,
     'ARm': 0.49597502,
     'ARmax1': 0.29573646,
     'ARmax10': 0.4688934,
     'ARmax100': 0.50754917,
     'ARs': 0.27492604,
     'global': {'total_loss': 0.07733054},
     'validation_loss': 0.07733054}
I0519 22:52:09.161067 140513721280320 controller.py:211] train | step:  320000 | training until step 340000...
I0520 00:17:08.470492 140513721280320 controller.py:425] train | step:  330000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6790956,
           'avg_obj': 0.32445243,
           'box_loss': 0.09740737,
           'class_loss': 0.023351176,
           'conf_loss': 0.11229015,
           'precision50': 0.56461996,
           'recall50': 0.2388204},
     '4': {'avg_iou': 0.77450347,
           'avg_obj': 0.46267906,
           'box_loss': 0.07803501,
           'class_loss': 0.019464998,
           'conf_loss': 0.10675077,
           'precision50': 0.74849576,
           'recall50': 0.45699385},
     '5': {'avg_iou': 0.810654,
           'avg_obj': 0.5483077,
           'box_loss': 0.069218844,
           'class_loss': 0.019413961,
           'conf_loss': 0.08507716,
           'precision50': 0.828445,
           'recall50': 0.5990061},
     'global': {'total_loss': 0.61101073},
     'learning_rate': 0.0022284898,
     'training_loss': 0.61101073}
I0520 00:18:12.261697 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-330000.
I0520 01:48:35.023302 140513721280320 controller.py:425] train | step:  340000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.67981946,
           'avg_obj': 0.32718527,
           'box_loss': 0.097197495,
           'class_loss': 0.02312113,
           'conf_loss': 0.11181815,
           'precision50': 0.5659816,
           'recall50': 0.24142063},
     '4': {'avg_iou': 0.775531,
           'avg_obj': 0.46588784,
           'box_loss': 0.077692546,
           'class_loss': 0.0192491,
           'conf_loss': 0.106149584,
           'precision50': 0.74979514,
           'recall50': 0.46078348},
     '5': {'avg_iou': 0.8115384,
           'avg_obj': 0.5510149,
           'box_loss': 0.06890621,
           'class_loss': 0.019155253,
           'conf_loss': 0.08459655,
           'precision50': 0.8297633,
           'recall50': 0.6023801},
     'global': {'total_loss': 0.60788584},
     'learning_rate': 0.0021290681,
     'training_loss': 0.60788584}
I0520 01:49:36.894365 140513721280320 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/640-torch-13/ckpt-340000.
I0520 01:49:36.899868 140513721280320 controller.py:252]  eval | step:  340000 | running 625 steps of evaluation...
I0520 01:54:10.534136 140513721280320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0520 01:58:21.619873 140513721280320 controller.py:261]  eval | step:  340000 | eval time:  524.7 sec | output: 
    {'3': {'avg_iou': 0.45505175,
           'avg_obj': 0.177056,
           'box_loss': 0.009203187,
           'class_loss': 0.003674803,
           'conf_loss': 0.012655496,
           'precision50': 0.34863985,
           'recall50': 0.17177816},
     '4': {'avg_iou': 0.6576776,
           'avg_obj': 0.34379703,
           'box_loss': 0.009829771,
           'class_loss': 0.0040764357,
           'conf_loss': 0.013348087,
           'precision50': 0.5639134,
           'recall50': 0.36583033},
     '5': {'avg_iou': 0.77400434,
           'avg_obj': 0.4839166,
           'box_loss': 0.00937619,
           'class_loss': 0.0040879063,
           'conf_loss': 0.01165146,
           'precision50': 0.7117434,
           'recall50': 0.5209729},
     'AP': 0.3510565,
     'AP50': 0.5564227,
     'AP75': 0.37183234,
     'APl': 0.47563353,
     'APm': 0.3289482,
     'APs': 0.1368212,
     'ARl': 0.62687504,
     'ARm': 0.49572605,
     'ARmax1': 0.29623803,
     'ARmax10': 0.46811298,
     'ARmax100': 0.5059882,
     'ARs': 0.2741116,
     'global': {'total_loss': 0.07790335},
     'validation_loss': 0.07790335}
I0520 01:58:50.546436 140513721280320 controller.py:211] train | step:  340000 | training until step 360000...
/home/cam2tensorflow/.experiment_start.sh: line 22: 20119 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4-$5
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208      7    753 --:--:-- --:--:-- --:--:--   760
okRequest issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-20T02:58:39.627706112Z'
  endTime: '2021-05-20T02:59:17.722485009Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621479519616-5c2ba1ec6fdab-e320d743-17d7ed88
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-04-28T09:49:15.232857330Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-28T09:48:54.136196+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621479519616-5c2ba1ec6fdab-e320d743-17d7ed88] to complete...
..............................................................................................................................................................................................................................................................................done.
