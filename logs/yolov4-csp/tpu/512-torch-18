cat: .experiment_zone: No such file or directory
Request issued for: [node-7]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621479460063-5c2ba1b3a48d3-d54c15fc-4925a04b] to complete...
..........................................................................................failed.
ERROR: (gcloud.compute.tpus.start) {
  "code": 8,
  "message": "There is no more capacity in the zone \"europe-west4-a\"; you can try in another zone where Cloud TPU Nodes are offered (see https://cloud.google.com/tpu/docs/regions) [EID: 0xb6e8d990ef45c35]"
}
europe-west4-a
I0520 02:52:00.483761 140413016651584 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[12.0, 16.0]',
                              '[19.0, 36.0]',
                              '[40.0, 28.0]',
                              '[36.0, 75.0]',
                              '[76.0, 55.0]',
                              '[72.0, 146.0]',
                              '[142.0, 110.0]',
                              '[192.0, 243.0]',
                              '[459.0, 401.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_scaled_loss': True},
                    'input_size': [512, 512, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.0,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.5,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'random_pad': False,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.5,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.5,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'random_pad': False,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 02:52:00.484653 140413016651584 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/params.yaml
I0520 02:52:02.029261 140413016651584 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 02:52:02.172071 140413016651584 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0520 02:52:02.172438 140413016651584 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-7" is not yet ready; state: "STOPPED"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, 'input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_scaled_loss': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.0, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.5, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'random_pad': False, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.5, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'random_pad': False, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     12   1268 --:--:-- --:--:-- --:--:--  1280
okRequest issued for: [node-7]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-20T02:58:04.528963727Z'
  endTime: '2021-05-20T02:58:15.734126995Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621479484511-5c2ba1caf53ca-c3fa9408-3805f771
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.124.160.48/29
  createTime: '2021-03-18T03:10:27.166064884Z'
  health: HEALTHY
  ipAddress: 10.124.160.50
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.124.160.50
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621479484511-5c2ba1caf53ca-c3fa9408-3805f771] to complete...
.............................................................done.
cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is STOPPING
europe-west4-a
I0520 02:52:53.920825 139904945469248 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[12.0, 16.0]',
                              '[19.0, 36.0]',
                              '[40.0, 28.0]',
                              '[36.0, 75.0]',
                              '[76.0, 55.0]',
                              '[72.0, 146.0]',
                              '[142.0, 110.0]',
                              '[192.0, 243.0]',
                              '[459.0, 401.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_scaled_loss': True},
                    'input_size': [512, 512, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.0,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.5,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'random_pad': False,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.5,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.5,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'random_pad': False,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 02:52:53.921785 139904945469248 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/params.yaml
I0520 02:52:54.841900 139904945469248 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 02:52:55.454808 139904945469248 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0520 02:52:55.455327 139904945469248 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-6" is not yet ready; state: "STOPPING"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, 'input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_scaled_loss': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.0, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.5, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'random_pad': False, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.5, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'random_pad': False, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     11   1188 --:--:-- --:--:-- --:--:--  1200
okRequest issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-20T02:58:57.816251436Z'
  endTime: '2021-05-20T02:59:28.876167444Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621479537803-5c2ba1fdc7f4b-3664cdf9-f9cfeef1
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-04-28T09:49:15.232857330Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-28T09:48:54.136196+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621479537803-5c2ba1fdc7f4b-3664cdf9-f9cfeef1] to complete...
.....................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-20T02:59:40.002200198Z'
  endTime: '2021-05-20T03:00:16.472196224Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621479579990-5c2ba22603b80-09b52634-1cc3e28a
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-04-28T09:49:15.232857330Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-28T09:48:54.136196+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621479579990-5c2ba22603b80-09b52634-1cc3e28a] to complete...
...............................................................................................................................................................................................done.
europe-west4-a
I0520 02:54:20.177306 139861436241728 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[12.0, 16.0]',
                              '[19.0, 36.0]',
                              '[40.0, 28.0]',
                              '[36.0, 75.0]',
                              '[76.0, 55.0]',
                              '[72.0, 146.0]',
                              '[142.0, 110.0]',
                              '[192.0, 243.0]',
                              '[459.0, 401.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_scaled_loss': True},
                    'input_size': [512, 512, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.0,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.5,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 1.5,
                                    'aug_scale_min': 0.5,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'random_pad': False,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.5,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 1.5,
                                         'aug_scale_min': 0.5,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'random_pad': False,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0520 02:54:20.178967 139861436241728 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/params.yaml
I0520 02:54:20.998932 139861436241728 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 02:54:21.626109 139861436241728 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0520 02:54:21.626420 139861436241728 transport.py:157] Attempting refresh to obtain initial access_token
I0520 02:54:21.682293 139861436241728 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 02:54:22.301179 139861436241728 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0520 02:54:22.301450 139861436241728 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-20 02:54:22.371345: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0520 02:54:22.372176 139861436241728 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 02:54:22.514129 139861436241728 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0520 02:54:22.514421 139861436241728 transport.py:157] Attempting refresh to obtain initial access_token
I0520 02:54:22.568149 139861436241728 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 02:54:22.723093 139861436241728 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0520 02:54:22.723675 139861436241728 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-20 02:54:22.777925: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-20 02:54:22.801413: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-05-20 02:54:22.801510: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:62618}
2021-05-20 02:55:04.344057: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-05-20 02:55:04.344155: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:62618}
2021-05-20 02:55:04.344871: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:62618
I0520 02:55:04.345667 139861436241728 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-6
I0520 02:55:04.346430 139861436241728 tpu_strategy_util.py:74] Initializing the TPU system: node-6
INFO:tensorflow:Clearing out eager caches
I0520 02:55:11.891291 139861436241728 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0520 02:55:11.893669 139861436241728 tpu_strategy_util.py:133] Finished initializing TPU system.
I0520 02:55:11.895348 139861436241728 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 02:55:12.042823 139861436241728 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0520 02:55:12.043350 139861436241728 transport.py:157] Attempting refresh to obtain initial access_token
I0520 02:55:12.095413 139861436241728 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0520 02:55:12.234393 139861436241728 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0520 02:55:12.234864 139861436241728 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0520 02:55:12.272816 139861436241728 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0520 02:55:12.273061 139861436241728 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0520 02:55:12.273314 139861436241728 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0520 02:55:12.273369 139861436241728 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0520 02:55:12.273417 139861436241728 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0520 02:55:12.273538 139861436241728 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0520 02:55:12.273587 139861436241728 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0520 02:55:12.273660 139861436241728 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0520 02:55:12.273704 139861436241728 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0520 02:55:12.273750 139861436241728 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0520 02:55:12.273806 139861436241728 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0520 02:55:12.273850 139861436241728 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0520 02:55:12.273893 139861436241728 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0520 02:55:12.273943 139861436241728 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0520 02:55:12.273987 139861436241728 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0520 02:55:12.274032 139861436241728 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0520 02:55:12.275343 139861436241728 train_utils.py:214] Running default trainer.
2021-05-20 02:55:12.286794: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, 'input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_scaled_loss': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.0, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.5, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'random_pad': False, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.5, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.5, 'aug_scale_max': 1.5, 'random_pad': False, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
heheheeheheheheheheheh:  [[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'num_classes': 91, 'input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_scaled_loss': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f33a04c27f0>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________I0520 02:56:01.935269 139861436241728 controller.py:362] restoring or initializing model...
I0520 02:56:14.485557 139861436241728 yolo.py:536] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0520 02:56:14.487210 139861436241728 controller.py:368] initialized model.
I0520 02:56:14.487439 139861436241728 train_lib.py:96] Starts to execute mode: train_and_eval
I0520 02:56:14.492149 139861436241728 controller.py:211] train | step:      0 | training until step 20000...
I0520 02:56:22.575092 139861436241728 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0520 02:57:10.159824 139861436241728 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0520 04:47:39.294072 139861436241728 controller.py:425] train | step:  10000 | steps/sec:    1.5 | output: 
    {'3': {'avg_iou': 0.40986583,
           'avg_obj': 0.061941084,
           'box_loss': 0.19591215,
           'class_loss': 0.3951682,
           'conf_loss': 1.388377,
           'precision50': 0.031932168,
           'recall50': 0.024839895},
     '4': {'avg_iou': 0.4833901,
           'avg_obj': 0.10335039,
           'box_loss': 0.19912569,
           'class_loss': 0.44210112,
           'conf_loss': 0.49855196,
           'precision50': 0.10799507,
           'recall50': 0.03433308},
     '5': {'avg_iou': 0.51439065,
           'avg_obj': 0.15666458,
           'box_loss': 0.19584562,
           'class_loss': 0.41989082,
           'conf_loss': 0.26617855,
           'precision50': 0.16310251,
           'recall50': 0.06005141},
     'global': {'total_loss': 4.0011353},
     'learning_rate': 0.009985589,
     'training_loss': 4.0011353}
I0520 04:48:42.637929 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-10000.
I0520 06:23:34.989817 139861436241728 controller.py:425] train | step:  20000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.4896232,
           'avg_obj': 0.052148353,
           'box_loss': 0.16671187,
           'class_loss': 0.12315671,
           'conf_loss': 0.19936363,
           'precision50': 0.05967529,
           'recall50': 0.0057532205},
     '4': {'avg_iou': 0.57426035,
           'avg_obj': 0.10837775,
           'box_loss': 0.16103007,
           'class_loss': 0.13557391,
           'conf_loss': 0.1855143,
           'precision50': 0.17371635,
           'recall50': 0.023586722},
     '5': {'avg_iou': 0.6263653,
           'avg_obj': 0.18624198,
           'box_loss': 0.14969572,
           'class_loss': 0.13238333,
           'conf_loss': 0.12211586,
           'precision50': 0.3017644,
           'recall50': 0.06764773},
     'global': {'total_loss': 1.3755444},
     'learning_rate': 0.009942464,
     'training_loss': 1.3755444}
I0520 06:24:36.333335 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-20000.
I0520 06:24:36.339587 139861436241728 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0520 06:24:36.989198 139861436241728 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0520 06:24:52.942401 139861436241728 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0520 06:30:01.290601 139861436241728 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0520 06:34:01.015650 139861436241728 controller.py:261]  eval | step:  20000 | eval time:  564.7 sec | output: 
    {'3': {'avg_iou': 0.39128137,
           'avg_obj': 0.044924073,
           'box_loss': 0.01528302,
           'class_loss': 0.009622935,
           'conf_loss': 0.021921325,
           'precision50': 0.08958612,
           'recall50': 0.012540012},
     '4': {'avg_iou': 0.547082,
           'avg_obj': 0.09707862,
           'box_loss': 0.017832076,
           'class_loss': 0.012321761,
           'conf_loss': 0.021376366,
           'precision50': 0.16784327,
           'recall50': 0.03711807},
     '5': {'avg_iou': 0.5950009,
           'avg_obj': 0.1647217,
           'box_loss': 0.018384844,
           'class_loss': 0.012776945,
           'conf_loss': 0.018039487,
           'precision50': 0.22510014,
           'recall50': 0.062272448},
     'AP': 0.053048667,
     'AP50': 0.12123982,
     'AP75': 0.038037743,
     'APl': 0.073673815,
     'APm': 0.05424957,
     'APs': 0.013579887,
     'ARl': 0.3054982,
     'ARm': 0.23026027,
     'ARmax1': 0.102047004,
     'ARmax10': 0.20049539,
     'ARmax100': 0.22527081,
     'ARs': 0.06896845,
     'global': {'total_loss': 0.1475588},
     'validation_loss': 0.1475588}

yolo_pan (YoloPAN)              {'5': (None, 16, 16, 57800704    input_2[0][0]                    
                                                                 input_3[0][0]                    
                                                                 input_4[0][0]                    
==================================================================================================
Total params: 57,800,704
Trainable params: 57,768,960
Non-trainable params: 31,744
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'5': (None, 16, 16, 2048 57800704  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  1033056   
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 85,486,272
Trainable params: 85,419,200
Non-trainable params: 67,072
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 400, 8), 5: (8, 200, 8)}, inds: {3: (8, 600, 3), 4: (8, 400, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
[[12.0, 16.0], [19.0, 36.0], [40.0, 28.0], [36.0, 75.0], [76.0, 55.0], [72.0, 146.0], [142.0, 110.0], [192.0, 243.0], [459.0, 401.0]]
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
train | step:  10000 | steps/sec:    1.5 | output: 
    {'3': {'avg_iou': 0.40986583,
           'avg_obj': 0.061941084,
           'box_loss': 0.19591215,
           'class_loss': 0.3951682,
           'conf_loss': 1.388377,
           'precision50': 0.031932168,
           'recall50': 0.024839895},
     '4': {'avg_iou': 0.4833901,
           'avg_obj': 0.10335039,
           'box_loss': 0.19912569,
           'class_loss': 0.44210112,
           'conf_loss': 0.49855196,
           'precision50': 0.10799507,
           'recall50': 0.03433308},
     '5': {'avg_iou': 0.51439065,
           'avg_obj': 0.15666458,
           'box_loss': 0.19584562,
           'class_loss': 0.41989082,
           'conf_loss': 0.26617855,
           'precision50': 0.16310251,
           'recall50': 0.06005141},
     'global': {'total_loss': 4.0011353},
     'learning_rate': 0.009985589,
     'training_loss': 4.0011353}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-10000.
train | step:  20000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.4896232,
           'avg_obj': 0.052148353,
           'box_loss': 0.16671187,
           'class_loss': 0.12315671,
           'conf_loss': 0.19936363,
           'precision50': 0.05967529,
           'recall50': 0.0057532205},
     '4': {'avg_iou': 0.57426035,
           'avg_obj': 0.10837775,
           'box_loss': 0.16103007,
           'class_loss': 0.13557391,
           'conf_loss': 0.1855143,
           'precision50': 0.17371635,
           'recall50': 0.023586722},
     '5': {'avg_iou': 0.6263653,
           'avg_obj': 0.18624198,
           'box_loss': 0.14969572,
           'class_loss': 0.13238333,
           'conf_loss': 0.12211586,
           'precision50': 0.3017644,
           'recall50': 0.06764773},
     'global': {'total_loss': 1.3755444},
     'learning_rate': 0.009942464,
     'training_loss': 1.3755444}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-20000.
 eval | step:  20000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=161.80s).
Accumulating evaluation results...
DONE (t=22.31s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.053
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.121
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.038
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.014
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.054
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.074
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.102
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.200
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.225
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.069
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.230
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.305
 eval | step:  20000 | eval time:  564.7 sec | output: 
    {'3': {'avg_iou': 0.39128137,
           'avg_obj': 0.044924073,
           'box_loss': 0.01528302,
           'class_loss': 0.009622935,
           'conf_loss': 0.021921325,
           'precision50': 0.08958612,
           'recall50': 0.012540012},
     '4': {'avg_iou': 0.547082,
           'avg_obj': 0.09707862,
           'box_loss': 0.017832076,
           'class_loss': 0.012321761,
           'conf_loss': 0.021376366,
           'precision50': 0.16784327,
           'recall50': 0.03711807},
     '5': {'avg_iou': 0.5950009,
           'avg_obj': 0.1647217,
           'box_loss': 0.018384844,
           'class_loss': 0.012776945,
           'conf_loss': 0.018039487,
           'precision50': 0.22510014,
           'recall50': 0.062272448},
     'AP': 0.053048667,
     'AP50': 0.12123982,
     'AP75': 0.038037743,
     'APl': 0.073673815,
     'APm': 0.05424957,
     'APs': 0.013579887,
     'ARl': 0.3054982,
     'ARm': 0.23026027,
     'ARmax1': 0.102047004,
     'ARmax10': 0.20049539,
     'ARmax100': 0.22527081,
     'ARs': 0.06896845,
     'global': {'total_loss': 0.1475588},
     'validation_loss': 0.1475588}I0520 06:34:24.604551 139861436241728 controller.py:211] train | step:  20000 | training until step 40000...
I0520 08:08:19.990592 139861436241728 controller.py:425] train | step:  30000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.51604426,
           'avg_obj': 0.0754221,
           'box_loss': 0.15762427,
           'class_loss': 0.107546985,
           'conf_loss': 0.19333218,
           'precision50': 0.11943263,
           'recall50': 0.014043698},
     '4': {'avg_iou': 0.6096167,
           'avg_obj': 0.14951529,
           'box_loss': 0.1467387,
           'class_loss': 0.114137486,
           'conf_loss': 0.17905088,
           'precision50': 0.32444692,
           'recall50': 0.057293285},
     '5': {'avg_iou': 0.66039306,
           'avg_obj': 0.24087256,
           'box_loss': 0.13535453,
           'class_loss': 0.10988791,
           'conf_loss': 0.11585251,
           'precision50': 0.46413234,
           'recall50': 0.14273793},
     'global': {'total_loss': 1.259527},
     'learning_rate': 0.0098709315,
     'training_loss': 1.259527}
I0520 08:09:19.235790 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-30000.
I0520 09:44:05.932454 139861436241728 controller.py:425] train | step:  40000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5319329,
           'avg_obj': 0.092313275,
           'box_loss': 0.15228632,
           'class_loss': 0.09812511,
           'conf_loss': 0.18923715,
           'precision50': 0.16397269,
           'recall50': 0.0220302},
     '4': {'avg_iou': 0.6309368,
           'avg_obj': 0.17865224,
           'box_loss': 0.13825996,
           'class_loss': 0.101245835,
           'conf_loss': 0.17397238,
           'precision50': 0.40814528,
           'recall50': 0.08785593},
     '5': {'avg_iou': 0.68067336,
           'avg_obj': 0.2774425,
           'box_loss': 0.12672469,
           'class_loss': 0.09631392,
           'conf_loss': 0.11158529,
           'precision50': 0.5412359,
           'recall50': 0.19881314},
     'global': {'total_loss': 1.1877509},
     'learning_rate': 0.00977151,
     'training_loss': 1.1877509}
I0520 09:45:03.644072 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-40000.
I0520 09:45:03.649896 139861436241728 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0520 09:49:11.671666 139861436241728 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0520 09:53:13.853417 139861436241728 controller.py:261]  eval | step:  40000 | eval time:  490.2 sec | output: 
    {'3': {'avg_iou': 0.41850322,
           'avg_obj': 0.07641503,
           'box_loss': 0.013875769,
           'class_loss': 0.007213197,
           'conf_loss': 0.02073181,
           'precision50': 0.1640092,
           'recall50': 0.034119945},
     '4': {'avg_iou': 0.59608394,
           'avg_obj': 0.16288322,
           'box_loss': 0.015303117,
           'class_loss': 0.008699251,
           'conf_loss': 0.019893507,
           'precision50': 0.34291974,
           'recall50': 0.10004454},
     '5': {'avg_iou': 0.654171,
           'avg_obj': 0.2561462,
           'box_loss': 0.015315281,
           'class_loss': 0.0088781,
           'conf_loss': 0.016668458,
           'precision50': 0.48547167,
           'recall50': 0.18781015},
     'AP': 0.12445933,
     'AP50': 0.24765171,
     'AP75': 0.10913604,
     'APl': 0.17523596,
     'APm': 0.124281295,
     'APs': 0.040794965,
     'ARl': 0.4371826,
     'ARm': 0.3387445,
     'ARmax1': 0.1621127,
     'ARmax10': 0.28965542,
     'ARmax100': 0.32360741,
     'ARs': 0.13914427,
     'global': {'total_loss': 0.12657855},
     'validation_loss': 0.12657855}
I0520 09:53:35.676821 139861436241728 controller.py:211] train | step:  40000 | training until step 60000...
I0520 11:27:49.732478 139861436241728 controller.py:425] train | step:  50000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.543769,
           'avg_obj': 0.10506864,
           'box_loss': 0.14830022,
           'class_loss': 0.09130785,
           'conf_loss': 0.1863941,
           'precision50': 0.1989437,
           'recall50': 0.02951734},
     '4': {'avg_iou': 0.6451479,
           'avg_obj': 0.19931161,
           'box_loss': 0.13250111,
           'class_loss': 0.092375286,
           'conf_loss': 0.17070042,
           'precision50': 0.45754188,
           'recall50': 0.112124585},
     '5': {'avg_iou': 0.6938278,
           'avg_obj': 0.30197236,
           'box_loss': 0.121071555,
           'class_loss': 0.08743854,
           'conf_loss': 0.10875614,
           'precision50': 0.58183575,
           'recall50': 0.23718682},
     'global': {'total_loss': 1.1388466},
     'learning_rate': 0.0096449135,
     'training_loss': 1.1388466}
I0520 11:28:47.652398 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-50000.
I0520 13:00:41.704363 139861436241728 controller.py:425] train | step:  60000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.552638,
           'avg_obj': 0.115861416,
           'box_loss': 0.14520127,
           'class_loss': 0.086275406,
           'conf_loss': 0.18382548,
           'precision50': 0.2265698,
           'recall50': 0.036342103},
     '4': {'avg_iou': 0.6553666,
           'avg_obj': 0.21527684,
           'box_loss': 0.12828769,
           'class_loss': 0.08575005,
           'conf_loss': 0.16754852,
           'precision50': 0.49029648,
           'recall50': 0.13146746},
     '5': {'avg_iou': 0.7031693,
           'avg_obj': 0.31985602,
           'box_loss': 0.11712682,
           'class_loss': 0.08086222,
           'conf_loss': 0.106423,
           'precision50': 0.60708606,
           'recall50': 0.2648793},
     'global': {'total_loss': 1.1013005},
     'learning_rate': 0.009492056,
     'training_loss': 1.1013005}
I0520 13:01:47.056444 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-60000.
I0520 13:01:47.062673 139861436241728 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0520 13:05:58.721961 139861436241728 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0520 13:10:02.210318 139861436241728 controller.py:261]  eval | step:  60000 | eval time:  495.1 sec | output: 
    {'3': {'avg_iou': 0.43211424,
           'avg_obj': 0.095630385,
           'box_loss': 0.013167624,
           'class_loss': 0.006116932,
           'conf_loss': 0.019941555,
           'precision50': 0.2204363,
           'recall50': 0.051463988},
     '4': {'avg_iou': 0.6188256,
           'avg_obj': 0.20130344,
           'box_loss': 0.014125667,
           'class_loss': 0.007009492,
           'conf_loss': 0.018953338,
           'precision50': 0.4253353,
           'recall50': 0.14498752},
     '5': {'avg_iou': 0.67928976,
           'avg_obj': 0.30652636,
           'box_loss': 0.014004406,
           'class_loss': 0.007174757,
           'conf_loss': 0.015612107,
           'precision50': 0.580081,
           'recall50': 0.26485455},
     'AP': 0.17179553,
     'AP50': 0.32595378,
     'AP75': 0.16126384,
     'APl': 0.24705258,
     'APm': 0.17094174,
     'APs': 0.060988758,
     'ARl': 0.49969476,
     'ARm': 0.3944068,
     'ARmax1': 0.19264604,
     'ARmax10': 0.33489153,
     'ARmax100': 0.37347332,
     'ARs': 0.17231894,
     'global': {'total_loss': 0.1161059},
     'validation_loss': 0.1161059}

train | step:  20000 | training until step 40000...
train | step:  30000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.51604426,
           'avg_obj': 0.0754221,
           'box_loss': 0.15762427,
           'class_loss': 0.107546985,
           'conf_loss': 0.19333218,
           'precision50': 0.11943263,
           'recall50': 0.014043698},
     '4': {'avg_iou': 0.6096167,
           'avg_obj': 0.14951529,
           'box_loss': 0.1467387,
           'class_loss': 0.114137486,
           'conf_loss': 0.17905088,
           'precision50': 0.32444692,
           'recall50': 0.057293285},
     '5': {'avg_iou': 0.66039306,
           'avg_obj': 0.24087256,
           'box_loss': 0.13535453,
           'class_loss': 0.10988791,
           'conf_loss': 0.11585251,
           'precision50': 0.46413234,
           'recall50': 0.14273793},
     'global': {'total_loss': 1.259527},
     'learning_rate': 0.0098709315,
     'training_loss': 1.259527}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-30000.
train | step:  40000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5319329,
           'avg_obj': 0.092313275,
           'box_loss': 0.15228632,
           'class_loss': 0.09812511,
           'conf_loss': 0.18923715,
           'precision50': 0.16397269,
           'recall50': 0.0220302},
     '4': {'avg_iou': 0.6309368,
           'avg_obj': 0.17865224,
           'box_loss': 0.13825996,
           'class_loss': 0.101245835,
           'conf_loss': 0.17397238,
           'precision50': 0.40814528,
           'recall50': 0.08785593},
     '5': {'avg_iou': 0.68067336,
           'avg_obj': 0.2774425,
           'box_loss': 0.12672469,
           'class_loss': 0.09631392,
           'conf_loss': 0.11158529,
           'precision50': 0.5412359,
           'recall50': 0.19881314},
     'global': {'total_loss': 1.1877509},
     'learning_rate': 0.00977151,
     'training_loss': 1.1877509}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-40000.
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=168.39s).
Accumulating evaluation results...
DONE (t=21.15s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.124
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.248
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.109
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.041
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.124
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.175
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.162
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.290
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.324
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.139
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.339
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.437
 eval | step:  40000 | eval time:  490.2 sec | output: 
    {'3': {'avg_iou': 0.41850322,
           'avg_obj': 0.07641503,
           'box_loss': 0.013875769,
           'class_loss': 0.007213197,
           'conf_loss': 0.02073181,
           'precision50': 0.1640092,
           'recall50': 0.034119945},
     '4': {'avg_iou': 0.59608394,
           'avg_obj': 0.16288322,
           'box_loss': 0.015303117,
           'class_loss': 0.008699251,
           'conf_loss': 0.019893507,
           'precision50': 0.34291974,
           'recall50': 0.10004454},
     '5': {'avg_iou': 0.654171,
           'avg_obj': 0.2561462,
           'box_loss': 0.015315281,
           'class_loss': 0.0088781,
           'conf_loss': 0.016668458,
           'precision50': 0.48547167,
           'recall50': 0.18781015},
     'AP': 0.12445933,
     'AP50': 0.24765171,
     'AP75': 0.10913604,
     'APl': 0.17523596,
     'APm': 0.124281295,
     'APs': 0.040794965,
     'ARl': 0.4371826,
     'ARm': 0.3387445,
     'ARmax1': 0.1621127,
     'ARmax10': 0.28965542,
     'ARmax100': 0.32360741,
     'ARs': 0.13914427,
     'global': {'total_loss': 0.12657855},
     'validation_loss': 0.12657855}
train | step:  40000 | training until step 60000...
train | step:  50000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.543769,
           'avg_obj': 0.10506864,
           'box_loss': 0.14830022,
           'class_loss': 0.09130785,
           'conf_loss': 0.1863941,
           'precision50': 0.1989437,
           'recall50': 0.02951734},
     '4': {'avg_iou': 0.6451479,
           'avg_obj': 0.19931161,
           'box_loss': 0.13250111,
           'class_loss': 0.092375286,
           'conf_loss': 0.17070042,
           'precision50': 0.45754188,
           'recall50': 0.112124585},
     '5': {'avg_iou': 0.6938278,
           'avg_obj': 0.30197236,
           'box_loss': 0.121071555,
           'class_loss': 0.08743854,
           'conf_loss': 0.10875614,
           'precision50': 0.58183575,
           'recall50': 0.23718682},
     'global': {'total_loss': 1.1388466},
     'learning_rate': 0.0096449135,
     'training_loss': 1.1388466}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-50000.
train | step:  60000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.552638,
           'avg_obj': 0.115861416,
           'box_loss': 0.14520127,
           'class_loss': 0.086275406,
           'conf_loss': 0.18382548,
           'precision50': 0.2265698,
           'recall50': 0.036342103},
     '4': {'avg_iou': 0.6553666,
           'avg_obj': 0.21527684,
           'box_loss': 0.12828769,
           'class_loss': 0.08575005,
           'conf_loss': 0.16754852,
           'precision50': 0.49029648,
           'recall50': 0.13146746},
     '5': {'avg_iou': 0.7031693,
           'avg_obj': 0.31985602,
           'box_loss': 0.11712682,
           'class_loss': 0.08086222,
           'conf_loss': 0.106423,
           'precision50': 0.60708606,
           'recall50': 0.2648793},
     'global': {'total_loss': 1.1013005},
     'learning_rate': 0.009492056,
     'training_loss': 1.1013005}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-60000.
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=170.14s).
Accumulating evaluation results...
DONE (t=19.79s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.172
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.326
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.161
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.061
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.171
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.247
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.193
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.335
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.373
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.172
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.394
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.500
 eval | step:  60000 | eval time:  495.1 sec | output: 
    {'3': {'avg_iou': 0.43211424,
           'avg_obj': 0.095630385,
           'box_loss': 0.013167624,
           'class_loss': 0.006116932,
           'conf_loss': 0.019941555,
           'precision50': 0.2204363,
           'recall50': 0.051463988},
     '4': {'avg_iou': 0.6188256,
           'avg_obj': 0.20130344,
           'box_loss': 0.014125667,
           'class_loss': 0.007009492,
           'conf_loss': 0.018953338,
           'precision50': 0.4253353,
           'recall50': 0.14498752},
     '5': {'avg_iou': 0.67928976,
           'avg_obj': 0.30652636,
           'box_loss': 0.014004406,
           'class_loss': 0.007174757,
           'conf_loss': 0.015612107,
           'precision50': 0.580081,
           'recall50': 0.26485455},
     'AP': 0.17179553,
     'AP50': 0.32595378,
     'AP75': 0.16126384,
     'APl': 0.24705258,
     'APm': 0.17094174,
     'APs': 0.060988758,
     'ARl': 0.49969476,
     'ARm': 0.3944068,
     'ARmax1': 0.19264604,
     'ARmax10': 0.33489153,
     'ARmax100': 0.37347332,
     'ARs': 0.17231894,
     'global': {'total_loss': 0.1161059},
     'validation_loss': 0.1161059}I0520 13:10:19.185037 139861436241728 controller.py:211] train | step:  60000 | training until step 80000...
I0520 14:43:14.233268 139861436241728 controller.py:425] train | step:  70000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.55973065,
           'avg_obj': 0.12456061,
           'box_loss': 0.14272635,
           'class_loss': 0.082008794,
           'conf_loss': 0.18129173,
           'precision50': 0.24770097,
           'recall50': 0.0423768},
     '4': {'avg_iou': 0.6636944,
           'avg_obj': 0.22825336,
           'box_loss': 0.12504175,
           'class_loss': 0.080576606,
           'conf_loss': 0.16500904,
           'precision50': 0.51488626,
           'recall50': 0.14817461},
     '5': {'avg_iou': 0.7109678,
           'avg_obj': 0.33480963,
           'box_loss': 0.11391535,
           'class_loss': 0.07585178,
           'conf_loss': 0.10451946,
           'precision50': 0.62585497,
           'recall50': 0.28789103},
     'global': {'total_loss': 1.0709457},
     'learning_rate': 0.009314038,
     'training_loss': 1.0709457}
I0520 14:44:13.897431 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-70000.
I0520 16:16:26.185662 139861436241728 controller.py:425] train | step:  80000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5657274,
           'avg_obj': 0.1321213,
           'box_loss': 0.14076784,
           'class_loss': 0.07882919,
           'conf_loss': 0.17986614,
           'precision50': 0.26703018,
           'recall50': 0.04807004},
     '4': {'avg_iou': 0.6705123,
           'avg_obj': 0.23923098,
           'box_loss': 0.12232451,
           'class_loss': 0.07656342,
           'conf_loss': 0.16332175,
           'precision50': 0.5344746,
           'recall50': 0.16234893},
     '5': {'avg_iou': 0.7172637,
           'avg_obj': 0.34727052,
           'box_loss': 0.11123068,
           'class_loss': 0.071898796,
           'conf_loss': 0.10307216,
           'precision50': 0.64053357,
           'recall50': 0.30668253},
     'global': {'total_loss': 1.0478747},
     'learning_rate': 0.009112143,
     'training_loss': 1.0478747}
I0520 16:17:40.599723 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-80000.
I0520 16:17:40.606414 139861436241728 controller.py:252]  eval | step:  80000 | running 625 steps of evaluation...
I0520 16:21:49.605511 139861436241728 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0520 16:26:01.038341 139861436241728 controller.py:261]  eval | step:  80000 | eval time:  500.4 sec | output: 
    {'3': {'avg_iou': 0.44066054,
           'avg_obj': 0.11012526,
           'box_loss': 0.012723203,
           'class_loss': 0.00548294,
           'conf_loss': 0.019496761,
           'precision50': 0.25283104,
           'recall50': 0.06722174},
     '4': {'avg_iou': 0.6328056,
           'avg_obj': 0.2277731,
           'box_loss': 0.013403317,
           'class_loss': 0.0061191414,
           'conf_loss': 0.018400228,
           'precision50': 0.4800353,
           'recall50': 0.18043393},
     '5': {'avg_iou': 0.69487095,
           'avg_obj': 0.3362693,
           'box_loss': 0.013192795,
           'class_loss': 0.0062902197,
           'conf_loss': 0.015252916,
           'precision50': 0.62143415,
           'recall50': 0.30847123},
     'AP': 0.20371872,
     'AP50': 0.37308502,
     'AP75': 0.19870272,
     'APl': 0.29222792,
     'APm': 0.2015518,
     'APs': 0.0745783,
     'ARl': 0.5334577,
     'ARm': 0.42627406,
     'ARmax1': 0.21301606,
     'ARmax10': 0.36034197,
     'ARmax100': 0.4034303,
     'ARs': 0.19853996,
     'global': {'total_loss': 0.11036154},
     'validation_loss': 0.11036154}
I0520 16:26:24.402840 139861436241728 controller.py:211] train | step:  80000 | training until step 100000...
I0520 17:56:52.581793 139861436241728 controller.py:425] train | step:  90000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.57098836,
           'avg_obj': 0.13907982,
           'box_loss': 0.138971,
           'class_loss': 0.07609933,
           'conf_loss': 0.17847149,
           'precision50': 0.283479,
           'recall50': 0.05328571},
     '4': {'avg_iou': 0.6761221,
           'avg_obj': 0.2490073,
           'box_loss': 0.12007053,
           'class_loss': 0.07309492,
           'conf_loss': 0.1617389,
           'precision50': 0.55017704,
           'recall50': 0.17539966},
     '5': {'avg_iou': 0.7226665,
           'avg_obj': 0.35809833,
           'box_loss': 0.10900841,
           'class_loss': 0.068649985,
           'conf_loss': 0.10190469,
           'precision50': 0.6526033,
           'recall50': 0.3228656},
     'global': {'total_loss': 1.028008},
     'learning_rate': 0.008887824,
     'training_loss': 1.028008}
I0520 17:57:52.439466 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-90000.
I0520 19:29:28.431799 139861436241728 controller.py:425] train | step:  100000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5749189,
           'avg_obj': 0.14485048,
           'box_loss': 0.13770959,
           'class_loss': 0.073718704,
           'conf_loss': 0.17741057,
           'precision50': 0.29720494,
           'recall50': 0.05784323},
     '4': {'avg_iou': 0.680991,
           'avg_obj': 0.25720277,
           'box_loss': 0.11818999,
           'class_loss': 0.07030703,
           'conf_loss': 0.16034026,
           'precision50': 0.5631606,
           'recall50': 0.1856935},
     '5': {'avg_iou': 0.727277,
           'avg_obj': 0.36695167,
           'box_loss': 0.107167885,
           'class_loss': 0.06601353,
           'conf_loss': 0.10084995,
           'precision50': 0.6620474,
           'recall50': 0.3364135},
     'global': {'total_loss': 1.0117061},
     'learning_rate': 0.008642699,
     'training_loss': 1.0117061}
I0520 19:30:32.206860 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-100000.
I0520 19:30:32.215315 139861436241728 controller.py:252]  eval | step:  100000 | running 625 steps of evaluation...
I0520 19:34:51.253647 139861436241728 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0520 19:39:00.712124 139861436241728 controller.py:261]  eval | step:  100000 | eval time:  508.5 sec | output: 
    {'3': {'avg_iou': 0.44665802,
           'avg_obj': 0.12028397,
           'box_loss': 0.01241155,
           'class_loss': 0.0050919405,
           'conf_loss': 0.019203909,
           'precision50': 0.2757442,
           'recall50': 0.07765536},
     '4': {'avg_iou': 0.64213955,
           'avg_obj': 0.24595268,
           'box_loss': 0.01291918,
           'class_loss': 0.005575993,
           'conf_loss': 0.018091423,
           'precision50': 0.51168835,
           'recall50': 0.20515087},
     '5': {'avg_iou': 0.70510286,
           'avg_obj': 0.3570286,
           'box_loss': 0.012657885,
           'class_loss': 0.0057179728,
           'conf_loss': 0.015040451,
           'precision50': 0.65061724,
           'recall50': 0.3400566},
     'AP': 0.22530398,
     'AP50': 0.4048193,
     'AP75': 0.22388229,
     'APl': 0.3226797,
     'APm': 0.22344203,
     'APs': 0.08409323,
     'ARl': 0.5542763,
     'ARm': 0.44398946,
     'ARmax1': 0.22514015,
     'ARmax10': 0.379039,
     'ARmax100': 0.4223183,
     'ARs': 0.2162321,
     'global': {'total_loss': 0.10671022},
     'validation_loss': 0.10671022}

train | step:  60000 | training until step 80000...
train | step:  70000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.55973065,
           'avg_obj': 0.12456061,
           'box_loss': 0.14272635,
           'class_loss': 0.082008794,
           'conf_loss': 0.18129173,
           'precision50': 0.24770097,
           'recall50': 0.0423768},
     '4': {'avg_iou': 0.6636944,
           'avg_obj': 0.22825336,
           'box_loss': 0.12504175,
           'class_loss': 0.080576606,
           'conf_loss': 0.16500904,
           'precision50': 0.51488626,
           'recall50': 0.14817461},
     '5': {'avg_iou': 0.7109678,
           'avg_obj': 0.33480963,
           'box_loss': 0.11391535,
           'class_loss': 0.07585178,
           'conf_loss': 0.10451946,
           'precision50': 0.62585497,
           'recall50': 0.28789103},
     'global': {'total_loss': 1.0709457},
     'learning_rate': 0.009314038,
     'training_loss': 1.0709457}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-70000.
train | step:  80000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5657274,
           'avg_obj': 0.1321213,
           'box_loss': 0.14076784,
           'class_loss': 0.07882919,
           'conf_loss': 0.17986614,
           'precision50': 0.26703018,
           'recall50': 0.04807004},
     '4': {'avg_iou': 0.6705123,
           'avg_obj': 0.23923098,
           'box_loss': 0.12232451,
           'class_loss': 0.07656342,
           'conf_loss': 0.16332175,
           'precision50': 0.5344746,
           'recall50': 0.16234893},
     '5': {'avg_iou': 0.7172637,
           'avg_obj': 0.34727052,
           'box_loss': 0.11123068,
           'class_loss': 0.071898796,
           'conf_loss': 0.10307216,
           'precision50': 0.64053357,
           'recall50': 0.30668253},
     'global': {'total_loss': 1.0478747},
     'learning_rate': 0.009112143,
     'training_loss': 1.0478747}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-80000.
 eval | step:  80000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=174.09s).
Accumulating evaluation results...
DONE (t=20.14s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.204
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.373
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.199
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.075
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.202
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.292
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.213
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.360
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.403
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.199
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.426
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.533
 eval | step:  80000 | eval time:  500.4 sec | output: 
    {'3': {'avg_iou': 0.44066054,
           'avg_obj': 0.11012526,
           'box_loss': 0.012723203,
           'class_loss': 0.00548294,
           'conf_loss': 0.019496761,
           'precision50': 0.25283104,
           'recall50': 0.06722174},
     '4': {'avg_iou': 0.6328056,
           'avg_obj': 0.2277731,
           'box_loss': 0.013403317,
           'class_loss': 0.0061191414,
           'conf_loss': 0.018400228,
           'precision50': 0.4800353,
           'recall50': 0.18043393},
     '5': {'avg_iou': 0.69487095,
           'avg_obj': 0.3362693,
           'box_loss': 0.013192795,
           'class_loss': 0.0062902197,
           'conf_loss': 0.015252916,
           'precision50': 0.62143415,
           'recall50': 0.30847123},
     'AP': 0.20371872,
     'AP50': 0.37308502,
     'AP75': 0.19870272,
     'APl': 0.29222792,
     'APm': 0.2015518,
     'APs': 0.0745783,
     'ARl': 0.5334577,
     'ARm': 0.42627406,
     'ARmax1': 0.21301606,
     'ARmax10': 0.36034197,
     'ARmax100': 0.4034303,
     'ARs': 0.19853996,
     'global': {'total_loss': 0.11036154},
     'validation_loss': 0.11036154}
train | step:  80000 | training until step 100000...
train | step:  90000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.57098836,
           'avg_obj': 0.13907982,
           'box_loss': 0.138971,
           'class_loss': 0.07609933,
           'conf_loss': 0.17847149,
           'precision50': 0.283479,
           'recall50': 0.05328571},
     '4': {'avg_iou': 0.6761221,
           'avg_obj': 0.2490073,
           'box_loss': 0.12007053,
           'class_loss': 0.07309492,
           'conf_loss': 0.1617389,
           'precision50': 0.55017704,
           'recall50': 0.17539966},
     '5': {'avg_iou': 0.7226665,
           'avg_obj': 0.35809833,
           'box_loss': 0.10900841,
           'class_loss': 0.068649985,
           'conf_loss': 0.10190469,
           'precision50': 0.6526033,
           'recall50': 0.3228656},
     'global': {'total_loss': 1.028008},
     'learning_rate': 0.008887824,
     'training_loss': 1.028008}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-90000.
train | step:  100000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5749189,
           'avg_obj': 0.14485048,
           'box_loss': 0.13770959,
           'class_loss': 0.073718704,
           'conf_loss': 0.17741057,
           'precision50': 0.29720494,
           'recall50': 0.05784323},
     '4': {'avg_iou': 0.680991,
           'avg_obj': 0.25720277,
           'box_loss': 0.11818999,
           'class_loss': 0.07030703,
           'conf_loss': 0.16034026,
           'precision50': 0.5631606,
           'recall50': 0.1856935},
     '5': {'avg_iou': 0.727277,
           'avg_obj': 0.36695167,
           'box_loss': 0.107167885,
           'class_loss': 0.06601353,
           'conf_loss': 0.10084995,
           'precision50': 0.6620474,
           'recall50': 0.3364135},
     'global': {'total_loss': 1.0117061},
     'learning_rate': 0.008642699,
     'training_loss': 1.0117061}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-100000.
 eval | step:  100000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=172.64s).
Accumulating evaluation results...
DONE (t=19.16s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.225
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.405
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.224
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.084
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.223
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.323
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.225
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.379
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.422
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.216
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.444
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.554
 eval | step:  100000 | eval time:  508.5 sec | output: 
    {'3': {'avg_iou': 0.44665802,
           'avg_obj': 0.12028397,
           'box_loss': 0.01241155,
           'class_loss': 0.0050919405,
           'conf_loss': 0.019203909,
           'precision50': 0.2757442,
           'recall50': 0.07765536},
     '4': {'avg_iou': 0.64213955,
           'avg_obj': 0.24595268,
           'box_loss': 0.01291918,
           'class_loss': 0.005575993,
           'conf_loss': 0.018091423,
           'precision50': 0.51168835,
           'recall50': 0.20515087},
     '5': {'avg_iou': 0.70510286,
           'avg_obj': 0.3570286,
           'box_loss': 0.012657885,
           'class_loss': 0.0057179728,
           'conf_loss': 0.015040451,
           'precision50': 0.65061724,
           'recall50': 0.3400566},
     'AP': 0.22530398,
     'AP50': 0.4048193,
     'AP75': 0.22388229,
     'APl': 0.3226797,
     'APm': 0.22344203,
     'APs': 0.08409323,
     'ARl': 0.5542763,
     'ARm': 0.44398946,
     'ARmax1': 0.22514015,
     'ARmax10': 0.379039,
     'ARmax100': 0.4223183,
     'ARs': 0.2162321,
     'global': {'total_loss': 0.10671022},
     'validation_loss': 0.10671022}I0520 19:39:18.075338 139861436241728 controller.py:211] train | step:  100000 | training until step 120000...
I0520 21:09:13.839705 139861436241728 controller.py:425] train | step:  110000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.57903683,
           'avg_obj': 0.15035181,
           'box_loss': 0.1364307,
           'class_loss': 0.07143552,
           'conf_loss': 0.17576094,
           'precision50': 0.30881703,
           'recall50': 0.062359504},
     '4': {'avg_iou': 0.6850601,
           'avg_obj': 0.26502225,
           'box_loss': 0.11651782,
           'class_loss': 0.0675545,
           'conf_loss': 0.15869772,
           'precision50': 0.573904,
           'recall50': 0.19686407},
     '5': {'avg_iou': 0.731169,
           'avg_obj': 0.37502405,
           'box_loss': 0.10542881,
           'class_loss': 0.0633725,
           'conf_loss': 0.09972421,
           'precision50': 0.66987133,
           'recall50': 0.34804097},
     'global': {'total_loss': 0.9949206},
     'learning_rate': 0.008378533,
     'training_loss': 0.9949206}
I0520 21:10:14.414770 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-110000.
I0520 22:42:41.787822 139861436241728 controller.py:425] train | step:  120000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5825152,
           'avg_obj': 0.15563338,
           'box_loss': 0.1350995,
           'class_loss': 0.06948952,
           'conf_loss': 0.17509568,
           'precision50': 0.31958702,
           'recall50': 0.06649763},
     '4': {'avg_iou': 0.68917817,
           'avg_obj': 0.27222106,
           'box_loss': 0.114863954,
           'class_loss': 0.06521205,
           'conf_loss': 0.1574812,
           'precision50': 0.58318484,
           'recall50': 0.20566621},
     '5': {'avg_iou': 0.73538357,
           'avg_obj': 0.38320267,
           'box_loss': 0.103712745,
           'class_loss': 0.061251488,
           'conf_loss': 0.09867967,
           'precision50': 0.677071,
           'recall50': 0.35967547},
     'global': {'total_loss': 0.9808868},
     'learning_rate': 0.008097229,
     'training_loss': 0.9808868}
I0520 22:43:45.991497 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-120000.
I0520 22:43:45.997596 139861436241728 controller.py:252]  eval | step:  120000 | running 625 steps of evaluation...
I0520 22:47:55.322980 139861436241728 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0520 22:52:05.796485 139861436241728 controller.py:261]  eval | step:  120000 | eval time:  499.8 sec | output: 
    {'3': {'avg_iou': 0.45134303,
           'avg_obj': 0.12783441,
           'box_loss': 0.012166773,
           'class_loss': 0.0047853733,
           'conf_loss': 0.019017477,
           'precision50': 0.28641415,
           'recall50': 0.08536686},
     '4': {'avg_iou': 0.64884907,
           'avg_obj': 0.2617195,
           'box_loss': 0.012570644,
           'class_loss': 0.0052007646,
           'conf_loss': 0.017772026,
           'precision50': 0.53396374,
           'recall50': 0.22484885},
     '5': {'avg_iou': 0.7123717,
           'avg_obj': 0.37358126,
           'box_loss': 0.012276731,
           'class_loss': 0.0053243972,
           'conf_loss': 0.014734189,
           'precision50': 0.66639256,
           'recall50': 0.36317018},
     'AP': 0.24280092,
     'AP50': 0.42929548,
     'AP75': 0.24414198,
     'APl': 0.34871846,
     'APm': 0.24008013,
     'APs': 0.09371244,
     'ARl': 0.5744698,
     'ARm': 0.4625442,
     'ARmax1': 0.23591386,
     'ARmax10': 0.39402792,
     'ARmax100': 0.43853384,
     'ARs': 0.22765301,
     'global': {'total_loss': 0.10384839},
     'validation_loss': 0.10384839}
I0520 22:52:24.670361 139861436241728 controller.py:211] train | step:  120000 | training until step 140000...
I0521 00:20:33.896900 139861436241728 controller.py:425] train | step:  130000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5860092,
           'avg_obj': 0.1605308,
           'box_loss': 0.13403873,
           'class_loss': 0.06799943,
           'conf_loss': 0.17388836,
           'precision50': 0.32893673,
           'recall50': 0.07039095},
     '4': {'avg_iou': 0.6926603,
           'avg_obj': 0.27822268,
           'box_loss': 0.11352821,
           'class_loss': 0.06342897,
           'conf_loss': 0.15625738,
           'precision50': 0.5907522,
           'recall50': 0.2141171},
     '5': {'avg_iou': 0.7387788,
           'avg_obj': 0.38978544,
           'box_loss': 0.10220678,
           'class_loss': 0.059495833,
           'conf_loss': 0.097951196,
           'precision50': 0.68289614,
           'recall50': 0.3695709},
     'global': {'total_loss': 0.9687955},
     'learning_rate': 0.007800815,
     'training_loss': 0.9687955}
I0521 00:21:37.270761 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-130000.
I0521 01:56:00.966548 139861436241728 controller.py:425] train | step:  140000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.58904177,
           'avg_obj': 0.16465357,
           'box_loss': 0.13292648,
           'class_loss': 0.066399366,
           'conf_loss': 0.17261238,
           'precision50': 0.3372386,
           'recall50': 0.07390799},
     '4': {'avg_iou': 0.69584715,
           'avg_obj': 0.28388566,
           'box_loss': 0.1122173,
           'class_loss': 0.061422307,
           'conf_loss': 0.15500975,
           'precision50': 0.5971063,
           'recall50': 0.22154939},
     '5': {'avg_iou': 0.74177516,
           'avg_obj': 0.39576796,
           'box_loss': 0.10102854,
           'class_loss': 0.057633936,
           'conf_loss': 0.09702908,
           'precision50': 0.68633044,
           'recall50': 0.3772636},
     'global': {'total_loss': 0.9562787},
     'learning_rate': 0.007491425,
     'training_loss': 0.9562787}
I0521 01:57:06.410463 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-140000.
I0521 01:57:06.417188 139861436241728 controller.py:252]  eval | step:  140000 | running 625 steps of evaluation...
I0521 02:01:25.062390 139861436241728 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0521 02:05:30.141382 139861436241728 controller.py:261]  eval | step:  140000 | eval time:  503.7 sec | output: 
    {'3': {'avg_iou': 0.45524347,
           'avg_obj': 0.1340174,
           'box_loss': 0.011966161,
           'class_loss': 0.004554254,
           'conf_loss': 0.018843014,
           'precision50': 0.30342,
           'recall50': 0.09376369},
     '4': {'avg_iou': 0.65353185,
           'avg_obj': 0.27209634,
           'box_loss': 0.012326878,
           'class_loss': 0.004911847,
           'conf_loss': 0.01753405,
           'precision50': 0.5509604,
           'recall50': 0.23936626},
     '5': {'avg_iou': 0.7176155,
           'avg_obj': 0.38668835,
           'box_loss': 0.012002028,
           'class_loss': 0.0050448533,
           'conf_loss': 0.014422462,
           'precision50': 0.67526823,
           'recall50': 0.38148156},
     'AP': 0.25708866,
     'AP50': 0.4465154,
     'AP75': 0.26038653,
     'APl': 0.3677242,
     'APm': 0.25648603,
     'APs': 0.09903679,
     'ARl': 0.58992964,
     'ARm': 0.47737366,
     'ARmax1': 0.24529241,
     'ARmax10': 0.4072249,
     'ARmax100': 0.452355,
     'ARs': 0.24141538,
     'global': {'total_loss': 0.10160561},
     'validation_loss': 0.10160561}

train | step:  100000 | training until step 120000...
train | step:  110000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.57903683,
           'avg_obj': 0.15035181,
           'box_loss': 0.1364307,
           'class_loss': 0.07143552,
           'conf_loss': 0.17576094,
           'precision50': 0.30881703,
           'recall50': 0.062359504},
     '4': {'avg_iou': 0.6850601,
           'avg_obj': 0.26502225,
           'box_loss': 0.11651782,
           'class_loss': 0.0675545,
           'conf_loss': 0.15869772,
           'precision50': 0.573904,
           'recall50': 0.19686407},
     '5': {'avg_iou': 0.731169,
           'avg_obj': 0.37502405,
           'box_loss': 0.10542881,
           'class_loss': 0.0633725,
           'conf_loss': 0.09972421,
           'precision50': 0.66987133,
           'recall50': 0.34804097},
     'global': {'total_loss': 0.9949206},
     'learning_rate': 0.008378533,
     'training_loss': 0.9949206}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-110000.
train | step:  120000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5825152,
           'avg_obj': 0.15563338,
           'box_loss': 0.1350995,
           'class_loss': 0.06948952,
           'conf_loss': 0.17509568,
           'precision50': 0.31958702,
           'recall50': 0.06649763},
     '4': {'avg_iou': 0.68917817,
           'avg_obj': 0.27222106,
           'box_loss': 0.114863954,
           'class_loss': 0.06521205,
           'conf_loss': 0.1574812,
           'precision50': 0.58318484,
           'recall50': 0.20566621},
     '5': {'avg_iou': 0.73538357,
           'avg_obj': 0.38320267,
           'box_loss': 0.103712745,
           'class_loss': 0.061251488,
           'conf_loss': 0.09867967,
           'precision50': 0.677071,
           'recall50': 0.35967547},
     'global': {'total_loss': 0.9808868},
     'learning_rate': 0.008097229,
     'training_loss': 0.9808868}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-120000.
 eval | step:  120000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=173.96s).
Accumulating evaluation results...
DONE (t=19.04s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.243
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.429
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.244
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.094
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.240
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.349
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.236
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.394
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.439
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.228
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.463
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.574
 eval | step:  120000 | eval time:  499.8 sec | output: 
    {'3': {'avg_iou': 0.45134303,
           'avg_obj': 0.12783441,
           'box_loss': 0.012166773,
           'class_loss': 0.0047853733,
           'conf_loss': 0.019017477,
           'precision50': 0.28641415,
           'recall50': 0.08536686},
     '4': {'avg_iou': 0.64884907,
           'avg_obj': 0.2617195,
           'box_loss': 0.012570644,
           'class_loss': 0.0052007646,
           'conf_loss': 0.017772026,
           'precision50': 0.53396374,
           'recall50': 0.22484885},
     '5': {'avg_iou': 0.7123717,
           'avg_obj': 0.37358126,
           'box_loss': 0.012276731,
           'class_loss': 0.0053243972,
           'conf_loss': 0.014734189,
           'precision50': 0.66639256,
           'recall50': 0.36317018},
     'AP': 0.24280092,
     'AP50': 0.42929548,
     'AP75': 0.24414198,
     'APl': 0.34871846,
     'APm': 0.24008013,
     'APs': 0.09371244,
     'ARl': 0.5744698,
     'ARm': 0.4625442,
     'ARmax1': 0.23591386,
     'ARmax10': 0.39402792,
     'ARmax100': 0.43853384,
     'ARs': 0.22765301,
     'global': {'total_loss': 0.10384839},
     'validation_loss': 0.10384839}
train | step:  120000 | training until step 140000...
train | step:  130000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5860092,
           'avg_obj': 0.1605308,
           'box_loss': 0.13403873,
           'class_loss': 0.06799943,
           'conf_loss': 0.17388836,
           'precision50': 0.32893673,
           'recall50': 0.07039095},
     '4': {'avg_iou': 0.6926603,
           'avg_obj': 0.27822268,
           'box_loss': 0.11352821,
           'class_loss': 0.06342897,
           'conf_loss': 0.15625738,
           'precision50': 0.5907522,
           'recall50': 0.2141171},
     '5': {'avg_iou': 0.7387788,
           'avg_obj': 0.38978544,
           'box_loss': 0.10220678,
           'class_loss': 0.059495833,
           'conf_loss': 0.097951196,
           'precision50': 0.68289614,
           'recall50': 0.3695709},
     'global': {'total_loss': 0.9687955},
     'learning_rate': 0.007800815,
     'training_loss': 0.9687955}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-130000.
train | step:  140000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.58904177,
           'avg_obj': 0.16465357,
           'box_loss': 0.13292648,
           'class_loss': 0.066399366,
           'conf_loss': 0.17261238,
           'precision50': 0.3372386,
           'recall50': 0.07390799},
     '4': {'avg_iou': 0.69584715,
           'avg_obj': 0.28388566,
           'box_loss': 0.1122173,
           'class_loss': 0.061422307,
           'conf_loss': 0.15500975,
           'precision50': 0.5971063,
           'recall50': 0.22154939},
     '5': {'avg_iou': 0.74177516,
           'avg_obj': 0.39576796,
           'box_loss': 0.10102854,
           'class_loss': 0.057633936,
           'conf_loss': 0.09702908,
           'precision50': 0.68633044,
           'recall50': 0.3772636},
     'global': {'total_loss': 0.9562787},
     'learning_rate': 0.007491425,
     'training_loss': 0.9562787}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-140000.
 eval | step:  140000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=171.91s).
Accumulating evaluation results...
DONE (t=18.48s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.257
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.447
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.260
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.099
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.256
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.368
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.245
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.407
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.452
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.241
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.477
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.590
 eval | step:  140000 | eval time:  503.7 sec | output: 
    {'3': {'avg_iou': 0.45524347,
           'avg_obj': 0.1340174,
           'box_loss': 0.011966161,
           'class_loss': 0.004554254,
           'conf_loss': 0.018843014,
           'precision50': 0.30342,
           'recall50': 0.09376369},
     '4': {'avg_iou': 0.65353185,
           'avg_obj': 0.27209634,
           'box_loss': 0.012326878,
           'class_loss': 0.004911847,
           'conf_loss': 0.01753405,
           'precision50': 0.5509604,
           'recall50': 0.23936626},
     '5': {'avg_iou': 0.7176155,
           'avg_obj': 0.38668835,
           'box_loss': 0.012002028,
           'class_loss': 0.0050448533,
           'conf_loss': 0.014422462,
           'precision50': 0.67526823,
           'recall50': 0.38148156},
     'AP': 0.25708866,
     'AP50': 0.4465154,
     'AP75': 0.26038653,
     'APl': 0.3677242,
     'APm': 0.25648603,
     'APs': 0.09903679,
     'ARl': 0.58992964,
     'ARm': 0.47737366,
     'ARmax1': 0.24529241,
     'ARmax10': 0.4072249,
     'ARmax100': 0.452355,
     'ARs': 0.24141538,
     'global': {'total_loss': 0.10160561},
     'validation_loss': 0.10160561}I0521 02:05:51.384153 139861436241728 controller.py:211] train | step:  140000 | training until step 160000...
I0521 03:35:02.324936 139861436241728 controller.py:425] train | step:  150000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5919863,
           'avg_obj': 0.1687873,
           'box_loss': 0.13197385,
           'class_loss': 0.06504159,
           'conf_loss': 0.17190933,
           'precision50': 0.345023,
           'recall50': 0.07741735},
     '4': {'avg_iou': 0.69863087,
           'avg_obj': 0.2892182,
           'box_loss': 0.11107506,
           'class_loss': 0.059946038,
           'conf_loss': 0.15420361,
           'precision50': 0.60454196,
           'recall50': 0.22883576},
     '5': {'avg_iou': 0.744827,
           'avg_obj': 0.40199986,
           'box_loss': 0.099690616,
           'class_loss': 0.056082275,
           'conf_loss': 0.09630609,
           'precision50': 0.69185334,
           'recall50': 0.38594016},
     'global': {'total_loss': 0.9462277},
     'learning_rate': 0.007171291,
     'training_loss': 0.9462277}
I0521 03:36:05.461085 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-150000.
I0521 05:09:15.886632 139861436241728 controller.py:425] train | step:  160000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5945203,
           'avg_obj': 0.17265256,
           'box_loss': 0.13111264,
           'class_loss': 0.063522965,
           'conf_loss': 0.17084561,
           'precision50': 0.35207796,
           'recall50': 0.08083449},
     '4': {'avg_iou': 0.70154446,
           'avg_obj': 0.2944924,
           'box_loss': 0.109814525,
           'class_loss': 0.058136567,
           'conf_loss': 0.15298337,
           'precision50': 0.6096498,
           'recall50': 0.23567356},
     '5': {'avg_iou': 0.7475064,
           'avg_obj': 0.40761924,
           'box_loss': 0.09859483,
           'class_loss': 0.05456842,
           'conf_loss': 0.095557034,
           'precision50': 0.69621134,
           'recall50': 0.3937092},
     'global': {'total_loss': 0.93513954},
     'learning_rate': 0.0068427175,
     'training_loss': 0.93513954}
I0521 05:10:14.704893 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-160000.
I0521 05:10:14.712460 139861436241728 controller.py:252]  eval | step:  160000 | running 625 steps of evaluation...
I0521 05:14:46.409309 139861436241728 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0521 05:19:01.037427 139861436241728 controller.py:261]  eval | step:  160000 | eval time:  526.3 sec | output: 
    {'3': {'avg_iou': 0.45827797,
           'avg_obj': 0.13912028,
           'box_loss': 0.011809462,
           'class_loss': 0.0043863845,
           'conf_loss': 0.018699337,
           'precision50': 0.31175745,
           'recall50': 0.09992679},
     '4': {'avg_iou': 0.65705144,
           'avg_obj': 0.2811278,
           'box_loss': 0.012143306,
           'class_loss': 0.0047066235,
           'conf_loss': 0.01730243,
           'precision50': 0.559508,
           'recall50': 0.25207376},
     '5': {'avg_iou': 0.721399,
           'avg_obj': 0.39720845,
           'box_loss': 0.011801151,
           'class_loss': 0.0048476434,
           'conf_loss': 0.014169626,
           'precision50': 0.6865606,
           'recall50': 0.39753503},
     'AP': 0.2653116,
     'AP50': 0.46179223,
     'AP75': 0.27054822,
     'APl': 0.3812005,
     'APm': 0.2669203,
     'APs': 0.10057905,
     'ARl': 0.5937295,
     'ARm': 0.48485395,
     'ARmax1': 0.24973544,
     'ARmax10': 0.41319975,
     'ARmax100': 0.45805722,
     'ARs': 0.24863824,
     'global': {'total_loss': 0.09986598},
     'validation_loss': 0.09986598}
I0521 05:19:18.549851 139861436241728 controller.py:211] train | step:  160000 | training until step 180000...
I0521 06:44:25.270399 139861436241728 controller.py:425] train | step:  170000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.59673125,
           'avg_obj': 0.17652375,
           'box_loss': 0.13027692,
           'class_loss': 0.062230263,
           'conf_loss': 0.17026359,
           'precision50': 0.35936472,
           'recall50': 0.08420255},
     '4': {'avg_iou': 0.70405364,
           'avg_obj': 0.29918036,
           'box_loss': 0.108938456,
           'class_loss': 0.05681352,
           'conf_loss': 0.15217958,
           'precision50': 0.6141553,
           'recall50': 0.2418165},
     '5': {'avg_iou': 0.7501149,
           'avg_obj': 0.4123642,
           'box_loss': 0.097588226,
           'class_loss': 0.053324018,
           'conf_loss': 0.09488791,
           'precision50': 0.69939065,
           'recall50': 0.40075734},
     'global': {'total_loss': 0.9265022},
     'learning_rate': 0.0065080714,
     'training_loss': 0.9265022}
I0521 06:45:25.740258 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-170000.
I0521 08:17:56.756082 139861436241728 controller.py:425] train | step:  180000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5990434,
           'avg_obj': 0.17951414,
           'box_loss': 0.12953474,
           'class_loss': 0.061097566,
           'conf_loss': 0.16937093,
           'precision50': 0.3640364,
           'recall50': 0.08671048},
     '4': {'avg_iou': 0.7062431,
           'avg_obj': 0.30321306,
           'box_loss': 0.10794,
           'class_loss': 0.05548225,
           'conf_loss': 0.151276,
           'precision50': 0.6186995,
           'recall50': 0.24733286},
     '5': {'avg_iou': 0.7525132,
           'avg_obj': 0.41711357,
           'box_loss': 0.09644586,
           'class_loss': 0.0520838,
           'conf_loss': 0.09436646,
           'precision50': 0.70309746,
           'recall50': 0.40687212},
     'global': {'total_loss': 0.9175967},
     'learning_rate': 0.0061697643,
     'training_loss': 0.9175967}
I0521 08:18:55.677693 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-180000.
I0521 08:18:55.683247 139861436241728 controller.py:252]  eval | step:  180000 | running 625 steps of evaluation...
I0521 08:23:06.140697 139861436241728 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0521 08:27:16.911237 139861436241728 controller.py:261]  eval | step:  180000 | eval time:  501.2 sec | output: 
    {'3': {'avg_iou': 0.4568392,
           'avg_obj': 0.13400461,
           'box_loss': 0.011884471,
           'class_loss': 0.0046951827,
           'conf_loss': 0.019286998,
           'precision50': 0.30654213,
           'recall50': 0.096326426},
     '4': {'avg_iou': 0.64830923,
           'avg_obj': 0.2661575,
           'box_loss': 0.012595719,
           'class_loss': 0.0052312105,
           'conf_loss': 0.018796226,
           'precision50': 0.54350877,
           'recall50': 0.23691209},
     '5': {'avg_iou': 0.7053144,
           'avg_obj': 0.3719714,
           'box_loss': 0.012640521,
           'class_loss': 0.008353185,
           'conf_loss': 0.015113293,
           'precision50': 0.66421276,
           'recall50': 0.36540836},
     'AP': 0.2567942,
     'AP50': 0.4491078,
     'AP75': 0.25614858,
     'APl': 0.36303085,
     'APm': 0.2590419,
     'APs': 0.102236874,
     'ARl': 0.57694626,
     'ARm': 0.46829897,
     'ARmax1': 0.2414285,
     'ARmax10': 0.40154016,
     'ARmax100': 0.44481876,
     'ARs': 0.2467541,
     'global': {'total_loss': 0.108596765},
     'validation_loss': 0.108596765}

train | step:  140000 | training until step 160000...
train | step:  150000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.5919863,
           'avg_obj': 0.1687873,
           'box_loss': 0.13197385,
           'class_loss': 0.06504159,
           'conf_loss': 0.17190933,
           'precision50': 0.345023,
           'recall50': 0.07741735},
     '4': {'avg_iou': 0.69863087,
           'avg_obj': 0.2892182,
           'box_loss': 0.11107506,
           'class_loss': 0.059946038,
           'conf_loss': 0.15420361,
           'precision50': 0.60454196,
           'recall50': 0.22883576},
     '5': {'avg_iou': 0.744827,
           'avg_obj': 0.40199986,
           'box_loss': 0.099690616,
           'class_loss': 0.056082275,
           'conf_loss': 0.09630609,
           'precision50': 0.69185334,
           'recall50': 0.38594016},
     'global': {'total_loss': 0.9462277},
     'learning_rate': 0.007171291,
     'training_loss': 0.9462277}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-150000.
train | step:  160000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5945203,
           'avg_obj': 0.17265256,
           'box_loss': 0.13111264,
           'class_loss': 0.063522965,
           'conf_loss': 0.17084561,
           'precision50': 0.35207796,
           'recall50': 0.08083449},
     '4': {'avg_iou': 0.70154446,
           'avg_obj': 0.2944924,
           'box_loss': 0.109814525,
           'class_loss': 0.058136567,
           'conf_loss': 0.15298337,
           'precision50': 0.6096498,
           'recall50': 0.23567356},
     '5': {'avg_iou': 0.7475064,
           'avg_obj': 0.40761924,
           'box_loss': 0.09859483,
           'class_loss': 0.05456842,
           'conf_loss': 0.095557034,
           'precision50': 0.69621134,
           'recall50': 0.3937092},
     'global': {'total_loss': 0.93513954},
     'learning_rate': 0.0068427175,
     'training_loss': 0.93513954}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-160000.
 eval | step:  160000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=177.65s).
Accumulating evaluation results...
DONE (t=18.59s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.265
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.462
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.271
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.101
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.267
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.381
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.250
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.413
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.458
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.249
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.594
 eval | step:  160000 | eval time:  526.3 sec | output: 
    {'3': {'avg_iou': 0.45827797,
           'avg_obj': 0.13912028,
           'box_loss': 0.011809462,
           'class_loss': 0.0043863845,
           'conf_loss': 0.018699337,
           'precision50': 0.31175745,
           'recall50': 0.09992679},
     '4': {'avg_iou': 0.65705144,
           'avg_obj': 0.2811278,
           'box_loss': 0.012143306,
           'class_loss': 0.0047066235,
           'conf_loss': 0.01730243,
           'precision50': 0.559508,
           'recall50': 0.25207376},
     '5': {'avg_iou': 0.721399,
           'avg_obj': 0.39720845,
           'box_loss': 0.011801151,
           'class_loss': 0.0048476434,
           'conf_loss': 0.014169626,
           'precision50': 0.6865606,
           'recall50': 0.39753503},
     'AP': 0.2653116,
     'AP50': 0.46179223,
     'AP75': 0.27054822,
     'APl': 0.3812005,
     'APm': 0.2669203,
     'APs': 0.10057905,
     'ARl': 0.5937295,
     'ARm': 0.48485395,
     'ARmax1': 0.24973544,
     'ARmax10': 0.41319975,
     'ARmax100': 0.45805722,
     'ARs': 0.24863824,
     'global': {'total_loss': 0.09986598},
     'validation_loss': 0.09986598}
train | step:  160000 | training until step 180000...
train | step:  170000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.59673125,
           'avg_obj': 0.17652375,
           'box_loss': 0.13027692,
           'class_loss': 0.062230263,
           'conf_loss': 0.17026359,
           'precision50': 0.35936472,
           'recall50': 0.08420255},
     '4': {'avg_iou': 0.70405364,
           'avg_obj': 0.29918036,
           'box_loss': 0.108938456,
           'class_loss': 0.05681352,
           'conf_loss': 0.15217958,
           'precision50': 0.6141553,
           'recall50': 0.2418165},
     '5': {'avg_iou': 0.7501149,
           'avg_obj': 0.4123642,
           'box_loss': 0.097588226,
           'class_loss': 0.053324018,
           'conf_loss': 0.09488791,
           'precision50': 0.69939065,
           'recall50': 0.40075734},
     'global': {'total_loss': 0.9265022},
     'learning_rate': 0.0065080714,
     'training_loss': 0.9265022}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-170000.
train | step:  180000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.5990434,
           'avg_obj': 0.17951414,
           'box_loss': 0.12953474,
           'class_loss': 0.061097566,
           'conf_loss': 0.16937093,
           'precision50': 0.3640364,
           'recall50': 0.08671048},
     '4': {'avg_iou': 0.7062431,
           'avg_obj': 0.30321306,
           'box_loss': 0.10794,
           'class_loss': 0.05548225,
           'conf_loss': 0.151276,
           'precision50': 0.6186995,
           'recall50': 0.24733286},
     '5': {'avg_iou': 0.7525132,
           'avg_obj': 0.41711357,
           'box_loss': 0.09644586,
           'class_loss': 0.0520838,
           'conf_loss': 0.09436646,
           'precision50': 0.70309746,
           'recall50': 0.40687212},
     'global': {'total_loss': 0.9175967},
     'learning_rate': 0.0061697643,
     'training_loss': 0.9175967}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-180000.
 eval | step:  180000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=172.50s).
Accumulating evaluation results...
DONE (t=19.42s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.257
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.449
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.256
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.102
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.259
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.363
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.241
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.402
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.445
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.247
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.468
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.577
 eval | step:  180000 | eval time:  501.2 sec | output: 
    {'3': {'avg_iou': 0.4568392,
           'avg_obj': 0.13400461,
           'box_loss': 0.011884471,
           'class_loss': 0.0046951827,
           'conf_loss': 0.019286998,
           'precision50': 0.30654213,
           'recall50': 0.096326426},
     '4': {'avg_iou': 0.64830923,
           'avg_obj': 0.2661575,
           'box_loss': 0.012595719,
           'class_loss': 0.0052312105,
           'conf_loss': 0.018796226,
           'precision50': 0.54350877,
           'recall50': 0.23691209},
     '5': {'avg_iou': 0.7053144,
           'avg_obj': 0.3719714,
           'box_loss': 0.012640521,
           'class_loss': 0.008353185,
           'conf_loss': 0.015113293,
           'precision50': 0.66421276,
           'recall50': 0.36540836},
     'AP': 0.2567942,
     'AP50': 0.4491078,
     'AP75': 0.25614858,
     'APl': 0.36303085,
     'APm': 0.2590419,
     'APs': 0.102236874,
     'ARl': 0.57694626,
     'ARm': 0.46829897,
     'ARmax1': 0.2414285,
     'ARmax10': 0.40154016,
     'ARmax100': 0.44481876,
     'ARs': 0.2467541,
     'global': {'total_loss': 0.108596765},
     'validation_loss': 0.108596765}I0521 08:27:41.010271 139861436241728 controller.py:211] train | step:  180000 | training until step 200000...
I0521 09:51:47.341198 139861436241728 controller.py:425] train | step:  190000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6010343,
           'avg_obj': 0.18261847,
           'box_loss': 0.12879866,
           'class_loss': 0.06009718,
           'conf_loss': 0.16876936,
           'precision50': 0.3707677,
           'recall50': 0.089882724},
     '4': {'avg_iou': 0.70861906,
           'avg_obj': 0.3079509,
           'box_loss': 0.10712488,
           'class_loss': 0.054345734,
           'conf_loss': 0.15062147,
           'precision50': 0.62387735,
           'recall50': 0.25344655},
     '5': {'avg_iou': 0.7545759,
           'avg_obj': 0.42158866,
           'box_loss': 0.09575654,
           'class_loss': 0.051016435,
           'conf_loss': 0.093874045,
           'precision50': 0.7069752,
           'recall50': 0.41316822},
     'global': {'total_loss': 0.91040194},
     'learning_rate': 0.0058302353,
     'training_loss': 0.91040194}
I0521 09:52:45.455337 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-190000.
I0521 11:22:40.373143 139861436241728 controller.py:425] train | step:  200000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6026948,
           'avg_obj': 0.18580331,
           'box_loss': 0.12839873,
           'class_loss': 0.059256874,
           'conf_loss': 0.16815211,
           'precision50': 0.37558085,
           'recall50': 0.09241442},
     '4': {'avg_iou': 0.71066624,
           'avg_obj': 0.31162992,
           'box_loss': 0.10632095,
           'class_loss': 0.05321772,
           'conf_loss': 0.14988524,
           'precision50': 0.6273179,
           'recall50': 0.25833625},
     '5': {'avg_iou': 0.7568944,
           'avg_obj': 0.4262667,
           'box_loss': 0.09476604,
           'class_loss': 0.049895022,
           'conf_loss': 0.09328662,
           'precision50': 0.70981646,
           'recall50': 0.41940346},
     'global': {'total_loss': 0.9031779},
     'learning_rate': 0.005491929,
     'training_loss': 0.9031779}
I0521 11:23:40.048739 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-200000.
I0521 11:23:40.055238 139861436241728 controller.py:252]  eval | step:  200000 | running 625 steps of evaluation...
I0521 11:27:55.710031 139861436241728 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0521 11:32:15.738670 139861436241728 controller.py:261]  eval | step:  200000 | eval time:  515.7 sec | output: 
    {'3': {'avg_iou': 0.46295688,
           'avg_obj': 0.14746737,
           'box_loss': 0.0115651665,
           'class_loss': 0.0041652913,
           'conf_loss': 0.018558398,
           'precision50': 0.32917985,
           'recall50': 0.10963733},
     '4': {'avg_iou': 0.66317326,
           'avg_obj': 0.2948257,
           'box_loss': 0.011826958,
           'class_loss': 0.0044231853,
           'conf_loss': 0.017119031,
           'precision50': 0.575052,
           'recall50': 0.27237836},
     '5': {'avg_iou': 0.72797596,
           'avg_obj': 0.41374537,
           'box_loss': 0.0114571545,
           'class_loss': 0.004546489,
           'conf_loss': 0.013918647,
           'precision50': 0.6925037,
           'recall50': 0.41860864},
     'AP': 0.28199723,
     'AP50': 0.4807576,
     'AP75': 0.28552014,
     'APl': 0.39729556,
     'APm': 0.2833195,
     'APs': 0.11136942,
     'ARl': 0.60582155,
     'ARm': 0.49858204,
     'ARmax1': 0.25772035,
     'ARmax10': 0.42564476,
     'ARmax100': 0.4706153,
     'ARs': 0.26106614,
     'global': {'total_loss': 0.097580366},
     'validation_loss': 0.097580366}
I0521 11:32:40.988633 139861436241728 controller.py:211] train | step:  200000 | training until step 220000...
I0521 12:56:03.772523 139861436241728 controller.py:425] train | step:  210000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6048166,
           'avg_obj': 0.1886804,
           'box_loss': 0.12746784,
           'class_loss': 0.058220696,
           'conf_loss': 0.16730636,
           'precision50': 0.37926936,
           'recall50': 0.09483654},
     '4': {'avg_iou': 0.71279055,
           'avg_obj': 0.3156681,
           'box_loss': 0.10537622,
           'class_loss': 0.052187428,
           'conf_loss': 0.14909573,
           'precision50': 0.63153857,
           'recall50': 0.26407483},
     '5': {'avg_iou': 0.7587304,
           'avg_obj': 0.4299559,
           'box_loss': 0.093991466,
           'class_loss': 0.048935033,
           'conf_loss': 0.092720754,
           'precision50': 0.71181905,
           'recall50': 0.4239797},
     'global': {'total_loss': 0.89530236},
     'learning_rate': 0.005157283,
     'training_loss': 0.89530236}
I0521 12:57:02.347153 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-210000.
I0521 14:26:47.827765 139861436241728 controller.py:425] train | step:  220000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6064057,
           'avg_obj': 0.19148399,
           'box_loss': 0.1269968,
           'class_loss': 0.05732313,
           'conf_loss': 0.16668567,
           'precision50': 0.38483146,
           'recall50': 0.09752344},
     '4': {'avg_iou': 0.71432936,
           'avg_obj': 0.31887612,
           'box_loss': 0.10479614,
           'class_loss': 0.05113663,
           'conf_loss': 0.14838757,
           'precision50': 0.6346205,
           'recall50': 0.26818764},
     '5': {'avg_iou': 0.7605613,
           'avg_obj': 0.43391383,
           'box_loss': 0.09318929,
           'class_loss': 0.04803734,
           'conf_loss': 0.09217995,
           'precision50': 0.7145565,
           'recall50': 0.42989093},
     'global': {'total_loss': 0.88873273},
     'learning_rate': 0.0048287087,
     'training_loss': 0.88873273}
I0521 14:27:49.113879 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-220000.
I0521 14:27:49.119499 139861436241728 controller.py:252]  eval | step:  220000 | running 625 steps of evaluation...
I0521 14:32:02.480874 139861436241728 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0521 14:36:08.993778 139861436241728 controller.py:261]  eval | step:  220000 | eval time:  499.9 sec | output: 
    {'3': {'avg_iou': 0.4646357,
           'avg_obj': 0.15049145,
           'box_loss': 0.011476688,
           'class_loss': 0.00410785,
           'conf_loss': 0.018497724,
           'precision50': 0.33583596,
           'recall50': 0.113898925},
     '4': {'avg_iou': 0.6649022,
           'avg_obj': 0.29973847,
           'box_loss': 0.011735843,
           'class_loss': 0.004330398,
           'conf_loss': 0.017027143,
           'precision50': 0.5793046,
           'recall50': 0.27916077},
     '5': {'avg_iou': 0.73031837,
           'avg_obj': 0.41930684,
           'box_loss': 0.011335713,
           'class_loss': 0.0044642044,
           'conf_loss': 0.013840513,
           'precision50': 0.6984373,
           'recall50': 0.4270506},
     'AP': 0.28704917,
     'AP50': 0.4881654,
     'AP75': 0.29405287,
     'APl': 0.40599263,
     'APm': 0.28988916,
     'APs': 0.11475819,
     'ARl': 0.61112493,
     'ARm': 0.5010957,
     'ARmax1': 0.2586776,
     'ARmax10': 0.43031105,
     'ARmax100': 0.47544038,
     'ARs': 0.26981926,
     'global': {'total_loss': 0.096816055},
     'validation_loss': 0.096816055}

train | step:  180000 | training until step 200000...
train | step:  190000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6010343,
           'avg_obj': 0.18261847,
           'box_loss': 0.12879866,
           'class_loss': 0.06009718,
           'conf_loss': 0.16876936,
           'precision50': 0.3707677,
           'recall50': 0.089882724},
     '4': {'avg_iou': 0.70861906,
           'avg_obj': 0.3079509,
           'box_loss': 0.10712488,
           'class_loss': 0.054345734,
           'conf_loss': 0.15062147,
           'precision50': 0.62387735,
           'recall50': 0.25344655},
     '5': {'avg_iou': 0.7545759,
           'avg_obj': 0.42158866,
           'box_loss': 0.09575654,
           'class_loss': 0.051016435,
           'conf_loss': 0.093874045,
           'precision50': 0.7069752,
           'recall50': 0.41316822},
     'global': {'total_loss': 0.91040194},
     'learning_rate': 0.0058302353,
     'training_loss': 0.91040194}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-190000.
train | step:  200000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6026948,
           'avg_obj': 0.18580331,
           'box_loss': 0.12839873,
           'class_loss': 0.059256874,
           'conf_loss': 0.16815211,
           'precision50': 0.37558085,
           'recall50': 0.09241442},
     '4': {'avg_iou': 0.71066624,
           'avg_obj': 0.31162992,
           'box_loss': 0.10632095,
           'class_loss': 0.05321772,
           'conf_loss': 0.14988524,
           'precision50': 0.6273179,
           'recall50': 0.25833625},
     '5': {'avg_iou': 0.7568944,
           'avg_obj': 0.4262667,
           'box_loss': 0.09476604,
           'class_loss': 0.049895022,
           'conf_loss': 0.09328662,
           'precision50': 0.70981646,
           'recall50': 0.41940346},
     'global': {'total_loss': 0.9031779},
     'learning_rate': 0.005491929,
     'training_loss': 0.9031779}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-200000.
 eval | step:  200000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=183.23s).
Accumulating evaluation results...
DONE (t=17.56s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.282
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.481
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.286
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.111
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.283
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.397
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.258
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.426
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.471
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.261
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.499
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.606
 eval | step:  200000 | eval time:  515.7 sec | output: 
    {'3': {'avg_iou': 0.46295688,
           'avg_obj': 0.14746737,
           'box_loss': 0.0115651665,
           'class_loss': 0.0041652913,
           'conf_loss': 0.018558398,
           'precision50': 0.32917985,
           'recall50': 0.10963733},
     '4': {'avg_iou': 0.66317326,
           'avg_obj': 0.2948257,
           'box_loss': 0.011826958,
           'class_loss': 0.0044231853,
           'conf_loss': 0.017119031,
           'precision50': 0.575052,
           'recall50': 0.27237836},
     '5': {'avg_iou': 0.72797596,
           'avg_obj': 0.41374537,
           'box_loss': 0.0114571545,
           'class_loss': 0.004546489,
           'conf_loss': 0.013918647,
           'precision50': 0.6925037,
           'recall50': 0.41860864},
     'AP': 0.28199723,
     'AP50': 0.4807576,
     'AP75': 0.28552014,
     'APl': 0.39729556,
     'APm': 0.2833195,
     'APs': 0.11136942,
     'ARl': 0.60582155,
     'ARm': 0.49858204,
     'ARmax1': 0.25772035,
     'ARmax10': 0.42564476,
     'ARmax100': 0.4706153,
     'ARs': 0.26106614,
     'global': {'total_loss': 0.097580366},
     'validation_loss': 0.097580366}
train | step:  200000 | training until step 220000...
train | step:  210000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6048166,
           'avg_obj': 0.1886804,
           'box_loss': 0.12746784,
           'class_loss': 0.058220696,
           'conf_loss': 0.16730636,
           'precision50': 0.37926936,
           'recall50': 0.09483654},
     '4': {'avg_iou': 0.71279055,
           'avg_obj': 0.3156681,
           'box_loss': 0.10537622,
           'class_loss': 0.052187428,
           'conf_loss': 0.14909573,
           'precision50': 0.63153857,
           'recall50': 0.26407483},
     '5': {'avg_iou': 0.7587304,
           'avg_obj': 0.4299559,
           'box_loss': 0.093991466,
           'class_loss': 0.048935033,
           'conf_loss': 0.092720754,
           'precision50': 0.71181905,
           'recall50': 0.4239797},
     'global': {'total_loss': 0.89530236},
     'learning_rate': 0.005157283,
     'training_loss': 0.89530236}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-210000.
train | step:  220000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6064057,
           'avg_obj': 0.19148399,
           'box_loss': 0.1269968,
           'class_loss': 0.05732313,
           'conf_loss': 0.16668567,
           'precision50': 0.38483146,
           'recall50': 0.09752344},
     '4': {'avg_iou': 0.71432936,
           'avg_obj': 0.31887612,
           'box_loss': 0.10479614,
           'class_loss': 0.05113663,
           'conf_loss': 0.14838757,
           'precision50': 0.6346205,
           'recall50': 0.26818764},
     '5': {'avg_iou': 0.7605613,
           'avg_obj': 0.43391383,
           'box_loss': 0.09318929,
           'class_loss': 0.04803734,
           'conf_loss': 0.09217995,
           'precision50': 0.7145565,
           'recall50': 0.42989093},
     'global': {'total_loss': 0.88873273},
     'learning_rate': 0.0048287087,
     'training_loss': 0.88873273}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-220000.
 eval | step:  220000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=175.21s).
Accumulating evaluation results...
DONE (t=17.38s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.287
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.488
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.294
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.115
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.290
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.406
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.259
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.430
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.475
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.270
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.501
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.611
 eval | step:  220000 | eval time:  499.9 sec | output: 
    {'3': {'avg_iou': 0.4646357,
           'avg_obj': 0.15049145,
           'box_loss': 0.011476688,
           'class_loss': 0.00410785,
           'conf_loss': 0.018497724,
           'precision50': 0.33583596,
           'recall50': 0.113898925},
     '4': {'avg_iou': 0.6649022,
           'avg_obj': 0.29973847,
           'box_loss': 0.011735843,
           'class_loss': 0.004330398,
           'conf_loss': 0.017027143,
           'precision50': 0.5793046,
           'recall50': 0.27916077},
     '5': {'avg_iou': 0.73031837,
           'avg_obj': 0.41930684,
           'box_loss': 0.011335713,
           'class_loss': 0.0044642044,
           'conf_loss': 0.013840513,
           'precision50': 0.6984373,
           'recall50': 0.4270506},
     'AP': 0.28704917,
     'AP50': 0.4881654,
     'AP75': 0.29405287,
     'APl': 0.40599263,
     'APm': 0.28988916,
     'APs': 0.11475819,
     'ARl': 0.61112493,
     'ARm': 0.5010957,
     'ARmax1': 0.2586776,
     'ARmax10': 0.43031105,
     'ARmax100': 0.47544038,
     'ARs': 0.26981926,
     'global': {'total_loss': 0.096816055},
     'validation_loss': 0.096816055}I0521 14:36:28.802926 139861436241728 controller.py:211] train | step:  220000 | training until step 240000...
I0521 15:59:48.856697 139861436241728 controller.py:425] train | step:  230000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6079616,
           'avg_obj': 0.19421163,
           'box_loss': 0.1264383,
           'class_loss': 0.05647257,
           'conf_loss': 0.16578937,
           'precision50': 0.38867941,
           'recall50': 0.0998057},
     '4': {'avg_iou': 0.71618927,
           'avg_obj': 0.3221274,
           'box_loss': 0.104116835,
           'class_loss': 0.050222423,
           'conf_loss': 0.1476814,
           'precision50': 0.63869685,
           'recall50': 0.2726092},
     '5': {'avg_iou': 0.7621581,
           'avg_obj': 0.43678027,
           'box_loss': 0.092519425,
           'class_loss': 0.04716372,
           'conf_loss': 0.09182288,
           'precision50': 0.7168201,
           'recall50': 0.4335604},
     'global': {'total_loss': 0.8822266},
     'learning_rate': 0.004508574,
     'training_loss': 0.8822266}
I0521 16:00:47.541867 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-230000.
I0521 17:28:59.965255 139861436241728 controller.py:425] train | step:  240000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6095242,
           'avg_obj': 0.19696738,
           'box_loss': 0.12603065,
           'class_loss': 0.055631947,
           'conf_loss': 0.16598108,
           'precision50': 0.39397174,
           'recall50': 0.10251211},
     '4': {'avg_iou': 0.71765727,
           'avg_obj': 0.32556656,
           'box_loss': 0.103486575,
           'class_loss': 0.04935995,
           'conf_loss': 0.1473749,
           'precision50': 0.64173245,
           'recall50': 0.2770528},
     '5': {'avg_iou': 0.76394117,
           'avg_obj': 0.44087285,
           'box_loss': 0.09181483,
           'class_loss': 0.046404228,
           'conf_loss': 0.09135772,
           'precision50': 0.7193253,
           'recall50': 0.43885532},
     'global': {'total_loss': 0.8774409},
     'learning_rate': 0.0041991845,
     'training_loss': 0.8774409}
I0521 17:29:57.784203 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-240000.
I0521 17:29:57.790444 139861436241728 controller.py:252]  eval | step:  240000 | running 625 steps of evaluation...
I0521 17:34:15.495494 139861436241728 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0521 17:38:29.482314 139861436241728 controller.py:261]  eval | step:  240000 | eval time:  511.7 sec | output: 
    {'3': {'avg_iou': 0.46220982,
           'avg_obj': 0.14433336,
           'box_loss': 0.011606602,
           'class_loss': 0.004386227,
           'conf_loss': 0.019005494,
           'precision50': 0.33044112,
           'recall50': 0.11044055},
     '4': {'avg_iou': 0.6572422,
           'avg_obj': 0.28634205,
           'box_loss': 0.012134347,
           'class_loss': 0.0047227307,
           'conf_loss': 0.018956041,
           'precision50': 0.5619049,
           'recall50': 0.26597095},
     '5': {'avg_iou': 0.71987426,
           'avg_obj': 0.4016026,
           'box_loss': 0.01188001,
           'class_loss': 0.0061103376,
           'conf_loss': 0.014497821,
           'precision50': 0.683575,
           'recall50': 0.40705},
     'AP': 0.27759233,
     'AP50': 0.47471154,
     'AP75': 0.2812993,
     'APl': 0.3947696,
     'APm': 0.2794088,
     'APs': 0.11200502,
     'ARl': 0.6013881,
     'ARm': 0.4848002,
     'ARmax1': 0.25380486,
     'ARmax10': 0.41780767,
     'ARmax100': 0.46221498,
     'ARs': 0.25505143,
     'global': {'total_loss': 0.10329961},
     'validation_loss': 0.10329961}
I0521 17:38:47.814592 139861436241728 controller.py:211] train | step:  240000 | training until step 260000...
I0521 19:00:38.101047 139861436241728 controller.py:425] train | step:  250000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.61115706,
           'avg_obj': 0.19955286,
           'box_loss': 0.12551135,
           'class_loss': 0.054937616,
           'conf_loss': 0.16496685,
           'precision50': 0.3977042,
           'recall50': 0.105261825},
     '4': {'avg_iou': 0.7194164,
           'avg_obj': 0.3287116,
           'box_loss': 0.102832384,
           'class_loss': 0.048584953,
           'conf_loss': 0.14675698,
           'precision50': 0.6447774,
           'recall50': 0.28139368},
     '5': {'avg_iou': 0.7655798,
           'avg_obj': 0.4441061,
           'box_loss': 0.09113033,
           'class_loss': 0.045578472,
           'conf_loss': 0.09104899,
           'precision50': 0.72136986,
           'recall50': 0.44331878},
     'global': {'total_loss': 0.8713475},
     'learning_rate': 0.0039027706,
     'training_loss': 0.8713475}
I0521 19:01:36.031336 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-250000.
I0521 20:28:23.065494 139861436241728 controller.py:425] train | step:  260000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.61250806,
           'avg_obj': 0.20197293,
           'box_loss': 0.12501058,
           'class_loss': 0.05413058,
           'conf_loss': 0.16430484,
           'precision50': 0.40030563,
           'recall50': 0.10679382},
     '4': {'avg_iou': 0.7209087,
           'avg_obj': 0.33199364,
           'box_loss': 0.102256685,
           'class_loss': 0.04767088,
           'conf_loss': 0.1460216,
           'precision50': 0.6471632,
           'recall50': 0.28518802},
     '5': {'avg_iou': 0.7669273,
           'avg_obj': 0.447297,
           'box_loss': 0.09056867,
           'class_loss': 0.04480439,
           'conf_loss': 0.0905406,
           'precision50': 0.7236261,
           'recall50': 0.44767115},
     'global': {'total_loss': 0.8653096},
     'learning_rate': 0.0036214672,
     'training_loss': 0.8653096}
I0521 20:29:21.190772 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-260000.
I0521 20:29:21.197687 139861436241728 controller.py:252]  eval | step:  260000 | running 625 steps of evaluation...
I0521 20:33:32.708261 139861436241728 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0521 20:37:43.354666 139861436241728 controller.py:261]  eval | step:  260000 | eval time:  502.2 sec | output: 
    {'3': {'avg_iou': 0.467032,
           'avg_obj': 0.15570198,
           'box_loss': 0.011353028,
           'class_loss': 0.0039850753,
           'conf_loss': 0.018412905,
           'precision50': 0.3436217,
           'recall50': 0.12107314},
     '4': {'avg_iou': 0.667621,
           'avg_obj': 0.3093606,
           'box_loss': 0.011594366,
           'class_loss': 0.004212106,
           'conf_loss': 0.01692949,
           'precision50': 0.5866082,
           'recall50': 0.2924978},
     '5': {'avg_iou': 0.7338578,
           'avg_obj': 0.42960235,
           'box_loss': 0.011151252,
           'class_loss': 0.004345696,
           'conf_loss': 0.013774283,
           'precision50': 0.7042011,
           'recall50': 0.44012222},
     'AP': 0.29605466,
     'AP50': 0.5000582,
     'AP75': 0.30543035,
     'APl': 0.41849348,
     'APm': 0.29829845,
     'APs': 0.122633904,
     'ARl': 0.6174786,
     'ARm': 0.51365036,
     'ARmax1': 0.2643392,
     'ARmax10': 0.43980744,
     'ARmax100': 0.48529044,
     'ARs': 0.2743318,
     'global': {'total_loss': 0.0957582},
     'validation_loss': 0.0957582}

train | step:  220000 | training until step 240000...
train | step:  230000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6079616,
           'avg_obj': 0.19421163,
           'box_loss': 0.1264383,
           'class_loss': 0.05647257,
           'conf_loss': 0.16578937,
           'precision50': 0.38867941,
           'recall50': 0.0998057},
     '4': {'avg_iou': 0.71618927,
           'avg_obj': 0.3221274,
           'box_loss': 0.104116835,
           'class_loss': 0.050222423,
           'conf_loss': 0.1476814,
           'precision50': 0.63869685,
           'recall50': 0.2726092},
     '5': {'avg_iou': 0.7621581,
           'avg_obj': 0.43678027,
           'box_loss': 0.092519425,
           'class_loss': 0.04716372,
           'conf_loss': 0.09182288,
           'precision50': 0.7168201,
           'recall50': 0.4335604},
     'global': {'total_loss': 0.8822266},
     'learning_rate': 0.004508574,
     'training_loss': 0.8822266}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-230000.
train | step:  240000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6095242,
           'avg_obj': 0.19696738,
           'box_loss': 0.12603065,
           'class_loss': 0.055631947,
           'conf_loss': 0.16598108,
           'precision50': 0.39397174,
           'recall50': 0.10251211},
     '4': {'avg_iou': 0.71765727,
           'avg_obj': 0.32556656,
           'box_loss': 0.103486575,
           'class_loss': 0.04935995,
           'conf_loss': 0.1473749,
           'precision50': 0.64173245,
           'recall50': 0.2770528},
     '5': {'avg_iou': 0.76394117,
           'avg_obj': 0.44087285,
           'box_loss': 0.09181483,
           'class_loss': 0.046404228,
           'conf_loss': 0.09135772,
           'precision50': 0.7193253,
           'recall50': 0.43885532},
     'global': {'total_loss': 0.8774409},
     'learning_rate': 0.0041991845,
     'training_loss': 0.8774409}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-240000.
 eval | step:  240000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=177.57s).
Accumulating evaluation results...
DONE (t=17.62s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.278
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.475
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.281
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.112
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.279
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.395
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.254
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.418
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.462
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.255
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.601
 eval | step:  240000 | eval time:  511.7 sec | output: 
    {'3': {'avg_iou': 0.46220982,
           'avg_obj': 0.14433336,
           'box_loss': 0.011606602,
           'class_loss': 0.004386227,
           'conf_loss': 0.019005494,
           'precision50': 0.33044112,
           'recall50': 0.11044055},
     '4': {'avg_iou': 0.6572422,
           'avg_obj': 0.28634205,
           'box_loss': 0.012134347,
           'class_loss': 0.0047227307,
           'conf_loss': 0.018956041,
           'precision50': 0.5619049,
           'recall50': 0.26597095},
     '5': {'avg_iou': 0.71987426,
           'avg_obj': 0.4016026,
           'box_loss': 0.01188001,
           'class_loss': 0.0061103376,
           'conf_loss': 0.014497821,
           'precision50': 0.683575,
           'recall50': 0.40705},
     'AP': 0.27759233,
     'AP50': 0.47471154,
     'AP75': 0.2812993,
     'APl': 0.3947696,
     'APm': 0.2794088,
     'APs': 0.11200502,
     'ARl': 0.6013881,
     'ARm': 0.4848002,
     'ARmax1': 0.25380486,
     'ARmax10': 0.41780767,
     'ARmax100': 0.46221498,
     'ARs': 0.25505143,
     'global': {'total_loss': 0.10329961},
     'validation_loss': 0.10329961}
train | step:  240000 | training until step 260000...
train | step:  250000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.61115706,
           'avg_obj': 0.19955286,
           'box_loss': 0.12551135,
           'class_loss': 0.054937616,
           'conf_loss': 0.16496685,
           'precision50': 0.3977042,
           'recall50': 0.105261825},
     '4': {'avg_iou': 0.7194164,
           'avg_obj': 0.3287116,
           'box_loss': 0.102832384,
           'class_loss': 0.048584953,
           'conf_loss': 0.14675698,
           'precision50': 0.6447774,
           'recall50': 0.28139368},
     '5': {'avg_iou': 0.7655798,
           'avg_obj': 0.4441061,
           'box_loss': 0.09113033,
           'class_loss': 0.045578472,
           'conf_loss': 0.09104899,
           'precision50': 0.72136986,
           'recall50': 0.44331878},
     'global': {'total_loss': 0.8713475},
     'learning_rate': 0.0039027706,
     'training_loss': 0.8713475}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-250000.
train | step:  260000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.61250806,
           'avg_obj': 0.20197293,
           'box_loss': 0.12501058,
           'class_loss': 0.05413058,
           'conf_loss': 0.16430484,
           'precision50': 0.40030563,
           'recall50': 0.10679382},
     '4': {'avg_iou': 0.7209087,
           'avg_obj': 0.33199364,
           'box_loss': 0.102256685,
           'class_loss': 0.04767088,
           'conf_loss': 0.1460216,
           'precision50': 0.6471632,
           'recall50': 0.28518802},
     '5': {'avg_iou': 0.7669273,
           'avg_obj': 0.447297,
           'box_loss': 0.09056867,
           'class_loss': 0.04480439,
           'conf_loss': 0.0905406,
           'precision50': 0.7236261,
           'recall50': 0.44767115},
     'global': {'total_loss': 0.8653096},
     'learning_rate': 0.0036214672,
     'training_loss': 0.8653096}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-260000.
 eval | step:  260000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.17s).
Accumulating evaluation results...
DONE (t=16.88s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.296
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.500
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.305
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.123
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.298
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.418
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.264
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.440
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.274
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.514
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.617
 eval | step:  260000 | eval time:  502.2 sec | output: 
    {'3': {'avg_iou': 0.467032,
           'avg_obj': 0.15570198,
           'box_loss': 0.011353028,
           'class_loss': 0.0039850753,
           'conf_loss': 0.018412905,
           'precision50': 0.3436217,
           'recall50': 0.12107314},
     '4': {'avg_iou': 0.667621,
           'avg_obj': 0.3093606,
           'box_loss': 0.011594366,
           'class_loss': 0.004212106,
           'conf_loss': 0.01692949,
           'precision50': 0.5866082,
           'recall50': 0.2924978},
     '5': {'avg_iou': 0.7338578,
           'avg_obj': 0.42960235,
           'box_loss': 0.011151252,
           'class_loss': 0.004345696,
           'conf_loss': 0.013774283,
           'precision50': 0.7042011,
           'recall50': 0.44012222},
     'AP': 0.29605466,
     'AP50': 0.5000582,
     'AP75': 0.30543035,
     'APl': 0.41849348,
     'APm': 0.29829845,
     'APs': 0.122633904,
     'ARl': 0.6174786,
     'ARm': 0.51365036,
     'ARmax1': 0.2643392,
     'ARmax10': 0.43980744,
     'ARmax100': 0.48529044,
     'ARs': 0.2743318,
     'global': {'total_loss': 0.0957582},
     'validation_loss': 0.0957582}I0521 20:38:01.044264 139861436241728 controller.py:211] train | step:  260000 | training until step 280000...
I0521 21:59:01.932200 139861436241728 controller.py:425] train | step:  270000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.613687,
           'avg_obj': 0.20378259,
           'box_loss': 0.1246175,
           'class_loss': 0.053561077,
           'conf_loss': 0.16374482,
           'precision50': 0.4027511,
           'recall50': 0.10844825},
     '4': {'avg_iou': 0.72232395,
           'avg_obj': 0.3349657,
           'box_loss': 0.101699755,
           'class_loss': 0.04702531,
           'conf_loss': 0.14533824,
           'precision50': 0.6502667,
           'recall50': 0.2895345},
     '5': {'avg_iou': 0.76856107,
           'avg_obj': 0.4502802,
           'box_loss': 0.08986214,
           'class_loss': 0.044179253,
           'conf_loss': 0.090093486,
           'precision50': 0.7251354,
           'recall50': 0.4510953},
     'global': {'total_loss': 0.86012274},
     'learning_rate': 0.003357301,
     'training_loss': 0.86012274}
I0521 22:00:02.413348 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-270000.
I0521 23:28:26.335252 139861436241728 controller.py:425] train | step:  280000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6151646,
           'avg_obj': 0.20635253,
           'box_loss': 0.12404506,
           'class_loss': 0.052870683,
           'conf_loss': 0.16295202,
           'precision50': 0.4067509,
           'recall50': 0.11108832},
     '4': {'avg_iou': 0.7238906,
           'avg_obj': 0.33774263,
           'box_loss': 0.101065636,
           'class_loss': 0.046313085,
           'conf_loss': 0.14467335,
           'precision50': 0.6528932,
           'recall50': 0.29327223},
     '5': {'avg_iou': 0.7699748,
           'avg_obj': 0.45359966,
           'box_loss': 0.08924958,
           'class_loss': 0.043457266,
           'conf_loss': 0.08960013,
           'precision50': 0.72782934,
           'recall50': 0.4554831},
     'global': {'total_loss': 0.8542251},
     'learning_rate': 0.003112175,
     'training_loss': 0.8542251}
I0521 23:29:27.932114 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-280000.
I0521 23:29:27.938384 139861436241728 controller.py:252]  eval | step:  280000 | running 625 steps of evaluation...
I0521 23:33:36.963598 139861436241728 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0521 23:37:45.401949 139861436241728 controller.py:261]  eval | step:  280000 | eval time:  497.5 sec | output: 
    {'3': {'avg_iou': 0.46778238,
           'avg_obj': 0.15796584,
           'box_loss': 0.0113126775,
           'class_loss': 0.0039828625,
           'conf_loss': 0.018419221,
           'precision50': 0.34709242,
           'recall50': 0.12405205},
     '4': {'avg_iou': 0.66931933,
           'avg_obj': 0.31280515,
           'box_loss': 0.011506129,
           'class_loss': 0.004200349,
           'conf_loss': 0.016886042,
           'precision50': 0.58771616,
           'recall50': 0.2975792},
     '5': {'avg_iou': 0.7357246,
           'avg_obj': 0.43384975,
           'box_loss': 0.011053791,
           'class_loss': 0.0043322504,
           'conf_loss': 0.013568672,
           'precision50': 0.7066838,
           'recall50': 0.4457477},
     'AP': 0.29784042,
     'AP50': 0.50226927,
     'AP75': 0.30748495,
     'APl': 0.41972116,
     'APm': 0.3005079,
     'APs': 0.12154433,
     'ARl': 0.62297577,
     'ARm': 0.51226854,
     'ARmax1': 0.26707402,
     'ARmax10': 0.44077766,
     'ARmax100': 0.48516485,
     'ARs': 0.27453944,
     'global': {'total_loss': 0.095262006},
     'validation_loss': 0.095262006}
I0521 23:38:04.670210 139861436241728 controller.py:211] train | step:  280000 | training until step 300000...
I0522 01:00:39.862180 139861436241728 controller.py:425] train | step:  290000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.61607206,
           'avg_obj': 0.20821688,
           'box_loss': 0.12375719,
           'class_loss': 0.052232414,
           'conf_loss': 0.16275841,
           'precision50': 0.4104507,
           'recall50': 0.113018945},
     '4': {'avg_iou': 0.7246204,
           'avg_obj': 0.3396434,
           'box_loss': 0.10073678,
           'class_loss': 0.04575389,
           'conf_loss': 0.1444595,
           'precision50': 0.65464187,
           'recall50': 0.29584944},
     '5': {'avg_iou': 0.7708206,
           'avg_obj': 0.45499516,
           'box_loss': 0.08893647,
           'class_loss': 0.043003473,
           'conf_loss': 0.08943488,
           'precision50': 0.72757953,
           'recall50': 0.4569004},
     'global': {'total_loss': 0.8510725},
     'learning_rate': 0.002887857,
     'training_loss': 0.8510725}
I0522 01:01:38.175484 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-290000.
I0522 02:29:17.591020 139861436241728 controller.py:425] train | step:  300000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.61709744,
           'avg_obj': 0.21013138,
           'box_loss': 0.12337853,
           'class_loss': 0.051899415,
           'conf_loss': 0.16240358,
           'precision50': 0.4122492,
           'recall50': 0.114197776},
     '4': {'avg_iou': 0.7259803,
           'avg_obj': 0.3421888,
           'box_loss': 0.10022795,
           'class_loss': 0.04519369,
           'conf_loss': 0.14394961,
           'precision50': 0.6566779,
           'recall50': 0.29898128},
     '5': {'avg_iou': 0.77247924,
           'avg_obj': 0.45827186,
           'box_loss': 0.08826961,
           'class_loss': 0.042441886,
           'conf_loss': 0.089142814,
           'precision50': 0.73087496,
           'recall50': 0.46181595},
     'global': {'total_loss': 0.84690636},
     'learning_rate': 0.002685961,
     'training_loss': 0.84690636}
I0522 02:30:17.607060 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-300000.
I0522 02:30:17.613250 139861436241728 controller.py:252]  eval | step:  300000 | running 625 steps of evaluation...
I0522 02:34:31.089656 139861436241728 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0522 02:39:13.660359 139861436241728 controller.py:261]  eval | step:  300000 | eval time:  536.0 sec | output: 
    {'3': {'avg_iou': 0.46849146,
           'avg_obj': 0.1600755,
           'box_loss': 0.011277399,
           'class_loss': 0.0039676633,
           'conf_loss': 0.01838006,
           'precision50': 0.3521659,
           'recall50': 0.12620434},
     '4': {'avg_iou': 0.6699545,
           'avg_obj': 0.3158204,
           'box_loss': 0.011473182,
           'class_loss': 0.004185066,
           'conf_loss': 0.016783161,
           'precision50': 0.58988905,
           'recall50': 0.3033691},
     '5': {'avg_iou': 0.7365937,
           'avg_obj': 0.4377899,
           'box_loss': 0.0110077355,
           'class_loss': 0.0043167192,
           'conf_loss': 0.013433836,
           'precision50': 0.7084764,
           'recall50': 0.45291007},
     'AP': 0.3007196,
     'AP50': 0.5063792,
     'AP75': 0.31075746,
     'APl': 0.42020416,
     'APm': 0.30442888,
     'APs': 0.12329074,
     'ARl': 0.6206643,
     'ARm': 0.512732,
     'ARmax1': 0.2696,
     'ARmax10': 0.4420864,
     'ARmax100': 0.4870434,
     'ARs': 0.28066945,
     'global': {'total_loss': 0.09482483},
     'validation_loss': 0.09482483}

train | step:  260000 | training until step 280000...
train | step:  270000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.613687,
           'avg_obj': 0.20378259,
           'box_loss': 0.1246175,
           'class_loss': 0.053561077,
           'conf_loss': 0.16374482,
           'precision50': 0.4027511,
           'recall50': 0.10844825},
     '4': {'avg_iou': 0.72232395,
           'avg_obj': 0.3349657,
           'box_loss': 0.101699755,
           'class_loss': 0.04702531,
           'conf_loss': 0.14533824,
           'precision50': 0.6502667,
           'recall50': 0.2895345},
     '5': {'avg_iou': 0.76856107,
           'avg_obj': 0.4502802,
           'box_loss': 0.08986214,
           'class_loss': 0.044179253,
           'conf_loss': 0.090093486,
           'precision50': 0.7251354,
           'recall50': 0.4510953},
     'global': {'total_loss': 0.86012274},
     'learning_rate': 0.003357301,
     'training_loss': 0.86012274}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-270000.
train | step:  280000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6151646,
           'avg_obj': 0.20635253,
           'box_loss': 0.12404506,
           'class_loss': 0.052870683,
           'conf_loss': 0.16295202,
           'precision50': 0.4067509,
           'recall50': 0.11108832},
     '4': {'avg_iou': 0.7238906,
           'avg_obj': 0.33774263,
           'box_loss': 0.101065636,
           'class_loss': 0.046313085,
           'conf_loss': 0.14467335,
           'precision50': 0.6528932,
           'recall50': 0.29327223},
     '5': {'avg_iou': 0.7699748,
           'avg_obj': 0.45359966,
           'box_loss': 0.08924958,
           'class_loss': 0.043457266,
           'conf_loss': 0.08960013,
           'precision50': 0.72782934,
           'recall50': 0.4554831},
     'global': {'total_loss': 0.8542251},
     'learning_rate': 0.003112175,
     'training_loss': 0.8542251}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-280000.
 eval | step:  280000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=174.14s).
Accumulating evaluation results...
DONE (t=16.21s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.298
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.502
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.307
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.122
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.301
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.420
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.267
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.441
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.275
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.512
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.623
 eval | step:  280000 | eval time:  497.5 sec | output: 
    {'3': {'avg_iou': 0.46778238,
           'avg_obj': 0.15796584,
           'box_loss': 0.0113126775,
           'class_loss': 0.0039828625,
           'conf_loss': 0.018419221,
           'precision50': 0.34709242,
           'recall50': 0.12405205},
     '4': {'avg_iou': 0.66931933,
           'avg_obj': 0.31280515,
           'box_loss': 0.011506129,
           'class_loss': 0.004200349,
           'conf_loss': 0.016886042,
           'precision50': 0.58771616,
           'recall50': 0.2975792},
     '5': {'avg_iou': 0.7357246,
           'avg_obj': 0.43384975,
           'box_loss': 0.011053791,
           'class_loss': 0.0043322504,
           'conf_loss': 0.013568672,
           'precision50': 0.7066838,
           'recall50': 0.4457477},
     'AP': 0.29784042,
     'AP50': 0.50226927,
     'AP75': 0.30748495,
     'APl': 0.41972116,
     'APm': 0.3005079,
     'APs': 0.12154433,
     'ARl': 0.62297577,
     'ARm': 0.51226854,
     'ARmax1': 0.26707402,
     'ARmax10': 0.44077766,
     'ARmax100': 0.48516485,
     'ARs': 0.27453944,
     'global': {'total_loss': 0.095262006},
     'validation_loss': 0.095262006}
train | step:  280000 | training until step 300000...
train | step:  290000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.61607206,
           'avg_obj': 0.20821688,
           'box_loss': 0.12375719,
           'class_loss': 0.052232414,
           'conf_loss': 0.16275841,
           'precision50': 0.4104507,
           'recall50': 0.113018945},
     '4': {'avg_iou': 0.7246204,
           'avg_obj': 0.3396434,
           'box_loss': 0.10073678,
           'class_loss': 0.04575389,
           'conf_loss': 0.1444595,
           'precision50': 0.65464187,
           'recall50': 0.29584944},
     '5': {'avg_iou': 0.7708206,
           'avg_obj': 0.45499516,
           'box_loss': 0.08893647,
           'class_loss': 0.043003473,
           'conf_loss': 0.08943488,
           'precision50': 0.72757953,
           'recall50': 0.4569004},
     'global': {'total_loss': 0.8510725},
     'learning_rate': 0.002887857,
     'training_loss': 0.8510725}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-290000.
train | step:  300000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.61709744,
           'avg_obj': 0.21013138,
           'box_loss': 0.12337853,
           'class_loss': 0.051899415,
           'conf_loss': 0.16240358,
           'precision50': 0.4122492,
           'recall50': 0.114197776},
     '4': {'avg_iou': 0.7259803,
           'avg_obj': 0.3421888,
           'box_loss': 0.10022795,
           'class_loss': 0.04519369,
           'conf_loss': 0.14394961,
           'precision50': 0.6566779,
           'recall50': 0.29898128},
     '5': {'avg_iou': 0.77247924,
           'avg_obj': 0.45827186,
           'box_loss': 0.08826961,
           'class_loss': 0.042441886,
           'conf_loss': 0.089142814,
           'precision50': 0.73087496,
           'recall50': 0.46181595},
     'global': {'total_loss': 0.84690636},
     'learning_rate': 0.002685961,
     'training_loss': 0.84690636}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-300000.
 eval | step:  300000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=202.63s).
Accumulating evaluation results...
DONE (t=16.96s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.301
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.506
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.311
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.123
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.304
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.420
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.270
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.442
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.487
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.281
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.513
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.621
 eval | step:  300000 | eval time:  536.0 sec | output: 
    {'3': {'avg_iou': 0.46849146,
           'avg_obj': 0.1600755,
           'box_loss': 0.011277399,
           'class_loss': 0.0039676633,
           'conf_loss': 0.01838006,
           'precision50': 0.3521659,
           'recall50': 0.12620434},
     '4': {'avg_iou': 0.6699545,
           'avg_obj': 0.3158204,
           'box_loss': 0.011473182,
           'class_loss': 0.004185066,
           'conf_loss': 0.016783161,
           'precision50': 0.58988905,
           'recall50': 0.3033691},
     '5': {'avg_iou': 0.7365937,
           'avg_obj': 0.4377899,
           'box_loss': 0.0110077355,
           'class_loss': 0.0043167192,
           'conf_loss': 0.013433836,
           'precision50': 0.7084764,
           'recall50': 0.45291007},
     'AP': 0.3007196,
     'AP50': 0.5063792,
     'AP75': 0.31075746,
     'APl': 0.42020416,
     'APm': 0.30442888,
     'APs': 0.12329074,
     'ARl': 0.6206643,
     'ARm': 0.512732,
     'ARmax1': 0.2696,
     'ARmax10': 0.4420864,
     'ARmax100': 0.4870434,
     'ARs': 0.28066945,
     'global': {'total_loss': 0.09482483},
     'validation_loss': 0.09482483}I0522 02:39:31.902067 139861436241728 controller.py:211] train | step:  300000 | training until step 320000...
I0522 04:02:00.405973 139861436241728 controller.py:425] train | step:  310000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6179513,
           'avg_obj': 0.21194714,
           'box_loss': 0.12304477,
           'class_loss': 0.051146373,
           'conf_loss': 0.16159959,
           'precision50': 0.41561952,
           'recall50': 0.11631788},
     '4': {'avg_iou': 0.7271503,
           'avg_obj': 0.3446338,
           'box_loss': 0.09963589,
           'class_loss': 0.04446399,
           'conf_loss': 0.14324856,
           'precision50': 0.6579139,
           'recall50': 0.3020253},
     '5': {'avg_iou': 0.7734951,
           'avg_obj': 0.46032032,
           'box_loss': 0.087853186,
           'class_loss': 0.04184658,
           'conf_loss': 0.08872496,
           'precision50': 0.73154557,
           'recall50': 0.4638919},
     'global': {'total_loss': 0.84156436},
     'learning_rate': 0.0025079434,
     'training_loss': 0.84156436}
I0522 04:02:58.708961 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-310000.
I0522 05:31:41.103779 139861436241728 controller.py:425] train | step:  320000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6190249,
           'avg_obj': 0.21347691,
           'box_loss': 0.12294288,
           'class_loss': 0.050905664,
           'conf_loss': 0.16168164,
           'precision50': 0.4181465,
           'recall50': 0.1177407},
     '4': {'avg_iou': 0.72796994,
           'avg_obj': 0.34674403,
           'box_loss': 0.099379174,
           'class_loss': 0.044109903,
           'conf_loss': 0.14314364,
           'precision50': 0.66065776,
           'recall50': 0.30484033},
     '5': {'avg_iou': 0.77432454,
           'avg_obj': 0.46278223,
           'box_loss': 0.08748401,
           'class_loss': 0.04151146,
           'conf_loss': 0.08847338,
           'precision50': 0.7331577,
           'recall50': 0.46718124},
     'global': {'total_loss': 0.8396316},
     'learning_rate': 0.002355086,
     'training_loss': 0.8396316}
I0522 05:32:39.760649 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-320000.
I0522 05:32:39.766784 139861436241728 controller.py:252]  eval | step:  320000 | running 625 steps of evaluation...
I0522 05:36:50.883610 139861436241728 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0522 05:40:54.498587 139861436241728 controller.py:261]  eval | step:  320000 | eval time:  494.7 sec | output: 
    {'3': {'avg_iou': 0.4690828,
           'avg_obj': 0.16120371,
           'box_loss': 0.011247765,
           'class_loss': 0.003992586,
           'conf_loss': 0.018405834,
           'precision50': 0.35450077,
           'recall50': 0.1295446},
     '4': {'avg_iou': 0.6707738,
           'avg_obj': 0.3180041,
           'box_loss': 0.011430675,
           'class_loss': 0.004211118,
           'conf_loss': 0.016860971,
           'precision50': 0.5934686,
           'recall50': 0.30601478},
     '5': {'avg_iou': 0.73733157,
           'avg_obj': 0.43910152,
           'box_loss': 0.010969443,
           'class_loss': 0.0043147537,
           'conf_loss': 0.013627002,
           'precision50': 0.7086059,
           'recall50': 0.45235485},
     'AP': 0.30190745,
     'AP50': 0.5070825,
     'AP75': 0.31359586,
     'APl': 0.42767414,
     'APm': 0.30550998,
     'APs': 0.12080654,
     'ARl': 0.6207893,
     'ARm': 0.51131,
     'ARmax1': 0.26873007,
     'ARmax10': 0.44052997,
     'ARmax100': 0.485551,
     'ARs': 0.2763991,
     'global': {'total_loss': 0.09506014},
     'validation_loss': 0.09506014}
I0522 05:41:12.558828 139861436241728 controller.py:211] train | step:  320000 | training until step 340000...
I0522 07:05:43.204722 139861436241728 controller.py:425] train | step:  330000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.61974734,
           'avg_obj': 0.2151316,
           'box_loss': 0.12249777,
           'class_loss': 0.050307743,
           'conf_loss': 0.1612162,
           'precision50': 0.42097807,
           'recall50': 0.119449146},
     '4': {'avg_iou': 0.7285485,
           'avg_obj': 0.34806314,
           'box_loss': 0.09913147,
           'class_loss': 0.043653406,
           'conf_loss': 0.14267094,
           'precision50': 0.6615865,
           'recall50': 0.30696565},
     '5': {'avg_iou': 0.7749335,
           'avg_obj': 0.46396366,
           'box_loss': 0.08714296,
           'class_loss': 0.04097267,
           'conf_loss': 0.08820279,
           'precision50': 0.7333997,
           'recall50': 0.4687883},
     'global': {'total_loss': 0.8357968},
     'learning_rate': 0.0022284898,
     'training_loss': 0.8357968}
I0522 07:06:42.943329 139861436241728 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-330000.
2021-05-22 08:27:34.689739: W tensorflow/core/distributed_runtime/eager/remote_tensor_handle_data.cc:76] Unable to destroy remote tensor handles. If you are running a tf.function, it usually indicates some op in the graph gets an error: Socket closed
Additional GRPC error information from remote target /job:worker/replica:0/task:0:
:{"created":"@1621672054.685499736","description":"Error received from peer ipv4:10.77.141.42:8470","file":"external/com_github_grpc_grpc/src/core/lib/surface/call.cc","file_line":1056,"grpc_message":"Socket closed","grpc_status":14}
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 149, in main
    model_dir=model_dir)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_lib.py", line 104, in run_experiment
    eval_interval=params.trainer.validation_interval)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 303, in train_and_evaluate
    self.train(steps=num_steps, checkpoint_at_completion=False)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 215, in train
    self._train_n_steps(num_steps)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 410, in _train_n_steps
    train_output = self.trainer.train(num_steps_tensor)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/standard_runner.py", line 142, in train
    return self.train_loop_end()
  File "/home/cam2tensorflow/TensorFlowModels/official/core/base_trainer.py", line 276, in train_loop_end
    self._recovery.maybe_recover(self.train_loss.result().numpy(),
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 1071, in numpy
    maybe_arr = self._numpy()  # pylint: disable=protected-access
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 1039, in _numpy
    six.raise_from(core._status_to_exception(e.code, e.message), None)  # pylint: disable=protected-access
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.UnavailableError: Socket closed
Additional GRPC error information from remote target /job:worker/replica:0/task:0:
:{"created":"@1621672054.685499736","description":"Error received from peer ipv4:10.77.141.42:8470","file":"external/com_github_grpc_grpc/src/core/lib/surface/call.cc","file_line":1056,"grpc_message":"Socket closed","grpc_status":14}
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/tpu_strategy.py", line 738, in async_wait
    context.async_wait()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/context.py", line 2330, in async_wait
    context().sync_executors()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/context.py", line 645, in sync_executors
    pywrap_tfe.TFE_ContextSyncExecutors(self._context_handle)
tensorflow.python.framework.errors_impl.UnavailableError: 2 root error(s) found.
  (0) Unavailable: Socket closed
Additional GRPC error information from remote target /job:worker/replica:0/task:0:
:{"created":"@1621672054.685499736","description":"Error received from peer ipv4:10.77.141.42:8470","file":"external/com_github_grpc_grpc/src/core/lib/surface/call.cc","file_line":1056,"grpc_message":"Socket closed","grpc_status":14}
  (1) Unavailable: Unable to find a context_id matching the specified one (11898263711164938488). Perhaps the worker was restarted, or the context was GC'd?
0 successful operations.
0 derived errors ignored.

train | step:  300000 | training until step 320000...
train | step:  310000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6179513,
           'avg_obj': 0.21194714,
           'box_loss': 0.12304477,
           'class_loss': 0.051146373,
           'conf_loss': 0.16159959,
           'precision50': 0.41561952,
           'recall50': 0.11631788},
     '4': {'avg_iou': 0.7271503,
           'avg_obj': 0.3446338,
           'box_loss': 0.09963589,
           'class_loss': 0.04446399,
           'conf_loss': 0.14324856,
           'precision50': 0.6579139,
           'recall50': 0.3020253},
     '5': {'avg_iou': 0.7734951,
           'avg_obj': 0.46032032,
           'box_loss': 0.087853186,
           'class_loss': 0.04184658,
           'conf_loss': 0.08872496,
           'precision50': 0.73154557,
           'recall50': 0.4638919},
     'global': {'total_loss': 0.84156436},
     'learning_rate': 0.0025079434,
     'training_loss': 0.84156436}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-310000.
train | step:  320000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6190249,
           'avg_obj': 0.21347691,
           'box_loss': 0.12294288,
           'class_loss': 0.050905664,
           'conf_loss': 0.16168164,
           'precision50': 0.4181465,
           'recall50': 0.1177407},
     '4': {'avg_iou': 0.72796994,
           'avg_obj': 0.34674403,
           'box_loss': 0.099379174,
           'class_loss': 0.044109903,
           'conf_loss': 0.14314364,
           'precision50': 0.66065776,
           'recall50': 0.30484033},
     '5': {'avg_iou': 0.77432454,
           'avg_obj': 0.46278223,
           'box_loss': 0.08748401,
           'class_loss': 0.04151146,
           'conf_loss': 0.08847338,
           'precision50': 0.7331577,
           'recall50': 0.46718124},
     'global': {'total_loss': 0.8396316},
     'learning_rate': 0.002355086,
     'training_loss': 0.8396316}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-320000.
 eval | step:  320000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=174.72s).
Accumulating evaluation results...
DONE (t=17.57s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.302
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.507
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.314
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.121
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.306
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.428
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.269
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.441
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.486
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.276
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.511
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.621
 eval | step:  320000 | eval time:  494.7 sec | output: 
    {'3': {'avg_iou': 0.4690828,
           'avg_obj': 0.16120371,
           'box_loss': 0.011247765,
           'class_loss': 0.003992586,
           'conf_loss': 0.018405834,
           'precision50': 0.35450077,
           'recall50': 0.1295446},
     '4': {'avg_iou': 0.6707738,
           'avg_obj': 0.3180041,
           'box_loss': 0.011430675,
           'class_loss': 0.004211118,
           'conf_loss': 0.016860971,
           'precision50': 0.5934686,
           'recall50': 0.30601478},
     '5': {'avg_iou': 0.73733157,
           'avg_obj': 0.43910152,
           'box_loss': 0.010969443,
           'class_loss': 0.0043147537,
           'conf_loss': 0.013627002,
           'precision50': 0.7086059,
           'recall50': 0.45235485},
     'AP': 0.30190745,
     'AP50': 0.5070825,
     'AP75': 0.31359586,
     'APl': 0.42767414,
     'APm': 0.30550998,
     'APs': 0.12080654,
     'ARl': 0.6207893,
     'ARm': 0.51131,
     'ARmax1': 0.26873007,
     'ARmax10': 0.44052997,
     'ARmax100': 0.485551,
     'ARs': 0.2763991,
     'global': {'total_loss': 0.09506014},
     'validation_loss': 0.09506014}
train | step:  320000 | training until step 340000...
train | step:  330000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.61974734,
           'avg_obj': 0.2151316,
           'box_loss': 0.12249777,
           'class_loss': 0.050307743,
           'conf_loss': 0.1612162,
           'precision50': 0.42097807,
           'recall50': 0.119449146},
     '4': {'avg_iou': 0.7285485,
           'avg_obj': 0.34806314,
           'box_loss': 0.09913147,
           'class_loss': 0.043653406,
           'conf_loss': 0.14267094,
           'precision50': 0.6615865,
           'recall50': 0.30696565},
     '5': {'avg_iou': 0.7749335,
           'avg_obj': 0.46396366,
           'box_loss': 0.08714296,
           'class_loss': 0.04097267,
           'conf_loss': 0.08820279,
           'precision50': 0.7333997,
           'recall50': 0.4687883},
     'global': {'total_loss': 0.8357968},
     'learning_rate': 0.0022284898,
     'training_loss': 0.8357968}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-18/ckpt-330000.
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   210    0     2  100   208     11   1181 --:--:-- --:--:-- --:--:--  1193
okRequest issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-22T08:34:27.631397960Z'
  endTime: '2021-05-22T08:35:22.587055013Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621672467616-5c2e70b5fd178-b6c14666-b8f2ae60
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-04-28T09:49:15.232857330Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-28T09:48:54.136196+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621672467616-5c2e70b5fd178-b6c14666-b8f2ae60] to complete...
.................................................................................................................................................................................................................................................................................................................................................................................................done.
