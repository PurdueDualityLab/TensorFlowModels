cat: .experiment_zone: No such file or directory
Request issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-13T10:01:56.608699525Z'
  endTime: '2021-05-13T10:02:32.386196968Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620900116594-5c23337aa7db4-57ef3d1c-3b0bebc2
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T05:45:10.821112479Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T05:44:59.159875+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T19:29:05.781890630Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T19:28:54.243943+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620900116594-5c23337aa7db4-57ef3d1c-3b0bebc2] to complete...
...............................................................................................................................................................................................done.
europe-west4-a
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 26, in <module>
    from yolo.common import registry_imports
  File "/home/cam2tensorflow/TensorFlowModels/yolo/common/registry_imports.py", line 23, in <module>
    from yolo.configs import yolo
  File "/home/cam2tensorflow/TensorFlowModels/yolo/configs/yolo.py", line 30, in <module>
    import regex as re
ModuleNotFoundError: No module named 'regex'
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   217    0     2  100   215     11   1279 --:--:-- --:--:-- --:--:--  1291
okRequest issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-13T10:02:40.695216734Z'
  endTime: '2021-05-13T10:03:03.791558600Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620900160671-5c2333a4b0d3e-8a1ce787-1da8df77
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T05:45:10.821112479Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T05:44:59.159875+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T19:29:05.781890630Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T19:28:54.243943+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620900160671-5c2333a4b0d3e-8a1ce787-1da8df77] to complete...
.....................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-13T10:03:48.785178341Z'
  endTime: '2021-05-13T10:04:24.464440354Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620900228770-5c2333e5a29c7-838db691-bc9f6169
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T05:45:10.821112479Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T05:44:59.159875+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T19:29:05.781890630Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T19:28:54.243943+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1620900228770-5c2333e5a29c7-838db691-bc9f6169] to complete...
..............................................................................................................................................................................................done.
europe-west4-a
I0513 09:59:22.767571 140638711330624 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'base': {'type': None},
                    'boxes': ['[15.0, 20.0]',
                              '[23.0, 45.0]',
                              '[50.0, 35.0]',
                              '[45.0, 93.0]',
                              '[95.0, 68.0]',
                              '[90.0, 182.0]',
                              '[177.0, 137.0]',
                              '[240.0, 303.0]',
                              '[573.0, 501.0]'],
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': True},
                    'input_size': [512, 512, 3],
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.2,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_crop': 0.1,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 2.0,
                                    'aug_scale_min': 0.1,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.5,
                                               'random_crop_mosaic': False},
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_crop': 0.1,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 2.0,
                                         'aug_scale_min': 0.1,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'mosaic': {'crop_area': [0.6, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 10000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.2,
                                                               'decay_steps': 370000,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0513 09:59:22.768483 140638711330624 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/params.yaml
I0513 09:59:24.457845 140638711330624 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0513 09:59:25.074168 140638711330624 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0513 09:59:25.074489 140638711330624 transport.py:157] Attempting refresh to obtain initial access_token
I0513 09:59:25.134766 140638711330624 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0513 09:59:25.773715 140638711330624 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0513 09:59:25.773983 140638711330624 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-13 09:59:25.819441: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0513 09:59:25.820439 140638711330624 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0513 09:59:25.973025 140638711330624 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0513 09:59:25.973297 140638711330624 transport.py:157] Attempting refresh to obtain initial access_token
I0513 09:59:26.042237 140638711330624 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0513 09:59:26.660185 140638711330624 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0513 09:59:26.660671 140638711330624 transport.py:157] Attempting refresh to obtain initial access_token
2021-05-13 09:59:26.729246: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-13 09:59:26.748131: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-05-13 09:59:26.748320: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:32791}
2021-05-13 10:00:01.947465: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-05-13 10:00:01.947659: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:32791}
2021-05-13 10:00:01.948595: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:32791
I0513 10:00:01.949905 140638711330624 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-1
I0513 10:00:01.950841 140638711330624 tpu_strategy_util.py:74] Initializing the TPU system: node-1
INFO:tensorflow:Clearing out eager caches
I0513 10:00:09.610174 140638711330624 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0513 10:00:09.612524 140638711330624 tpu_strategy_util.py:133] Finished initializing TPU system.
I0513 10:00:09.614018 140638711330624 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0513 10:00:09.771240 140638711330624 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0513 10:00:09.771564 140638711330624 transport.py:157] Attempting refresh to obtain initial access_token
I0513 10:00:09.950153 140638711330624 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0513 10:00:10.568310 140638711330624 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0513 10:00:10.568570 140638711330624 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0513 10:00:10.615991 140638711330624 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0513 10:00:10.616278 140638711330624 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0513 10:00:10.616732 140638711330624 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0513 10:00:10.616839 140638711330624 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0513 10:00:10.616894 140638711330624 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0513 10:00:10.617076 140638711330624 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0513 10:00:10.617170 140638711330624 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0513 10:00:10.617244 140638711330624 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0513 10:00:10.617318 140638711330624 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0513 10:00:10.617382 140638711330624 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0513 10:00:10.617558 140638711330624 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0513 10:00:10.617668 140638711330624 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0513 10:00:10.617778 140638711330624 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0513 10:00:10.617871 140638711330624 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0513 10:00:10.617957 140638711330624 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0513 10:00:10.618042 140638711330624 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0513 10:00:10.619398 140638711330624 train_utils.py:214] Running default trainer.
2021-05-13 10:00:10.647682: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, 'input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[15.0, 20.0]', '[23.0, 45.0]', '[50.0, 35.0]', '[45.0, 93.0]', '[95.0, 68.0]', '[90.0, 182.0]', '[177.0, 137.0]', '[240.0, 303.0]', '[573.0, 501.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'max_num_instances': 200, 'letter_box': True, 'random_flip': True, 'aug_rand_crop': 0.1, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.6, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 370000, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 10000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
[[15.0, 20.0], [23.0, 45.0], [50.0, 35.0], [45.0, 93.0], [95.0, 68.0], [90.0, 182.0], [177.0, 137.0], [240.0, 303.0], [573.0, 501.0]]
[[15.0, 20.0], [23.0, 45.0], [50.0, 35.0], [45.0, 93.0], [95.0, 68.0], [90.0, 182.0], [177.0, 137.0], [240.0, 303.0], [573.0, 501.0]]
heheheeheheheheheheheh:  [[15.0, 20.0], [23.0, 45.0], [50.0, 35.0], [45.0, 93.0], [95.0, 68.0], [90.0, 182.0], [177.0, 137.0], [240.0, 303.0], [573.0, 501.0]]
{'num_classes': 91, 'input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 2.0}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', 'boxes': ['[15.0, 20.0]', '[23.0, 45.0]', '[50.0, 35.0]', '[45.0, 93.0]', '[95.0, 68.0]', '[90.0, 182.0]', '[177.0, 137.0]', '[240.0, 303.0]', '[573.0, 501.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7fe89c0d0748>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
[[15.0, 20.0], [23.0, 45.0], [50.0, 35.0], [45.0, 93.0], [95.0, 68.0], [90.0, 182.0], [177.0, 137.0], [240.0, 303.0], [573.0, 501.0]]
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________I0513 10:01:04.865982 140638711330624 controller.py:362] restoring or initializing model...
I0513 10:01:15.364188 140638711330624 yolo.py:537] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0513 10:01:15.366179 140638711330624 controller.py:368] initialized model.
I0513 10:01:15.366399 140638711330624 train_lib.py:96] Starts to execute mode: train_and_eval
I0513 10:01:15.370777 140638711330624 controller.py:211] train | step:      0 | training until step 20000...
I0513 10:01:23.318332 140638711330624 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0513 10:02:15.299989 140638711330624 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0513 11:52:14.852132 140638711330624 controller.py:425] train | step:  10000 | steps/sec:    1.5 | output: 
    {'3': {'avg_iou': 0.44687593,
           'avg_obj': 0.08357892,
           'box_loss': 0.0229284,
           'class_loss': 0.05435525,
           'conf_loss': 0.18921377,
           'precision50': 0.10187528,
           'recall50': 0.02691983},
     '4': {'avg_iou': 0.5488339,
           'avg_obj': 0.15394633,
           'box_loss': 0.020913038,
           'class_loss': 0.05452533,
           'conf_loss': 0.07289365,
           'precision50': 0.26146397,
           'recall50': 0.075000405},
     '5': {'avg_iou': 0.57103723,
           'avg_obj': 0.20926331,
           'box_loss': 0.019526036,
           'class_loss': 0.047045015,
           'conf_loss': 0.03472506,
           'precision50': 0.33355325,
           'recall50': 0.11790105},
     'global': {'total_loss': 4.129009},
     'learning_rate': 0.009985589,
     'training_loss': 4.129009}
I0513 11:53:13.230062 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-10000.
I0513 13:34:46.801050 140638711330624 controller.py:425] train | step:  20000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.55370927,
           'avg_obj': 0.12587695,
           'box_loss': 0.017968886,
           'class_loss': 0.010501556,
           'conf_loss': 0.028725296,
           'precision50': 0.30781937,
           'recall50': 0.047265552},
     '4': {'avg_iou': 0.68088245,
           'avg_obj': 0.23720345,
           'box_loss': 0.014436969,
           'class_loss': 0.009166903,
           'conf_loss': 0.023967216,
           'precision50': 0.54444385,
           'recall50': 0.16605917},
     '5': {'avg_iou': 0.7207965,
           'avg_obj': 0.32876453,
           'box_loss': 0.012469062,
           'class_loss': 0.007642018,
           'conf_loss': 0.014693477,
           'precision50': 0.6227872,
           'recall50': 0.28826913},
     'global': {'total_loss': 1.1165693},
     'learning_rate': 0.009942464,
     'training_loss': 1.1165693}
I0513 13:35:32.105465 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-20000.
I0513 13:35:32.111597 140638711330624 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0513 13:35:32.879334 140638711330624 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0513 13:35:50.957641 140638711330624 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0513 13:40:45.443067 140638711330624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0513 13:44:57.055755 140638711330624 controller.py:261]  eval | step:  20000 | eval time:  564.9 sec | output: 
    {'3': {'avg_iou': 0.48078525,
           'avg_obj': 0.12805682,
           'box_loss': 0.012778846,
           'class_loss': 0.0054963334,
           'conf_loss': 0.020891583,
           'precision50': 0.31178057,
           'recall50': 0.08007342},
     '4': {'avg_iou': 0.6924707,
           'avg_obj': 0.27829254,
           'box_loss': 0.011367992,
           'class_loss': 0.00487993,
           'conf_loss': 0.017174954,
           'precision50': 0.5706575,
           'recall50': 0.24579522},
     '5': {'avg_iou': 0.72872245,
           'avg_obj': 0.38571092,
           'box_loss': 0.009786718,
           'class_loss': 0.004227057,
           'conf_loss': 0.011826606,
           'precision50': 0.6811197,
           'recall50': 0.39777058},
     'AP': 0.24798734,
     'AP50': 0.42725986,
     'AP75': 0.2556592,
     'APl': 0.38303366,
     'APm': 0.24256735,
     'APs': 0.061013967,
     'ARl': 0.5915515,
     'ARm': 0.44948673,
     'ARmax1': 0.23492156,
     'ARmax10': 0.3844396,
     'ARmax100': 0.4223944,
     'ARs': 0.17409441,
     'global': {'total_loss': 0.09843003},
     'validation_loss': 0.09843003}

yolo_fpn (YoloFPN)              {'5': (None, 16, 16, 9626112     input_2[0][0]                    
                                                                 input_3[0][0]                    
                                                                 input_4[0][0]                    
__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'3': (None, 64, 64, 16271360    yolo_fpn[0][0]                   
                                                                 yolo_fpn[0][1]                   
                                                                 yolo_fpn[0][2]                   
==================================================================================================
Total params: 25,897,472
Trainable params: 25,867,520
Non-trainable params: 29,952
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
[[15.0, 20.0], [23.0, 45.0], [50.0, 35.0], [45.0, 93.0], [95.0, 68.0], [90.0, 182.0], [177.0, 137.0], [240.0, 303.0], [573.0, 501.0]]
[[15.0, 20.0], [23.0, 45.0], [50.0, 35.0], [45.0, 93.0], [95.0, 68.0], [90.0, 182.0], [177.0, 137.0], [240.0, 303.0], [573.0, 501.0]]
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 400, 8), 5: (8, 200, 8)}, inds: {3: (8, 600, 3), 4: (8, 400, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
[[15.0, 20.0], [23.0, 45.0], [50.0, 35.0], [45.0, 93.0], [95.0, 68.0], [90.0, 182.0], [177.0, 137.0], [240.0, 303.0], [573.0, 501.0]]
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
train | step:  10000 | steps/sec:    1.5 | output: 
    {'3': {'avg_iou': 0.44687593,
           'avg_obj': 0.08357892,
           'box_loss': 0.0229284,
           'class_loss': 0.05435525,
           'conf_loss': 0.18921377,
           'precision50': 0.10187528,
           'recall50': 0.02691983},
     '4': {'avg_iou': 0.5488339,
           'avg_obj': 0.15394633,
           'box_loss': 0.020913038,
           'class_loss': 0.05452533,
           'conf_loss': 0.07289365,
           'precision50': 0.26146397,
           'recall50': 0.075000405},
     '5': {'avg_iou': 0.57103723,
           'avg_obj': 0.20926331,
           'box_loss': 0.019526036,
           'class_loss': 0.047045015,
           'conf_loss': 0.03472506,
           'precision50': 0.33355325,
           'recall50': 0.11790105},
     'global': {'total_loss': 4.129009},
     'learning_rate': 0.009985589,
     'training_loss': 4.129009}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-10000.
train | step:  20000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.55370927,
           'avg_obj': 0.12587695,
           'box_loss': 0.017968886,
           'class_loss': 0.010501556,
           'conf_loss': 0.028725296,
           'precision50': 0.30781937,
           'recall50': 0.047265552},
     '4': {'avg_iou': 0.68088245,
           'avg_obj': 0.23720345,
           'box_loss': 0.014436969,
           'class_loss': 0.009166903,
           'conf_loss': 0.023967216,
           'precision50': 0.54444385,
           'recall50': 0.16605917},
     '5': {'avg_iou': 0.7207965,
           'avg_obj': 0.32876453,
           'box_loss': 0.012469062,
           'class_loss': 0.007642018,
           'conf_loss': 0.014693477,
           'precision50': 0.6227872,
           'recall50': 0.28826913},
     'global': {'total_loss': 1.1165693},
     'learning_rate': 0.009942464,
     'training_loss': 1.1165693}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-20000.
 eval | step:  20000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=175.24s).
Accumulating evaluation results...
DONE (t=18.56s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.248
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.427
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.256
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.061
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.243
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.383
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.235
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.384
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.422
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.174
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.449
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.592
 eval | step:  20000 | eval time:  564.9 sec | output: 
    {'3': {'avg_iou': 0.48078525,
           'avg_obj': 0.12805682,
           'box_loss': 0.012778846,
           'class_loss': 0.0054963334,
           'conf_loss': 0.020891583,
           'precision50': 0.31178057,
           'recall50': 0.08007342},
     '4': {'avg_iou': 0.6924707,
           'avg_obj': 0.27829254,
           'box_loss': 0.011367992,
           'class_loss': 0.00487993,
           'conf_loss': 0.017174954,
           'precision50': 0.5706575,
           'recall50': 0.24579522},
     '5': {'avg_iou': 0.72872245,
           'avg_obj': 0.38571092,
           'box_loss': 0.009786718,
           'class_loss': 0.004227057,
           'conf_loss': 0.011826606,
           'precision50': 0.6811197,
           'recall50': 0.39777058},
     'AP': 0.24798734,
     'AP50': 0.42725986,
     'AP75': 0.2556592,
     'APl': 0.38303366,
     'APm': 0.24256735,
     'APs': 0.061013967,
     'ARl': 0.5915515,
     'ARm': 0.44948673,
     'ARmax1': 0.23492156,
     'ARmax10': 0.3844396,
     'ARmax100': 0.4223944,
     'ARs': 0.17409441,
     'global': {'total_loss': 0.09843003},
     'validation_loss': 0.09843003}I0513 13:45:22.186197 140638711330624 controller.py:211] train | step:  20000 | training until step 40000...
I0513 15:27:18.000982 140638711330624 controller.py:425] train | step:  30000 | steps/sec:    1.5 | output: 
    {'3': {'avg_iou': 0.57711136,
           'avg_obj': 0.15379874,
           'box_loss': 0.017000541,
           'class_loss': 0.00901207,
           'conf_loss': 0.027966956,
           'precision50': 0.37741795,
           'recall50': 0.07142526},
     '4': {'avg_iou': 0.71030974,
           'avg_obj': 0.2792303,
           'box_loss': 0.0130641665,
           'class_loss': 0.007544966,
           'conf_loss': 0.023094865,
           'precision50': 0.5986312,
           'recall50': 0.22241892},
     '5': {'avg_iou': 0.7521483,
           'avg_obj': 0.3782706,
           'box_loss': 0.010996737,
           'class_loss': 0.0062093344,
           'conf_loss': 0.013986305,
           'precision50': 0.664724,
           'recall50': 0.36179164},
     'global': {'total_loss': 1.0310086},
     'learning_rate': 0.0098709315,
     'training_loss': 1.0310086}
I0513 15:28:04.956396 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-30000.
I0513 17:08:35.952983 140638711330624 controller.py:425] train | step:  40000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.5915644,
           'avg_obj': 0.17258438,
           'box_loss': 0.016390806,
           'class_loss': 0.008171762,
           'conf_loss': 0.027321378,
           'precision50': 0.4148603,
           'recall50': 0.08924885},
     '4': {'avg_iou': 0.72720414,
           'avg_obj': 0.30593976,
           'box_loss': 0.012256577,
           'class_loss': 0.0066535505,
           'conf_loss': 0.022389203,
           'precision50': 0.62411404,
           'recall50': 0.25839496},
     '5': {'avg_iou': 0.76946217,
           'avg_obj': 0.40815872,
           'box_loss': 0.010176776,
           'class_loss': 0.005458091,
           'conf_loss': 0.013486801,
           'precision50': 0.68319124,
           'recall50': 0.40263325},
     'global': {'total_loss': 0.9784404},
     'learning_rate': 0.00977151,
     'training_loss': 0.9784404}
I0513 17:09:22.080837 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-40000.
I0513 17:09:22.086343 140638711330624 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0513 17:13:27.921224 140638711330624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0513 17:17:44.272150 140638711330624 controller.py:261]  eval | step:  40000 | eval time:  502.2 sec | output: 
    {'3': {'avg_iou': 0.50264114,
           'avg_obj': 0.16086324,
           'box_loss': 0.011672672,
           'class_loss': 0.0043159747,
           'conf_loss': 0.020084653,
           'precision50': 0.37439567,
           'recall50': 0.12010115},
     '4': {'avg_iou': 0.71915907,
           'avg_obj': 0.33458093,
           'box_loss': 0.010018595,
           'class_loss': 0.0036519158,
           'conf_loss': 0.01617699,
           'precision50': 0.6269808,
           'recall50': 0.32577544},
     '5': {'avg_iou': 0.75428784,
           'avg_obj': 0.4448828,
           'box_loss': 0.008494868,
           'class_loss': 0.0032504238,
           'conf_loss': 0.010870654,
           'precision50': 0.71237236,
           'recall50': 0.483169},
     'AP': 0.31268793,
     'AP50': 0.50603336,
     'AP75': 0.3266842,
     'APl': 0.47020862,
     'APm': 0.31550837,
     'APs': 0.09423001,
     'ARl': 0.6465824,
     'ARm': 0.51331073,
     'ARmax1': 0.2714535,
     'ARmax10': 0.43858624,
     'ARmax100': 0.4786093,
     'ARs': 0.23115942,
     'global': {'total_loss': 0.08853673},
     'validation_loss': 0.08853673}
I0513 17:18:01.492461 140638711330624 controller.py:211] train | step:  40000 | training until step 60000...
I0513 18:57:16.988184 140638711330624 controller.py:425] train | step:  50000 | steps/sec:    1.5 | output: 
    {'3': {'avg_iou': 0.6013077,
           'avg_obj': 0.18568528,
           'box_loss': 0.015944887,
           'class_loss': 0.007632094,
           'conf_loss': 0.026833858,
           'precision50': 0.43624854,
           'recall50': 0.10210041},
     '4': {'avg_iou': 0.738465,
           'avg_obj': 0.32421324,
           'box_loss': 0.011716014,
           'class_loss': 0.0060963007,
           'conf_loss': 0.021880902,
           'precision50': 0.6388536,
           'recall50': 0.28257096},
     '5': {'avg_iou': 0.7811081,
           'avg_obj': 0.4287794,
           'box_loss': 0.009623019,
           'class_loss': 0.0049798093,
           'conf_loss': 0.0131279025,
           'precision50': 0.6943887,
           'recall50': 0.42972252},
     'global': {'total_loss': 0.9426779},
     'learning_rate': 0.0096449135,
     'training_loss': 0.9426779}
I0513 18:58:04.248611 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-50000.
I0513 20:31:32.669363 140638711330624 controller.py:425] train | step:  60000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6084426,
           'avg_obj': 0.19575585,
           'box_loss': 0.015657632,
           'class_loss': 0.0072308145,
           'conf_loss': 0.026568426,
           'precision50': 0.45207748,
           'recall50': 0.11233279},
     '4': {'avg_iou': 0.74676996,
           'avg_obj': 0.33872977,
           'box_loss': 0.01132885,
           'class_loss': 0.0056812293,
           'conf_loss': 0.021545285,
           'precision50': 0.6502699,
           'recall50': 0.30151275},
     '5': {'avg_iou': 0.78947085,
           'avg_obj': 0.4450917,
           'box_loss': 0.009233435,
           'class_loss': 0.004637861,
           'conf_loss': 0.01285335,
           'precision50': 0.7030974,
           'recall50': 0.44993013},
     'global': {'total_loss': 0.9178932},
     'learning_rate': 0.009492056,
     'training_loss': 0.9178932}
I0513 20:32:19.980658 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-60000.
I0513 20:32:19.988219 140638711330624 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0513 20:36:29.308079 140638711330624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0513 20:40:44.570772 140638711330624 controller.py:261]  eval | step:  60000 | eval time:  504.6 sec | output: 
    {'3': {'avg_iou': 0.5129465,
           'avg_obj': 0.17822847,
           'box_loss': 0.011153878,
           'class_loss': 0.003900232,
           'conf_loss': 0.019727098,
           'precision50': 0.39867818,
           'recall50': 0.14195593},
     '4': {'avg_iou': 0.73136103,
           'avg_obj': 0.363726,
           'box_loss': 0.00940134,
           'class_loss': 0.0032350689,
           'conf_loss': 0.015750304,
           'precision50': 0.65096146,
           'recall50': 0.36790806},
     '5': {'avg_iou': 0.76532793,
           'avg_obj': 0.47573355,
           'box_loss': 0.0079369275,
           'class_loss': 0.0029045106,
           'conf_loss': 0.010538882,
           'precision50': 0.7258386,
           'recall50': 0.5239627},
     'AP': 0.3407981,
     'AP50': 0.5363688,
     'AP75': 0.36367017,
     'APl': 0.50924647,
     'APm': 0.34481314,
     'APs': 0.11030261,
     'ARl': 0.67507666,
     'ARm': 0.543709,
     'ARmax1': 0.2908546,
     'ARmax10': 0.4644532,
     'ARmax100': 0.50482947,
     'ARs': 0.2497613,
     'global': {'total_loss': 0.08454826},
     'validation_loss': 0.08454826}

train | step:  20000 | training until step 40000...
train | step:  30000 | steps/sec:    1.5 | output: 
    {'3': {'avg_iou': 0.57711136,
           'avg_obj': 0.15379874,
           'box_loss': 0.017000541,
           'class_loss': 0.00901207,
           'conf_loss': 0.027966956,
           'precision50': 0.37741795,
           'recall50': 0.07142526},
     '4': {'avg_iou': 0.71030974,
           'avg_obj': 0.2792303,
           'box_loss': 0.0130641665,
           'class_loss': 0.007544966,
           'conf_loss': 0.023094865,
           'precision50': 0.5986312,
           'recall50': 0.22241892},
     '5': {'avg_iou': 0.7521483,
           'avg_obj': 0.3782706,
           'box_loss': 0.010996737,
           'class_loss': 0.0062093344,
           'conf_loss': 0.013986305,
           'precision50': 0.664724,
           'recall50': 0.36179164},
     'global': {'total_loss': 1.0310086},
     'learning_rate': 0.0098709315,
     'training_loss': 1.0310086}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-30000.
train | step:  40000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.5915644,
           'avg_obj': 0.17258438,
           'box_loss': 0.016390806,
           'class_loss': 0.008171762,
           'conf_loss': 0.027321378,
           'precision50': 0.4148603,
           'recall50': 0.08924885},
     '4': {'avg_iou': 0.72720414,
           'avg_obj': 0.30593976,
           'box_loss': 0.012256577,
           'class_loss': 0.0066535505,
           'conf_loss': 0.022389203,
           'precision50': 0.62411404,
           'recall50': 0.25839496},
     '5': {'avg_iou': 0.76946217,
           'avg_obj': 0.40815872,
           'box_loss': 0.010176776,
           'class_loss': 0.005458091,
           'conf_loss': 0.013486801,
           'precision50': 0.68319124,
           'recall50': 0.40263325},
     'global': {'total_loss': 0.9784404},
     'learning_rate': 0.00977151,
     'training_loss': 0.9784404}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-40000.
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=179.61s).
Accumulating evaluation results...
DONE (t=15.99s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.313
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.506
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.327
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.094
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.316
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.470
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.271
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.439
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.479
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.231
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.513
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.647
 eval | step:  40000 | eval time:  502.2 sec | output: 
    {'3': {'avg_iou': 0.50264114,
           'avg_obj': 0.16086324,
           'box_loss': 0.011672672,
           'class_loss': 0.0043159747,
           'conf_loss': 0.020084653,
           'precision50': 0.37439567,
           'recall50': 0.12010115},
     '4': {'avg_iou': 0.71915907,
           'avg_obj': 0.33458093,
           'box_loss': 0.010018595,
           'class_loss': 0.0036519158,
           'conf_loss': 0.01617699,
           'precision50': 0.6269808,
           'recall50': 0.32577544},
     '5': {'avg_iou': 0.75428784,
           'avg_obj': 0.4448828,
           'box_loss': 0.008494868,
           'class_loss': 0.0032504238,
           'conf_loss': 0.010870654,
           'precision50': 0.71237236,
           'recall50': 0.483169},
     'AP': 0.31268793,
     'AP50': 0.50603336,
     'AP75': 0.3266842,
     'APl': 0.47020862,
     'APm': 0.31550837,
     'APs': 0.09423001,
     'ARl': 0.6465824,
     'ARm': 0.51331073,
     'ARmax1': 0.2714535,
     'ARmax10': 0.43858624,
     'ARmax100': 0.4786093,
     'ARs': 0.23115942,
     'global': {'total_loss': 0.08853673},
     'validation_loss': 0.08853673}
train | step:  40000 | training until step 60000...
train | step:  50000 | steps/sec:    1.5 | output: 
    {'3': {'avg_iou': 0.6013077,
           'avg_obj': 0.18568528,
           'box_loss': 0.015944887,
           'class_loss': 0.007632094,
           'conf_loss': 0.026833858,
           'precision50': 0.43624854,
           'recall50': 0.10210041},
     '4': {'avg_iou': 0.738465,
           'avg_obj': 0.32421324,
           'box_loss': 0.011716014,
           'class_loss': 0.0060963007,
           'conf_loss': 0.021880902,
           'precision50': 0.6388536,
           'recall50': 0.28257096},
     '5': {'avg_iou': 0.7811081,
           'avg_obj': 0.4287794,
           'box_loss': 0.009623019,
           'class_loss': 0.0049798093,
           'conf_loss': 0.0131279025,
           'precision50': 0.6943887,
           'recall50': 0.42972252},
     'global': {'total_loss': 0.9426779},
     'learning_rate': 0.0096449135,
     'training_loss': 0.9426779}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-50000.
train | step:  60000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6084426,
           'avg_obj': 0.19575585,
           'box_loss': 0.015657632,
           'class_loss': 0.0072308145,
           'conf_loss': 0.026568426,
           'precision50': 0.45207748,
           'recall50': 0.11233279},
     '4': {'avg_iou': 0.74676996,
           'avg_obj': 0.33872977,
           'box_loss': 0.01132885,
           'class_loss': 0.0056812293,
           'conf_loss': 0.021545285,
           'precision50': 0.6502699,
           'recall50': 0.30151275},
     '5': {'avg_iou': 0.78947085,
           'avg_obj': 0.4450917,
           'box_loss': 0.009233435,
           'class_loss': 0.004637861,
           'conf_loss': 0.01285335,
           'precision50': 0.7030974,
           'recall50': 0.44993013},
     'global': {'total_loss': 0.9178932},
     'learning_rate': 0.009492056,
     'training_loss': 0.9178932}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-60000.
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=178.26s).
Accumulating evaluation results...
DONE (t=16.24s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.341
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.536
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.364
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.110
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.345
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.509
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.291
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.464
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.505
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.250
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.544
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.675
 eval | step:  60000 | eval time:  504.6 sec | output: 
    {'3': {'avg_iou': 0.5129465,
           'avg_obj': 0.17822847,
           'box_loss': 0.011153878,
           'class_loss': 0.003900232,
           'conf_loss': 0.019727098,
           'precision50': 0.39867818,
           'recall50': 0.14195593},
     '4': {'avg_iou': 0.73136103,
           'avg_obj': 0.363726,
           'box_loss': 0.00940134,
           'class_loss': 0.0032350689,
           'conf_loss': 0.015750304,
           'precision50': 0.65096146,
           'recall50': 0.36790806},
     '5': {'avg_iou': 0.76532793,
           'avg_obj': 0.47573355,
           'box_loss': 0.0079369275,
           'class_loss': 0.0029045106,
           'conf_loss': 0.010538882,
           'precision50': 0.7258386,
           'recall50': 0.5239627},
     'AP': 0.3407981,
     'AP50': 0.5363688,
     'AP75': 0.36367017,
     'APl': 0.50924647,
     'APm': 0.34481314,
     'APs': 0.11030261,
     'ARl': 0.67507666,
     'ARm': 0.543709,
     'ARmax1': 0.2908546,
     'ARmax10': 0.4644532,
     'ARmax100': 0.50482947,
     'ARs': 0.2497613,
     'global': {'total_loss': 0.08454826},
     'validation_loss': 0.08454826}I0513 20:41:06.125890 140638711330624 controller.py:211] train | step:  60000 | training until step 80000...
I0513 22:17:37.815745 140638711330624 controller.py:425] train | step:  70000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.61385953,
           'avg_obj': 0.2042715,
           'box_loss': 0.015435496,
           'class_loss': 0.0069325487,
           'conf_loss': 0.026228061,
           'precision50': 0.46438852,
           'recall50': 0.12092494},
     '4': {'avg_iou': 0.7535124,
           'avg_obj': 0.35039386,
           'box_loss': 0.011004668,
           'class_loss': 0.005378795,
           'conf_loss': 0.02120118,
           'precision50': 0.65844095,
           'recall50': 0.31647786},
     '5': {'avg_iou': 0.79632175,
           'avg_obj': 0.45800275,
           'box_loss': 0.008908278,
           'class_loss': 0.0043723215,
           'conf_loss': 0.012622295,
           'precision50': 0.708547,
           'recall50': 0.46554673},
     'global': {'total_loss': 0.8966711},
     'learning_rate': 0.009314038,
     'training_loss': 0.8966711}
I0513 22:18:28.131547 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-70000.
I0513 23:56:42.025607 140638711330624 controller.py:425] train | step:  80000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.61885405,
           'avg_obj': 0.21155477,
           'box_loss': 0.015213023,
           'class_loss': 0.006680091,
           'conf_loss': 0.026030004,
           'precision50': 0.47368366,
           'recall50': 0.12811857},
     '4': {'avg_iou': 0.75894105,
           'avg_obj': 0.3607271,
           'box_loss': 0.01074541,
           'class_loss': 0.005114722,
           'conf_loss': 0.020943541,
           'precision50': 0.6652055,
           'recall50': 0.32985216},
     '5': {'avg_iou': 0.80184305,
           'avg_obj': 0.46885028,
           'box_loss': 0.008655929,
           'class_loss': 0.0041531967,
           'conf_loss': 0.012428681,
           'precision50': 0.71362317,
           'recall50': 0.47895578},
     'global': {'total_loss': 0.8797159},
     'learning_rate': 0.009112143,
     'training_loss': 0.8797159}
I0513 23:57:36.662855 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-80000.
I0513 23:57:36.669932 140638711330624 controller.py:252]  eval | step:  80000 | running 625 steps of evaluation...
I0514 00:02:02.148225 140638711330624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0514 00:06:18.475924 140638711330624 controller.py:261]  eval | step:  80000 | eval time:  521.8 sec | output: 
    {'3': {'avg_iou': 0.5186374,
           'avg_obj': 0.18876705,
           'box_loss': 0.010867372,
           'class_loss': 0.0036508262,
           'conf_loss': 0.019476086,
           'precision50': 0.41447026,
           'recall50': 0.15538985},
     '4': {'avg_iou': 0.73846626,
           'avg_obj': 0.38150746,
           'box_loss': 0.009042487,
           'class_loss': 0.0030084865,
           'conf_loss': 0.015494853,
           'precision50': 0.6548255,
           'recall50': 0.3904186},
     '5': {'avg_iou': 0.77156144,
           'avg_obj': 0.4940711,
           'box_loss': 0.007622638,
           'class_loss': 0.002754353,
           'conf_loss': 0.010262635,
           'precision50': 0.7311057,
           'recall50': 0.5453176},
     'AP': 0.3562629,
     'AP50': 0.5539281,
     'AP75': 0.37696603,
     'APl': 0.5262064,
     'APm': 0.36409026,
     'APs': 0.12241226,
     'ARl': 0.68655384,
     'ARm': 0.56253844,
     'ARmax1': 0.30112705,
     'ARmax10': 0.47754958,
     'ARmax100': 0.5193297,
     'ARs': 0.27328035,
     'global': {'total_loss': 0.08217972},
     'validation_loss': 0.08217972}
I0514 00:06:50.815161 140638711330624 controller.py:211] train | step:  80000 | training until step 100000...
I0514 01:47:27.211477 140638711330624 controller.py:425] train | step:  90000 | steps/sec:    1.5 | output: 
    {'3': {'avg_iou': 0.62303704,
           'avg_obj': 0.21796717,
           'box_loss': 0.01503712,
           'class_loss': 0.006454425,
           'conf_loss': 0.025822269,
           'precision50': 0.4818851,
           'recall50': 0.13490175},
     '4': {'avg_iou': 0.76368785,
           'avg_obj': 0.3693366,
           'box_loss': 0.010529598,
           'class_loss': 0.0049100854,
           'conf_loss': 0.020707574,
           'precision50': 0.6704782,
           'recall50': 0.3404851},
     '5': {'avg_iou': 0.8070227,
           'avg_obj': 0.4788106,
           'box_loss': 0.008427144,
           'class_loss': 0.0039809844,
           'conf_loss': 0.012250711,
           'precision50': 0.71883786,
           'recall50': 0.49049208},
     'global': {'total_loss': 0.86495966},
     'learning_rate': 0.008887824,
     'training_loss': 0.86495966}
I0514 01:48:18.164346 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-90000.
I0514 03:20:48.289865 140638711330624 controller.py:425] train | step:  100000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6266157,
           'avg_obj': 0.2238886,
           'box_loss': 0.01489238,
           'class_loss': 0.0062579033,
           'conf_loss': 0.025629207,
           'precision50': 0.48964155,
           'recall50': 0.14079735},
     '4': {'avg_iou': 0.7678576,
           'avg_obj': 0.37757427,
           'box_loss': 0.010333958,
           'class_loss': 0.004716332,
           'conf_loss': 0.02046128,
           'precision50': 0.6746991,
           'recall50': 0.35017884},
     '5': {'avg_iou': 0.8112935,
           'avg_obj': 0.48775685,
           'box_loss': 0.008222487,
           'class_loss': 0.0038092693,
           'conf_loss': 0.0120718265,
           'precision50': 0.7222014,
           'recall50': 0.5006183},
     'global': {'total_loss': 0.8511576},
     'learning_rate': 0.008642699,
     'training_loss': 0.8511576}
I0514 03:21:37.604691 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-100000.
I0514 03:21:37.610712 140638711330624 controller.py:252]  eval | step:  100000 | running 625 steps of evaluation...
I0514 03:26:02.555712 140638711330624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0514 03:30:10.168312 140638711330624 controller.py:261]  eval | step:  100000 | eval time:  512.6 sec | output: 
    {'3': {'avg_iou': 0.5224511,
           'avg_obj': 0.1967842,
           'box_loss': 0.010675131,
           'class_loss': 0.0035224028,
           'conf_loss': 0.01934543,
           'precision50': 0.42313915,
           'recall50': 0.16537167},
     '4': {'avg_iou': 0.7428152,
           'avg_obj': 0.3933524,
           'box_loss': 0.008823399,
           'class_loss': 0.002955745,
           'conf_loss': 0.015343009,
           'precision50': 0.6597291,
           'recall50': 0.4078709},
     '5': {'avg_iou': 0.7755281,
           'avg_obj': 0.507125,
           'box_loss': 0.007422483,
           'class_loss': 0.0026732925,
           'conf_loss': 0.010157291,
           'precision50': 0.73021793,
           'recall50': 0.55924326},
     'AP': 0.36744583,
     'AP50': 0.56722355,
     'AP75': 0.39083335,
     'APl': 0.5421883,
     'APm': 0.37805974,
     'APs': 0.13295199,
     'ARl': 0.698048,
     'ARm': 0.56630594,
     'ARmax1': 0.30522245,
     'ARmax10': 0.48565015,
     'ARmax100': 0.52689266,
     'ARs': 0.2801075,
     'global': {'total_loss': 0.08091812},
     'validation_loss': 0.08091812}

train | step:  60000 | training until step 80000...
train | step:  70000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.61385953,
           'avg_obj': 0.2042715,
           'box_loss': 0.015435496,
           'class_loss': 0.0069325487,
           'conf_loss': 0.026228061,
           'precision50': 0.46438852,
           'recall50': 0.12092494},
     '4': {'avg_iou': 0.7535124,
           'avg_obj': 0.35039386,
           'box_loss': 0.011004668,
           'class_loss': 0.005378795,
           'conf_loss': 0.02120118,
           'precision50': 0.65844095,
           'recall50': 0.31647786},
     '5': {'avg_iou': 0.79632175,
           'avg_obj': 0.45800275,
           'box_loss': 0.008908278,
           'class_loss': 0.0043723215,
           'conf_loss': 0.012622295,
           'precision50': 0.708547,
           'recall50': 0.46554673},
     'global': {'total_loss': 0.8966711},
     'learning_rate': 0.009314038,
     'training_loss': 0.8966711}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-70000.
train | step:  80000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.61885405,
           'avg_obj': 0.21155477,
           'box_loss': 0.015213023,
           'class_loss': 0.006680091,
           'conf_loss': 0.026030004,
           'precision50': 0.47368366,
           'recall50': 0.12811857},
     '4': {'avg_iou': 0.75894105,
           'avg_obj': 0.3607271,
           'box_loss': 0.01074541,
           'class_loss': 0.005114722,
           'conf_loss': 0.020943541,
           'precision50': 0.6652055,
           'recall50': 0.32985216},
     '5': {'avg_iou': 0.80184305,
           'avg_obj': 0.46885028,
           'box_loss': 0.008655929,
           'class_loss': 0.0041531967,
           'conf_loss': 0.012428681,
           'precision50': 0.71362317,
           'recall50': 0.47895578},
     'global': {'total_loss': 0.8797159},
     'learning_rate': 0.009112143,
     'training_loss': 0.8797159}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-80000.
 eval | step:  80000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=179.27s).
Accumulating evaluation results...
DONE (t=15.07s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.356
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.554
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.377
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.122
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.364
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.526
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.301
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.478
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.519
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.273
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.563
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.687
 eval | step:  80000 | eval time:  521.8 sec | output: 
    {'3': {'avg_iou': 0.5186374,
           'avg_obj': 0.18876705,
           'box_loss': 0.010867372,
           'class_loss': 0.0036508262,
           'conf_loss': 0.019476086,
           'precision50': 0.41447026,
           'recall50': 0.15538985},
     '4': {'avg_iou': 0.73846626,
           'avg_obj': 0.38150746,
           'box_loss': 0.009042487,
           'class_loss': 0.0030084865,
           'conf_loss': 0.015494853,
           'precision50': 0.6548255,
           'recall50': 0.3904186},
     '5': {'avg_iou': 0.77156144,
           'avg_obj': 0.4940711,
           'box_loss': 0.007622638,
           'class_loss': 0.002754353,
           'conf_loss': 0.010262635,
           'precision50': 0.7311057,
           'recall50': 0.5453176},
     'AP': 0.3562629,
     'AP50': 0.5539281,
     'AP75': 0.37696603,
     'APl': 0.5262064,
     'APm': 0.36409026,
     'APs': 0.12241226,
     'ARl': 0.68655384,
     'ARm': 0.56253844,
     'ARmax1': 0.30112705,
     'ARmax10': 0.47754958,
     'ARmax100': 0.5193297,
     'ARs': 0.27328035,
     'global': {'total_loss': 0.08217972},
     'validation_loss': 0.08217972}
train | step:  80000 | training until step 100000...
train | step:  90000 | steps/sec:    1.5 | output: 
    {'3': {'avg_iou': 0.62303704,
           'avg_obj': 0.21796717,
           'box_loss': 0.01503712,
           'class_loss': 0.006454425,
           'conf_loss': 0.025822269,
           'precision50': 0.4818851,
           'recall50': 0.13490175},
     '4': {'avg_iou': 0.76368785,
           'avg_obj': 0.3693366,
           'box_loss': 0.010529598,
           'class_loss': 0.0049100854,
           'conf_loss': 0.020707574,
           'precision50': 0.6704782,
           'recall50': 0.3404851},
     '5': {'avg_iou': 0.8070227,
           'avg_obj': 0.4788106,
           'box_loss': 0.008427144,
           'class_loss': 0.0039809844,
           'conf_loss': 0.012250711,
           'precision50': 0.71883786,
           'recall50': 0.49049208},
     'global': {'total_loss': 0.86495966},
     'learning_rate': 0.008887824,
     'training_loss': 0.86495966}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-90000.
train | step:  100000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6266157,
           'avg_obj': 0.2238886,
           'box_loss': 0.01489238,
           'class_loss': 0.0062579033,
           'conf_loss': 0.025629207,
           'precision50': 0.48964155,
           'recall50': 0.14079735},
     '4': {'avg_iou': 0.7678576,
           'avg_obj': 0.37757427,
           'box_loss': 0.010333958,
           'class_loss': 0.004716332,
           'conf_loss': 0.02046128,
           'precision50': 0.6746991,
           'recall50': 0.35017884},
     '5': {'avg_iou': 0.8112935,
           'avg_obj': 0.48775685,
           'box_loss': 0.008222487,
           'class_loss': 0.0038092693,
           'conf_loss': 0.0120718265,
           'precision50': 0.7222014,
           'recall50': 0.5006183},
     'global': {'total_loss': 0.8511576},
     'learning_rate': 0.008642699,
     'training_loss': 0.8511576}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-100000.
 eval | step:  100000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=178.99s).
Accumulating evaluation results...
DONE (t=13.95s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.367
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.567
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.391
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.133
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.378
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.542
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.305
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.486
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.527
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.280
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.566
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.698
 eval | step:  100000 | eval time:  512.6 sec | output: 
    {'3': {'avg_iou': 0.5224511,
           'avg_obj': 0.1967842,
           'box_loss': 0.010675131,
           'class_loss': 0.0035224028,
           'conf_loss': 0.01934543,
           'precision50': 0.42313915,
           'recall50': 0.16537167},
     '4': {'avg_iou': 0.7428152,
           'avg_obj': 0.3933524,
           'box_loss': 0.008823399,
           'class_loss': 0.002955745,
           'conf_loss': 0.015343009,
           'precision50': 0.6597291,
           'recall50': 0.4078709},
     '5': {'avg_iou': 0.7755281,
           'avg_obj': 0.507125,
           'box_loss': 0.007422483,
           'class_loss': 0.0026732925,
           'conf_loss': 0.010157291,
           'precision50': 0.73021793,
           'recall50': 0.55924326},
     'AP': 0.36744583,
     'AP50': 0.56722355,
     'AP75': 0.39083335,
     'APl': 0.5421883,
     'APm': 0.37805974,
     'APs': 0.13295199,
     'ARl': 0.698048,
     'ARm': 0.56630594,
     'ARmax1': 0.30522245,
     'ARmax10': 0.48565015,
     'ARmax100': 0.52689266,
     'ARs': 0.2801075,
     'global': {'total_loss': 0.08091812},
     'validation_loss': 0.08091812}I0514 03:30:33.202827 140638711330624 controller.py:211] train | step:  100000 | training until step 120000...
I0514 05:04:58.154361 140638711330624 controller.py:425] train | step:  110000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.62948406,
           'avg_obj': 0.22867861,
           'box_loss': 0.014762706,
           'class_loss': 0.0060974443,
           'conf_loss': 0.025441717,
           'precision50': 0.4951439,
           'recall50': 0.14599851},
     '4': {'avg_iou': 0.77170354,
           'avg_obj': 0.38515946,
           'box_loss': 0.010154909,
           'class_loss': 0.0045567784,
           'conf_loss': 0.020255238,
           'precision50': 0.6804889,
           'recall50': 0.36023536},
     '5': {'avg_iou': 0.81528956,
           'avg_obj': 0.49613634,
           'box_loss': 0.008037128,
           'class_loss': 0.003688679,
           'conf_loss': 0.011926649,
           'precision50': 0.7262843,
           'recall50': 0.5104411},
     'global': {'total_loss': 0.83936787},
     'learning_rate': 0.008378533,
     'training_loss': 0.83936787}
I0514 05:05:48.003156 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-110000.
I0514 06:43:37.784353 140638711330624 controller.py:425] train | step:  120000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6321477,
           'avg_obj': 0.2335685,
           'box_loss': 0.014650917,
           'class_loss': 0.00598098,
           'conf_loss': 0.025274888,
           'precision50': 0.50218457,
           'recall50': 0.15174653},
     '4': {'avg_iou': 0.7749666,
           'avg_obj': 0.3918334,
           'box_loss': 0.010002253,
           'class_loss': 0.0044163116,
           'conf_loss': 0.020052304,
           'precision50': 0.6843725,
           'recall50': 0.36869887},
     '5': {'avg_iou': 0.8187205,
           'avg_obj': 0.5040578,
           'box_loss': 0.007879223,
           'class_loss': 0.0035564918,
           'conf_loss': 0.0117679965,
           'precision50': 0.72890276,
           'recall50': 0.5188057},
     'global': {'total_loss': 0.82864827},
     'learning_rate': 0.008097229,
     'training_loss': 0.82864827}
I0514 06:44:25.222778 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-120000.
I0514 06:44:25.228897 140638711330624 controller.py:252]  eval | step:  120000 | running 625 steps of evaluation...
I0514 06:48:45.271721 140638711330624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0514 06:52:58.157154 140638711330624 controller.py:261]  eval | step:  120000 | eval time:  512.9 sec | output: 
    {'3': {'avg_iou': 0.5248859,
           'avg_obj': 0.20196785,
           'box_loss': 0.01055166,
           'class_loss': 0.0034146518,
           'conf_loss': 0.019312257,
           'precision50': 0.42521548,
           'recall50': 0.1733905},
     '4': {'avg_iou': 0.74573,
           'avg_obj': 0.40260038,
           'box_loss': 0.008675837,
           'class_loss': 0.0028941564,
           'conf_loss': 0.015308429,
           'precision50': 0.66103894,
           'recall50': 0.42103803},
     '5': {'avg_iou': 0.778357,
           'avg_obj': 0.5164279,
           'box_loss': 0.007279602,
           'class_loss': 0.0026262894,
           'conf_loss': 0.010152012,
           'precision50': 0.72772175,
           'recall50': 0.5707269},
     'AP': 0.37428808,
     'AP50': 0.571461,
     'AP75': 0.39492774,
     'APl': 0.5473827,
     'APm': 0.3854462,
     'APs': 0.13363156,
     'ARl': 0.70089704,
     'ARm': 0.57241434,
     'ARmax1': 0.31066826,
     'ARmax10': 0.49254686,
     'ARmax100': 0.5338669,
     'ARs': 0.284511,
     'global': {'total_loss': 0.08021487},
     'validation_loss': 0.08021487}
I0514 06:53:24.266510 140638711330624 controller.py:211] train | step:  120000 | training until step 140000...
I0514 08:28:25.322597 140638711330624 controller.py:425] train | step:  130000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.6348573,
           'avg_obj': 0.23842794,
           'box_loss': 0.01455454,
           'class_loss': 0.005843499,
           'conf_loss': 0.025140053,
           'precision50': 0.50683635,
           'recall50': 0.15619253},
     '4': {'avg_iou': 0.77787834,
           'avg_obj': 0.39816502,
           'box_loss': 0.009862741,
           'class_loss': 0.004293622,
           'conf_loss': 0.019879235,
           'precision50': 0.6876991,
           'recall50': 0.37631124},
     '5': {'avg_iou': 0.82220256,
           'avg_obj': 0.51094645,
           'box_loss': 0.0077150743,
           'class_loss': 0.0034612885,
           'conf_loss': 0.011628925,
           'precision50': 0.7320105,
           'recall50': 0.526418},
     'global': {'total_loss': 0.8190317},
     'learning_rate': 0.007800815,
     'training_loss': 0.8190317}
I0514 08:29:13.486184 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-130000.
I0514 10:03:48.336532 140638711330624 controller.py:425] train | step:  140000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6374503,
           'avg_obj': 0.242475,
           'box_loss': 0.014422937,
           'class_loss': 0.005709491,
           'conf_loss': 0.024977902,
           'precision50': 0.5113102,
           'recall50': 0.16080302},
     '4': {'avg_iou': 0.78065,
           'avg_obj': 0.40391526,
           'box_loss': 0.009732312,
           'class_loss': 0.0041698446,
           'conf_loss': 0.019712295,
           'precision50': 0.6908641,
           'recall50': 0.3831305},
     '5': {'avg_iou': 0.82503635,
           'avg_obj': 0.5178322,
           'box_loss': 0.0075888326,
           'class_loss': 0.0033492863,
           'conf_loss': 0.011502075,
           'precision50': 0.73533213,
           'recall50': 0.5338575},
     'global': {'total_loss': 0.80931747},
     'learning_rate': 0.007491425,
     'training_loss': 0.80931747}
I0514 10:04:36.859195 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-140000.
I0514 10:04:36.865520 140638711330624 controller.py:252]  eval | step:  140000 | running 625 steps of evaluation...
I0514 10:08:53.716267 140638711330624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0514 10:12:59.619154 140638711330624 controller.py:261]  eval | step:  140000 | eval time:  502.8 sec | output: 
    {'3': {'avg_iou': 0.526999,
           'avg_obj': 0.20593457,
           'box_loss': 0.010444737,
           'class_loss': 0.0033697593,
           'conf_loss': 0.019280944,
           'precision50': 0.43098184,
           'recall50': 0.17898153},
     '4': {'avg_iou': 0.7479167,
           'avg_obj': 0.4076695,
           'box_loss': 0.00856628,
           'class_loss': 0.0028555796,
           'conf_loss': 0.01532464,
           'precision50': 0.66214466,
           'recall50': 0.42780253},
     '5': {'avg_iou': 0.7797578,
           'avg_obj': 0.52156776,
           'box_loss': 0.007209246,
           'class_loss': 0.00261336,
           'conf_loss': 0.010147787,
           'precision50': 0.7280329,
           'recall50': 0.5725555},
     'AP': 0.37950355,
     'AP50': 0.5772524,
     'AP75': 0.40262192,
     'APl': 0.5518311,
     'APm': 0.39210016,
     'APs': 0.1383056,
     'ARl': 0.7065071,
     'ARm': 0.57909304,
     'ARmax1': 0.31379813,
     'ARmax10': 0.4985982,
     'ARmax100': 0.5392109,
     'ARs': 0.29373804,
     'global': {'total_loss': 0.07981237},
     'validation_loss': 0.07981237}

train | step:  100000 | training until step 120000...
train | step:  110000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.62948406,
           'avg_obj': 0.22867861,
           'box_loss': 0.014762706,
           'class_loss': 0.0060974443,
           'conf_loss': 0.025441717,
           'precision50': 0.4951439,
           'recall50': 0.14599851},
     '4': {'avg_iou': 0.77170354,
           'avg_obj': 0.38515946,
           'box_loss': 0.010154909,
           'class_loss': 0.0045567784,
           'conf_loss': 0.020255238,
           'precision50': 0.6804889,
           'recall50': 0.36023536},
     '5': {'avg_iou': 0.81528956,
           'avg_obj': 0.49613634,
           'box_loss': 0.008037128,
           'class_loss': 0.003688679,
           'conf_loss': 0.011926649,
           'precision50': 0.7262843,
           'recall50': 0.5104411},
     'global': {'total_loss': 0.83936787},
     'learning_rate': 0.008378533,
     'training_loss': 0.83936787}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-110000.
train | step:  120000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6321477,
           'avg_obj': 0.2335685,
           'box_loss': 0.014650917,
           'class_loss': 0.00598098,
           'conf_loss': 0.025274888,
           'precision50': 0.50218457,
           'recall50': 0.15174653},
     '4': {'avg_iou': 0.7749666,
           'avg_obj': 0.3918334,
           'box_loss': 0.010002253,
           'class_loss': 0.0044163116,
           'conf_loss': 0.020052304,
           'precision50': 0.6843725,
           'recall50': 0.36869887},
     '5': {'avg_iou': 0.8187205,
           'avg_obj': 0.5040578,
           'box_loss': 0.007879223,
           'class_loss': 0.0035564918,
           'conf_loss': 0.0117679965,
           'precision50': 0.72890276,
           'recall50': 0.5188057},
     'global': {'total_loss': 0.82864827},
     'learning_rate': 0.008097229,
     'training_loss': 0.82864827}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-120000.
 eval | step:  120000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=181.55s).
Accumulating evaluation results...
DONE (t=13.18s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.374
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.571
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.395
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.134
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.385
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.547
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.311
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.493
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.534
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.285
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.572
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.701
 eval | step:  120000 | eval time:  512.9 sec | output: 
    {'3': {'avg_iou': 0.5248859,
           'avg_obj': 0.20196785,
           'box_loss': 0.01055166,
           'class_loss': 0.0034146518,
           'conf_loss': 0.019312257,
           'precision50': 0.42521548,
           'recall50': 0.1733905},
     '4': {'avg_iou': 0.74573,
           'avg_obj': 0.40260038,
           'box_loss': 0.008675837,
           'class_loss': 0.0028941564,
           'conf_loss': 0.015308429,
           'precision50': 0.66103894,
           'recall50': 0.42103803},
     '5': {'avg_iou': 0.778357,
           'avg_obj': 0.5164279,
           'box_loss': 0.007279602,
           'class_loss': 0.0026262894,
           'conf_loss': 0.010152012,
           'precision50': 0.72772175,
           'recall50': 0.5707269},
     'AP': 0.37428808,
     'AP50': 0.571461,
     'AP75': 0.39492774,
     'APl': 0.5473827,
     'APm': 0.3854462,
     'APs': 0.13363156,
     'ARl': 0.70089704,
     'ARm': 0.57241434,
     'ARmax1': 0.31066826,
     'ARmax10': 0.49254686,
     'ARmax100': 0.5338669,
     'ARs': 0.284511,
     'global': {'total_loss': 0.08021487},
     'validation_loss': 0.08021487}
train | step:  120000 | training until step 140000...
train | step:  130000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.6348573,
           'avg_obj': 0.23842794,
           'box_loss': 0.01455454,
           'class_loss': 0.005843499,
           'conf_loss': 0.025140053,
           'precision50': 0.50683635,
           'recall50': 0.15619253},
     '4': {'avg_iou': 0.77787834,
           'avg_obj': 0.39816502,
           'box_loss': 0.009862741,
           'class_loss': 0.004293622,
           'conf_loss': 0.019879235,
           'precision50': 0.6876991,
           'recall50': 0.37631124},
     '5': {'avg_iou': 0.82220256,
           'avg_obj': 0.51094645,
           'box_loss': 0.0077150743,
           'class_loss': 0.0034612885,
           'conf_loss': 0.011628925,
           'precision50': 0.7320105,
           'recall50': 0.526418},
     'global': {'total_loss': 0.8190317},
     'learning_rate': 0.007800815,
     'training_loss': 0.8190317}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-130000.
train | step:  140000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6374503,
           'avg_obj': 0.242475,
           'box_loss': 0.014422937,
           'class_loss': 0.005709491,
           'conf_loss': 0.024977902,
           'precision50': 0.5113102,
           'recall50': 0.16080302},
     '4': {'avg_iou': 0.78065,
           'avg_obj': 0.40391526,
           'box_loss': 0.009732312,
           'class_loss': 0.0041698446,
           'conf_loss': 0.019712295,
           'precision50': 0.6908641,
           'recall50': 0.3831305},
     '5': {'avg_iou': 0.82503635,
           'avg_obj': 0.5178322,
           'box_loss': 0.0075888326,
           'class_loss': 0.0033492863,
           'conf_loss': 0.011502075,
           'precision50': 0.73533213,
           'recall50': 0.5338575},
     'global': {'total_loss': 0.80931747},
     'learning_rate': 0.007491425,
     'training_loss': 0.80931747}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-140000.
 eval | step:  140000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.93s).
Accumulating evaluation results...
DONE (t=12.54s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.380
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.577
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.403
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.138
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.392
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.552
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.314
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.499
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.539
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.294
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.579
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.707
 eval | step:  140000 | eval time:  502.8 sec | output: 
    {'3': {'avg_iou': 0.526999,
           'avg_obj': 0.20593457,
           'box_loss': 0.010444737,
           'class_loss': 0.0033697593,
           'conf_loss': 0.019280944,
           'precision50': 0.43098184,
           'recall50': 0.17898153},
     '4': {'avg_iou': 0.7479167,
           'avg_obj': 0.4076695,
           'box_loss': 0.00856628,
           'class_loss': 0.0028555796,
           'conf_loss': 0.01532464,
           'precision50': 0.66214466,
           'recall50': 0.42780253},
     '5': {'avg_iou': 0.7797578,
           'avg_obj': 0.52156776,
           'box_loss': 0.007209246,
           'class_loss': 0.00261336,
           'conf_loss': 0.010147787,
           'precision50': 0.7280329,
           'recall50': 0.5725555},
     'AP': 0.37950355,
     'AP50': 0.5772524,
     'AP75': 0.40262192,
     'APl': 0.5518311,
     'APm': 0.39210016,
     'APs': 0.1383056,
     'ARl': 0.7065071,
     'ARm': 0.57909304,
     'ARmax1': 0.31379813,
     'ARmax10': 0.4985982,
     'ARmax100': 0.5392109,
     'ARs': 0.29373804,
     'global': {'total_loss': 0.07981237},
     'validation_loss': 0.07981237}I0514 10:13:17.452800 140638711330624 controller.py:211] train | step:  140000 | training until step 160000...
I0514 11:43:35.006396 140638711330624 controller.py:425] train | step:  150000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6395722,
           'avg_obj': 0.24666579,
           'box_loss': 0.014345678,
           'class_loss': 0.005607145,
           'conf_loss': 0.024840571,
           'precision50': 0.5159874,
           'recall50': 0.16512729},
     '4': {'avg_iou': 0.7832811,
           'avg_obj': 0.40987822,
           'box_loss': 0.009602401,
           'class_loss': 0.0040644766,
           'conf_loss': 0.019553008,
           'precision50': 0.6948981,
           'recall50': 0.3907644},
     '5': {'avg_iou': 0.82788694,
           'avg_obj': 0.5243548,
           'box_loss': 0.0074556503,
           'class_loss': 0.0032654759,
           'conf_loss': 0.011376591,
           'precision50': 0.737916,
           'recall50': 0.5409157},
     'global': {'total_loss': 0.80088776},
     'learning_rate': 0.007171291,
     'training_loss': 0.80088776}
I0514 11:44:26.587263 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-150000.
I0514 13:18:41.113436 140638711330624 controller.py:425] train | step:  160000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6417438,
           'avg_obj': 0.25055403,
           'box_loss': 0.014249137,
           'class_loss': 0.0054918863,
           'conf_loss': 0.024711067,
           'precision50': 0.5203848,
           'recall50': 0.16937256},
     '4': {'avg_iou': 0.78591347,
           'avg_obj': 0.41528687,
           'box_loss': 0.009493674,
           'class_loss': 0.003966659,
           'conf_loss': 0.019414771,
           'precision50': 0.6977066,
           'recall50': 0.3971858},
     '5': {'avg_iou': 0.83044785,
           'avg_obj': 0.5301573,
           'box_loss': 0.0073383865,
           'class_loss': 0.0031805765,
           'conf_loss': 0.011268507,
           'precision50': 0.7403677,
           'recall50': 0.5473354},
     'global': {'total_loss': 0.7929185},
     'learning_rate': 0.0068427175,
     'training_loss': 0.7929185}
I0514 13:19:29.173362 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-160000.
I0514 13:19:29.179813 140638711330624 controller.py:252]  eval | step:  160000 | running 625 steps of evaluation...
I0514 13:23:34.014069 140638711330624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0514 13:27:39.409810 140638711330624 controller.py:261]  eval | step:  160000 | eval time:  490.2 sec | output: 
    {'3': {'avg_iou': 0.52890104,
           'avg_obj': 0.20982717,
           'box_loss': 0.010349849,
           'class_loss': 0.0033801747,
           'conf_loss': 0.019259227,
           'precision50': 0.43555805,
           'recall50': 0.18565452},
     '4': {'avg_iou': 0.7492887,
           'avg_obj': 0.41380358,
           'box_loss': 0.008497325,
           'class_loss': 0.0028507614,
           'conf_loss': 0.015336441,
           'precision50': 0.6598354,
           'recall50': 0.4380103},
     '5': {'avg_iou': 0.78098434,
           'avg_obj': 0.5277612,
           'box_loss': 0.0071489997,
           'class_loss': 0.002613498,
           'conf_loss': 0.01016725,
           'precision50': 0.72627777,
           'recall50': 0.5801718},
     'AP': 0.38321272,
     'AP50': 0.57992744,
     'AP75': 0.40852946,
     'APl': 0.5559201,
     'APm': 0.39674997,
     'APs': 0.14405634,
     'ARl': 0.70968276,
     'ARm': 0.5829887,
     'ARmax1': 0.3170373,
     'ARmax10': 0.5019296,
     'ARmax100': 0.5434366,
     'ARs': 0.2999095,
     'global': {'total_loss': 0.07960353},
     'validation_loss': 0.07960353}
I0514 13:28:00.523325 140638711330624 controller.py:211] train | step:  160000 | training until step 180000...
I0514 14:58:10.777325 140638711330624 controller.py:425] train | step:  170000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.64312136,
           'avg_obj': 0.25425,
           'box_loss': 0.014180499,
           'class_loss': 0.005410164,
           'conf_loss': 0.024511198,
           'precision50': 0.5239954,
           'recall50': 0.17308567},
     '4': {'avg_iou': 0.7881243,
           'avg_obj': 0.4204732,
           'box_loss': 0.009383524,
           'class_loss': 0.00387863,
           'conf_loss': 0.019198602,
           'precision50': 0.70036304,
           'recall50': 0.40334854},
     '5': {'avg_iou': 0.83304316,
           'avg_obj': 0.5366298,
           'box_loss': 0.0072089834,
           'class_loss': 0.0031052511,
           'conf_loss': 0.011120756,
           'precision50': 0.7423051,
           'recall50': 0.5535903},
     'global': {'total_loss': 0.78397995},
     'learning_rate': 0.0065080714,
     'training_loss': 0.78397995}
I0514 14:59:02.894520 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-170000.
I0514 16:33:20.962582 140638711330624 controller.py:425] train | step:  180000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6449222,
           'avg_obj': 0.2574812,
           'box_loss': 0.014106917,
           'class_loss': 0.0053236866,
           'conf_loss': 0.024420518,
           'precision50': 0.52824026,
           'recall50': 0.17707886},
     '4': {'avg_iou': 0.79038966,
           'avg_obj': 0.42554706,
           'box_loss': 0.009275511,
           'class_loss': 0.003797117,
           'conf_loss': 0.019082673,
           'precision50': 0.703161,
           'recall50': 0.40920323},
     '5': {'avg_iou': 0.8353036,
           'avg_obj': 0.5416168,
           'box_loss': 0.0071112677,
           'class_loss': 0.0030361742,
           'conf_loss': 0.011021584,
           'precision50': 0.745202,
           'recall50': 0.559476},
     'global': {'total_loss': 0.7774041},
     'learning_rate': 0.0061697643,
     'training_loss': 0.7774041}
I0514 16:34:08.514555 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-180000.
I0514 16:34:08.522106 140638711330624 controller.py:252]  eval | step:  180000 | running 625 steps of evaluation...
I0514 16:38:08.794638 140638711330624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0514 16:42:06.272313 140638711330624 controller.py:261]  eval | step:  180000 | eval time:  477.7 sec | output: 
    {'3': {'avg_iou': 0.5299576,
           'avg_obj': 0.21288757,
           'box_loss': 0.010296847,
           'class_loss': 0.0033836646,
           'conf_loss': 0.019345775,
           'precision50': 0.4348758,
           'recall50': 0.1905669},
     '4': {'avg_iou': 0.7500034,
           'avg_obj': 0.41814283,
           'box_loss': 0.008461639,
           'class_loss': 0.00290786,
           'conf_loss': 0.015418652,
           'precision50': 0.6601145,
           'recall50': 0.44383487},
     '5': {'avg_iou': 0.78213894,
           'avg_obj': 0.5338826,
           'box_loss': 0.007091031,
           'class_loss': 0.002668993,
           'conf_loss': 0.010230508,
           'precision50': 0.7267191,
           'recall50': 0.58853114},
     'AP': 0.3856962,
     'AP50': 0.5820952,
     'AP75': 0.41370225,
     'APl': 0.556088,
     'APm': 0.40012467,
     'APs': 0.14313017,
     'ARl': 0.70572454,
     'ARm': 0.58112067,
     'ARmax1': 0.31755182,
     'ARmax10': 0.50362206,
     'ARmax100': 0.5436983,
     'ARs': 0.30511287,
     'global': {'total_loss': 0.07980498},
     'validation_loss': 0.07980498}

train | step:  140000 | training until step 160000...
train | step:  150000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6395722,
           'avg_obj': 0.24666579,
           'box_loss': 0.014345678,
           'class_loss': 0.005607145,
           'conf_loss': 0.024840571,
           'precision50': 0.5159874,
           'recall50': 0.16512729},
     '4': {'avg_iou': 0.7832811,
           'avg_obj': 0.40987822,
           'box_loss': 0.009602401,
           'class_loss': 0.0040644766,
           'conf_loss': 0.019553008,
           'precision50': 0.6948981,
           'recall50': 0.3907644},
     '5': {'avg_iou': 0.82788694,
           'avg_obj': 0.5243548,
           'box_loss': 0.0074556503,
           'class_loss': 0.0032654759,
           'conf_loss': 0.011376591,
           'precision50': 0.737916,
           'recall50': 0.5409157},
     'global': {'total_loss': 0.80088776},
     'learning_rate': 0.007171291,
     'training_loss': 0.80088776}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-150000.
train | step:  160000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6417438,
           'avg_obj': 0.25055403,
           'box_loss': 0.014249137,
           'class_loss': 0.0054918863,
           'conf_loss': 0.024711067,
           'precision50': 0.5203848,
           'recall50': 0.16937256},
     '4': {'avg_iou': 0.78591347,
           'avg_obj': 0.41528687,
           'box_loss': 0.009493674,
           'class_loss': 0.003966659,
           'conf_loss': 0.019414771,
           'precision50': 0.6977066,
           'recall50': 0.3971858},
     '5': {'avg_iou': 0.83044785,
           'avg_obj': 0.5301573,
           'box_loss': 0.0073383865,
           'class_loss': 0.0031805765,
           'conf_loss': 0.011268507,
           'precision50': 0.7403677,
           'recall50': 0.5473354},
     'global': {'total_loss': 0.7929185},
     'learning_rate': 0.0068427175,
     'training_loss': 0.7929185}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-160000.
 eval | step:  160000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=177.16s).
Accumulating evaluation results...
DONE (t=12.30s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.383
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.580
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.409
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.144
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.397
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.556
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.317
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.502
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.543
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.300
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.583
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.710
 eval | step:  160000 | eval time:  490.2 sec | output: 
    {'3': {'avg_iou': 0.52890104,
           'avg_obj': 0.20982717,
           'box_loss': 0.010349849,
           'class_loss': 0.0033801747,
           'conf_loss': 0.019259227,
           'precision50': 0.43555805,
           'recall50': 0.18565452},
     '4': {'avg_iou': 0.7492887,
           'avg_obj': 0.41380358,
           'box_loss': 0.008497325,
           'class_loss': 0.0028507614,
           'conf_loss': 0.015336441,
           'precision50': 0.6598354,
           'recall50': 0.4380103},
     '5': {'avg_iou': 0.78098434,
           'avg_obj': 0.5277612,
           'box_loss': 0.0071489997,
           'class_loss': 0.002613498,
           'conf_loss': 0.01016725,
           'precision50': 0.72627777,
           'recall50': 0.5801718},
     'AP': 0.38321272,
     'AP50': 0.57992744,
     'AP75': 0.40852946,
     'APl': 0.5559201,
     'APm': 0.39674997,
     'APs': 0.14405634,
     'ARl': 0.70968276,
     'ARm': 0.5829887,
     'ARmax1': 0.3170373,
     'ARmax10': 0.5019296,
     'ARmax100': 0.5434366,
     'ARs': 0.2999095,
     'global': {'total_loss': 0.07960353},
     'validation_loss': 0.07960353}
train | step:  160000 | training until step 180000...
train | step:  170000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.64312136,
           'avg_obj': 0.25425,
           'box_loss': 0.014180499,
           'class_loss': 0.005410164,
           'conf_loss': 0.024511198,
           'precision50': 0.5239954,
           'recall50': 0.17308567},
     '4': {'avg_iou': 0.7881243,
           'avg_obj': 0.4204732,
           'box_loss': 0.009383524,
           'class_loss': 0.00387863,
           'conf_loss': 0.019198602,
           'precision50': 0.70036304,
           'recall50': 0.40334854},
     '5': {'avg_iou': 0.83304316,
           'avg_obj': 0.5366298,
           'box_loss': 0.0072089834,
           'class_loss': 0.0031052511,
           'conf_loss': 0.011120756,
           'precision50': 0.7423051,
           'recall50': 0.5535903},
     'global': {'total_loss': 0.78397995},
     'learning_rate': 0.0065080714,
     'training_loss': 0.78397995}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-170000.
train | step:  180000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6449222,
           'avg_obj': 0.2574812,
           'box_loss': 0.014106917,
           'class_loss': 0.0053236866,
           'conf_loss': 0.024420518,
           'precision50': 0.52824026,
           'recall50': 0.17707886},
     '4': {'avg_iou': 0.79038966,
           'avg_obj': 0.42554706,
           'box_loss': 0.009275511,
           'class_loss': 0.003797117,
           'conf_loss': 0.019082673,
           'precision50': 0.703161,
           'recall50': 0.40920323},
     '5': {'avg_iou': 0.8353036,
           'avg_obj': 0.5416168,
           'box_loss': 0.0071112677,
           'class_loss': 0.0030361742,
           'conf_loss': 0.011021584,
           'precision50': 0.745202,
           'recall50': 0.559476},
     'global': {'total_loss': 0.7774041},
     'learning_rate': 0.0061697643,
     'training_loss': 0.7774041}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-180000.
 eval | step:  180000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=175.07s).
Accumulating evaluation results...
DONE (t=11.93s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.386
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.582
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.414
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.143
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.400
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.556
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.318
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.504
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.544
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.305
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.581
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.706
 eval | step:  180000 | eval time:  477.7 sec | output: 
    {'3': {'avg_iou': 0.5299576,
           'avg_obj': 0.21288757,
           'box_loss': 0.010296847,
           'class_loss': 0.0033836646,
           'conf_loss': 0.019345775,
           'precision50': 0.4348758,
           'recall50': 0.1905669},
     '4': {'avg_iou': 0.7500034,
           'avg_obj': 0.41814283,
           'box_loss': 0.008461639,
           'class_loss': 0.00290786,
           'conf_loss': 0.015418652,
           'precision50': 0.6601145,
           'recall50': 0.44383487},
     '5': {'avg_iou': 0.78213894,
           'avg_obj': 0.5338826,
           'box_loss': 0.007091031,
           'class_loss': 0.002668993,
           'conf_loss': 0.010230508,
           'precision50': 0.7267191,
           'recall50': 0.58853114},
     'AP': 0.3856962,
     'AP50': 0.5820952,
     'AP75': 0.41370225,
     'APl': 0.556088,
     'APm': 0.40012467,
     'APs': 0.14313017,
     'ARl': 0.70572454,
     'ARm': 0.58112067,
     'ARmax1': 0.31755182,
     'ARmax10': 0.50362206,
     'ARmax100': 0.5436983,
     'ARs': 0.30511287,
     'global': {'total_loss': 0.07980498},
     'validation_loss': 0.07980498}I0514 16:42:25.386485 140638711330624 controller.py:211] train | step:  180000 | training until step 200000...
I0514 18:10:51.543029 140638711330624 controller.py:425] train | step:  190000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.64665115,
           'avg_obj': 0.26119852,
           'box_loss': 0.014050811,
           'class_loss': 0.00523918,
           'conf_loss': 0.024288327,
           'precision50': 0.5321616,
           'recall50': 0.18096134},
     '4': {'avg_iou': 0.79243743,
           'avg_obj': 0.43036002,
           'box_loss': 0.009173964,
           'class_loss': 0.0037066878,
           'conf_loss': 0.018919243,
           'precision50': 0.70624,
           'recall50': 0.41584712},
     '5': {'avg_iou': 0.83775353,
           'avg_obj': 0.54766214,
           'box_loss': 0.0069925087,
           'class_loss': 0.0029531075,
           'conf_loss': 0.010892558,
           'precision50': 0.74702007,
           'recall50': 0.5655347},
     'global': {'total_loss': 0.7697318},
     'learning_rate': 0.0058302353,
     'training_loss': 0.7697318}
I0514 18:11:39.949016 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-190000.
I0514 19:44:46.858470 140638711330624 controller.py:425] train | step:  200000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6483661,
           'avg_obj': 0.2644137,
           'box_loss': 0.013947948,
           'class_loss': 0.0051468527,
           'conf_loss': 0.024138844,
           'precision50': 0.5337629,
           'recall50': 0.18399285},
     '4': {'avg_iou': 0.7942968,
           'avg_obj': 0.43484437,
           'box_loss': 0.009082753,
           'class_loss': 0.0036299306,
           'conf_loss': 0.018764753,
           'precision50': 0.7081936,
           'recall50': 0.42068022},
     '5': {'avg_iou': 0.8398015,
           'avg_obj': 0.5526181,
           'box_loss': 0.0068989675,
           'class_loss': 0.0028988917,
           'conf_loss': 0.0108037675,
           'precision50': 0.74890596,
           'recall50': 0.5705879},
     'global': {'total_loss': 0.7625027},
     'learning_rate': 0.005491929,
     'training_loss': 0.7625027}
I0514 19:45:34.305396 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-200000.
I0514 19:45:34.311209 140638711330624 controller.py:252]  eval | step:  200000 | running 625 steps of evaluation...
I0514 19:49:41.740208 140638711330624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0514 19:53:51.492883 140638711330624 controller.py:261]  eval | step:  200000 | eval time:  497.2 sec | output: 
    {'3': {'avg_iou': 0.5304813,
           'avg_obj': 0.21472232,
           'box_loss': 0.010272919,
           'class_loss': 0.0034256591,
           'conf_loss': 0.019378027,
           'precision50': 0.43900758,
           'recall50': 0.19359352},
     '4': {'avg_iou': 0.7504623,
           'avg_obj': 0.42248285,
           'box_loss': 0.008438382,
           'class_loss': 0.002955091,
           'conf_loss': 0.015527498,
           'precision50': 0.6589727,
           'recall50': 0.4488898},
     '5': {'avg_iou': 0.7822352,
           'avg_obj': 0.5373606,
           'box_loss': 0.0070860824,
           'class_loss': 0.0027262429,
           'conf_loss': 0.010339478,
           'precision50': 0.7261625,
           'recall50': 0.5922543},
     'AP': 0.38344836,
     'AP50': 0.57938606,
     'AP75': 0.4071257,
     'APl': 0.5554673,
     'APm': 0.39664307,
     'APs': 0.1476732,
     'ARl': 0.6945684,
     'ARm': 0.5782322,
     'ARmax1': 0.31492805,
     'ARmax10': 0.50020504,
     'ARmax100': 0.5394773,
     'ARs': 0.29933384,
     'global': {'total_loss': 0.08014941},
     'validation_loss': 0.08014941}
I0514 19:54:12.906110 140638711330624 controller.py:211] train | step:  200000 | training until step 220000...
I0514 21:23:37.618181 140638711330624 controller.py:425] train | step:  210000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6496874,
           'avg_obj': 0.26704907,
           'box_loss': 0.01390542,
           'class_loss': 0.005092219,
           'conf_loss': 0.024070743,
           'precision50': 0.5367836,
           'recall50': 0.18727429},
     '4': {'avg_iou': 0.79619193,
           'avg_obj': 0.4392412,
           'box_loss': 0.008998202,
           'class_loss': 0.003576756,
           'conf_loss': 0.018666774,
           'precision50': 0.7095436,
           'recall50': 0.42553812},
     '5': {'avg_iou': 0.8418651,
           'avg_obj': 0.55778766,
           'box_loss': 0.0068047624,
           'class_loss': 0.002834294,
           'conf_loss': 0.010707153,
           'precision50': 0.7507405,
           'recall50': 0.57570684},
     'global': {'total_loss': 0.7572505},
     'learning_rate': 0.005157283,
     'training_loss': 0.7572505}
I0514 21:24:29.024473 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-210000.
I0514 22:59:07.937016 140638711330624 controller.py:425] train | step:  220000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.651161,
           'avg_obj': 0.2703653,
           'box_loss': 0.01385313,
           'class_loss': 0.005014273,
           'conf_loss': 0.023935812,
           'precision50': 0.54048026,
           'recall50': 0.19060986},
     '4': {'avg_iou': 0.7980001,
           'avg_obj': 0.4439751,
           'box_loss': 0.008919689,
           'class_loss': 0.003509301,
           'conf_loss': 0.018519826,
           'precision50': 0.71250486,
           'recall50': 0.431159},
     '5': {'avg_iou': 0.8439254,
           'avg_obj': 0.5633077,
           'box_loss': 0.006714483,
           'class_loss': 0.0027931565,
           'conf_loss': 0.010591337,
           'precision50': 0.7528614,
           'recall50': 0.58108115},
     'global': {'total_loss': 0.7508093},
     'learning_rate': 0.0048287087,
     'training_loss': 0.7508093}
I0514 22:59:57.378207 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-220000.
I0514 22:59:57.383555 140638711330624 controller.py:252]  eval | step:  220000 | running 625 steps of evaluation...
I0514 23:04:02.445359 140638711330624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0514 23:07:55.049089 140638711330624 controller.py:261]  eval | step:  220000 | eval time:  477.7 sec | output: 
    {'3': {'avg_iou': 0.531319,
           'avg_obj': 0.2168312,
           'box_loss': 0.0102305105,
           'class_loss': 0.0033806534,
           'conf_loss': 0.019487284,
           'precision50': 0.4381897,
           'recall50': 0.19885176},
     '4': {'avg_iou': 0.7504935,
           'avg_obj': 0.4243587,
           'box_loss': 0.008437119,
           'class_loss': 0.0029449374,
           'conf_loss': 0.015694592,
           'precision50': 0.6584762,
           'recall50': 0.45222118},
     '5': {'avg_iou': 0.78165954,
           'avg_obj': 0.53972,
           'box_loss': 0.0071159434,
           'class_loss': 0.0027540708,
           'conf_loss': 0.010480272,
           'precision50': 0.72239494,
           'recall50': 0.5926488},
     'AP': 0.3838343,
     'AP50': 0.5788015,
     'AP75': 0.40988162,
     'APl': 0.5542098,
     'APm': 0.39831334,
     'APs': 0.15954244,
     'ARl': 0.6900299,
     'ARm': 0.5782181,
     'ARmax1': 0.31426865,
     'ARmax10': 0.49778223,
     'ARmax100': 0.5374247,
     'ARs': 0.3097158,
     'global': {'total_loss': 0.080525406},
     'validation_loss': 0.080525406}

train | step:  180000 | training until step 200000...
train | step:  190000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.64665115,
           'avg_obj': 0.26119852,
           'box_loss': 0.014050811,
           'class_loss': 0.00523918,
           'conf_loss': 0.024288327,
           'precision50': 0.5321616,
           'recall50': 0.18096134},
     '4': {'avg_iou': 0.79243743,
           'avg_obj': 0.43036002,
           'box_loss': 0.009173964,
           'class_loss': 0.0037066878,
           'conf_loss': 0.018919243,
           'precision50': 0.70624,
           'recall50': 0.41584712},
     '5': {'avg_iou': 0.83775353,
           'avg_obj': 0.54766214,
           'box_loss': 0.0069925087,
           'class_loss': 0.0029531075,
           'conf_loss': 0.010892558,
           'precision50': 0.74702007,
           'recall50': 0.5655347},
     'global': {'total_loss': 0.7697318},
     'learning_rate': 0.0058302353,
     'training_loss': 0.7697318}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-190000.
train | step:  200000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6483661,
           'avg_obj': 0.2644137,
           'box_loss': 0.013947948,
           'class_loss': 0.0051468527,
           'conf_loss': 0.024138844,
           'precision50': 0.5337629,
           'recall50': 0.18399285},
     '4': {'avg_iou': 0.7942968,
           'avg_obj': 0.43484437,
           'box_loss': 0.009082753,
           'class_loss': 0.0036299306,
           'conf_loss': 0.018764753,
           'precision50': 0.7081936,
           'recall50': 0.42068022},
     '5': {'avg_iou': 0.8398015,
           'avg_obj': 0.5526181,
           'box_loss': 0.0068989675,
           'class_loss': 0.0028988917,
           'conf_loss': 0.0108037675,
           'precision50': 0.74890596,
           'recall50': 0.5705879},
     'global': {'total_loss': 0.7625027},
     'learning_rate': 0.005491929,
     'training_loss': 0.7625027}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-200000.
 eval | step:  200000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=181.62s).
Accumulating evaluation results...
DONE (t=11.72s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.383
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.579
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.407
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.148
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.397
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.555
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.315
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.500
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.539
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.299
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.578
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.695
 eval | step:  200000 | eval time:  497.2 sec | output: 
    {'3': {'avg_iou': 0.5304813,
           'avg_obj': 0.21472232,
           'box_loss': 0.010272919,
           'class_loss': 0.0034256591,
           'conf_loss': 0.019378027,
           'precision50': 0.43900758,
           'recall50': 0.19359352},
     '4': {'avg_iou': 0.7504623,
           'avg_obj': 0.42248285,
           'box_loss': 0.008438382,
           'class_loss': 0.002955091,
           'conf_loss': 0.015527498,
           'precision50': 0.6589727,
           'recall50': 0.4488898},
     '5': {'avg_iou': 0.7822352,
           'avg_obj': 0.5373606,
           'box_loss': 0.0070860824,
           'class_loss': 0.0027262429,
           'conf_loss': 0.010339478,
           'precision50': 0.7261625,
           'recall50': 0.5922543},
     'AP': 0.38344836,
     'AP50': 0.57938606,
     'AP75': 0.4071257,
     'APl': 0.5554673,
     'APm': 0.39664307,
     'APs': 0.1476732,
     'ARl': 0.6945684,
     'ARm': 0.5782322,
     'ARmax1': 0.31492805,
     'ARmax10': 0.50020504,
     'ARmax100': 0.5394773,
     'ARs': 0.29933384,
     'global': {'total_loss': 0.08014941},
     'validation_loss': 0.08014941}
train | step:  200000 | training until step 220000...
train | step:  210000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6496874,
           'avg_obj': 0.26704907,
           'box_loss': 0.01390542,
           'class_loss': 0.005092219,
           'conf_loss': 0.024070743,
           'precision50': 0.5367836,
           'recall50': 0.18727429},
     '4': {'avg_iou': 0.79619193,
           'avg_obj': 0.4392412,
           'box_loss': 0.008998202,
           'class_loss': 0.003576756,
           'conf_loss': 0.018666774,
           'precision50': 0.7095436,
           'recall50': 0.42553812},
     '5': {'avg_iou': 0.8418651,
           'avg_obj': 0.55778766,
           'box_loss': 0.0068047624,
           'class_loss': 0.002834294,
           'conf_loss': 0.010707153,
           'precision50': 0.7507405,
           'recall50': 0.57570684},
     'global': {'total_loss': 0.7572505},
     'learning_rate': 0.005157283,
     'training_loss': 0.7572505}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-210000.
train | step:  220000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.651161,
           'avg_obj': 0.2703653,
           'box_loss': 0.01385313,
           'class_loss': 0.005014273,
           'conf_loss': 0.023935812,
           'precision50': 0.54048026,
           'recall50': 0.19060986},
     '4': {'avg_iou': 0.7980001,
           'avg_obj': 0.4439751,
           'box_loss': 0.008919689,
           'class_loss': 0.003509301,
           'conf_loss': 0.018519826,
           'precision50': 0.71250486,
           'recall50': 0.431159},
     '5': {'avg_iou': 0.8439254,
           'avg_obj': 0.5633077,
           'box_loss': 0.006714483,
           'class_loss': 0.0027931565,
           'conf_loss': 0.010591337,
           'precision50': 0.7528614,
           'recall50': 0.58108115},
     'global': {'total_loss': 0.7508093},
     'learning_rate': 0.0048287087,
     'training_loss': 0.7508093}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-220000.
 eval | step:  220000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=174.61s).
Accumulating evaluation results...
DONE (t=11.65s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.384
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.579
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.410
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.160
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.398
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.554
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.314
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.498
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.537
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.310
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.578
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.690
 eval | step:  220000 | eval time:  477.7 sec | output: 
    {'3': {'avg_iou': 0.531319,
           'avg_obj': 0.2168312,
           'box_loss': 0.0102305105,
           'class_loss': 0.0033806534,
           'conf_loss': 0.019487284,
           'precision50': 0.4381897,
           'recall50': 0.19885176},
     '4': {'avg_iou': 0.7504935,
           'avg_obj': 0.4243587,
           'box_loss': 0.008437119,
           'class_loss': 0.0029449374,
           'conf_loss': 0.015694592,
           'precision50': 0.6584762,
           'recall50': 0.45222118},
     '5': {'avg_iou': 0.78165954,
           'avg_obj': 0.53972,
           'box_loss': 0.0071159434,
           'class_loss': 0.0027540708,
           'conf_loss': 0.010480272,
           'precision50': 0.72239494,
           'recall50': 0.5926488},
     'AP': 0.3838343,
     'AP50': 0.5788015,
     'AP75': 0.40988162,
     'APl': 0.5542098,
     'APm': 0.39831334,
     'APs': 0.15954244,
     'ARl': 0.6900299,
     'ARm': 0.5782181,
     'ARmax1': 0.31426865,
     'ARmax10': 0.49778223,
     'ARmax100': 0.5374247,
     'ARs': 0.3097158,
     'global': {'total_loss': 0.080525406},
     'validation_loss': 0.080525406}I0514 23:08:19.124799 140638711330624 controller.py:211] train | step:  220000 | training until step 240000...
I0515 00:37:10.871487 140638711330624 controller.py:425] train | step:  230000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.65278435,
           'avg_obj': 0.27375966,
           'box_loss': 0.013752005,
           'class_loss': 0.0049268943,
           'conf_loss': 0.023813931,
           'precision50': 0.5434885,
           'recall50': 0.1941915},
     '4': {'avg_iou': 0.79978234,
           'avg_obj': 0.44833636,
           'box_loss': 0.008833547,
           'class_loss': 0.0034379798,
           'conf_loss': 0.018353479,
           'precision50': 0.7152181,
           'recall50': 0.43674484},
     '5': {'avg_iou': 0.8458129,
           'avg_obj': 0.56818426,
           'box_loss': 0.006620922,
           'class_loss': 0.0027242487,
           'conf_loss': 0.010474476,
           'precision50': 0.7551161,
           'recall50': 0.58638704},
     'global': {'total_loss': 0.74349797},
     'learning_rate': 0.004508574,
     'training_loss': 0.74349797}
I0515 00:37:59.167868 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-230000.
I0515 02:11:12.306111 140638711330624 controller.py:425] train | step:  240000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.65379065,
           'avg_obj': 0.276422,
           'box_loss': 0.013743609,
           'class_loss': 0.004897956,
           'conf_loss': 0.02377109,
           'precision50': 0.54655135,
           'recall50': 0.19746788},
     '4': {'avg_iou': 0.801085,
           'avg_obj': 0.45209536,
           'box_loss': 0.008777358,
           'class_loss': 0.003390105,
           'conf_loss': 0.018261584,
           'precision50': 0.71725845,
           'recall50': 0.4410336},
     '5': {'avg_iou': 0.8475574,
           'avg_obj': 0.5727072,
           'box_loss': 0.006545117,
           'class_loss': 0.0026832982,
           'conf_loss': 0.010386711,
           'precision50': 0.7562198,
           'recall50': 0.5900608},
     'global': {'total_loss': 0.7396541},
     'learning_rate': 0.0041991845,
     'training_loss': 0.7396541}
I0515 02:12:00.618976 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-240000.
I0515 02:12:00.624120 140638711330624 controller.py:252]  eval | step:  240000 | running 625 steps of evaluation...
I0515 02:16:03.623198 140638711330624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0515 02:20:01.813356 140638711330624 controller.py:261]  eval | step:  240000 | eval time:  481.2 sec | output: 
    {'3': {'avg_iou': 0.5314205,
           'avg_obj': 0.21827503,
           'box_loss': 0.010226105,
           'class_loss': 0.0034243923,
           'conf_loss': 0.019615704,
           'precision50': 0.43878892,
           'recall50': 0.20118406},
     '4': {'avg_iou': 0.75019383,
           'avg_obj': 0.42679468,
           'box_loss': 0.008454339,
           'class_loss': 0.0030193261,
           'conf_loss': 0.015885256,
           'precision50': 0.65820515,
           'recall50': 0.45639923},
     '5': {'avg_iou': 0.78148216,
           'avg_obj': 0.5432101,
           'box_loss': 0.0071260124,
           'class_loss': 0.0028087315,
           'conf_loss': 0.010645075,
           'precision50': 0.72076946,
           'recall50': 0.59679526},
     'AP': 0.38363072,
     'AP50': 0.57748187,
     'AP75': 0.40736654,
     'APl': 0.5548825,
     'APm': 0.39722604,
     'APs': 0.15102486,
     'ARl': 0.6900607,
     'ARm': 0.57462406,
     'ARmax1': 0.3172701,
     'ARmax10': 0.49895108,
     'ARmax100': 0.53711843,
     'ARs': 0.29748172,
     'global': {'total_loss': 0.0812049},
     'validation_loss': 0.0812049}
I0515 02:20:20.625457 140638711330624 controller.py:211] train | step:  240000 | training until step 260000...
I0515 03:49:35.574370 140638711330624 controller.py:425] train | step:  250000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.65486234,
           'avg_obj': 0.27879748,
           'box_loss': 0.013680533,
           'class_loss': 0.0048228293,
           'conf_loss': 0.023618508,
           'precision50': 0.5486196,
           'recall50': 0.19966443},
     '4': {'avg_iou': 0.802674,
           'avg_obj': 0.45610756,
           'box_loss': 0.00869898,
           'class_loss': 0.003325481,
           'conf_loss': 0.018139169,
           'precision50': 0.71911794,
           'recall50': 0.44557974},
     '5': {'avg_iou': 0.8493293,
           'avg_obj': 0.5775216,
           'box_loss': 0.0064592813,
           'class_loss': 0.0026244868,
           'conf_loss': 0.01029468,
           'precision50': 0.75850546,
           'recall50': 0.5952864},
     'global': {'total_loss': 0.7333131},
     'learning_rate': 0.0039027706,
     'training_loss': 0.7333131}
I0515 03:50:27.405551 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-250000.
I0515 05:22:11.796324 140638711330624 controller.py:425] train | step:  260000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6561508,
           'avg_obj': 0.28204778,
           'box_loss': 0.013627946,
           'class_loss': 0.0047673145,
           'conf_loss': 0.023504542,
           'precision50': 0.5524608,
           'recall50': 0.20362575},
     '4': {'avg_iou': 0.8042944,
           'avg_obj': 0.46049184,
           'box_loss': 0.008625188,
           'class_loss': 0.003271397,
           'conf_loss': 0.018003365,
           'precision50': 0.7211604,
           'recall50': 0.45057726},
     '5': {'avg_iou': 0.8509364,
           'avg_obj': 0.58187515,
           'box_loss': 0.0063863215,
           'class_loss': 0.0025816879,
           'conf_loss': 0.010194563,
           'precision50': 0.7601907,
           'recall50': 0.5994967},
     'global': {'total_loss': 0.72769827},
     'learning_rate': 0.0036214672,
     'training_loss': 0.72769827}
I0515 05:23:00.973217 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-260000.
I0515 05:23:00.978954 140638711330624 controller.py:252]  eval | step:  260000 | running 625 steps of evaluation...
I0515 05:26:56.073993 140638711330624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0515 05:30:54.317188 140638711330624 controller.py:261]  eval | step:  260000 | eval time:  473.3 sec | output: 
    {'3': {'avg_iou': 0.53151476,
           'avg_obj': 0.21955673,
           'box_loss': 0.010221972,
           'class_loss': 0.003460519,
           'conf_loss': 0.019715179,
           'precision50': 0.43683964,
           'recall50': 0.20277055},
     '4': {'avg_iou': 0.7501439,
           'avg_obj': 0.42841342,
           'box_loss': 0.008456114,
           'class_loss': 0.003070833,
           'conf_loss': 0.01607249,
           'precision50': 0.6546661,
           'recall50': 0.45801678},
     '5': {'avg_iou': 0.7810439,
           'avg_obj': 0.54491526,
           'box_loss': 0.0071487688,
           'class_loss': 0.0029046026,
           'conf_loss': 0.01076369,
           'precision50': 0.7198136,
           'recall50': 0.5968272},
     'AP': 0.382431,
     'AP50': 0.57650495,
     'AP75': 0.40407318,
     'APl': 0.55187815,
     'APm': 0.3962383,
     'APs': 0.1530729,
     'ARl': 0.6850019,
     'ARm': 0.5719776,
     'ARmax1': 0.31584325,
     'ARmax10': 0.49578303,
     'ARmax100': 0.53456837,
     'ARs': 0.2966367,
     'global': {'total_loss': 0.08181417},
     'validation_loss': 0.08181417}

train | step:  220000 | training until step 240000...
train | step:  230000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.65278435,
           'avg_obj': 0.27375966,
           'box_loss': 0.013752005,
           'class_loss': 0.0049268943,
           'conf_loss': 0.023813931,
           'precision50': 0.5434885,
           'recall50': 0.1941915},
     '4': {'avg_iou': 0.79978234,
           'avg_obj': 0.44833636,
           'box_loss': 0.008833547,
           'class_loss': 0.0034379798,
           'conf_loss': 0.018353479,
           'precision50': 0.7152181,
           'recall50': 0.43674484},
     '5': {'avg_iou': 0.8458129,
           'avg_obj': 0.56818426,
           'box_loss': 0.006620922,
           'class_loss': 0.0027242487,
           'conf_loss': 0.010474476,
           'precision50': 0.7551161,
           'recall50': 0.58638704},
     'global': {'total_loss': 0.74349797},
     'learning_rate': 0.004508574,
     'training_loss': 0.74349797}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-230000.
train | step:  240000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.65379065,
           'avg_obj': 0.276422,
           'box_loss': 0.013743609,
           'class_loss': 0.004897956,
           'conf_loss': 0.02377109,
           'precision50': 0.54655135,
           'recall50': 0.19746788},
     '4': {'avg_iou': 0.801085,
           'avg_obj': 0.45209536,
           'box_loss': 0.008777358,
           'class_loss': 0.003390105,
           'conf_loss': 0.018261584,
           'precision50': 0.71725845,
           'recall50': 0.4410336},
     '5': {'avg_iou': 0.8475574,
           'avg_obj': 0.5727072,
           'box_loss': 0.006545117,
           'class_loss': 0.0026832982,
           'conf_loss': 0.010386711,
           'precision50': 0.7562198,
           'recall50': 0.5900608},
     'global': {'total_loss': 0.7396541},
     'learning_rate': 0.0041991845,
     'training_loss': 0.7396541}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-240000.
 eval | step:  240000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=174.47s).
Accumulating evaluation results...
DONE (t=11.24s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.384
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.577
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.407
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.151
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.397
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.555
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.317
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.499
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.537
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.297
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.575
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.690
 eval | step:  240000 | eval time:  481.2 sec | output: 
    {'3': {'avg_iou': 0.5314205,
           'avg_obj': 0.21827503,
           'box_loss': 0.010226105,
           'class_loss': 0.0034243923,
           'conf_loss': 0.019615704,
           'precision50': 0.43878892,
           'recall50': 0.20118406},
     '4': {'avg_iou': 0.75019383,
           'avg_obj': 0.42679468,
           'box_loss': 0.008454339,
           'class_loss': 0.0030193261,
           'conf_loss': 0.015885256,
           'precision50': 0.65820515,
           'recall50': 0.45639923},
     '5': {'avg_iou': 0.78148216,
           'avg_obj': 0.5432101,
           'box_loss': 0.0071260124,
           'class_loss': 0.0028087315,
           'conf_loss': 0.010645075,
           'precision50': 0.72076946,
           'recall50': 0.59679526},
     'AP': 0.38363072,
     'AP50': 0.57748187,
     'AP75': 0.40736654,
     'APl': 0.5548825,
     'APm': 0.39722604,
     'APs': 0.15102486,
     'ARl': 0.6900607,
     'ARm': 0.57462406,
     'ARmax1': 0.3172701,
     'ARmax10': 0.49895108,
     'ARmax100': 0.53711843,
     'ARs': 0.29748172,
     'global': {'total_loss': 0.0812049},
     'validation_loss': 0.0812049}
train | step:  240000 | training until step 260000...
train | step:  250000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.65486234,
           'avg_obj': 0.27879748,
           'box_loss': 0.013680533,
           'class_loss': 0.0048228293,
           'conf_loss': 0.023618508,
           'precision50': 0.5486196,
           'recall50': 0.19966443},
     '4': {'avg_iou': 0.802674,
           'avg_obj': 0.45610756,
           'box_loss': 0.00869898,
           'class_loss': 0.003325481,
           'conf_loss': 0.018139169,
           'precision50': 0.71911794,
           'recall50': 0.44557974},
     '5': {'avg_iou': 0.8493293,
           'avg_obj': 0.5775216,
           'box_loss': 0.0064592813,
           'class_loss': 0.0026244868,
           'conf_loss': 0.01029468,
           'precision50': 0.75850546,
           'recall50': 0.5952864},
     'global': {'total_loss': 0.7333131},
     'learning_rate': 0.0039027706,
     'training_loss': 0.7333131}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-250000.
train | step:  260000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6561508,
           'avg_obj': 0.28204778,
           'box_loss': 0.013627946,
           'class_loss': 0.0047673145,
           'conf_loss': 0.023504542,
           'precision50': 0.5524608,
           'recall50': 0.20362575},
     '4': {'avg_iou': 0.8042944,
           'avg_obj': 0.46049184,
           'box_loss': 0.008625188,
           'class_loss': 0.003271397,
           'conf_loss': 0.018003365,
           'precision50': 0.7211604,
           'recall50': 0.45057726},
     '5': {'avg_iou': 0.8509364,
           'avg_obj': 0.58187515,
           'box_loss': 0.0063863215,
           'class_loss': 0.0025816879,
           'conf_loss': 0.010194563,
           'precision50': 0.7601907,
           'recall50': 0.5994967},
     'global': {'total_loss': 0.72769827},
     'learning_rate': 0.0036214672,
     'training_loss': 0.72769827}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-260000.
 eval | step:  260000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.75s).
Accumulating evaluation results...
DONE (t=10.69s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.382
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.577
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.404
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.153
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.396
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.552
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.316
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.496
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.535
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.297
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.572
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.685
 eval | step:  260000 | eval time:  473.3 sec | output: 
    {'3': {'avg_iou': 0.53151476,
           'avg_obj': 0.21955673,
           'box_loss': 0.010221972,
           'class_loss': 0.003460519,
           'conf_loss': 0.019715179,
           'precision50': 0.43683964,
           'recall50': 0.20277055},
     '4': {'avg_iou': 0.7501439,
           'avg_obj': 0.42841342,
           'box_loss': 0.008456114,
           'class_loss': 0.003070833,
           'conf_loss': 0.01607249,
           'precision50': 0.6546661,
           'recall50': 0.45801678},
     '5': {'avg_iou': 0.7810439,
           'avg_obj': 0.54491526,
           'box_loss': 0.0071487688,
           'class_loss': 0.0029046026,
           'conf_loss': 0.01076369,
           'precision50': 0.7198136,
           'recall50': 0.5968272},
     'AP': 0.382431,
     'AP50': 0.57650495,
     'AP75': 0.40407318,
     'APl': 0.55187815,
     'APm': 0.3962383,
     'APs': 0.1530729,
     'ARl': 0.6850019,
     'ARm': 0.5719776,
     'ARmax1': 0.31584325,
     'ARmax10': 0.49578303,
     'ARmax100': 0.53456837,
     'ARs': 0.2966367,
     'global': {'total_loss': 0.08181417},
     'validation_loss': 0.08181417}I0515 05:31:13.167398 140638711330624 controller.py:211] train | step:  260000 | training until step 280000...
I0515 06:59:03.448864 140638711330624 controller.py:425] train | step:  270000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6572494,
           'avg_obj': 0.28444117,
           'box_loss': 0.013595273,
           'class_loss': 0.004726972,
           'conf_loss': 0.023457855,
           'precision50': 0.5544382,
           'recall50': 0.20613413},
     '4': {'avg_iou': 0.80544585,
           'avg_obj': 0.4635394,
           'box_loss': 0.0085679,
           'class_loss': 0.0032344803,
           'conf_loss': 0.017917424,
           'precision50': 0.7230123,
           'recall50': 0.45451328},
     '5': {'avg_iou': 0.85240036,
           'avg_obj': 0.58603454,
           'box_loss': 0.0063145664,
           'class_loss': 0.0025420468,
           'conf_loss': 0.010102616,
           'precision50': 0.761387,
           'recall50': 0.6031097},
     'global': {'total_loss': 0.723674},
     'learning_rate': 0.003357301,
     'training_loss': 0.723674}
I0515 06:59:51.524757 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-270000.
I0515 08:27:45.634182 140638711330624 controller.py:425] train | step:  280000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.65856504,
           'avg_obj': 0.2867015,
           'box_loss': 0.013540906,
           'class_loss': 0.004675104,
           'conf_loss': 0.023366198,
           'precision50': 0.5564571,
           'recall50': 0.20880517},
     '4': {'avg_iou': 0.8067077,
           'avg_obj': 0.4671686,
           'box_loss': 0.008513839,
           'class_loss': 0.0031917966,
           'conf_loss': 0.017779564,
           'precision50': 0.72422194,
           'recall50': 0.45833892},
     '5': {'avg_iou': 0.853748,
           'avg_obj': 0.59004945,
           'box_loss': 0.0062603466,
           'class_loss': 0.0025079835,
           'conf_loss': 0.010009776,
           'precision50': 0.7630179,
           'recall50': 0.6069547},
     'global': {'total_loss': 0.7187651},
     'learning_rate': 0.003112175,
     'training_loss': 0.7187651}
I0515 08:28:33.059899 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-280000.
I0515 08:28:33.066175 140638711330624 controller.py:252]  eval | step:  280000 | running 625 steps of evaluation...
I0515 08:32:29.733461 140638711330624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0515 08:36:24.567810 140638711330624 controller.py:261]  eval | step:  280000 | eval time:  471.5 sec | output: 
    {'3': {'avg_iou': 0.5317361,
           'avg_obj': 0.22077304,
           'box_loss': 0.010211477,
           'class_loss': 0.0034945216,
           'conf_loss': 0.019796029,
           'precision50': 0.4369061,
           'recall50': 0.20723179},
     '4': {'avg_iou': 0.75000304,
           'avg_obj': 0.4296505,
           'box_loss': 0.008465001,
           'class_loss': 0.0031430805,
           'conf_loss': 0.016195284,
           'precision50': 0.65195906,
           'recall50': 0.4608375},
     '5': {'avg_iou': 0.78110033,
           'avg_obj': 0.54712874,
           'box_loss': 0.007146752,
           'class_loss': 0.0029918456,
           'conf_loss': 0.010922869,
           'precision50': 0.7168125,
           'recall50': 0.59800553},
     'AP': 0.38206977,
     'AP50': 0.5753677,
     'AP75': 0.40291065,
     'APl': 0.5468308,
     'APm': 0.39754793,
     'APs': 0.15374033,
     'ARl': 0.6798833,
     'ARm': 0.569106,
     'ARmax1': 0.31432754,
     'ARmax10': 0.4942304,
     'ARmax100': 0.53253454,
     'ARs': 0.30147788,
     'global': {'total_loss': 0.082366906},
     'validation_loss': 0.082366906}
I0515 08:36:46.940844 140638711330624 controller.py:211] train | step:  280000 | training until step 300000...
I0515 09:59:09.264558 140638711330624 controller.py:425] train | step:  290000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6593461,
           'avg_obj': 0.28872308,
           'box_loss': 0.013506801,
           'class_loss': 0.0046300413,
           'conf_loss': 0.023294903,
           'precision50': 0.55834395,
           'recall50': 0.21065159},
     '4': {'avg_iou': 0.8076273,
           'avg_obj': 0.469706,
           'box_loss': 0.00846803,
           'class_loss': 0.003155605,
           'conf_loss': 0.017727625,
           'precision50': 0.72601956,
           'recall50': 0.46152803},
     '5': {'avg_iou': 0.8549917,
           'avg_obj': 0.5933683,
           'box_loss': 0.0062063336,
           'class_loss': 0.002477411,
           'conf_loss': 0.0099544125,
           'precision50': 0.76488477,
           'recall50': 0.6105601},
     'global': {'total_loss': 0.7153686},
     'learning_rate': 0.002887857,
     'training_loss': 0.7153686}
I0515 10:00:01.049636 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-290000.
I0515 11:30:36.035385 140638711330624 controller.py:425] train | step:  300000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6602576,
           'avg_obj': 0.29120025,
           'box_loss': 0.01346098,
           'class_loss': 0.0045914785,
           'conf_loss': 0.023195302,
           'precision50': 0.5605347,
           'recall50': 0.21366325},
     '4': {'avg_iou': 0.8090402,
           'avg_obj': 0.4731885,
           'box_loss': 0.008407658,
           'class_loss': 0.0031144442,
           'conf_loss': 0.017611014,
           'precision50': 0.7277358,
           'recall50': 0.4657279},
     '5': {'avg_iou': 0.85626787,
           'avg_obj': 0.5968987,
           'box_loss': 0.006152184,
           'class_loss': 0.0024394656,
           'conf_loss': 0.009870953,
           'precision50': 0.7660591,
           'recall50': 0.6143501},
     'global': {'total_loss': 0.7107475},
     'learning_rate': 0.002685961,
     'training_loss': 0.7107475}
I0515 11:31:24.673787 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-300000.
I0515 11:31:24.679546 140638711330624 controller.py:252]  eval | step:  300000 | running 625 steps of evaluation...
I0515 11:35:23.362943 140638711330624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0515 11:39:24.315544 140638711330624 controller.py:261]  eval | step:  300000 | eval time:  479.6 sec | output: 
    {'3': {'avg_iou': 0.5314458,
           'avg_obj': 0.22154531,
           'box_loss': 0.010227463,
           'class_loss': 0.0035226531,
           'conf_loss': 0.019941801,
           'precision50': 0.43616104,
           'recall50': 0.2079768},
     '4': {'avg_iou': 0.74927807,
           'avg_obj': 0.43066987,
           'box_loss': 0.008501734,
           'class_loss': 0.003172954,
           'conf_loss': 0.01638298,
           'precision50': 0.65266377,
           'recall50': 0.46163985},
     '5': {'avg_iou': 0.78038955,
           'avg_obj': 0.54738027,
           'box_loss': 0.007183626,
           'class_loss': 0.0030035975,
           'conf_loss': 0.011088267,
           'precision50': 0.7131722,
           'recall50': 0.597083},
     'AP': 0.38223997,
     'AP50': 0.57455605,
     'AP75': 0.40631863,
     'APl': 0.5453058,
     'APm': 0.39758423,
     'APs': 0.15107013,
     'ARl': 0.6784988,
     'ARm': 0.56688374,
     'ARmax1': 0.3136664,
     'ARmax10': 0.4929566,
     'ARmax100': 0.53051,
     'ARs': 0.3007701,
     'global': {'total_loss': 0.083025075},
     'validation_loss': 0.083025075}

train | step:  260000 | training until step 280000...
train | step:  270000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6572494,
           'avg_obj': 0.28444117,
           'box_loss': 0.013595273,
           'class_loss': 0.004726972,
           'conf_loss': 0.023457855,
           'precision50': 0.5544382,
           'recall50': 0.20613413},
     '4': {'avg_iou': 0.80544585,
           'avg_obj': 0.4635394,
           'box_loss': 0.0085679,
           'class_loss': 0.0032344803,
           'conf_loss': 0.017917424,
           'precision50': 0.7230123,
           'recall50': 0.45451328},
     '5': {'avg_iou': 0.85240036,
           'avg_obj': 0.58603454,
           'box_loss': 0.0063145664,
           'class_loss': 0.0025420468,
           'conf_loss': 0.010102616,
           'precision50': 0.761387,
           'recall50': 0.6031097},
     'global': {'total_loss': 0.723674},
     'learning_rate': 0.003357301,
     'training_loss': 0.723674}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-270000.
train | step:  280000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.65856504,
           'avg_obj': 0.2867015,
           'box_loss': 0.013540906,
           'class_loss': 0.004675104,
           'conf_loss': 0.023366198,
           'precision50': 0.5564571,
           'recall50': 0.20880517},
     '4': {'avg_iou': 0.8067077,
           'avg_obj': 0.4671686,
           'box_loss': 0.008513839,
           'class_loss': 0.0031917966,
           'conf_loss': 0.017779564,
           'precision50': 0.72422194,
           'recall50': 0.45833892},
     '5': {'avg_iou': 0.853748,
           'avg_obj': 0.59004945,
           'box_loss': 0.0062603466,
           'class_loss': 0.0025079835,
           'conf_loss': 0.010009776,
           'precision50': 0.7630179,
           'recall50': 0.6069547},
     'global': {'total_loss': 0.7187651},
     'learning_rate': 0.003112175,
     'training_loss': 0.7187651}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-280000.
 eval | step:  280000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=175.63s).
Accumulating evaluation results...
DONE (t=10.62s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.382
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.575
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.403
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.154
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.398
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.547
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.314
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.494
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.533
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.301
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.569
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.680
 eval | step:  280000 | eval time:  471.5 sec | output: 
    {'3': {'avg_iou': 0.5317361,
           'avg_obj': 0.22077304,
           'box_loss': 0.010211477,
           'class_loss': 0.0034945216,
           'conf_loss': 0.019796029,
           'precision50': 0.4369061,
           'recall50': 0.20723179},
     '4': {'avg_iou': 0.75000304,
           'avg_obj': 0.4296505,
           'box_loss': 0.008465001,
           'class_loss': 0.0031430805,
           'conf_loss': 0.016195284,
           'precision50': 0.65195906,
           'recall50': 0.4608375},
     '5': {'avg_iou': 0.78110033,
           'avg_obj': 0.54712874,
           'box_loss': 0.007146752,
           'class_loss': 0.0029918456,
           'conf_loss': 0.010922869,
           'precision50': 0.7168125,
           'recall50': 0.59800553},
     'AP': 0.38206977,
     'AP50': 0.5753677,
     'AP75': 0.40291065,
     'APl': 0.5468308,
     'APm': 0.39754793,
     'APs': 0.15374033,
     'ARl': 0.6798833,
     'ARm': 0.569106,
     'ARmax1': 0.31432754,
     'ARmax10': 0.4942304,
     'ARmax100': 0.53253454,
     'ARs': 0.30147788,
     'global': {'total_loss': 0.082366906},
     'validation_loss': 0.082366906}
train | step:  280000 | training until step 300000...
train | step:  290000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6593461,
           'avg_obj': 0.28872308,
           'box_loss': 0.013506801,
           'class_loss': 0.0046300413,
           'conf_loss': 0.023294903,
           'precision50': 0.55834395,
           'recall50': 0.21065159},
     '4': {'avg_iou': 0.8076273,
           'avg_obj': 0.469706,
           'box_loss': 0.00846803,
           'class_loss': 0.003155605,
           'conf_loss': 0.017727625,
           'precision50': 0.72601956,
           'recall50': 0.46152803},
     '5': {'avg_iou': 0.8549917,
           'avg_obj': 0.5933683,
           'box_loss': 0.0062063336,
           'class_loss': 0.002477411,
           'conf_loss': 0.0099544125,
           'precision50': 0.76488477,
           'recall50': 0.6105601},
     'global': {'total_loss': 0.7153686},
     'learning_rate': 0.002887857,
     'training_loss': 0.7153686}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-290000.
train | step:  300000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6602576,
           'avg_obj': 0.29120025,
           'box_loss': 0.01346098,
           'class_loss': 0.0045914785,
           'conf_loss': 0.023195302,
           'precision50': 0.5605347,
           'recall50': 0.21366325},
     '4': {'avg_iou': 0.8090402,
           'avg_obj': 0.4731885,
           'box_loss': 0.008407658,
           'class_loss': 0.0031144442,
           'conf_loss': 0.017611014,
           'precision50': 0.7277358,
           'recall50': 0.4657279},
     '5': {'avg_iou': 0.85626787,
           'avg_obj': 0.5968987,
           'box_loss': 0.006152184,
           'class_loss': 0.0024394656,
           'conf_loss': 0.009870953,
           'precision50': 0.7660591,
           'recall50': 0.6143501},
     'global': {'total_loss': 0.7107475},
     'learning_rate': 0.002685961,
     'training_loss': 0.7107475}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-300000.
 eval | step:  300000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=178.58s).
Accumulating evaluation results...
DONE (t=10.97s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.382
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.575
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.406
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.151
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.398
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.545
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.314
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.493
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.531
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.301
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.567
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.678
 eval | step:  300000 | eval time:  479.6 sec | output: 
    {'3': {'avg_iou': 0.5314458,
           'avg_obj': 0.22154531,
           'box_loss': 0.010227463,
           'class_loss': 0.0035226531,
           'conf_loss': 0.019941801,
           'precision50': 0.43616104,
           'recall50': 0.2079768},
     '4': {'avg_iou': 0.74927807,
           'avg_obj': 0.43066987,
           'box_loss': 0.008501734,
           'class_loss': 0.003172954,
           'conf_loss': 0.01638298,
           'precision50': 0.65266377,
           'recall50': 0.46163985},
     '5': {'avg_iou': 0.78038955,
           'avg_obj': 0.54738027,
           'box_loss': 0.007183626,
           'class_loss': 0.0030035975,
           'conf_loss': 0.011088267,
           'precision50': 0.7131722,
           'recall50': 0.597083},
     'AP': 0.38223997,
     'AP50': 0.57455605,
     'AP75': 0.40631863,
     'APl': 0.5453058,
     'APm': 0.39758423,
     'APs': 0.15107013,
     'ARl': 0.6784988,
     'ARm': 0.56688374,
     'ARmax1': 0.3136664,
     'ARmax10': 0.4929566,
     'ARmax100': 0.53051,
     'ARs': 0.3007701,
     'global': {'total_loss': 0.083025075},
     'validation_loss': 0.083025075}I0515 11:39:46.767389 140638711330624 controller.py:211] train | step:  300000 | training until step 320000...
I0515 13:01:41.116132 140638711330624 controller.py:425] train | step:  310000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6615367,
           'avg_obj': 0.29300722,
           'box_loss': 0.013413037,
           'class_loss': 0.0045496593,
           'conf_loss': 0.023113368,
           'precision50': 0.5616236,
           'recall50': 0.21545991},
     '4': {'avg_iou': 0.8100066,
           'avg_obj': 0.4756911,
           'box_loss': 0.008355841,
           'class_loss': 0.003075858,
           'conf_loss': 0.017534904,
           'precision50': 0.72904927,
           'recall50': 0.46868268},
     '5': {'avg_iou': 0.8574209,
           'avg_obj': 0.6000493,
           'box_loss': 0.0060910704,
           'class_loss': 0.0024077517,
           'conf_loss': 0.009823215,
           'precision50': 0.7675618,
           'recall50': 0.6170939},
     'global': {'total_loss': 0.7069176},
     'learning_rate': 0.0025079434,
     'training_loss': 0.7069176}
I0515 13:02:28.345007 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-310000.
I0515 14:37:33.028076 140638711330624 controller.py:425] train | step:  320000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.66200775,
           'avg_obj': 0.2948597,
           'box_loss': 0.013386573,
           'class_loss': 0.004512484,
           'conf_loss': 0.023040006,
           'precision50': 0.5638293,
           'recall50': 0.21789669},
     '4': {'avg_iou': 0.8109089,
           'avg_obj': 0.47844496,
           'box_loss': 0.008319191,
           'class_loss': 0.0030440486,
           'conf_loss': 0.017464604,
           'precision50': 0.7304129,
           'recall50': 0.47139594},
     '5': {'avg_iou': 0.85823953,
           'avg_obj': 0.60313874,
           'box_loss': 0.006055972,
           'class_loss': 0.0023819788,
           'conf_loss': 0.009747476,
           'precision50': 0.76853853,
           'recall50': 0.6200072},
     'global': {'total_loss': 0.70361733},
     'learning_rate': 0.002355086,
     'training_loss': 0.70361733}
I0515 14:38:20.814877 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-320000.
I0515 14:38:20.822795 140638711330624 controller.py:252]  eval | step:  320000 | running 625 steps of evaluation...
I0515 14:42:20.346781 140638711330624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0515 14:46:18.087570 140638711330624 controller.py:261]  eval | step:  320000 | eval time:  477.3 sec | output: 
    {'3': {'avg_iou': 0.5313059,
           'avg_obj': 0.2229483,
           'box_loss': 0.010234603,
           'class_loss': 0.0035202217,
           'conf_loss': 0.020031087,
           'precision50': 0.43586582,
           'recall50': 0.21036264},
     '4': {'avg_iou': 0.7488634,
           'avg_obj': 0.43259394,
           'box_loss': 0.008521974,
           'class_loss': 0.0032168052,
           'conf_loss': 0.016504064,
           'precision50': 0.65018106,
           'recall50': 0.46407768},
     '5': {'avg_iou': 0.7802479,
           'avg_obj': 0.5492055,
           'box_loss': 0.0071914503,
           'class_loss': 0.0030867825,
           'conf_loss': 0.011231103,
           'precision50': 0.71209925,
           'recall50': 0.597673},
     'AP': 0.38068104,
     'AP50': 0.5726097,
     'AP75': 0.4034671,
     'APl': 0.54373413,
     'APm': 0.39718428,
     'APs': 0.15236296,
     'ARl': 0.673462,
     'ARm': 0.5645538,
     'ARmax1': 0.3113295,
     'ARmax10': 0.4902852,
     'ARmax100': 0.52781326,
     'ARs': 0.2996738,
     'global': {'total_loss': 0.08353807},
     'validation_loss': 0.08353807}
I0515 14:46:36.017313 140638711330624 controller.py:211] train | step:  320000 | training until step 340000...
I0515 16:09:40.544600 140638711330624 controller.py:425] train | step:  330000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6626545,
           'avg_obj': 0.29668567,
           'box_loss': 0.013360915,
           'class_loss': 0.0044854423,
           'conf_loss': 0.0229958,
           'precision50': 0.565974,
           'recall50': 0.2197812},
     '4': {'avg_iou': 0.811774,
           'avg_obj': 0.4810688,
           'box_loss': 0.008284205,
           'class_loss': 0.0030237492,
           'conf_loss': 0.017360244,
           'precision50': 0.7315027,
           'recall50': 0.47488937},
     '5': {'avg_iou': 0.85934377,
           'avg_obj': 0.60620654,
           'box_loss': 0.0060106264,
           'class_loss': 0.002357061,
           'conf_loss': 0.009669977,
           'precision50': 0.77015525,
           'recall50': 0.6235793},
     'global': {'total_loss': 0.7003853},
     'learning_rate': 0.0022284898,
     'training_loss': 0.7003853}
I0515 16:10:27.439287 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-330000.
I0515 17:37:38.029455 140638711330624 controller.py:425] train | step:  340000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.66298085,
           'avg_obj': 0.29781815,
           'box_loss': 0.013332762,
           'class_loss': 0.0044727935,
           'conf_loss': 0.022899488,
           'precision50': 0.5661139,
           'recall50': 0.22113167},
     '4': {'avg_iou': 0.8125398,
           'avg_obj': 0.48289227,
           'box_loss': 0.00824579,
           'class_loss': 0.0030017993,
           'conf_loss': 0.01730039,
           'precision50': 0.73268396,
           'recall50': 0.47677132},
     '5': {'avg_iou': 0.8601036,
           'avg_obj': 0.60805666,
           'box_loss': 0.0059716892,
           'class_loss': 0.0023404122,
           'conf_loss': 0.009642718,
           'precision50': 0.7707577,
           'recall50': 0.6252248},
     'global': {'total_loss': 0.69766194},
     'learning_rate': 0.0021290681,
     'training_loss': 0.69766194}
I0515 17:38:25.760215 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-340000.
I0515 17:38:25.766319 140638711330624 controller.py:252]  eval | step:  340000 | running 625 steps of evaluation...
I0515 17:42:43.149128 140638711330624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0515 17:46:45.236731 140638711330624 controller.py:261]  eval | step:  340000 | eval time:  499.5 sec | output: 
    {'3': {'avg_iou': 0.5311123,
           'avg_obj': 0.22372314,
           'box_loss': 0.010244765,
           'class_loss': 0.0035235242,
           'conf_loss': 0.020140631,
           'precision50': 0.43677104,
           'recall50': 0.21204588},
     '4': {'avg_iou': 0.74830383,
           'avg_obj': 0.43329155,
           'box_loss': 0.008550238,
           'class_loss': 0.0032563193,
           'conf_loss': 0.01664795,
           'precision50': 0.6472566,
           'recall50': 0.46496606},
     '5': {'avg_iou': 0.78000593,
           'avg_obj': 0.5496763,
           'box_loss': 0.0072040367,
           'class_loss': 0.0031025948,
           'conf_loss': 0.011346566,
           'precision50': 0.71044445,
           'recall50': 0.59859395},
     'AP': 0.3794236,
     'AP50': 0.56845134,
     'AP75': 0.4017363,
     'APl': 0.541172,
     'APm': 0.39517808,
     'APs': 0.15429552,
     'ARl': 0.6701232,
     'ARm': 0.5644168,
     'ARmax1': 0.31146967,
     'ARmax10': 0.49003482,
     'ARmax100': 0.5278573,
     'ARs': 0.30422524,
     'global': {'total_loss': 0.084016666},
     'validation_loss': 0.084016666}

train | step:  300000 | training until step 320000...
train | step:  310000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6615367,
           'avg_obj': 0.29300722,
           'box_loss': 0.013413037,
           'class_loss': 0.0045496593,
           'conf_loss': 0.023113368,
           'precision50': 0.5616236,
           'recall50': 0.21545991},
     '4': {'avg_iou': 0.8100066,
           'avg_obj': 0.4756911,
           'box_loss': 0.008355841,
           'class_loss': 0.003075858,
           'conf_loss': 0.017534904,
           'precision50': 0.72904927,
           'recall50': 0.46868268},
     '5': {'avg_iou': 0.8574209,
           'avg_obj': 0.6000493,
           'box_loss': 0.0060910704,
           'class_loss': 0.0024077517,
           'conf_loss': 0.009823215,
           'precision50': 0.7675618,
           'recall50': 0.6170939},
     'global': {'total_loss': 0.7069176},
     'learning_rate': 0.0025079434,
     'training_loss': 0.7069176}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-310000.
train | step:  320000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.66200775,
           'avg_obj': 0.2948597,
           'box_loss': 0.013386573,
           'class_loss': 0.004512484,
           'conf_loss': 0.023040006,
           'precision50': 0.5638293,
           'recall50': 0.21789669},
     '4': {'avg_iou': 0.8109089,
           'avg_obj': 0.47844496,
           'box_loss': 0.008319191,
           'class_loss': 0.0030440486,
           'conf_loss': 0.017464604,
           'precision50': 0.7304129,
           'recall50': 0.47139594},
     '5': {'avg_iou': 0.85823953,
           'avg_obj': 0.60313874,
           'box_loss': 0.006055972,
           'class_loss': 0.0023819788,
           'conf_loss': 0.009747476,
           'precision50': 0.76853853,
           'recall50': 0.6200072},
     'global': {'total_loss': 0.70361733},
     'learning_rate': 0.002355086,
     'training_loss': 0.70361733}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-320000.
 eval | step:  320000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.49s).
Accumulating evaluation results...
DONE (t=10.53s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.381
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.573
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.403
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.152
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.397
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.544
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.311
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.490
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.528
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.300
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.565
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.673
 eval | step:  320000 | eval time:  477.3 sec | output: 
    {'3': {'avg_iou': 0.5313059,
           'avg_obj': 0.2229483,
           'box_loss': 0.010234603,
           'class_loss': 0.0035202217,
           'conf_loss': 0.020031087,
           'precision50': 0.43586582,
           'recall50': 0.21036264},
     '4': {'avg_iou': 0.7488634,
           'avg_obj': 0.43259394,
           'box_loss': 0.008521974,
           'class_loss': 0.0032168052,
           'conf_loss': 0.016504064,
           'precision50': 0.65018106,
           'recall50': 0.46407768},
     '5': {'avg_iou': 0.7802479,
           'avg_obj': 0.5492055,
           'box_loss': 0.0071914503,
           'class_loss': 0.0030867825,
           'conf_loss': 0.011231103,
           'precision50': 0.71209925,
           'recall50': 0.597673},
     'AP': 0.38068104,
     'AP50': 0.5726097,
     'AP75': 0.4034671,
     'APl': 0.54373413,
     'APm': 0.39718428,
     'APs': 0.15236296,
     'ARl': 0.673462,
     'ARm': 0.5645538,
     'ARmax1': 0.3113295,
     'ARmax10': 0.4902852,
     'ARmax100': 0.52781326,
     'ARs': 0.2996738,
     'global': {'total_loss': 0.08353807},
     'validation_loss': 0.08353807}
train | step:  320000 | training until step 340000...
train | step:  330000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6626545,
           'avg_obj': 0.29668567,
           'box_loss': 0.013360915,
           'class_loss': 0.0044854423,
           'conf_loss': 0.0229958,
           'precision50': 0.565974,
           'recall50': 0.2197812},
     '4': {'avg_iou': 0.811774,
           'avg_obj': 0.4810688,
           'box_loss': 0.008284205,
           'class_loss': 0.0030237492,
           'conf_loss': 0.017360244,
           'precision50': 0.7315027,
           'recall50': 0.47488937},
     '5': {'avg_iou': 0.85934377,
           'avg_obj': 0.60620654,
           'box_loss': 0.0060106264,
           'class_loss': 0.002357061,
           'conf_loss': 0.009669977,
           'precision50': 0.77015525,
           'recall50': 0.6235793},
     'global': {'total_loss': 0.7003853},
     'learning_rate': 0.0022284898,
     'training_loss': 0.7003853}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-330000.
train | step:  340000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.66298085,
           'avg_obj': 0.29781815,
           'box_loss': 0.013332762,
           'class_loss': 0.0044727935,
           'conf_loss': 0.022899488,
           'precision50': 0.5661139,
           'recall50': 0.22113167},
     '4': {'avg_iou': 0.8125398,
           'avg_obj': 0.48289227,
           'box_loss': 0.00824579,
           'class_loss': 0.0030017993,
           'conf_loss': 0.01730039,
           'precision50': 0.73268396,
           'recall50': 0.47677132},
     '5': {'avg_iou': 0.8601036,
           'avg_obj': 0.60805666,
           'box_loss': 0.0059716892,
           'class_loss': 0.0023404122,
           'conf_loss': 0.009642718,
           'precision50': 0.7707577,
           'recall50': 0.6252248},
     'global': {'total_loss': 0.69766194},
     'learning_rate': 0.0021290681,
     'training_loss': 0.69766194}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-340000.
 eval | step:  340000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.16s).
Accumulating evaluation results...
DONE (t=10.67s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.379
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.568
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.402
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.154
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.395
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.541
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.311
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.490
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.528
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.304
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.564
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.670
 eval | step:  340000 | eval time:  499.5 sec | output: 
    {'3': {'avg_iou': 0.5311123,
           'avg_obj': 0.22372314,
           'box_loss': 0.010244765,
           'class_loss': 0.0035235242,
           'conf_loss': 0.020140631,
           'precision50': 0.43677104,
           'recall50': 0.21204588},
     '4': {'avg_iou': 0.74830383,
           'avg_obj': 0.43329155,
           'box_loss': 0.008550238,
           'class_loss': 0.0032563193,
           'conf_loss': 0.01664795,
           'precision50': 0.6472566,
           'recall50': 0.46496606},
     '5': {'avg_iou': 0.78000593,
           'avg_obj': 0.5496763,
           'box_loss': 0.0072040367,
           'class_loss': 0.0031025948,
           'conf_loss': 0.011346566,
           'precision50': 0.71044445,
           'recall50': 0.59859395},
     'AP': 0.3794236,
     'AP50': 0.56845134,
     'AP75': 0.4017363,
     'APl': 0.541172,
     'APm': 0.39517808,
     'APs': 0.15429552,
     'ARl': 0.6701232,
     'ARm': 0.5644168,
     'ARmax1': 0.31146967,
     'ARmax10': 0.49003482,
     'ARmax100': 0.5278573,
     'ARs': 0.30422524,
     'global': {'total_loss': 0.084016666},
     'validation_loss': 0.084016666}I0515 17:47:03.657734 140638711330624 controller.py:211] train | step:  340000 | training until step 360000...
I0515 19:07:49.361046 140638711330624 controller.py:425] train | step:  350000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6641897,
           'avg_obj': 0.3000705,
           'box_loss': 0.013297726,
           'class_loss': 0.004427067,
           'conf_loss': 0.022835528,
           'precision50': 0.56822956,
           'recall50': 0.22379388},
     '4': {'avg_iou': 0.8132476,
           'avg_obj': 0.4849722,
           'box_loss': 0.008206695,
           'class_loss': 0.002969946,
           'conf_loss': 0.017247876,
           'precision50': 0.7334858,
           'recall50': 0.47903422},
     '5': {'avg_iou': 0.8607959,
           'avg_obj': 0.6101973,
           'box_loss': 0.005940022,
           'class_loss': 0.0023207255,
           'conf_loss': 0.009597308,
           'precision50': 0.77118313,
           'recall50': 0.6265744},
     'global': {'total_loss': 0.69474286},
     'learning_rate': 0.0020575363,
     'training_loss': 0.69474286}
I0515 19:08:35.983962 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-350000.
I0515 20:36:44.935263 140638711330624 controller.py:425] train | step:  360000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6643889,
           'avg_obj': 0.30103397,
           'box_loss': 0.01328883,
           'class_loss': 0.0044145477,
           'conf_loss': 0.02280756,
           'precision50': 0.56865823,
           'recall50': 0.22441097},
     '4': {'avg_iou': 0.81376916,
           'avg_obj': 0.48656514,
           'box_loss': 0.008183718,
           'class_loss': 0.002948241,
           'conf_loss': 0.01720251,
           'precision50': 0.7342258,
           'recall50': 0.48074916},
     '5': {'avg_iou': 0.86139876,
           'avg_obj': 0.6125279,
           'box_loss': 0.00591643,
           'class_loss': 0.0023008669,
           'conf_loss': 0.009535833,
           'precision50': 0.7723094,
           'recall50': 0.62907463},
     'global': {'total_loss': 0.69278723},
     'learning_rate': 0.00201441,
     'training_loss': 0.69278723}
I0515 20:37:35.774110 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-360000.
I0515 20:37:35.779971 140638711330624 controller.py:252]  eval | step:  360000 | running 625 steps of evaluation...
I0515 20:41:42.979149 140638711330624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0515 20:45:39.206149 140638711330624 controller.py:261]  eval | step:  360000 | eval time:  483.4 sec | output: 
    {'3': {'avg_iou': 0.5313735,
           'avg_obj': 0.22420579,
           'box_loss': 0.010232003,
           'class_loss': 0.0035536087,
           'conf_loss': 0.020239709,
           'precision50': 0.43829048,
           'recall50': 0.21312386},
     '4': {'avg_iou': 0.74779624,
           'avg_obj': 0.4348605,
           'box_loss': 0.008575793,
           'class_loss': 0.0033119912,
           'conf_loss': 0.016734822,
           'precision50': 0.6481548,
           'recall50': 0.46689555},
     '5': {'avg_iou': 0.779606,
           'avg_obj': 0.55160457,
           'box_loss': 0.0072247605,
           'class_loss': 0.0031659089,
           'conf_loss': 0.011415642,
           'precision50': 0.7094051,
           'recall50': 0.6011864},
     'AP': 0.38023615,
     'AP50': 0.5690338,
     'AP75': 0.40298188,
     'APl': 0.543181,
     'APm': 0.3938797,
     'APs': 0.15504879,
     'ARl': 0.6696223,
     'ARm': 0.561871,
     'ARmax1': 0.312055,
     'ARmax10': 0.49072018,
     'ARmax100': 0.5277034,
     'ARs': 0.30216098,
     'global': {'total_loss': 0.08445431},
     'validation_loss': 0.08445431}
I0515 20:45:58.089218 140638711330624 controller.py:211] train | step:  360000 | training until step 375000...
I0515 22:07:03.761222 140638711330624 controller.py:425] train | step:  370000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.66473484,
           'avg_obj': 0.30199796,
           'box_loss': 0.013254063,
           'class_loss': 0.004386305,
           'conf_loss': 0.022729535,
           'precision50': 0.56933695,
           'recall50': 0.22590017},
     '4': {'avg_iou': 0.8142965,
           'avg_obj': 0.48835796,
           'box_loss': 0.0081595555,
           'class_loss': 0.002940783,
           'conf_loss': 0.017086677,
           'precision50': 0.73515314,
           'recall50': 0.4830557},
     '5': {'avg_iou': 0.8619829,
           'avg_obj': 0.61426157,
           'box_loss': 0.0058850017,
           'class_loss': 0.0022866847,
           'conf_loss': 0.009474866,
           'precision50': 0.77210635,
           'recall50': 0.62994254},
     'global': {'total_loss': 0.68962854},
     'learning_rate': 0.002,
     'training_loss': 0.68962854}
I0515 22:07:54.627589 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-370000.
I0515 22:51:15.561068 140638711330624 controller.py:425] train | step:  375000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6647551,
           'avg_obj': 0.30267036,
           'box_loss': 0.013246971,
           'class_loss': 0.0043734075,
           'conf_loss': 0.022694184,
           'precision50': 0.569655,
           'recall50': 0.22621797},
     '4': {'avg_iou': 0.8146028,
           'avg_obj': 0.48901114,
           'box_loss': 0.008148882,
           'class_loss': 0.002933563,
           'conf_loss': 0.017093744,
           'precision50': 0.7348016,
           'recall50': 0.48358282},
     '5': {'avg_iou': 0.86213875,
           'avg_obj': 0.61508286,
           'box_loss': 0.0058779228,
           'class_loss': 0.00228719,
           'conf_loss': 0.009478913,
           'precision50': 0.77177995,
           'recall50': 0.63066554},
     'global': {'total_loss': 0.68907744},
     'learning_rate': 0.002,
     'training_loss': 0.68907744}
I0515 22:51:28.708923 140638711330624 controller.py:252]  eval | step:  375000 | running 625 steps of evaluation...
I0515 22:55:28.383577 140638711330624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0515 22:59:24.513688 140638711330624 controller.py:261]  eval | step:  375000 | eval time:  475.8 sec | output: 
    {'3': {'avg_iou': 0.53089505,
           'avg_obj': 0.22414802,
           'box_loss': 0.010256442,
           'class_loss': 0.0035673718,
           'conf_loss': 0.020271672,
           'precision50': 0.4360581,
           'recall50': 0.21292178},
     '4': {'avg_iou': 0.74753404,
           'avg_obj': 0.43545097,
           'box_loss': 0.008590728,
           'class_loss': 0.0032997387,
           'conf_loss': 0.016812505,
           'precision50': 0.64904344,
           'recall50': 0.4675029},
     '5': {'avg_iou': 0.7792284,
           'avg_obj': 0.5524277,
           'box_loss': 0.0072435583,
           'class_loss': 0.0031949056,
           'conf_loss': 0.011474451,
           'precision50': 0.708904,
           'recall50': 0.6020839},
     'AP': 0.37956163,
     'AP50': 0.56909597,
     'AP75': 0.39991376,
     'APl': 0.54263633,
     'APm': 0.39382216,
     'APs': 0.15558389,
     'ARl': 0.67113554,
     'ARm': 0.5628882,
     'ARmax1': 0.3117443,
     'ARmax10': 0.48960125,
     'ARmax100': 0.52725595,
     'ARs': 0.30332026,
     'global': {'total_loss': 0.08471141},
     'validation_loss': 0.08471141}

train | step:  340000 | training until step 360000...
train | step:  350000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6641897,
           'avg_obj': 0.3000705,
           'box_loss': 0.013297726,
           'class_loss': 0.004427067,
           'conf_loss': 0.022835528,
           'precision50': 0.56822956,
           'recall50': 0.22379388},
     '4': {'avg_iou': 0.8132476,
           'avg_obj': 0.4849722,
           'box_loss': 0.008206695,
           'class_loss': 0.002969946,
           'conf_loss': 0.017247876,
           'precision50': 0.7334858,
           'recall50': 0.47903422},
     '5': {'avg_iou': 0.8607959,
           'avg_obj': 0.6101973,
           'box_loss': 0.005940022,
           'class_loss': 0.0023207255,
           'conf_loss': 0.009597308,
           'precision50': 0.77118313,
           'recall50': 0.6265744},
     'global': {'total_loss': 0.69474286},
     'learning_rate': 0.0020575363,
     'training_loss': 0.69474286}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-350000.
train | step:  360000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6643889,
           'avg_obj': 0.30103397,
           'box_loss': 0.01328883,
           'class_loss': 0.0044145477,
           'conf_loss': 0.02280756,
           'precision50': 0.56865823,
           'recall50': 0.22441097},
     '4': {'avg_iou': 0.81376916,
           'avg_obj': 0.48656514,
           'box_loss': 0.008183718,
           'class_loss': 0.002948241,
           'conf_loss': 0.01720251,
           'precision50': 0.7342258,
           'recall50': 0.48074916},
     '5': {'avg_iou': 0.86139876,
           'avg_obj': 0.6125279,
           'box_loss': 0.00591643,
           'class_loss': 0.0023008669,
           'conf_loss': 0.009535833,
           'precision50': 0.7723094,
           'recall50': 0.62907463},
     'global': {'total_loss': 0.69278723},
     'learning_rate': 0.00201441,
     'training_loss': 0.69278723}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-360000.
 eval | step:  360000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.03s).
Accumulating evaluation results...
DONE (t=10.18s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.380
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.569
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.403
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.155
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.394
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.543
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.312
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.528
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.302
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.562
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.670
 eval | step:  360000 | eval time:  483.4 sec | output: 
    {'3': {'avg_iou': 0.5313735,
           'avg_obj': 0.22420579,
           'box_loss': 0.010232003,
           'class_loss': 0.0035536087,
           'conf_loss': 0.020239709,
           'precision50': 0.43829048,
           'recall50': 0.21312386},
     '4': {'avg_iou': 0.74779624,
           'avg_obj': 0.4348605,
           'box_loss': 0.008575793,
           'class_loss': 0.0033119912,
           'conf_loss': 0.016734822,
           'precision50': 0.6481548,
           'recall50': 0.46689555},
     '5': {'avg_iou': 0.779606,
           'avg_obj': 0.55160457,
           'box_loss': 0.0072247605,
           'class_loss': 0.0031659089,
           'conf_loss': 0.011415642,
           'precision50': 0.7094051,
           'recall50': 0.6011864},
     'AP': 0.38023615,
     'AP50': 0.5690338,
     'AP75': 0.40298188,
     'APl': 0.543181,
     'APm': 0.3938797,
     'APs': 0.15504879,
     'ARl': 0.6696223,
     'ARm': 0.561871,
     'ARmax1': 0.312055,
     'ARmax10': 0.49072018,
     'ARmax100': 0.5277034,
     'ARs': 0.30216098,
     'global': {'total_loss': 0.08445431},
     'validation_loss': 0.08445431}
train | step:  360000 | training until step 375000...
train | step:  370000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.66473484,
           'avg_obj': 0.30199796,
           'box_loss': 0.013254063,
           'class_loss': 0.004386305,
           'conf_loss': 0.022729535,
           'precision50': 0.56933695,
           'recall50': 0.22590017},
     '4': {'avg_iou': 0.8142965,
           'avg_obj': 0.48835796,
           'box_loss': 0.0081595555,
           'class_loss': 0.002940783,
           'conf_loss': 0.017086677,
           'precision50': 0.73515314,
           'recall50': 0.4830557},
     '5': {'avg_iou': 0.8619829,
           'avg_obj': 0.61426157,
           'box_loss': 0.0058850017,
           'class_loss': 0.0022866847,
           'conf_loss': 0.009474866,
           'precision50': 0.77210635,
           'recall50': 0.62994254},
     'global': {'total_loss': 0.68962854},
     'learning_rate': 0.002,
     'training_loss': 0.68962854}
saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-370000.
train | step:  375000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6647551,
           'avg_obj': 0.30267036,
           'box_loss': 0.013246971,
           'class_loss': 0.0043734075,
           'conf_loss': 0.022694184,
           'precision50': 0.569655,
           'recall50': 0.22621797},
     '4': {'avg_iou': 0.8146028,
           'avg_obj': 0.48901114,
           'box_loss': 0.008148882,
           'class_loss': 0.002933563,
           'conf_loss': 0.017093744,
           'precision50': 0.7348016,
           'recall50': 0.48358282},
     '5': {'avg_iou': 0.86213875,
           'avg_obj': 0.61508286,
           'box_loss': 0.0058779228,
           'class_loss': 0.00228719,
           'conf_loss': 0.009478913,
           'precision50': 0.77177995,
           'recall50': 0.63066554},
     'global': {'total_loss': 0.68907744},
     'learning_rate': 0.002,
     'training_loss': 0.68907744}
 eval | step:  375000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.05s).
Accumulating evaluation results...
DONE (t=10.41s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.380
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.569
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.400
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.156
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.394
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.543
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.312
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.490
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.527
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.303
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.563
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.671
 eval | step:  375000 | eval time:  475.8 sec | output: 
    {'3': {'avg_iou': 0.53089505,
           'avg_obj': 0.22414802,
           'box_loss': 0.010256442,
           'class_loss': 0.0035673718,
           'conf_loss': 0.020271672,
           'precision50': 0.4360581,
           'recall50': 0.21292178},
     '4': {'avg_iou': 0.74753404,
           'avg_obj': 0.43545097,
           'box_loss': 0.008590728,
           'class_loss': 0.0032997387,
           'conf_loss': 0.016812505,
           'precision50': 0.64904344,
           'recall50': 0.4675029},
     '5': {'avg_iou': 0.7792284,
           'avg_obj': 0.5524277,
           'box_loss': 0.0072435583,
           'class_loss': 0.0031949056,
           'conf_loss': 0.011474451,
           'precision50': 0.708904,
           'recall50': 0.6020839},
     'AP': 0.37956163,
     'AP50': 0.56909597,
     'AP75': 0.39991376,
     'APl': 0.54263633,
     'APm': 0.39382216,
     'APs': 0.15558389,
     'ARl': 0.67113554,
     'ARm': 0.5628882,
     'ARmax1': 0.3117443,
     'ARmax10': 0.48960125,
     'ARmax100': 0.52725595,
     'ARs': 0.30332026,
     'global': {'total_loss': 0.08471141},
     'validation_loss': 0.08471141}I0515 23:00:15.935681 140638711330624 controller.py:455] saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-375000.
I0515 23:00:15.953178 140638711330624 train_lib.py:123] Number of trainable params in model: 53.066944 Millions.

saved checkpoint to gs://tensorflow2/yolov4-csp/tpu/512-torch-scaled/ckpt-375000.
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   217    0     2  100   215      7    839 --:--:-- --:--:-- --:--:--   844
okRequest issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-05-15T23:05:58.274285640Z'
  endTime: '2021-05-15T23:06:35.721952142Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621119958242-5c266673fd4eb-ece44610-a9d489dd
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T05:45:10.821112479Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T05:44:59.159875+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  - createTime: '2021-04-27T19:29:05.781890630Z'
    details: The TPU runtime has run OOM at timestamp 2021-04-27T19:28:54.243943+00:00
    symptomType: OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1621119958242-5c266673fd4eb-ece44610-a9d489dd] to complete...
..........................................................................................................................................................................................................................................................................done.
