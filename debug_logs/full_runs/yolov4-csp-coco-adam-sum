cat: .experiment_zone: No such file or directory
Request issued for: [node-3]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-01T20:59:30.557090082Z'
  endTime: '2021-04-01T21:00:21.856852276Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617310770543-5beef81f83cd7-6015d43a-faf5d1a5
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617310770543-5beef81f83cd7-6015d43a-faf5d1a5] to complete...
....................................................................................................................................................................................................................................................................................done.
europe-west4-a
I0401 21:00:28.523283 139828038801216 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'aug_rand_angle': 5.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_transalate': 0.0,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_boxes': 0.1,
                                    'jitter_im': 0.3,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'max_process_size': 608,
                                    'min_process_size': 320,
                                    'mosaic': {'crop_area': [0.5, 1.0],
                                               'crop_area_mosaic': [0.25, 0.75],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': False,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'aug_rand_angle': 5.0,
                                         'aug_rand_brightness': 0.75,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.75,
                                         'aug_rand_transalate': 0.0,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.1,
                                         'jitter_im': 0.3,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'max_process_size': 608,
                                         'min_process_size': 320,
                                         'mosaic': {'crop_area': [0.5, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.75],
                                                    'mosaic_frequency': 0.75,
                                                    'output_size': [640, 640],
                                                    'random_crop': False,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.01,
                                                               'decay_steps': 336500,
                                                               'initial_learning_rate': 0.001,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'adam': {'amsgrad': False,
                                                         'beta_1': 0.949,
                                                         'beta_2': 0.999,
                                                         'clipnorm': None,
                                                         'clipvalue': None,
                                                         'epsilon': 1e-07,
                                                         'global_clipnorm': None,
                                                         'name': 'adam'},
                                                'type': 'adam'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 20000,
             'summary_interval': 20000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0401 21:00:28.524260 139828038801216 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/params.yaml
I0401 21:00:30.047903 139828038801216 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0401 21:00:30.188452 139828038801216 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0401 21:00:30.188713 139828038801216 transport.py:157] Attempting refresh to obtain initial access_token
I0401 21:00:30.242769 139828038801216 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0401 21:00:30.856678 139828038801216 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0401 21:00:30.857376 139828038801216 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-01 21:00:30.899701: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0401 21:00:30.900455 139828038801216 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0401 21:00:31.041512 139828038801216 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0401 21:00:31.041746 139828038801216 transport.py:157] Attempting refresh to obtain initial access_token
I0401 21:00:31.105908 139828038801216 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0401 21:00:31.246680 139828038801216 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0401 21:00:31.246938 139828038801216 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-01 21:00:31.297722: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-01 21:00:31.312437: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-04-01 21:00:31.312506: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:35545}
2021-04-01 21:00:54.647021: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-04-01 21:00:54.647110: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:35545}
2021-04-01 21:00:54.647633: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:35545
I0401 21:00:54.651266 139828038801216 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-3
I0401 21:00:54.654033 139828038801216 tpu_strategy_util.py:74] Initializing the TPU system: node-3
INFO:tensorflow:Clearing out eager caches
I0401 21:01:01.979553 139828038801216 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0401 21:01:01.981476 139828038801216 tpu_strategy_util.py:133] Finished initializing TPU system.
I0401 21:01:01.982982 139828038801216 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0401 21:01:02.126518 139828038801216 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0401 21:01:02.126764 139828038801216 transport.py:157] Attempting refresh to obtain initial access_token
I0401 21:01:02.177720 139828038801216 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0401 21:01:02.314964 139828038801216 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0401 21:01:02.315238 139828038801216 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0401 21:01:02.374165 139828038801216 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0401 21:01:02.374425 139828038801216 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0401 21:01:02.374727 139828038801216 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0401 21:01:02.374831 139828038801216 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0401 21:01:02.374938 139828038801216 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0401 21:01:02.375200 139828038801216 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0401 21:01:02.375311 139828038801216 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0401 21:01:02.375409 139828038801216 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0401 21:01:02.375506 139828038801216 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0401 21:01:02.375592 139828038801216 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0401 21:01:02.375664 139828038801216 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0401 21:01:02.375757 139828038801216 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0401 21:01:02.375889 139828038801216 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0401 21:01:02.375987 139828038801216 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0401 21:01:02.376080 139828038801216 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0401 21:01:02.376131 139828038801216 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0401 21:01:02.412684 139828038801216 train_utils.py:214] Running default trainer.
2021-04-01 21:01:02.421195: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 320, 'max_process_size': 608, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'jitter_boxes': 0.1, 'aug_rand_transalate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_zoom': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_angle': 5.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.5, 1.0], 'crop_area_mosaic': [0.25, 0.75], 'random_crop': False, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 320, 'max_process_size': 608, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'jitter_boxes': 0.1, 'aug_rand_transalate': 0.0, 'aug_rand_saturation': 0.75, 'aug_rand_brightness': 0.75, 'aug_rand_zoom': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_angle': 5.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.75, 'crop_area': [0.5, 1.0], 'crop_area_mosaic': [0.25, 0.75], 'random_crop': False, 'random_crop_mosaic': True}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'adam', 'adam': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'adam', 'beta_1': 0.949, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.001, 'decay_steps': 336500, 'alpha': 0.01}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 20000, 'summary_interval': 20000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
{'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f2bd83f8da0>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
route_split 512.0 512.0
conv2 512.0
conv1 512.0
spp
conv1 512.0
conv2 512.0
connect
conv1 512.0
8
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
route_split 256.0 256.0
conv2 256.0
conv1 256.0
conv2 256.0
connect
conv1 256.0
6
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)








 ListWrapper([128, 256, 512])
route_split 128 128
conv2 128
conv1 128
conv2 128
connect
conv1 128
conv2 256
7
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
route_split 256 256
conv2 256
conv1 256
conv2 256
connect
conv1 256
conv2 512
7
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
route_split 512 512
conv2 512
conv1 512
conv2 512
connect
conv1 512
conv2 1024
7
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
detget {'3': 2.0, '4': 2.0, '5': 2.0}
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)I0401 21:01:49.227863 139828038801216 controller.py:362] restoring or initializing model...
I0401 21:01:57.533279 139828038801216 yolo.py:455] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0401 21:01:57.534892 139828038801216 controller.py:368] initialized model.
I0401 21:01:57.535130 139828038801216 train_lib.py:96] Starts to execute mode: train_and_eval
I0401 21:01:57.539879 139828038801216 controller.py:211] train | step:      0 | training until step 20000...
I0401 21:02:04.699308 139828038801216 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 149, in main
    model_dir=model_dir)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_lib.py", line 104, in run_experiment
    eval_interval=params.trainer.validation_interval)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 303, in train_and_evaluate
    self.train(steps=num_steps, checkpoint_at_completion=False)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 215, in train
    self._train_n_steps(num_steps)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 410, in _train_n_steps
    train_output = self.trainer.train(num_steps_tensor)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/standard_runner.py", line 141, in train
    self._train_loop_fn(self._train_iter, num_steps)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py", line 828, in __call__
    result = self._call(*args, **kwds)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py", line 871, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py", line 726, in _initialize
    *args, **kwds))
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py", line 2969, in _get_concrete_function_internal_garbage_collected
    graph_function, _ = self._maybe_define_function(args, kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py", line 3361, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py", line 3206, in _create_graph_function
    capture_by_value=self._capture_by_value),
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/func_graph.py", line 990, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py", line 634, in wrapped_fn
    out = weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/func_graph.py", line 977, in wrapper
    raise e.ag_error_metadata.to_exception(e)
ValueError: in user code:

    /home/cam2tensorflow/TensorFlowModels/orbit/utils/loop_fns.py:118 loop_fn  *
        step_fn(iterator)
    /home/cam2tensorflow/TensorFlowModels/official/core/base_trainer.py:292 step_fn  *
        logs = self.task.train_step(
    /home/cam2tensorflow/TensorFlowModels/yolo/tasks/yolo.py:210 train_step  *
        y_pred = model(image, training=True)
    /home/cam2tensorflow/TensorFlowModels/yolo/modeling/Yolo.py:32 call  *
        maps = self._backbone(inputs)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py:998 __call__  **
        input_spec.assert_input_compatibility(self.input_spec, inputs, self.name)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/input_spec.py:274 assert_input_compatibility
        ', found shape=' + display_shape(x.shape))

    ValueError: Input 0 is incompatible with layer cspdarknet53: expected shape=(None, 640, 640, 3), found shape=(8, 512, 512, 3)


(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 80, 80, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4), num_detections: (8,), upds: {3: (8, 400, 8), 4: (8, 400, 8), 5: (8, 400, 8)}, inds: {3: (8, 400, 3), 4: (8, 400, 3), 5: (8, 400, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 640, 640, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 80, 80, 3, 1), 4: (1, 40, 40, 3, 1), 5: (1, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   220    0     2  100   218     11   1289 --:--:-- --:--:-- --:--:--  1301
okRequest issued for: [node-3]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-01T21:02:08.834266761Z'
  endTime: '2021-04-01T21:02:47.887622260Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617310928823-5beef8b6763ca-cca4db21-a5768704
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617310928823-5beef8b6763ca-cca4db21-a5768704] to complete...
................................................................................................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-3]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-01T21:03:26.590854672Z'
  endTime: '2021-04-01T21:04:01.851779699Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617311006578-5beef9009d8ce-68fba1bf-579e69e6
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617311006578-5beef9009d8ce-68fba1bf-579e69e6] to complete...
..........................................................................................................................................................................................done.
europe-west4-a
I0401 21:04:06.379420 139684420589376 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'aug_rand_angle': 5.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_transalate': 0.0,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.1,
                                    'jitter_im': 0.3,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'max_process_size': 608,
                                    'min_process_size': 320,
                                    'mosaic': {'crop_area': [0.5, 1.0],
                                               'crop_area_mosaic': [0.25, 0.75],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': False,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'aug_rand_angle': 5.0,
                                         'aug_rand_brightness': 0.75,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.75,
                                         'aug_rand_transalate': 0.0,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.1,
                                         'jitter_im': 0.3,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'max_process_size': 608,
                                         'min_process_size': 320,
                                         'mosaic': {'crop_area': [0.5, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.75],
                                                    'mosaic_frequency': 0.75,
                                                    'output_size': [640, 640],
                                                    'random_crop': False,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.01,
                                                               'decay_steps': 336500,
                                                               'initial_learning_rate': 0.001,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'adam': {'amsgrad': False,
                                                         'beta_1': 0.949,
                                                         'beta_2': 0.999,
                                                         'clipnorm': None,
                                                         'clipvalue': None,
                                                         'epsilon': 1e-07,
                                                         'global_clipnorm': None,
                                                         'name': 'adam'},
                                                'type': 'adam'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 20000,
             'summary_interval': 20000,
             'train_steps': 375000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0401 21:04:06.380789 139684420589376 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/params.yaml
I0401 21:04:07.179538 139684420589376 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0401 21:04:07.321368 139684420589376 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0401 21:04:07.321669 139684420589376 transport.py:157] Attempting refresh to obtain initial access_token
I0401 21:04:07.409108 139684420589376 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0401 21:04:08.025513 139684420589376 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0401 21:04:08.025782 139684420589376 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-01 21:04:08.069445: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0401 21:04:08.070122 139684420589376 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0401 21:04:08.207163 139684420589376 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0401 21:04:08.207394 139684420589376 transport.py:157] Attempting refresh to obtain initial access_token
I0401 21:04:08.251082 139684420589376 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0401 21:04:08.863678 139684420589376 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0401 21:04:08.863925 139684420589376 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-01 21:04:08.906874: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-01 21:04:08.916983: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-04-01 21:04:08.917249: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:35794}
2021-04-01 21:04:41.217306: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-04-01 21:04:41.217409: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:35794}
2021-04-01 21:04:41.217887: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:35794
I0401 21:04:41.218862 139684420589376 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-3
I0401 21:04:41.219865 139684420589376 tpu_strategy_util.py:74] Initializing the TPU system: node-3
INFO:tensorflow:Clearing out eager caches
I0401 21:04:49.050899 139684420589376 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0401 21:04:49.052891 139684420589376 tpu_strategy_util.py:133] Finished initializing TPU system.
I0401 21:04:49.054550 139684420589376 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0401 21:04:49.196212 139684420589376 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0401 21:04:49.196449 139684420589376 transport.py:157] Attempting refresh to obtain initial access_token
I0401 21:04:49.263217 139684420589376 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0401 21:04:49.402943 139684420589376 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0401 21:04:49.403199 139684420589376 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0401 21:04:49.453862 139684420589376 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0401 21:04:49.454089 139684420589376 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0401 21:04:49.454374 139684420589376 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0401 21:04:49.454426 139684420589376 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0401 21:04:49.454475 139684420589376 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0401 21:04:49.454592 139684420589376 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0401 21:04:49.454644 139684420589376 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0401 21:04:49.454694 139684420589376 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0401 21:04:49.454741 139684420589376 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0401 21:04:49.454786 139684420589376 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0401 21:04:49.454832 139684420589376 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0401 21:04:49.454880 139684420589376 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0401 21:04:49.454927 139684420589376 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0401 21:04:49.454972 139684420589376 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0401 21:04:49.455022 139684420589376 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0401 21:04:49.455101 139684420589376 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0401 21:04:49.489705 139684420589376 train_utils.py:214] Running default trainer.
2021-04-01 21:04:49.497679: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 320, 'max_process_size': 608, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'jitter_boxes': 0.1, 'aug_rand_transalate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_zoom': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_angle': 5.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.5, 1.0], 'crop_area_mosaic': [0.25, 0.75], 'random_crop': False, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 320, 'max_process_size': 608, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'jitter_boxes': 0.1, 'aug_rand_transalate': 0.0, 'aug_rand_saturation': 0.75, 'aug_rand_brightness': 0.75, 'aug_rand_zoom': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_angle': 5.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.75, 'crop_area': [0.5, 1.0], 'crop_area_mosaic': [0.25, 0.75], 'random_crop': False, 'random_crop_mosaic': True}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'adam', 'adam': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'adam', 'beta_1': 0.949, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.001, 'decay_steps': 336500, 'alpha': 0.01}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 20000, 'summary_interval': 20000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 375000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
{'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f0a6bf7b048>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
route_split 512.0 512.0
conv2 512.0
conv1 512.0
spp
conv1 512.0
conv2 512.0
connect
conv1 512.0
8
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
route_split 256.0 256.0
conv2 256.0
conv1 256.0
conv2 256.0
connect
conv1 256.0
6
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)








 ListWrapper([128, 256, 512])
route_split 128 128
conv2 128
conv1 128
conv2 128
connect
conv1 128
conv2 256
7
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
route_split 256 256
conv2 256
conv1 256
conv2 256
connect
conv1 256
conv2 512
7
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
route_split 512 512
conv2 512
conv1 512
conv2 512
connect
conv1 512
conv2 1024
7
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
detget {'3': 2.0, '4': 2.0, '5': 2.0}
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)I0401 21:05:35.678052 139684420589376 controller.py:362] restoring or initializing model...
I0401 21:05:41.566147 139684420589376 yolo.py:455] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0401 21:05:41.568007 139684420589376 controller.py:368] initialized model.
I0401 21:05:41.568240 139684420589376 train_lib.py:96] Starts to execute mode: train_and_eval
I0401 21:05:41.573347 139684420589376 controller.py:211] train | step:      0 | training until step 20000...
I0401 21:05:47.364938 139684420589376 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0401 21:06:30.710945 139684420589376 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0401 23:17:18.864514 139684420589376 controller.py:425] train | step:  20000 | steps/sec:    2.5 | output: 
    {'avg_iou_3': 0.5899465,
     'avg_iou_4': 0.682497,
     'avg_iou_5': 0.72986954,
     'avg_obj_3': 0.1620931,
     'avg_obj_4': 0.27272218,
     'avg_obj_5': 0.37551484,
     'box_loss_3': 0.13564973,
     'box_loss_4': 0.11840187,
     'box_loss_5': 0.1081743,
     'class_loss_3': 0.14255713,
     'class_loss_4': 0.13805474,
     'class_loss_5': 0.12424855,
     'conf_loss_3': 0.6338656,
     'conf_loss_4': 0.2872883,
     'conf_loss_5': 0.18316983,
     'learning_rate': 0.000991396,
     'recall50_3': 0.07564746,
     'recall50_4': 0.20787022,
     'recall50_5': 0.35825098,
     'total_loss': 1.8714061,
     'training_loss': 1.8714061}
I0401 23:18:22.233237 139684420589376 controller.py:455] saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-20000.
I0401 23:18:22.240093 139684420589376 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0401 23:18:22.880811 139684420589376 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0401 23:18:39.998458 139684420589376 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0401 23:23:42.565522 139684420589376 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0401 23:27:54.254557 139684420589376 controller.py:261]  eval | step:  20000 | eval time:  572.0 sec | output: 
    {'AP': 0.34587497,
     'AP50': 0.54443526,
     'AP75': 0.3706313,
     'APl': 0.47401553,
     'APm': 0.32760295,
     'APs': 0.12096762,
     'ARl': 0.6680854,
     'ARm': 0.5381055,
     'ARmax1': 0.29828128,
     'ARmax10': 0.48911023,
     'ARmax100': 0.5354108,
     'ARs': 0.29084316,
     'avg_iou_3': 0.46543774,
     'avg_iou_4': 0.6783584,
     'avg_iou_5': 0.7969078,
     'avg_obj_3': 0.19365297,
     'avg_obj_4': 0.3877333,
     'avg_obj_5': 0.5472737,
     'box_loss_3': 0.008699149,
     'box_loss_4': 0.008846147,
     'box_loss_5': 0.008337913,
     'class_loss_3': 0.0033718082,
     'class_loss_4': 0.003732934,
     'class_loss_5': 0.0037700406,
     'conf_loss_3': 0.007196455,
     'conf_loss_4': 0.008330386,
     'conf_loss_5': 0.008657187,
     'recall50_3': 0.17420633,
     'recall50_4': 0.41800103,
     'recall50_5': 0.6141971,
     'total_loss': 0.060941976,
     'validation_loss': 0.060941976}

(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 80, 80, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 640, 640, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4), num_detections: (8,), upds: {3: (8, 400, 8), 4: (8, 400, 8), 5: (8, 400, 8)}, inds: {3: (8, 400, 3), 4: (8, 400, 3), 5: (8, 400, 3)}, true_conf: {3: (8, 80, 80, 3, 1), 4: (8, 40, 40, 3, 1), 5: (8, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 640, 640, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 80, 80, 3, 1), 4: (1, 40, 40, 3, 1), 5: (1, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
train | step:  20000 | steps/sec:    2.5 | output: 
    {'avg_iou_3': 0.5899465,
     'avg_iou_4': 0.682497,
     'avg_iou_5': 0.72986954,
     'avg_obj_3': 0.1620931,
     'avg_obj_4': 0.27272218,
     'avg_obj_5': 0.37551484,
     'box_loss_3': 0.13564973,
     'box_loss_4': 0.11840187,
     'box_loss_5': 0.1081743,
     'class_loss_3': 0.14255713,
     'class_loss_4': 0.13805474,
     'class_loss_5': 0.12424855,
     'conf_loss_3': 0.6338656,
     'conf_loss_4': 0.2872883,
     'conf_loss_5': 0.18316983,
     'learning_rate': 0.000991396,
     'recall50_3': 0.07564746,
     'recall50_4': 0.20787022,
     'recall50_5': 0.35825098,
     'total_loss': 1.8714061,
     'training_loss': 1.8714061}
saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-20000.
 eval | step:  20000 | running 625 steps of evaluation...
(1, 20, 20, 512) (1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 2048)
(1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 1024)
(1, 20, 20, 512)
(1, 40, 40, 256) (1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 512)
(1, 40, 40, 256)
(1, 80, 80, 128) (1, 80, 80, 128)
(1, 80, 80, 128)
(1, 80, 80, 128)
(1, 80, 80, 128)
(1, 80, 80, 256)
(1, 80, 80, 128)
(1, 80, 80, 256)
(1, 40, 40, 256) (1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 512)
(1, 40, 40, 256)
(1, 40, 40, 512)
(1, 20, 20, 512) (1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 1024)
(1, 20, 20, 512)
(1, 20, 20, 1024)
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=179.84s).
Accumulating evaluation results...
DONE (t=18.14s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.346
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.544
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.371
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.121
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.328
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.474
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.298
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.489
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.535
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.291
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.538
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.668
 eval | step:  20000 | eval time:  572.0 sec | output: 
    {'AP': 0.34587497,
     'AP50': 0.54443526,
     'AP75': 0.3706313,
     'APl': 0.47401553,
     'APm': 0.32760295,
     'APs': 0.12096762,
     'ARl': 0.6680854,
     'ARm': 0.5381055,
     'ARmax1': 0.29828128,
     'ARmax10': 0.48911023,
     'ARmax100': 0.5354108,
     'ARs': 0.29084316,
     'avg_iou_3': 0.46543774,
     'avg_iou_4': 0.6783584,
     'avg_iou_5': 0.7969078,
     'avg_obj_3': 0.19365297,
     'avg_obj_4': 0.3877333,
     'avg_obj_5': 0.5472737,
     'box_loss_3': 0.008699149,
     'box_loss_4': 0.008846147,
     'box_loss_5': 0.008337913,
     'class_loss_3': 0.0033718082,
     'class_loss_4': 0.003732934,
     'class_loss_5': 0.0037700406,
     'conf_loss_3': 0.007196455,
     'conf_loss_4': 0.008330386,
     'conf_loss_5': 0.008657187,
     'recall50_3': 0.17420633,
     'recall50_4': 0.41800103,
     'recall50_5': 0.6141971,
     'total_loss': 0.060941976,
     'validation_loss': 0.060941976}I0401 23:28:25.195960 139684420589376 controller.py:211] train | step:  20000 | training until step 40000...
I0402 01:37:09.851208 139684420589376 controller.py:425] train | step:  40000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.6493356,
     'avg_iou_4': 0.7522618,
     'avg_iou_5': 0.802709,
     'avg_obj_3': 0.22582261,
     'avg_obj_4': 0.37163958,
     'avg_obj_5': 0.4904398,
     'box_loss_3': 0.115085766,
     'box_loss_4': 0.091114834,
     'box_loss_5': 0.077843875,
     'class_loss_3': 0.04515498,
     'class_loss_4': 0.040179916,
     'class_loss_5': 0.03887412,
     'conf_loss_3': 0.17898779,
     'conf_loss_4': 0.16633444,
     'conf_loss_5': 0.12489963,
     'learning_rate': 0.000965883,
     'recall50_3': 0.13860647,
     'recall50_4': 0.3374444,
     'recall50_5': 0.5200113,
     'total_loss': 0.87847775,
     'training_loss': 0.87847775}
I0402 01:38:11.910520 139684420589376 controller.py:455] saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-40000.
I0402 01:38:11.917358 139684420589376 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0402 01:42:32.967155 139684420589376 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0402 01:46:48.527782 139684420589376 controller.py:261]  eval | step:  40000 | eval time:  516.6 sec | output: 
    {'AP': 0.38396502,
     'AP50': 0.5880808,
     'AP75': 0.41537145,
     'APl': 0.52378404,
     'APm': 0.36740854,
     'APs': 0.14777671,
     'ARl': 0.70061755,
     'ARm': 0.5697968,
     'ARmax1': 0.32074782,
     'ARmax10': 0.5202915,
     'ARmax100': 0.5667004,
     'ARs': 0.32297602,
     'avg_iou_3': 0.47389424,
     'avg_iou_4': 0.6889207,
     'avg_iou_5': 0.80881506,
     'avg_obj_3': 0.20975539,
     'avg_obj_4': 0.41534156,
     'avg_obj_5': 0.5838226,
     'box_loss_3': 0.008268622,
     'box_loss_4': 0.008307569,
     'box_loss_5': 0.007731109,
     'class_loss_3': 0.002841865,
     'class_loss_4': 0.0031822748,
     'class_loss_5': 0.0031556392,
     'conf_loss_3': 0.006938558,
     'conf_loss_4': 0.008202968,
     'conf_loss_5': 0.0087166475,
     'recall50_3': 0.19936721,
     'recall50_4': 0.45575836,
     'recall50_5': 0.65386486,
     'total_loss': 0.057345256,
     'validation_loss': 0.057345256}
I0402 01:47:18.927742 139684420589376 controller.py:211] train | step:  40000 | training until step 60000...
I0402 03:55:26.450818 139684420589376 controller.py:425] train | step:  60000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.66511077,
     'avg_iou_4': 0.7710316,
     'avg_iou_5': 0.82094276,
     'avg_obj_3': 0.25631708,
     'avg_obj_4': 0.4150812,
     'avg_obj_5': 0.5360547,
     'box_loss_3': 0.10945763,
     'box_loss_4': 0.08389018,
     'box_loss_5': 0.0703728,
     'class_loss_3': 0.037029877,
     'class_loss_4': 0.031584054,
     'class_loss_5': 0.030710107,
     'conf_loss_3': 0.16986524,
     'conf_loss_4': 0.15475845,
     'conf_loss_5': 0.11493725,
     'learning_rate': 0.0009243479,
     'recall50_3': 0.17002568,
     'recall50_4': 0.39190823,
     'recall50_5': 0.5769058,
     'total_loss': 0.80260557,
     'training_loss': 0.80260557}
I0402 03:56:28.903401 139684420589376 controller.py:455] saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-60000.
I0402 03:56:28.911904 139684420589376 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0402 04:00:58.099512 139684420589376 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0402 04:05:15.256336 139684420589376 controller.py:261]  eval | step:  60000 | eval time:  526.3 sec | output: 
    {'AP': 0.39671814,
     'AP50': 0.60160017,
     'AP75': 0.42921284,
     'APl': 0.5406077,
     'APm': 0.3769681,
     'APs': 0.15858383,
     'ARl': 0.7053885,
     'ARm': 0.57499814,
     'ARmax1': 0.3243534,
     'ARmax10': 0.5276213,
     'ARmax100': 0.57333225,
     'ARs': 0.33363613,
     'avg_iou_3': 0.47670665,
     'avg_iou_4': 0.69139653,
     'avg_iou_5': 0.8116589,
     'avg_obj_3': 0.21752784,
     'avg_obj_4': 0.4290487,
     'avg_obj_5': 0.60135186,
     'box_loss_3': 0.008125266,
     'box_loss_4': 0.008183026,
     'box_loss_5': 0.007587413,
     'class_loss_3': 0.0027459376,
     'class_loss_4': 0.0031122384,
     'class_loss_5': 0.0030550815,
     'conf_loss_3': 0.0068957536,
     'conf_loss_4': 0.008305366,
     'conf_loss_5': 0.008981896,
     'recall50_3': 0.21303189,
     'recall50_4': 0.4699485,
     'recall50_5': 0.6694766,
     'total_loss': 0.05699196,
     'validation_loss': 0.05699196}
I0402 04:05:46.276239 139684420589376 controller.py:211] train | step:  60000 | training until step 80000...
I0402 06:13:44.912985 139684420589376 controller.py:425] train | step:  80000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.6745206,
     'avg_iou_4': 0.78203803,
     'avg_iou_5': 0.83170676,
     'avg_obj_3': 0.278057,
     'avg_obj_4': 0.44508246,
     'avg_obj_5': 0.5661897,
     'box_loss_3': 0.10632527,
     'box_loss_4': 0.07974648,
     'box_loss_5': 0.06604485,
     'class_loss_3': 0.0326384,
     'class_loss_4': 0.027007544,
     'class_loss_5': 0.026451377,
     'conf_loss_3': 0.16396496,
     'conf_loss_4': 0.1469001,
     'conf_loss_5': 0.10822677,
     'learning_rate': 0.00086823467,
     'recall50_3': 0.19361034,
     'recall50_4': 0.42873925,
     'recall50_5': 0.61249197,
     'total_loss': 0.75730664,
     'training_loss': 0.75730664}
I0402 06:14:49.729247 139684420589376 controller.py:455] saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-80000.
I0402 06:14:49.736535 139684420589376 controller.py:252]  eval | step:  80000 | running 625 steps of evaluation...
I0402 06:19:17.974172 139684420589376 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0402 06:23:34.413960 139684420589376 controller.py:261]  eval | step:  80000 | eval time:  524.7 sec | output: 
    {'AP': 0.40226987,
     'AP50': 0.6056362,
     'AP75': 0.4346957,
     'APl': 0.5442909,
     'APm': 0.3821248,
     'APs': 0.1544161,
     'ARl': 0.7051863,
     'ARm': 0.5764218,
     'ARmax1': 0.32721183,
     'ARmax10': 0.53003573,
     'ARmax100': 0.5749532,
     'ARs': 0.33857432,
     'avg_iou_3': 0.47747594,
     'avg_iou_4': 0.69158244,
     'avg_iou_5': 0.8121569,
     'avg_obj_3': 0.22428764,
     'avg_obj_4': 0.4386183,
     'avg_obj_5': 0.61246824,
     'box_loss_3': 0.008087598,
     'box_loss_4': 0.008174633,
     'box_loss_5': 0.0075636045,
     'class_loss_3': 0.0026955802,
     'class_loss_4': 0.0031155401,
     'class_loss_5': 0.0030510155,
     'conf_loss_3': 0.006969371,
     'conf_loss_4': 0.008459553,
     'conf_loss_5': 0.009215414,
     'recall50_3': 0.2252922,
     'recall50_4': 0.48147696,
     'recall50_5': 0.68013966,
     'total_loss': 0.05733231,
     'validation_loss': 0.05733231}

train | step:  20000 | training until step 40000...
train | step:  40000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.6493356,
     'avg_iou_4': 0.7522618,
     'avg_iou_5': 0.802709,
     'avg_obj_3': 0.22582261,
     'avg_obj_4': 0.37163958,
     'avg_obj_5': 0.4904398,
     'box_loss_3': 0.115085766,
     'box_loss_4': 0.091114834,
     'box_loss_5': 0.077843875,
     'class_loss_3': 0.04515498,
     'class_loss_4': 0.040179916,
     'class_loss_5': 0.03887412,
     'conf_loss_3': 0.17898779,
     'conf_loss_4': 0.16633444,
     'conf_loss_5': 0.12489963,
     'learning_rate': 0.000965883,
     'recall50_3': 0.13860647,
     'recall50_4': 0.3374444,
     'recall50_5': 0.5200113,
     'total_loss': 0.87847775,
     'training_loss': 0.87847775}
saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-40000.
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.76s).
Accumulating evaluation results...
DONE (t=15.58s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.384
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.588
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.415
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.148
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.367
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.524
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.321
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.520
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.567
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.323
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.570
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.701
 eval | step:  40000 | eval time:  516.6 sec | output: 
    {'AP': 0.38396502,
     'AP50': 0.5880808,
     'AP75': 0.41537145,
     'APl': 0.52378404,
     'APm': 0.36740854,
     'APs': 0.14777671,
     'ARl': 0.70061755,
     'ARm': 0.5697968,
     'ARmax1': 0.32074782,
     'ARmax10': 0.5202915,
     'ARmax100': 0.5667004,
     'ARs': 0.32297602,
     'avg_iou_3': 0.47389424,
     'avg_iou_4': 0.6889207,
     'avg_iou_5': 0.80881506,
     'avg_obj_3': 0.20975539,
     'avg_obj_4': 0.41534156,
     'avg_obj_5': 0.5838226,
     'box_loss_3': 0.008268622,
     'box_loss_4': 0.008307569,
     'box_loss_5': 0.007731109,
     'class_loss_3': 0.002841865,
     'class_loss_4': 0.0031822748,
     'class_loss_5': 0.0031556392,
     'conf_loss_3': 0.006938558,
     'conf_loss_4': 0.008202968,
     'conf_loss_5': 0.0087166475,
     'recall50_3': 0.19936721,
     'recall50_4': 0.45575836,
     'recall50_5': 0.65386486,
     'total_loss': 0.057345256,
     'validation_loss': 0.057345256}
train | step:  40000 | training until step 60000...
train | step:  60000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.66511077,
     'avg_iou_4': 0.7710316,
     'avg_iou_5': 0.82094276,
     'avg_obj_3': 0.25631708,
     'avg_obj_4': 0.4150812,
     'avg_obj_5': 0.5360547,
     'box_loss_3': 0.10945763,
     'box_loss_4': 0.08389018,
     'box_loss_5': 0.0703728,
     'class_loss_3': 0.037029877,
     'class_loss_4': 0.031584054,
     'class_loss_5': 0.030710107,
     'conf_loss_3': 0.16986524,
     'conf_loss_4': 0.15475845,
     'conf_loss_5': 0.11493725,
     'learning_rate': 0.0009243479,
     'recall50_3': 0.17002568,
     'recall50_4': 0.39190823,
     'recall50_5': 0.5769058,
     'total_loss': 0.80260557,
     'training_loss': 0.80260557}
saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-60000.
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=178.57s).
Accumulating evaluation results...
DONE (t=15.42s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.397
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.602
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.429
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.159
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.377
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.541
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.324
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.528
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.573
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.334
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.575
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.705
 eval | step:  60000 | eval time:  526.3 sec | output: 
    {'AP': 0.39671814,
     'AP50': 0.60160017,
     'AP75': 0.42921284,
     'APl': 0.5406077,
     'APm': 0.3769681,
     'APs': 0.15858383,
     'ARl': 0.7053885,
     'ARm': 0.57499814,
     'ARmax1': 0.3243534,
     'ARmax10': 0.5276213,
     'ARmax100': 0.57333225,
     'ARs': 0.33363613,
     'avg_iou_3': 0.47670665,
     'avg_iou_4': 0.69139653,
     'avg_iou_5': 0.8116589,
     'avg_obj_3': 0.21752784,
     'avg_obj_4': 0.4290487,
     'avg_obj_5': 0.60135186,
     'box_loss_3': 0.008125266,
     'box_loss_4': 0.008183026,
     'box_loss_5': 0.007587413,
     'class_loss_3': 0.0027459376,
     'class_loss_4': 0.0031122384,
     'class_loss_5': 0.0030550815,
     'conf_loss_3': 0.0068957536,
     'conf_loss_4': 0.008305366,
     'conf_loss_5': 0.008981896,
     'recall50_3': 0.21303189,
     'recall50_4': 0.4699485,
     'recall50_5': 0.6694766,
     'total_loss': 0.05699196,
     'validation_loss': 0.05699196}
train | step:  60000 | training until step 80000...
train | step:  80000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.6745206,
     'avg_iou_4': 0.78203803,
     'avg_iou_5': 0.83170676,
     'avg_obj_3': 0.278057,
     'avg_obj_4': 0.44508246,
     'avg_obj_5': 0.5661897,
     'box_loss_3': 0.10632527,
     'box_loss_4': 0.07974648,
     'box_loss_5': 0.06604485,
     'class_loss_3': 0.0326384,
     'class_loss_4': 0.027007544,
     'class_loss_5': 0.026451377,
     'conf_loss_3': 0.16396496,
     'conf_loss_4': 0.1469001,
     'conf_loss_5': 0.10822677,
     'learning_rate': 0.00086823467,
     'recall50_3': 0.19361034,
     'recall50_4': 0.42873925,
     'recall50_5': 0.61249197,
     'total_loss': 0.75730664,
     'training_loss': 0.75730664}
saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-80000.
 eval | step:  80000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=184.97s).
Accumulating evaluation results...
DONE (t=14.89s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.402
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.606
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.435
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.154
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.382
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.544
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.327
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.530
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.575
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.339
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.576
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.705
 eval | step:  80000 | eval time:  524.7 sec | output: 
    {'AP': 0.40226987,
     'AP50': 0.6056362,
     'AP75': 0.4346957,
     'APl': 0.5442909,
     'APm': 0.3821248,
     'APs': 0.1544161,
     'ARl': 0.7051863,
     'ARm': 0.5764218,
     'ARmax1': 0.32721183,
     'ARmax10': 0.53003573,
     'ARmax100': 0.5749532,
     'ARs': 0.33857432,
     'avg_iou_3': 0.47747594,
     'avg_iou_4': 0.69158244,
     'avg_iou_5': 0.8121569,
     'avg_obj_3': 0.22428764,
     'avg_obj_4': 0.4386183,
     'avg_obj_5': 0.61246824,
     'box_loss_3': 0.008087598,
     'box_loss_4': 0.008174633,
     'box_loss_5': 0.0075636045,
     'class_loss_3': 0.0026955802,
     'class_loss_4': 0.0031155401,
     'class_loss_5': 0.0030510155,
     'conf_loss_3': 0.006969371,
     'conf_loss_4': 0.008459553,
     'conf_loss_5': 0.009215414,
     'recall50_3': 0.2252922,
     'recall50_4': 0.48147696,
     'recall50_5': 0.68013966,
     'total_loss': 0.05733231,
     'validation_loss': 0.05733231}I0402 06:24:05.178519 139684420589376 controller.py:211] train | step:  80000 | training until step 100000...
I0402 08:31:54.234945 139684420589376 controller.py:425] train | step:  100000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.6815555,
     'avg_iou_4': 0.790396,
     'avg_iou_5': 0.83992726,
     'avg_obj_3': 0.29594213,
     'avg_obj_4': 0.46980518,
     'avg_obj_5': 0.5909806,
     'box_loss_3': 0.10387178,
     'box_loss_4': 0.07665726,
     'box_loss_5': 0.06276996,
     'class_loss_3': 0.02959632,
     'class_loss_4': 0.024044722,
     'class_loss_5': 0.023554401,
     'conf_loss_3': 0.15888353,
     'conf_loss_4': 0.14038815,
     'conf_loss_5': 0.10261544,
     'learning_rate': 0.00079949404,
     'recall50_3': 0.21349703,
     'recall50_4': 0.45963624,
     'recall50_5': 0.6412966,
     'total_loss': 0.72237957,
     'training_loss': 0.72237957}
I0402 08:32:54.590840 139684420589376 controller.py:455] saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-100000.
I0402 08:32:54.601485 139684420589376 controller.py:252]  eval | step:  100000 | running 625 steps of evaluation...
I0402 08:37:29.075017 139684420589376 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0402 08:41:40.703039 139684420589376 controller.py:261]  eval | step:  100000 | eval time:  526.1 sec | output: 
    {'AP': 0.40051526,
     'AP50': 0.6028014,
     'AP75': 0.43188065,
     'APl': 0.5406495,
     'APm': 0.38263524,
     'APs': 0.16087823,
     'ARl': 0.697718,
     'ARm': 0.56964195,
     'ARmax1': 0.3266914,
     'ARmax10': 0.5266533,
     'ARmax100': 0.57099676,
     'ARs': 0.34339026,
     'avg_iou_3': 0.47843117,
     'avg_iou_4': 0.6912985,
     'avg_iou_5': 0.811551,
     'avg_obj_3': 0.22822177,
     'avg_obj_4': 0.44263682,
     'avg_obj_5': 0.6172498,
     'box_loss_3': 0.00803687,
     'box_loss_4': 0.00819133,
     'box_loss_5': 0.0075973435,
     'class_loss_3': 0.0027588925,
     'class_loss_4': 0.0032350174,
     'class_loss_5': 0.0031569523,
     'conf_loss_3': 0.0070099505,
     'conf_loss_4': 0.0085924985,
     'conf_loss_5': 0.009385658,
     'recall50_3': 0.23257361,
     'recall50_4': 0.48950723,
     'recall50_5': 0.6828226,
     'total_loss': 0.05796452,
     'validation_loss': 0.05796452}
I0402 08:41:57.550947 139684420589376 controller.py:211] train | step:  100000 | training until step 120000...
I0402 10:48:32.292154 139684420589376 controller.py:425] train | step:  120000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.6872066,
     'avg_iou_4': 0.79726833,
     'avg_iou_5': 0.84648174,
     'avg_obj_3': 0.3117413,
     'avg_obj_4': 0.49072543,
     'avg_obj_5': 0.6118174,
     'box_loss_3': 0.10195062,
     'box_loss_4': 0.07409958,
     'box_loss_5': 0.06019531,
     'class_loss_3': 0.027332716,
     'class_loss_4': 0.02182587,
     'class_loss_5': 0.021441365,
     'conf_loss_3': 0.15468092,
     'conf_loss_4': 0.13507326,
     'conf_loss_5': 0.09785587,
     'learning_rate': 0.00072051573,
     'recall50_3': 0.2317716,
     'recall50_4': 0.48460042,
     'recall50_5': 0.66440785,
     'total_loss': 0.69445705,
     'training_loss': 0.69445705}
I0402 10:49:28.270050 139684420589376 controller.py:455] saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-120000.
I0402 10:49:28.277264 139684420589376 controller.py:252]  eval | step:  120000 | running 625 steps of evaluation...
I0402 10:53:55.627811 139684420589376 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0402 10:58:02.203495 139684420589376 controller.py:261]  eval | step:  120000 | eval time:  513.9 sec | output: 
    {'AP': 0.39905727,
     'AP50': 0.60008794,
     'AP75': 0.43246102,
     'APl': 0.5405565,
     'APm': 0.38154748,
     'APs': 0.16364895,
     'ARl': 0.6923983,
     'ARm': 0.5654647,
     'ARmax1': 0.3257105,
     'ARmax10': 0.525478,
     'ARmax100': 0.56798196,
     'ARs': 0.33489585,
     'avg_iou_3': 0.4776167,
     'avg_iou_4': 0.6906037,
     'avg_iou_5': 0.81056184,
     'avg_obj_3': 0.22984065,
     'avg_obj_4': 0.44464248,
     'avg_obj_5': 0.621163,
     'box_loss_3': 0.008080248,
     'box_loss_4': 0.00822726,
     'box_loss_5': 0.007647882,
     'class_loss_3': 0.0028380856,
     'class_loss_4': 0.003334232,
     'class_loss_5': 0.0032879119,
     'conf_loss_3': 0.007033452,
     'conf_loss_4': 0.00870285,
     'conf_loss_5': 0.009527937,
     'recall50_3': 0.23684175,
     'recall50_4': 0.49054214,
     'recall50_5': 0.6864535,
     'total_loss': 0.058679834,
     'validation_loss': 0.058679834}
I0402 10:58:21.320883 139684420589376 controller.py:211] train | step:  120000 | training until step 140000...
I0402 13:06:58.456299 139684420589376 controller.py:425] train | step:  140000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.6921707,
     'avg_iou_4': 0.802988,
     'avg_iou_5': 0.85206145,
     'avg_obj_3': 0.32612956,
     'avg_obj_4': 0.50877976,
     'avg_obj_5': 0.6298411,
     'box_loss_3': 0.10021061,
     'box_loss_4': 0.071989216,
     'box_loss_5': 0.057990126,
     'class_loss_3': 0.025435967,
     'class_loss_4': 0.020150071,
     'class_loss_5': 0.019727433,
     'conf_loss_3': 0.15047036,
     'conf_loss_4': 0.13018201,
     'conf_loss_5': 0.09366569,
     'learning_rate': 0.0006340452,
     'recall50_3': 0.24826375,
     'recall50_4': 0.5061571,
     'recall50_5': 0.6841775,
     'total_loss': 0.66981894,
     'training_loss': 0.66981894}
I0402 13:08:07.921312 139684420589376 controller.py:455] saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-140000.
I0402 13:08:07.927778 139684420589376 controller.py:252]  eval | step:  140000 | running 625 steps of evaluation...
I0402 13:12:33.665811 139684420589376 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0402 13:16:33.378277 139684420589376 controller.py:261]  eval | step:  140000 | eval time:  505.4 sec | output: 
    {'AP': 0.39472702,
     'AP50': 0.59491444,
     'AP75': 0.42267752,
     'APl': 0.5330651,
     'APm': 0.37952808,
     'APs': 0.15656085,
     'ARl': 0.6864417,
     'ARm': 0.55778486,
     'ARmax1': 0.32363653,
     'ARmax10': 0.5193445,
     'ARmax100': 0.561086,
     'ARs': 0.33185303,
     'avg_iou_3': 0.47709018,
     'avg_iou_4': 0.6895218,
     'avg_iou_5': 0.809263,
     'avg_obj_3': 0.22955354,
     'avg_obj_4': 0.44569126,
     'avg_obj_5': 0.62258726,
     'box_loss_3': 0.008107317,
     'box_loss_4': 0.008284361,
     'box_loss_5': 0.0077178916,
     'class_loss_3': 0.002875464,
     'class_loss_4': 0.0034293502,
     'class_loss_5': 0.0034183883,
     'conf_loss_3': 0.007054689,
     'conf_loss_4': 0.008797767,
     'conf_loss_5': 0.009649951,
     'recall50_3': 0.238218,
     'recall50_4': 0.4902231,
     'recall50_5': 0.68438244,
     'total_loss': 0.05933521,
     'validation_loss': 0.05933521}

train | step:  80000 | training until step 100000...
train | step:  100000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.6815555,
     'avg_iou_4': 0.790396,
     'avg_iou_5': 0.83992726,
     'avg_obj_3': 0.29594213,
     'avg_obj_4': 0.46980518,
     'avg_obj_5': 0.5909806,
     'box_loss_3': 0.10387178,
     'box_loss_4': 0.07665726,
     'box_loss_5': 0.06276996,
     'class_loss_3': 0.02959632,
     'class_loss_4': 0.024044722,
     'class_loss_5': 0.023554401,
     'conf_loss_3': 0.15888353,
     'conf_loss_4': 0.14038815,
     'conf_loss_5': 0.10261544,
     'learning_rate': 0.00079949404,
     'recall50_3': 0.21349703,
     'recall50_4': 0.45963624,
     'recall50_5': 0.6412966,
     'total_loss': 0.72237957,
     'training_loss': 0.72237957}
saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-100000.
 eval | step:  100000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=180.72s).
Accumulating evaluation results...
DONE (t=14.40s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.401
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.603
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.432
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.161
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.383
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.541
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.327
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.527
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.571
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.343
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.570
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.698
 eval | step:  100000 | eval time:  526.1 sec | output: 
    {'AP': 0.40051526,
     'AP50': 0.6028014,
     'AP75': 0.43188065,
     'APl': 0.5406495,
     'APm': 0.38263524,
     'APs': 0.16087823,
     'ARl': 0.697718,
     'ARm': 0.56964195,
     'ARmax1': 0.3266914,
     'ARmax10': 0.5266533,
     'ARmax100': 0.57099676,
     'ARs': 0.34339026,
     'avg_iou_3': 0.47843117,
     'avg_iou_4': 0.6912985,
     'avg_iou_5': 0.811551,
     'avg_obj_3': 0.22822177,
     'avg_obj_4': 0.44263682,
     'avg_obj_5': 0.6172498,
     'box_loss_3': 0.00803687,
     'box_loss_4': 0.00819133,
     'box_loss_5': 0.0075973435,
     'class_loss_3': 0.0027588925,
     'class_loss_4': 0.0032350174,
     'class_loss_5': 0.0031569523,
     'conf_loss_3': 0.0070099505,
     'conf_loss_4': 0.0085924985,
     'conf_loss_5': 0.009385658,
     'recall50_3': 0.23257361,
     'recall50_4': 0.48950723,
     'recall50_5': 0.6828226,
     'total_loss': 0.05796452,
     'validation_loss': 0.05796452}
train | step:  100000 | training until step 120000...
train | step:  120000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.6872066,
     'avg_iou_4': 0.79726833,
     'avg_iou_5': 0.84648174,
     'avg_obj_3': 0.3117413,
     'avg_obj_4': 0.49072543,
     'avg_obj_5': 0.6118174,
     'box_loss_3': 0.10195062,
     'box_loss_4': 0.07409958,
     'box_loss_5': 0.06019531,
     'class_loss_3': 0.027332716,
     'class_loss_4': 0.02182587,
     'class_loss_5': 0.021441365,
     'conf_loss_3': 0.15468092,
     'conf_loss_4': 0.13507326,
     'conf_loss_5': 0.09785587,
     'learning_rate': 0.00072051573,
     'recall50_3': 0.2317716,
     'recall50_4': 0.48460042,
     'recall50_5': 0.66440785,
     'total_loss': 0.69445705,
     'training_loss': 0.69445705}
saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-120000.
 eval | step:  120000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=175.74s).
Accumulating evaluation results...
DONE (t=13.35s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.399
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.600
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.432
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.164
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.382
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.541
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.326
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.525
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.568
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.335
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.565
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.692
 eval | step:  120000 | eval time:  513.9 sec | output: 
    {'AP': 0.39905727,
     'AP50': 0.60008794,
     'AP75': 0.43246102,
     'APl': 0.5405565,
     'APm': 0.38154748,
     'APs': 0.16364895,
     'ARl': 0.6923983,
     'ARm': 0.5654647,
     'ARmax1': 0.3257105,
     'ARmax10': 0.525478,
     'ARmax100': 0.56798196,
     'ARs': 0.33489585,
     'avg_iou_3': 0.4776167,
     'avg_iou_4': 0.6906037,
     'avg_iou_5': 0.81056184,
     'avg_obj_3': 0.22984065,
     'avg_obj_4': 0.44464248,
     'avg_obj_5': 0.621163,
     'box_loss_3': 0.008080248,
     'box_loss_4': 0.00822726,
     'box_loss_5': 0.007647882,
     'class_loss_3': 0.0028380856,
     'class_loss_4': 0.003334232,
     'class_loss_5': 0.0032879119,
     'conf_loss_3': 0.007033452,
     'conf_loss_4': 0.00870285,
     'conf_loss_5': 0.009527937,
     'recall50_3': 0.23684175,
     'recall50_4': 0.49054214,
     'recall50_5': 0.6864535,
     'total_loss': 0.058679834,
     'validation_loss': 0.058679834}
train | step:  120000 | training until step 140000...
train | step:  140000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.6921707,
     'avg_iou_4': 0.802988,
     'avg_iou_5': 0.85206145,
     'avg_obj_3': 0.32612956,
     'avg_obj_4': 0.50877976,
     'avg_obj_5': 0.6298411,
     'box_loss_3': 0.10021061,
     'box_loss_4': 0.071989216,
     'box_loss_5': 0.057990126,
     'class_loss_3': 0.025435967,
     'class_loss_4': 0.020150071,
     'class_loss_5': 0.019727433,
     'conf_loss_3': 0.15047036,
     'conf_loss_4': 0.13018201,
     'conf_loss_5': 0.09366569,
     'learning_rate': 0.0006340452,
     'recall50_3': 0.24826375,
     'recall50_4': 0.5061571,
     'recall50_5': 0.6841775,
     'total_loss': 0.66981894,
     'training_loss': 0.66981894}
saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-140000.
 eval | step:  140000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=172.66s).
Accumulating evaluation results...
DONE (t=13.07s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.395
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.595
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.423
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.157
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.380
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.533
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.324
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.519
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.561
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.332
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.558
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.686
 eval | step:  140000 | eval time:  505.4 sec | output: 
    {'AP': 0.39472702,
     'AP50': 0.59491444,
     'AP75': 0.42267752,
     'APl': 0.5330651,
     'APm': 0.37952808,
     'APs': 0.15656085,
     'ARl': 0.6864417,
     'ARm': 0.55778486,
     'ARmax1': 0.32363653,
     'ARmax10': 0.5193445,
     'ARmax100': 0.561086,
     'ARs': 0.33185303,
     'avg_iou_3': 0.47709018,
     'avg_iou_4': 0.6895218,
     'avg_iou_5': 0.809263,
     'avg_obj_3': 0.22955354,
     'avg_obj_4': 0.44569126,
     'avg_obj_5': 0.62258726,
     'box_loss_3': 0.008107317,
     'box_loss_4': 0.008284361,
     'box_loss_5': 0.0077178916,
     'class_loss_3': 0.002875464,
     'class_loss_4': 0.0034293502,
     'class_loss_5': 0.0034183883,
     'conf_loss_3': 0.007054689,
     'conf_loss_4': 0.008797767,
     'conf_loss_5': 0.009649951,
     'recall50_3': 0.238218,
     'recall50_4': 0.4902231,
     'recall50_5': 0.68438244,
     'total_loss': 0.05933521,
     'validation_loss': 0.05933521}I0402 13:16:49.040563 139684420589376 controller.py:211] train | step:  140000 | training until step 160000...
I0402 15:24:31.871257 139684420589376 controller.py:425] train | step:  160000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.69668317,
     'avg_iou_4': 0.8080539,
     'avg_iou_5': 0.8569868,
     'avg_obj_3': 0.33943433,
     'avg_obj_4': 0.5249172,
     'avg_obj_5': 0.6458802,
     'box_loss_3': 0.09864153,
     'box_loss_4': 0.07009379,
     'box_loss_5': 0.056068428,
     'class_loss_3': 0.023926662,
     'class_loss_4': 0.018729938,
     'class_loss_5': 0.018303277,
     'conf_loss_3': 0.14702225,
     'conf_loss_4': 0.12608151,
     'conf_loss_5': 0.08989102,
     'learning_rate': 0.00054308854,
     'recall50_3': 0.26343057,
     'recall50_4': 0.5245908,
     'recall50_5': 0.70146966,
     'total_loss': 0.6487586,
     'training_loss': 0.6487586}
I0402 15:25:31.190444 139684420589376 controller.py:455] saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-160000.
I0402 15:25:31.196642 139684420589376 controller.py:252]  eval | step:  160000 | running 625 steps of evaluation...
I0402 15:29:54.756089 139684420589376 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0402 15:33:56.761076 139684420589376 controller.py:261]  eval | step:  160000 | eval time:  505.6 sec | output: 
    {'AP': 0.39211136,
     'AP50': 0.5902459,
     'AP75': 0.4222962,
     'APl': 0.5318423,
     'APm': 0.3753728,
     'APs': 0.15523992,
     'ARl': 0.6817708,
     'ARm': 0.54996526,
     'ARmax1': 0.32281968,
     'ARmax10': 0.51363885,
     'ARmax100': 0.5547179,
     'ARs': 0.3237247,
     'avg_iou_3': 0.47633678,
     'avg_iou_4': 0.6878386,
     'avg_iou_5': 0.808294,
     'avg_obj_3': 0.23014121,
     'avg_obj_4': 0.44710347,
     'avg_obj_5': 0.6238988,
     'box_loss_3': 0.008146553,
     'box_loss_4': 0.008372119,
     'box_loss_5': 0.0077660307,
     'class_loss_3': 0.0029183142,
     'class_loss_4': 0.0034902794,
     'class_loss_5': 0.0035271153,
     'conf_loss_3': 0.0071272575,
     'conf_loss_4': 0.008915834,
     'conf_loss_5': 0.009840461,
     'recall50_3': 0.24184453,
     'recall50_4': 0.49238262,
     'recall50_5': 0.68634534,
     'total_loss': 0.060103968,
     'validation_loss': 0.060103968}
I0402 15:34:12.077990 139684420589376 controller.py:211] train | step:  160000 | training until step 180000...
I0402 17:39:24.636207 139684420589376 controller.py:425] train | step:  180000 | steps/sec:    2.5 | output: 
    {'avg_iou_3': 0.7008159,
     'avg_iou_4': 0.8126624,
     'avg_iou_5': 0.861325,
     'avg_obj_3': 0.35187748,
     'avg_obj_4': 0.53949565,
     'avg_obj_5': 0.6600808,
     'box_loss_3': 0.09734676,
     'box_loss_4': 0.06844338,
     'box_loss_5': 0.054357354,
     'class_loss_3': 0.022609817,
     'class_loss_4': 0.017609378,
     'class_loss_5': 0.017127376,
     'conf_loss_3': 0.14392364,
     'conf_loss_4': 0.12242262,
     'conf_loss_5': 0.086609334,
     'learning_rate': 0.0004508079,
     'recall50_3': 0.27804285,
     'recall50_4': 0.54150766,
     'recall50_5': 0.71664447,
     'total_loss': 0.630452,
     'training_loss': 0.630452}
I0402 17:40:20.092501 139684420589376 controller.py:455] saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-180000.
I0402 17:40:20.099494 139684420589376 controller.py:252]  eval | step:  180000 | running 625 steps of evaluation...
I0402 17:44:44.128704 139684420589376 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0402 17:48:41.887582 139684420589376 controller.py:261]  eval | step:  180000 | eval time:  501.8 sec | output: 
    {'AP': 0.38906896,
     'AP50': 0.5873384,
     'AP75': 0.41721705,
     'APl': 0.5273572,
     'APm': 0.37193096,
     'APs': 0.15464173,
     'ARl': 0.671377,
     'ARm': 0.5493241,
     'ARmax1': 0.3200042,
     'ARmax10': 0.5101502,
     'ARmax100': 0.55158633,
     'ARs': 0.326233,
     'avg_iou_3': 0.47530973,
     'avg_iou_4': 0.6861868,
     'avg_iou_5': 0.80690247,
     'avg_obj_3': 0.23004304,
     'avg_obj_4': 0.44656387,
     'avg_obj_5': 0.6244816,
     'box_loss_3': 0.008199303,
     'box_loss_4': 0.0084571,
     'box_loss_5': 0.007838868,
     'class_loss_3': 0.0029703511,
     'class_loss_4': 0.0035516166,
     'class_loss_5': 0.0036008595,
     'conf_loss_3': 0.0071477396,
     'conf_loss_4': 0.009001648,
     'conf_loss_5': 0.009940661,
     'recall50_3': 0.24340224,
     'recall50_4': 0.4915922,
     'recall50_5': 0.6832984,
     'total_loss': 0.06070813,
     'validation_loss': 0.06070813}
I0402 17:48:59.215226 139684420589376 controller.py:211] train | step:  180000 | training until step 200000...
I0402 19:54:21.001821 139684420589376 controller.py:425] train | step:  200000 | steps/sec:    2.5 | output: 
    {'avg_iou_3': 0.70445114,
     'avg_iou_4': 0.8168488,
     'avg_iou_5': 0.8652321,
     'avg_obj_3': 0.36338523,
     'avg_obj_4': 0.5527182,
     'avg_obj_5': 0.67287385,
     'box_loss_3': 0.09599047,
     'box_loss_4': 0.06687567,
     'box_loss_5': 0.052820556,
     'class_loss_3': 0.021523656,
     'class_loss_4': 0.016607013,
     'class_loss_5': 0.016113235,
     'conf_loss_3': 0.14087865,
     'conf_loss_4': 0.11901765,
     'conf_loss_5': 0.08361413,
     'learning_rate': 0.00036041107,
     'recall50_3': 0.2917245,
     'recall50_4': 0.557059,
     'recall50_5': 0.72964764,
     'total_loss': 0.61343986,
     'training_loss': 0.61343986}
I0402 19:55:14.925632 139684420589376 controller.py:455] saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-200000.
I0402 19:55:14.933441 139684420589376 controller.py:252]  eval | step:  200000 | running 625 steps of evaluation...
I0402 19:59:57.264412 139684420589376 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0402 20:04:01.585158 139684420589376 controller.py:261]  eval | step:  200000 | eval time:  526.7 sec | output: 
    {'AP': 0.38572532,
     'AP50': 0.58202344,
     'AP75': 0.41223153,
     'APl': 0.5241623,
     'APm': 0.36792675,
     'APs': 0.15199465,
     'ARl': 0.67050576,
     'ARm': 0.5393357,
     'ARmax1': 0.31778705,
     'ARmax10': 0.50723207,
     'ARmax100': 0.54716456,
     'ARs': 0.31871194,
     'avg_iou_3': 0.47421715,
     'avg_iou_4': 0.6847383,
     'avg_iou_5': 0.8056137,
     'avg_obj_3': 0.23023115,
     'avg_obj_4': 0.446708,
     'avg_obj_5': 0.62566507,
     'box_loss_3': 0.008254568,
     'box_loss_4': 0.008530666,
     'box_loss_5': 0.007902329,
     'class_loss_3': 0.0030536363,
     'class_loss_4': 0.0036199614,
     'class_loss_5': 0.0036915925,
     'conf_loss_3': 0.007201067,
     'conf_loss_4': 0.009082051,
     'conf_loss_5': 0.01002452,
     'recall50_3': 0.24409677,
     'recall50_4': 0.49167538,
     'recall50_5': 0.6838617,
     'total_loss': 0.06136039,
     'validation_loss': 0.06136039}

train | step:  140000 | training until step 160000...
train | step:  160000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.69668317,
     'avg_iou_4': 0.8080539,
     'avg_iou_5': 0.8569868,
     'avg_obj_3': 0.33943433,
     'avg_obj_4': 0.5249172,
     'avg_obj_5': 0.6458802,
     'box_loss_3': 0.09864153,
     'box_loss_4': 0.07009379,
     'box_loss_5': 0.056068428,
     'class_loss_3': 0.023926662,
     'class_loss_4': 0.018729938,
     'class_loss_5': 0.018303277,
     'conf_loss_3': 0.14702225,
     'conf_loss_4': 0.12608151,
     'conf_loss_5': 0.08989102,
     'learning_rate': 0.00054308854,
     'recall50_3': 0.26343057,
     'recall50_4': 0.5245908,
     'recall50_5': 0.70146966,
     'total_loss': 0.6487586,
     'training_loss': 0.6487586}
saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-160000.
 eval | step:  160000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=173.84s).
Accumulating evaluation results...
DONE (t=13.24s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.392
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.590
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.422
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.155
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.375
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.532
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.323
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.514
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.555
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.324
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.550
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.682
 eval | step:  160000 | eval time:  505.6 sec | output: 
    {'AP': 0.39211136,
     'AP50': 0.5902459,
     'AP75': 0.4222962,
     'APl': 0.5318423,
     'APm': 0.3753728,
     'APs': 0.15523992,
     'ARl': 0.6817708,
     'ARm': 0.54996526,
     'ARmax1': 0.32281968,
     'ARmax10': 0.51363885,
     'ARmax100': 0.5547179,
     'ARs': 0.3237247,
     'avg_iou_3': 0.47633678,
     'avg_iou_4': 0.6878386,
     'avg_iou_5': 0.808294,
     'avg_obj_3': 0.23014121,
     'avg_obj_4': 0.44710347,
     'avg_obj_5': 0.6238988,
     'box_loss_3': 0.008146553,
     'box_loss_4': 0.008372119,
     'box_loss_5': 0.0077660307,
     'class_loss_3': 0.0029183142,
     'class_loss_4': 0.0034902794,
     'class_loss_5': 0.0035271153,
     'conf_loss_3': 0.0071272575,
     'conf_loss_4': 0.008915834,
     'conf_loss_5': 0.009840461,
     'recall50_3': 0.24184453,
     'recall50_4': 0.49238262,
     'recall50_5': 0.68634534,
     'total_loss': 0.060103968,
     'validation_loss': 0.060103968}
train | step:  160000 | training until step 180000...
train | step:  180000 | steps/sec:    2.5 | output: 
    {'avg_iou_3': 0.7008159,
     'avg_iou_4': 0.8126624,
     'avg_iou_5': 0.861325,
     'avg_obj_3': 0.35187748,
     'avg_obj_4': 0.53949565,
     'avg_obj_5': 0.6600808,
     'box_loss_3': 0.09734676,
     'box_loss_4': 0.06844338,
     'box_loss_5': 0.054357354,
     'class_loss_3': 0.022609817,
     'class_loss_4': 0.017609378,
     'class_loss_5': 0.017127376,
     'conf_loss_3': 0.14392364,
     'conf_loss_4': 0.12242262,
     'conf_loss_5': 0.086609334,
     'learning_rate': 0.0004508079,
     'recall50_3': 0.27804285,
     'recall50_4': 0.54150766,
     'recall50_5': 0.71664447,
     'total_loss': 0.630452,
     'training_loss': 0.630452}
saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-180000.
 eval | step:  180000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=175.11s).
Accumulating evaluation results...
DONE (t=12.12s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.389
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.587
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.417
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.155
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.372
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.527
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.320
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.510
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.552
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.326
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.549
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.671
 eval | step:  180000 | eval time:  501.8 sec | output: 
    {'AP': 0.38906896,
     'AP50': 0.5873384,
     'AP75': 0.41721705,
     'APl': 0.5273572,
     'APm': 0.37193096,
     'APs': 0.15464173,
     'ARl': 0.671377,
     'ARm': 0.5493241,
     'ARmax1': 0.3200042,
     'ARmax10': 0.5101502,
     'ARmax100': 0.55158633,
     'ARs': 0.326233,
     'avg_iou_3': 0.47530973,
     'avg_iou_4': 0.6861868,
     'avg_iou_5': 0.80690247,
     'avg_obj_3': 0.23004304,
     'avg_obj_4': 0.44656387,
     'avg_obj_5': 0.6244816,
     'box_loss_3': 0.008199303,
     'box_loss_4': 0.0084571,
     'box_loss_5': 0.007838868,
     'class_loss_3': 0.0029703511,
     'class_loss_4': 0.0035516166,
     'class_loss_5': 0.0036008595,
     'conf_loss_3': 0.0071477396,
     'conf_loss_4': 0.009001648,
     'conf_loss_5': 0.009940661,
     'recall50_3': 0.24340224,
     'recall50_4': 0.4915922,
     'recall50_5': 0.6832984,
     'total_loss': 0.06070813,
     'validation_loss': 0.06070813}
train | step:  180000 | training until step 200000...
train | step:  200000 | steps/sec:    2.5 | output: 
    {'avg_iou_3': 0.70445114,
     'avg_iou_4': 0.8168488,
     'avg_iou_5': 0.8652321,
     'avg_obj_3': 0.36338523,
     'avg_obj_4': 0.5527182,
     'avg_obj_5': 0.67287385,
     'box_loss_3': 0.09599047,
     'box_loss_4': 0.06687567,
     'box_loss_5': 0.052820556,
     'class_loss_3': 0.021523656,
     'class_loss_4': 0.016607013,
     'class_loss_5': 0.016113235,
     'conf_loss_3': 0.14087865,
     'conf_loss_4': 0.11901765,
     'conf_loss_5': 0.08361413,
     'learning_rate': 0.00036041107,
     'recall50_3': 0.2917245,
     'recall50_4': 0.557059,
     'recall50_5': 0.72964764,
     'total_loss': 0.61343986,
     'training_loss': 0.61343986}
saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-200000.
 eval | step:  200000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=172.78s).
Accumulating evaluation results...
DONE (t=11.74s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.386
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.582
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.412
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.152
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.368
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.524
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.318
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.507
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.547
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.319
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.539
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.671
 eval | step:  200000 | eval time:  526.7 sec | output: 
    {'AP': 0.38572532,
     'AP50': 0.58202344,
     'AP75': 0.41223153,
     'APl': 0.5241623,
     'APm': 0.36792675,
     'APs': 0.15199465,
     'ARl': 0.67050576,
     'ARm': 0.5393357,
     'ARmax1': 0.31778705,
     'ARmax10': 0.50723207,
     'ARmax100': 0.54716456,
     'ARs': 0.31871194,
     'avg_iou_3': 0.47421715,
     'avg_iou_4': 0.6847383,
     'avg_iou_5': 0.8056137,
     'avg_obj_3': 0.23023115,
     'avg_obj_4': 0.446708,
     'avg_obj_5': 0.62566507,
     'box_loss_3': 0.008254568,
     'box_loss_4': 0.008530666,
     'box_loss_5': 0.007902329,
     'class_loss_3': 0.0030536363,
     'class_loss_4': 0.0036199614,
     'class_loss_5': 0.0036915925,
     'conf_loss_3': 0.007201067,
     'conf_loss_4': 0.009082051,
     'conf_loss_5': 0.01002452,
     'recall50_3': 0.24409677,
     'recall50_4': 0.49167538,
     'recall50_5': 0.6838617,
     'total_loss': 0.06136039,
     'validation_loss': 0.06136039}I0402 20:04:22.443964 139684420589376 controller.py:211] train | step:  200000 | training until step 220000...
I0402 22:10:33.148652 139684420589376 controller.py:425] train | step:  220000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.7076343,
     'avg_iou_4': 0.82035047,
     'avg_iou_5': 0.86868113,
     'avg_obj_3': 0.37346137,
     'avg_obj_4': 0.5641126,
     'avg_obj_5': 0.6837669,
     'box_loss_3': 0.09484008,
     'box_loss_4': 0.06558037,
     'box_loss_5': 0.051438842,
     'class_loss_3': 0.02055896,
     'class_loss_4': 0.015771693,
     'class_loss_5': 0.015247178,
     'conf_loss_3': 0.13817114,
     'conf_loss_4': 0.11597123,
     'conf_loss_5': 0.080991134,
     'learning_rate': 0.0002750408,
     'recall50_3': 0.30337584,
     'recall50_4': 0.5694403,
     'recall50_5': 0.74065816,
     'total_loss': 0.5985708,
     'training_loss': 0.5985708}
I0402 22:11:28.797490 139684420589376 controller.py:455] saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-220000.
I0402 22:11:28.803273 139684420589376 controller.py:252]  eval | step:  220000 | running 625 steps of evaluation...
I0402 22:16:03.171083 139684420589376 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0402 22:20:06.340000 139684420589376 controller.py:261]  eval | step:  220000 | eval time:  517.5 sec | output: 
    {'AP': 0.38300422,
     'AP50': 0.57919425,
     'AP75': 0.40867552,
     'APl': 0.5191172,
     'APm': 0.36599985,
     'APs': 0.15317406,
     'ARl': 0.66426045,
     'ARm': 0.5303651,
     'ARmax1': 0.31621164,
     'ARmax10': 0.5006714,
     'ARmax100': 0.5394581,
     'ARs': 0.3096788,
     'avg_iou_3': 0.47360116,
     'avg_iou_4': 0.6834,
     'avg_iou_5': 0.8052599,
     'avg_obj_3': 0.23003046,
     'avg_obj_4': 0.44787848,
     'avg_obj_5': 0.62712556,
     'box_loss_3': 0.008287934,
     'box_loss_4': 0.008599968,
     'box_loss_5': 0.007924243,
     'class_loss_3': 0.0031537602,
     'class_loss_4': 0.0037191361,
     'class_loss_5': 0.0038061382,
     'conf_loss_3': 0.0072414475,
     'conf_loss_4': 0.009204986,
     'conf_loss_5': 0.010167117,
     'recall50_3': 0.24382947,
     'recall50_4': 0.49370688,
     'recall50_5': 0.6840433,
     'total_loss': 0.06210468,
     'validation_loss': 0.06210468}
I0402 22:20:24.658865 139684420589376 controller.py:211] train | step:  220000 | training until step 240000...
I0403 00:23:13.123465 139684420589376 controller.py:425] train | step:  240000 | steps/sec:    2.5 | output: 
    {'avg_iou_3': 0.7106104,
     'avg_iou_4': 0.8235249,
     'avg_iou_5': 0.8716992,
     'avg_obj_3': 0.38302416,
     'avg_obj_4': 0.5742275,
     'avg_obj_5': 0.69357276,
     'box_loss_3': 0.09388653,
     'box_loss_4': 0.06439345,
     'box_loss_5': 0.050213374,
     'class_loss_3': 0.01972814,
     'class_loss_4': 0.015067672,
     'class_loss_5': 0.014470789,
     'conf_loss_3': 0.13595268,
     'conf_loss_4': 0.11357162,
     'conf_loss_5': 0.07880979,
     'learning_rate': 0.00019766467,
     'recall50_3': 0.31431624,
     'recall50_4': 0.58073455,
     'recall50_5': 0.7503833,
     'total_loss': 0.5860928,
     'training_loss': 0.5860928}
I0403 00:24:10.448922 139684420589376 controller.py:455] saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-240000.
I0403 00:24:10.455273 139684420589376 controller.py:252]  eval | step:  240000 | running 625 steps of evaluation...
I0403 00:28:46.529325 139684420589376 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0403 00:32:45.535433 139684420589376 controller.py:261]  eval | step:  240000 | eval time:  515.1 sec | output: 
    {'AP': 0.38151547,
     'AP50': 0.5759599,
     'AP75': 0.40897468,
     'APl': 0.5235318,
     'APm': 0.36215582,
     'APs': 0.1506219,
     'ARl': 0.663172,
     'ARm': 0.5239291,
     'ARmax1': 0.3155052,
     'ARmax10': 0.49786127,
     'ARmax100': 0.53517216,
     'ARs': 0.30763286,
     'avg_iou_3': 0.47240177,
     'avg_iou_4': 0.68160343,
     'avg_iou_5': 0.8041021,
     'avg_obj_3': 0.22940584,
     'avg_obj_4': 0.44755903,
     'avg_obj_5': 0.6284576,
     'box_loss_3': 0.008348935,
     'box_loss_4': 0.008692942,
     'box_loss_5': 0.007984948,
     'class_loss_3': 0.0032106491,
     'class_loss_4': 0.003828276,
     'class_loss_5': 0.0039163087,
     'conf_loss_3': 0.0072958367,
     'conf_loss_4': 0.009306948,
     'conf_loss_5': 0.010299719,
     'recall50_3': 0.24257608,
     'recall50_4': 0.49069038,
     'recall50_5': 0.68329895,
     'total_loss': 0.06288457,
     'validation_loss': 0.06288457}
I0403 00:33:02.153539 139684420589376 controller.py:211] train | step:  240000 | training until step 260000...
I0403 02:34:26.750779 139684420589376 controller.py:425] train | step:  260000 | steps/sec:    2.5 | output: 
    {'avg_iou_3': 0.7129692,
     'avg_iou_4': 0.8261927,
     'avg_iou_5': 0.8741565,
     'avg_obj_3': 0.3907455,
     'avg_obj_4': 0.58246475,
     'avg_obj_5': 0.70139366,
     'box_loss_3': 0.09314293,
     'box_loss_4': 0.063450284,
     'box_loss_5': 0.049248364,
     'class_loss_3': 0.01914921,
     'class_loss_4': 0.014587013,
     'class_loss_5': 0.013924432,
     'conf_loss_3': 0.134015,
     'conf_loss_4': 0.111448206,
     'conf_loss_5': 0.076982565,
     'learning_rate': 0.00013097274,
     'recall50_3': 0.3233465,
     'recall50_4': 0.58972365,
     'recall50_5': 0.75825715,
     'total_loss': 0.57594657,
     'training_loss': 0.57594657}
I0403 02:35:24.729117 139684420589376 controller.py:455] saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-260000.
I0403 02:35:24.735087 139684420589376 controller.py:252]  eval | step:  260000 | running 625 steps of evaluation...
I0403 02:39:47.177032 139684420589376 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0403 02:43:43.702780 139684420589376 controller.py:261]  eval | step:  260000 | eval time:  499.0 sec | output: 
    {'AP': 0.37933102,
     'AP50': 0.5717935,
     'AP75': 0.40671644,
     'APl': 0.5221721,
     'APm': 0.35839114,
     'APs': 0.14904085,
     'ARl': 0.6593774,
     'ARm': 0.51881045,
     'ARmax1': 0.3136172,
     'ARmax10': 0.4928534,
     'ARmax100': 0.5305523,
     'ARs': 0.29569787,
     'avg_iou_3': 0.47126895,
     'avg_iou_4': 0.6802828,
     'avg_iou_5': 0.8031518,
     'avg_obj_3': 0.22930647,
     'avg_obj_4': 0.447266,
     'avg_obj_5': 0.62869203,
     'box_loss_3': 0.008407464,
     'box_loss_4': 0.008760795,
     'box_loss_5': 0.008034924,
     'class_loss_3': 0.0032456801,
     'class_loss_4': 0.0039085415,
     'class_loss_5': 0.0039955713,
     'conf_loss_3': 0.007341047,
     'conf_loss_4': 0.009393821,
     'conf_loss_5': 0.0103973765,
     'recall50_3': 0.24417646,
     'recall50_4': 0.49201298,
     'recall50_5': 0.68090916,
     'total_loss': 0.063485235,
     'validation_loss': 0.063485235}

train | step:  200000 | training until step 220000...
train | step:  220000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.7076343,
     'avg_iou_4': 0.82035047,
     'avg_iou_5': 0.86868113,
     'avg_obj_3': 0.37346137,
     'avg_obj_4': 0.5641126,
     'avg_obj_5': 0.6837669,
     'box_loss_3': 0.09484008,
     'box_loss_4': 0.06558037,
     'box_loss_5': 0.051438842,
     'class_loss_3': 0.02055896,
     'class_loss_4': 0.015771693,
     'class_loss_5': 0.015247178,
     'conf_loss_3': 0.13817114,
     'conf_loss_4': 0.11597123,
     'conf_loss_5': 0.080991134,
     'learning_rate': 0.0002750408,
     'recall50_3': 0.30337584,
     'recall50_4': 0.5694403,
     'recall50_5': 0.74065816,
     'total_loss': 0.5985708,
     'training_loss': 0.5985708}
saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-220000.
 eval | step:  220000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=174.27s).
Accumulating evaluation results...
DONE (t=11.12s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.383
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.579
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.409
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.153
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.366
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.519
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.316
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.501
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.539
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.310
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.530
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.664
 eval | step:  220000 | eval time:  517.5 sec | output: 
    {'AP': 0.38300422,
     'AP50': 0.57919425,
     'AP75': 0.40867552,
     'APl': 0.5191172,
     'APm': 0.36599985,
     'APs': 0.15317406,
     'ARl': 0.66426045,
     'ARm': 0.5303651,
     'ARmax1': 0.31621164,
     'ARmax10': 0.5006714,
     'ARmax100': 0.5394581,
     'ARs': 0.3096788,
     'avg_iou_3': 0.47360116,
     'avg_iou_4': 0.6834,
     'avg_iou_5': 0.8052599,
     'avg_obj_3': 0.23003046,
     'avg_obj_4': 0.44787848,
     'avg_obj_5': 0.62712556,
     'box_loss_3': 0.008287934,
     'box_loss_4': 0.008599968,
     'box_loss_5': 0.007924243,
     'class_loss_3': 0.0031537602,
     'class_loss_4': 0.0037191361,
     'class_loss_5': 0.0038061382,
     'conf_loss_3': 0.0072414475,
     'conf_loss_4': 0.009204986,
     'conf_loss_5': 0.010167117,
     'recall50_3': 0.24382947,
     'recall50_4': 0.49370688,
     'recall50_5': 0.6840433,
     'total_loss': 0.06210468,
     'validation_loss': 0.06210468}
train | step:  220000 | training until step 240000...
train | step:  240000 | steps/sec:    2.5 | output: 
    {'avg_iou_3': 0.7106104,
     'avg_iou_4': 0.8235249,
     'avg_iou_5': 0.8716992,
     'avg_obj_3': 0.38302416,
     'avg_obj_4': 0.5742275,
     'avg_obj_5': 0.69357276,
     'box_loss_3': 0.09388653,
     'box_loss_4': 0.06439345,
     'box_loss_5': 0.050213374,
     'class_loss_3': 0.01972814,
     'class_loss_4': 0.015067672,
     'class_loss_5': 0.014470789,
     'conf_loss_3': 0.13595268,
     'conf_loss_4': 0.11357162,
     'conf_loss_5': 0.07880979,
     'learning_rate': 0.00019766467,
     'recall50_3': 0.31431624,
     'recall50_4': 0.58073455,
     'recall50_5': 0.7503833,
     'total_loss': 0.5860928,
     'training_loss': 0.5860928}
saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-240000.
 eval | step:  240000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=170.32s).
Accumulating evaluation results...
DONE (t=11.07s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.382
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.576
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.409
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.151
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.362
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.524
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.316
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.498
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.535
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.308
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.524
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.663
 eval | step:  240000 | eval time:  515.1 sec | output: 
    {'AP': 0.38151547,
     'AP50': 0.5759599,
     'AP75': 0.40897468,
     'APl': 0.5235318,
     'APm': 0.36215582,
     'APs': 0.1506219,
     'ARl': 0.663172,
     'ARm': 0.5239291,
     'ARmax1': 0.3155052,
     'ARmax10': 0.49786127,
     'ARmax100': 0.53517216,
     'ARs': 0.30763286,
     'avg_iou_3': 0.47240177,
     'avg_iou_4': 0.68160343,
     'avg_iou_5': 0.8041021,
     'avg_obj_3': 0.22940584,
     'avg_obj_4': 0.44755903,
     'avg_obj_5': 0.6284576,
     'box_loss_3': 0.008348935,
     'box_loss_4': 0.008692942,
     'box_loss_5': 0.007984948,
     'class_loss_3': 0.0032106491,
     'class_loss_4': 0.003828276,
     'class_loss_5': 0.0039163087,
     'conf_loss_3': 0.0072958367,
     'conf_loss_4': 0.009306948,
     'conf_loss_5': 0.010299719,
     'recall50_3': 0.24257608,
     'recall50_4': 0.49069038,
     'recall50_5': 0.68329895,
     'total_loss': 0.06288457,
     'validation_loss': 0.06288457}
train | step:  240000 | training until step 260000...
train | step:  260000 | steps/sec:    2.5 | output: 
    {'avg_iou_3': 0.7129692,
     'avg_iou_4': 0.8261927,
     'avg_iou_5': 0.8741565,
     'avg_obj_3': 0.3907455,
     'avg_obj_4': 0.58246475,
     'avg_obj_5': 0.70139366,
     'box_loss_3': 0.09314293,
     'box_loss_4': 0.063450284,
     'box_loss_5': 0.049248364,
     'class_loss_3': 0.01914921,
     'class_loss_4': 0.014587013,
     'class_loss_5': 0.013924432,
     'conf_loss_3': 0.134015,
     'conf_loss_4': 0.111448206,
     'conf_loss_5': 0.076982565,
     'learning_rate': 0.00013097274,
     'recall50_3': 0.3233465,
     'recall50_4': 0.58972365,
     'recall50_5': 0.75825715,
     'total_loss': 0.57594657,
     'training_loss': 0.57594657}
saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-260000.
 eval | step:  260000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=170.12s).
Accumulating evaluation results...
DONE (t=10.81s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.379
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.572
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.407
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.149
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.358
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.522
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.314
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.493
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.531
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.296
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.519
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.659
 eval | step:  260000 | eval time:  499.0 sec | output: 
    {'AP': 0.37933102,
     'AP50': 0.5717935,
     'AP75': 0.40671644,
     'APl': 0.5221721,
     'APm': 0.35839114,
     'APs': 0.14904085,
     'ARl': 0.6593774,
     'ARm': 0.51881045,
     'ARmax1': 0.3136172,
     'ARmax10': 0.4928534,
     'ARmax100': 0.5305523,
     'ARs': 0.29569787,
     'avg_iou_3': 0.47126895,
     'avg_iou_4': 0.6802828,
     'avg_iou_5': 0.8031518,
     'avg_obj_3': 0.22930647,
     'avg_obj_4': 0.447266,
     'avg_obj_5': 0.62869203,
     'box_loss_3': 0.008407464,
     'box_loss_4': 0.008760795,
     'box_loss_5': 0.008034924,
     'class_loss_3': 0.0032456801,
     'class_loss_4': 0.0039085415,
     'class_loss_5': 0.0039955713,
     'conf_loss_3': 0.007341047,
     'conf_loss_4': 0.009393821,
     'conf_loss_5': 0.0103973765,
     'recall50_3': 0.24417646,
     'recall50_4': 0.49201298,
     'recall50_5': 0.68090916,
     'total_loss': 0.063485235,
     'validation_loss': 0.063485235}I0403 02:44:00.769469 139684420589376 controller.py:211] train | step:  260000 | training until step 280000...
I0403 04:42:51.102208 139684420589376 controller.py:425] train | step:  280000 | steps/sec:    2.6 | output: 
    {'avg_iou_3': 0.7149434,
     'avg_iou_4': 0.82826376,
     'avg_iou_5': 0.87620735,
     'avg_obj_3': 0.3968813,
     'avg_obj_4': 0.58915526,
     'avg_obj_5': 0.70779705,
     'box_loss_3': 0.09237254,
     'box_loss_4': 0.06264137,
     'box_loss_5': 0.048434503,
     'class_loss_3': 0.018615015,
     'class_loss_4': 0.014106289,
     'class_loss_5': 0.013445032,
     'conf_loss_3': 0.13231096,
     'conf_loss_4': 0.10974639,
     'conf_loss_5': 0.07541149,
     'learning_rate': 7.728347e-05,
     'recall50_3': 0.3304567,
     'recall50_4': 0.59718215,
     'recall50_5': 0.76435006,
     'total_loss': 0.5670828,
     'training_loss': 0.5670828}
I0403 04:43:49.871160 139684420589376 controller.py:455] saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-280000.
I0403 04:43:49.877379 139684420589376 controller.py:252]  eval | step:  280000 | running 625 steps of evaluation...
I0403 04:48:11.661681 139684420589376 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0403 04:52:04.894854 139684420589376 controller.py:261]  eval | step:  280000 | eval time:  495.0 sec | output: 
    {'AP': 0.37628555,
     'AP50': 0.56812227,
     'AP75': 0.40396437,
     'APl': 0.5116414,
     'APm': 0.3567951,
     'APs': 0.14785677,
     'ARl': 0.65150404,
     'ARm': 0.5152177,
     'ARmax1': 0.31226224,
     'ARmax10': 0.49073386,
     'ARmax100': 0.5266669,
     'ARs': 0.30019385,
     'avg_iou_3': 0.4703372,
     'avg_iou_4': 0.6792272,
     'avg_iou_5': 0.80181056,
     'avg_obj_3': 0.22924165,
     'avg_obj_4': 0.4467372,
     'avg_obj_5': 0.6292054,
     'box_loss_3': 0.008456823,
     'box_loss_4': 0.008814671,
     'box_loss_5': 0.008103652,
     'class_loss_3': 0.0033038585,
     'class_loss_4': 0.003989486,
     'class_loss_5': 0.004103878,
     'conf_loss_3': 0.007396228,
     'conf_loss_4': 0.009477454,
     'conf_loss_5': 0.010505796,
     'recall50_3': 0.244429,
     'recall50_4': 0.49063355,
     'recall50_5': 0.6815048,
     'total_loss': 0.06415185,
     'validation_loss': 0.06415185}
I0403 04:52:27.993677 139684420589376 controller.py:211] train | step:  280000 | training until step 300000...
I0403 06:50:48.616356 139684420589376 controller.py:425] train | step:  300000 | steps/sec:    2.6 | output: 
    {'avg_iou_3': 0.71635216,
     'avg_iou_4': 0.82982296,
     'avg_iou_5': 0.8777578,
     'avg_obj_3': 0.4014715,
     'avg_obj_4': 0.5939435,
     'avg_obj_5': 0.7127182,
     'box_loss_3': 0.092027195,
     'box_loss_4': 0.062123016,
     'box_loss_5': 0.047838412,
     'class_loss_3': 0.018329833,
     'class_loss_4': 0.01380596,
     'class_loss_5': 0.013146668,
     'conf_loss_3': 0.13145865,
     'conf_loss_4': 0.10879198,
     'conf_loss_5': 0.07444182,
     'learning_rate': 3.8463215e-05,
     'recall50_3': 0.3358079,
     'recall50_4': 0.6025972,
     'recall50_5': 0.7692831,
     'total_loss': 0.56196207,
     'training_loss': 0.56196207}
I0403 06:51:44.232126 139684420589376 controller.py:455] saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-300000.
I0403 06:51:44.237897 139684420589376 controller.py:252]  eval | step:  300000 | running 625 steps of evaluation...
I0403 06:56:10.791611 139684420589376 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0403 07:00:08.357806 139684420589376 controller.py:261]  eval | step:  300000 | eval time:  504.1 sec | output: 
    {'AP': 0.37668535,
     'AP50': 0.5671237,
     'AP75': 0.40399528,
     'APl': 0.5150341,
     'APm': 0.35787812,
     'APs': 0.14682953,
     'ARl': 0.6472714,
     'ARm': 0.51191795,
     'ARmax1': 0.31211796,
     'ARmax10': 0.48797822,
     'ARmax100': 0.5229798,
     'ARs': 0.28583032,
     'avg_iou_3': 0.46991435,
     'avg_iou_4': 0.678925,
     'avg_iou_5': 0.8017336,
     'avg_obj_3': 0.2286977,
     'avg_obj_4': 0.44641596,
     'avg_obj_5': 0.63045794,
     'box_loss_3': 0.008478688,
     'box_loss_4': 0.008830994,
     'box_loss_5': 0.008107106,
     'class_loss_3': 0.003303777,
     'class_loss_4': 0.004022135,
     'class_loss_5': 0.0041608587,
     'conf_loss_3': 0.007395627,
     'conf_loss_4': 0.009509232,
     'conf_loss_5': 0.010562414,
     'recall50_3': 0.24396648,
     'recall50_4': 0.4892708,
     'recall50_5': 0.68106526,
     'total_loss': 0.06437082,
     'validation_loss': 0.06437082}
I0403 07:00:29.731647 139684420589376 controller.py:211] train | step:  300000 | training until step 320000...
I0403 09:06:15.174834 139684420589376 controller.py:425] train | step:  320000 | steps/sec:    2.5 | output: 
    {'avg_iou_3': 0.7170627,
     'avg_iou_4': 0.8307059,
     'avg_iou_5': 0.8786701,
     'avg_obj_3': 0.4039007,
     'avg_obj_4': 0.5965342,
     'avg_obj_5': 0.7151538,
     'box_loss_3': 0.09155464,
     'box_loss_4': 0.0617198,
     'box_loss_5': 0.04743465,
     'class_loss_3': 0.01802383,
     'class_loss_4': 0.013623151,
     'class_loss_5': 0.012937837,
     'conf_loss_3': 0.13056804,
     'conf_loss_4': 0.107860535,
     'conf_loss_5': 0.073728986,
     'learning_rate': 1.586156e-05,
     'recall50_3': 0.33862635,
     'recall50_4': 0.6052246,
     'recall50_5': 0.7716188,
     'total_loss': 0.55745083,
     'training_loss': 0.55745083}
I0403 09:07:10.357713 139684420589376 controller.py:455] saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-320000.
I0403 09:07:10.363351 139684420589376 controller.py:252]  eval | step:  320000 | running 625 steps of evaluation...
I0403 09:11:35.289900 139684420589376 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0403 09:15:31.919880 139684420589376 controller.py:261]  eval | step:  320000 | eval time:  501.6 sec | output: 
    {'AP': 0.3759376,
     'AP50': 0.5679859,
     'AP75': 0.40227762,
     'APl': 0.51177245,
     'APm': 0.35669878,
     'APs': 0.14542153,
     'ARl': 0.6471286,
     'ARm': 0.5113696,
     'ARmax1': 0.31182417,
     'ARmax10': 0.48693183,
     'ARmax100': 0.52194,
     'ARs': 0.28552598,
     'avg_iou_3': 0.4694979,
     'avg_iou_4': 0.678338,
     'avg_iou_5': 0.80169475,
     'avg_obj_3': 0.22846094,
     'avg_obj_4': 0.4464736,
     'avg_obj_5': 0.6308418,
     'box_loss_3': 0.008499734,
     'box_loss_4': 0.008861791,
     'box_loss_5': 0.0081098415,
     'class_loss_3': 0.003319527,
     'class_loss_4': 0.004067571,
     'class_loss_5': 0.0041990206,
     'conf_loss_3': 0.007404514,
     'conf_loss_4': 0.009529988,
     'conf_loss_5': 0.010607307,
     'recall50_3': 0.24336685,
     'recall50_4': 0.48984367,
     'recall50_5': 0.68230915,
     'total_loss': 0.06459928,
     'validation_loss': 0.06459928}

train | step:  260000 | training until step 280000...
train | step:  280000 | steps/sec:    2.6 | output: 
    {'avg_iou_3': 0.7149434,
     'avg_iou_4': 0.82826376,
     'avg_iou_5': 0.87620735,
     'avg_obj_3': 0.3968813,
     'avg_obj_4': 0.58915526,
     'avg_obj_5': 0.70779705,
     'box_loss_3': 0.09237254,
     'box_loss_4': 0.06264137,
     'box_loss_5': 0.048434503,
     'class_loss_3': 0.018615015,
     'class_loss_4': 0.014106289,
     'class_loss_5': 0.013445032,
     'conf_loss_3': 0.13231096,
     'conf_loss_4': 0.10974639,
     'conf_loss_5': 0.07541149,
     'learning_rate': 7.728347e-05,
     'recall50_3': 0.3304567,
     'recall50_4': 0.59718215,
     'recall50_5': 0.76435006,
     'total_loss': 0.5670828,
     'training_loss': 0.5670828}
saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-280000.
 eval | step:  280000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=168.02s).
Accumulating evaluation results...
DONE (t=10.61s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.376
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.568
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.404
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.148
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.357
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.512
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.312
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.527
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.300
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.515
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.652
 eval | step:  280000 | eval time:  495.0 sec | output: 
    {'AP': 0.37628555,
     'AP50': 0.56812227,
     'AP75': 0.40396437,
     'APl': 0.5116414,
     'APm': 0.3567951,
     'APs': 0.14785677,
     'ARl': 0.65150404,
     'ARm': 0.5152177,
     'ARmax1': 0.31226224,
     'ARmax10': 0.49073386,
     'ARmax100': 0.5266669,
     'ARs': 0.30019385,
     'avg_iou_3': 0.4703372,
     'avg_iou_4': 0.6792272,
     'avg_iou_5': 0.80181056,
     'avg_obj_3': 0.22924165,
     'avg_obj_4': 0.4467372,
     'avg_obj_5': 0.6292054,
     'box_loss_3': 0.008456823,
     'box_loss_4': 0.008814671,
     'box_loss_5': 0.008103652,
     'class_loss_3': 0.0033038585,
     'class_loss_4': 0.003989486,
     'class_loss_5': 0.004103878,
     'conf_loss_3': 0.007396228,
     'conf_loss_4': 0.009477454,
     'conf_loss_5': 0.010505796,
     'recall50_3': 0.244429,
     'recall50_4': 0.49063355,
     'recall50_5': 0.6815048,
     'total_loss': 0.06415185,
     'validation_loss': 0.06415185}
train | step:  280000 | training until step 300000...
train | step:  300000 | steps/sec:    2.6 | output: 
    {'avg_iou_3': 0.71635216,
     'avg_iou_4': 0.82982296,
     'avg_iou_5': 0.8777578,
     'avg_obj_3': 0.4014715,
     'avg_obj_4': 0.5939435,
     'avg_obj_5': 0.7127182,
     'box_loss_3': 0.092027195,
     'box_loss_4': 0.062123016,
     'box_loss_5': 0.047838412,
     'class_loss_3': 0.018329833,
     'class_loss_4': 0.01380596,
     'class_loss_5': 0.013146668,
     'conf_loss_3': 0.13145865,
     'conf_loss_4': 0.10879198,
     'conf_loss_5': 0.07444182,
     'learning_rate': 3.8463215e-05,
     'recall50_3': 0.3358079,
     'recall50_4': 0.6025972,
     'recall50_5': 0.7692831,
     'total_loss': 0.56196207,
     'training_loss': 0.56196207}
saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-300000.
 eval | step:  300000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=169.07s).
Accumulating evaluation results...
DONE (t=14.16s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.377
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.567
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.404
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.147
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.358
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.515
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.312
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.488
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.523
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.286
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.512
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.647
 eval | step:  300000 | eval time:  504.1 sec | output: 
    {'AP': 0.37668535,
     'AP50': 0.5671237,
     'AP75': 0.40399528,
     'APl': 0.5150341,
     'APm': 0.35787812,
     'APs': 0.14682953,
     'ARl': 0.6472714,
     'ARm': 0.51191795,
     'ARmax1': 0.31211796,
     'ARmax10': 0.48797822,
     'ARmax100': 0.5229798,
     'ARs': 0.28583032,
     'avg_iou_3': 0.46991435,
     'avg_iou_4': 0.678925,
     'avg_iou_5': 0.8017336,
     'avg_obj_3': 0.2286977,
     'avg_obj_4': 0.44641596,
     'avg_obj_5': 0.63045794,
     'box_loss_3': 0.008478688,
     'box_loss_4': 0.008830994,
     'box_loss_5': 0.008107106,
     'class_loss_3': 0.003303777,
     'class_loss_4': 0.004022135,
     'class_loss_5': 0.0041608587,
     'conf_loss_3': 0.007395627,
     'conf_loss_4': 0.009509232,
     'conf_loss_5': 0.010562414,
     'recall50_3': 0.24396648,
     'recall50_4': 0.4892708,
     'recall50_5': 0.68106526,
     'total_loss': 0.06437082,
     'validation_loss': 0.06437082}
train | step:  300000 | training until step 320000...
train | step:  320000 | steps/sec:    2.5 | output: 
    {'avg_iou_3': 0.7170627,
     'avg_iou_4': 0.8307059,
     'avg_iou_5': 0.8786701,
     'avg_obj_3': 0.4039007,
     'avg_obj_4': 0.5965342,
     'avg_obj_5': 0.7151538,
     'box_loss_3': 0.09155464,
     'box_loss_4': 0.0617198,
     'box_loss_5': 0.04743465,
     'class_loss_3': 0.01802383,
     'class_loss_4': 0.013623151,
     'class_loss_5': 0.012937837,
     'conf_loss_3': 0.13056804,
     'conf_loss_4': 0.107860535,
     'conf_loss_5': 0.073728986,
     'learning_rate': 1.586156e-05,
     'recall50_3': 0.33862635,
     'recall50_4': 0.6052246,
     'recall50_5': 0.7716188,
     'total_loss': 0.55745083,
     'training_loss': 0.55745083}
saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-320000.
 eval | step:  320000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=171.58s).
Accumulating evaluation results...
DONE (t=10.99s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.376
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.568
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.402
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.145
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.357
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.512
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.312
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.487
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.522
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.286
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.511
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.647
 eval | step:  320000 | eval time:  501.6 sec | output: 
    {'AP': 0.3759376,
     'AP50': 0.5679859,
     'AP75': 0.40227762,
     'APl': 0.51177245,
     'APm': 0.35669878,
     'APs': 0.14542153,
     'ARl': 0.6471286,
     'ARm': 0.5113696,
     'ARmax1': 0.31182417,
     'ARmax10': 0.48693183,
     'ARmax100': 0.52194,
     'ARs': 0.28552598,
     'avg_iou_3': 0.4694979,
     'avg_iou_4': 0.678338,
     'avg_iou_5': 0.80169475,
     'avg_obj_3': 0.22846094,
     'avg_obj_4': 0.4464736,
     'avg_obj_5': 0.6308418,
     'box_loss_3': 0.008499734,
     'box_loss_4': 0.008861791,
     'box_loss_5': 0.0081098415,
     'class_loss_3': 0.003319527,
     'class_loss_4': 0.004067571,
     'class_loss_5': 0.0041990206,
     'conf_loss_3': 0.007404514,
     'conf_loss_4': 0.009529988,
     'conf_loss_5': 0.010607307,
     'recall50_3': 0.24336685,
     'recall50_4': 0.48984367,
     'recall50_5': 0.68230915,
     'total_loss': 0.06459928,
     'validation_loss': 0.06459928}I0403 09:15:47.658556 139684420589376 controller.py:211] train | step:  320000 | training until step 340000...
I0403 11:13:53.148280 139684420589376 controller.py:425] train | step:  340000 | steps/sec:    2.6 | output: 
    {'avg_iou_3': 0.71759945,
     'avg_iou_4': 0.8311526,
     'avg_iou_5': 0.8790669,
     'avg_obj_3': 0.40527827,
     'avg_obj_4': 0.5981028,
     'avg_obj_5': 0.71672314,
     'box_loss_3': 0.09148001,
     'box_loss_4': 0.06156057,
     'box_loss_5': 0.047283575,
     'class_loss_3': 0.017975848,
     'class_loss_4': 0.013537667,
     'class_loss_5': 0.012873246,
     'conf_loss_3': 0.1304268,
     'conf_loss_4': 0.107600816,
     'conf_loss_5': 0.07341614,
     'learning_rate': 1.0000001e-05,
     'recall50_3': 0.34025592,
     'recall50_4': 0.60720825,
     'recall50_5': 0.77333295,
     'total_loss': 0.5561553,
     'training_loss': 0.5561553}
I0403 11:14:48.210308 139684420589376 controller.py:455] saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-340000.
I0403 11:14:48.216858 139684420589376 controller.py:252]  eval | step:  340000 | running 625 steps of evaluation...
I0403 11:19:11.018520 139684420589376 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0403 11:23:10.043037 139684420589376 controller.py:261]  eval | step:  340000 | eval time:  501.8 sec | output: 
    {'AP': 0.37575656,
     'AP50': 0.5681838,
     'AP75': 0.40244162,
     'APl': 0.51192325,
     'APm': 0.35631537,
     'APs': 0.1458253,
     'ARl': 0.64691573,
     'ARm': 0.51050836,
     'ARmax1': 0.3116227,
     'ARmax10': 0.48663464,
     'ARmax100': 0.521671,
     'ARs': 0.28432992,
     'avg_iou_3': 0.46927348,
     'avg_iou_4': 0.6781896,
     'avg_iou_5': 0.8015577,
     'avg_obj_3': 0.22875437,
     'avg_obj_4': 0.4468519,
     'avg_obj_5': 0.6311526,
     'box_loss_3': 0.008511667,
     'box_loss_4': 0.008869473,
     'box_loss_5': 0.008117215,
     'class_loss_3': 0.0033385074,
     'class_loss_4': 0.004071502,
     'class_loss_5': 0.004209982,
     'conf_loss_3': 0.007420636,
     'conf_loss_4': 0.009557508,
     'conf_loss_5': 0.0106296325,
     'recall50_3': 0.24339582,
     'recall50_4': 0.48983663,
     'recall50_5': 0.68164444,
     'total_loss': 0.06472615,
     'validation_loss': 0.06472615}
I0403 11:23:27.226157 139684420589376 controller.py:211] train | step:  340000 | training until step 360000...
I0403 13:22:51.304245 139684420589376 controller.py:425] train | step:  360000 | steps/sec:    2.6 | output: 
    {'avg_iou_3': 0.71777713,
     'avg_iou_4': 0.83127433,
     'avg_iou_5': 0.87930447,
     'avg_obj_3': 0.40576583,
     'avg_obj_4': 0.5987386,
     'avg_obj_5': 0.7172143,
     'box_loss_3': 0.09141992,
     'box_loss_4': 0.06153425,
     'box_loss_5': 0.04719787,
     'class_loss_3': 0.01791876,
     'class_loss_4': 0.013497524,
     'class_loss_5': 0.012810042,
     'conf_loss_3': 0.1303384,
     'conf_loss_4': 0.10747304,
     'conf_loss_5': 0.07331538,
     'learning_rate': 1.0000001e-05,
     'recall50_3': 0.34100416,
     'recall50_4': 0.6079187,
     'recall50_5': 0.7736614,
     'total_loss': 0.5555045,
     'training_loss': 0.5555045}
I0403 13:23:47.897568 139684420589376 controller.py:455] saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-360000.
I0403 13:23:47.904650 139684420589376 controller.py:252]  eval | step:  360000 | running 625 steps of evaluation...
I0403 13:28:15.700574 139684420589376 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0403 13:32:11.241581 139684420589376 controller.py:261]  eval | step:  360000 | eval time:  503.3 sec | output: 
    {'AP': 0.37580642,
     'AP50': 0.5680309,
     'AP75': 0.40208703,
     'APl': 0.51200736,
     'APm': 0.3563143,
     'APs': 0.14527424,
     'ARl': 0.64572626,
     'ARm': 0.50929505,
     'ARmax1': 0.31161797,
     'ARmax10': 0.4860429,
     'ARmax100': 0.5208052,
     'ARs': 0.28332445,
     'avg_iou_3': 0.46920723,
     'avg_iou_4': 0.67800975,
     'avg_iou_5': 0.8014408,
     'avg_obj_3': 0.22874016,
     'avg_obj_4': 0.44717738,
     'avg_obj_5': 0.6307708,
     'box_loss_3': 0.008514981,
     'box_loss_4': 0.008878149,
     'box_loss_5': 0.008122911,
     'class_loss_3': 0.0033393432,
     'class_loss_4': 0.0040717036,
     'class_loss_5': 0.0042268625,
     'conf_loss_3': 0.007424375,
     'conf_loss_4': 0.009566503,
     'conf_loss_5': 0.01061801,
     'recall50_3': 0.24341707,
     'recall50_4': 0.48970595,
     'recall50_5': 0.68227243,
     'total_loss': 0.06476286,
     'validation_loss': 0.06476286}
I0403 13:32:28.164053 139684420589376 controller.py:211] train | step:  360000 | training until step 375000...
I0403 15:00:11.019037 139684420589376 controller.py:425] train | step:  375000 | steps/sec:    2.6 | output: 
    {'avg_iou_3': 0.7176904,
     'avg_iou_4': 0.8313622,
     'avg_iou_5': 0.8794333,
     'avg_obj_3': 0.4059388,
     'avg_obj_4': 0.5988994,
     'avg_obj_5': 0.7176282,
     'box_loss_3': 0.09139025,
     'box_loss_4': 0.061481014,
     'box_loss_5': 0.04712049,
     'class_loss_3': 0.017925642,
     'class_loss_4': 0.013512546,
     'class_loss_5': 0.012777359,
     'conf_loss_3': 0.13010079,
     'conf_loss_4': 0.107261784,
     'conf_loss_5': 0.07311486,
     'learning_rate': 1.0000001e-05,
     'recall50_3': 0.34096217,
     'recall50_4': 0.60772365,
     'recall50_5': 0.77396244,
     'total_loss': 0.5546856,
     'training_loss': 0.5546856}
I0403 15:00:24.218862 139684420589376 controller.py:252]  eval | step:  375000 | running 625 steps of evaluation...
I0403 15:04:50.516935 139684420589376 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0403 15:08:48.665431 139684420589376 controller.py:261]  eval | step:  375000 | eval time:  504.4 sec | output: 
    {'AP': 0.3757702,
     'AP50': 0.5676138,
     'AP75': 0.40091437,
     'APl': 0.51276267,
     'APm': 0.3566185,
     'APs': 0.14412588,
     'ARl': 0.6471607,
     'ARm': 0.5111096,
     'ARmax1': 0.31180155,
     'ARmax10': 0.486017,
     'ARmax100': 0.52145964,
     'ARs': 0.28376946,
     'avg_iou_3': 0.46915093,
     'avg_iou_4': 0.67802143,
     'avg_iou_5': 0.8015449,
     'avg_obj_3': 0.22864266,
     'avg_obj_4': 0.44702533,
     'avg_obj_5': 0.6307272,
     'box_loss_3': 0.008517769,
     'box_loss_4': 0.008878038,
     'box_loss_5': 0.008117967,
     'class_loss_3': 0.0033443798,
     'class_loss_4': 0.0040783766,
     'class_loss_5': 0.004233124,
     'conf_loss_3': 0.00742267,
     'conf_loss_4': 0.009565851,
     'conf_loss_5': 0.010629587,
     'recall50_3': 0.24307916,
     'recall50_4': 0.49005944,
     'recall50_5': 0.68183637,
     'total_loss': 0.06478774,
     'validation_loss': 0.06478774}

train | step:  320000 | training until step 340000...
train | step:  340000 | steps/sec:    2.6 | output: 
    {'avg_iou_3': 0.71759945,
     'avg_iou_4': 0.8311526,
     'avg_iou_5': 0.8790669,
     'avg_obj_3': 0.40527827,
     'avg_obj_4': 0.5981028,
     'avg_obj_5': 0.71672314,
     'box_loss_3': 0.09148001,
     'box_loss_4': 0.06156057,
     'box_loss_5': 0.047283575,
     'class_loss_3': 0.017975848,
     'class_loss_4': 0.013537667,
     'class_loss_5': 0.012873246,
     'conf_loss_3': 0.1304268,
     'conf_loss_4': 0.107600816,
     'conf_loss_5': 0.07341614,
     'learning_rate': 1.0000001e-05,
     'recall50_3': 0.34025592,
     'recall50_4': 0.60720825,
     'recall50_5': 0.77333295,
     'total_loss': 0.5561553,
     'training_loss': 0.5561553}
saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-340000.
 eval | step:  340000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.02s).
Accumulating evaluation results...
DONE (t=10.82s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.376
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.568
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.402
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.146
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.356
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.512
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.312
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.487
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.522
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.284
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.511
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.647
 eval | step:  340000 | eval time:  501.8 sec | output: 
    {'AP': 0.37575656,
     'AP50': 0.5681838,
     'AP75': 0.40244162,
     'APl': 0.51192325,
     'APm': 0.35631537,
     'APs': 0.1458253,
     'ARl': 0.64691573,
     'ARm': 0.51050836,
     'ARmax1': 0.3116227,
     'ARmax10': 0.48663464,
     'ARmax100': 0.521671,
     'ARs': 0.28432992,
     'avg_iou_3': 0.46927348,
     'avg_iou_4': 0.6781896,
     'avg_iou_5': 0.8015577,
     'avg_obj_3': 0.22875437,
     'avg_obj_4': 0.4468519,
     'avg_obj_5': 0.6311526,
     'box_loss_3': 0.008511667,
     'box_loss_4': 0.008869473,
     'box_loss_5': 0.008117215,
     'class_loss_3': 0.0033385074,
     'class_loss_4': 0.004071502,
     'class_loss_5': 0.004209982,
     'conf_loss_3': 0.007420636,
     'conf_loss_4': 0.009557508,
     'conf_loss_5': 0.0106296325,
     'recall50_3': 0.24339582,
     'recall50_4': 0.48983663,
     'recall50_5': 0.68164444,
     'total_loss': 0.06472615,
     'validation_loss': 0.06472615}
train | step:  340000 | training until step 360000...
train | step:  360000 | steps/sec:    2.6 | output: 
    {'avg_iou_3': 0.71777713,
     'avg_iou_4': 0.83127433,
     'avg_iou_5': 0.87930447,
     'avg_obj_3': 0.40576583,
     'avg_obj_4': 0.5987386,
     'avg_obj_5': 0.7172143,
     'box_loss_3': 0.09141992,
     'box_loss_4': 0.06153425,
     'box_loss_5': 0.04719787,
     'class_loss_3': 0.01791876,
     'class_loss_4': 0.013497524,
     'class_loss_5': 0.012810042,
     'conf_loss_3': 0.1303384,
     'conf_loss_4': 0.10747304,
     'conf_loss_5': 0.07331538,
     'learning_rate': 1.0000001e-05,
     'recall50_3': 0.34100416,
     'recall50_4': 0.6079187,
     'recall50_5': 0.7736614,
     'total_loss': 0.5555045,
     'training_loss': 0.5555045}
saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-360000.
 eval | step:  360000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=171.36s).
Accumulating evaluation results...
DONE (t=10.80s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.376
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.568
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.402
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.145
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.356
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.512
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.312
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.486
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.521
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.283
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.509
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.646
 eval | step:  360000 | eval time:  503.3 sec | output: 
    {'AP': 0.37580642,
     'AP50': 0.5680309,
     'AP75': 0.40208703,
     'APl': 0.51200736,
     'APm': 0.3563143,
     'APs': 0.14527424,
     'ARl': 0.64572626,
     'ARm': 0.50929505,
     'ARmax1': 0.31161797,
     'ARmax10': 0.4860429,
     'ARmax100': 0.5208052,
     'ARs': 0.28332445,
     'avg_iou_3': 0.46920723,
     'avg_iou_4': 0.67800975,
     'avg_iou_5': 0.8014408,
     'avg_obj_3': 0.22874016,
     'avg_obj_4': 0.44717738,
     'avg_obj_5': 0.6307708,
     'box_loss_3': 0.008514981,
     'box_loss_4': 0.008878149,
     'box_loss_5': 0.008122911,
     'class_loss_3': 0.0033393432,
     'class_loss_4': 0.0040717036,
     'class_loss_5': 0.0042268625,
     'conf_loss_3': 0.007424375,
     'conf_loss_4': 0.009566503,
     'conf_loss_5': 0.01061801,
     'recall50_3': 0.24341707,
     'recall50_4': 0.48970595,
     'recall50_5': 0.68227243,
     'total_loss': 0.06476286,
     'validation_loss': 0.06476286}
train | step:  360000 | training until step 375000...
train | step:  375000 | steps/sec:    2.6 | output: 
    {'avg_iou_3': 0.7176904,
     'avg_iou_4': 0.8313622,
     'avg_iou_5': 0.8794333,
     'avg_obj_3': 0.4059388,
     'avg_obj_4': 0.5988994,
     'avg_obj_5': 0.7176282,
     'box_loss_3': 0.09139025,
     'box_loss_4': 0.061481014,
     'box_loss_5': 0.04712049,
     'class_loss_3': 0.017925642,
     'class_loss_4': 0.013512546,
     'class_loss_5': 0.012777359,
     'conf_loss_3': 0.13010079,
     'conf_loss_4': 0.107261784,
     'conf_loss_5': 0.07311486,
     'learning_rate': 1.0000001e-05,
     'recall50_3': 0.34096217,
     'recall50_4': 0.60772365,
     'recall50_5': 0.77396244,
     'total_loss': 0.5546856,
     'training_loss': 0.5546856}
 eval | step:  375000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=171.42s).
Accumulating evaluation results...
DONE (t=10.92s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.376
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.568
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.401
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.144
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.357
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.513
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.312
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.486
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.521
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.284
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.511
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.647
 eval | step:  375000 | eval time:  504.4 sec | output: 
    {'AP': 0.3757702,
     'AP50': 0.5676138,
     'AP75': 0.40091437,
     'APl': 0.51276267,
     'APm': 0.3566185,
     'APs': 0.14412588,
     'ARl': 0.6471607,
     'ARm': 0.5111096,
     'ARmax1': 0.31180155,
     'ARmax10': 0.486017,
     'ARmax100': 0.52145964,
     'ARs': 0.28376946,
     'avg_iou_3': 0.46915093,
     'avg_iou_4': 0.67802143,
     'avg_iou_5': 0.8015449,
     'avg_obj_3': 0.22864266,
     'avg_obj_4': 0.44702533,
     'avg_obj_5': 0.6307272,
     'box_loss_3': 0.008517769,
     'box_loss_4': 0.008878038,
     'box_loss_5': 0.008117967,
     'class_loss_3': 0.0033443798,
     'class_loss_4': 0.0040783766,
     'class_loss_5': 0.004233124,
     'conf_loss_3': 0.00742267,
     'conf_loss_4': 0.009565851,
     'conf_loss_5': 0.010629587,
     'recall50_3': 0.24307916,
     'recall50_4': 0.49005944,
     'recall50_5': 0.68183637,
     'total_loss': 0.06478774,
     'validation_loss': 0.06478774}I0403 15:09:48.612418 139684420589376 controller.py:455] saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-375000.
I0403 15:09:48.630132 139684420589376 train_lib.py:123] Number of trainable params in model: 53.066944 Millions.

saved checkpoint to gs://tensorflow2/full_runs/yolov4-csp-coco-adam-sum/ckpt-375000.
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   220    0     2  100   218      7    851 --:--:-- --:--:-- --:--:--   859
okRequest issued for: [node-3]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-03T15:10:02.683073701Z'
  endTime: '2021-04-03T15:10:52.678423174Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617462602667-5bf12dbde968b-982f0ef2-11144ea9
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617462602667-5bf12dbde968b-982f0ef2-11144ea9] to complete...
.......................................................................................................................................................................................................................................................................done.
