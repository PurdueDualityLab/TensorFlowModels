cat: .experiment_zone: No such file or directory
Request issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-20T15:39:51.552718706Z'
  endTime: '2021-04-20T15:40:26.258468913Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618933191540-5c06941cbff4f-2f6d9454-e5a6678e
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618933191540-5c06941cbff4f-2f6d9454-e5a6678e] to complete...
...............................................................................................................................................................................................done.
europe-west4-a
I0420 15:38:28.681648 139837058635584 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 20.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 2.4,
                                    'aug_scale_min': 0.1,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.6,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.213,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 0.5,
                                         'aug_rand_hue': 0.15,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 2.4,
                                         'aug_scale_min': 0.1,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.6,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.75, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 1.0,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.001},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [400000,
                                                                                450000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00131,
                                                                            0.000131,
                                                                            1.31e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 2000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 500500,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0420 15:38:28.683380 139837058635584 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/params.yaml
I0420 15:38:30.396767 139837058635584 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0420 15:38:31.016397 139837058635584 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0420 15:38:31.016737 139837058635584 transport.py:157] Attempting refresh to obtain initial access_token
I0420 15:38:31.077891 139837058635584 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0420 15:38:31.222305 139837058635584 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0420 15:38:31.222774 139837058635584 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-20 15:38:31.273275: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0420 15:38:31.274333 139837058635584 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0420 15:38:31.896744 139837058635584 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0420 15:38:31.896987 139837058635584 transport.py:157] Attempting refresh to obtain initial access_token
I0420 15:38:31.943709 139837058635584 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0420 15:38:32.563211 139837058635584 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0420 15:38:32.563470 139837058635584 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-20 15:38:32.610710: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-20 15:38:32.624351: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-20 15:38:32.624431: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:44243}
2021-04-20 15:39:10.311438: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-20 15:39:10.311589: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:44243}
2021-04-20 15:39:10.312609: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:44243
I0420 15:39:10.313412 139837058635584 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-6
I0420 15:39:10.314373 139837058635584 tpu_strategy_util.py:74] Initializing the TPU system: node-6
INFO:tensorflow:Clearing out eager caches
I0420 15:39:18.108051 139837058635584 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0420 15:39:18.110322 139837058635584 tpu_strategy_util.py:133] Finished initializing TPU system.
I0420 15:39:18.112019 139837058635584 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0420 15:39:18.256165 139837058635584 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0420 15:39:18.256418 139837058635584 transport.py:157] Attempting refresh to obtain initial access_token
I0420 15:39:18.325150 139837058635584 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0420 15:39:18.946847 139837058635584 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0420 15:39:18.947116 139837058635584 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0420 15:39:19.023638 139837058635584 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0420 15:39:19.023890 139837058635584 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0420 15:39:19.024144 139837058635584 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0420 15:39:19.024195 139837058635584 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0420 15:39:19.024246 139837058635584 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0420 15:39:19.024375 139837058635584 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0420 15:39:19.024424 139837058635584 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0420 15:39:19.024473 139837058635584 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0420 15:39:19.024522 139837058635584 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0420 15:39:19.024565 139837058635584 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0420 15:39:19.024611 139837058635584 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0420 15:39:19.024714 139837058635584 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0420 15:39:19.024772 139837058635584 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0420 15:39:19.024818 139837058635584 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0420 15:39:19.024862 139837058635584 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0420 15:39:19.024923 139837058635584 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0420 15:39:19.026274 139837058635584 train_utils.py:214] Running default trainer.
2021-04-20 15:39:19.047713: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.4, 'aug_rand_angle': 20.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.15, 'aug_scale_min': 0.1, 'aug_scale_max': 2.4, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.75, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 1.0, 'random_crop_mosaic': False}}}, 'weight_decay': 0.001, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [400000, 450000], 'values': [0.00131, 0.000131, 1.31e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 2000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 500500, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05} 0.0005
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f2df45ba7b8>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________
yolo_fpn (YoloFPN)              {'5': (None, 16, 16, 15165440    input_2[0][0]                    
                                                                 input_3[0][0]                    
                                                                 input_4[0][0]                    I0420 15:40:06.173871 139837058635584 controller.py:362] restoring or initializing model...
I0420 15:40:13.157370 139837058635584 yolo.py:529] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0420 15:40:13.159657 139837058635584 controller.py:368] initialized model.
I0420 15:40:13.160007 139837058635584 train_lib.py:96] Starts to execute mode: train_and_eval
I0420 15:40:13.165074 139837058635584 controller.py:211] train | step:      0 | training until step 20000...
I0420 15:40:20.543691 139837058635584 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0420 15:41:21.314391 139837058635584 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0420 16:47:46.266530 139837058635584 controller.py:425] train | step:  10000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.53047854,
           'avg_obj': 0.06267919,
           'box_loss': 3.5237894,
           'class_loss': 12.592402,
           'conf_loss': 54.627808,
           'precision50': 0.028578674,
           'recall50': 0.009988035},
     '4': {'avg_iou': 0.6154095,
           'avg_obj': 0.1344851,
           'box_loss': 3.724102,
           'class_loss': 15.774257,
           'conf_loss': 18.612833,
           'precision50': 0.14609537,
           'recall50': 0.064274356},
     '5': {'avg_iou': 0.6644583,
           'avg_obj': 0.23674841,
           'box_loss': 2.2610831,
           'class_loss': 10.770305,
           'conf_loss': 10.160149,
           'precision50': 0.29395556,
           'recall50': 0.20124233},
     'global': {'total_loss': 132.04681},
     'learning_rate': 0.00131,
     'training_loss': 132.04681}
I0420 16:48:43.760835 139837058635584 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-10000.
I0420 17:50:51.960935 139837058635584 controller.py:425] train | step:  20000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.5875349,
           'avg_obj': 0.08632741,
           'box_loss': 3.1031122,
           'class_loss': 3.9685633,
           'conf_loss': 6.5916853,
           'precision50': 0.06478215,
           'recall50': 0.016984934},
     '4': {'avg_iou': 0.6900617,
           'avg_obj': 0.19803318,
           'box_loss': 3.005179,
           'class_loss': 4.5986514,
           'conf_loss': 7.6294694,
           'precision50': 0.23662841,
           'recall50': 0.12569448},
     '5': {'avg_iou': 0.7523184,
           'avg_obj': 0.33922213,
           'box_loss': 1.6750041,
           'class_loss': 3.1226768,
           'conf_loss': 4.4136996,
           'precision50': 0.40475327,
           'recall50': 0.3310445},
     'global': {'total_loss': 38.108036},
     'learning_rate': 0.00131,
     'training_loss': 38.108036}
I0420 17:51:03.445879 139837058635584 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0420 17:51:04.207005 139837058635584 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0420 17:51:21.732359 139837058635584 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0420 17:56:15.618361 139837058635584 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0420 18:00:27.771223 139837058635584 controller.py:261]  eval | step:  20000 | eval time:  564.3 sec | output: 
    {'3': {'avg_iou': 0.45310947,
           'avg_obj': 0.108963914,
           'box_loss': 3.268615,
           'class_loss': 2.9756145,
           'conf_loss': 7.3973804,
           'precision50': 0.17434317,
           'recall50': 0.06281535},
     '4': {'avg_iou': 0.64703476,
           'avg_obj': 0.2941119,
           'box_loss': 2.7588258,
           'class_loss': 2.570852,
           'conf_loss': 6.455853,
           'precision50': 0.3526428,
           'recall50': 0.27473134},
     '5': {'avg_iou': 0.7089228,
           'avg_obj': 0.48448345,
           'box_loss': 1.4586604,
           'class_loss': 1.4234967,
           'conf_loss': 3.1837745,
           'precision50': 0.44337672,
           'recall50': 0.4973839},
     'AP': 0.20001604,
     'AP50': 0.40252241,
     'AP75': 0.1776715,
     'APl': 0.29648992,
     'APm': 0.19360322,
     'APs': 0.06594614,
     'ARl': 0.5223326,
     'ARm': 0.40639377,
     'ARmax1': 0.20399614,
     'ARmax10': 0.3456979,
     'ARmax100': 0.38551348,
     'ARs': 0.17534627,
     'global': {'total_loss': 31.493097},
     'validation_loss': 31.493097}

__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'3': (None, 64, 64, 22153728    yolo_fpn[0][0]                   
                                                                 yolo_fpn[0][1]                   
                                                                 yolo_fpn[0][2]                   
==================================================================================================
Total params: 37,319,168
Trainable params: 37,288,192
Non-trainable params: 30,976
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 37319168  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 64,488,640
Trainable params: 64,422,336
Non-trainable params: 66,304
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 200, 8), 4: (8, 200, 8), 5: (8, 200, 8)}, inds: {3: (8, 200, 3), 4: (8, 200, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
train | step:  10000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.53047854,
           'avg_obj': 0.06267919,
           'box_loss': 3.5237894,
           'class_loss': 12.592402,
           'conf_loss': 54.627808,
           'precision50': 0.028578674,
           'recall50': 0.009988035},
     '4': {'avg_iou': 0.6154095,
           'avg_obj': 0.1344851,
           'box_loss': 3.724102,
           'class_loss': 15.774257,
           'conf_loss': 18.612833,
           'precision50': 0.14609537,
           'recall50': 0.064274356},
     '5': {'avg_iou': 0.6644583,
           'avg_obj': 0.23674841,
           'box_loss': 2.2610831,
           'class_loss': 10.770305,
           'conf_loss': 10.160149,
           'precision50': 0.29395556,
           'recall50': 0.20124233},
     'global': {'total_loss': 132.04681},
     'learning_rate': 0.00131,
     'training_loss': 132.04681}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-10000.
train | step:  20000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.5875349,
           'avg_obj': 0.08632741,
           'box_loss': 3.1031122,
           'class_loss': 3.9685633,
           'conf_loss': 6.5916853,
           'precision50': 0.06478215,
           'recall50': 0.016984934},
     '4': {'avg_iou': 0.6900617,
           'avg_obj': 0.19803318,
           'box_loss': 3.005179,
           'class_loss': 4.5986514,
           'conf_loss': 7.6294694,
           'precision50': 0.23662841,
           'recall50': 0.12569448},
     '5': {'avg_iou': 0.7523184,
           'avg_obj': 0.33922213,
           'box_loss': 1.6750041,
           'class_loss': 3.1226768,
           'conf_loss': 4.4136996,
           'precision50': 0.40475327,
           'recall50': 0.3310445},
     'global': {'total_loss': 38.108036},
     'learning_rate': 0.00131,
     'training_loss': 38.108036}
 eval | step:  20000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=173.58s).
Accumulating evaluation results...
DONE (t=18.17s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.200
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.403
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.178
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.066
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.194
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.296
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.204
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.346
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.386
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.175
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.406
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.522
 eval | step:  20000 | eval time:  564.3 sec | output: 
    {'3': {'avg_iou': 0.45310947,
           'avg_obj': 0.108963914,
           'box_loss': 3.268615,
           'class_loss': 2.9756145,
           'conf_loss': 7.3973804,
           'precision50': 0.17434317,
           'recall50': 0.06281535},
     '4': {'avg_iou': 0.64703476,
           'avg_obj': 0.2941119,
           'box_loss': 2.7588258,
           'class_loss': 2.570852,
           'conf_loss': 6.455853,
           'precision50': 0.3526428,
           'recall50': 0.27473134},
     '5': {'avg_iou': 0.7089228,
           'avg_obj': 0.48448345,
           'box_loss': 1.4586604,
           'class_loss': 1.4234967,
           'conf_loss': 3.1837745,
           'precision50': 0.44337672,
           'recall50': 0.4973839},
     'AP': 0.20001604,
     'AP50': 0.40252241,
     'AP75': 0.1776715,
     'APl': 0.29648992,
     'APm': 0.19360322,
     'APs': 0.06594614,
     'ARl': 0.5223326,
     'ARm': 0.40639377,
     'ARmax1': 0.20399614,
     'ARmax10': 0.3456979,
     'ARmax100': 0.38551348,
     'ARs': 0.17534627,
     'global': {'total_loss': 31.493097},
     'validation_loss': 31.493097}I0420 18:00:50.705169 139837058635584 controller.py:211] train | step:  20000 | training until step 40000...
I0420 19:07:48.683898 139837058635584 controller.py:425] train | step:  30000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6008728,
           'avg_obj': 0.10115405,
           'box_loss': 3.010639,
           'class_loss': 3.6130695,
           'conf_loss': 6.494715,
           'precision50': 0.08366135,
           'recall50': 0.025331957},
     '4': {'avg_iou': 0.7067978,
           'avg_obj': 0.2273647,
           'box_loss': 2.8523223,
           'class_loss': 4.0917635,
           'conf_loss': 7.3659344,
           'precision50': 0.2568473,
           'recall50': 0.15503056},
     '5': {'avg_iou': 0.7690771,
           'avg_obj': 0.3781885,
           'box_loss': 1.563938,
           'class_loss': 2.7608612,
           'conf_loss': 4.158644,
           'precision50': 0.41801864,
           'recall50': 0.3757469},
     'global': {'total_loss': 35.911903},
     'learning_rate': 0.00131,
     'training_loss': 35.911903}
I0420 19:08:44.071497 139837058635584 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-30000.
I0420 20:10:46.191146 139837058635584 controller.py:425] train | step:  40000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6089745,
           'avg_obj': 0.11050549,
           'box_loss': 2.9479537,
           'class_loss': 3.3948574,
           'conf_loss': 6.418713,
           'precision50': 0.09366806,
           'recall50': 0.030808814},
     '4': {'avg_iou': 0.71638757,
           'avg_obj': 0.24609302,
           'box_loss': 2.7562563,
           'class_loss': 3.778794,
           'conf_loss': 7.1780963,
           'precision50': 0.26722816,
           'recall50': 0.17386146},
     '5': {'avg_iou': 0.77865887,
           'avg_obj': 0.40238407,
           'box_loss': 1.4981285,
           'class_loss': 2.5426977,
           'conf_loss': 3.9934547,
           'precision50': 0.42425585,
           'recall50': 0.403876},
     'global': {'total_loss': 34.508923},
     'learning_rate': 0.00131,
     'training_loss': 34.508923}
I0420 20:11:01.687510 139837058635584 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0420 20:15:18.901170 139837058635584 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0420 20:19:37.266418 139837058635584 controller.py:261]  eval | step:  40000 | eval time:  515.6 sec | output: 
    {'3': {'avg_iou': 0.46803033,
           'avg_obj': 0.14652148,
           'box_loss': 3.061868,
           'class_loss': 2.4636931,
           'conf_loss': 7.0364704,
           'precision50': 0.22716509,
           'recall50': 0.111517765},
     '4': {'avg_iou': 0.6722669,
           'avg_obj': 0.36004344,
           'box_loss': 2.480371,
           'class_loss': 2.0649734,
           'conf_loss': 5.9481483,
           'precision50': 0.3740601,
           'recall50': 0.35205215},
     '5': {'avg_iou': 0.74176013,
           'avg_obj': 0.5406766,
           'box_loss': 1.2746207,
           'class_loss': 1.1410661,
           'conf_loss': 2.8067853,
           'precision50': 0.4499426,
           'recall50': 0.5578697},
     'AP': 0.26442814,
     'AP50': 0.48396835,
     'AP75': 0.26401374,
     'APl': 0.38099855,
     'APm': 0.26299137,
     'APs': 0.090345114,
     'ARl': 0.57747954,
     'ARm': 0.4676892,
     'ARmax1': 0.24167185,
     'ARmax10': 0.4004642,
     'ARmax100': 0.4417905,
     'ARs': 0.22768937,
     'global': {'total_loss': 28.278},
     'validation_loss': 28.278}
I0420 20:19:53.601596 139837058635584 controller.py:211] train | step:  40000 | training until step 60000...
I0420 21:24:35.987214 139837058635584 controller.py:425] train | step:  50000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6152206,
           'avg_obj': 0.119987905,
           'box_loss': 2.9076464,
           'class_loss': 3.2555337,
           'conf_loss': 6.356063,
           'precision50': 0.10374315,
           'recall50': 0.03665032},
     '4': {'avg_iou': 0.72361153,
           'avg_obj': 0.26188338,
           'box_loss': 2.685475,
           'class_loss': 3.5780609,
           'conf_loss': 7.026623,
           'precision50': 0.27572837,
           'recall50': 0.18940306},
     '5': {'avg_iou': 0.7853232,
           'avg_obj': 0.41921854,
           'box_loss': 1.4544886,
           'class_loss': 2.404638,
           'conf_loss': 3.8861425,
           'precision50': 0.42833188,
           'recall50': 0.42287904},
     'global': {'total_loss': 33.55468},
     'learning_rate': 0.00131,
     'training_loss': 33.55468}
I0420 21:25:26.576603 139837058635584 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-50000.
I0420 22:33:08.547193 139837058635584 controller.py:425] train | step:  60000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6217117,
           'avg_obj': 0.12953034,
           'box_loss': 2.846729,
           'class_loss': 3.1278646,
           'conf_loss': 6.2587385,
           'precision50': 0.11458691,
           'recall50': 0.04283608},
     '4': {'avg_iou': 0.7300154,
           'avg_obj': 0.27627507,
           'box_loss': 2.6195574,
           'class_loss': 3.4206505,
           'conf_loss': 6.880935,
           'precision50': 0.28359184,
           'recall50': 0.20403375},
     '5': {'avg_iou': 0.7908466,
           'avg_obj': 0.43408662,
           'box_loss': 1.4162078,
           'class_loss': 2.290429,
           'conf_loss': 3.7844903,
           'precision50': 0.43171602,
           'recall50': 0.43947828},
     'global': {'total_loss': 32.64565},
     'learning_rate': 0.00131,
     'training_loss': 32.64565}
I0420 22:33:21.902973 139837058635584 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0420 22:37:37.099276 139837058635584 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0420 22:41:45.305408 139837058635584 controller.py:261]  eval | step:  60000 | eval time:  503.4 sec | output: 
    {'3': {'avg_iou': 0.4739313,
           'avg_obj': 0.1621302,
           'box_loss': 2.9844427,
           'class_loss': 2.2431862,
           'conf_loss': 6.878936,
           'precision50': 0.24142712,
           'recall50': 0.13092276},
     '4': {'avg_iou': 0.67947036,
           'avg_obj': 0.38617298,
           'box_loss': 2.399523,
           'class_loss': 1.853617,
           'conf_loss': 5.7361107,
           'precision50': 0.38160774,
           'recall50': 0.38240707},
     '5': {'avg_iou': 0.75008357,
           'avg_obj': 0.5692295,
           'box_loss': 1.2224264,
           'class_loss': 1.0223057,
           'conf_loss': 2.6846383,
           'precision50': 0.45012242,
           'recall50': 0.5896779},
     'AP': 0.2868997,
     'AP50': 0.5165187,
     'AP75': 0.28886354,
     'APl': 0.4119081,
     'APm': 0.29038987,
     'APs': 0.10081785,
     'ARl': 0.59957373,
     'ARm': 0.48841715,
     'ARmax1': 0.2529509,
     'ARmax10': 0.41829246,
     'ARmax100': 0.4603829,
     'ARs': 0.2482041,
     'global': {'total_loss': 27.02519},
     'validation_loss': 27.02519}

train | step:  20000 | training until step 40000...
train | step:  30000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6008728,
           'avg_obj': 0.10115405,
           'box_loss': 3.010639,
           'class_loss': 3.6130695,
           'conf_loss': 6.494715,
           'precision50': 0.08366135,
           'recall50': 0.025331957},
     '4': {'avg_iou': 0.7067978,
           'avg_obj': 0.2273647,
           'box_loss': 2.8523223,
           'class_loss': 4.0917635,
           'conf_loss': 7.3659344,
           'precision50': 0.2568473,
           'recall50': 0.15503056},
     '5': {'avg_iou': 0.7690771,
           'avg_obj': 0.3781885,
           'box_loss': 1.563938,
           'class_loss': 2.7608612,
           'conf_loss': 4.158644,
           'precision50': 0.41801864,
           'recall50': 0.3757469},
     'global': {'total_loss': 35.911903},
     'learning_rate': 0.00131,
     'training_loss': 35.911903}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-30000.
train | step:  40000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6089745,
           'avg_obj': 0.11050549,
           'box_loss': 2.9479537,
           'class_loss': 3.3948574,
           'conf_loss': 6.418713,
           'precision50': 0.09366806,
           'recall50': 0.030808814},
     '4': {'avg_iou': 0.71638757,
           'avg_obj': 0.24609302,
           'box_loss': 2.7562563,
           'class_loss': 3.778794,
           'conf_loss': 7.1780963,
           'precision50': 0.26722816,
           'recall50': 0.17386146},
     '5': {'avg_iou': 0.77865887,
           'avg_obj': 0.40238407,
           'box_loss': 1.4981285,
           'class_loss': 2.5426977,
           'conf_loss': 3.9934547,
           'precision50': 0.42425585,
           'recall50': 0.403876},
     'global': {'total_loss': 34.508923},
     'learning_rate': 0.00131,
     'training_loss': 34.508923}
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=184.68s).
Accumulating evaluation results...
DONE (t=17.06s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.264
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.484
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.264
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.090
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.263
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.381
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.242
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.400
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.442
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.228
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.468
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.577
 eval | step:  40000 | eval time:  515.6 sec | output: 
    {'3': {'avg_iou': 0.46803033,
           'avg_obj': 0.14652148,
           'box_loss': 3.061868,
           'class_loss': 2.4636931,
           'conf_loss': 7.0364704,
           'precision50': 0.22716509,
           'recall50': 0.111517765},
     '4': {'avg_iou': 0.6722669,
           'avg_obj': 0.36004344,
           'box_loss': 2.480371,
           'class_loss': 2.0649734,
           'conf_loss': 5.9481483,
           'precision50': 0.3740601,
           'recall50': 0.35205215},
     '5': {'avg_iou': 0.74176013,
           'avg_obj': 0.5406766,
           'box_loss': 1.2746207,
           'class_loss': 1.1410661,
           'conf_loss': 2.8067853,
           'precision50': 0.4499426,
           'recall50': 0.5578697},
     'AP': 0.26442814,
     'AP50': 0.48396835,
     'AP75': 0.26401374,
     'APl': 0.38099855,
     'APm': 0.26299137,
     'APs': 0.090345114,
     'ARl': 0.57747954,
     'ARm': 0.4676892,
     'ARmax1': 0.24167185,
     'ARmax10': 0.4004642,
     'ARmax100': 0.4417905,
     'ARs': 0.22768937,
     'global': {'total_loss': 28.278},
     'validation_loss': 28.278}
train | step:  40000 | training until step 60000...
train | step:  50000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6152206,
           'avg_obj': 0.119987905,
           'box_loss': 2.9076464,
           'class_loss': 3.2555337,
           'conf_loss': 6.356063,
           'precision50': 0.10374315,
           'recall50': 0.03665032},
     '4': {'avg_iou': 0.72361153,
           'avg_obj': 0.26188338,
           'box_loss': 2.685475,
           'class_loss': 3.5780609,
           'conf_loss': 7.026623,
           'precision50': 0.27572837,
           'recall50': 0.18940306},
     '5': {'avg_iou': 0.7853232,
           'avg_obj': 0.41921854,
           'box_loss': 1.4544886,
           'class_loss': 2.404638,
           'conf_loss': 3.8861425,
           'precision50': 0.42833188,
           'recall50': 0.42287904},
     'global': {'total_loss': 33.55468},
     'learning_rate': 0.00131,
     'training_loss': 33.55468}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-50000.
train | step:  60000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6217117,
           'avg_obj': 0.12953034,
           'box_loss': 2.846729,
           'class_loss': 3.1278646,
           'conf_loss': 6.2587385,
           'precision50': 0.11458691,
           'recall50': 0.04283608},
     '4': {'avg_iou': 0.7300154,
           'avg_obj': 0.27627507,
           'box_loss': 2.6195574,
           'class_loss': 3.4206505,
           'conf_loss': 6.880935,
           'precision50': 0.28359184,
           'recall50': 0.20403375},
     '5': {'avg_iou': 0.7908466,
           'avg_obj': 0.43408662,
           'box_loss': 1.4162078,
           'class_loss': 2.290429,
           'conf_loss': 3.7844903,
           'precision50': 0.43171602,
           'recall50': 0.43947828},
     'global': {'total_loss': 32.64565},
     'learning_rate': 0.00131,
     'training_loss': 32.64565}
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=175.48s).
Accumulating evaluation results...
DONE (t=16.96s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.287
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.517
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.289
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.101
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.290
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.412
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.253
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.418
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.460
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.248
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.488
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.600
 eval | step:  60000 | eval time:  503.4 sec | output: 
    {'3': {'avg_iou': 0.4739313,
           'avg_obj': 0.1621302,
           'box_loss': 2.9844427,
           'class_loss': 2.2431862,
           'conf_loss': 6.878936,
           'precision50': 0.24142712,
           'recall50': 0.13092276},
     '4': {'avg_iou': 0.67947036,
           'avg_obj': 0.38617298,
           'box_loss': 2.399523,
           'class_loss': 1.853617,
           'conf_loss': 5.7361107,
           'precision50': 0.38160774,
           'recall50': 0.38240707},
     '5': {'avg_iou': 0.75008357,
           'avg_obj': 0.5692295,
           'box_loss': 1.2224264,
           'class_loss': 1.0223057,
           'conf_loss': 2.6846383,
           'precision50': 0.45012242,
           'recall50': 0.5896779},
     'AP': 0.2868997,
     'AP50': 0.5165187,
     'AP75': 0.28886354,
     'APl': 0.4119081,
     'APm': 0.29038987,
     'APs': 0.10081785,
     'ARl': 0.59957373,
     'ARm': 0.48841715,
     'ARmax1': 0.2529509,
     'ARmax10': 0.41829246,
     'ARmax100': 0.4603829,
     'ARs': 0.2482041,
     'global': {'total_loss': 27.02519},
     'validation_loss': 27.02519}I0420 22:42:01.790110 139837058635584 controller.py:211] train | step:  60000 | training until step 80000...
I0420 23:47:58.114204 139837058635584 controller.py:425] train | step:  70000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.62615275,
           'avg_obj': 0.13719653,
           'box_loss': 2.816217,
           'class_loss': 3.0317454,
           'conf_loss': 6.21268,
           'precision50': 0.12210372,
           'recall50': 0.047821727},
     '4': {'avg_iou': 0.73476124,
           'avg_obj': 0.28661266,
           'box_loss': 2.5769322,
           'class_loss': 3.2986567,
           'conf_loss': 6.788506,
           'precision50': 0.2883252,
           'recall50': 0.21455425},
     '5': {'avg_iou': 0.79478437,
           'avg_obj': 0.44473705,
           'box_loss': 1.3914981,
           'class_loss': 2.2097876,
           'conf_loss': 3.7186198,
           'precision50': 0.43320993,
           'recall50': 0.45045844},
     'global': {'total_loss': 32.044655},
     'learning_rate': 0.00131,
     'training_loss': 32.044655}
I0420 23:48:48.746627 139837058635584 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-70000.
I0421 00:50:16.903971 139837058635584 controller.py:425] train | step:  80000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6300708,
           'avg_obj': 0.143682,
           'box_loss': 2.7928398,
           'class_loss': 2.9596996,
           'conf_loss': 6.17637,
           'precision50': 0.1279221,
           'recall50': 0.05215109},
     '4': {'avg_iou': 0.7387459,
           'avg_obj': 0.29627958,
           'box_loss': 2.540584,
           'class_loss': 3.1970356,
           'conf_loss': 6.7042494,
           'precision50': 0.2934656,
           'recall50': 0.22365017},
     '5': {'avg_iou': 0.7984627,
           'avg_obj': 0.45494074,
           'box_loss': 1.367204,
           'class_loss': 2.13689,
           'conf_loss': 3.6534872,
           'precision50': 0.43408424,
           'recall50': 0.4610533},
     'global': {'total_loss': 31.528341},
     'learning_rate': 0.00131,
     'training_loss': 31.528341}
I0421 00:50:31.066875 139837058635584 controller.py:252]  eval | step:  80000 | running 625 steps of evaluation...
I0421 00:54:46.457511 139837058635584 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0421 00:59:05.334571 139837058635584 controller.py:261]  eval | step:  80000 | eval time:  514.3 sec | output: 
    {'3': {'avg_iou': 0.4779517,
           'avg_obj': 0.17211327,
           'box_loss': 2.932339,
           'class_loss': 2.101002,
           'conf_loss': 6.774463,
           'precision50': 0.2536294,
           'recall50': 0.14510635},
     '4': {'avg_iou': 0.6833394,
           'avg_obj': 0.40481144,
           'box_loss': 2.3596847,
           'class_loss': 1.7062719,
           'conf_loss': 5.612091,
           'precision50': 0.3876973,
           'recall50': 0.4058302},
     '5': {'avg_iou': 0.7534421,
           'avg_obj': 0.58796966,
           'box_loss': 1.2007264,
           'class_loss': 0.94588643,
           'conf_loss': 2.627322,
           'precision50': 0.44423354,
           'recall50': 0.6061727},
     'AP': 0.29981193,
     'AP50': 0.53566146,
     'AP75': 0.30542117,
     'APl': 0.4332388,
     'APm': 0.30281162,
     'APs': 0.11093053,
     'ARl': 0.61161363,
     'ARm': 0.4991539,
     'ARmax1': 0.2614977,
     'ARmax10': 0.42780083,
     'ARmax100': 0.47083515,
     'ARs': 0.25967827,
     'global': {'total_loss': 26.25978},
     'validation_loss': 26.25978}
I0421 00:59:21.634693 139837058635584 controller.py:211] train | step:  80000 | training until step 100000...
I0421 02:01:38.557617 139837058635584 controller.py:425] train | step:  90000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6344217,
           'avg_obj': 0.15167674,
           'box_loss': 2.7534611,
           'class_loss': 2.892295,
           'conf_loss': 6.099688,
           'precision50': 0.13704574,
           'recall50': 0.057422694},
     '4': {'avg_iou': 0.7425688,
           'avg_obj': 0.30653077,
           'box_loss': 2.4978864,
           'class_loss': 3.1058507,
           'conf_loss': 6.5923834,
           'precision50': 0.2983177,
           'recall50': 0.23378347},
     '5': {'avg_iou': 0.80191946,
           'avg_obj': 0.46362972,
           'box_loss': 1.3398304,
           'class_loss': 2.0746684,
           'conf_loss': 3.5835028,
           'precision50': 0.4358909,
           'recall50': 0.47103745},
     'global': {'total_loss': 30.939428},
     'learning_rate': 0.00131,
     'training_loss': 30.939428}
I0421 02:02:29.334984 139837058635584 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-90000.
I0421 03:03:20.954627 139837058635584 controller.py:425] train | step:  100000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6392447,
           'avg_obj': 0.16163154,
           'box_loss': 2.7212517,
           'class_loss': 2.831558,
           'conf_loss': 6.0369415,
           'precision50': 0.14665225,
           'recall50': 0.06407398},
     '4': {'avg_iou': 0.7469759,
           'avg_obj': 0.31574997,
           'box_loss': 2.4574175,
           'class_loss': 3.0303483,
           'conf_loss': 6.505796,
           'precision50': 0.30195096,
           'recall50': 0.24232578},
     '5': {'avg_iou': 0.80461216,
           'avg_obj': 0.4713086,
           'box_loss': 1.3228433,
           'class_loss': 2.017913,
           'conf_loss': 3.537718,
           'precision50': 0.43541196,
           'recall50': 0.4790229},
     'global': {'total_loss': 30.46184},
     'learning_rate': 0.00131,
     'training_loss': 30.46184}
I0421 03:03:33.624184 139837058635584 controller.py:252]  eval | step:  100000 | running 625 steps of evaluation...
I0421 03:07:46.489268 139837058635584 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0421 03:12:10.442536 139837058635584 controller.py:261]  eval | step:  100000 | eval time:  516.8 sec | output: 
    {'3': {'avg_iou': 0.48258075,
           'avg_obj': 0.18316299,
           'box_loss': 2.8685327,
           'class_loss': 2.0085588,
           'conf_loss': 6.6746087,
           'precision50': 0.2593849,
           'recall50': 0.15906839},
     '4': {'avg_iou': 0.6918897,
           'avg_obj': 0.4197738,
           'box_loss': 2.2753985,
           'class_loss': 1.6297961,
           'conf_loss': 5.4670615,
           'precision50': 0.38889137,
           'recall50': 0.4194789},
     '5': {'avg_iou': 0.7608947,
           'avg_obj': 0.59807444,
           'box_loss': 1.158197,
           'class_loss': 0.9061955,
           'conf_loss': 2.539847,
           'precision50': 0.4477751,
           'recall50': 0.6160576},
     'AP': 0.31617704,
     'AP50': 0.55149955,
     'AP75': 0.32595047,
     'APl': 0.45150936,
     'APm': 0.32437664,
     'APs': 0.12305461,
     'ARl': 0.6214549,
     'ARm': 0.5156412,
     'ARmax1': 0.2725042,
     'ARmax10': 0.44283742,
     'ARmax100': 0.4850637,
     'ARs': 0.27598768,
     'global': {'total_loss': 25.528196},
     'validation_loss': 25.528196}

train | step:  60000 | training until step 80000...
train | step:  70000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.62615275,
           'avg_obj': 0.13719653,
           'box_loss': 2.816217,
           'class_loss': 3.0317454,
           'conf_loss': 6.21268,
           'precision50': 0.12210372,
           'recall50': 0.047821727},
     '4': {'avg_iou': 0.73476124,
           'avg_obj': 0.28661266,
           'box_loss': 2.5769322,
           'class_loss': 3.2986567,
           'conf_loss': 6.788506,
           'precision50': 0.2883252,
           'recall50': 0.21455425},
     '5': {'avg_iou': 0.79478437,
           'avg_obj': 0.44473705,
           'box_loss': 1.3914981,
           'class_loss': 2.2097876,
           'conf_loss': 3.7186198,
           'precision50': 0.43320993,
           'recall50': 0.45045844},
     'global': {'total_loss': 32.044655},
     'learning_rate': 0.00131,
     'training_loss': 32.044655}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-70000.
train | step:  80000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6300708,
           'avg_obj': 0.143682,
           'box_loss': 2.7928398,
           'class_loss': 2.9596996,
           'conf_loss': 6.17637,
           'precision50': 0.1279221,
           'recall50': 0.05215109},
     '4': {'avg_iou': 0.7387459,
           'avg_obj': 0.29627958,
           'box_loss': 2.540584,
           'class_loss': 3.1970356,
           'conf_loss': 6.7042494,
           'precision50': 0.2934656,
           'recall50': 0.22365017},
     '5': {'avg_iou': 0.7984627,
           'avg_obj': 0.45494074,
           'box_loss': 1.367204,
           'class_loss': 2.13689,
           'conf_loss': 3.6534872,
           'precision50': 0.43408424,
           'recall50': 0.4610533},
     'global': {'total_loss': 31.528341},
     'learning_rate': 0.00131,
     'training_loss': 31.528341}
 eval | step:  80000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=182.84s).
Accumulating evaluation results...
DONE (t=16.41s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.300
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.536
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.305
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.111
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.303
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.433
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.261
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.428
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.471
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.260
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.499
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.612
 eval | step:  80000 | eval time:  514.3 sec | output: 
    {'3': {'avg_iou': 0.4779517,
           'avg_obj': 0.17211327,
           'box_loss': 2.932339,
           'class_loss': 2.101002,
           'conf_loss': 6.774463,
           'precision50': 0.2536294,
           'recall50': 0.14510635},
     '4': {'avg_iou': 0.6833394,
           'avg_obj': 0.40481144,
           'box_loss': 2.3596847,
           'class_loss': 1.7062719,
           'conf_loss': 5.612091,
           'precision50': 0.3876973,
           'recall50': 0.4058302},
     '5': {'avg_iou': 0.7534421,
           'avg_obj': 0.58796966,
           'box_loss': 1.2007264,
           'class_loss': 0.94588643,
           'conf_loss': 2.627322,
           'precision50': 0.44423354,
           'recall50': 0.6061727},
     'AP': 0.29981193,
     'AP50': 0.53566146,
     'AP75': 0.30542117,
     'APl': 0.4332388,
     'APm': 0.30281162,
     'APs': 0.11093053,
     'ARl': 0.61161363,
     'ARm': 0.4991539,
     'ARmax1': 0.2614977,
     'ARmax10': 0.42780083,
     'ARmax100': 0.47083515,
     'ARs': 0.25967827,
     'global': {'total_loss': 26.25978},
     'validation_loss': 26.25978}
train | step:  80000 | training until step 100000...
train | step:  90000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6344217,
           'avg_obj': 0.15167674,
           'box_loss': 2.7534611,
           'class_loss': 2.892295,
           'conf_loss': 6.099688,
           'precision50': 0.13704574,
           'recall50': 0.057422694},
     '4': {'avg_iou': 0.7425688,
           'avg_obj': 0.30653077,
           'box_loss': 2.4978864,
           'class_loss': 3.1058507,
           'conf_loss': 6.5923834,
           'precision50': 0.2983177,
           'recall50': 0.23378347},
     '5': {'avg_iou': 0.80191946,
           'avg_obj': 0.46362972,
           'box_loss': 1.3398304,
           'class_loss': 2.0746684,
           'conf_loss': 3.5835028,
           'precision50': 0.4358909,
           'recall50': 0.47103745},
     'global': {'total_loss': 30.939428},
     'learning_rate': 0.00131,
     'training_loss': 30.939428}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-90000.
train | step:  100000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6392447,
           'avg_obj': 0.16163154,
           'box_loss': 2.7212517,
           'class_loss': 2.831558,
           'conf_loss': 6.0369415,
           'precision50': 0.14665225,
           'recall50': 0.06407398},
     '4': {'avg_iou': 0.7469759,
           'avg_obj': 0.31574997,
           'box_loss': 2.4574175,
           'class_loss': 3.0303483,
           'conf_loss': 6.505796,
           'precision50': 0.30195096,
           'recall50': 0.24232578},
     '5': {'avg_iou': 0.80461216,
           'avg_obj': 0.4713086,
           'box_loss': 1.3228433,
           'class_loss': 2.017913,
           'conf_loss': 3.537718,
           'precision50': 0.43541196,
           'recall50': 0.4790229},
     'global': {'total_loss': 30.46184},
     'learning_rate': 0.00131,
     'training_loss': 30.46184}
 eval | step:  100000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=185.46s).
Accumulating evaluation results...
DONE (t=18.25s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.316
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.551
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.326
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.123
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.324
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.452
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.273
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.443
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.276
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.516
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.621
 eval | step:  100000 | eval time:  516.8 sec | output: 
    {'3': {'avg_iou': 0.48258075,
           'avg_obj': 0.18316299,
           'box_loss': 2.8685327,
           'class_loss': 2.0085588,
           'conf_loss': 6.6746087,
           'precision50': 0.2593849,
           'recall50': 0.15906839},
     '4': {'avg_iou': 0.6918897,
           'avg_obj': 0.4197738,
           'box_loss': 2.2753985,
           'class_loss': 1.6297961,
           'conf_loss': 5.4670615,
           'precision50': 0.38889137,
           'recall50': 0.4194789},
     '5': {'avg_iou': 0.7608947,
           'avg_obj': 0.59807444,
           'box_loss': 1.158197,
           'class_loss': 0.9061955,
           'conf_loss': 2.539847,
           'precision50': 0.4477751,
           'recall50': 0.6160576},
     'AP': 0.31617704,
     'AP50': 0.55149955,
     'AP75': 0.32595047,
     'APl': 0.45150936,
     'APm': 0.32437664,
     'APs': 0.12305461,
     'ARl': 0.6214549,
     'ARm': 0.5156412,
     'ARmax1': 0.2725042,
     'ARmax10': 0.44283742,
     'ARmax100': 0.4850637,
     'ARs': 0.27598768,
     'global': {'total_loss': 25.528196},
     'validation_loss': 25.528196}I0421 03:12:27.015228 139837058635584 controller.py:211] train | step:  100000 | training until step 120000...
I0421 04:10:19.030082 139837058635584 controller.py:425] train | step:  110000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.64254886,
           'avg_obj': 0.16748506,
           'box_loss': 2.6996386,
           'class_loss': 2.7840393,
           'conf_loss': 6.003623,
           'precision50': 0.1524248,
           'recall50': 0.06831454},
     '4': {'avg_iou': 0.75002253,
           'avg_obj': 0.32327706,
           'box_loss': 2.4266014,
           'class_loss': 2.959895,
           'conf_loss': 6.4353385,
           'precision50': 0.30474564,
           'recall50': 0.24920833},
     '5': {'avg_iou': 0.8072721,
           'avg_obj': 0.47726938,
           'box_loss': 1.3054599,
           'class_loss': 1.9703767,
           'conf_loss': 3.4976563,
           'precision50': 0.4365336,
           'recall50': 0.4853725},
     'global': {'total_loss': 30.082571},
     'learning_rate': 0.00131,
     'training_loss': 30.082571}
I0421 04:11:12.689496 139837058635584 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-110000.
I0421 05:12:32.416318 139837058635584 controller.py:425] train | step:  120000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6458111,
           'avg_obj': 0.17207745,
           'box_loss': 2.6740565,
           'class_loss': 2.7382097,
           'conf_loss': 5.96548,
           'precision50': 0.15561655,
           'recall50': 0.0715608},
     '4': {'avg_iou': 0.7527791,
           'avg_obj': 0.32885858,
           'box_loss': 2.401455,
           'class_loss': 2.913028,
           'conf_loss': 6.384991,
           'precision50': 0.3061639,
           'recall50': 0.2544612},
     '5': {'avg_iou': 0.8094661,
           'avg_obj': 0.4836679,
           'box_loss': 1.2895501,
           'class_loss': 1.9338113,
           'conf_loss': 3.4531453,
           'precision50': 0.437341,
           'recall50': 0.4913753},
     'global': {'total_loss': 29.75371},
     'learning_rate': 0.00131,
     'training_loss': 29.75371}
I0421 05:12:45.063732 139837058635584 controller.py:252]  eval | step:  120000 | running 625 steps of evaluation...
I0421 05:17:04.679070 139837058635584 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0421 05:21:17.765321 139837058635584 controller.py:261]  eval | step:  120000 | eval time:  512.7 sec | output: 
    {'3': {'avg_iou': 0.48332876,
           'avg_obj': 0.1891671,
           'box_loss': 2.8486083,
           'class_loss': 1.9344443,
           'conf_loss': 6.6193204,
           'precision50': 0.26545644,
           'recall50': 0.16591986},
     '4': {'avg_iou': 0.6932862,
           'avg_obj': 0.42979306,
           'box_loss': 2.2571387,
           'class_loss': 1.5675278,
           'conf_loss': 5.390555,
           'precision50': 0.38908055,
           'recall50': 0.43282837},
     '5': {'avg_iou': 0.7621996,
           'avg_obj': 0.6085226,
           'box_loss': 1.1485851,
           'class_loss': 0.8715135,
           'conf_loss': 2.5085363,
           'precision50': 0.44230768,
           'recall50': 0.6253956},
     'AP': 0.32228544,
     'AP50': 0.5614725,
     'AP75': 0.3312641,
     'APl': 0.4601713,
     'APm': 0.3298295,
     'APs': 0.12876956,
     'ARl': 0.6272518,
     'ARm': 0.51861346,
     'ARmax1': 0.2744264,
     'ARmax10': 0.44587958,
     'ARmax100': 0.4883731,
     'ARs': 0.27572608,
     'global': {'total_loss': 25.14622},
     'validation_loss': 25.14622}
I0421 05:21:33.841463 139837058635584 controller.py:211] train | step:  120000 | training until step 140000...
I0421 06:21:28.986051 139837058635584 controller.py:425] train | step:  130000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.64771193,
           'avg_obj': 0.1758686,
           'box_loss': 2.6596713,
           'class_loss': 2.6975021,
           'conf_loss': 5.9386463,
           'precision50': 0.15896882,
           'recall50': 0.074528195},
     '4': {'avg_iou': 0.75494856,
           'avg_obj': 0.33419785,
           'box_loss': 2.3812099,
           'class_loss': 2.8604352,
           'conf_loss': 6.3361197,
           'precision50': 0.3083711,
           'recall50': 0.25983536},
     '5': {'avg_iou': 0.81145066,
           'avg_obj': 0.48906577,
           'box_loss': 1.2775537,
           'class_loss': 1.8974766,
           'conf_loss': 3.4216156,
           'precision50': 0.43800727,
           'recall50': 0.49671227},
     'global': {'total_loss': 29.470188},
     'learning_rate': 0.00131,
     'training_loss': 29.470188}
I0421 06:22:20.108218 139837058635584 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-130000.
I0421 07:26:04.920645 139837058635584 controller.py:425] train | step:  140000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6495816,
           'avg_obj': 0.17951697,
           'box_loss': 2.6460679,
           'class_loss': 2.661202,
           'conf_loss': 5.906126,
           'precision50': 0.1605708,
           'recall50': 0.07693979},
     '4': {'avg_iou': 0.7569387,
           'avg_obj': 0.33861077,
           'box_loss': 2.3558493,
           'class_loss': 2.8014388,
           'conf_loss': 6.2757163,
           'precision50': 0.3093415,
           'recall50': 0.26430628},
     '5': {'avg_iou': 0.81312644,
           'avg_obj': 0.49384838,
           'box_loss': 1.2643402,
           'class_loss': 1.8589436,
           'conf_loss': 3.383541,
           'precision50': 0.43771645,
           'recall50': 0.50187004},
     'global': {'total_loss': 29.15315},
     'learning_rate': 0.00131,
     'training_loss': 29.15315}
I0421 07:26:17.953883 139837058635584 controller.py:252]  eval | step:  140000 | running 625 steps of evaluation...
I0421 07:30:39.760732 139837058635584 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0421 07:34:48.239668 139837058635584 controller.py:261]  eval | step:  140000 | eval time:  510.3 sec | output: 
    {'3': {'avg_iou': 0.48878208,
           'avg_obj': 0.19812039,
           'box_loss': 2.7791746,
           'class_loss': 1.8769604,
           'conf_loss': 6.528549,
           'precision50': 0.26571077,
           'recall50': 0.17682204},
     '4': {'avg_iou': 0.7018974,
           'avg_obj': 0.44105482,
           'box_loss': 2.1586692,
           'class_loss': 1.516732,
           'conf_loss': 5.2661347,
           'precision50': 0.39409438,
           'recall50': 0.4462421},
     '5': {'avg_iou': 0.77154446,
           'avg_obj': 0.6140576,
           'box_loss': 1.0953872,
           'class_loss': 0.84223896,
           'conf_loss': 2.4237497,
           'precision50': 0.44848603,
           'recall50': 0.63099205},
     'AP': 0.33807838,
     'AP50': 0.56988895,
     'AP75': 0.3589375,
     'APl': 0.48273137,
     'APm': 0.3493207,
     'APs': 0.13633339,
     'ARl': 0.6453007,
     'ARm': 0.53987503,
     'ARmax1': 0.28349936,
     'ARmax10': 0.46179548,
     'ARmax100': 0.5049749,
     'ARs': 0.2899667,
     'global': {'total_loss': 24.487583},
     'validation_loss': 24.487583}

train | step:  100000 | training until step 120000...
train | step:  110000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.64254886,
           'avg_obj': 0.16748506,
           'box_loss': 2.6996386,
           'class_loss': 2.7840393,
           'conf_loss': 6.003623,
           'precision50': 0.1524248,
           'recall50': 0.06831454},
     '4': {'avg_iou': 0.75002253,
           'avg_obj': 0.32327706,
           'box_loss': 2.4266014,
           'class_loss': 2.959895,
           'conf_loss': 6.4353385,
           'precision50': 0.30474564,
           'recall50': 0.24920833},
     '5': {'avg_iou': 0.8072721,
           'avg_obj': 0.47726938,
           'box_loss': 1.3054599,
           'class_loss': 1.9703767,
           'conf_loss': 3.4976563,
           'precision50': 0.4365336,
           'recall50': 0.4853725},
     'global': {'total_loss': 30.082571},
     'learning_rate': 0.00131,
     'training_loss': 30.082571}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-110000.
train | step:  120000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6458111,
           'avg_obj': 0.17207745,
           'box_loss': 2.6740565,
           'class_loss': 2.7382097,
           'conf_loss': 5.96548,
           'precision50': 0.15561655,
           'recall50': 0.0715608},
     '4': {'avg_iou': 0.7527791,
           'avg_obj': 0.32885858,
           'box_loss': 2.401455,
           'class_loss': 2.913028,
           'conf_loss': 6.384991,
           'precision50': 0.3061639,
           'recall50': 0.2544612},
     '5': {'avg_iou': 0.8094661,
           'avg_obj': 0.4836679,
           'box_loss': 1.2895501,
           'class_loss': 1.9338113,
           'conf_loss': 3.4531453,
           'precision50': 0.437341,
           'recall50': 0.4913753},
     'global': {'total_loss': 29.75371},
     'learning_rate': 0.00131,
     'training_loss': 29.75371}
 eval | step:  120000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.73s).
Accumulating evaluation results...
DONE (t=19.47s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.322
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.561
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.331
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.129
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.330
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.460
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.274
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.446
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.488
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.276
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.519
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.627
 eval | step:  120000 | eval time:  512.7 sec | output: 
    {'3': {'avg_iou': 0.48332876,
           'avg_obj': 0.1891671,
           'box_loss': 2.8486083,
           'class_loss': 1.9344443,
           'conf_loss': 6.6193204,
           'precision50': 0.26545644,
           'recall50': 0.16591986},
     '4': {'avg_iou': 0.6932862,
           'avg_obj': 0.42979306,
           'box_loss': 2.2571387,
           'class_loss': 1.5675278,
           'conf_loss': 5.390555,
           'precision50': 0.38908055,
           'recall50': 0.43282837},
     '5': {'avg_iou': 0.7621996,
           'avg_obj': 0.6085226,
           'box_loss': 1.1485851,
           'class_loss': 0.8715135,
           'conf_loss': 2.5085363,
           'precision50': 0.44230768,
           'recall50': 0.6253956},
     'AP': 0.32228544,
     'AP50': 0.5614725,
     'AP75': 0.3312641,
     'APl': 0.4601713,
     'APm': 0.3298295,
     'APs': 0.12876956,
     'ARl': 0.6272518,
     'ARm': 0.51861346,
     'ARmax1': 0.2744264,
     'ARmax10': 0.44587958,
     'ARmax100': 0.4883731,
     'ARs': 0.27572608,
     'global': {'total_loss': 25.14622},
     'validation_loss': 25.14622}
train | step:  120000 | training until step 140000...
train | step:  130000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.64771193,
           'avg_obj': 0.1758686,
           'box_loss': 2.6596713,
           'class_loss': 2.6975021,
           'conf_loss': 5.9386463,
           'precision50': 0.15896882,
           'recall50': 0.074528195},
     '4': {'avg_iou': 0.75494856,
           'avg_obj': 0.33419785,
           'box_loss': 2.3812099,
           'class_loss': 2.8604352,
           'conf_loss': 6.3361197,
           'precision50': 0.3083711,
           'recall50': 0.25983536},
     '5': {'avg_iou': 0.81145066,
           'avg_obj': 0.48906577,
           'box_loss': 1.2775537,
           'class_loss': 1.8974766,
           'conf_loss': 3.4216156,
           'precision50': 0.43800727,
           'recall50': 0.49671227},
     'global': {'total_loss': 29.470188},
     'learning_rate': 0.00131,
     'training_loss': 29.470188}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-130000.
train | step:  140000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6495816,
           'avg_obj': 0.17951697,
           'box_loss': 2.6460679,
           'class_loss': 2.661202,
           'conf_loss': 5.906126,
           'precision50': 0.1605708,
           'recall50': 0.07693979},
     '4': {'avg_iou': 0.7569387,
           'avg_obj': 0.33861077,
           'box_loss': 2.3558493,
           'class_loss': 2.8014388,
           'conf_loss': 6.2757163,
           'precision50': 0.3093415,
           'recall50': 0.26430628},
     '5': {'avg_iou': 0.81312644,
           'avg_obj': 0.49384838,
           'box_loss': 1.2643402,
           'class_loss': 1.8589436,
           'conf_loss': 3.383541,
           'precision50': 0.43771645,
           'recall50': 0.50187004},
     'global': {'total_loss': 29.15315},
     'learning_rate': 0.00131,
     'training_loss': 29.15315}
 eval | step:  140000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=177.11s).
Accumulating evaluation results...
DONE (t=16.54s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.338
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.570
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.359
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.136
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.349
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.483
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.283
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.462
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.505
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.290
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.540
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.645
 eval | step:  140000 | eval time:  510.3 sec | output: 
    {'3': {'avg_iou': 0.48878208,
           'avg_obj': 0.19812039,
           'box_loss': 2.7791746,
           'class_loss': 1.8769604,
           'conf_loss': 6.528549,
           'precision50': 0.26571077,
           'recall50': 0.17682204},
     '4': {'avg_iou': 0.7018974,
           'avg_obj': 0.44105482,
           'box_loss': 2.1586692,
           'class_loss': 1.516732,
           'conf_loss': 5.2661347,
           'precision50': 0.39409438,
           'recall50': 0.4462421},
     '5': {'avg_iou': 0.77154446,
           'avg_obj': 0.6140576,
           'box_loss': 1.0953872,
           'class_loss': 0.84223896,
           'conf_loss': 2.4237497,
           'precision50': 0.44848603,
           'recall50': 0.63099205},
     'AP': 0.33807838,
     'AP50': 0.56988895,
     'AP75': 0.3589375,
     'APl': 0.48273137,
     'APm': 0.3493207,
     'APs': 0.13633339,
     'ARl': 0.6453007,
     'ARm': 0.53987503,
     'ARmax1': 0.28349936,
     'ARmax10': 0.46179548,
     'ARmax100': 0.5049749,
     'ARs': 0.2899667,
     'global': {'total_loss': 24.487583},
     'validation_loss': 24.487583}I0421 07:35:05.007574 139837058635584 controller.py:211] train | step:  140000 | training until step 160000...
I0421 08:30:14.097579 139837058635584 controller.py:425] train | step:  150000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.65190995,
           'avg_obj': 0.18279284,
           'box_loss': 2.6124675,
           'class_loss': 2.61394,
           'conf_loss': 5.8493037,
           'precision50': 0.16199535,
           'recall50': 0.07885278},
     '4': {'avg_iou': 0.7591832,
           'avg_obj': 0.34293947,
           'box_loss': 2.3304465,
           'class_loss': 2.7551599,
           'conf_loss': 6.226287,
           'precision50': 0.30978534,
           'recall50': 0.2674687},
     '5': {'avg_iou': 0.8147589,
           'avg_obj': 0.4985063,
           'box_loss': 1.2520186,
           'class_loss': 1.8299683,
           'conf_loss': 3.3516266,
           'precision50': 0.43775082,
           'recall50': 0.50597346},
     'global': {'total_loss': 28.82125},
     'learning_rate': 0.00131,
     'training_loss': 28.82125}
I0421 08:31:06.712322 139837058635584 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-150000.
I0421 09:31:02.949342 139837058635584 controller.py:425] train | step:  160000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6535475,
           'avg_obj': 0.18584515,
           'box_loss': 2.6141942,
           'class_loss': 2.5838118,
           'conf_loss': 5.85668,
           'precision50': 0.16509517,
           'recall50': 0.08123262},
     '4': {'avg_iou': 0.76069915,
           'avg_obj': 0.3473865,
           'box_loss': 2.32326,
           'class_loss': 2.7169778,
           'conf_loss': 6.2031693,
           'precision50': 0.3120604,
           'recall50': 0.27226913},
     '5': {'avg_iou': 0.8160199,
           'avg_obj': 0.50216043,
           'box_loss': 1.2447674,
           'class_loss': 1.801526,
           'conf_loss': 3.3284216,
           'precision50': 0.43887398,
           'recall50': 0.5106909},
     'global': {'total_loss': 28.67285},
     'learning_rate': 0.00131,
     'training_loss': 28.67285}
I0421 09:31:15.734463 139837058635584 controller.py:252]  eval | step:  160000 | running 625 steps of evaluation...
I0421 09:35:37.698227 139837058635584 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0421 09:40:02.217863 139837058635584 controller.py:261]  eval | step:  160000 | eval time:  526.5 sec | output: 
    {'3': {'avg_iou': 0.49132645,
           'avg_obj': 0.20310567,
           'box_loss': 2.7450516,
           'class_loss': 1.8466048,
           'conf_loss': 6.47891,
           'precision50': 0.2683509,
           'recall50': 0.18416809},
     '4': {'avg_iou': 0.70494205,
           'avg_obj': 0.44698766,
           'box_loss': 2.1280503,
           'class_loss': 1.4809854,
           'conf_loss': 5.2003803,
           'precision50': 0.39495173,
           'recall50': 0.45145687},
     '5': {'avg_iou': 0.77428836,
           'avg_obj': 0.617028,
           'box_loss': 1.0778127,
           'class_loss': 0.82588273,
           'conf_loss': 2.4015136,
           'precision50': 0.44950926,
           'recall50': 0.63382673},
     'AP': 0.34510624,
     'AP50': 0.57538146,
     'AP75': 0.36554983,
     'APl': 0.48892418,
     'APm': 0.35774052,
     'APs': 0.14001599,
     'ARl': 0.6481179,
     'ARm': 0.5436228,
     'ARmax1': 0.28789294,
     'ARmax10': 0.46749115,
     'ARmax100': 0.5102376,
     'ARs': 0.29918942,
     'global': {'total_loss': 24.185179},
     'validation_loss': 24.185179}
I0421 09:40:19.191003 139837058635584 controller.py:211] train | step:  160000 | training until step 180000...
I0421 10:36:22.178286 139837058635584 controller.py:425] train | step:  170000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6552164,
           'avg_obj': 0.18839477,
           'box_loss': 2.6029916,
           'class_loss': 2.5598466,
           'conf_loss': 5.840104,
           'precision50': 0.166015,
           'recall50': 0.08283088},
     '4': {'avg_iou': 0.76201963,
           'avg_obj': 0.350503,
           'box_loss': 2.3129287,
           'class_loss': 2.684951,
           'conf_loss': 6.1804957,
           'precision50': 0.31196922,
           'recall50': 0.27514142},
     '5': {'avg_iou': 0.8174637,
           'avg_obj': 0.50603604,
           'box_loss': 1.2356827,
           'class_loss': 1.7769334,
           'conf_loss': 3.3050203,
           'precision50': 0.4391211,
           'recall50': 0.5145159},
     'global': {'total_loss': 28.498909},
     'learning_rate': 0.00131,
     'training_loss': 28.498909}
I0421 10:37:12.538951 139837058635584 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-170000.
I0421 11:36:42.452181 139837058635584 controller.py:425] train | step:  180000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.65628755,
           'avg_obj': 0.19166136,
           'box_loss': 2.5926287,
           'class_loss': 2.5325356,
           'conf_loss': 5.812507,
           'precision50': 0.16838439,
           'recall50': 0.085053556},
     '4': {'avg_iou': 0.7635286,
           'avg_obj': 0.35423815,
           'box_loss': 2.2921925,
           'class_loss': 2.641441,
           'conf_loss': 6.127113,
           'precision50': 0.3125258,
           'recall50': 0.27857465},
     '5': {'avg_iou': 0.8186104,
           'avg_obj': 0.50976086,
           'box_loss': 1.226113,
           'class_loss': 1.7518231,
           'conf_loss': 3.2757337,
           'precision50': 0.43831635,
           'recall50': 0.5179736},
     'global': {'total_loss': 28.252037},
     'learning_rate': 0.00131,
     'training_loss': 28.252037}
I0421 11:36:56.065068 139837058635584 controller.py:252]  eval | step:  180000 | running 625 steps of evaluation...
I0421 11:41:12.063695 139837058635584 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0421 11:45:33.167683 139837058635584 controller.py:261]  eval | step:  180000 | eval time:  517.1 sec | output: 
    {'3': {'avg_iou': 0.49302843,
           'avg_obj': 0.20769247,
           'box_loss': 2.7186954,
           'class_loss': 1.8041576,
           'conf_loss': 6.440071,
           'precision50': 0.27093124,
           'recall50': 0.18795522},
     '4': {'avg_iou': 0.7077369,
           'avg_obj': 0.45521688,
           'box_loss': 2.095,
           'class_loss': 1.4619155,
           'conf_loss': 5.1604295,
           'precision50': 0.39265132,
           'recall50': 0.46144858},
     '5': {'avg_iou': 0.77629495,
           'avg_obj': 0.6236103,
           'box_loss': 1.0649632,
           'class_loss': 0.81109923,
           'conf_loss': 2.3823986,
           'precision50': 0.4437702,
           'recall50': 0.63990974},
     'AP': 0.34930262,
     'AP50': 0.5801926,
     'AP75': 0.36984184,
     'APl': 0.49542645,
     'APm': 0.36162785,
     'APs': 0.1438418,
     'ARl': 0.65431285,
     'ARm': 0.55094695,
     'ARmax1': 0.2901431,
     'ARmax10': 0.47380933,
     'ARmax100': 0.5155157,
     'ARs': 0.29505458,
     'global': {'total_loss': 23.938738},
     'validation_loss': 23.938738}

train | step:  140000 | training until step 160000...
train | step:  150000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.65190995,
           'avg_obj': 0.18279284,
           'box_loss': 2.6124675,
           'class_loss': 2.61394,
           'conf_loss': 5.8493037,
           'precision50': 0.16199535,
           'recall50': 0.07885278},
     '4': {'avg_iou': 0.7591832,
           'avg_obj': 0.34293947,
           'box_loss': 2.3304465,
           'class_loss': 2.7551599,
           'conf_loss': 6.226287,
           'precision50': 0.30978534,
           'recall50': 0.2674687},
     '5': {'avg_iou': 0.8147589,
           'avg_obj': 0.4985063,
           'box_loss': 1.2520186,
           'class_loss': 1.8299683,
           'conf_loss': 3.3516266,
           'precision50': 0.43775082,
           'recall50': 0.50597346},
     'global': {'total_loss': 28.82125},
     'learning_rate': 0.00131,
     'training_loss': 28.82125}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-150000.
train | step:  160000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6535475,
           'avg_obj': 0.18584515,
           'box_loss': 2.6141942,
           'class_loss': 2.5838118,
           'conf_loss': 5.85668,
           'precision50': 0.16509517,
           'recall50': 0.08123262},
     '4': {'avg_iou': 0.76069915,
           'avg_obj': 0.3473865,
           'box_loss': 2.32326,
           'class_loss': 2.7169778,
           'conf_loss': 6.2031693,
           'precision50': 0.3120604,
           'recall50': 0.27226913},
     '5': {'avg_iou': 0.8160199,
           'avg_obj': 0.50216043,
           'box_loss': 1.2447674,
           'class_loss': 1.801526,
           'conf_loss': 3.3284216,
           'precision50': 0.43887398,
           'recall50': 0.5106909},
     'global': {'total_loss': 28.67285},
     'learning_rate': 0.00131,
     'training_loss': 28.67285}
 eval | step:  160000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=186.85s).
Accumulating evaluation results...
DONE (t=18.25s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.345
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.575
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.366
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.140
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.358
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.489
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.288
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.467
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.510
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.299
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.544
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.648
 eval | step:  160000 | eval time:  526.5 sec | output: 
    {'3': {'avg_iou': 0.49132645,
           'avg_obj': 0.20310567,
           'box_loss': 2.7450516,
           'class_loss': 1.8466048,
           'conf_loss': 6.47891,
           'precision50': 0.2683509,
           'recall50': 0.18416809},
     '4': {'avg_iou': 0.70494205,
           'avg_obj': 0.44698766,
           'box_loss': 2.1280503,
           'class_loss': 1.4809854,
           'conf_loss': 5.2003803,
           'precision50': 0.39495173,
           'recall50': 0.45145687},
     '5': {'avg_iou': 0.77428836,
           'avg_obj': 0.617028,
           'box_loss': 1.0778127,
           'class_loss': 0.82588273,
           'conf_loss': 2.4015136,
           'precision50': 0.44950926,
           'recall50': 0.63382673},
     'AP': 0.34510624,
     'AP50': 0.57538146,
     'AP75': 0.36554983,
     'APl': 0.48892418,
     'APm': 0.35774052,
     'APs': 0.14001599,
     'ARl': 0.6481179,
     'ARm': 0.5436228,
     'ARmax1': 0.28789294,
     'ARmax10': 0.46749115,
     'ARmax100': 0.5102376,
     'ARs': 0.29918942,
     'global': {'total_loss': 24.185179},
     'validation_loss': 24.185179}
train | step:  160000 | training until step 180000...
train | step:  170000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6552164,
           'avg_obj': 0.18839477,
           'box_loss': 2.6029916,
           'class_loss': 2.5598466,
           'conf_loss': 5.840104,
           'precision50': 0.166015,
           'recall50': 0.08283088},
     '4': {'avg_iou': 0.76201963,
           'avg_obj': 0.350503,
           'box_loss': 2.3129287,
           'class_loss': 2.684951,
           'conf_loss': 6.1804957,
           'precision50': 0.31196922,
           'recall50': 0.27514142},
     '5': {'avg_iou': 0.8174637,
           'avg_obj': 0.50603604,
           'box_loss': 1.2356827,
           'class_loss': 1.7769334,
           'conf_loss': 3.3050203,
           'precision50': 0.4391211,
           'recall50': 0.5145159},
     'global': {'total_loss': 28.498909},
     'learning_rate': 0.00131,
     'training_loss': 28.498909}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-170000.
train | step:  180000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.65628755,
           'avg_obj': 0.19166136,
           'box_loss': 2.5926287,
           'class_loss': 2.5325356,
           'conf_loss': 5.812507,
           'precision50': 0.16838439,
           'recall50': 0.085053556},
     '4': {'avg_iou': 0.7635286,
           'avg_obj': 0.35423815,
           'box_loss': 2.2921925,
           'class_loss': 2.641441,
           'conf_loss': 6.127113,
           'precision50': 0.3125258,
           'recall50': 0.27857465},
     '5': {'avg_iou': 0.8186104,
           'avg_obj': 0.50976086,
           'box_loss': 1.226113,
           'class_loss': 1.7518231,
           'conf_loss': 3.2757337,
           'precision50': 0.43831635,
           'recall50': 0.5179736},
     'global': {'total_loss': 28.252037},
     'learning_rate': 0.00131,
     'training_loss': 28.252037}
 eval | step:  180000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=188.16s).
Accumulating evaluation results...
DONE (t=16.71s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.349
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.580
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.370
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.144
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.362
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.495
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.290
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.474
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.516
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.295
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.551
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.654
 eval | step:  180000 | eval time:  517.1 sec | output: 
    {'3': {'avg_iou': 0.49302843,
           'avg_obj': 0.20769247,
           'box_loss': 2.7186954,
           'class_loss': 1.8041576,
           'conf_loss': 6.440071,
           'precision50': 0.27093124,
           'recall50': 0.18795522},
     '4': {'avg_iou': 0.7077369,
           'avg_obj': 0.45521688,
           'box_loss': 2.095,
           'class_loss': 1.4619155,
           'conf_loss': 5.1604295,
           'precision50': 0.39265132,
           'recall50': 0.46144858},
     '5': {'avg_iou': 0.77629495,
           'avg_obj': 0.6236103,
           'box_loss': 1.0649632,
           'class_loss': 0.81109923,
           'conf_loss': 2.3823986,
           'precision50': 0.4437702,
           'recall50': 0.63990974},
     'AP': 0.34930262,
     'AP50': 0.5801926,
     'AP75': 0.36984184,
     'APl': 0.49542645,
     'APm': 0.36162785,
     'APs': 0.1438418,
     'ARl': 0.65431285,
     'ARm': 0.55094695,
     'ARmax1': 0.2901431,
     'ARmax10': 0.47380933,
     'ARmax100': 0.5155157,
     'ARs': 0.29505458,
     'global': {'total_loss': 23.938738},
     'validation_loss': 23.938738}I0421 11:45:50.101327 139837058635584 controller.py:211] train | step:  180000 | training until step 200000...
I0421 12:41:50.300436 139837058635584 controller.py:425] train | step:  190000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.65760547,
           'avg_obj': 0.19405814,
           'box_loss': 2.586533,
           'class_loss': 2.5122824,
           'conf_loss': 5.803865,
           'precision50': 0.16940345,
           'recall50': 0.08645527},
     '4': {'avg_iou': 0.76478654,
           'avg_obj': 0.35716012,
           'box_loss': 2.2831528,
           'class_loss': 2.6185653,
           'conf_loss': 6.109823,
           'precision50': 0.31355453,
           'recall50': 0.28145888},
     '5': {'avg_iou': 0.81954277,
           'avg_obj': 0.51314306,
           'box_loss': 1.2203424,
           'class_loss': 1.729099,
           'conf_loss': 3.2543547,
           'precision50': 0.4388515,
           'recall50': 0.52174264},
     'global': {'total_loss': 28.118},
     'learning_rate': 0.00131,
     'training_loss': 28.118}
I0421 12:42:44.836782 139837058635584 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-190000.
I0421 13:46:41.006219 139837058635584 controller.py:425] train | step:  200000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6589678,
           'avg_obj': 0.19609416,
           'box_loss': 2.57108,
           'class_loss': 2.4860327,
           'conf_loss': 5.778858,
           'precision50': 0.17086782,
           'recall50': 0.087779604},
     '4': {'avg_iou': 0.76610017,
           'avg_obj': 0.36012247,
           'box_loss': 2.2723699,
           'class_loss': 2.5908856,
           'conf_loss': 6.0864153,
           'precision50': 0.31417418,
           'recall50': 0.28377143},
     '5': {'avg_iou': 0.82074493,
           'avg_obj': 0.51592314,
           'box_loss': 1.2141974,
           'class_loss': 1.7088336,
           'conf_loss': 3.240292,
           'precision50': 0.43870708,
           'recall50': 0.5245781},
     'global': {'total_loss': 27.948969},
     'learning_rate': 0.00131,
     'training_loss': 27.948969}
I0421 13:46:53.554883 139837058635584 controller.py:252]  eval | step:  200000 | running 625 steps of evaluation...
I0421 13:51:20.090889 139837058635584 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0421 13:55:39.182609 139837058635584 controller.py:261]  eval | step:  200000 | eval time:  525.6 sec | output: 
    {'3': {'avg_iou': 0.49512446,
           'avg_obj': 0.21128462,
           'box_loss': 2.6955528,
           'class_loss': 1.7811913,
           'conf_loss': 6.4172864,
           'precision50': 0.26989186,
           'recall50': 0.19164355},
     '4': {'avg_iou': 0.71016616,
           'avg_obj': 0.4588598,
           'box_loss': 2.0653815,
           'class_loss': 1.4395567,
           'conf_loss': 5.116477,
           'precision50': 0.39234635,
           'recall50': 0.46347174},
     '5': {'avg_iou': 0.7792879,
           'avg_obj': 0.625944,
           'box_loss': 1.0477946,
           'class_loss': 0.79471433,
           'conf_loss': 2.3528407,
           'precision50': 0.44714794,
           'recall50': 0.64279974},
     'AP': 0.35476837,
     'AP50': 0.5846227,
     'AP75': 0.37651864,
     'APl': 0.50183666,
     'APm': 0.36759374,
     'APs': 0.14865011,
     'ARl': 0.65916306,
     'ARm': 0.5591018,
     'ARmax1': 0.2934219,
     'ARmax10': 0.4803403,
     'ARmax100': 0.5226472,
     'ARs': 0.31135073,
     'global': {'total_loss': 23.710787},
     'validation_loss': 23.710787}
I0421 13:55:58.566130 139837058635584 controller.py:211] train | step:  200000 | training until step 220000...
I0421 14:49:50.593314 139837058635584 controller.py:425] train | step:  210000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6597049,
           'avg_obj': 0.19744986,
           'box_loss': 2.5660875,
           'class_loss': 2.4561656,
           'conf_loss': 5.767452,
           'precision50': 0.17124029,
           'recall50': 0.08898327},
     '4': {'avg_iou': 0.7672444,
           'avg_obj': 0.36294433,
           'box_loss': 2.261083,
           'class_loss': 2.5636828,
           'conf_loss': 6.058821,
           'precision50': 0.31558585,
           'recall50': 0.28680533},
     '5': {'avg_iou': 0.8218303,
           'avg_obj': 0.5193656,
           'box_loss': 1.2080827,
           'class_loss': 1.6929611,
           'conf_loss': 3.22269,
           'precision50': 0.44048253,
           'recall50': 0.5276731},
     'global': {'total_loss': 27.79704},
     'learning_rate': 0.00131,
     'training_loss': 27.79704}
I0421 14:50:41.676092 139837058635584 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-210000.
I0421 15:50:05.124385 139837058635584 controller.py:425] train | step:  220000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6611655,
           'avg_obj': 0.19957256,
           'box_loss': 2.551603,
           'class_loss': 2.4336922,
           'conf_loss': 5.7442102,
           'precision50': 0.17274694,
           'recall50': 0.09033818},
     '4': {'avg_iou': 0.76837075,
           'avg_obj': 0.36561307,
           'box_loss': 2.2497928,
           'class_loss': 2.5331655,
           'conf_loss': 6.0313478,
           'precision50': 0.31566596,
           'recall50': 0.28921443},
     '5': {'avg_iou': 0.8228344,
           'avg_obj': 0.52185386,
           'box_loss': 1.2003562,
           'class_loss': 1.6751289,
           'conf_loss': 3.2030084,
           'precision50': 0.43942168,
           'recall50': 0.5300586},
     'global': {'total_loss': 27.622412},
     'learning_rate': 0.00131,
     'training_loss': 27.622412}
I0421 15:50:18.137900 139837058635584 controller.py:252]  eval | step:  220000 | running 625 steps of evaluation...
I0421 15:54:41.145540 139837058635584 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0421 15:58:57.295252 139837058635584 controller.py:261]  eval | step:  220000 | eval time:  519.2 sec | output: 
    {'3': {'avg_iou': 0.49555302,
           'avg_obj': 0.2142178,
           'box_loss': 2.6808176,
           'class_loss': 1.7543836,
           'conf_loss': 6.3870773,
           'precision50': 0.27095637,
           'recall50': 0.19550347},
     '4': {'avg_iou': 0.7112509,
           'avg_obj': 0.4640877,
           'box_loss': 2.059623,
           'class_loss': 1.424912,
           'conf_loss': 5.1011395,
           'precision50': 0.39168876,
           'recall50': 0.4713582},
     '5': {'avg_iou': 0.7796244,
           'avg_obj': 0.6305001,
           'box_loss': 1.0449182,
           'class_loss': 0.7819286,
           'conf_loss': 2.3497798,
           'precision50': 0.4413107,
           'recall50': 0.6461013},
     'AP': 0.35769612,
     'AP50': 0.5887975,
     'AP75': 0.38129833,
     'APl': 0.5069543,
     'APm': 0.37230885,
     'APs': 0.14829798,
     'ARl': 0.6641347,
     'ARm': 0.56194556,
     'ARmax1': 0.29416943,
     'ARmax10': 0.48307985,
     'ARmax100': 0.5253656,
     'ARs': 0.31013435,
     'global': {'total_loss': 23.58459},
     'validation_loss': 23.58459}

train | step:  180000 | training until step 200000...
train | step:  190000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.65760547,
           'avg_obj': 0.19405814,
           'box_loss': 2.586533,
           'class_loss': 2.5122824,
           'conf_loss': 5.803865,
           'precision50': 0.16940345,
           'recall50': 0.08645527},
     '4': {'avg_iou': 0.76478654,
           'avg_obj': 0.35716012,
           'box_loss': 2.2831528,
           'class_loss': 2.6185653,
           'conf_loss': 6.109823,
           'precision50': 0.31355453,
           'recall50': 0.28145888},
     '5': {'avg_iou': 0.81954277,
           'avg_obj': 0.51314306,
           'box_loss': 1.2203424,
           'class_loss': 1.729099,
           'conf_loss': 3.2543547,
           'precision50': 0.4388515,
           'recall50': 0.52174264},
     'global': {'total_loss': 28.118},
     'learning_rate': 0.00131,
     'training_loss': 28.118}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-190000.
train | step:  200000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6589678,
           'avg_obj': 0.19609416,
           'box_loss': 2.57108,
           'class_loss': 2.4860327,
           'conf_loss': 5.778858,
           'precision50': 0.17086782,
           'recall50': 0.087779604},
     '4': {'avg_iou': 0.76610017,
           'avg_obj': 0.36012247,
           'box_loss': 2.2723699,
           'class_loss': 2.5908856,
           'conf_loss': 6.0864153,
           'precision50': 0.31417418,
           'recall50': 0.28377143},
     '5': {'avg_iou': 0.82074493,
           'avg_obj': 0.51592314,
           'box_loss': 1.2141974,
           'class_loss': 1.7088336,
           'conf_loss': 3.240292,
           'precision50': 0.43870708,
           'recall50': 0.5245781},
     'global': {'total_loss': 27.948969},
     'learning_rate': 0.00131,
     'training_loss': 27.948969}
 eval | step:  200000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=185.97s).
Accumulating evaluation results...
DONE (t=14.79s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.355
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.585
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.377
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.149
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.368
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.502
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.293
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.480
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.523
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.311
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.559
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.659
 eval | step:  200000 | eval time:  525.6 sec | output: 
    {'3': {'avg_iou': 0.49512446,
           'avg_obj': 0.21128462,
           'box_loss': 2.6955528,
           'class_loss': 1.7811913,
           'conf_loss': 6.4172864,
           'precision50': 0.26989186,
           'recall50': 0.19164355},
     '4': {'avg_iou': 0.71016616,
           'avg_obj': 0.4588598,
           'box_loss': 2.0653815,
           'class_loss': 1.4395567,
           'conf_loss': 5.116477,
           'precision50': 0.39234635,
           'recall50': 0.46347174},
     '5': {'avg_iou': 0.7792879,
           'avg_obj': 0.625944,
           'box_loss': 1.0477946,
           'class_loss': 0.79471433,
           'conf_loss': 2.3528407,
           'precision50': 0.44714794,
           'recall50': 0.64279974},
     'AP': 0.35476837,
     'AP50': 0.5846227,
     'AP75': 0.37651864,
     'APl': 0.50183666,
     'APm': 0.36759374,
     'APs': 0.14865011,
     'ARl': 0.65916306,
     'ARm': 0.5591018,
     'ARmax1': 0.2934219,
     'ARmax10': 0.4803403,
     'ARmax100': 0.5226472,
     'ARs': 0.31135073,
     'global': {'total_loss': 23.710787},
     'validation_loss': 23.710787}
train | step:  200000 | training until step 220000...
train | step:  210000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6597049,
           'avg_obj': 0.19744986,
           'box_loss': 2.5660875,
           'class_loss': 2.4561656,
           'conf_loss': 5.767452,
           'precision50': 0.17124029,
           'recall50': 0.08898327},
     '4': {'avg_iou': 0.7672444,
           'avg_obj': 0.36294433,
           'box_loss': 2.261083,
           'class_loss': 2.5636828,
           'conf_loss': 6.058821,
           'precision50': 0.31558585,
           'recall50': 0.28680533},
     '5': {'avg_iou': 0.8218303,
           'avg_obj': 0.5193656,
           'box_loss': 1.2080827,
           'class_loss': 1.6929611,
           'conf_loss': 3.22269,
           'precision50': 0.44048253,
           'recall50': 0.5276731},
     'global': {'total_loss': 27.79704},
     'learning_rate': 0.00131,
     'training_loss': 27.79704}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-210000.
train | step:  220000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6611655,
           'avg_obj': 0.19957256,
           'box_loss': 2.551603,
           'class_loss': 2.4336922,
           'conf_loss': 5.7442102,
           'precision50': 0.17274694,
           'recall50': 0.09033818},
     '4': {'avg_iou': 0.76837075,
           'avg_obj': 0.36561307,
           'box_loss': 2.2497928,
           'class_loss': 2.5331655,
           'conf_loss': 6.0313478,
           'precision50': 0.31566596,
           'recall50': 0.28921443},
     '5': {'avg_iou': 0.8228344,
           'avg_obj': 0.52185386,
           'box_loss': 1.2003562,
           'class_loss': 1.6751289,
           'conf_loss': 3.2030084,
           'precision50': 0.43942168,
           'recall50': 0.5300586},
     'global': {'total_loss': 27.622412},
     'learning_rate': 0.00131,
     'training_loss': 27.622412}
 eval | step:  220000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=183.68s).
Accumulating evaluation results...
DONE (t=15.55s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.358
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.589
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.381
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.148
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.372
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.507
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.294
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.483
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.525
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.310
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.562
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.664
 eval | step:  220000 | eval time:  519.2 sec | output: 
    {'3': {'avg_iou': 0.49555302,
           'avg_obj': 0.2142178,
           'box_loss': 2.6808176,
           'class_loss': 1.7543836,
           'conf_loss': 6.3870773,
           'precision50': 0.27095637,
           'recall50': 0.19550347},
     '4': {'avg_iou': 0.7112509,
           'avg_obj': 0.4640877,
           'box_loss': 2.059623,
           'class_loss': 1.424912,
           'conf_loss': 5.1011395,
           'precision50': 0.39168876,
           'recall50': 0.4713582},
     '5': {'avg_iou': 0.7796244,
           'avg_obj': 0.6305001,
           'box_loss': 1.0449182,
           'class_loss': 0.7819286,
           'conf_loss': 2.3497798,
           'precision50': 0.4413107,
           'recall50': 0.6461013},
     'AP': 0.35769612,
     'AP50': 0.5887975,
     'AP75': 0.38129833,
     'APl': 0.5069543,
     'APm': 0.37230885,
     'APs': 0.14829798,
     'ARl': 0.6641347,
     'ARm': 0.56194556,
     'ARmax1': 0.29416943,
     'ARmax10': 0.48307985,
     'ARmax100': 0.5253656,
     'ARs': 0.31013435,
     'global': {'total_loss': 23.58459},
     'validation_loss': 23.58459}I0421 15:59:14.667168 139837058635584 controller.py:211] train | step:  220000 | training until step 240000...
I0421 16:49:47.881421 139837058635584 controller.py:425] train | step:  230000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6617787,
           'avg_obj': 0.20150587,
           'box_loss': 2.5493093,
           'class_loss': 2.4179134,
           'conf_loss': 5.734693,
           'precision50': 0.1731158,
           'recall50': 0.09174447},
     '4': {'avg_iou': 0.7693915,
           'avg_obj': 0.3680598,
           'box_loss': 2.2346957,
           'class_loss': 2.5044067,
           'conf_loss': 5.994785,
           'precision50': 0.31629387,
           'recall50': 0.29182076},
     '5': {'avg_iou': 0.82353574,
           'avg_obj': 0.52466345,
           'box_loss': 1.1942444,
           'class_loss': 1.6555951,
           'conf_loss': 3.1807725,
           'precision50': 0.44008213,
           'recall50': 0.5332066},
     'global': {'total_loss': 27.466341},
     'learning_rate': 0.00131,
     'training_loss': 27.466341}
I0421 16:50:40.223573 139837058635584 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-230000.
I0421 17:49:25.867974 139837058635584 controller.py:425] train | step:  240000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6628866,
           'avg_obj': 0.20440271,
           'box_loss': 2.5454814,
           'class_loss': 2.4059281,
           'conf_loss': 5.724066,
           'precision50': 0.1751473,
           'recall50': 0.09379726},
     '4': {'avg_iou': 0.77036506,
           'avg_obj': 0.37175316,
           'box_loss': 2.230073,
           'class_loss': 2.4885936,
           'conf_loss': 5.9703493,
           'precision50': 0.3170695,
           'recall50': 0.29509258},
     '5': {'avg_iou': 0.82436514,
           'avg_obj': 0.5268767,
           'box_loss': 1.1875829,
           'class_loss': 1.6373925,
           'conf_loss': 3.1622372,
           'precision50': 0.43877357,
           'recall50': 0.535047},
     'global': {'total_loss': 27.35174},
     'learning_rate': 0.00131,
     'training_loss': 27.35174}
I0421 17:49:38.429034 139837058635584 controller.py:252]  eval | step:  240000 | running 625 steps of evaluation...
I0421 17:54:01.206666 139837058635584 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
/home/cam2tensorflow/.experiment_start.sh: line 22: 14243 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   233    0     2  100   231      7    878 --:--:-- --:--:-- --:--:--   885
okRequest issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-21T18:00:03.468901422Z'
  endTime: '2021-04-21T18:00:57.369800074Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619028003452-5c07f5506f7e7-594f17ed-c6ddc863
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619028003452-5c07f5506f7e7-594f17ed-c6ddc863] to complete...
............................................................................................................................................................................................................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-21T18:22:04.795481711Z'
  endTime: '2021-04-21T18:22:42.879743544Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619029324781-5c07fa3c8d864-75eb03fc-fe732048
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619029324781-5c07fa3c8d864-75eb03fc-fe732048] to complete...
......................................................................................................................................................................................................done.
europe-west4-a
I0421 18:20:46.336550 140713659025216 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 20.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 2.4,
                                    'aug_scale_min': 0.1,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.6,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.213,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 0.5,
                                         'aug_rand_hue': 0.15,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 2.0,
                                         'aug_scale_min': 0.1,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.6,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.75, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.001},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [400000,
                                                                                450000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00131,
                                                                            0.000131,
                                                                            1.31e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 2000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 500500,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0421 18:20:46.337921 140713659025216 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/params.yaml
I0421 18:20:47.234764 140713659025216 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0421 18:20:47.858595 140713659025216 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0421 18:20:47.858938 140713659025216 transport.py:157] Attempting refresh to obtain initial access_token
I0421 18:20:47.933506 140713659025216 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0421 18:20:48.562463 140713659025216 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0421 18:20:48.563647 140713659025216 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-21 18:20:48.668165: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0421 18:20:48.672704 140713659025216 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0421 18:20:49.371687 140713659025216 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0421 18:20:49.376982 140713659025216 transport.py:157] Attempting refresh to obtain initial access_token
I0421 18:20:49.508691 140713659025216 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0421 18:20:50.165954 140713659025216 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0421 18:20:50.168469 140713659025216 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-21 18:20:50.256412: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-21 18:20:50.309565: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-21 18:20:50.309750: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:31995}
2021-04-21 18:21:16.284109: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-21 18:21:16.284225: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:31995}
2021-04-21 18:21:16.284913: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:31995
I0421 18:21:16.286662 140713659025216 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-6
I0421 18:21:16.287331 140713659025216 tpu_strategy_util.py:74] Initializing the TPU system: node-6
INFO:tensorflow:Clearing out eager caches
I0421 18:21:24.525047 140713659025216 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0421 18:21:24.527277 140713659025216 tpu_strategy_util.py:133] Finished initializing TPU system.
I0421 18:21:24.531731 140713659025216 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0421 18:21:25.175415 140713659025216 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0421 18:21:25.175714 140713659025216 transport.py:157] Attempting refresh to obtain initial access_token
I0421 18:21:25.344920 140713659025216 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0421 18:21:25.966413 140713659025216 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0421 18:21:25.966731 140713659025216 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0421 18:21:26.018735 140713659025216 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0421 18:21:26.019072 140713659025216 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0421 18:21:26.019524 140713659025216 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0421 18:21:26.019686 140713659025216 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0421 18:21:26.019794 140713659025216 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0421 18:21:26.020159 140713659025216 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0421 18:21:26.020263 140713659025216 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0421 18:21:26.020372 140713659025216 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0421 18:21:26.020483 140713659025216 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0421 18:21:26.020594 140713659025216 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0421 18:21:26.020740 140713659025216 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0421 18:21:26.020837 140713659025216 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0421 18:21:26.020976 140713659025216 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0421 18:21:26.021080 140713659025216 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0421 18:21:26.021183 140713659025216 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0421 18:21:26.021274 140713659025216 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0421 18:21:26.023481 140713659025216 train_utils.py:214] Running default trainer.
2021-04-21 18:21:26.169135: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_scale_min': 0.1, 'aug_scale_max': 2.4, 'aug_rand_angle': 20.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.15, 'aug_scale_min': 0.1, 'aug_scale_max': 2.0, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.75, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': False}}}, 'weight_decay': 0.001, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [400000, 450000], 'values': [0.00131, 0.000131, 1.31e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 2000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 500500, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05} 0.0005
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7ffa0c54e2e8>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________
yolo_fpn (YoloFPN)              {'5': (None, 16, 16, 15165440    input_2[0][0]                    
                                                                 input_3[0][0]                    
                                                                 input_4[0][0]                    I0421 18:22:25.917332 140713659025216 controller.py:362] restoring or initializing model...
I0421 18:22:46.831113 140713659025216 controller.py:366] restored model from gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-230000.
I0421 18:22:46.831597 140713659025216 controller.py:192] restored from checkpoint: gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-230000
I0421 18:22:46.831815 140713659025216 train_lib.py:96] Starts to execute mode: train_and_eval
I0421 18:22:46.836040 140713659025216 controller.py:211] train | step:  230000 | training until step 250000...
I0421 18:22:53.039076 140713659025216 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0421 18:24:01.887365 140713659025216 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0421 19:28:56.961220 140713659025216 controller.py:425] train | step:  240000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.66555756,
           'avg_obj': 0.19861259,
           'box_loss': 2.4264624,
           'class_loss': 2.2441332,
           'conf_loss': 5.5591784,
           'precision50': 0.16750206,
           'recall50': 0.08935444},
     '4': {'avg_iou': 0.76982224,
           'avg_obj': 0.36479965,
           'box_loss': 2.2421958,
           'class_loss': 2.4699922,
           'conf_loss': 6.054801,
           'precision50': 0.31137842,
           'recall50': 0.28698635},
     '5': {'avg_iou': 0.8246,
           'avg_obj': 0.5269123,
           'box_loss': 1.2212979,
           'class_loss': 1.6831146,
           'conf_loss': 3.2542515,
           'precision50': 0.4372833,
           'recall50': 0.53459644},
     'global': {'total_loss': 27.155476},
     'learning_rate': 0.00131,
     'training_loss': 27.155476}
I0421 20:34:37.893684 140713659025216 controller.py:425] train | step:  250000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6667771,
           'avg_obj': 0.20015179,
           'box_loss': 2.4088492,
           'class_loss': 2.2104328,
           'conf_loss': 5.521022,
           'precision50': 0.1677,
           'recall50': 0.090525284},
     '4': {'avg_iou': 0.7707019,
           'avg_obj': 0.36701778,
           'box_loss': 2.2238095,
           'class_loss': 2.441063,
           'conf_loss': 6.010489,
           'precision50': 0.31080672,
           'recall50': 0.28886372},
     '5': {'avg_iou': 0.8251739,
           'avg_obj': 0.5286417,
           'box_loss': 1.2139097,
           'class_loss': 1.6623418,
           'conf_loss': 3.2352018,
           'precision50': 0.43684894,
           'recall50': 0.5357189},
     'global': {'total_loss': 26.927097},
     'learning_rate': 0.00131,
     'training_loss': 26.927097}
I0421 20:35:30.141158 140713659025216 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-250000.
I0421 20:35:30.147464 140713659025216 controller.py:252]  eval | step:  250000 | running 625 steps of evaluation...
I0421 20:35:31.041613 140713659025216 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0421 20:35:47.560690 140713659025216 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0421 20:40:46.889927 140713659025216 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0421 20:44:53.028549 140713659025216 controller.py:261]  eval | step:  250000 | eval time:  562.9 sec | output: 
    {'3': {'avg_iou': 0.49797294,
           'avg_obj': 0.21971579,
           'box_loss': 2.6558561,
           'class_loss': 1.7403986,
           'conf_loss': 6.3451014,
           'precision50': 0.26956248,
           'recall50': 0.2019811},
     '4': {'avg_iou': 0.71367073,
           'avg_obj': 0.47021475,
           'box_loss': 2.0290134,
           'class_loss': 1.4048544,
           'conf_loss': 5.048957,
           'precision50': 0.39232555,
           'recall50': 0.47861192},
     '5': {'avg_iou': 0.78236157,
           'avg_obj': 0.6350425,
           'box_loss': 1.0285891,
           'class_loss': 0.775148,
           'conf_loss': 2.3315518,
           'precision50': 0.44141024,
           'recall50': 0.6509144},
     'AP': 0.36357284,
     'AP50': 0.5921508,
     'AP75': 0.38706422,
     'APl': 0.5095106,
     'APm': 0.38042402,
     'APs': 0.1532711,
     'ARl': 0.6648067,
     'ARm': 0.5655595,
     'ARmax1': 0.29755342,
     'ARmax10': 0.48773202,
     'ARmax100': 0.5291852,
     'ARs': 0.3120333,
     'global': {'total_loss': 23.359472},
     'validation_loss': 23.359472}

__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'3': (None, 64, 64, 22153728    yolo_fpn[0][0]                   
                                                                 yolo_fpn[0][1]                   
                                                                 yolo_fpn[0][2]                   
==================================================================================================
Total params: 37,319,168
Trainable params: 37,288,192
Non-trainable params: 30,976
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 37319168  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 64,488,640
Trainable params: 64,422,336
Non-trainable params: 66,304
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 200, 8), 4: (8, 200, 8), 5: (8, 200, 8)}, inds: {3: (8, 200, 3), 4: (8, 200, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
restored model from gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-230000.
restored from checkpoint: gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-230000
train | step:  230000 | training until step 250000...
train | step:  240000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.66555756,
           'avg_obj': 0.19861259,
           'box_loss': 2.4264624,
           'class_loss': 2.2441332,
           'conf_loss': 5.5591784,
           'precision50': 0.16750206,
           'recall50': 0.08935444},
     '4': {'avg_iou': 0.76982224,
           'avg_obj': 0.36479965,
           'box_loss': 2.2421958,
           'class_loss': 2.4699922,
           'conf_loss': 6.054801,
           'precision50': 0.31137842,
           'recall50': 0.28698635},
     '5': {'avg_iou': 0.8246,
           'avg_obj': 0.5269123,
           'box_loss': 1.2212979,
           'class_loss': 1.6831146,
           'conf_loss': 3.2542515,
           'precision50': 0.4372833,
           'recall50': 0.53459644},
     'global': {'total_loss': 27.155476},
     'learning_rate': 0.00131,
     'training_loss': 27.155476}
train | step:  250000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6667771,
           'avg_obj': 0.20015179,
           'box_loss': 2.4088492,
           'class_loss': 2.2104328,
           'conf_loss': 5.521022,
           'precision50': 0.1677,
           'recall50': 0.090525284},
     '4': {'avg_iou': 0.7707019,
           'avg_obj': 0.36701778,
           'box_loss': 2.2238095,
           'class_loss': 2.441063,
           'conf_loss': 6.010489,
           'precision50': 0.31080672,
           'recall50': 0.28886372},
     '5': {'avg_iou': 0.8251739,
           'avg_obj': 0.5286417,
           'box_loss': 1.2139097,
           'class_loss': 1.6623418,
           'conf_loss': 3.2352018,
           'precision50': 0.43684894,
           'recall50': 0.5357189},
     'global': {'total_loss': 26.927097},
     'learning_rate': 0.00131,
     'training_loss': 26.927097}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-250000.
 eval | step:  250000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=177.33s).
Accumulating evaluation results...
DONE (t=15.12s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.364
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.592
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.387
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.153
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.380
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.510
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.298
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.488
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.529
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.312
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.566
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.665
 eval | step:  250000 | eval time:  562.9 sec | output: 
    {'3': {'avg_iou': 0.49797294,
           'avg_obj': 0.21971579,
           'box_loss': 2.6558561,
           'class_loss': 1.7403986,
           'conf_loss': 6.3451014,
           'precision50': 0.26956248,
           'recall50': 0.2019811},
     '4': {'avg_iou': 0.71367073,
           'avg_obj': 0.47021475,
           'box_loss': 2.0290134,
           'class_loss': 1.4048544,
           'conf_loss': 5.048957,
           'precision50': 0.39232555,
           'recall50': 0.47861192},
     '5': {'avg_iou': 0.78236157,
           'avg_obj': 0.6350425,
           'box_loss': 1.0285891,
           'class_loss': 0.775148,
           'conf_loss': 2.3315518,
           'precision50': 0.44141024,
           'recall50': 0.6509144},
     'AP': 0.36357284,
     'AP50': 0.5921508,
     'AP75': 0.38706422,
     'APl': 0.5095106,
     'APm': 0.38042402,
     'APs': 0.1532711,
     'ARl': 0.6648067,
     'ARm': 0.5655595,
     'ARmax1': 0.29755342,
     'ARmax10': 0.48773202,
     'ARmax100': 0.5291852,
     'ARs': 0.3120333,
     'global': {'total_loss': 23.359472},
     'validation_loss': 23.359472}I0421 20:45:11.778305 140713659025216 controller.py:211] train | step:  250000 | training until step 270000...
I0421 21:46:59.290016 140713659025216 controller.py:425] train | step:  260000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.667253,
           'avg_obj': 0.20165254,
           'box_loss': 2.414119,
           'class_loss': 2.2076368,
           'conf_loss': 5.5308285,
           'precision50': 0.16893493,
           'recall50': 0.09151233},
     '4': {'avg_iou': 0.77147615,
           'avg_obj': 0.3689741,
           'box_loss': 2.2241845,
           'class_loss': 2.4279144,
           'conf_loss': 6.0107675,
           'precision50': 0.31215182,
           'recall50': 0.29085106},
     '5': {'avg_iou': 0.8260337,
           'avg_obj': 0.53144884,
           'box_loss': 1.2105845,
           'class_loss': 1.6524912,
           'conf_loss': 3.2226264,
           'precision50': 0.4376213,
           'recall50': 0.53902906},
     'global': {'total_loss': 26.901155},
     'learning_rate': 0.00131,
     'training_loss': 26.901155}
I0421 22:52:45.569066 140713659025216 controller.py:425] train | step:  270000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6680182,
           'avg_obj': 0.20407365,
           'box_loss': 2.4094226,
           'class_loss': 2.1928477,
           'conf_loss': 5.5194926,
           'precision50': 0.17025271,
           'recall50': 0.09325885},
     '4': {'avg_iou': 0.77255225,
           'avg_obj': 0.37292877,
           'box_loss': 2.2151675,
           'class_loss': 2.405251,
           'conf_loss': 5.9790006,
           'precision50': 0.31306782,
           'recall50': 0.2948403},
     '5': {'avg_iou': 0.8268507,
           'avg_obj': 0.5346684,
           'box_loss': 1.2045746,
           'class_loss': 1.6314795,
           'conf_loss': 3.1993663,
           'precision50': 0.4372044,
           'recall50': 0.54142076},
     'global': {'total_loss': 26.756603},
     'learning_rate': 0.00131,
     'training_loss': 26.756603}
I0421 22:53:37.295143 140713659025216 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-270000.
I0421 22:53:37.302900 140713659025216 controller.py:252]  eval | step:  270000 | running 625 steps of evaluation...
I0421 22:57:54.984227 140713659025216 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0421 23:02:18.887588 140713659025216 controller.py:261]  eval | step:  270000 | eval time:  521.6 sec | output: 
    {'3': {'avg_iou': 0.4984808,
           'avg_obj': 0.22128533,
           'box_loss': 2.6468272,
           'class_loss': 1.7278125,
           'conf_loss': 6.3278255,
           'precision50': 0.27371654,
           'recall50': 0.20491964},
     '4': {'avg_iou': 0.7147095,
           'avg_obj': 0.47574863,
           'box_loss': 2.0214543,
           'class_loss': 1.3883212,
           'conf_loss': 5.026405,
           'precision50': 0.388214,
           'recall50': 0.4849744},
     '5': {'avg_iou': 0.7831639,
           'avg_obj': 0.6401732,
           'box_loss': 1.0243306,
           'class_loss': 0.7709971,
           'conf_loss': 2.3206623,
           'precision50': 0.43882212,
           'recall50': 0.6583651},
     'AP': 0.36433092,
     'AP50': 0.5923707,
     'AP75': 0.39002645,
     'APl': 0.51065576,
     'APm': 0.3818075,
     'APs': 0.15700856,
     'ARl': 0.6665466,
     'ARm': 0.56672066,
     'ARmax1': 0.29774818,
     'ARmax10': 0.48844078,
     'ARmax100': 0.5302626,
     'ARs': 0.31732318,
     'global': {'total_loss': 23.254656},
     'validation_loss': 23.254656}
I0421 23:02:35.510452 140713659025216 controller.py:211] train | step:  270000 | training until step 290000...
I0422 00:02:48.110326 140713659025216 controller.py:425] train | step:  280000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6689548,
           'avg_obj': 0.20505652,
           'box_loss': 2.395025,
           'class_loss': 2.1690001,
           'conf_loss': 5.49501,
           'precision50': 0.16992427,
           'recall50': 0.09343356},
     '4': {'avg_iou': 0.77326983,
           'avg_obj': 0.3735051,
           'box_loss': 2.2023122,
           'class_loss': 2.3837004,
           'conf_loss': 5.9539623,
           'precision50': 0.3128518,
           'recall50': 0.2947959},
     '5': {'avg_iou': 0.827471,
           'avg_obj': 0.53646487,
           'box_loss': 1.198897,
           'class_loss': 1.6191465,
           'conf_loss': 3.18474,
           'precision50': 0.4376186,
           'recall50': 0.54360133},
     'global': {'total_loss': 26.601843},
     'learning_rate': 0.00131,
     'training_loss': 26.601843}
I0422 01:04:39.058993 140713659025216 controller.py:425] train | step:  290000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.66936815,
           'avg_obj': 0.20625508,
           'box_loss': 2.392583,
           'class_loss': 2.1563687,
           'conf_loss': 5.489396,
           'precision50': 0.1704124,
           'recall50': 0.09452046},
     '4': {'avg_iou': 0.77396375,
           'avg_obj': 0.37586913,
           'box_loss': 2.1999092,
           'class_loss': 2.3643653,
           'conf_loss': 5.943681,
           'precision50': 0.313416,
           'recall50': 0.2978891},
     '5': {'avg_iou': 0.8280045,
           'avg_obj': 0.5383025,
           'box_loss': 1.1959496,
           'class_loss': 1.6043054,
           'conf_loss': 3.1743612,
           'precision50': 0.43764794,
           'recall50': 0.5459428},
     'global': {'total_loss': 26.520903},
     'learning_rate': 0.00131,
     'training_loss': 26.520903}
I0422 01:05:30.295902 140713659025216 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-290000.
I0422 01:05:30.302810 140713659025216 controller.py:252]  eval | step:  290000 | running 625 steps of evaluation...
I0422 01:09:42.157547 140713659025216 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0422 01:13:55.440034 140713659025216 controller.py:261]  eval | step:  290000 | eval time:  505.1 sec | output: 
    {'3': {'avg_iou': 0.49895835,
           'avg_obj': 0.22278436,
           'box_loss': 2.640175,
           'class_loss': 1.7248129,
           'conf_loss': 6.320254,
           'precision50': 0.2749066,
           'recall50': 0.20766333},
     '4': {'avg_iou': 0.7151913,
           'avg_obj': 0.4764135,
           'box_loss': 2.0117939,
           'class_loss': 1.3856381,
           'conf_loss': 5.0391765,
           'precision50': 0.38630697,
           'recall50': 0.48362958},
     '5': {'avg_iou': 0.78304744,
           'avg_obj': 0.6417021,
           'box_loss': 1.024492,
           'class_loss': 0.76149434,
           'conf_loss': 2.3326678,
           'precision50': 0.43588495,
           'recall50': 0.6586052},
     'AP': 0.36569262,
     'AP50': 0.59527165,
     'AP75': 0.39233822,
     'APl': 0.51114297,
     'APm': 0.38360655,
     'APs': 0.15905432,
     'ARl': 0.66809946,
     'ARm': 0.5706128,
     'ARmax1': 0.2991874,
     'ARmax10': 0.48958662,
     'ARmax100': 0.53253925,
     'ARs': 0.3238795,
     'global': {'total_loss': 23.240515},
     'validation_loss': 23.240515}

train | step:  250000 | training until step 270000...
train | step:  260000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.667253,
           'avg_obj': 0.20165254,
           'box_loss': 2.414119,
           'class_loss': 2.2076368,
           'conf_loss': 5.5308285,
           'precision50': 0.16893493,
           'recall50': 0.09151233},
     '4': {'avg_iou': 0.77147615,
           'avg_obj': 0.3689741,
           'box_loss': 2.2241845,
           'class_loss': 2.4279144,
           'conf_loss': 6.0107675,
           'precision50': 0.31215182,
           'recall50': 0.29085106},
     '5': {'avg_iou': 0.8260337,
           'avg_obj': 0.53144884,
           'box_loss': 1.2105845,
           'class_loss': 1.6524912,
           'conf_loss': 3.2226264,
           'precision50': 0.4376213,
           'recall50': 0.53902906},
     'global': {'total_loss': 26.901155},
     'learning_rate': 0.00131,
     'training_loss': 26.901155}
train | step:  270000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6680182,
           'avg_obj': 0.20407365,
           'box_loss': 2.4094226,
           'class_loss': 2.1928477,
           'conf_loss': 5.5194926,
           'precision50': 0.17025271,
           'recall50': 0.09325885},
     '4': {'avg_iou': 0.77255225,
           'avg_obj': 0.37292877,
           'box_loss': 2.2151675,
           'class_loss': 2.405251,
           'conf_loss': 5.9790006,
           'precision50': 0.31306782,
           'recall50': 0.2948403},
     '5': {'avg_iou': 0.8268507,
           'avg_obj': 0.5346684,
           'box_loss': 1.2045746,
           'class_loss': 1.6314795,
           'conf_loss': 3.1993663,
           'precision50': 0.4372044,
           'recall50': 0.54142076},
     'global': {'total_loss': 26.756603},
     'learning_rate': 0.00131,
     'training_loss': 26.756603}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-270000.
 eval | step:  270000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=191.21s).
Accumulating evaluation results...
DONE (t=15.74s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.364
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.592
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.390
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.157
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.382
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.511
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.298
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.488
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.530
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.317
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.567
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.667
 eval | step:  270000 | eval time:  521.6 sec | output: 
    {'3': {'avg_iou': 0.4984808,
           'avg_obj': 0.22128533,
           'box_loss': 2.6468272,
           'class_loss': 1.7278125,
           'conf_loss': 6.3278255,
           'precision50': 0.27371654,
           'recall50': 0.20491964},
     '4': {'avg_iou': 0.7147095,
           'avg_obj': 0.47574863,
           'box_loss': 2.0214543,
           'class_loss': 1.3883212,
           'conf_loss': 5.026405,
           'precision50': 0.388214,
           'recall50': 0.4849744},
     '5': {'avg_iou': 0.7831639,
           'avg_obj': 0.6401732,
           'box_loss': 1.0243306,
           'class_loss': 0.7709971,
           'conf_loss': 2.3206623,
           'precision50': 0.43882212,
           'recall50': 0.6583651},
     'AP': 0.36433092,
     'AP50': 0.5923707,
     'AP75': 0.39002645,
     'APl': 0.51065576,
     'APm': 0.3818075,
     'APs': 0.15700856,
     'ARl': 0.6665466,
     'ARm': 0.56672066,
     'ARmax1': 0.29774818,
     'ARmax10': 0.48844078,
     'ARmax100': 0.5302626,
     'ARs': 0.31732318,
     'global': {'total_loss': 23.254656},
     'validation_loss': 23.254656}
train | step:  270000 | training until step 290000...
train | step:  280000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6689548,
           'avg_obj': 0.20505652,
           'box_loss': 2.395025,
           'class_loss': 2.1690001,
           'conf_loss': 5.49501,
           'precision50': 0.16992427,
           'recall50': 0.09343356},
     '4': {'avg_iou': 0.77326983,
           'avg_obj': 0.3735051,
           'box_loss': 2.2023122,
           'class_loss': 2.3837004,
           'conf_loss': 5.9539623,
           'precision50': 0.3128518,
           'recall50': 0.2947959},
     '5': {'avg_iou': 0.827471,
           'avg_obj': 0.53646487,
           'box_loss': 1.198897,
           'class_loss': 1.6191465,
           'conf_loss': 3.18474,
           'precision50': 0.4376186,
           'recall50': 0.54360133},
     'global': {'total_loss': 26.601843},
     'learning_rate': 0.00131,
     'training_loss': 26.601843}
train | step:  290000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.66936815,
           'avg_obj': 0.20625508,
           'box_loss': 2.392583,
           'class_loss': 2.1563687,
           'conf_loss': 5.489396,
           'precision50': 0.1704124,
           'recall50': 0.09452046},
     '4': {'avg_iou': 0.77396375,
           'avg_obj': 0.37586913,
           'box_loss': 2.1999092,
           'class_loss': 2.3643653,
           'conf_loss': 5.943681,
           'precision50': 0.313416,
           'recall50': 0.2978891},
     '5': {'avg_iou': 0.8280045,
           'avg_obj': 0.5383025,
           'box_loss': 1.1959496,
           'class_loss': 1.6043054,
           'conf_loss': 3.1743612,
           'precision50': 0.43764794,
           'recall50': 0.5459428},
     'global': {'total_loss': 26.520903},
     'learning_rate': 0.00131,
     'training_loss': 26.520903}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-290000.
 eval | step:  290000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=184.01s).
Accumulating evaluation results...
DONE (t=14.52s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.366
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.595
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.392
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.159
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.384
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.511
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.299
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.490
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.533
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.324
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.571
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.668
 eval | step:  290000 | eval time:  505.1 sec | output: 
    {'3': {'avg_iou': 0.49895835,
           'avg_obj': 0.22278436,
           'box_loss': 2.640175,
           'class_loss': 1.7248129,
           'conf_loss': 6.320254,
           'precision50': 0.2749066,
           'recall50': 0.20766333},
     '4': {'avg_iou': 0.7151913,
           'avg_obj': 0.4764135,
           'box_loss': 2.0117939,
           'class_loss': 1.3856381,
           'conf_loss': 5.0391765,
           'precision50': 0.38630697,
           'recall50': 0.48362958},
     '5': {'avg_iou': 0.78304744,
           'avg_obj': 0.6417021,
           'box_loss': 1.024492,
           'class_loss': 0.76149434,
           'conf_loss': 2.3326678,
           'precision50': 0.43588495,
           'recall50': 0.6586052},
     'AP': 0.36569262,
     'AP50': 0.59527165,
     'AP75': 0.39233822,
     'APl': 0.51114297,
     'APm': 0.38360655,
     'APs': 0.15905432,
     'ARl': 0.66809946,
     'ARm': 0.5706128,
     'ARmax1': 0.2991874,
     'ARmax10': 0.48958662,
     'ARmax100': 0.53253925,
     'ARs': 0.3238795,
     'global': {'total_loss': 23.240515},
     'validation_loss': 23.240515}I0422 01:14:12.105424 140713659025216 controller.py:211] train | step:  290000 | training until step 310000...
I0422 02:17:41.641777 140713659025216 controller.py:425] train | step:  300000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6701617,
           'avg_obj': 0.20834465,
           'box_loss': 2.3821173,
           'class_loss': 2.1452854,
           'conf_loss': 5.4606276,
           'precision50': 0.17149068,
           'recall50': 0.09555445},
     '4': {'avg_iou': 0.7747996,
           'avg_obj': 0.37764862,
           'box_loss': 2.1850321,
           'class_loss': 2.3526845,
           'conf_loss': 5.908351,
           'precision50': 0.3132853,
           'recall50': 0.2989641},
     '5': {'avg_iou': 0.82877314,
           'avg_obj': 0.54003507,
           'box_loss': 1.1901456,
           'class_loss': 1.5964719,
           'conf_loss': 3.1607308,
           'precision50': 0.43661034,
           'recall50': 0.5470597},
     'global': {'total_loss': 26.381418},
     'learning_rate': 0.00131,
     'training_loss': 26.381418}
I0422 03:22:09.134711 140713659025216 controller.py:425] train | step:  310000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.67086965,
           'avg_obj': 0.20922905,
           'box_loss': 2.380829,
           'class_loss': 2.1331336,
           'conf_loss': 5.4676166,
           'precision50': 0.17271115,
           'recall50': 0.096888214},
     '4': {'avg_iou': 0.77547765,
           'avg_obj': 0.379683,
           'box_loss': 2.1836782,
           'class_loss': 2.3409848,
           'conf_loss': 5.9034834,
           'precision50': 0.31414586,
           'recall50': 0.30163446},
     '5': {'avg_iou': 0.82932585,
           'avg_obj': 0.5427497,
           'box_loss': 1.1865029,
           'class_loss': 1.5796057,
           'conf_loss': 3.1427433,
           'precision50': 0.43650362,
           'recall50': 0.54934114},
     'global': {'total_loss': 26.318546},
     'learning_rate': 0.00131,
     'training_loss': 26.318546}
I0422 03:23:02.895440 140713659025216 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-310000.
I0422 03:23:02.901012 140713659025216 controller.py:252]  eval | step:  310000 | running 625 steps of evaluation...
I0422 03:27:14.831599 140713659025216 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0422 03:31:23.986581 140713659025216 controller.py:261]  eval | step:  310000 | eval time:  501.1 sec | output: 
    {'3': {'avg_iou': 0.49931476,
           'avg_obj': 0.22329655,
           'box_loss': 2.6385357,
           'class_loss': 1.7300285,
           'conf_loss': 6.3218417,
           'precision50': 0.27444005,
           'recall50': 0.20774937},
     '4': {'avg_iou': 0.71522814,
           'avg_obj': 0.4774128,
           'box_loss': 2.0115674,
           'class_loss': 1.3857211,
           'conf_loss': 5.034427,
           'precision50': 0.38492143,
           'recall50': 0.48560488},
     '5': {'avg_iou': 0.7828134,
           'avg_obj': 0.6420862,
           'box_loss': 1.0245026,
           'class_loss': 0.7623768,
           'conf_loss': 2.3319345,
           'precision50': 0.43487763,
           'recall50': 0.658847},
     'AP': 0.36608067,
     'AP50': 0.59508103,
     'AP75': 0.39232057,
     'APl': 0.51361835,
     'APm': 0.38333395,
     'APs': 0.1570812,
     'ARl': 0.6662377,
     'ARm': 0.5716141,
     'ARmax1': 0.29929072,
     'ARmax10': 0.49115872,
     'ARmax100': 0.5338972,
     'ARs': 0.32396585,
     'global': {'total_loss': 23.240934},
     'validation_loss': 23.240934}
I0422 03:31:40.502505 140713659025216 controller.py:211] train | step:  310000 | training until step 330000...
I0422 04:37:25.812523 140713659025216 controller.py:425] train | step:  320000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.67156196,
           'avg_obj': 0.21087043,
           'box_loss': 2.379083,
           'class_loss': 2.1185,
           'conf_loss': 5.4590173,
           'precision50': 0.1735625,
           'recall50': 0.097460516},
     '4': {'avg_iou': 0.7759968,
           'avg_obj': 0.38181406,
           'box_loss': 2.175743,
           'class_loss': 2.3097816,
           'conf_loss': 5.8747087,
           'precision50': 0.31392056,
           'recall50': 0.3026421},
     '5': {'avg_iou': 0.830109,
           'avg_obj': 0.5445715,
           'box_loss': 1.1812475,
           'class_loss': 1.567683,
           'conf_loss': 3.1310525,
           'precision50': 0.43704927,
           'recall50': 0.55197376},
     'global': {'total_loss': 26.19684},
     'learning_rate': 0.00131,
     'training_loss': 26.19684}
I0422 05:41:34.834937 140713659025216 controller.py:425] train | step:  330000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.67204165,
           'avg_obj': 0.21136516,
           'box_loss': 2.3775313,
           'class_loss': 2.115202,
           'conf_loss': 5.4596844,
           'precision50': 0.17313665,
           'recall50': 0.09773603},
     '4': {'avg_iou': 0.7767219,
           'avg_obj': 0.38298455,
           'box_loss': 2.1725192,
           'class_loss': 2.3050172,
           'conf_loss': 5.873502,
           'precision50': 0.31505594,
           'recall50': 0.30376816},
     '5': {'avg_iou': 0.83072805,
           'avg_obj': 0.54619485,
           'box_loss': 1.1784273,
           'class_loss': 1.5554534,
           'conf_loss': 3.12302,
           'precision50': 0.4364022,
           'recall50': 0.5531763},
     'global': {'total_loss': 26.160368},
     'learning_rate': 0.00131,
     'training_loss': 26.160368}
I0422 05:42:26.883005 140713659025216 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-330000.
I0422 05:42:26.889701 140713659025216 controller.py:252]  eval | step:  330000 | running 625 steps of evaluation...
I0422 05:46:44.866270 140713659025216 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0422 05:51:01.839687 140713659025216 controller.py:261]  eval | step:  330000 | eval time:  514.9 sec | output: 
    {'3': {'avg_iou': 0.50024444,
           'avg_obj': 0.22419682,
           'box_loss': 2.6286433,
           'class_loss': 1.7120624,
           'conf_loss': 6.3088055,
           'precision50': 0.27382654,
           'recall50': 0.209749},
     '4': {'avg_iou': 0.7161092,
           'avg_obj': 0.47973922,
           'box_loss': 1.997368,
           'class_loss': 1.378071,
           'conf_loss': 5.0038943,
           'precision50': 0.3865364,
           'recall50': 0.48866108},
     '5': {'avg_iou': 0.78323483,
           'avg_obj': 0.64376545,
           'box_loss': 1.0202677,
           'class_loss': 0.76013064,
           'conf_loss': 2.3288023,
           'precision50': 0.4345534,
           'recall50': 0.66140354},
     'AP': 0.36950618,
     'AP50': 0.5978825,
     'AP75': 0.39372814,
     'APl': 0.51797014,
     'APm': 0.38925856,
     'APs': 0.16580072,
     'ARl': 0.66864765,
     'ARm': 0.5729387,
     'ARmax1': 0.3023582,
     'ARmax10': 0.4931314,
     'ARmax100': 0.5354906,
     'ARs': 0.32438537,
     'global': {'total_loss': 23.138042},
     'validation_loss': 23.138042}

train | step:  290000 | training until step 310000...
train | step:  300000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6701617,
           'avg_obj': 0.20834465,
           'box_loss': 2.3821173,
           'class_loss': 2.1452854,
           'conf_loss': 5.4606276,
           'precision50': 0.17149068,
           'recall50': 0.09555445},
     '4': {'avg_iou': 0.7747996,
           'avg_obj': 0.37764862,
           'box_loss': 2.1850321,
           'class_loss': 2.3526845,
           'conf_loss': 5.908351,
           'precision50': 0.3132853,
           'recall50': 0.2989641},
     '5': {'avg_iou': 0.82877314,
           'avg_obj': 0.54003507,
           'box_loss': 1.1901456,
           'class_loss': 1.5964719,
           'conf_loss': 3.1607308,
           'precision50': 0.43661034,
           'recall50': 0.5470597},
     'global': {'total_loss': 26.381418},
     'learning_rate': 0.00131,
     'training_loss': 26.381418}
train | step:  310000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.67086965,
           'avg_obj': 0.20922905,
           'box_loss': 2.380829,
           'class_loss': 2.1331336,
           'conf_loss': 5.4676166,
           'precision50': 0.17271115,
           'recall50': 0.096888214},
     '4': {'avg_iou': 0.77547765,
           'avg_obj': 0.379683,
           'box_loss': 2.1836782,
           'class_loss': 2.3409848,
           'conf_loss': 5.9034834,
           'precision50': 0.31414586,
           'recall50': 0.30163446},
     '5': {'avg_iou': 0.82932585,
           'avg_obj': 0.5427497,
           'box_loss': 1.1865029,
           'class_loss': 1.5796057,
           'conf_loss': 3.1427433,
           'precision50': 0.43650362,
           'recall50': 0.54934114},
     'global': {'total_loss': 26.318546},
     'learning_rate': 0.00131,
     'training_loss': 26.318546}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-310000.
 eval | step:  310000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=177.52s).
Accumulating evaluation results...
DONE (t=14.89s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.366
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.595
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.392
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.157
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.383
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.514
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.299
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.534
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.324
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.572
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.666
 eval | step:  310000 | eval time:  501.1 sec | output: 
    {'3': {'avg_iou': 0.49931476,
           'avg_obj': 0.22329655,
           'box_loss': 2.6385357,
           'class_loss': 1.7300285,
           'conf_loss': 6.3218417,
           'precision50': 0.27444005,
           'recall50': 0.20774937},
     '4': {'avg_iou': 0.71522814,
           'avg_obj': 0.4774128,
           'box_loss': 2.0115674,
           'class_loss': 1.3857211,
           'conf_loss': 5.034427,
           'precision50': 0.38492143,
           'recall50': 0.48560488},
     '5': {'avg_iou': 0.7828134,
           'avg_obj': 0.6420862,
           'box_loss': 1.0245026,
           'class_loss': 0.7623768,
           'conf_loss': 2.3319345,
           'precision50': 0.43487763,
           'recall50': 0.658847},
     'AP': 0.36608067,
     'AP50': 0.59508103,
     'AP75': 0.39232057,
     'APl': 0.51361835,
     'APm': 0.38333395,
     'APs': 0.1570812,
     'ARl': 0.6662377,
     'ARm': 0.5716141,
     'ARmax1': 0.29929072,
     'ARmax10': 0.49115872,
     'ARmax100': 0.5338972,
     'ARs': 0.32396585,
     'global': {'total_loss': 23.240934},
     'validation_loss': 23.240934}
train | step:  310000 | training until step 330000...
train | step:  320000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.67156196,
           'avg_obj': 0.21087043,
           'box_loss': 2.379083,
           'class_loss': 2.1185,
           'conf_loss': 5.4590173,
           'precision50': 0.1735625,
           'recall50': 0.097460516},
     '4': {'avg_iou': 0.7759968,
           'avg_obj': 0.38181406,
           'box_loss': 2.175743,
           'class_loss': 2.3097816,
           'conf_loss': 5.8747087,
           'precision50': 0.31392056,
           'recall50': 0.3026421},
     '5': {'avg_iou': 0.830109,
           'avg_obj': 0.5445715,
           'box_loss': 1.1812475,
           'class_loss': 1.567683,
           'conf_loss': 3.1310525,
           'precision50': 0.43704927,
           'recall50': 0.55197376},
     'global': {'total_loss': 26.19684},
     'learning_rate': 0.00131,
     'training_loss': 26.19684}
train | step:  330000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.67204165,
           'avg_obj': 0.21136516,
           'box_loss': 2.3775313,
           'class_loss': 2.115202,
           'conf_loss': 5.4596844,
           'precision50': 0.17313665,
           'recall50': 0.09773603},
     '4': {'avg_iou': 0.7767219,
           'avg_obj': 0.38298455,
           'box_loss': 2.1725192,
           'class_loss': 2.3050172,
           'conf_loss': 5.873502,
           'precision50': 0.31505594,
           'recall50': 0.30376816},
     '5': {'avg_iou': 0.83072805,
           'avg_obj': 0.54619485,
           'box_loss': 1.1784273,
           'class_loss': 1.5554534,
           'conf_loss': 3.12302,
           'precision50': 0.4364022,
           'recall50': 0.5531763},
     'global': {'total_loss': 26.160368},
     'learning_rate': 0.00131,
     'training_loss': 26.160368}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-330000.
 eval | step:  330000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=182.29s).
Accumulating evaluation results...
DONE (t=15.18s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.370
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.598
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.394
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.166
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.389
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.518
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.302
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.493
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.535
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.324
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.573
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.669
 eval | step:  330000 | eval time:  514.9 sec | output: 
    {'3': {'avg_iou': 0.50024444,
           'avg_obj': 0.22419682,
           'box_loss': 2.6286433,
           'class_loss': 1.7120624,
           'conf_loss': 6.3088055,
           'precision50': 0.27382654,
           'recall50': 0.209749},
     '4': {'avg_iou': 0.7161092,
           'avg_obj': 0.47973922,
           'box_loss': 1.997368,
           'class_loss': 1.378071,
           'conf_loss': 5.0038943,
           'precision50': 0.3865364,
           'recall50': 0.48866108},
     '5': {'avg_iou': 0.78323483,
           'avg_obj': 0.64376545,
           'box_loss': 1.0202677,
           'class_loss': 0.76013064,
           'conf_loss': 2.3288023,
           'precision50': 0.4345534,
           'recall50': 0.66140354},
     'AP': 0.36950618,
     'AP50': 0.5978825,
     'AP75': 0.39372814,
     'APl': 0.51797014,
     'APm': 0.38925856,
     'APs': 0.16580072,
     'ARl': 0.66864765,
     'ARm': 0.5729387,
     'ARmax1': 0.3023582,
     'ARmax10': 0.4931314,
     'ARmax100': 0.5354906,
     'ARs': 0.32438537,
     'global': {'total_loss': 23.138042},
     'validation_loss': 23.138042}I0422 05:51:18.289000 140713659025216 controller.py:211] train | step:  330000 | training until step 350000...
I0422 06:52:05.686127 140713659025216 controller.py:425] train | step:  340000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.67255944,
           'avg_obj': 0.21305338,
           'box_loss': 2.37015,
           'class_loss': 2.0985756,
           'conf_loss': 5.439477,
           'precision50': 0.17496732,
           'recall50': 0.09882254},
     '4': {'avg_iou': 0.7774983,
           'avg_obj': 0.38557634,
           'box_loss': 2.1636488,
           'class_loss': 2.2842755,
           'conf_loss': 5.844551,
           'precision50': 0.31472766,
           'recall50': 0.30666775},
     '5': {'avg_iou': 0.8311743,
           'avg_obj': 0.5485786,
           'box_loss': 1.1739645,
           'class_loss': 1.5465376,
           'conf_loss': 3.1040552,
           'precision50': 0.43648177,
           'recall50': 0.55533046},
     'global': {'total_loss': 26.02525},
     'learning_rate': 0.00131,
     'training_loss': 26.02525}
I0422 07:54:17.824115 140713659025216 controller.py:425] train | step:  350000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6737005,
           'avg_obj': 0.21457864,
           'box_loss': 2.363396,
           'class_loss': 2.0860007,
           'conf_loss': 5.429306,
           'precision50': 0.17537288,
           'recall50': 0.10007701},
     '4': {'avg_iou': 0.77795094,
           'avg_obj': 0.38748798,
           'box_loss': 2.159195,
           'class_loss': 2.267548,
           'conf_loss': 5.8274,
           'precision50': 0.3153538,
           'recall50': 0.30880576},
     '5': {'avg_iou': 0.83163685,
           'avg_obj': 0.55032146,
           'box_loss': 1.1700374,
           'class_loss': 1.5308437,
           'conf_loss': 3.0910368,
           'precision50': 0.4360535,
           'recall50': 0.55664116},
     'global': {'total_loss': 25.924852},
     'learning_rate': 0.00131,
     'training_loss': 25.924852}
I0422 07:55:11.861214 140713659025216 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-350000.
I0422 07:55:11.867736 140713659025216 controller.py:252]  eval | step:  350000 | running 625 steps of evaluation...
I0422 07:59:29.696738 140713659025216 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0422 08:03:40.686444 140713659025216 controller.py:261]  eval | step:  350000 | eval time:  508.8 sec | output: 
    {'3': {'avg_iou': 0.50012535,
           'avg_obj': 0.22549707,
           'box_loss': 2.6282587,
           'class_loss': 1.7068608,
           'conf_loss': 6.292492,
           'precision50': 0.27329457,
           'recall50': 0.21109255},
     '4': {'avg_iou': 0.7159654,
           'avg_obj': 0.48305088,
           'box_loss': 1.9995615,
           'class_loss': 1.3756056,
           'conf_loss': 5.001301,
           'precision50': 0.38390666,
           'recall50': 0.49187812},
     '5': {'avg_iou': 0.7827404,
           'avg_obj': 0.6487752,
           'box_loss': 1.0223616,
           'class_loss': 0.7640984,
           'conf_loss': 2.3210642,
           'precision50': 0.43007895,
           'recall50': 0.6644665},
     'AP': 0.3699949,
     'AP50': 0.6009352,
     'AP75': 0.39878938,
     'APl': 0.5177275,
     'APm': 0.38780332,
     'APs': 0.16405106,
     'ARl': 0.6667861,
     'ARm': 0.5738421,
     'ARmax1': 0.30394197,
     'ARmax10': 0.49318376,
     'ARmax100': 0.53626835,
     'ARs': 0.32878387,
     'global': {'total_loss': 23.111626},
     'validation_loss': 23.111626}
I0422 08:03:57.321585 140713659025216 controller.py:211] train | step:  350000 | training until step 370000...
I0422 09:05:01.956037 140713659025216 controller.py:425] train | step:  360000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.67385745,
           'avg_obj': 0.21584627,
           'box_loss': 2.362866,
           'class_loss': 2.077138,
           'conf_loss': 5.4237075,
           'precision50': 0.17571849,
           'recall50': 0.10064501},
     '4': {'avg_iou': 0.7786374,
           'avg_obj': 0.38879874,
           'box_loss': 2.1530077,
           'class_loss': 2.2545924,
           'conf_loss': 5.814152,
           'precision50': 0.3162232,
           'recall50': 0.3098156},
     '5': {'avg_iou': 0.8322127,
           'avg_obj': 0.5523576,
           'box_loss': 1.167505,
           'class_loss': 1.5217509,
           'conf_loss': 3.079807,
           'precision50': 0.43630537,
           'recall50': 0.5587453},
     'global': {'total_loss': 25.854563},
     'learning_rate': 0.00131,
     'training_loss': 25.854563}
I0422 10:05:18.382643 140713659025216 controller.py:425] train | step:  370000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6743877,
           'avg_obj': 0.21675964,
           'box_loss': 2.3566413,
           'class_loss': 2.063649,
           'conf_loss': 5.4103775,
           'precision50': 0.1761907,
           'recall50': 0.101107985},
     '4': {'avg_iou': 0.77906734,
           'avg_obj': 0.39047775,
           'box_loss': 2.1487546,
           'class_loss': 2.245067,
           'conf_loss': 5.7982655,
           'precision50': 0.31572396,
           'recall50': 0.31067944},
     '5': {'avg_iou': 0.83262295,
           'avg_obj': 0.5539472,
           'box_loss': 1.1644695,
           'class_loss': 1.5120355,
           'conf_loss': 3.0678835,
           'precision50': 0.435903,
           'recall50': 0.56048244},
     'global': {'total_loss': 25.767178},
     'learning_rate': 0.00131,
     'training_loss': 25.767178}
I0422 10:06:10.155471 140713659025216 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-370000.
I0422 10:06:10.162274 140713659025216 controller.py:252]  eval | step:  370000 | running 625 steps of evaluation...
I0422 10:10:34.690346 140713659025216 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0422 10:14:43.211322 140713659025216 controller.py:261]  eval | step:  370000 | eval time:  513.0 sec | output: 
    {'3': {'avg_iou': 0.50051445,
           'avg_obj': 0.22716033,
           'box_loss': 2.6192763,
           'class_loss': 1.6982789,
           'conf_loss': 6.287222,
           'precision50': 0.27235088,
           'recall50': 0.21279903},
     '4': {'avg_iou': 0.71683127,
           'avg_obj': 0.48481953,
           'box_loss': 1.9936563,
           'class_loss': 1.3672714,
           'conf_loss': 4.9992447,
           'precision50': 0.38413686,
           'recall50': 0.4955087},
     '5': {'avg_iou': 0.7835872,
           'avg_obj': 0.64788246,
           'box_loss': 1.019504,
           'class_loss': 0.74747145,
           'conf_loss': 2.3300912,
           'precision50': 0.43017262,
           'recall50': 0.6629647},
     'AP': 0.37108183,
     'AP50': 0.5998884,
     'AP75': 0.40039292,
     'APl': 0.51918125,
     'APm': 0.3891924,
     'APs': 0.16599335,
     'ARl': 0.665641,
     'ARm': 0.5769338,
     'ARmax1': 0.30359957,
     'ARmax10': 0.49575606,
     'ARmax100': 0.53829944,
     'ARs': 0.331926,
     'global': {'total_loss': 23.062008},
     'validation_loss': 23.062008}

train | step:  330000 | training until step 350000...
train | step:  340000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.67255944,
           'avg_obj': 0.21305338,
           'box_loss': 2.37015,
           'class_loss': 2.0985756,
           'conf_loss': 5.439477,
           'precision50': 0.17496732,
           'recall50': 0.09882254},
     '4': {'avg_iou': 0.7774983,
           'avg_obj': 0.38557634,
           'box_loss': 2.1636488,
           'class_loss': 2.2842755,
           'conf_loss': 5.844551,
           'precision50': 0.31472766,
           'recall50': 0.30666775},
     '5': {'avg_iou': 0.8311743,
           'avg_obj': 0.5485786,
           'box_loss': 1.1739645,
           'class_loss': 1.5465376,
           'conf_loss': 3.1040552,
           'precision50': 0.43648177,
           'recall50': 0.55533046},
     'global': {'total_loss': 26.02525},
     'learning_rate': 0.00131,
     'training_loss': 26.02525}
train | step:  350000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6737005,
           'avg_obj': 0.21457864,
           'box_loss': 2.363396,
           'class_loss': 2.0860007,
           'conf_loss': 5.429306,
           'precision50': 0.17537288,
           'recall50': 0.10007701},
     '4': {'avg_iou': 0.77795094,
           'avg_obj': 0.38748798,
           'box_loss': 2.159195,
           'class_loss': 2.267548,
           'conf_loss': 5.8274,
           'precision50': 0.3153538,
           'recall50': 0.30880576},
     '5': {'avg_iou': 0.83163685,
           'avg_obj': 0.55032146,
           'box_loss': 1.1700374,
           'class_loss': 1.5308437,
           'conf_loss': 3.0910368,
           'precision50': 0.4360535,
           'recall50': 0.55664116},
     'global': {'total_loss': 25.924852},
     'learning_rate': 0.00131,
     'training_loss': 25.924852}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-350000.
 eval | step:  350000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=179.02s).
Accumulating evaluation results...
DONE (t=15.38s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.370
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.601
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.399
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.164
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.388
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.518
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.304
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.493
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.536
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.329
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.574
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.667
 eval | step:  350000 | eval time:  508.8 sec | output: 
    {'3': {'avg_iou': 0.50012535,
           'avg_obj': 0.22549707,
           'box_loss': 2.6282587,
           'class_loss': 1.7068608,
           'conf_loss': 6.292492,
           'precision50': 0.27329457,
           'recall50': 0.21109255},
     '4': {'avg_iou': 0.7159654,
           'avg_obj': 0.48305088,
           'box_loss': 1.9995615,
           'class_loss': 1.3756056,
           'conf_loss': 5.001301,
           'precision50': 0.38390666,
           'recall50': 0.49187812},
     '5': {'avg_iou': 0.7827404,
           'avg_obj': 0.6487752,
           'box_loss': 1.0223616,
           'class_loss': 0.7640984,
           'conf_loss': 2.3210642,
           'precision50': 0.43007895,
           'recall50': 0.6644665},
     'AP': 0.3699949,
     'AP50': 0.6009352,
     'AP75': 0.39878938,
     'APl': 0.5177275,
     'APm': 0.38780332,
     'APs': 0.16405106,
     'ARl': 0.6667861,
     'ARm': 0.5738421,
     'ARmax1': 0.30394197,
     'ARmax10': 0.49318376,
     'ARmax100': 0.53626835,
     'ARs': 0.32878387,
     'global': {'total_loss': 23.111626},
     'validation_loss': 23.111626}
train | step:  350000 | training until step 370000...
train | step:  360000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.67385745,
           'avg_obj': 0.21584627,
           'box_loss': 2.362866,
           'class_loss': 2.077138,
           'conf_loss': 5.4237075,
           'precision50': 0.17571849,
           'recall50': 0.10064501},
     '4': {'avg_iou': 0.7786374,
           'avg_obj': 0.38879874,
           'box_loss': 2.1530077,
           'class_loss': 2.2545924,
           'conf_loss': 5.814152,
           'precision50': 0.3162232,
           'recall50': 0.3098156},
     '5': {'avg_iou': 0.8322127,
           'avg_obj': 0.5523576,
           'box_loss': 1.167505,
           'class_loss': 1.5217509,
           'conf_loss': 3.079807,
           'precision50': 0.43630537,
           'recall50': 0.5587453},
     'global': {'total_loss': 25.854563},
     'learning_rate': 0.00131,
     'training_loss': 25.854563}
train | step:  370000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6743877,
           'avg_obj': 0.21675964,
           'box_loss': 2.3566413,
           'class_loss': 2.063649,
           'conf_loss': 5.4103775,
           'precision50': 0.1761907,
           'recall50': 0.101107985},
     '4': {'avg_iou': 0.77906734,
           'avg_obj': 0.39047775,
           'box_loss': 2.1487546,
           'class_loss': 2.245067,
           'conf_loss': 5.7982655,
           'precision50': 0.31572396,
           'recall50': 0.31067944},
     '5': {'avg_iou': 0.83262295,
           'avg_obj': 0.5539472,
           'box_loss': 1.1644695,
           'class_loss': 1.5120355,
           'conf_loss': 3.0678835,
           'precision50': 0.435903,
           'recall50': 0.56048244},
     'global': {'total_loss': 25.767178},
     'learning_rate': 0.00131,
     'training_loss': 25.767178}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-370000.
 eval | step:  370000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=179.35s).
Accumulating evaluation results...
DONE (t=15.15s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.371
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.600
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.400
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.166
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.389
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.519
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.304
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.496
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.538
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.332
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.577
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.666
 eval | step:  370000 | eval time:  513.0 sec | output: 
    {'3': {'avg_iou': 0.50051445,
           'avg_obj': 0.22716033,
           'box_loss': 2.6192763,
           'class_loss': 1.6982789,
           'conf_loss': 6.287222,
           'precision50': 0.27235088,
           'recall50': 0.21279903},
     '4': {'avg_iou': 0.71683127,
           'avg_obj': 0.48481953,
           'box_loss': 1.9936563,
           'class_loss': 1.3672714,
           'conf_loss': 4.9992447,
           'precision50': 0.38413686,
           'recall50': 0.4955087},
     '5': {'avg_iou': 0.7835872,
           'avg_obj': 0.64788246,
           'box_loss': 1.019504,
           'class_loss': 0.74747145,
           'conf_loss': 2.3300912,
           'precision50': 0.43017262,
           'recall50': 0.6629647},
     'AP': 0.37108183,
     'AP50': 0.5998884,
     'AP75': 0.40039292,
     'APl': 0.51918125,
     'APm': 0.3891924,
     'APs': 0.16599335,
     'ARl': 0.665641,
     'ARm': 0.5769338,
     'ARmax1': 0.30359957,
     'ARmax10': 0.49575606,
     'ARmax100': 0.53829944,
     'ARs': 0.331926,
     'global': {'total_loss': 23.062008},
     'validation_loss': 23.062008}I0422 10:14:59.431663 140713659025216 controller.py:211] train | step:  370000 | training until step 390000...
I0422 11:15:09.016680 140713659025216 controller.py:425] train | step:  380000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.67424107,
           'avg_obj': 0.21756227,
           'box_loss': 2.358928,
           'class_loss': 2.0575323,
           'conf_loss': 5.411995,
           'precision50': 0.1773755,
           'recall50': 0.10223701},
     '4': {'avg_iou': 0.7794326,
           'avg_obj': 0.39236844,
           'box_loss': 2.1426308,
           'class_loss': 2.218537,
           'conf_loss': 5.7745223,
           'precision50': 0.31621888,
           'recall50': 0.31256056},
     '5': {'avg_iou': 0.83296067,
           'avg_obj': 0.55541766,
           'box_loss': 1.1606145,
           'class_loss': 1.5038077,
           'conf_loss': 3.055654,
           'precision50': 0.43598852,
           'recall50': 0.5614369},
     'global': {'total_loss': 25.684244},
     'learning_rate': 0.00131,
     'training_loss': 25.684244}
I0422 12:21:06.195826 140713659025216 controller.py:425] train | step:  390000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6754207,
           'avg_obj': 0.21919174,
           'box_loss': 2.353837,
           'class_loss': 2.045413,
           'conf_loss': 5.4056697,
           'precision50': 0.17746857,
           'recall50': 0.102757424},
     '4': {'avg_iou': 0.7800483,
           'avg_obj': 0.39400306,
           'box_loss': 2.1407182,
           'class_loss': 2.2150493,
           'conf_loss': 5.7669373,
           'precision50': 0.31645337,
           'recall50': 0.3141749},
     '5': {'avg_iou': 0.8335481,
           'avg_obj': 0.5575452,
           'box_loss': 1.1580594,
           'class_loss': 1.4939435,
           'conf_loss': 3.0444329,
           'precision50': 0.43544394,
           'recall50': 0.563648},
     'global': {'total_loss': 25.623997},
     'learning_rate': 0.00131,
     'training_loss': 25.623997}
I0422 12:21:56.962280 140713659025216 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-390000.
I0422 12:21:56.967881 140713659025216 controller.py:252]  eval | step:  390000 | running 625 steps of evaluation...
I0422 12:26:22.114813 140713659025216 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0422 12:30:41.827767 140713659025216 controller.py:261]  eval | step:  390000 | eval time:  524.9 sec | output: 
    {'3': {'avg_iou': 0.50068253,
           'avg_obj': 0.22696202,
           'box_loss': 2.615308,
           'class_loss': 1.6933527,
           'conf_loss': 6.28341,
           'precision50': 0.27245286,
           'recall50': 0.21438216},
     '4': {'avg_iou': 0.71649975,
           'avg_obj': 0.48754606,
           'box_loss': 1.9926896,
           'class_loss': 1.3703239,
           'conf_loss': 5.004277,
           'precision50': 0.38123053,
           'recall50': 0.4976328},
     '5': {'avg_iou': 0.78312904,
           'avg_obj': 0.6519065,
           'box_loss': 1.0199302,
           'class_loss': 0.75781995,
           'conf_loss': 2.3264496,
           'precision50': 0.4253557,
           'recall50': 0.6677311},
     'AP': 0.3698334,
     'AP50': 0.59808624,
     'AP75': 0.39797902,
     'APl': 0.5189878,
     'APm': 0.388502,
     'APs': 0.16106445,
     'ARl': 0.6660755,
     'ARm': 0.5751672,
     'ARmax1': 0.30317715,
     'ARmax10': 0.49330455,
     'ARmax100': 0.5363725,
     'ARs': 0.3304826,
     'global': {'total_loss': 23.063555},
     'validation_loss': 23.063555}
I0422 12:30:58.421820 140713659025216 controller.py:211] train | step:  390000 | training until step 410000...
I0422 13:27:28.081485 140713659025216 controller.py:425] train | step:  400000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6756466,
           'avg_obj': 0.22013076,
           'box_loss': 2.350235,
           'class_loss': 2.0358772,
           'conf_loss': 5.3933926,
           'precision50': 0.17765704,
           'recall50': 0.10332701},
     '4': {'avg_iou': 0.7803145,
           'avg_obj': 0.39506522,
           'box_loss': 2.1364362,
           'class_loss': 2.2051723,
           'conf_loss': 5.7544017,
           'precision50': 0.31673822,
           'recall50': 0.315303},
     '5': {'avg_iou': 0.8337499,
           'avg_obj': 0.559101,
           'box_loss': 1.1557355,
           'class_loss': 1.4856406,
           'conf_loss': 3.031633,
           'precision50': 0.436612,
           'recall50': 0.565056},
     'global': {'total_loss': 25.5485},
     'learning_rate': 0.00131,
     'training_loss': 25.5485}
I0422 14:29:21.461571 140713659025216 controller.py:425] train | step:  410000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.68477166,
           'avg_obj': 0.234905,
           'box_loss': 2.291081,
           'class_loss': 1.9140959,
           'conf_loss': 5.2945642,
           'precision50': 0.18444699,
           'recall50': 0.11362341},
     '4': {'avg_iou': 0.7886019,
           'avg_obj': 0.41421035,
           'box_loss': 2.0560858,
           'class_loss': 2.048849,
           'conf_loss': 5.563533,
           'precision50': 0.31882644,
           'recall50': 0.33300665},
     '5': {'avg_iou': 0.84137726,
           'avg_obj': 0.5787614,
           'box_loss': 1.1019268,
           'class_loss': 1.3614112,
           'conf_loss': 2.8898532,
           'precision50': 0.4354337,
           'recall50': 0.58455366},
     'global': {'total_loss': 24.521406},
     'learning_rate': 0.000131,
     'training_loss': 24.521406}
I0422 14:30:11.820781 140713659025216 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-410000.
I0422 14:30:11.827010 140713659025216 controller.py:252]  eval | step:  410000 | running 625 steps of evaluation...
I0422 14:34:43.331115 140713659025216 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0422 14:39:07.150718 140713659025216 controller.py:261]  eval | step:  410000 | eval time:  535.3 sec | output: 
    {'3': {'avg_iou': 0.49996373,
           'avg_obj': 0.22849324,
           'box_loss': 2.6254141,
           'class_loss': 1.7398078,
           'conf_loss': 6.3218284,
           'precision50': 0.26826704,
           'recall50': 0.21478046},
     '4': {'avg_iou': 0.71522987,
           'avg_obj': 0.48673895,
           'box_loss': 2.0055854,
           'class_loss': 1.4055699,
           'conf_loss': 5.057199,
           'precision50': 0.37641284,
           'recall50': 0.49584052},
     '5': {'avg_iou': 0.780392,
           'avg_obj': 0.6506063,
           'box_loss': 1.0366076,
           'class_loss': 0.78543067,
           'conf_loss': 2.3692932,
           'precision50': 0.42261246,
           'recall50': 0.6654371},
     'AP': 0.36591026,
     'AP50': 0.593847,
     'AP75': 0.39192328,
     'APl': 0.5099552,
     'APm': 0.387761,
     'APs': 0.16300763,
     'ARl': 0.6599767,
     'ARm': 0.5722978,
     'ARmax1': 0.3009906,
     'ARmax10': 0.4908306,
     'ARmax100': 0.5320723,
     'ARs': 0.3270868,
     'global': {'total_loss': 23.346722},
     'validation_loss': 23.346722}

train | step:  370000 | training until step 390000...
train | step:  380000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.67424107,
           'avg_obj': 0.21756227,
           'box_loss': 2.358928,
           'class_loss': 2.0575323,
           'conf_loss': 5.411995,
           'precision50': 0.1773755,
           'recall50': 0.10223701},
     '4': {'avg_iou': 0.7794326,
           'avg_obj': 0.39236844,
           'box_loss': 2.1426308,
           'class_loss': 2.218537,
           'conf_loss': 5.7745223,
           'precision50': 0.31621888,
           'recall50': 0.31256056},
     '5': {'avg_iou': 0.83296067,
           'avg_obj': 0.55541766,
           'box_loss': 1.1606145,
           'class_loss': 1.5038077,
           'conf_loss': 3.055654,
           'precision50': 0.43598852,
           'recall50': 0.5614369},
     'global': {'total_loss': 25.684244},
     'learning_rate': 0.00131,
     'training_loss': 25.684244}
train | step:  390000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6754207,
           'avg_obj': 0.21919174,
           'box_loss': 2.353837,
           'class_loss': 2.045413,
           'conf_loss': 5.4056697,
           'precision50': 0.17746857,
           'recall50': 0.102757424},
     '4': {'avg_iou': 0.7800483,
           'avg_obj': 0.39400306,
           'box_loss': 2.1407182,
           'class_loss': 2.2150493,
           'conf_loss': 5.7669373,
           'precision50': 0.31645337,
           'recall50': 0.3141749},
     '5': {'avg_iou': 0.8335481,
           'avg_obj': 0.5575452,
           'box_loss': 1.1580594,
           'class_loss': 1.4939435,
           'conf_loss': 3.0444329,
           'precision50': 0.43544394,
           'recall50': 0.563648},
     'global': {'total_loss': 25.623997},
     'learning_rate': 0.00131,
     'training_loss': 25.623997}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-390000.
 eval | step:  390000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=183.39s).
Accumulating evaluation results...
DONE (t=16.19s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.370
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.598
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.398
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.161
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.389
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.519
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.303
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.493
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.536
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.330
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.575
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.666
 eval | step:  390000 | eval time:  524.9 sec | output: 
    {'3': {'avg_iou': 0.50068253,
           'avg_obj': 0.22696202,
           'box_loss': 2.615308,
           'class_loss': 1.6933527,
           'conf_loss': 6.28341,
           'precision50': 0.27245286,
           'recall50': 0.21438216},
     '4': {'avg_iou': 0.71649975,
           'avg_obj': 0.48754606,
           'box_loss': 1.9926896,
           'class_loss': 1.3703239,
           'conf_loss': 5.004277,
           'precision50': 0.38123053,
           'recall50': 0.4976328},
     '5': {'avg_iou': 0.78312904,
           'avg_obj': 0.6519065,
           'box_loss': 1.0199302,
           'class_loss': 0.75781995,
           'conf_loss': 2.3264496,
           'precision50': 0.4253557,
           'recall50': 0.6677311},
     'AP': 0.3698334,
     'AP50': 0.59808624,
     'AP75': 0.39797902,
     'APl': 0.5189878,
     'APm': 0.388502,
     'APs': 0.16106445,
     'ARl': 0.6660755,
     'ARm': 0.5751672,
     'ARmax1': 0.30317715,
     'ARmax10': 0.49330455,
     'ARmax100': 0.5363725,
     'ARs': 0.3304826,
     'global': {'total_loss': 23.063555},
     'validation_loss': 23.063555}
train | step:  390000 | training until step 410000...
train | step:  400000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6756466,
           'avg_obj': 0.22013076,
           'box_loss': 2.350235,
           'class_loss': 2.0358772,
           'conf_loss': 5.3933926,
           'precision50': 0.17765704,
           'recall50': 0.10332701},
     '4': {'avg_iou': 0.7803145,
           'avg_obj': 0.39506522,
           'box_loss': 2.1364362,
           'class_loss': 2.2051723,
           'conf_loss': 5.7544017,
           'precision50': 0.31673822,
           'recall50': 0.315303},
     '5': {'avg_iou': 0.8337499,
           'avg_obj': 0.559101,
           'box_loss': 1.1557355,
           'class_loss': 1.4856406,
           'conf_loss': 3.031633,
           'precision50': 0.436612,
           'recall50': 0.565056},
     'global': {'total_loss': 25.5485},
     'learning_rate': 0.00131,
     'training_loss': 25.5485}
train | step:  410000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.68477166,
           'avg_obj': 0.234905,
           'box_loss': 2.291081,
           'class_loss': 1.9140959,
           'conf_loss': 5.2945642,
           'precision50': 0.18444699,
           'recall50': 0.11362341},
     '4': {'avg_iou': 0.7886019,
           'avg_obj': 0.41421035,
           'box_loss': 2.0560858,
           'class_loss': 2.048849,
           'conf_loss': 5.563533,
           'precision50': 0.31882644,
           'recall50': 0.33300665},
     '5': {'avg_iou': 0.84137726,
           'avg_obj': 0.5787614,
           'box_loss': 1.1019268,
           'class_loss': 1.3614112,
           'conf_loss': 2.8898532,
           'precision50': 0.4354337,
           'recall50': 0.58455366},
     'global': {'total_loss': 24.521406},
     'learning_rate': 0.000131,
     'training_loss': 24.521406}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-410000.
 eval | step:  410000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=185.38s).
Accumulating evaluation results...
DONE (t=16.10s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.366
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.594
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.392
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.163
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.388
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.510
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.301
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.532
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.327
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.572
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.660
 eval | step:  410000 | eval time:  535.3 sec | output: 
    {'3': {'avg_iou': 0.49996373,
           'avg_obj': 0.22849324,
           'box_loss': 2.6254141,
           'class_loss': 1.7398078,
           'conf_loss': 6.3218284,
           'precision50': 0.26826704,
           'recall50': 0.21478046},
     '4': {'avg_iou': 0.71522987,
           'avg_obj': 0.48673895,
           'box_loss': 2.0055854,
           'class_loss': 1.4055699,
           'conf_loss': 5.057199,
           'precision50': 0.37641284,
           'recall50': 0.49584052},
     '5': {'avg_iou': 0.780392,
           'avg_obj': 0.6506063,
           'box_loss': 1.0366076,
           'class_loss': 0.78543067,
           'conf_loss': 2.3692932,
           'precision50': 0.42261246,
           'recall50': 0.6654371},
     'AP': 0.36591026,
     'AP50': 0.593847,
     'AP75': 0.39192328,
     'APl': 0.5099552,
     'APm': 0.387761,
     'APs': 0.16300763,
     'ARl': 0.6599767,
     'ARm': 0.5722978,
     'ARmax1': 0.3009906,
     'ARmax10': 0.4908306,
     'ARmax100': 0.5320723,
     'ARs': 0.3270868,
     'global': {'total_loss': 23.346722},
     'validation_loss': 23.346722}I0422 14:39:23.651468 140713659025216 controller.py:211] train | step:  410000 | training until step 430000...
I0422 15:41:51.877171 140713659025216 controller.py:425] train | step:  420000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.68602884,
           'avg_obj': 0.23840734,
           'box_loss': 2.2758265,
           'class_loss': 1.8850063,
           'conf_loss': 5.263474,
           'precision50': 0.1862073,
           'recall50': 0.11633988},
     '4': {'avg_iou': 0.7903417,
           'avg_obj': 0.41917393,
           'box_loss': 2.0411422,
           'class_loss': 2.003683,
           'conf_loss': 5.5225253,
           'precision50': 0.31947938,
           'recall50': 0.3374964},
     '5': {'avg_iou': 0.8428622,
           'avg_obj': 0.5852044,
           'box_loss': 1.0930742,
           'class_loss': 1.3271482,
           'conf_loss': 2.8498194,
           'precision50': 0.4353711,
           'recall50': 0.59127176},
     'global': {'total_loss': 24.261667},
     'learning_rate': 0.000131,
     'training_loss': 24.261667}
I0422 16:42:48.307129 140713659025216 controller.py:425] train | step:  430000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6862781,
           'avg_obj': 0.23956594,
           'box_loss': 2.2778623,
           'class_loss': 1.8725895,
           'conf_loss': 5.2594495,
           'precision50': 0.18646002,
           'recall50': 0.1167653},
     '4': {'avg_iou': 0.7907032,
           'avg_obj': 0.42103618,
           'box_loss': 2.0388522,
           'class_loss': 1.9937049,
           'conf_loss': 5.5108485,
           'precision50': 0.3202033,
           'recall50': 0.33935323},
     '5': {'avg_iou': 0.84336483,
           'avg_obj': 0.5870309,
           'box_loss': 1.0908413,
           'class_loss': 1.3193172,
           'conf_loss': 2.8420935,
           'precision50': 0.4359681,
           'recall50': 0.59301853},
     'global': {'total_loss': 24.205566},
     'learning_rate': 0.000131,
     'training_loss': 24.205566}
I0422 16:43:42.508498 140713659025216 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-430000.
I0422 16:43:42.514809 140713659025216 controller.py:252]  eval | step:  430000 | running 625 steps of evaluation...
I0422 16:48:05.101784 140713659025216 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0422 16:52:11.529422 140713659025216 controller.py:261]  eval | step:  430000 | eval time:  509.0 sec | output: 
    {'3': {'avg_iou': 0.50070804,
           'avg_obj': 0.22987732,
           'box_loss': 2.6156538,
           'class_loss': 1.7444754,
           'conf_loss': 6.314319,
           'precision50': 0.2691912,
           'recall50': 0.21713899},
     '4': {'avg_iou': 0.71621555,
           'avg_obj': 0.4900649,
           'box_loss': 1.9961654,
           'class_loss': 1.4043157,
           'conf_loss': 5.0568113,
           'precision50': 0.37428573,
           'recall50': 0.4978292},
     '5': {'avg_iou': 0.78149694,
           'avg_obj': 0.65370345,
           'box_loss': 1.0305017,
           'class_loss': 0.7826118,
           'conf_loss': 2.3640132,
           'precision50': 0.4193452,
           'recall50': 0.6674528},
     'AP': 0.36746374,
     'AP50': 0.5941289,
     'AP75': 0.39733908,
     'APl': 0.51113933,
     'APm': 0.3877121,
     'APs': 0.1622797,
     'ARl': 0.6607492,
     'ARm': 0.57152045,
     'ARmax1': 0.30249676,
     'ARmax10': 0.49115908,
     'ARmax100': 0.5325655,
     'ARs': 0.3273986,
     'global': {'total_loss': 23.308846},
     'validation_loss': 23.308846}
I0422 16:52:29.083420 140713659025216 controller.py:211] train | step:  430000 | training until step 450000...
I0422 17:46:57.371711 140713659025216 controller.py:425] train | step:  440000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.68661714,
           'avg_obj': 0.24089192,
           'box_loss': 2.2673173,
           'class_loss': 1.8563877,
           'conf_loss': 5.230928,
           'precision50': 0.18696375,
           'recall50': 0.117438585},
     '4': {'avg_iou': 0.7912012,
           'avg_obj': 0.42236602,
           'box_loss': 2.0245874,
           'class_loss': 1.9737478,
           'conf_loss': 5.4703937,
           'precision50': 0.3209132,
           'recall50': 0.34077317},
     '5': {'avg_iou': 0.8439227,
           'avg_obj': 0.58875334,
           'box_loss': 1.0842116,
           'class_loss': 1.3063967,
           'conf_loss': 2.8208196,
           'precision50': 0.43479103,
           'recall50': 0.5940782},
     'global': {'total_loss': 24.034771},
     'learning_rate': 0.000131,
     'training_loss': 24.034771}
I0422 18:50:36.948485 140713659025216 controller.py:425] train | step:  450000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.68747014,
           'avg_obj': 0.24190034,
           'box_loss': 2.2592857,
           'class_loss': 1.8481268,
           'conf_loss': 5.2221985,
           'precision50': 0.18702097,
           'recall50': 0.118476614},
     '4': {'avg_iou': 0.7915842,
           'avg_obj': 0.42397872,
           'box_loss': 2.0265515,
           'class_loss': 1.967591,
           'conf_loss': 5.4707336,
           'precision50': 0.3206648,
           'recall50': 0.3421114},
     '5': {'avg_iou': 0.8442938,
           'avg_obj': 0.5909468,
           'box_loss': 1.0841129,
           'class_loss': 1.297432,
           'conf_loss': 2.8138611,
           'precision50': 0.4347183,
           'recall50': 0.5957279},
     'global': {'total_loss': 23.989908},
     'learning_rate': 0.000131,
     'training_loss': 23.989908}
I0422 18:51:29.095658 140713659025216 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-450000.
I0422 18:51:29.103125 140713659025216 controller.py:252]  eval | step:  450000 | running 625 steps of evaluation...
I0422 18:55:55.979461 140713659025216 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0422 19:00:05.668973 140713659025216 controller.py:261]  eval | step:  450000 | eval time:  516.6 sec | output: 
    {'3': {'avg_iou': 0.50114864,
           'avg_obj': 0.2312372,
           'box_loss': 2.6112792,
           'class_loss': 1.7439277,
           'conf_loss': 6.308115,
           'precision50': 0.26785016,
           'recall50': 0.21799992},
     '4': {'avg_iou': 0.7163186,
           'avg_obj': 0.492866,
           'box_loss': 1.9955031,
           'class_loss': 1.4082961,
           'conf_loss': 5.049285,
           'precision50': 0.3740805,
           'recall50': 0.5001736},
     '5': {'avg_iou': 0.7820328,
           'avg_obj': 0.6562018,
           'box_loss': 1.026807,
           'class_loss': 0.7817144,
           'conf_loss': 2.3563552,
           'precision50': 0.41861275,
           'recall50': 0.66935056},
     'AP': 0.36822736,
     'AP50': 0.5956423,
     'AP75': 0.39585698,
     'APl': 0.5121291,
     'APm': 0.38888258,
     'APs': 0.16707008,
     'ARl': 0.66227365,
     'ARm': 0.5702514,
     'ARmax1': 0.30363455,
     'ARmax10': 0.49176124,
     'ARmax100': 0.53312236,
     'ARs': 0.3281526,
     'global': {'total_loss': 23.28128},
     'validation_loss': 23.28128}

train | step:  410000 | training until step 430000...
train | step:  420000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.68602884,
           'avg_obj': 0.23840734,
           'box_loss': 2.2758265,
           'class_loss': 1.8850063,
           'conf_loss': 5.263474,
           'precision50': 0.1862073,
           'recall50': 0.11633988},
     '4': {'avg_iou': 0.7903417,
           'avg_obj': 0.41917393,
           'box_loss': 2.0411422,
           'class_loss': 2.003683,
           'conf_loss': 5.5225253,
           'precision50': 0.31947938,
           'recall50': 0.3374964},
     '5': {'avg_iou': 0.8428622,
           'avg_obj': 0.5852044,
           'box_loss': 1.0930742,
           'class_loss': 1.3271482,
           'conf_loss': 2.8498194,
           'precision50': 0.4353711,
           'recall50': 0.59127176},
     'global': {'total_loss': 24.261667},
     'learning_rate': 0.000131,
     'training_loss': 24.261667}
train | step:  430000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6862781,
           'avg_obj': 0.23956594,
           'box_loss': 2.2778623,
           'class_loss': 1.8725895,
           'conf_loss': 5.2594495,
           'precision50': 0.18646002,
           'recall50': 0.1167653},
     '4': {'avg_iou': 0.7907032,
           'avg_obj': 0.42103618,
           'box_loss': 2.0388522,
           'class_loss': 1.9937049,
           'conf_loss': 5.5108485,
           'precision50': 0.3202033,
           'recall50': 0.33935323},
     '5': {'avg_iou': 0.84336483,
           'avg_obj': 0.5870309,
           'box_loss': 1.0908413,
           'class_loss': 1.3193172,
           'conf_loss': 2.8420935,
           'precision50': 0.4359681,
           'recall50': 0.59301853},
     'global': {'total_loss': 24.205566},
     'learning_rate': 0.000131,
     'training_loss': 24.205566}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-430000.
 eval | step:  430000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=179.09s).
Accumulating evaluation results...
DONE (t=14.56s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.367
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.594
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.397
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.162
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.388
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.511
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.302
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.533
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.327
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.572
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.661
 eval | step:  430000 | eval time:  509.0 sec | output: 
    {'3': {'avg_iou': 0.50070804,
           'avg_obj': 0.22987732,
           'box_loss': 2.6156538,
           'class_loss': 1.7444754,
           'conf_loss': 6.314319,
           'precision50': 0.2691912,
           'recall50': 0.21713899},
     '4': {'avg_iou': 0.71621555,
           'avg_obj': 0.4900649,
           'box_loss': 1.9961654,
           'class_loss': 1.4043157,
           'conf_loss': 5.0568113,
           'precision50': 0.37428573,
           'recall50': 0.4978292},
     '5': {'avg_iou': 0.78149694,
           'avg_obj': 0.65370345,
           'box_loss': 1.0305017,
           'class_loss': 0.7826118,
           'conf_loss': 2.3640132,
           'precision50': 0.4193452,
           'recall50': 0.6674528},
     'AP': 0.36746374,
     'AP50': 0.5941289,
     'AP75': 0.39733908,
     'APl': 0.51113933,
     'APm': 0.3877121,
     'APs': 0.1622797,
     'ARl': 0.6607492,
     'ARm': 0.57152045,
     'ARmax1': 0.30249676,
     'ARmax10': 0.49115908,
     'ARmax100': 0.5325655,
     'ARs': 0.3273986,
     'global': {'total_loss': 23.308846},
     'validation_loss': 23.308846}
train | step:  430000 | training until step 450000...
train | step:  440000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.68661714,
           'avg_obj': 0.24089192,
           'box_loss': 2.2673173,
           'class_loss': 1.8563877,
           'conf_loss': 5.230928,
           'precision50': 0.18696375,
           'recall50': 0.117438585},
     '4': {'avg_iou': 0.7912012,
           'avg_obj': 0.42236602,
           'box_loss': 2.0245874,
           'class_loss': 1.9737478,
           'conf_loss': 5.4703937,
           'precision50': 0.3209132,
           'recall50': 0.34077317},
     '5': {'avg_iou': 0.8439227,
           'avg_obj': 0.58875334,
           'box_loss': 1.0842116,
           'class_loss': 1.3063967,
           'conf_loss': 2.8208196,
           'precision50': 0.43479103,
           'recall50': 0.5940782},
     'global': {'total_loss': 24.034771},
     'learning_rate': 0.000131,
     'training_loss': 24.034771}
train | step:  450000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.68747014,
           'avg_obj': 0.24190034,
           'box_loss': 2.2592857,
           'class_loss': 1.8481268,
           'conf_loss': 5.2221985,
           'precision50': 0.18702097,
           'recall50': 0.118476614},
     '4': {'avg_iou': 0.7915842,
           'avg_obj': 0.42397872,
           'box_loss': 2.0265515,
           'class_loss': 1.967591,
           'conf_loss': 5.4707336,
           'precision50': 0.3206648,
           'recall50': 0.3421114},
     '5': {'avg_iou': 0.8442938,
           'avg_obj': 0.5909468,
           'box_loss': 1.0841129,
           'class_loss': 1.297432,
           'conf_loss': 2.8138611,
           'precision50': 0.4347183,
           'recall50': 0.5957279},
     'global': {'total_loss': 23.989908},
     'learning_rate': 0.000131,
     'training_loss': 23.989908}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-450000.
 eval | step:  450000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=179.22s).
Accumulating evaluation results...
DONE (t=13.89s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.368
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.596
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.396
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.167
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.389
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.512
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.304
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.492
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.533
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.328
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.570
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.662
 eval | step:  450000 | eval time:  516.6 sec | output: 
    {'3': {'avg_iou': 0.50114864,
           'avg_obj': 0.2312372,
           'box_loss': 2.6112792,
           'class_loss': 1.7439277,
           'conf_loss': 6.308115,
           'precision50': 0.26785016,
           'recall50': 0.21799992},
     '4': {'avg_iou': 0.7163186,
           'avg_obj': 0.492866,
           'box_loss': 1.9955031,
           'class_loss': 1.4082961,
           'conf_loss': 5.049285,
           'precision50': 0.3740805,
           'recall50': 0.5001736},
     '5': {'avg_iou': 0.7820328,
           'avg_obj': 0.6562018,
           'box_loss': 1.026807,
           'class_loss': 0.7817144,
           'conf_loss': 2.3563552,
           'precision50': 0.41861275,
           'recall50': 0.66935056},
     'AP': 0.36822736,
     'AP50': 0.5956423,
     'AP75': 0.39585698,
     'APl': 0.5121291,
     'APm': 0.38888258,
     'APs': 0.16707008,
     'ARl': 0.66227365,
     'ARm': 0.5702514,
     'ARmax1': 0.30363455,
     'ARmax10': 0.49176124,
     'ARmax100': 0.53312236,
     'ARs': 0.3281526,
     'global': {'total_loss': 23.28128},
     'validation_loss': 23.28128}I0422 19:00:22.148036 140713659025216 controller.py:211] train | step:  450000 | training until step 470000...
I0422 19:52:21.547425 140713659025216 controller.py:425] train | step:  460000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.688591,
           'avg_obj': 0.243453,
           'box_loss': 2.2568095,
           'class_loss': 1.8399469,
           'conf_loss': 5.2205834,
           'precision50': 0.18833515,
           'recall50': 0.11962076},
     '4': {'avg_iou': 0.7925142,
           'avg_obj': 0.42634854,
           'box_loss': 2.0208392,
           'class_loss': 1.9579656,
           'conf_loss': 5.454695,
           'precision50': 0.3219922,
           'recall50': 0.3444066},
     '5': {'avg_iou': 0.8450519,
           'avg_obj': 0.5927301,
           'box_loss': 1.0786393,
           'class_loss': 1.290297,
           'conf_loss': 2.8005161,
           'precision50': 0.43456686,
           'recall50': 0.5976562},
     'global': {'total_loss': 23.920307},
     'learning_rate': 1.31e-05,
     'training_loss': 23.920307}
I0422 20:53:46.169931 140713659025216 controller.py:425] train | step:  470000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.68855274,
           'avg_obj': 0.24350561,
           'box_loss': 2.2644577,
           'class_loss': 1.8404967,
           'conf_loss': 5.237792,
           'precision50': 0.1879125,
           'recall50': 0.119701944},
     '4': {'avg_iou': 0.79270333,
           'avg_obj': 0.42682138,
           'box_loss': 2.0224547,
           'class_loss': 1.9514316,
           'conf_loss': 5.45833,
           'precision50': 0.32151696,
           'recall50': 0.34479514},
     '5': {'avg_iou': 0.84517676,
           'avg_obj': 0.5935549,
           'box_loss': 1.07832,
           'class_loss': 1.2832996,
           'conf_loss': 2.7946408,
           'precision50': 0.4351251,
           'recall50': 0.5986789},
     'global': {'total_loss': 23.93124},
     'learning_rate': 1.31e-05,
     'training_loss': 23.93124}
I0422 20:54:37.458449 140713659025216 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-470000.
I0422 20:54:37.466044 140713659025216 controller.py:252]  eval | step:  470000 | running 625 steps of evaluation...
I0422 20:59:03.053900 140713659025216 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0422 21:03:13.527416 140713659025216 controller.py:261]  eval | step:  470000 | eval time:  516.1 sec | output: 
    {'3': {'avg_iou': 0.50097847,
           'avg_obj': 0.23091352,
           'box_loss': 2.6132429,
           'class_loss': 1.7441504,
           'conf_loss': 6.306562,
           'precision50': 0.26981807,
           'recall50': 0.21725808},
     '4': {'avg_iou': 0.71610916,
           'avg_obj': 0.4933333,
           'box_loss': 1.9967484,
           'class_loss': 1.4075519,
           'conf_loss': 5.0546465,
           'precision50': 0.37303025,
           'recall50': 0.5006639},
     '5': {'avg_iou': 0.78152096,
           'avg_obj': 0.65714586,
           'box_loss': 1.0294435,
           'class_loss': 0.7819607,
           'conf_loss': 2.364435,
           'precision50': 0.41742992,
           'recall50': 0.66987735},
     'AP': 0.36781248,
     'AP50': 0.59574026,
     'AP75': 0.39346057,
     'APl': 0.5114672,
     'APm': 0.38793153,
     'APs': 0.16716115,
     'ARl': 0.66120327,
     'ARm': 0.5695012,
     'ARmax1': 0.3030646,
     'ARmax10': 0.4910151,
     'ARmax100': 0.5325898,
     'ARs': 0.328731,
     'global': {'total_loss': 23.298754},
     'validation_loss': 23.298754}
I0422 21:03:31.017190 140713659025216 controller.py:211] train | step:  470000 | training until step 490000...
I0422 21:55:20.072395 140713659025216 controller.py:425] train | step:  480000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6885464,
           'avg_obj': 0.24410784,
           'box_loss': 2.2567794,
           'class_loss': 1.8337069,
           'conf_loss': 5.2186403,
           'precision50': 0.18825524,
           'recall50': 0.11987948},
     '4': {'avg_iou': 0.7929403,
           'avg_obj': 0.42691812,
           'box_loss': 2.014173,
           'class_loss': 1.9467863,
           'conf_loss': 5.4393115,
           'precision50': 0.32141972,
           'recall50': 0.34543723},
     '5': {'avg_iou': 0.84535235,
           'avg_obj': 0.59412473,
           'box_loss': 1.0752218,
           'class_loss': 1.281267,
           'conf_loss': 2.7875643,
           'precision50': 0.43470648,
           'recall50': 0.5993269},
     'global': {'total_loss': 23.853466},
     'learning_rate': 1.31e-05,
     'training_loss': 23.853466}
I0422 22:56:52.633544 140713659025216 controller.py:425] train | step:  490000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6891165,
           'avg_obj': 0.24473764,
           'box_loss': 2.2593312,
           'class_loss': 1.8314996,
           'conf_loss': 5.226346,
           'precision50': 0.18900153,
           'recall50': 0.12050784},
     '4': {'avg_iou': 0.79275286,
           'avg_obj': 0.42764854,
           'box_loss': 2.0194452,
           'class_loss': 1.94833,
           'conf_loss': 5.4476323,
           'precision50': 0.32140836,
           'recall50': 0.34552625},
     '5': {'avg_iou': 0.84522927,
           'avg_obj': 0.59421384,
           'box_loss': 1.0765854,
           'class_loss': 1.2794403,
           'conf_loss': 2.7876747,
           'precision50': 0.4352557,
           'recall50': 0.59969527},
     'global': {'total_loss': 23.876259},
     'learning_rate': 1.31e-05,
     'training_loss': 23.876259}
I0422 22:57:43.692812 140713659025216 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-490000.
I0422 22:57:43.699999 140713659025216 controller.py:252]  eval | step:  490000 | running 625 steps of evaluation...
I0422 23:02:02.599092 140713659025216 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0422 23:06:16.849210 140713659025216 controller.py:261]  eval | step:  490000 | eval time:  513.1 sec | output: 
    {'3': {'avg_iou': 0.5010826,
           'avg_obj': 0.2314969,
           'box_loss': 2.6128001,
           'class_loss': 1.7444211,
           'conf_loss': 6.3036723,
           'precision50': 0.26879254,
           'recall50': 0.21934931},
     '4': {'avg_iou': 0.7162148,
           'avg_obj': 0.49436298,
           'box_loss': 1.995998,
           'class_loss': 1.408656,
           'conf_loss': 5.056306,
           'precision50': 0.3732842,
           'recall50': 0.50174063},
     '5': {'avg_iou': 0.7816502,
           'avg_obj': 0.65742475,
           'box_loss': 1.0287893,
           'class_loss': 0.78179353,
           'conf_loss': 2.3625844,
           'precision50': 0.41755602,
           'recall50': 0.6704413},
     'AP': 0.36828592,
     'AP50': 0.59619445,
     'AP75': 0.3945498,
     'APl': 0.51190525,
     'APm': 0.38844645,
     'APs': 0.16763136,
     'ARl': 0.6618639,
     'ARm': 0.5692699,
     'ARmax1': 0.30359268,
     'ARmax10': 0.49136138,
     'ARmax100': 0.53291166,
     'ARs': 0.3288256,
     'global': {'total_loss': 23.295034},
     'validation_loss': 23.295034}

train | step:  450000 | training until step 470000...
train | step:  460000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.688591,
           'avg_obj': 0.243453,
           'box_loss': 2.2568095,
           'class_loss': 1.8399469,
           'conf_loss': 5.2205834,
           'precision50': 0.18833515,
           'recall50': 0.11962076},
     '4': {'avg_iou': 0.7925142,
           'avg_obj': 0.42634854,
           'box_loss': 2.0208392,
           'class_loss': 1.9579656,
           'conf_loss': 5.454695,
           'precision50': 0.3219922,
           'recall50': 0.3444066},
     '5': {'avg_iou': 0.8450519,
           'avg_obj': 0.5927301,
           'box_loss': 1.0786393,
           'class_loss': 1.290297,
           'conf_loss': 2.8005161,
           'precision50': 0.43456686,
           'recall50': 0.5976562},
     'global': {'total_loss': 23.920307},
     'learning_rate': 1.31e-05,
     'training_loss': 23.920307}
train | step:  470000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.68855274,
           'avg_obj': 0.24350561,
           'box_loss': 2.2644577,
           'class_loss': 1.8404967,
           'conf_loss': 5.237792,
           'precision50': 0.1879125,
           'recall50': 0.119701944},
     '4': {'avg_iou': 0.79270333,
           'avg_obj': 0.42682138,
           'box_loss': 2.0224547,
           'class_loss': 1.9514316,
           'conf_loss': 5.45833,
           'precision50': 0.32151696,
           'recall50': 0.34479514},
     '5': {'avg_iou': 0.84517676,
           'avg_obj': 0.5935549,
           'box_loss': 1.07832,
           'class_loss': 1.2832996,
           'conf_loss': 2.7946408,
           'precision50': 0.4351251,
           'recall50': 0.5986789},
     'global': {'total_loss': 23.93124},
     'learning_rate': 1.31e-05,
     'training_loss': 23.93124}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-470000.
 eval | step:  470000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=179.31s).
Accumulating evaluation results...
DONE (t=14.15s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.368
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.596
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.393
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.167
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.388
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.511
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.303
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.533
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.329
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.570
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.661
 eval | step:  470000 | eval time:  516.1 sec | output: 
    {'3': {'avg_iou': 0.50097847,
           'avg_obj': 0.23091352,
           'box_loss': 2.6132429,
           'class_loss': 1.7441504,
           'conf_loss': 6.306562,
           'precision50': 0.26981807,
           'recall50': 0.21725808},
     '4': {'avg_iou': 0.71610916,
           'avg_obj': 0.4933333,
           'box_loss': 1.9967484,
           'class_loss': 1.4075519,
           'conf_loss': 5.0546465,
           'precision50': 0.37303025,
           'recall50': 0.5006639},
     '5': {'avg_iou': 0.78152096,
           'avg_obj': 0.65714586,
           'box_loss': 1.0294435,
           'class_loss': 0.7819607,
           'conf_loss': 2.364435,
           'precision50': 0.41742992,
           'recall50': 0.66987735},
     'AP': 0.36781248,
     'AP50': 0.59574026,
     'AP75': 0.39346057,
     'APl': 0.5114672,
     'APm': 0.38793153,
     'APs': 0.16716115,
     'ARl': 0.66120327,
     'ARm': 0.5695012,
     'ARmax1': 0.3030646,
     'ARmax10': 0.4910151,
     'ARmax100': 0.5325898,
     'ARs': 0.328731,
     'global': {'total_loss': 23.298754},
     'validation_loss': 23.298754}
train | step:  470000 | training until step 490000...
train | step:  480000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6885464,
           'avg_obj': 0.24410784,
           'box_loss': 2.2567794,
           'class_loss': 1.8337069,
           'conf_loss': 5.2186403,
           'precision50': 0.18825524,
           'recall50': 0.11987948},
     '4': {'avg_iou': 0.7929403,
           'avg_obj': 0.42691812,
           'box_loss': 2.014173,
           'class_loss': 1.9467863,
           'conf_loss': 5.4393115,
           'precision50': 0.32141972,
           'recall50': 0.34543723},
     '5': {'avg_iou': 0.84535235,
           'avg_obj': 0.59412473,
           'box_loss': 1.0752218,
           'class_loss': 1.281267,
           'conf_loss': 2.7875643,
           'precision50': 0.43470648,
           'recall50': 0.5993269},
     'global': {'total_loss': 23.853466},
     'learning_rate': 1.31e-05,
     'training_loss': 23.853466}
train | step:  490000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6891165,
           'avg_obj': 0.24473764,
           'box_loss': 2.2593312,
           'class_loss': 1.8314996,
           'conf_loss': 5.226346,
           'precision50': 0.18900153,
           'recall50': 0.12050784},
     '4': {'avg_iou': 0.79275286,
           'avg_obj': 0.42764854,
           'box_loss': 2.0194452,
           'class_loss': 1.94833,
           'conf_loss': 5.4476323,
           'precision50': 0.32140836,
           'recall50': 0.34552625},
     '5': {'avg_iou': 0.84522927,
           'avg_obj': 0.59421384,
           'box_loss': 1.0765854,
           'class_loss': 1.2794403,
           'conf_loss': 2.7876747,
           'precision50': 0.4352557,
           'recall50': 0.59969527},
     'global': {'total_loss': 23.876259},
     'learning_rate': 1.31e-05,
     'training_loss': 23.876259}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-490000.
 eval | step:  490000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=182.58s).
Accumulating evaluation results...
DONE (t=13.76s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.368
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.596
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.395
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.168
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.388
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.512
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.304
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.533
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.329
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.569
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.662
 eval | step:  490000 | eval time:  513.1 sec | output: 
    {'3': {'avg_iou': 0.5010826,
           'avg_obj': 0.2314969,
           'box_loss': 2.6128001,
           'class_loss': 1.7444211,
           'conf_loss': 6.3036723,
           'precision50': 0.26879254,
           'recall50': 0.21934931},
     '4': {'avg_iou': 0.7162148,
           'avg_obj': 0.49436298,
           'box_loss': 1.995998,
           'class_loss': 1.408656,
           'conf_loss': 5.056306,
           'precision50': 0.3732842,
           'recall50': 0.50174063},
     '5': {'avg_iou': 0.7816502,
           'avg_obj': 0.65742475,
           'box_loss': 1.0287893,
           'class_loss': 0.78179353,
           'conf_loss': 2.3625844,
           'precision50': 0.41755602,
           'recall50': 0.6704413},
     'AP': 0.36828592,
     'AP50': 0.59619445,
     'AP75': 0.3945498,
     'APl': 0.51190525,
     'APm': 0.38844645,
     'APs': 0.16763136,
     'ARl': 0.6618639,
     'ARm': 0.5692699,
     'ARmax1': 0.30359268,
     'ARmax10': 0.49136138,
     'ARmax100': 0.53291166,
     'ARs': 0.3288256,
     'global': {'total_loss': 23.295034},
     'validation_loss': 23.295034}I0422 23:06:34.261421 140713659025216 controller.py:211] train | step:  490000 | training until step 500500...
I0422 23:58:18.008701 140713659025216 controller.py:425] train | step:  500000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6885856,
           'avg_obj': 0.24447161,
           'box_loss': 2.2600615,
           'class_loss': 1.8363132,
           'conf_loss': 5.222854,
           'precision50': 0.18867597,
           'recall50': 0.12040564},
     '4': {'avg_iou': 0.7930013,
           'avg_obj': 0.4272774,
           'box_loss': 2.0150423,
           'class_loss': 1.9467859,
           'conf_loss': 5.440978,
           'precision50': 0.32161313,
           'recall50': 0.34602416},
     '5': {'avg_iou': 0.8454878,
           'avg_obj': 0.5941527,
           'box_loss': 1.0753328,
           'class_loss': 1.2775526,
           'conf_loss': 2.7893484,
           'precision50': 0.4347252,
           'recall50': 0.5997575},
     'global': {'total_loss': 23.864275},
     'learning_rate': 1.31e-05,
     'training_loss': 23.864275}
I0423 00:01:22.378843 140713659025216 controller.py:425] train | step:  500500 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6890032,
           'avg_obj': 0.24446464,
           'box_loss': 2.2335563,
           'class_loss': 1.8275285,
           'conf_loss': 5.177514,
           'precision50': 0.18566483,
           'recall50': 0.11815614},
     '4': {'avg_iou': 0.7925736,
           'avg_obj': 0.4268507,
           'box_loss': 2.0044565,
           'class_loss': 1.9380951,
           'conf_loss': 5.4215193,
           'precision50': 0.3177895,
           'recall50': 0.34328032},
     '5': {'avg_iou': 0.84562314,
           'avg_obj': 0.5948776,
           'box_loss': 1.0714427,
           'class_loss': 1.2676483,
           'conf_loss': 2.7782156,
           'precision50': 0.43371457,
           'recall50': 0.59898233},
     'global': {'total_loss': 23.719965},
     'learning_rate': 1.31e-05,
     'training_loss': 23.719965}
I0423 00:01:37.437336 140713659025216 controller.py:252]  eval | step:  500500 | running 625 steps of evaluation...
I0423 00:06:00.130999 140713659025216 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0423 00:10:01.953530 140713659025216 controller.py:261]  eval | step:  500500 | eval time:  504.5 sec | output: 
    {'3': {'avg_iou': 0.5009804,
           'avg_obj': 0.23174392,
           'box_loss': 2.6136885,
           'class_loss': 1.7434201,
           'conf_loss': 6.305653,
           'precision50': 0.26803216,
           'recall50': 0.2187312},
     '4': {'avg_iou': 0.71614563,
           'avg_obj': 0.4943476,
           'box_loss': 1.9969143,
           'class_loss': 1.40796,
           'conf_loss': 5.057486,
           'precision50': 0.37275854,
           'recall50': 0.5019473},
     '5': {'avg_iou': 0.7817332,
           'avg_obj': 0.65772474,
           'box_loss': 1.0285666,
           'class_loss': 0.7815101,
           'conf_loss': 2.3629403,
           'precision50': 0.41746807,
           'recall50': 0.6709502},
     'AP': 0.3681088,
     'AP50': 0.59589714,
     'AP75': 0.39467198,
     'APl': 0.51198375,
     'APm': 0.3884154,
     'APs': 0.16752596,
     'ARl': 0.6605715,
     'ARm': 0.5693157,
     'ARmax1': 0.30328536,
     'ARmax10': 0.49063227,
     'ARmax100': 0.5317933,
     'ARs': 0.3273849,
     'global': {'total_loss': 23.298132},
     'validation_loss': 23.298132}
I0423 00:11:02.077205 140713659025216 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-500500.
I0423 00:11:02.094067 140713659025216 train_lib.py:123] Number of trainable params in model: 64.488640 Millions.

train | step:  490000 | training until step 500500...
train | step:  500000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6885856,
           'avg_obj': 0.24447161,
           'box_loss': 2.2600615,
           'class_loss': 1.8363132,
           'conf_loss': 5.222854,
           'precision50': 0.18867597,
           'recall50': 0.12040564},
     '4': {'avg_iou': 0.7930013,
           'avg_obj': 0.4272774,
           'box_loss': 2.0150423,
           'class_loss': 1.9467859,
           'conf_loss': 5.440978,
           'precision50': 0.32161313,
           'recall50': 0.34602416},
     '5': {'avg_iou': 0.8454878,
           'avg_obj': 0.5941527,
           'box_loss': 1.0753328,
           'class_loss': 1.2775526,
           'conf_loss': 2.7893484,
           'precision50': 0.4347252,
           'recall50': 0.5997575},
     'global': {'total_loss': 23.864275},
     'learning_rate': 1.31e-05,
     'training_loss': 23.864275}
train | step:  500500 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6890032,
           'avg_obj': 0.24446464,
           'box_loss': 2.2335563,
           'class_loss': 1.8275285,
           'conf_loss': 5.177514,
           'precision50': 0.18566483,
           'recall50': 0.11815614},
     '4': {'avg_iou': 0.7925736,
           'avg_obj': 0.4268507,
           'box_loss': 2.0044565,
           'class_loss': 1.9380951,
           'conf_loss': 5.4215193,
           'precision50': 0.3177895,
           'recall50': 0.34328032},
     '5': {'avg_iou': 0.84562314,
           'avg_obj': 0.5948776,
           'box_loss': 1.0714427,
           'class_loss': 1.2676483,
           'conf_loss': 2.7782156,
           'precision50': 0.43371457,
           'recall50': 0.59898233},
     'global': {'total_loss': 23.719965},
     'learning_rate': 1.31e-05,
     'training_loss': 23.719965}
 eval | step:  500500 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=174.89s).
Accumulating evaluation results...
DONE (t=13.70s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.368
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.596
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.395
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.168
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.388
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.512
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.303
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.532
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.327
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.569
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.661
 eval | step:  500500 | eval time:  504.5 sec | output: 
    {'3': {'avg_iou': 0.5009804,
           'avg_obj': 0.23174392,
           'box_loss': 2.6136885,
           'class_loss': 1.7434201,
           'conf_loss': 6.305653,
           'precision50': 0.26803216,
           'recall50': 0.2187312},
     '4': {'avg_iou': 0.71614563,
           'avg_obj': 0.4943476,
           'box_loss': 1.9969143,
           'class_loss': 1.40796,
           'conf_loss': 5.057486,
           'precision50': 0.37275854,
           'recall50': 0.5019473},
     '5': {'avg_iou': 0.7817332,
           'avg_obj': 0.65772474,
           'box_loss': 1.0285666,
           'class_loss': 0.7815101,
           'conf_loss': 2.3629403,
           'precision50': 0.41746807,
           'recall50': 0.6709502},
     'AP': 0.3681088,
     'AP50': 0.59589714,
     'AP75': 0.39467198,
     'APl': 0.51198375,
     'APm': 0.3884154,
     'APs': 0.16752596,
     'ARl': 0.6605715,
     'ARm': 0.5693157,
     'ARmax1': 0.30328536,
     'ARmax10': 0.49063227,
     'ARmax100': 0.5317933,
     'ARs': 0.3273849,
     'global': {'total_loss': 23.298132},
     'validation_loss': 23.298132}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-angle-ema-500k/ckpt-500500.
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   233    0     2  100   231     11   1327 --:--:-- --:--:-- --:--:--  1339
okRequest issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-23T00:13:44.854663657Z'
  endTime: '2021-04-23T00:14:22.046427922Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619136824828-5c098ab4962b4-ae6c35da-f04fcdd8
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1619136824828-5c098ab4962b4-ae6c35da-f04fcdd8] to complete...
...................................................................................................................................................................................................done.
