cat: .experiment_zone: No such file or directory
Request issued for: [node-3]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-19T18:47:14.397802345Z'
  endTime: '2021-04-19T18:47:52.924339450Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618858034374-5c057c214a69b-7fdf5699-65a200e2
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618858034374-5c057c214a69b-7fdf5699-65a200e2] to complete...
......................................................................................................................................................................................................done.
europe-west4-a
I0419 18:45:59.809091 139862618326848 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 30.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.14,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 2.5,
                                    'aug_scale_min': 0.1,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.6,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.213,
                                         'aug_rand_angle': 30.0,
                                         'aug_rand_brightness': 0.5,
                                         'aug_rand_hue': 0.15,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 2.4,
                                         'aug_scale_min': 0.1,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.9,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.75, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 1.0,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.001},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': None,
                                  'learning_rate': {'stepwise': {'boundaries': [240000,
                                                                                260000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00131,
                                                                            0.000131,
                                                                            1.31e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'adam': {'amsgrad': False,
                                                         'beta_1': 0.949,
                                                         'beta_2': 0.999,
                                                         'clipnorm': None,
                                                         'clipvalue': None,
                                                         'epsilon': 1e-07,
                                                         'global_clipnorm': None,
                                                         'name': 'adam'},
                                                'type': 'adam'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 2000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0419 18:45:59.810012 139862618326848 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_tests/250k-512-aggressive-adam/params.yaml
I0419 18:46:01.365530 139862618326848 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0419 18:46:01.985150 139862618326848 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0419 18:46:01.985392 139862618326848 transport.py:157] Attempting refresh to obtain initial access_token
I0419 18:46:02.033376 139862618326848 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0419 18:46:02.177217 139862618326848 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0419 18:46:02.177453 139862618326848 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-19 18:46:02.232142: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0419 18:46:02.232765 139862618326848 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0419 18:46:02.376996 139862618326848 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0419 18:46:02.377238 139862618326848 transport.py:157] Attempting refresh to obtain initial access_token
I0419 18:46:02.485058 139862618326848 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0419 18:46:03.105244 139862618326848 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0419 18:46:03.105507 139862618326848 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-19 18:46:03.149047: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-19 18:46:03.160499: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-04-19 18:46:03.160578: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:59863}
2021-04-19 18:46:40.939832: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-04-19 18:46:40.940015: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:59863}
2021-04-19 18:46:40.940823: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:59863
I0419 18:46:40.942176 139862618326848 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-3
I0419 18:46:40.943319 139862618326848 tpu_strategy_util.py:74] Initializing the TPU system: node-3
INFO:tensorflow:Clearing out eager caches
I0419 18:46:48.242098 139862618326848 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0419 18:46:48.244252 139862618326848 tpu_strategy_util.py:133] Finished initializing TPU system.
I0419 18:46:48.246143 139862618326848 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0419 18:46:48.394121 139862618326848 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0419 18:46:48.394509 139862618326848 transport.py:157] Attempting refresh to obtain initial access_token
I0419 18:46:48.464565 139862618326848 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0419 18:46:49.081130 139862618326848 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0419 18:46:49.081372 139862618326848 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0419 18:46:49.130671 139862618326848 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0419 18:46:49.130907 139862618326848 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0419 18:46:49.131172 139862618326848 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0419 18:46:49.131224 139862618326848 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0419 18:46:49.131273 139862618326848 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0419 18:46:49.131388 139862618326848 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0419 18:46:49.131435 139862618326848 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0419 18:46:49.131481 139862618326848 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0419 18:46:49.131522 139862618326848 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0419 18:46:49.131563 139862618326848 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0419 18:46:49.131607 139862618326848 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0419 18:46:49.131663 139862618326848 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0419 18:46:49.131707 139862618326848 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0419 18:46:49.131749 139862618326848 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0419 18:46:49.131800 139862618326848 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0419 18:46:49.131860 139862618326848 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0419 18:46:49.133049 139862618326848 train_utils.py:214] Running default trainer.
2021-04-19 18:46:49.152815: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.14, 'aug_scale_min': 0.1, 'aug_scale_max': 2.5, 'aug_rand_angle': 30.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.9, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.15, 'aug_scale_min': 0.1, 'aug_scale_max': 2.4, 'aug_rand_angle': 30.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.75, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 1.0, 'random_crop_mosaic': False}}}, 'weight_decay': 0.001, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'adam', 'adam': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'adam', 'beta_1': 0.949, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}}, 'ema': None, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [240000, 260000], 'values': [0.00131, 0.000131, 1.31e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 2000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05} 0.0005
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f33e45466a0>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________
yolo_fpn (YoloFPN)              {'5': (None, 16, 16, 15165440    input_2[0][0]                    
                                                                 input_3[0][0]                    
                                                                 input_4[0][0]                    I0419 18:47:36.078964 139862618326848 controller.py:362] restoring or initializing model...
I0419 18:47:44.115042 139862618326848 yolo.py:529] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0419 18:47:44.116997 139862618326848 controller.py:368] initialized model.
I0419 18:47:44.117225 139862618326848 train_lib.py:96] Starts to execute mode: train_and_eval
I0419 18:47:44.122402 139862618326848 controller.py:211] train | step:      0 | training until step 20000...
I0419 18:47:52.218153 139862618326848 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0419 18:48:58.259347 139862618326848 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is READY
europe-west4-a
I0419 18:52:18.559372 139626383488832 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 30.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.14,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 2.5,
                                    'aug_scale_min': 0.1,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.6,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.213,
                                         'aug_rand_angle': 30.0,
                                         'aug_rand_brightness': 0.5,
                                         'aug_rand_hue': 0.15,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 2.4,
                                         'aug_scale_min': 0.1,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.9,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.75, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 1.0,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.001},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': None,
                                  'learning_rate': {'stepwise': {'boundaries': [240000,
                                                                                260000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00131,
                                                                            0.000131,
                                                                            1.31e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'adam': {'amsgrad': False,
                                                         'beta_1': 0.949,
                                                         'beta_2': 0.999,
                                                         'clipnorm': None,
                                                         'clipvalue': None,
                                                         'epsilon': 1e-07,
                                                         'global_clipnorm': None,
                                                         'name': 'adam'},
                                                'type': 'adam'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 2000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0419 18:52:18.560399 139626383488832 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_tests/250k-512-aggressive-adam/params.yaml
I0419 18:52:19.399772 139626383488832 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0419 18:52:19.553868 139626383488832 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0419 18:52:19.554089 139626383488832 transport.py:157] Attempting refresh to obtain initial access_token
I0419 18:52:19.623556 139626383488832 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0419 18:52:20.255683 139626383488832 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0419 18:52:20.255984 139626383488832 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-19 18:52:20.333074: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0419 18:52:20.333678 139626383488832 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0419 18:52:20.480028 139626383488832 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0419 18:52:20.480237 139626383488832 transport.py:157] Attempting refresh to obtain initial access_token
I0419 18:52:20.525325 139626383488832 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0419 18:52:20.680680 139626383488832 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0419 18:52:20.680886 139626383488832 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-19 18:52:20.732287: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-19 18:52:20.746209: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-04-19 18:52:20.746283: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:60061}
2021-04-19 18:52:20.761886: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-04-19 18:52:20.761957: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:60061}
2021-04-19 18:52:20.762771: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:60061
I0419 18:52:20.763547 139626383488832 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-3
I0419 18:52:20.764015 139626383488832 tpu_strategy_util.py:74] Initializing the TPU system: node-3
INFO:tensorflow:Clearing out eager caches
I0419 19:58:53.320802 139626383488832 tpu_strategy_util.py:109] Clearing out eager caches
2021-04-19 19:58:53.323526: W tensorflow/core/distributed_runtime/eager/remote_tensor_handle_data.cc:76] Unable to destroy remote tensor handles. If you are running a tf.function, it usually indicates some op in the graph gets an error: SharedMemoryAddress expired.
INFO:tensorflow:Finished initializing TPU system.
I0419 19:58:53.323895 139626383488832 tpu_strategy_util.py:133] Finished initializing TPU system.
I0419 19:58:53.325560 139626383488832 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 149, in main
    model_dir=model_dir)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_lib.py", line 104, in run_experiment
    eval_interval=params.trainer.validation_interval)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 303, in train_and_evaluate
    self.train(steps=num_steps, checkpoint_at_completion=False)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 215, in train
    self._train_n_steps(num_steps)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 410, in _train_n_steps
    train_output = self.trainer.train(num_steps_tensor)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/standard_runner.py", line 142, in train
    return self.train_loop_end()
  File "/home/cam2tensorflow/TensorFlowModels/official/core/base_trainer.py", line 276, in train_loop_end
    self._recovery.maybe_recover(self.train_loss.result().numpy(),
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 1071, in numpy
    maybe_arr = self._numpy()  # pylint: disable=protected-access
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 1039, in _numpy
    six.raise_from(core._status_to_exception(e.code, e.message), None)  # pylint: disable=protected-access
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.FailedPreconditionError: SharedMemoryAddress expired.
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/tpu_strategy.py", line 738, in async_wait
    context.async_wait()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/context.py", line 2330, in async_wait
    context().sync_executors()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/context.py", line 645, in sync_executors
    pywrap_tfe.TFE_ContextSyncExecutors(self._context_handle)
tensorflow.python.framework.errors_impl.FailedPreconditionError: SharedMemoryAddress expired.

__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'3': (None, 64, 64, 22153728    yolo_fpn[0][0]                   
                                                                 yolo_fpn[0][1]                   
                                                                 yolo_fpn[0][2]                   
==================================================================================================
Total params: 37,319,168
Trainable params: 37,288,192
Non-trainable params: 30,976
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 37319168  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 64,488,640
Trainable params: 64,422,336
Non-trainable params: 66,304
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 200, 8), 4: (8, 200, 8), 5: (8, 200, 8)}, inds: {3: (8, 200, 3), 4: (8, 200, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
I0419 19:58:53.950231 139626383488832 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0419 19:58:53.950489 139626383488832 transport.py:157] Attempting refresh to obtain initial access_token
I0419 19:58:54.025319 139626383488832 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0419 19:58:54.170717 139626383488832 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0419 19:58:54.170932 139626383488832 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0419 19:58:54.228555 139626383488832 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0419 19:58:54.228780 139626383488832 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0419 19:58:54.229256 139626383488832 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0419 19:58:54.229311 139626383488832 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0419 19:58:54.229357 139626383488832 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0419 19:58:54.229525 139626383488832 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0419 19:58:54.229574 139626383488832 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0419 19:58:54.229619 139626383488832 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0419 19:58:54.229665 139626383488832 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0419 19:58:54.229721 139626383488832 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0419 19:58:54.229764 139626383488832 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0419 19:58:54.229813 139626383488832 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0419 19:58:54.229855 139626383488832 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0419 19:58:54.229896 139626383488832 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0419 19:58:54.229938 139626383488832 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0419 19:58:54.229987 139626383488832 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0419 19:58:54.231469 139626383488832 train_utils.py:214] Running default trainer.
2021-04-19 19:58:54.253137: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
2021-04-19 19:58:54.390176: W tensorflow/core/distributed_runtime/eager/remote_tensor_handle_data.cc:76] Unable to destroy remote tensor handles. If you are running a tf.function, it usually indicates some op in the graph gets an error: SharedMemoryAddress expired.
2021-04-19 19:59:01.022028: W ./tensorflow/core/distributed_runtime/eager/destroy_tensor_handle_node.h:57] Ignoring an error encountered when deleting remote tensors handles: Invalid argument: Unable to find the relevant tensor remote_handle: Op ID: 34850, Output num: 0
Additional GRPC error information from remote target /job:worker/replica:0/task:0:
:{"created":"@1618862341.021857222","description":"Error received from peer ipv4:10.91.127.66:8470","file":"external/com_github_grpc_grpc/src/core/lib/surface/call.cc","file_line":1056,"grpc_message":"Unable to find the relevant tensor remote_handle: Op ID: 34850, Output num: 0","grpc_status":3}
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.14, 'aug_scale_min': 0.1, 'aug_scale_max': 2.5, 'aug_rand_angle': 30.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.9, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.15, 'aug_scale_min': 0.1, 'aug_scale_max': 2.4, 'aug_rand_angle': 30.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.75, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 1.0, 'random_crop_mosaic': False}}}, 'weight_decay': 0.001, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'adam', 'adam': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'adam', 'beta_1': 0.949, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}}, 'ema': None, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [240000, 260000], 'values': [0.00131, 0.000131, 1.31e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 2000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05} 0.0005
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7efce429b630>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   223    0     2  100   221     10   1133 --:--:-- --:--:-- --:--:--  1143
okRequest issued for: [node-3]

DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________
yolo_fpn (YoloFPN)              {'5': (None, 16, 16, 15165440    input_2[0][0]                    
                                                                 input_3[0][0]                    
                                                                 input_4[0][0]                    2021-04-19 19:59:22.061184: E tensorflow/core/common_runtime/eager/context.cc:646] Failed to register function remotely due to Connection reset by peer
This could happen if the remote target has been disconnected from the client.
2021-04-19 19:59:22.061274: E tensorflow/core/common_runtime/eager/context.cc:646] Failed to register function remotely due to Connection reset by peer
This could happen if the remote target has been disconnected from the client.
2021-04-19 19:59:22.061289: E tensorflow/core/common_runtime/eager/context.cc:646] Failed to register function remotely due to Connection reset by peer
This could happen if the remote target has been disconnected from the client.
2021-04-19 19:59:22.061319: E tensorflow/core/common_runtime/eager/context.cc:646] Failed to register function remotely due to Connection reset by peer
This could happen if the remote target has been disconnected from the client.
2021-04-19 19:59:22.061331: E tensorflow/core/common_runtime/eager/context.cc:646] Failed to register function remotely due to Connection reset by peer
This could happen if the remote target has been disconnected from the client.
2021-04-19 19:59:22.061341: E tensorflow/core/common_runtime/eager/context.cc:646] Failed to register function remotely due to Connection reset by peer
This could happen if the remote target has been disconnected from the client.
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-19T20:01:05.802332969Z'
  endTime: '2021-04-19T20:02:02.376423056Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618862465779-5c058ca368753-e10fc01a-52b0517e
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618862465779-5c058ca368753-e10fc01a-52b0517e] to complete...
..............................................................................................................................................................................................................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-3]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-19T22:59:36.512239604Z'
  endTime: '2021-04-19T23:00:10.073873732Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618873176485-5c05b489eeddf-f189f704-c5745ee6
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618873176485-5c05b489eeddf-f189f704-c5745ee6] to complete...
....................................................................................................................................................................................................done.
europe-west4-a
I0419 22:58:21.184654 139842769708864 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 30.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.14,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 2.5,
                                    'aug_scale_min': 0.1,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.6,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.213,
                                         'aug_rand_angle': 30.0,
                                         'aug_rand_brightness': 0.5,
                                         'aug_rand_hue': 0.15,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 2.4,
                                         'aug_scale_min': 0.1,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.9,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.75, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 1.0,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.001},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': None,
                                  'learning_rate': {'stepwise': {'boundaries': [240000,
                                                                                260000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00131,
                                                                            0.000131,
                                                                            1.31e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'adam': {'amsgrad': False,
                                                         'beta_1': 0.949,
                                                         'beta_2': 0.999,
                                                         'clipnorm': None,
                                                         'clipvalue': None,
                                                         'epsilon': 1e-07,
                                                         'global_clipnorm': None,
                                                         'name': 'adam'},
                                                'type': 'adam'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 2000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0419 22:58:21.185802 139842769708864 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_tests/250k-512-aggressive-adam/params.yaml
I0419 22:58:22.059195 139842769708864 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0419 22:58:22.210346 139842769708864 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0419 22:58:22.210622 139842769708864 transport.py:157] Attempting refresh to obtain initial access_token
I0419 22:58:22.258083 139842769708864 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0419 22:58:22.881990 139842769708864 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0419 22:58:22.882449 139842769708864 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-19 22:58:22.927333: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0419 22:58:22.928177 139842769708864 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0419 22:58:23.070653 139842769708864 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0419 22:58:23.070945 139842769708864 transport.py:157] Attempting refresh to obtain initial access_token
I0419 22:58:23.122802 139842769708864 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0419 22:58:23.737435 139842769708864 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0419 22:58:23.737713 139842769708864 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-19 22:58:23.810088: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-19 22:58:23.823751: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-04-19 22:58:23.824255: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:31051}
2021-04-19 22:58:58.223338: E tensorflow/core/common_runtime/eager/context.cc:646] Failed to register function remotely due to Unable to find a context_id matching the specified one (16212435396591141085). Perhaps the worker was restarted, or the context was GC'd?
This could happen if the remote target has been disconnected from the client.
2021-04-19 22:58:58.223533: E tensorflow/core/common_runtime/eager/context.cc:646] Failed to register function remotely due to Unable to find a context_id matching the specified one (16212435396591141085). Perhaps the worker was restarted, or the context was GC'd?
This could happen if the remote target has been disconnected from the client.
2021-04-19 22:58:58.223549: E tensorflow/core/common_runtime/eager/context.cc:646] Failed to register function remotely due to Unable to find a context_id matching the specified one (16212435396591141085). Perhaps the worker was restarted, or the context was GC'd?
This could happen if the remote target has been disconnected from the client.
2021-04-19 22:58:58.223557: E tensorflow/core/common_runtime/eager/context.cc:646] Failed to register function remotely due to Unable to find a context_id matching the specified one (16212435396591141085). Perhaps the worker was restarted, or the context was GC'd?
This could happen if the remote target has been disconnected from the client.
2021-04-19 22:58:58.223564: E tensorflow/core/common_runtime/eager/context.cc:646] Failed to register function remotely due to Unable to find a context_id matching the specified one (16212435396591141085). Perhaps the worker was restarted, or the context was GC'd?
This could happen if the remote target has been disconnected from the client.
2021-04-19 22:58:58.223601: E tensorflow/core/common_runtime/eager/context.cc:646] Failed to register function remotely due to Unable to find a context_id matching the specified one (16212435396591141085). Perhaps the worker was restarted, or the context was GC'd?
This could happen if the remote target has been disconnected from the client.
2021-04-19 22:58:58.223630: E tensorflow/core/common_runtime/eager/context.cc:646] Failed to register function remotely due to Unable to find a context_id matching the specified one (16212435396591141085). Perhaps the worker was restarted, or the context was GC'd?
This could happen if the remote target has been disconnected from the client.
2021-04-19 22:58:58.223637: E tensorflow/core/common_runtime/eager/context.cc:646] Failed to register function remotely due to Unable to find a context_id matching the specified one (16212435396591141085). Perhaps the worker was restarted, or the context was GC'd?
This could happen if the remote target has been disconnected from the client.
2021-04-19 22:58:58.223645: E tensorflow/core/common_runtime/eager/context.cc:646] Failed to register function remotely due to Unable to find a context_id matching the specified one (16212435396591141085). Perhaps the worker was restarted, or the context was GC'd?
This could happen if the remote target has been disconnected from the client.
2021-04-19 22:58:58.223651: E tensorflow/core/common_runtime/eager/context.cc:646] Failed to register function remotely due to Unable to find a context_id matching the specified one (16212435396591141085). Perhaps the worker was restarted, or the context was GC'd?
This could happen if the remote target has been disconnected from the client.
2021-04-19 22:58:58.223687: E tensorflow/core/common_runtime/eager/context.cc:646] Failed to register function remotely due to Unable to find a context_id matching the specified one (16212435396591141085). Perhaps the worker was restarted, or the context was GC'd?
This could happen if the remote target has been disconnected from the client.
2021-04-19 22:58:58.223720: E tensorflow/core/common_runtime/eager/context.cc:646] Failed to register function remotely due to Unable to find a context_id matching the specified one (16212435396591141085). Perhaps the worker was restarted, or the context was GC'd?
This could happen if the remote target has been disconnected from the client.
2021-04-19 22:58:58.223729: E tensorflow/core/common_runtime/eager/context.cc:646] Failed to register function remotely due to Unable to find a context_id matching the specified one (16212435396591141085). Perhaps the worker was restarted, or the context was GC'd?
This could happen if the remote target has been disconnected from the client.
2021-04-19 22:58:58.223736: E tensorflow/core/common_runtime/eager/context.cc:646] Failed to register function remotely due to Unable to find a context_id matching the specified one (16212435396591141085). Perhaps the worker was restarted, or the context was GC'd?
This could happen if the remote target has been disconnected from the client.
2021-04-19 22:58:58.223743: E tensorflow/core/common_runtime/eager/context.cc:646] Failed to register function remotely due to Unable to find a context_id matching the specified one (16212435396591141085). Perhaps the worker was restarted, or the context was GC'd?
This could happen if the remote target has been disconnected from the client.
2021-04-19 22:58:58.223749: E tensorflow/core/common_runtime/eager/context.cc:646] Failed to register function remotely due to Unable to find a context_id matching the specified one (16212435396591141085). Perhaps the worker was restarted, or the context was GC'd?
This could happen if the remote target has been disconnected from the client.
2021-04-19 22:58:58.223793: E tensorflow/core/common_runtime/eager/context.cc:646] Failed to register function remotely due to Unable to find a context_id matching the specified one (16212435396591141085). Perhaps the worker was restarted, or the context was GC'd?
This could happen if the remote target has been disconnected from the client.
2021-04-19 22:58:58.223802: E tensorflow/core/common_runtime/eager/context.cc:646] Failed to register function remotely due to Unable to find a context_id matching the specified one (16212435396591141085). Perhaps the worker was restarted, or the context was GC'd?
This could happen if the remote target has been disconnected from the client.
2021-04-19 22:58:58.439276: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-04-19 22:58:58.439358: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:31051}
2021-04-19 22:58:58.440091: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:31051
I0419 22:58:58.440905 139842769708864 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-3
I0419 22:58:58.441850 139842769708864 tpu_strategy_util.py:74] Initializing the TPU system: node-3
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 149, in main
    model_dir=model_dir)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_lib.py", line 68, in run_experiment
    params, model_dir))
  File "/usr/local/lib/python3.7/dist-packages/gin/config.py", line 1069, in gin_wrapper
    utils.augment_exception_message_and_reraise(e, err_str)
  File "/usr/local/lib/python3.7/dist-packages/gin/utils.py", line 41, in augment_exception_message_and_reraise
    raise proxy.with_traceback(exception.__traceback__) from None
  File "/usr/local/lib/python3.7/dist-packages/gin/config.py", line 1046, in gin_wrapper
    return fn(*new_args, **new_kwargs)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_utils.py", line 225, in create_trainer
    checkpoint_exporter=checkpoint_exporter)
  File "/usr/local/lib/python3.7/dist-packages/gin/config.py", line 1069, in gin_wrapper
    utils.augment_exception_message_and_reraise(e, err_str)
  File "/usr/local/lib/python3.7/dist-packages/gin/utils.py", line 41, in augment_exception_message_and_reraise
    raise proxy.with_traceback(exception.__traceback__) from None
  File "/usr/local/lib/python3.7/dist-packages/gin/config.py", line 1046, in gin_wrapper
    return fn(*new_args, **new_kwargs)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/base_trainer.py", line 152, in __init__
    self.strategy, self.task.build_inputs, self.config.task.train_data)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/utils/common.py", line 85, in make_distributed_dataset
    return strategy.distribute_datasets_from_function(dataset_fn)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/distribute_lib.py", line 1135, in distribute_datasets_from_function
    dataset_fn, options)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/tpu_strategy.py", line 842, in _distribute_datasets_from_function
    self._container_strategy())
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/input_lib.py", line 162, in get_distributed_datasets_from_function
    input_contexts, strategy, options)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/input_lib.py", line 1273, in __init__
    self._input_contexts, self._input_workers, dataset_fn))
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/input_lib.py", line 1936, in _create_datasets_from_function_with_input_context
    dataset = dataset_fn(ctx)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/utils/common.py", line 83, in dataset_fn
    return dataset_or_fn(*args, **kwargs)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/tasks/yolo.py", line 185, in build_inputs
    dataset = reader.read(input_context=input_context)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/input_reader.py", line 365, in read
    self._tfds_builder)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/input_reader.py", line 306, in _read_decode_and_parse_dataset
    dataset = _maybe_map_fn(dataset, self._parser_fn)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/input_reader.py", line 34, in _maybe_map_fn
    fn, num_parallel_calls=tf.data.experimental.AUTOTUNE)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/data/ops/dataset_ops.py", line 1812, in map
    preserve_cardinality=True)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/data/ops/dataset_ops.py", line 4246, in __init__
    use_legacy_function=use_legacy_function)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/data/ops/dataset_ops.py", line 3525, in __init__
    self._function = wrapper_fn.get_concrete_function()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py", line 3052, in get_concrete_function
    *args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py", line 3019, in _get_concrete_function_garbage_collected
    graph_function, _ = self._maybe_define_function(args, kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py", line 3361, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py", line 3206, in _create_graph_function
    capture_by_value=self._capture_by_value),
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/func_graph.py", line 990, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/data/ops/dataset_ops.py", line 3518, in wrapper_fn
    ret = _wrapper_helper(*args)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/data/ops/dataset_ops.py", line 3453, in _wrapper_helper
    ret = autograph.tf_convert(func, ag_ctx)(*nested_args)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/autograph/impl/api.py", line 670, in wrapper
    raise e.ag_error_metadata.to_exception(e)
tensorflow.python.framework.errors_impl.AbortedError: in user code:

    /home/cam2tensorflow/TensorFlowModels/official/vision/beta/dataloaders/parser.py:65 parse  *
        return self._parse_train_data(decoded_tensors)
    /home/cam2tensorflow/TensorFlowModels/yolo/dataloaders/yolo_input.py:402 _parse_train_data  *
        image, labels = self._build_label(
    /home/cam2tensorflow/TensorFlowModels/yolo/dataloaders/yolo_input.py:509 _build_label  *
        grid, inds, upds, true_conf = self._build_grid(
    /home/cam2tensorflow/TensorFlowModels/yolo/dataloaders/yolo_input.py:180 _build_grid  *
        indexes, updates, true_grid = preprocessing_ops.build_grided_gt_ind(
    /home/cam2tensorflow/TensorFlowModels/yolo/ops/preprocessing_ops.py:525 build_grided_gt_ind  *
        len_masks = tf.shape(mask)[0]
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/util/dispatch.py:201 wrapper  **
        return target(*args, **kwargs)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/array_ops.py:622 shape_v2
        return shape(input, name, out_type)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/util/dispatch.py:201 wrapper
        return target(*args, **kwargs)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/array_ops.py:649 shape
        return shape_internal(input, name, optimize=True, out_type=out_type)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/array_ops.py:673 shape_internal
        input = ops.convert_to_tensor(input)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/profiler/trace.py:163 wrapped
        return func(*args, **kwargs)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py:1501 convert_to_tensor
        return graph.capture(value, name=name)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/func_graph.py:623 capture
        return self.capture_eager_tensor(tensor, name)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/func_graph.py:720 capture_eager_tensor
        constant_value = tensor_util.constant_value(tensor)
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_util.py:831 constant_value
        return tensor.numpy()
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py:1071 numpy
        maybe_arr = self._numpy()  # pylint: disable=protected-access
    /usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py:1039 _numpy
        six.raise_from(core._status_to_exception(e.code, e.message), None)  # pylint: disable=protected-access
    <string>:3 raise_from
        

    AbortedError: RecvTensor expects a different device incarnation: 4230567674094130093 vs. 18131272081471307053. Your worker job ("/job:tpu_worker/replica:0/task:0") was probably restarted. Check your worker job for the reason why it was restarted.
    Additional GRPC error information from remote target /job:worker/replica:0/task:0:
    :{"created":"@1618873138.202052320","description":"Error received from peer ipv4:10.91.127.66:8470","file":"external/com_github_grpc_grpc/src/core/lib/surface/call.cc","file_line":1056,"grpc_message":"RecvTensor expects a different device incarnation: 4230567674094130093 vs. 18131272081471307053. Your worker job ("/job:tpu_worker/replica:0/task:0") was probably restarted. Check your worker job for the reason why it was restarted.","grpc_status":10}

  In call to configurable 'Trainer' (<class 'official.core.base_trainer.Trainer'>)
  In call to configurable 'create_trainer' (<function create_trainer at 0x7efcfae52730>)
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/tpu_strategy.py", line 738, in async_wait
    context.async_wait()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/context.py", line 2330, in async_wait
    context().sync_executors()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/context.py", line 645, in sync_executors
    pywrap_tfe.TFE_ContextSyncExecutors(self._context_handle)
tensorflow.python.framework.errors_impl.AbortedError: 2 root error(s) found.
  (0) Aborted: RecvTensor expects a different device incarnation: 4230567674094130093 vs. 18131272081471307053. Your worker job ("/job:tpu_worker/replica:0/task:0") was probably restarted. Check your worker job for the reason why it was restarted.
Additional GRPC error information from remote target /job:worker/replica:0/task:0:
:{"created":"@1618873138.202052320","description":"Error received from peer ipv4:10.91.127.66:8470","file":"external/com_github_grpc_grpc/src/core/lib/surface/call.cc","file_line":1056,"grpc_message":"RecvTensor expects a different device incarnation: 4230567674094130093 vs. 18131272081471307053. Your worker job ("/job:tpu_worker/replica:0/task:0") was probably restarted. Check your worker job for the reason why it was restarted.","grpc_status":10}
  (1) Unavailable: Unable to find a context_id matching the specified one (16212435396591141085). Perhaps the worker was restarted, or the context was GC'd?
0 successful operations.
0 derived errors ignored.

__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'3': (None, 64, 64, 22153728    yolo_fpn[0][0]                   
                                                                 yolo_fpn[0][1]                   
                                                                 yolo_fpn[0][2]                   
==================================================================================================
Total params: 37,319,168
Trainable params: 37,288,192
Non-trainable params: 30,976
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 37319168  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 64,488,640
Trainable params: 64,422,336
Non-trainable params: 66,304
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   223    0     2  100   221     12   1435 --:--:-- --:--:-- --:--:--  1448
okRequest issued for: [node-3]
INFO:tensorflow:Clearing out eager caches
I0419 22:59:06.954198 139842769708864 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0419 22:59:06.956519 139842769708864 tpu_strategy_util.py:133] Finished initializing TPU system.
I0419 22:59:06.958011 139842769708864 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0419 22:59:07.102493 139842769708864 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0419 22:59:07.102735 139842769708864 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 140, in get_distribution_strategy
    return tf.distribute.TPUStrategy(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/tpu_strategy.py", line 214, in __init__
    device_assignment=experimental_device_assignment))
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/tpu_strategy.py", line 680, in __init__
    self._tpu_metadata = self._tpu_cluster_resolver.get_tpu_system_metadata()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 295, in get_tpu_system_metadata
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-3" is not yet ready; state: "STOPPING"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.14, 'aug_scale_min': 0.1, 'aug_scale_max': 2.5, 'aug_rand_angle': 30.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.9, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.15, 'aug_scale_min': 0.1, 'aug_scale_max': 2.4, 'aug_rand_angle': 30.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.75, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 1.0, 'random_crop_mosaic': False}}}, 'weight_decay': 0.001, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'adam', 'adam': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'adam', 'beta_1': 0.949, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}}, 'ema': None, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [240000, 260000], 'values': [0.00131, 0.000131, 1.31e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 2000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   223    0     2  100   221     12   1355 --:--:-- --:--:-- --:--:--  1368
okRequest issued for: [node-3]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-19T23:01:07.137827378Z'
  endTime: '2021-04-19T23:01:57.034370084Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618873267124-5c05b4e05f764-a0fdfa26-19b7fe16
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618873267124-5c05b4e05f764-a0fdfa26-19b7fe16] to complete...
.................................................................................................................................................................................................................................................................................done.
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-19T23:01:00.553615847Z'
  endTime: '2021-04-19T23:01:56.025905208Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618873260528-5c05b4da15510-ec502d31-487ce7c2
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618873260528-5c05b4da15510-ec502d31-487ce7c2] to complete...
.........................................................................................................................................................................................................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-3]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-19T23:07:17.577735546Z'
  endTime: '2021-04-19T23:07:54.448999038Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618873637566-5c05b641a768e-f5df469c-7e41aa6c
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618873637566-5c05b641a768e-f5df469c-7e41aa6c] to complete...
........................................................................................................................................................................................................done.
europe-west4-a
I0419 23:06:02.422171 139894318675776 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'nms_type': 'greedy',
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 30.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.14,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.0,
                                    'aug_scale_aspect': 0.0,
                                    'aug_scale_max': 2.5,
                                    'aug_scale_min': 0.1,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_im': 0.6,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.213,
                                         'aug_rand_angle': 30.0,
                                         'aug_rand_brightness': 0.5,
                                         'aug_rand_hue': 0.15,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.0,
                                         'aug_scale_aspect': 0.0,
                                         'aug_scale_max': 2.4,
                                         'aug_scale_min': 0.1,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_im': 0.9,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.75, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': 1.0,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.001},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': None,
                                  'learning_rate': {'stepwise': {'boundaries': [240000,
                                                                                260000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00131,
                                                                            0.000131,
                                                                            1.31e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'adam': {'amsgrad': False,
                                                         'beta_1': 0.949,
                                                         'beta_2': 0.999,
                                                         'clipnorm': None,
                                                         'clipvalue': None,
                                                         'epsilon': 1e-07,
                                                         'global_clipnorm': None,
                                                         'name': 'adam'},
                                                'type': 'adam'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 2000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0419 23:06:02.423476 139894318675776 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_tests/250k-512-aggressive-adam/params.yaml
I0419 23:06:03.295797 139894318675776 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0419 23:06:03.915246 139894318675776 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0419 23:06:03.915569 139894318675776 transport.py:157] Attempting refresh to obtain initial access_token
I0419 23:06:03.962382 139894318675776 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0419 23:06:04.106672 139894318675776 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0419 23:06:04.107203 139894318675776 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-19 23:06:04.164073: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0419 23:06:04.164732 139894318675776 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0419 23:06:04.779470 139894318675776 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0419 23:06:04.780020 139894318675776 transport.py:157] Attempting refresh to obtain initial access_token
I0419 23:06:04.822341 139894318675776 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0419 23:06:04.967906 139894318675776 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0419 23:06:04.968258 139894318675776 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-19 23:06:05.024104: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-19 23:06:05.039049: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-04-19 23:06:05.039128: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:31279}
2021-04-19 23:06:42.431687: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-04-19 23:06:42.431779: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:31279}
2021-04-19 23:06:42.432604: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:31279
I0419 23:06:42.433407 139894318675776 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-3
I0419 23:06:42.433841 139894318675776 tpu_strategy_util.py:74] Initializing the TPU system: node-3
INFO:tensorflow:Clearing out eager caches
I0419 23:06:50.678655 139894318675776 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0419 23:06:50.681161 139894318675776 tpu_strategy_util.py:133] Finished initializing TPU system.
I0419 23:06:50.683012 139894318675776 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0419 23:06:51.312705 139894318675776 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0419 23:06:51.313296 139894318675776 transport.py:157] Attempting refresh to obtain initial access_token
I0419 23:06:51.371938 139894318675776 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0419 23:06:51.998470 139894318675776 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0419 23:06:51.999043 139894318675776 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0419 23:06:52.063770 139894318675776 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0419 23:06:52.064094 139894318675776 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0419 23:06:52.064496 139894318675776 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0419 23:06:52.064594 139894318675776 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0419 23:06:52.064687 139894318675776 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0419 23:06:52.064971 139894318675776 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0419 23:06:52.065070 139894318675776 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0419 23:06:52.065245 139894318675776 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0419 23:06:52.065355 139894318675776 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0419 23:06:52.065481 139894318675776 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0419 23:06:52.065571 139894318675776 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0419 23:06:52.065659 139894318675776 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0419 23:06:52.065744 139894318675776 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0419 23:06:52.065829 139894318675776 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0419 23:06:52.065922 139894318675776 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0419 23:06:52.066013 139894318675776 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0419 23:06:52.067882 139894318675776 train_utils.py:214] Running default trainer.
2021-04-19 23:06:52.099504: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.14, 'aug_scale_min': 0.1, 'aug_scale_max': 2.5, 'aug_rand_angle': 30.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.9, 'aug_scale_aspect': 0.0, 'aug_rand_translate': 0.0, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.15, 'aug_scale_min': 0.1, 'aug_scale_max': 2.4, 'aug_rand_angle': 30.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.75, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 1.0, 'random_crop_mosaic': False}}}, 'weight_decay': 0.001, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'adam', 'adam': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'adam', 'beta_1': 0.949, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}}, 'ema': None, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [240000, 260000], 'values': [0.00131, 0.000131, 1.31e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 2000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05} 0.0005
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'nms_type': 'greedy', 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f3b4851c1d0>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
Model: "YoloDecoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            [(None, 64, 64, 256) 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            [(None, 32, 32, 512) 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 16, 16, 1024 0                                            
__________________________________________________________________________________________________
yolo_fpn (YoloFPN)              {'5': (None, 16, 16, 15165440    input_2[0][0]                    
                                                                 input_3[0][0]                    
                                                                 input_4[0][0]                    I0419 23:07:49.936222 139894318675776 controller.py:362] restoring or initializing model...
I0419 23:08:01.104462 139894318675776 yolo.py:529] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0419 23:08:01.106266 139894318675776 controller.py:368] initialized model.
I0419 23:08:01.106512 139894318675776 train_lib.py:96] Starts to execute mode: train_and_eval
I0419 23:08:01.111632 139894318675776 controller.py:211] train | step:      0 | training until step 20000...
I0419 23:08:07.639152 139894318675776 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0419 23:09:09.659892 139894318675776 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0420 00:18:14.616554 139894318675776 controller.py:425] train | step:  10000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.49159235,
           'avg_obj': 0.06135058,
           'box_loss': 3.5953062,
           'class_loss': 19.660343,
           'conf_loss': 194.3545,
           'precision50': 0.0023051621,
           'recall50': 0.016066339},
     '4': {'avg_iou': 0.56126297,
           'avg_obj': 0.087099485,
           'box_loss': 4.173627,
           'class_loss': 23.158613,
           'conf_loss': 41.77692,
           'precision50': 0.040230066,
           'recall50': 0.026055152},
     '5': {'avg_iou': 0.6220417,
           'avg_obj': 0.13914733,
           'box_loss': 2.6145248,
           'class_loss': 14.831973,
           'conf_loss': 14.553295,
           'precision50': 0.13330385,
           'recall50': 0.08070146},
     'global': {'total_loss': 318.71884},
     'learning_rate': 0.00131,
     'training_loss': 318.71884}
I0420 00:19:09.081957 139894318675776 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-10000.
I0420 01:19:34.308639 139894318675776 controller.py:425] train | step:  20000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.55507976,
           'avg_obj': 0.044183303,
           'box_loss': 3.1598582,
           'class_loss': 4.9010944,
           'conf_loss': 6.5302377,
           'precision50': 0.014068922,
           'recall50': 0.002697462},
     '4': {'avg_iou': 0.64403856,
           'avg_obj': 0.10440149,
           'box_loss': 3.4002075,
           'class_loss': 6.267479,
           'conf_loss': 8.378037,
           'precision50': 0.10358285,
           'recall50': 0.038359426},
     '5': {'avg_iou': 0.7159409,
           'avg_obj': 0.20251663,
           'box_loss': 1.9760953,
           'class_loss': 4.464543,
           'conf_loss': 5.438374,
           'precision50': 0.2825718,
           'recall50': 0.1593346},
     'global': {'total_loss': 44.51574},
     'learning_rate': 0.00131,
     'training_loss': 44.51574}
I0420 01:19:45.764798 139894318675776 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0420 01:19:51.505641 139894318675776 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0420 01:24:45.986031 139894318675776 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0420 01:29:05.768102 139894318675776 controller.py:261]  eval | step:  20000 | eval time:  560.0 sec | output: 
    {'3': {'avg_iou': 0.40300766,
           'avg_obj': 0.03598852,
           'box_loss': 3.9356265,
           'class_loss': 4.847937,
           'conf_loss': 8.249319,
           'precision50': 0.02882381,
           'recall50': 0.005836281},
     '4': {'avg_iou': 0.5902744,
           'avg_obj': 0.124314524,
           'box_loss': 3.3265266,
           'class_loss': 4.7006764,
           'conf_loss': 7.872175,
           'precision50': 0.17167225,
           'recall50': 0.073130235},
     '5': {'avg_iou': 0.660736,
           'avg_obj': 0.27309614,
           'box_loss': 1.732058,
           'class_loss': 2.7183282,
           'conf_loss': 4.1985774,
           'precision50': 0.30108947,
           'recall50': 0.22872098},
     'AP': 0.073085375,
     'AP50': 0.17256923,
     'AP75': 0.048390254,
     'APl': 0.11620167,
     'APm': 0.06629925,
     'APs': 0.017449846,
     'ARl': 0.36895984,
     'ARm': 0.25546846,
     'ARmax1': 0.119599804,
     'ARmax10': 0.22314973,
     'ARmax100': 0.2497144,
     'ARs': 0.07099869,
     'global': {'total_loss': 41.58121},
     'validation_loss': 41.58121}

__________________________________________________________________________________________________
yolo_pan (YoloPAN)              {'3': (None, 64, 64, 22153728    yolo_fpn[0][0]                   
                                                                 yolo_fpn[0][1]                   
                                                                 yolo_fpn[0][2]                   
==================================================================================================
Total params: 37,319,168
Trainable params: 37,288,192
Non-trainable params: 30,976
__________________________________________________________________________________________________
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 37319168  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 64,488,640
Trainable params: 64,422,336
Non-trainable params: 66,304
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 200, 8), 4: (8, 200, 8), 5: (8, 200, 8)}, inds: {3: (8, 200, 3), 4: (8, 200, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
train | step:  10000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.49159235,
           'avg_obj': 0.06135058,
           'box_loss': 3.5953062,
           'class_loss': 19.660343,
           'conf_loss': 194.3545,
           'precision50': 0.0023051621,
           'recall50': 0.016066339},
     '4': {'avg_iou': 0.56126297,
           'avg_obj': 0.087099485,
           'box_loss': 4.173627,
           'class_loss': 23.158613,
           'conf_loss': 41.77692,
           'precision50': 0.040230066,
           'recall50': 0.026055152},
     '5': {'avg_iou': 0.6220417,
           'avg_obj': 0.13914733,
           'box_loss': 2.6145248,
           'class_loss': 14.831973,
           'conf_loss': 14.553295,
           'precision50': 0.13330385,
           'recall50': 0.08070146},
     'global': {'total_loss': 318.71884},
     'learning_rate': 0.00131,
     'training_loss': 318.71884}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-10000.
train | step:  20000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.55507976,
           'avg_obj': 0.044183303,
           'box_loss': 3.1598582,
           'class_loss': 4.9010944,
           'conf_loss': 6.5302377,
           'precision50': 0.014068922,
           'recall50': 0.002697462},
     '4': {'avg_iou': 0.64403856,
           'avg_obj': 0.10440149,
           'box_loss': 3.4002075,
           'class_loss': 6.267479,
           'conf_loss': 8.378037,
           'precision50': 0.10358285,
           'recall50': 0.038359426},
     '5': {'avg_iou': 0.7159409,
           'avg_obj': 0.20251663,
           'box_loss': 1.9760953,
           'class_loss': 4.464543,
           'conf_loss': 5.438374,
           'precision50': 0.2825718,
           'recall50': 0.1593346},
     'global': {'total_loss': 44.51574},
     'learning_rate': 0.00131,
     'training_loss': 44.51574}
 eval | step:  20000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=177.51s).
Accumulating evaluation results...
DONE (t=24.23s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.073
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.173
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.048
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.017
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.066
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.116
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.120
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.223
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.250
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.071
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.255
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.369
 eval | step:  20000 | eval time:  560.0 sec | output: 
    {'3': {'avg_iou': 0.40300766,
           'avg_obj': 0.03598852,
           'box_loss': 3.9356265,
           'class_loss': 4.847937,
           'conf_loss': 8.249319,
           'precision50': 0.02882381,
           'recall50': 0.005836281},
     '4': {'avg_iou': 0.5902744,
           'avg_obj': 0.124314524,
           'box_loss': 3.3265266,
           'class_loss': 4.7006764,
           'conf_loss': 7.872175,
           'precision50': 0.17167225,
           'recall50': 0.073130235},
     '5': {'avg_iou': 0.660736,
           'avg_obj': 0.27309614,
           'box_loss': 1.732058,
           'class_loss': 2.7183282,
           'conf_loss': 4.1985774,
           'precision50': 0.30108947,
           'recall50': 0.22872098},
     'AP': 0.073085375,
     'AP50': 0.17256923,
     'AP75': 0.048390254,
     'APl': 0.11620167,
     'APm': 0.06629925,
     'APs': 0.017449846,
     'ARl': 0.36895984,
     'ARm': 0.25546846,
     'ARmax1': 0.119599804,
     'ARmax10': 0.22314973,
     'ARmax100': 0.2497144,
     'ARs': 0.07099869,
     'global': {'total_loss': 41.58121},
     'validation_loss': 41.58121}I0420 01:29:29.463949 139894318675776 controller.py:211] train | step:  20000 | training until step 40000...
I0420 02:30:07.282291 139894318675776 controller.py:425] train | step:  30000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.5756355,
           'avg_obj': 0.062902756,
           'box_loss': 3.016317,
           'class_loss': 4.3307686,
           'conf_loss': 6.3891444,
           'precision50': 0.035194457,
           'recall50': 0.008513781},
     '4': {'avg_iou': 0.6722238,
           'avg_obj': 0.14565726,
           'box_loss': 3.1290042,
           'class_loss': 5.370926,
           'conf_loss': 7.979813,
           'precision50': 0.16028942,
           'recall50': 0.07269661},
     '5': {'avg_iou': 0.7438981,
           'avg_obj': 0.26935446,
           'box_loss': 1.7824842,
           'class_loss': 3.8070984,
           'conf_loss': 4.9859266,
           'precision50': 0.35120675,
           'recall50': 0.24494134},
     'global': {'total_loss': 40.791462},
     'learning_rate': 0.00131,
     'training_loss': 40.791462}
I0420 02:30:59.083055 139894318675776 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-30000.
I0420 03:36:59.329426 139894318675776 controller.py:425] train | step:  40000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.5923085,
           'avg_obj': 0.0832695,
           'box_loss': 2.9010665,
           'class_loss': 4.025855,
           'conf_loss': 6.2505617,
           'precision50': 0.061207518,
           'recall50': 0.017235657},
     '4': {'avg_iou': 0.6911465,
           'avg_obj': 0.17964806,
           'box_loss': 2.947842,
           'class_loss': 4.90756,
           'conf_loss': 7.658228,
           'precision50': 0.1984947,
           'recall50': 0.103234276},
     '5': {'avg_iou': 0.76047546,
           'avg_obj': 0.3103248,
           'box_loss': 1.6674926,
           'class_loss': 3.4656014,
           'conf_loss': 4.7095723,
           'precision50': 0.37909618,
           'recall50': 0.29618618},
     'global': {'total_loss': 38.533768},
     'learning_rate': 0.00131,
     'training_loss': 38.533768}
I0420 03:37:11.220276 139894318675776 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0420 03:41:20.685873 139894318675776 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0420 03:45:40.820565 139894318675776 controller.py:261]  eval | step:  40000 | eval time:  509.6 sec | output: 
    {'3': {'avg_iou': 0.42966607,
           'avg_obj': 0.076418765,
           'box_loss': 3.5523071,
           'class_loss': 4.0767307,
           'conf_loss': 7.8170366,
           'precision50': 0.12044864,
           'recall50': 0.045784425},
     '4': {'avg_iou': 0.62178797,
           'avg_obj': 0.19237551,
           'box_loss': 2.9789796,
           'class_loss': 3.777493,
           'conf_loss': 7.2925577,
           'precision50': 0.25691757,
           'recall50': 0.15765646},
     '5': {'avg_iou': 0.6937828,
           'avg_obj': 0.3471769,
           'box_loss': 1.5438862,
           'class_loss': 2.1980479,
           'conf_loss': 3.755371,
           'precision50': 0.364468,
           'recall50': 0.32618204},
     'AP': 0.12805693,
     'AP50': 0.27014562,
     'AP75': 0.10411068,
     'APl': 0.19349982,
     'APm': 0.13080251,
     'APs': 0.037643727,
     'ARl': 0.44681054,
     'ARm': 0.34763062,
     'ARmax1': 0.16624473,
     'ARmax10': 0.2941124,
     'ARmax100': 0.3277544,
     'ARs': 0.14472449,
     'global': {'total_loss': 36.9924},
     'validation_loss': 36.9924}
I0420 03:45:57.902616 139894318675776 controller.py:211] train | step:  40000 | training until step 60000...
I0420 04:51:29.824245 139894318675776 controller.py:425] train | step:  50000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.60202515,
           'avg_obj': 0.09533595,
           'box_loss': 2.8315768,
           'class_loss': 3.822451,
           'conf_loss': 6.164036,
           'precision50': 0.07581088,
           'recall50': 0.023272853},
     '4': {'avg_iou': 0.7015211,
           'avg_obj': 0.19882359,
           'box_loss': 2.8523064,
           'class_loss': 4.624214,
           'conf_loss': 7.485168,
           'precision50': 0.21447188,
           'recall50': 0.12080111},
     '5': {'avg_iou': 0.76988876,
           'avg_obj': 0.3344937,
           'box_loss': 1.6042968,
           'class_loss': 3.2590435,
           'conf_loss': 4.5523963,
           'precision50': 0.38983768,
           'recall50': 0.32448462},
     'global': {'total_loss': 37.1954},
     'learning_rate': 0.00131,
     'training_loss': 37.1954}
I0420 04:52:18.201583 139894318675776 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-50000.
I0420 05:51:19.515098 139894318675776 controller.py:425] train | step:  60000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6085939,
           'avg_obj': 0.10404838,
           'box_loss': 2.7918143,
           'class_loss': 3.6917508,
           'conf_loss': 6.1141224,
           'precision50': 0.08599852,
           'recall50': 0.028098898},
     '4': {'avg_iou': 0.7087598,
           'avg_obj': 0.21295123,
           'box_loss': 2.7868826,
           'class_loss': 4.418663,
           'conf_loss': 7.3595705,
           'precision50': 0.22510384,
           'recall50': 0.13378042},
     '5': {'avg_iou': 0.77628684,
           'avg_obj': 0.3522815,
           'box_loss': 1.558341,
           'class_loss': 3.0937924,
           'conf_loss': 4.426919,
           'precision50': 0.39731935,
           'recall50': 0.34549764},
     'global': {'total_loss': 36.241806},
     'learning_rate': 0.00131,
     'training_loss': 36.241806}
I0420 05:51:32.390693 139894318675776 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0420 05:55:43.309780 139894318675776 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0420 05:59:56.223163 139894318675776 controller.py:261]  eval | step:  60000 | eval time:  503.8 sec | output: 
    {'3': {'avg_iou': 0.44403282,
           'avg_obj': 0.09919514,
           'box_loss': 3.348339,
           'class_loss': 3.3054695,
           'conf_loss': 7.523539,
           'precision50': 0.16166317,
           'recall50': 0.06822459},
     '4': {'avg_iou': 0.64172715,
           'avg_obj': 0.23900491,
           'box_loss': 2.7533538,
           'class_loss': 2.9535728,
           'conf_loss': 6.75484,
           'precision50': 0.30273524,
           'recall50': 0.20834307},
     '5': {'avg_iou': 0.71665174,
           'avg_obj': 0.4324373,
           'box_loss': 1.4116495,
           'class_loss': 1.6362151,
           'conf_loss': 3.3185403,
           'precision50': 0.4038347,
           'recall50': 0.4305352},
     'AP': 0.18770441,
     'AP50': 0.36629766,
     'AP75': 0.17333888,
     'APl': 0.28200793,
     'APm': 0.1807222,
     'APs': 0.062067967,
     'ARl': 0.5198514,
     'ARm': 0.3959796,
     'ARmax1': 0.20043464,
     'ARmax10': 0.34506896,
     'ARmax100': 0.38163683,
     'ARs': 0.1863428,
     'global': {'total_loss': 33.005524},
     'validation_loss': 33.005524}

train | step:  20000 | training until step 40000...
train | step:  30000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.5756355,
           'avg_obj': 0.062902756,
           'box_loss': 3.016317,
           'class_loss': 4.3307686,
           'conf_loss': 6.3891444,
           'precision50': 0.035194457,
           'recall50': 0.008513781},
     '4': {'avg_iou': 0.6722238,
           'avg_obj': 0.14565726,
           'box_loss': 3.1290042,
           'class_loss': 5.370926,
           'conf_loss': 7.979813,
           'precision50': 0.16028942,
           'recall50': 0.07269661},
     '5': {'avg_iou': 0.7438981,
           'avg_obj': 0.26935446,
           'box_loss': 1.7824842,
           'class_loss': 3.8070984,
           'conf_loss': 4.9859266,
           'precision50': 0.35120675,
           'recall50': 0.24494134},
     'global': {'total_loss': 40.791462},
     'learning_rate': 0.00131,
     'training_loss': 40.791462}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-30000.
train | step:  40000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.5923085,
           'avg_obj': 0.0832695,
           'box_loss': 2.9010665,
           'class_loss': 4.025855,
           'conf_loss': 6.2505617,
           'precision50': 0.061207518,
           'recall50': 0.017235657},
     '4': {'avg_iou': 0.6911465,
           'avg_obj': 0.17964806,
           'box_loss': 2.947842,
           'class_loss': 4.90756,
           'conf_loss': 7.658228,
           'precision50': 0.1984947,
           'recall50': 0.103234276},
     '5': {'avg_iou': 0.76047546,
           'avg_obj': 0.3103248,
           'box_loss': 1.6674926,
           'class_loss': 3.4656014,
           'conf_loss': 4.7095723,
           'precision50': 0.37909618,
           'recall50': 0.29618618},
     'global': {'total_loss': 38.533768},
     'learning_rate': 0.00131,
     'training_loss': 38.533768}
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=183.39s).
Accumulating evaluation results...
DONE (t=21.38s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.128
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.270
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.104
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.038
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.131
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.193
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.166
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.294
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.328
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.145
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.348
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.447
 eval | step:  40000 | eval time:  509.6 sec | output: 
    {'3': {'avg_iou': 0.42966607,
           'avg_obj': 0.076418765,
           'box_loss': 3.5523071,
           'class_loss': 4.0767307,
           'conf_loss': 7.8170366,
           'precision50': 0.12044864,
           'recall50': 0.045784425},
     '4': {'avg_iou': 0.62178797,
           'avg_obj': 0.19237551,
           'box_loss': 2.9789796,
           'class_loss': 3.777493,
           'conf_loss': 7.2925577,
           'precision50': 0.25691757,
           'recall50': 0.15765646},
     '5': {'avg_iou': 0.6937828,
           'avg_obj': 0.3471769,
           'box_loss': 1.5438862,
           'class_loss': 2.1980479,
           'conf_loss': 3.755371,
           'precision50': 0.364468,
           'recall50': 0.32618204},
     'AP': 0.12805693,
     'AP50': 0.27014562,
     'AP75': 0.10411068,
     'APl': 0.19349982,
     'APm': 0.13080251,
     'APs': 0.037643727,
     'ARl': 0.44681054,
     'ARm': 0.34763062,
     'ARmax1': 0.16624473,
     'ARmax10': 0.2941124,
     'ARmax100': 0.3277544,
     'ARs': 0.14472449,
     'global': {'total_loss': 36.9924},
     'validation_loss': 36.9924}
train | step:  40000 | training until step 60000...
train | step:  50000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.60202515,
           'avg_obj': 0.09533595,
           'box_loss': 2.8315768,
           'class_loss': 3.822451,
           'conf_loss': 6.164036,
           'precision50': 0.07581088,
           'recall50': 0.023272853},
     '4': {'avg_iou': 0.7015211,
           'avg_obj': 0.19882359,
           'box_loss': 2.8523064,
           'class_loss': 4.624214,
           'conf_loss': 7.485168,
           'precision50': 0.21447188,
           'recall50': 0.12080111},
     '5': {'avg_iou': 0.76988876,
           'avg_obj': 0.3344937,
           'box_loss': 1.6042968,
           'class_loss': 3.2590435,
           'conf_loss': 4.5523963,
           'precision50': 0.38983768,
           'recall50': 0.32448462},
     'global': {'total_loss': 37.1954},
     'learning_rate': 0.00131,
     'training_loss': 37.1954}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-50000.
train | step:  60000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6085939,
           'avg_obj': 0.10404838,
           'box_loss': 2.7918143,
           'class_loss': 3.6917508,
           'conf_loss': 6.1141224,
           'precision50': 0.08599852,
           'recall50': 0.028098898},
     '4': {'avg_iou': 0.7087598,
           'avg_obj': 0.21295123,
           'box_loss': 2.7868826,
           'class_loss': 4.418663,
           'conf_loss': 7.3595705,
           'precision50': 0.22510384,
           'recall50': 0.13378042},
     '5': {'avg_iou': 0.77628684,
           'avg_obj': 0.3522815,
           'box_loss': 1.558341,
           'class_loss': 3.0937924,
           'conf_loss': 4.426919,
           'precision50': 0.39731935,
           'recall50': 0.34549764},
     'global': {'total_loss': 36.241806},
     'learning_rate': 0.00131,
     'training_loss': 36.241806}
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=179.83s).
Accumulating evaluation results...
DONE (t=19.62s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.188
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.366
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.173
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.062
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.181
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.282
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.200
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.345
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.382
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.186
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.396
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.520
 eval | step:  60000 | eval time:  503.8 sec | output: 
    {'3': {'avg_iou': 0.44403282,
           'avg_obj': 0.09919514,
           'box_loss': 3.348339,
           'class_loss': 3.3054695,
           'conf_loss': 7.523539,
           'precision50': 0.16166317,
           'recall50': 0.06822459},
     '4': {'avg_iou': 0.64172715,
           'avg_obj': 0.23900491,
           'box_loss': 2.7533538,
           'class_loss': 2.9535728,
           'conf_loss': 6.75484,
           'precision50': 0.30273524,
           'recall50': 0.20834307},
     '5': {'avg_iou': 0.71665174,
           'avg_obj': 0.4324373,
           'box_loss': 1.4116495,
           'class_loss': 1.6362151,
           'conf_loss': 3.3185403,
           'precision50': 0.4038347,
           'recall50': 0.4305352},
     'AP': 0.18770441,
     'AP50': 0.36629766,
     'AP75': 0.17333888,
     'APl': 0.28200793,
     'APm': 0.1807222,
     'APs': 0.062067967,
     'ARl': 0.5198514,
     'ARm': 0.3959796,
     'ARmax1': 0.20043464,
     'ARmax10': 0.34506896,
     'ARmax100': 0.38163683,
     'ARs': 0.1863428,
     'global': {'total_loss': 33.005524},
     'validation_loss': 33.005524}I0420 06:00:13.553223 139894318675776 controller.py:211] train | step:  60000 | training until step 80000...
I0420 07:06:15.009894 139894318675776 controller.py:425] train | step:  70000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6132468,
           'avg_obj': 0.110627405,
           'box_loss': 2.743118,
           'class_loss': 3.5543344,
           'conf_loss': 6.0311384,
           'precision50': 0.091925554,
           'recall50': 0.031463444},
     '4': {'avg_iou': 0.71419317,
           'avg_obj': 0.22309771,
           'box_loss': 2.7212532,
           'class_loss': 4.2435594,
           'conf_loss': 7.2296185,
           'precision50': 0.23126951,
           'recall50': 0.14319344},
     '5': {'avg_iou': 0.7811176,
           'avg_obj': 0.36484653,
           'box_loss': 1.5237166,
           'class_loss': 2.9788704,
           'conf_loss': 4.338987,
           'precision50': 0.40138245,
           'recall50': 0.35990858},
     'global': {'total_loss': 35.36458},
     'learning_rate': 0.00131,
     'training_loss': 35.36458}
I0420 07:07:04.735492 139894318675776 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-70000.
I0420 08:08:46.912792 139894318675776 controller.py:425] train | step:  80000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.61764455,
           'avg_obj': 0.11691758,
           'box_loss': 2.7226744,
           'class_loss': 3.4834902,
           'conf_loss': 6.01405,
           'precision50': 0.099320516,
           'recall50': 0.034983613},
     '4': {'avg_iou': 0.7190726,
           'avg_obj': 0.23283172,
           'box_loss': 2.682325,
           'class_loss': 4.1263695,
           'conf_loss': 7.156349,
           'precision50': 0.23803867,
           'recall50': 0.15218776},
     '5': {'avg_iou': 0.7851459,
           'avg_obj': 0.37617278,
           'box_loss': 1.4962069,
           'class_loss': 2.8809378,
           'conf_loss': 4.2638106,
           'precision50': 0.40448663,
           'recall50': 0.3726264},
     'global': {'total_loss': 34.826298},
     'learning_rate': 0.00131,
     'training_loss': 34.826298}
I0420 08:08:59.078252 139894318675776 controller.py:252]  eval | step:  80000 | running 625 steps of evaluation...
I0420 08:13:15.787240 139894318675776 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0420 08:17:35.965887 139894318675776 controller.py:261]  eval | step:  80000 | eval time:  516.9 sec | output: 
    {'3': {'avg_iou': 0.45312425,
           'avg_obj': 0.11727278,
           'box_loss': 3.207702,
           'class_loss': 3.0204139,
           'conf_loss': 7.350166,
           'precision50': 0.18058382,
           'recall50': 0.08438947},
     '4': {'avg_iou': 0.6498132,
           'avg_obj': 0.28770474,
           'box_loss': 2.6647534,
           'class_loss': 2.7128701,
           'conf_loss': 6.5878406,
           'precision50': 0.3298859,
           'recall50': 0.26393387},
     '5': {'avg_iou': 0.726715,
           'avg_obj': 0.4616105,
           'box_loss': 1.3485906,
           'class_loss': 1.5124077,
           'conf_loss': 3.1688533,
           'precision50': 0.43064365,
           'recall50': 0.4618876},
     'AP': 0.20675258,
     'AP50': 0.3987368,
     'AP75': 0.19527544,
     'APl': 0.30251184,
     'APm': 0.20962396,
     'APs': 0.073981315,
     'ARl': 0.52701056,
     'ARm': 0.4212745,
     'ARmax1': 0.21211445,
     'ARmax10': 0.35879633,
     'ARmax100': 0.3966553,
     'ARs': 0.19595805,
     'global': {'total_loss': 31.573597},
     'validation_loss': 31.573597}
I0420 08:17:52.457833 139894318675776 controller.py:211] train | step:  80000 | training until step 100000...
I0420 09:21:18.530777 139894318675776 controller.py:425] train | step:  90000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.621371,
           'avg_obj': 0.122146204,
           'box_loss': 2.6922104,
           'class_loss': 3.38946,
           'conf_loss': 5.9656286,
           'precision50': 0.10351054,
           'recall50': 0.037758652},
     '4': {'avg_iou': 0.7229004,
           'avg_obj': 0.24158716,
           'box_loss': 2.644978,
           'class_loss': 4.0071177,
           'conf_loss': 7.0682783,
           'precision50': 0.24388355,
           'recall50': 0.160231},
     '5': {'avg_iou': 0.78865457,
           'avg_obj': 0.38641378,
           'box_loss': 1.4716103,
           'class_loss': 2.7949696,
           'conf_loss': 4.1923513,
           'precision50': 0.40855554,
           'recall50': 0.38483647},
     'global': {'total_loss': 34.22657},
     'learning_rate': 0.00131,
     'training_loss': 34.22657}
I0420 09:22:07.868781 139894318675776 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-90000.
I0420 10:25:19.531287 139894318675776 controller.py:425] train | step:  100000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.624369,
           'avg_obj': 0.12613405,
           'box_loss': 2.6749377,
           'class_loss': 3.3292043,
           'conf_loss': 5.9503546,
           'precision50': 0.107347526,
           'recall50': 0.040289655},
     '4': {'avg_iou': 0.72601074,
           'avg_obj': 0.24788366,
           'box_loss': 2.622931,
           'class_loss': 3.9260817,
           'conf_loss': 7.030309,
           'precision50': 0.24774788,
           'recall50': 0.16630456},
     '5': {'avg_iou': 0.7914058,
           'avg_obj': 0.39429724,
           'box_loss': 1.4553678,
           'class_loss': 2.7361212,
           'conf_loss': 4.148173,
           'precision50': 0.4098786,
           'recall50': 0.39315087},
     'global': {'total_loss': 33.8734},
     'learning_rate': 0.00131,
     'training_loss': 33.8734}
I0420 10:25:32.082679 139894318675776 controller.py:252]  eval | step:  100000 | running 625 steps of evaluation...
I0420 10:29:46.636417 139894318675776 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0420 10:33:54.285977 139894318675776 controller.py:261]  eval | step:  100000 | eval time:  502.2 sec | output: 
    {'3': {'avg_iou': 0.4507964,
           'avg_obj': 0.12352651,
           'box_loss': 3.254565,
           'class_loss': 2.902686,
           'conf_loss': 7.3405576,
           'precision50': 0.18149476,
           'recall50': 0.09197851},
     '4': {'avg_iou': 0.6545204,
           'avg_obj': 0.26930803,
           'box_loss': 2.6594121,
           'class_loss': 2.5543675,
           'conf_loss': 6.484525,
           'precision50': 0.3194739,
           'recall50': 0.24738295},
     '5': {'avg_iou': 0.73084044,
           'avg_obj': 0.46376556,
           'box_loss': 1.337529,
           'class_loss': 1.448726,
           'conf_loss': 3.1494555,
           'precision50': 0.41471153,
           'recall50': 0.4647062},
     'AP': 0.21603431,
     'AP50': 0.41537356,
     'AP75': 0.20181993,
     'APl': 0.3231256,
     'APm': 0.21286598,
     'APs': 0.075974904,
     'ARl': 0.552808,
     'ARm': 0.41761297,
     'ARmax1': 0.21629234,
     'ARmax10': 0.3631782,
     'ARmax100': 0.40286285,
     'ARs': 0.19931829,
     'global': {'total_loss': 31.131815},
     'validation_loss': 31.131815}

train | step:  60000 | training until step 80000...
train | step:  70000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6132468,
           'avg_obj': 0.110627405,
           'box_loss': 2.743118,
           'class_loss': 3.5543344,
           'conf_loss': 6.0311384,
           'precision50': 0.091925554,
           'recall50': 0.031463444},
     '4': {'avg_iou': 0.71419317,
           'avg_obj': 0.22309771,
           'box_loss': 2.7212532,
           'class_loss': 4.2435594,
           'conf_loss': 7.2296185,
           'precision50': 0.23126951,
           'recall50': 0.14319344},
     '5': {'avg_iou': 0.7811176,
           'avg_obj': 0.36484653,
           'box_loss': 1.5237166,
           'class_loss': 2.9788704,
           'conf_loss': 4.338987,
           'precision50': 0.40138245,
           'recall50': 0.35990858},
     'global': {'total_loss': 35.36458},
     'learning_rate': 0.00131,
     'training_loss': 35.36458}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-70000.
train | step:  80000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.61764455,
           'avg_obj': 0.11691758,
           'box_loss': 2.7226744,
           'class_loss': 3.4834902,
           'conf_loss': 6.01405,
           'precision50': 0.099320516,
           'recall50': 0.034983613},
     '4': {'avg_iou': 0.7190726,
           'avg_obj': 0.23283172,
           'box_loss': 2.682325,
           'class_loss': 4.1263695,
           'conf_loss': 7.156349,
           'precision50': 0.23803867,
           'recall50': 0.15218776},
     '5': {'avg_iou': 0.7851459,
           'avg_obj': 0.37617278,
           'box_loss': 1.4962069,
           'class_loss': 2.8809378,
           'conf_loss': 4.2638106,
           'precision50': 0.40448663,
           'recall50': 0.3726264},
     'global': {'total_loss': 34.826298},
     'learning_rate': 0.00131,
     'training_loss': 34.826298}
 eval | step:  80000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=184.78s).
Accumulating evaluation results...
DONE (t=19.82s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.207
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.399
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.195
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.074
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.210
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.303
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.212
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.359
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.397
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.196
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.421
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.527
 eval | step:  80000 | eval time:  516.9 sec | output: 
    {'3': {'avg_iou': 0.45312425,
           'avg_obj': 0.11727278,
           'box_loss': 3.207702,
           'class_loss': 3.0204139,
           'conf_loss': 7.350166,
           'precision50': 0.18058382,
           'recall50': 0.08438947},
     '4': {'avg_iou': 0.6498132,
           'avg_obj': 0.28770474,
           'box_loss': 2.6647534,
           'class_loss': 2.7128701,
           'conf_loss': 6.5878406,
           'precision50': 0.3298859,
           'recall50': 0.26393387},
     '5': {'avg_iou': 0.726715,
           'avg_obj': 0.4616105,
           'box_loss': 1.3485906,
           'class_loss': 1.5124077,
           'conf_loss': 3.1688533,
           'precision50': 0.43064365,
           'recall50': 0.4618876},
     'AP': 0.20675258,
     'AP50': 0.3987368,
     'AP75': 0.19527544,
     'APl': 0.30251184,
     'APm': 0.20962396,
     'APs': 0.073981315,
     'ARl': 0.52701056,
     'ARm': 0.4212745,
     'ARmax1': 0.21211445,
     'ARmax10': 0.35879633,
     'ARmax100': 0.3966553,
     'ARs': 0.19595805,
     'global': {'total_loss': 31.573597},
     'validation_loss': 31.573597}
train | step:  80000 | training until step 100000...
train | step:  90000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.621371,
           'avg_obj': 0.122146204,
           'box_loss': 2.6922104,
           'class_loss': 3.38946,
           'conf_loss': 5.9656286,
           'precision50': 0.10351054,
           'recall50': 0.037758652},
     '4': {'avg_iou': 0.7229004,
           'avg_obj': 0.24158716,
           'box_loss': 2.644978,
           'class_loss': 4.0071177,
           'conf_loss': 7.0682783,
           'precision50': 0.24388355,
           'recall50': 0.160231},
     '5': {'avg_iou': 0.78865457,
           'avg_obj': 0.38641378,
           'box_loss': 1.4716103,
           'class_loss': 2.7949696,
           'conf_loss': 4.1923513,
           'precision50': 0.40855554,
           'recall50': 0.38483647},
     'global': {'total_loss': 34.22657},
     'learning_rate': 0.00131,
     'training_loss': 34.22657}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-90000.
train | step:  100000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.624369,
           'avg_obj': 0.12613405,
           'box_loss': 2.6749377,
           'class_loss': 3.3292043,
           'conf_loss': 5.9503546,
           'precision50': 0.107347526,
           'recall50': 0.040289655},
     '4': {'avg_iou': 0.72601074,
           'avg_obj': 0.24788366,
           'box_loss': 2.622931,
           'class_loss': 3.9260817,
           'conf_loss': 7.030309,
           'precision50': 0.24774788,
           'recall50': 0.16630456},
     '5': {'avg_iou': 0.7914058,
           'avg_obj': 0.39429724,
           'box_loss': 1.4553678,
           'class_loss': 2.7361212,
           'conf_loss': 4.148173,
           'precision50': 0.4098786,
           'recall50': 0.39315087},
     'global': {'total_loss': 33.8734},
     'learning_rate': 0.00131,
     'training_loss': 33.8734}
 eval | step:  100000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.23s).
Accumulating evaluation results...
DONE (t=17.19s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.216
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.415
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.202
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.076
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.213
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.323
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.216
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.363
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.403
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.199
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.418
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.553
 eval | step:  100000 | eval time:  502.2 sec | output: 
    {'3': {'avg_iou': 0.4507964,
           'avg_obj': 0.12352651,
           'box_loss': 3.254565,
           'class_loss': 2.902686,
           'conf_loss': 7.3405576,
           'precision50': 0.18149476,
           'recall50': 0.09197851},
     '4': {'avg_iou': 0.6545204,
           'avg_obj': 0.26930803,
           'box_loss': 2.6594121,
           'class_loss': 2.5543675,
           'conf_loss': 6.484525,
           'precision50': 0.3194739,
           'recall50': 0.24738295},
     '5': {'avg_iou': 0.73084044,
           'avg_obj': 0.46376556,
           'box_loss': 1.337529,
           'class_loss': 1.448726,
           'conf_loss': 3.1494555,
           'precision50': 0.41471153,
           'recall50': 0.4647062},
     'AP': 0.21603431,
     'AP50': 0.41537356,
     'AP75': 0.20181993,
     'APl': 0.3231256,
     'APm': 0.21286598,
     'APs': 0.075974904,
     'ARl': 0.552808,
     'ARm': 0.41761297,
     'ARmax1': 0.21629234,
     'ARmax10': 0.3631782,
     'ARmax100': 0.40286285,
     'ARs': 0.19931829,
     'global': {'total_loss': 31.131815},
     'validation_loss': 31.131815}I0420 10:34:10.390309 139894318675776 controller.py:211] train | step:  100000 | training until step 120000...
I0420 11:32:36.960301 139894318675776 controller.py:425] train | step:  110000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.626698,
           'avg_obj': 0.13006394,
           'box_loss': 2.6589055,
           'class_loss': 3.2664082,
           'conf_loss': 5.921496,
           'precision50': 0.110882506,
           'recall50': 0.04273794},
     '4': {'avg_iou': 0.7285191,
           'avg_obj': 0.2537447,
           'box_loss': 2.5935185,
           'class_loss': 3.8398027,
           'conf_loss': 6.9606853,
           'precision50': 0.2502384,
           'recall50': 0.1714527},
     '5': {'avg_iou': 0.7937667,
           'avg_obj': 0.40082374,
           'box_loss': 1.4366512,
           'class_loss': 2.6789742,
           'conf_loss': 4.097233,
           'precision50': 0.4121698,
           'recall50': 0.40179643},
     'global': {'total_loss': 33.453667},
     'learning_rate': 0.00131,
     'training_loss': 33.453667}
I0420 11:33:26.889926 139894318675776 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-110000.
I0420 12:32:11.907812 139894318675776 controller.py:425] train | step:  120000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6289759,
           'avg_obj': 0.13368627,
           'box_loss': 2.6442091,
           'class_loss': 3.2173264,
           'conf_loss': 5.898507,
           'precision50': 0.11318175,
           'recall50': 0.044476762},
     '4': {'avg_iou': 0.73110443,
           'avg_obj': 0.2584271,
           'box_loss': 2.571761,
           'class_loss': 3.7714794,
           'conf_loss': 6.926212,
           'precision50': 0.25340426,
           'recall50': 0.17619264},
     '5': {'avg_iou': 0.795908,
           'avg_obj': 0.40722647,
           'box_loss': 1.4244214,
           'class_loss': 2.6231413,
           'conf_loss': 4.0612373,
           'precision50': 0.41268712,
           'recall50': 0.40816092},
     'global': {'total_loss': 33.138336},
     'learning_rate': 0.00131,
     'training_loss': 33.138336}
I0420 12:32:23.882776 139894318675776 controller.py:252]  eval | step:  120000 | running 625 steps of evaluation...
I0420 12:36:40.281530 139894318675776 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0420 12:40:52.461010 139894318675776 controller.py:261]  eval | step:  120000 | eval time:  508.6 sec | output: 
    {'3': {'avg_iou': 0.45675176,
           'avg_obj': 0.13218361,
           'box_loss': 3.1841893,
           'class_loss': 2.8410606,
           'conf_loss': 7.161237,
           'precision50': 0.19969296,
           'recall50': 0.10434482},
     '4': {'avg_iou': 0.66751975,
           'avg_obj': 0.3136218,
           'box_loss': 2.5001535,
           'class_loss': 2.5040927,
           'conf_loss': 6.229288,
           'precision50': 0.33685634,
           'recall50': 0.29718554},
     '5': {'avg_iou': 0.7407278,
           'avg_obj': 0.49184117,
           'box_loss': 1.2729108,
           'class_loss': 1.3855994,
           'conf_loss': 3.022043,
           'precision50': 0.43789718,
           'recall50': 0.5009684},
     'AP': 0.23514485,
     'AP50': 0.43035612,
     'AP75': 0.23334551,
     'APl': 0.34898984,
     'APm': 0.23803693,
     'APs': 0.080818795,
     'ARl': 0.579484,
     'ARm': 0.4515899,
     'ARmax1': 0.22899048,
     'ARmax10': 0.38541934,
     'ARmax100': 0.4240568,
     'ARs': 0.2071071,
     'global': {'total_loss': 30.100573},
     'validation_loss': 30.100573}
I0420 12:41:08.531194 139894318675776 controller.py:211] train | step:  120000 | training until step 140000...
I0420 13:39:10.910224 139894318675776 controller.py:425] train | step:  130000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.63065225,
           'avg_obj': 0.13719831,
           'box_loss': 2.6299682,
           'class_loss': 3.1683006,
           'conf_loss': 5.8691015,
           'precision50': 0.11683171,
           'recall50': 0.04684931},
     '4': {'avg_iou': 0.7330805,
           'avg_obj': 0.263484,
           'box_loss': 2.5486898,
           'class_loss': 3.6988902,
           'conf_loss': 6.866901,
           'precision50': 0.2558986,
           'recall50': 0.18108061},
     '5': {'avg_iou': 0.7975317,
           'avg_obj': 0.4124431,
           'box_loss': 1.4100412,
           'class_loss': 2.5724444,
           'conf_loss': 4.018313,
           'precision50': 0.4141832,
           'recall50': 0.41338056},
     'global': {'total_loss': 32.782692},
     'learning_rate': 0.00131,
     'training_loss': 32.782692}
I0420 13:40:03.175824 139894318675776 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-130000.
I0420 14:46:02.202213 139894318675776 controller.py:425] train | step:  140000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6325245,
           'avg_obj': 0.13954988,
           'box_loss': 2.613233,
           'class_loss': 3.1139476,
           'conf_loss': 5.8417783,
           'precision50': 0.1181718,
           'recall50': 0.048107106},
     '4': {'avg_iou': 0.73477226,
           'avg_obj': 0.26714906,
           'box_loss': 2.5303695,
           'class_loss': 3.6371305,
           'conf_loss': 6.828682,
           'precision50': 0.25753155,
           'recall50': 0.18433519},
     '5': {'avg_iou': 0.79928935,
           'avg_obj': 0.4172627,
           'box_loss': 1.3996326,
           'class_loss': 2.5288234,
           'conf_loss': 3.9898527,
           'precision50': 0.41645765,
           'recall50': 0.41929922},
     'global': {'total_loss': 32.4834},
     'learning_rate': 0.00131,
     'training_loss': 32.4834}
I0420 14:46:30.667037 139894318675776 controller.py:252]  eval | step:  140000 | running 625 steps of evaluation...
I0420 14:50:52.858385 139894318675776 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0420 14:55:07.521235 139894318675776 controller.py:261]  eval | step:  140000 | eval time:  516.9 sec | output: 
    {'3': {'avg_iou': 0.46704048,
           'avg_obj': 0.13489053,
           'box_loss': 3.050136,
           'class_loss': 2.7063513,
           'conf_loss': 7.1360393,
           'precision50': 0.20454107,
           'recall50': 0.10263822},
     '4': {'avg_iou': 0.67136365,
           'avg_obj': 0.31635714,
           'box_loss': 2.4532466,
           'class_loss': 2.4094021,
           'conf_loss': 6.1593084,
           'precision50': 0.3419421,
           'recall50': 0.29814002},
     '5': {'avg_iou': 0.74213594,
           'avg_obj': 0.495765,
           'box_loss': 1.2608188,
           'class_loss': 1.3438978,
           'conf_loss': 2.9431148,
           'precision50': 0.43226764,
           'recall50': 0.50000733},
     'AP': 0.24535403,
     'AP50': 0.44598755,
     'AP75': 0.24027053,
     'APl': 0.35296535,
     'APm': 0.2515837,
     'APs': 0.09106692,
     'ARl': 0.57078665,
     'ARm': 0.46296677,
     'ARmax1': 0.23672614,
     'ARmax10': 0.39541128,
     'ARmax100': 0.43538585,
     'ARs': 0.2330843,
     'global': {'total_loss': 29.462303},
     'validation_loss': 29.462303}

train | step:  100000 | training until step 120000...
train | step:  110000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.626698,
           'avg_obj': 0.13006394,
           'box_loss': 2.6589055,
           'class_loss': 3.2664082,
           'conf_loss': 5.921496,
           'precision50': 0.110882506,
           'recall50': 0.04273794},
     '4': {'avg_iou': 0.7285191,
           'avg_obj': 0.2537447,
           'box_loss': 2.5935185,
           'class_loss': 3.8398027,
           'conf_loss': 6.9606853,
           'precision50': 0.2502384,
           'recall50': 0.1714527},
     '5': {'avg_iou': 0.7937667,
           'avg_obj': 0.40082374,
           'box_loss': 1.4366512,
           'class_loss': 2.6789742,
           'conf_loss': 4.097233,
           'precision50': 0.4121698,
           'recall50': 0.40179643},
     'global': {'total_loss': 33.453667},
     'learning_rate': 0.00131,
     'training_loss': 33.453667}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-110000.
train | step:  120000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6289759,
           'avg_obj': 0.13368627,
           'box_loss': 2.6442091,
           'class_loss': 3.2173264,
           'conf_loss': 5.898507,
           'precision50': 0.11318175,
           'recall50': 0.044476762},
     '4': {'avg_iou': 0.73110443,
           'avg_obj': 0.2584271,
           'box_loss': 2.571761,
           'class_loss': 3.7714794,
           'conf_loss': 6.926212,
           'precision50': 0.25340426,
           'recall50': 0.17619264},
     '5': {'avg_iou': 0.795908,
           'avg_obj': 0.40722647,
           'box_loss': 1.4244214,
           'class_loss': 2.6231413,
           'conf_loss': 4.0612373,
           'precision50': 0.41268712,
           'recall50': 0.40816092},
     'global': {'total_loss': 33.138336},
     'learning_rate': 0.00131,
     'training_loss': 33.138336}
 eval | step:  120000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=173.57s).
Accumulating evaluation results...
DONE (t=19.12s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.235
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.430
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.233
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.081
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.238
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.349
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.229
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.385
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.424
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.207
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.452
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.579
 eval | step:  120000 | eval time:  508.6 sec | output: 
    {'3': {'avg_iou': 0.45675176,
           'avg_obj': 0.13218361,
           'box_loss': 3.1841893,
           'class_loss': 2.8410606,
           'conf_loss': 7.161237,
           'precision50': 0.19969296,
           'recall50': 0.10434482},
     '4': {'avg_iou': 0.66751975,
           'avg_obj': 0.3136218,
           'box_loss': 2.5001535,
           'class_loss': 2.5040927,
           'conf_loss': 6.229288,
           'precision50': 0.33685634,
           'recall50': 0.29718554},
     '5': {'avg_iou': 0.7407278,
           'avg_obj': 0.49184117,
           'box_loss': 1.2729108,
           'class_loss': 1.3855994,
           'conf_loss': 3.022043,
           'precision50': 0.43789718,
           'recall50': 0.5009684},
     'AP': 0.23514485,
     'AP50': 0.43035612,
     'AP75': 0.23334551,
     'APl': 0.34898984,
     'APm': 0.23803693,
     'APs': 0.080818795,
     'ARl': 0.579484,
     'ARm': 0.4515899,
     'ARmax1': 0.22899048,
     'ARmax10': 0.38541934,
     'ARmax100': 0.4240568,
     'ARs': 0.2071071,
     'global': {'total_loss': 30.100573},
     'validation_loss': 30.100573}
train | step:  120000 | training until step 140000...
train | step:  130000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.63065225,
           'avg_obj': 0.13719831,
           'box_loss': 2.6299682,
           'class_loss': 3.1683006,
           'conf_loss': 5.8691015,
           'precision50': 0.11683171,
           'recall50': 0.04684931},
     '4': {'avg_iou': 0.7330805,
           'avg_obj': 0.263484,
           'box_loss': 2.5486898,
           'class_loss': 3.6988902,
           'conf_loss': 6.866901,
           'precision50': 0.2558986,
           'recall50': 0.18108061},
     '5': {'avg_iou': 0.7975317,
           'avg_obj': 0.4124431,
           'box_loss': 1.4100412,
           'class_loss': 2.5724444,
           'conf_loss': 4.018313,
           'precision50': 0.4141832,
           'recall50': 0.41338056},
     'global': {'total_loss': 32.782692},
     'learning_rate': 0.00131,
     'training_loss': 32.782692}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-130000.
train | step:  140000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6325245,
           'avg_obj': 0.13954988,
           'box_loss': 2.613233,
           'class_loss': 3.1139476,
           'conf_loss': 5.8417783,
           'precision50': 0.1181718,
           'recall50': 0.048107106},
     '4': {'avg_iou': 0.73477226,
           'avg_obj': 0.26714906,
           'box_loss': 2.5303695,
           'class_loss': 3.6371305,
           'conf_loss': 6.828682,
           'precision50': 0.25753155,
           'recall50': 0.18433519},
     '5': {'avg_iou': 0.79928935,
           'avg_obj': 0.4172627,
           'box_loss': 1.3996326,
           'class_loss': 2.5288234,
           'conf_loss': 3.9898527,
           'precision50': 0.41645765,
           'recall50': 0.41929922},
     'global': {'total_loss': 32.4834},
     'learning_rate': 0.00131,
     'training_loss': 32.4834}
 eval | step:  140000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=177.20s).
Accumulating evaluation results...
DONE (t=17.34s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.245
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.446
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.240
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.091
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.252
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.353
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.237
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.395
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.435
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.233
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.463
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.571
 eval | step:  140000 | eval time:  516.9 sec | output: 
    {'3': {'avg_iou': 0.46704048,
           'avg_obj': 0.13489053,
           'box_loss': 3.050136,
           'class_loss': 2.7063513,
           'conf_loss': 7.1360393,
           'precision50': 0.20454107,
           'recall50': 0.10263822},
     '4': {'avg_iou': 0.67136365,
           'avg_obj': 0.31635714,
           'box_loss': 2.4532466,
           'class_loss': 2.4094021,
           'conf_loss': 6.1593084,
           'precision50': 0.3419421,
           'recall50': 0.29814002},
     '5': {'avg_iou': 0.74213594,
           'avg_obj': 0.495765,
           'box_loss': 1.2608188,
           'class_loss': 1.3438978,
           'conf_loss': 2.9431148,
           'precision50': 0.43226764,
           'recall50': 0.50000733},
     'AP': 0.24535403,
     'AP50': 0.44598755,
     'AP75': 0.24027053,
     'APl': 0.35296535,
     'APm': 0.2515837,
     'APs': 0.09106692,
     'ARl': 0.57078665,
     'ARm': 0.46296677,
     'ARmax1': 0.23672614,
     'ARmax10': 0.39541128,
     'ARmax100': 0.43538585,
     'ARs': 0.2330843,
     'global': {'total_loss': 29.462303},
     'validation_loss': 29.462303}I0420 14:55:24.541549 139894318675776 controller.py:211] train | step:  140000 | training until step 160000...
I0420 15:54:54.643784 139894318675776 controller.py:425] train | step:  150000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.63437307,
           'avg_obj': 0.14303598,
           'box_loss': 2.6055796,
           'class_loss': 3.0844133,
           'conf_loss': 5.831408,
           'precision50': 0.12166111,
           'recall50': 0.050438114},
     '4': {'avg_iou': 0.736597,
           'avg_obj': 0.2715132,
           'box_loss': 2.5154247,
           'class_loss': 3.5871336,
           'conf_loss': 6.7934065,
           'precision50': 0.26041216,
           'recall50': 0.18874177},
     '5': {'avg_iou': 0.80076945,
           'avg_obj': 0.42161313,
           'box_loss': 1.388872,
           'class_loss': 2.491123,
           'conf_loss': 3.9589612,
           'precision50': 0.41756308,
           'recall50': 0.42365626},
     'global': {'total_loss': 32.256325},
     'learning_rate': 0.00131,
     'training_loss': 32.256325}
I0420 15:55:42.739616 139894318675776 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-150000.
I0420 16:59:30.183702 139894318675776 controller.py:425] train | step:  160000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.63570327,
           'avg_obj': 0.14535683,
           'box_loss': 2.5942903,
           'class_loss': 3.0435975,
           'conf_loss': 5.808498,
           'precision50': 0.12313766,
           'recall50': 0.051687457},
     '4': {'avg_iou': 0.7385287,
           'avg_obj': 0.27525318,
           'box_loss': 2.496427,
           'class_loss': 3.5396335,
           'conf_loss': 6.7563257,
           'precision50': 0.26206028,
           'recall50': 0.19223061},
     '5': {'avg_iou': 0.802451,
           'avg_obj': 0.42685807,
           'box_loss': 1.3777864,
           'class_loss': 2.451709,
           'conf_loss': 3.9258833,
           'precision50': 0.41933402,
           'recall50': 0.4301585},
     'global': {'total_loss': 31.994116},
     'learning_rate': 0.00131,
     'training_loss': 31.994116}
I0420 16:59:43.239681 139894318675776 controller.py:252]  eval | step:  160000 | running 625 steps of evaluation...
I0420 17:03:58.475081 139894318675776 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0420 17:08:14.918442 139894318675776 controller.py:261]  eval | step:  160000 | eval time:  511.7 sec | output: 
    {'3': {'avg_iou': 0.46209946,
           'avg_obj': 0.13790248,
           'box_loss': 3.115243,
           'class_loss': 2.6121492,
           'conf_loss': 7.1949744,
           'precision50': 0.19624886,
           'recall50': 0.10740814},
     '4': {'avg_iou': 0.6693829,
           'avg_obj': 0.3334941,
           'box_loss': 2.4724765,
           'class_loss': 2.2605019,
           'conf_loss': 6.165245,
           'precision50': 0.3401794,
           'recall50': 0.31934327},
     '5': {'avg_iou': 0.7392439,
           'avg_obj': 0.5296562,
           'box_loss': 1.2821808,
           'class_loss': 1.2273465,
           'conf_loss': 2.9618196,
           'precision50': 0.42011157,
           'recall50': 0.541101},
     'AP': 0.24686883,
     'AP50': 0.46078965,
     'AP75': 0.24064758,
     'APl': 0.36626336,
     'APm': 0.24656983,
     'APs': 0.0868807,
     'ARl': 0.5770324,
     'ARm': 0.45674932,
     'ARmax1': 0.23333092,
     'ARmax10': 0.3921187,
     'ARmax100': 0.43180215,
     'ARs': 0.2135059,
     'global': {'total_loss': 29.291931},
     'validation_loss': 29.291931}
I0420 17:08:31.152907 139894318675776 controller.py:211] train | step:  160000 | training until step 180000...
I0420 18:04:12.130249 139894318675776 controller.py:425] train | step:  170000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6370585,
           'avg_obj': 0.14821719,
           'box_loss': 2.5877576,
           'class_loss': 3.0170887,
           'conf_loss': 5.7993975,
           'precision50': 0.12574247,
           'recall50': 0.053710878},
     '4': {'avg_iou': 0.7399834,
           'avg_obj': 0.27910918,
           'box_loss': 2.4854426,
           'class_loss': 3.500514,
           'conf_loss': 6.727484,
           'precision50': 0.2642131,
           'recall50': 0.19559954},
     '5': {'avg_iou': 0.8036763,
           'avg_obj': 0.43064174,
           'box_loss': 1.3675859,
           'class_loss': 2.4238212,
           'conf_loss': 3.8931277,
           'precision50': 0.41927046,
           'recall50': 0.43413574},
     'global': {'total_loss': 31.802328},
     'learning_rate': 0.00131,
     'training_loss': 31.802328}
I0420 18:05:02.802240 139894318675776 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-170000.
I0420 19:03:31.895784 139894318675776 controller.py:425] train | step:  180000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6384895,
           'avg_obj': 0.1504317,
           'box_loss': 2.58108,
           'class_loss': 2.989562,
           'conf_loss': 5.7837467,
           'precision50': 0.12703057,
           'recall50': 0.054787952},
     '4': {'avg_iou': 0.74138457,
           'avg_obj': 0.28237647,
           'box_loss': 2.4688866,
           'class_loss': 3.456726,
           'conf_loss': 6.687461,
           'precision50': 0.26531377,
           'recall50': 0.1983609},
     '5': {'avg_iou': 0.80471456,
           'avg_obj': 0.4339638,
           'box_loss': 1.3602961,
           'class_loss': 2.3914046,
           'conf_loss': 3.8714314,
           'precision50': 0.419159,
           'recall50': 0.4382621},
     'global': {'total_loss': 31.590637},
     'learning_rate': 0.00131,
     'training_loss': 31.590637}
I0420 19:03:44.823789 139894318675776 controller.py:252]  eval | step:  180000 | running 625 steps of evaluation...
I0420 19:08:00.880981 139894318675776 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0420 19:12:21.133709 139894318675776 controller.py:261]  eval | step:  180000 | eval time:  516.3 sec | output: 
    {'3': {'avg_iou': 0.47193876,
           'avg_obj': 0.15731098,
           'box_loss': 2.9878783,
           'class_loss': 2.4580371,
           'conf_loss': 6.9122443,
           'precision50': 0.22540517,
           'recall50': 0.1315084},
     '4': {'avg_iou': 0.6818316,
           'avg_obj': 0.34785715,
           'box_loss': 2.3491766,
           'class_loss': 2.1645718,
           'conf_loss': 5.906848,
           'precision50': 0.35480088,
           'recall50': 0.33462572},
     '5': {'avg_iou': 0.75467485,
           'avg_obj': 0.524982,
           'box_loss': 1.1843647,
           'class_loss': 1.2096288,
           'conf_loss': 2.7709873,
           'precision50': 0.44431832,
           'recall50': 0.5335649},
     'AP': 0.27324867,
     'AP50': 0.48287544,
     'AP75': 0.28199607,
     'APl': 0.39088705,
     'APm': 0.28087643,
     'APs': 0.10407674,
     'ARl': 0.5992551,
     'ARm': 0.49010712,
     'ARmax1': 0.25330332,
     'ARmax10': 0.4196332,
     'ARmax100': 0.46055472,
     'ARs': 0.24731901,
     'global': {'total_loss': 27.943747},
     'validation_loss': 27.943747}

train | step:  140000 | training until step 160000...
train | step:  150000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.63437307,
           'avg_obj': 0.14303598,
           'box_loss': 2.6055796,
           'class_loss': 3.0844133,
           'conf_loss': 5.831408,
           'precision50': 0.12166111,
           'recall50': 0.050438114},
     '4': {'avg_iou': 0.736597,
           'avg_obj': 0.2715132,
           'box_loss': 2.5154247,
           'class_loss': 3.5871336,
           'conf_loss': 6.7934065,
           'precision50': 0.26041216,
           'recall50': 0.18874177},
     '5': {'avg_iou': 0.80076945,
           'avg_obj': 0.42161313,
           'box_loss': 1.388872,
           'class_loss': 2.491123,
           'conf_loss': 3.9589612,
           'precision50': 0.41756308,
           'recall50': 0.42365626},
     'global': {'total_loss': 32.256325},
     'learning_rate': 0.00131,
     'training_loss': 32.256325}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-150000.
train | step:  160000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.63570327,
           'avg_obj': 0.14535683,
           'box_loss': 2.5942903,
           'class_loss': 3.0435975,
           'conf_loss': 5.808498,
           'precision50': 0.12313766,
           'recall50': 0.051687457},
     '4': {'avg_iou': 0.7385287,
           'avg_obj': 0.27525318,
           'box_loss': 2.496427,
           'class_loss': 3.5396335,
           'conf_loss': 6.7563257,
           'precision50': 0.26206028,
           'recall50': 0.19223061},
     '5': {'avg_iou': 0.802451,
           'avg_obj': 0.42685807,
           'box_loss': 1.3777864,
           'class_loss': 2.451709,
           'conf_loss': 3.9258833,
           'precision50': 0.41933402,
           'recall50': 0.4301585},
     'global': {'total_loss': 31.994116},
     'learning_rate': 0.00131,
     'training_loss': 31.994116}
 eval | step:  160000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=180.64s).
Accumulating evaluation results...
DONE (t=17.01s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.247
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.461
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.241
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.087
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.247
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.366
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.233
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.392
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.432
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.214
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.457
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.577
 eval | step:  160000 | eval time:  511.7 sec | output: 
    {'3': {'avg_iou': 0.46209946,
           'avg_obj': 0.13790248,
           'box_loss': 3.115243,
           'class_loss': 2.6121492,
           'conf_loss': 7.1949744,
           'precision50': 0.19624886,
           'recall50': 0.10740814},
     '4': {'avg_iou': 0.6693829,
           'avg_obj': 0.3334941,
           'box_loss': 2.4724765,
           'class_loss': 2.2605019,
           'conf_loss': 6.165245,
           'precision50': 0.3401794,
           'recall50': 0.31934327},
     '5': {'avg_iou': 0.7392439,
           'avg_obj': 0.5296562,
           'box_loss': 1.2821808,
           'class_loss': 1.2273465,
           'conf_loss': 2.9618196,
           'precision50': 0.42011157,
           'recall50': 0.541101},
     'AP': 0.24686883,
     'AP50': 0.46078965,
     'AP75': 0.24064758,
     'APl': 0.36626336,
     'APm': 0.24656983,
     'APs': 0.0868807,
     'ARl': 0.5770324,
     'ARm': 0.45674932,
     'ARmax1': 0.23333092,
     'ARmax10': 0.3921187,
     'ARmax100': 0.43180215,
     'ARs': 0.2135059,
     'global': {'total_loss': 29.291931},
     'validation_loss': 29.291931}
train | step:  160000 | training until step 180000...
train | step:  170000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6370585,
           'avg_obj': 0.14821719,
           'box_loss': 2.5877576,
           'class_loss': 3.0170887,
           'conf_loss': 5.7993975,
           'precision50': 0.12574247,
           'recall50': 0.053710878},
     '4': {'avg_iou': 0.7399834,
           'avg_obj': 0.27910918,
           'box_loss': 2.4854426,
           'class_loss': 3.500514,
           'conf_loss': 6.727484,
           'precision50': 0.2642131,
           'recall50': 0.19559954},
     '5': {'avg_iou': 0.8036763,
           'avg_obj': 0.43064174,
           'box_loss': 1.3675859,
           'class_loss': 2.4238212,
           'conf_loss': 3.8931277,
           'precision50': 0.41927046,
           'recall50': 0.43413574},
     'global': {'total_loss': 31.802328},
     'learning_rate': 0.00131,
     'training_loss': 31.802328}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-170000.
train | step:  180000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6384895,
           'avg_obj': 0.1504317,
           'box_loss': 2.58108,
           'class_loss': 2.989562,
           'conf_loss': 5.7837467,
           'precision50': 0.12703057,
           'recall50': 0.054787952},
     '4': {'avg_iou': 0.74138457,
           'avg_obj': 0.28237647,
           'box_loss': 2.4688866,
           'class_loss': 3.456726,
           'conf_loss': 6.687461,
           'precision50': 0.26531377,
           'recall50': 0.1983609},
     '5': {'avg_iou': 0.80471456,
           'avg_obj': 0.4339638,
           'box_loss': 1.3602961,
           'class_loss': 2.3914046,
           'conf_loss': 3.8714314,
           'precision50': 0.419159,
           'recall50': 0.4382621},
     'global': {'total_loss': 31.590637},
     'learning_rate': 0.00131,
     'training_loss': 31.590637}
 eval | step:  180000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=185.25s).
Accumulating evaluation results...
DONE (t=16.04s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.273
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.483
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.282
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.104
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.281
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.391
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.253
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.420
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.461
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.247
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.490
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.599
 eval | step:  180000 | eval time:  516.3 sec | output: 
    {'3': {'avg_iou': 0.47193876,
           'avg_obj': 0.15731098,
           'box_loss': 2.9878783,
           'class_loss': 2.4580371,
           'conf_loss': 6.9122443,
           'precision50': 0.22540517,
           'recall50': 0.1315084},
     '4': {'avg_iou': 0.6818316,
           'avg_obj': 0.34785715,
           'box_loss': 2.3491766,
           'class_loss': 2.1645718,
           'conf_loss': 5.906848,
           'precision50': 0.35480088,
           'recall50': 0.33462572},
     '5': {'avg_iou': 0.75467485,
           'avg_obj': 0.524982,
           'box_loss': 1.1843647,
           'class_loss': 1.2096288,
           'conf_loss': 2.7709873,
           'precision50': 0.44431832,
           'recall50': 0.5335649},
     'AP': 0.27324867,
     'AP50': 0.48287544,
     'AP75': 0.28199607,
     'APl': 0.39088705,
     'APm': 0.28087643,
     'APs': 0.10407674,
     'ARl': 0.5992551,
     'ARm': 0.49010712,
     'ARmax1': 0.25330332,
     'ARmax10': 0.4196332,
     'ARmax100': 0.46055472,
     'ARs': 0.24731901,
     'global': {'total_loss': 27.943747},
     'validation_loss': 27.943747}I0420 19:12:38.172986 139894318675776 controller.py:211] train | step:  180000 | training until step 200000...
I0420 20:05:09.883126 139894318675776 controller.py:425] train | step:  190000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6396003,
           'avg_obj': 0.15201509,
           'box_loss': 2.5646682,
           'class_loss': 2.9504886,
           'conf_loss': 5.76188,
           'precision50': 0.12791708,
           'recall50': 0.05557968},
     '4': {'avg_iou': 0.74278,
           'avg_obj': 0.28578186,
           'box_loss': 2.4605765,
           'class_loss': 3.4187582,
           'conf_loss': 6.669005,
           'precision50': 0.26697367,
           'recall50': 0.20188199},
     '5': {'avg_iou': 0.8057776,
           'avg_obj': 0.43773934,
           'box_loss': 1.3547404,
           'class_loss': 2.3671143,
           'conf_loss': 3.8525581,
           'precision50': 0.4213514,
           'recall50': 0.44176495},
     'global': {'total_loss': 31.399754},
     'learning_rate': 0.00131,
     'training_loss': 31.399754}
I0420 20:06:02.461188 139894318675776 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-190000.
I0420 21:05:13.048773 139894318675776 controller.py:425] train | step:  200000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6405772,
           'avg_obj': 0.15424299,
           'box_loss': 2.56495,
           'class_loss': 2.9327765,
           'conf_loss': 5.7602444,
           'precision50': 0.13011684,
           'recall50': 0.05712591},
     '4': {'avg_iou': 0.7437455,
           'avg_obj': 0.2876133,
           'box_loss': 2.4505568,
           'class_loss': 3.3812149,
           'conf_loss': 6.648882,
           'precision50': 0.26819223,
           'recall50': 0.20348294},
     '5': {'avg_iou': 0.80659515,
           'avg_obj': 0.4402411,
           'box_loss': 1.348471,
           'class_loss': 2.3410125,
           'conf_loss': 3.8336136,
           'precision50': 0.42166346,
           'recall50': 0.44417754},
     'global': {'total_loss': 31.261766},
     'learning_rate': 0.00131,
     'training_loss': 31.261766}
I0420 21:05:25.428635 139894318675776 controller.py:252]  eval | step:  200000 | running 625 steps of evaluation...
I0420 21:09:40.671765 139894318675776 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0420 21:13:53.439016 139894318675776 controller.py:261]  eval | step:  200000 | eval time:  508.0 sec | output: 
    {'3': {'avg_iou': 0.45294762,
           'avg_obj': 0.12574211,
           'box_loss': 3.2385929,
           'class_loss': 2.5723026,
           'conf_loss': 7.3157835,
           'precision50': 0.18541242,
           'recall50': 0.093334846},
     '4': {'avg_iou': 0.66077334,
           'avg_obj': 0.29837996,
           'box_loss': 2.592413,
           'class_loss': 2.2509916,
           'conf_loss': 6.3170724,
           'precision50': 0.32724312,
           'recall50': 0.2792656},
     '5': {'avg_iou': 0.7329383,
           'avg_obj': 0.51038855,
           'box_loss': 1.3210377,
           'class_loss': 1.2451131,
           'conf_loss': 3.0538735,
           'precision50': 0.41463974,
           'recall50': 0.51886916},
     'AP': 0.23821156,
     'AP50': 0.4590174,
     'AP75': 0.22523579,
     'APl': 0.35280725,
     'APm': 0.23769948,
     'APs': 0.07975326,
     'ARl': 0.5596108,
     'ARm': 0.43599224,
     'ARmax1': 0.22969632,
     'ARmax10': 0.377157,
     'ARmax100': 0.41576156,
     'ARs': 0.20470351,
     'global': {'total_loss': 29.90718},
     'validation_loss': 29.90718}
I0420 21:14:10.798744 139894318675776 controller.py:211] train | step:  200000 | training until step 220000...
I0420 22:05:28.786373 139894318675776 controller.py:425] train | step:  210000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6419071,
           'avg_obj': 0.15543641,
           'box_loss': 2.5535555,
           'class_loss': 2.9104266,
           'conf_loss': 5.7445693,
           'precision50': 0.13089776,
           'recall50': 0.058093652},
     '4': {'avg_iou': 0.7447625,
           'avg_obj': 0.2896772,
           'box_loss': 2.441425,
           'class_loss': 3.3600452,
           'conf_loss': 6.629589,
           'precision50': 0.269423,
           'recall50': 0.2053938},
     '5': {'avg_iou': 0.80779904,
           'avg_obj': 0.44285074,
           'box_loss': 1.3413869,
           'class_loss': 2.3186765,
           'conf_loss': 3.8186238,
           'precision50': 0.42166,
           'recall50': 0.4472},
     'global': {'total_loss': 31.118319},
     'learning_rate': 0.00131,
     'training_loss': 31.118319}
I0420 22:06:19.479108 139894318675776 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-210000.
I0420 23:05:07.493083 139894318675776 controller.py:425] train | step:  220000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6427648,
           'avg_obj': 0.15739998,
           'box_loss': 2.5455587,
           'class_loss': 2.876113,
           'conf_loss': 5.7259026,
           'precision50': 0.13169642,
           'recall50': 0.059180785},
     '4': {'avg_iou': 0.74596775,
           'avg_obj': 0.29257676,
           'box_loss': 2.4274805,
           'class_loss': 3.3124497,
           'conf_loss': 6.5972366,
           'precision50': 0.2698757,
           'recall50': 0.20807673},
     '5': {'avg_iou': 0.80868274,
           'avg_obj': 0.44623125,
           'box_loss': 1.3338728,
           'class_loss': 2.2896972,
           'conf_loss': 3.7939758,
           'precision50': 0.42138878,
           'recall50': 0.4501725},
     'global': {'total_loss': 30.902304},
     'learning_rate': 0.00131,
     'training_loss': 30.902304}
I0420 23:05:19.561991 139894318675776 controller.py:252]  eval | step:  220000 | running 625 steps of evaluation...
I0420 23:09:32.523418 139894318675776 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0420 23:13:41.962232 139894318675776 controller.py:261]  eval | step:  220000 | eval time:  502.4 sec | output: 
    {'3': {'avg_iou': 0.46269068,
           'avg_obj': 0.14200744,
           'box_loss': 3.1279476,
           'class_loss': 2.4807627,
           'conf_loss': 7.0743814,
           'precision50': 0.21424708,
           'recall50': 0.11594934},
     '4': {'avg_iou': 0.66851306,
           'avg_obj': 0.34268478,
           'box_loss': 2.5034122,
           'class_loss': 2.1990654,
           'conf_loss': 6.0527334,
           'precision50': 0.34816322,
           'recall50': 0.3299168},
     '5': {'avg_iou': 0.7444378,
           'avg_obj': 0.55261976,
           'box_loss': 1.2431834,
           'class_loss': 1.2085811,
           'conf_loss': 2.8827803,
           'precision50': 0.42208397,
           'recall50': 0.56413704},
     'AP': 0.26056346,
     'AP50': 0.4800468,
     'AP75': 0.25521815,
     'APl': 0.38774627,
     'APm': 0.26276845,
     'APs': 0.09089492,
     'ARl': 0.5866891,
     'ARm': 0.4642733,
     'ARmax1': 0.24185878,
     'ARmax10': 0.39979094,
     'ARmax100': 0.43914247,
     'ARs': 0.23175174,
     'global': {'total_loss': 28.772854},
     'validation_loss': 28.772854}

train | step:  180000 | training until step 200000...
train | step:  190000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6396003,
           'avg_obj': 0.15201509,
           'box_loss': 2.5646682,
           'class_loss': 2.9504886,
           'conf_loss': 5.76188,
           'precision50': 0.12791708,
           'recall50': 0.05557968},
     '4': {'avg_iou': 0.74278,
           'avg_obj': 0.28578186,
           'box_loss': 2.4605765,
           'class_loss': 3.4187582,
           'conf_loss': 6.669005,
           'precision50': 0.26697367,
           'recall50': 0.20188199},
     '5': {'avg_iou': 0.8057776,
           'avg_obj': 0.43773934,
           'box_loss': 1.3547404,
           'class_loss': 2.3671143,
           'conf_loss': 3.8525581,
           'precision50': 0.4213514,
           'recall50': 0.44176495},
     'global': {'total_loss': 31.399754},
     'learning_rate': 0.00131,
     'training_loss': 31.399754}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-190000.
train | step:  200000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6405772,
           'avg_obj': 0.15424299,
           'box_loss': 2.56495,
           'class_loss': 2.9327765,
           'conf_loss': 5.7602444,
           'precision50': 0.13011684,
           'recall50': 0.05712591},
     '4': {'avg_iou': 0.7437455,
           'avg_obj': 0.2876133,
           'box_loss': 2.4505568,
           'class_loss': 3.3812149,
           'conf_loss': 6.648882,
           'precision50': 0.26819223,
           'recall50': 0.20348294},
     '5': {'avg_iou': 0.80659515,
           'avg_obj': 0.4402411,
           'box_loss': 1.348471,
           'class_loss': 2.3410125,
           'conf_loss': 3.8336136,
           'precision50': 0.42166346,
           'recall50': 0.44417754},
     'global': {'total_loss': 31.261766},
     'learning_rate': 0.00131,
     'training_loss': 31.261766}
 eval | step:  200000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=178.58s).
Accumulating evaluation results...
DONE (t=17.14s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.238
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.459
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.225
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.080
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.238
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.353
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.230
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.377
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.416
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.205
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.436
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.560
 eval | step:  200000 | eval time:  508.0 sec | output: 
    {'3': {'avg_iou': 0.45294762,
           'avg_obj': 0.12574211,
           'box_loss': 3.2385929,
           'class_loss': 2.5723026,
           'conf_loss': 7.3157835,
           'precision50': 0.18541242,
           'recall50': 0.093334846},
     '4': {'avg_iou': 0.66077334,
           'avg_obj': 0.29837996,
           'box_loss': 2.592413,
           'class_loss': 2.2509916,
           'conf_loss': 6.3170724,
           'precision50': 0.32724312,
           'recall50': 0.2792656},
     '5': {'avg_iou': 0.7329383,
           'avg_obj': 0.51038855,
           'box_loss': 1.3210377,
           'class_loss': 1.2451131,
           'conf_loss': 3.0538735,
           'precision50': 0.41463974,
           'recall50': 0.51886916},
     'AP': 0.23821156,
     'AP50': 0.4590174,
     'AP75': 0.22523579,
     'APl': 0.35280725,
     'APm': 0.23769948,
     'APs': 0.07975326,
     'ARl': 0.5596108,
     'ARm': 0.43599224,
     'ARmax1': 0.22969632,
     'ARmax10': 0.377157,
     'ARmax100': 0.41576156,
     'ARs': 0.20470351,
     'global': {'total_loss': 29.90718},
     'validation_loss': 29.90718}
train | step:  200000 | training until step 220000...
train | step:  210000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6419071,
           'avg_obj': 0.15543641,
           'box_loss': 2.5535555,
           'class_loss': 2.9104266,
           'conf_loss': 5.7445693,
           'precision50': 0.13089776,
           'recall50': 0.058093652},
     '4': {'avg_iou': 0.7447625,
           'avg_obj': 0.2896772,
           'box_loss': 2.441425,
           'class_loss': 3.3600452,
           'conf_loss': 6.629589,
           'precision50': 0.269423,
           'recall50': 0.2053938},
     '5': {'avg_iou': 0.80779904,
           'avg_obj': 0.44285074,
           'box_loss': 1.3413869,
           'class_loss': 2.3186765,
           'conf_loss': 3.8186238,
           'precision50': 0.42166,
           'recall50': 0.4472},
     'global': {'total_loss': 31.118319},
     'learning_rate': 0.00131,
     'training_loss': 31.118319}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-210000.
train | step:  220000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6427648,
           'avg_obj': 0.15739998,
           'box_loss': 2.5455587,
           'class_loss': 2.876113,
           'conf_loss': 5.7259026,
           'precision50': 0.13169642,
           'recall50': 0.059180785},
     '4': {'avg_iou': 0.74596775,
           'avg_obj': 0.29257676,
           'box_loss': 2.4274805,
           'class_loss': 3.3124497,
           'conf_loss': 6.5972366,
           'precision50': 0.2698757,
           'recall50': 0.20807673},
     '5': {'avg_iou': 0.80868274,
           'avg_obj': 0.44623125,
           'box_loss': 1.3338728,
           'class_loss': 2.2896972,
           'conf_loss': 3.7939758,
           'precision50': 0.42138878,
           'recall50': 0.4501725},
     'global': {'total_loss': 30.902304},
     'learning_rate': 0.00131,
     'training_loss': 30.902304}
 eval | step:  220000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=174.92s).
Accumulating evaluation results...
DONE (t=17.01s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.261
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.480
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.255
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.091
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.263
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.388
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.242
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.400
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.439
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.232
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.464
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.587
 eval | step:  220000 | eval time:  502.4 sec | output: 
    {'3': {'avg_iou': 0.46269068,
           'avg_obj': 0.14200744,
           'box_loss': 3.1279476,
           'class_loss': 2.4807627,
           'conf_loss': 7.0743814,
           'precision50': 0.21424708,
           'recall50': 0.11594934},
     '4': {'avg_iou': 0.66851306,
           'avg_obj': 0.34268478,
           'box_loss': 2.5034122,
           'class_loss': 2.1990654,
           'conf_loss': 6.0527334,
           'precision50': 0.34816322,
           'recall50': 0.3299168},
     '5': {'avg_iou': 0.7444378,
           'avg_obj': 0.55261976,
           'box_loss': 1.2431834,
           'class_loss': 1.2085811,
           'conf_loss': 2.8827803,
           'precision50': 0.42208397,
           'recall50': 0.56413704},
     'AP': 0.26056346,
     'AP50': 0.4800468,
     'AP75': 0.25521815,
     'APl': 0.38774627,
     'APm': 0.26276845,
     'APs': 0.09089492,
     'ARl': 0.5866891,
     'ARm': 0.4642733,
     'ARmax1': 0.24185878,
     'ARmax10': 0.39979094,
     'ARmax100': 0.43914247,
     'ARs': 0.23175174,
     'global': {'total_loss': 28.772854},
     'validation_loss': 28.772854}I0420 23:14:03.698816 139894318675776 controller.py:211] train | step:  220000 | training until step 240000...
I0421 00:05:49.468492 139894318675776 controller.py:425] train | step:  230000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.644004,
           'avg_obj': 0.15959655,
           'box_loss': 2.5334759,
           'class_loss': 2.847131,
           'conf_loss': 5.7014256,
           'precision50': 0.13341752,
           'recall50': 0.06047436},
     '4': {'avg_iou': 0.74717736,
           'avg_obj': 0.2954701,
           'box_loss': 2.4181304,
           'class_loss': 3.2878375,
           'conf_loss': 6.577545,
           'precision50': 0.2707836,
           'recall50': 0.21090251},
     '5': {'avg_iou': 0.8096974,
           'avg_obj': 0.44959393,
           'box_loss': 1.3296069,
           'class_loss': 2.2698786,
           'conf_loss': 3.777943,
           'precision50': 0.4229415,
           'recall50': 0.4544306},
     'global': {'total_loss': 30.743013},
     'learning_rate': 0.00131,
     'training_loss': 30.743013}
I0421 00:06:45.343316 139894318675776 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-230000.
I0421 01:05:26.164328 139894318675776 controller.py:425] train | step:  240000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.64461654,
           'avg_obj': 0.16116248,
           'box_loss': 2.5425284,
           'class_loss': 2.8413913,
           'conf_loss': 5.7218056,
           'precision50': 0.13488027,
           'recall50': 0.061508056},
     '4': {'avg_iou': 0.74781126,
           'avg_obj': 0.29800963,
           'box_loss': 2.4113307,
           'class_loss': 3.2578135,
           'conf_loss': 6.5526686,
           'precision50': 0.2729917,
           'recall50': 0.21327381},
     '5': {'avg_iou': 0.81048024,
           'avg_obj': 0.45192274,
           'box_loss': 1.3219566,
           'class_loss': 2.249616,
           'conf_loss': 3.7542875,
           'precision50': 0.42338043,
           'recall50': 0.4570675},
     'global': {'total_loss': 30.653412},
     'learning_rate': 0.00131,
     'training_loss': 30.653412}
I0421 01:05:38.781546 139894318675776 controller.py:252]  eval | step:  240000 | running 625 steps of evaluation...
I0421 01:09:57.747830 139894318675776 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0421 01:14:08.515229 139894318675776 controller.py:261]  eval | step:  240000 | eval time:  509.7 sec | output: 
    {'3': {'avg_iou': 0.47282833,
           'avg_obj': 0.16032778,
           'box_loss': 2.976576,
           'class_loss': 2.416236,
           'conf_loss': 6.933214,
           'precision50': 0.22314702,
           'recall50': 0.13327393},
     '4': {'avg_iou': 0.68255115,
           'avg_obj': 0.36648807,
           'box_loss': 2.3404953,
           'class_loss': 2.1183105,
           'conf_loss': 5.8120804,
           'precision50': 0.36110455,
           'recall50': 0.36064827},
     '5': {'avg_iou': 0.75752634,
           'avg_obj': 0.5410287,
           'box_loss': 1.1756086,
           'class_loss': 1.1431433,
           'conf_loss': 2.7129602,
           'precision50': 0.43994808,
           'recall50': 0.5541876},
     'AP': 0.28255287,
     'AP50': 0.49439016,
     'AP75': 0.28814864,
     'APl': 0.41661665,
     'APm': 0.28824824,
     'APs': 0.09872557,
     'ARl': 0.61429155,
     'ARm': 0.49164677,
     'ARmax1': 0.25685552,
     'ARmax10': 0.42251936,
     'ARmax100': 0.46372917,
     'ARs': 0.24421543,
     'global': {'total_loss': 27.628632},
     'validation_loss': 27.628632}
I0421 01:14:27.388726 139894318675776 controller.py:211] train | step:  240000 | training until step 260000...
I0421 02:06:03.869483 139894318675776 controller.py:425] train | step:  250000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6526317,
           'avg_obj': 0.1735161,
           'box_loss': 2.475393,
           'class_loss': 2.6662486,
           'conf_loss': 5.6098557,
           'precision50': 0.14338909,
           'recall50': 0.06936235},
     '4': {'avg_iou': 0.75666183,
           'avg_obj': 0.31568685,
           'box_loss': 2.3239806,
           'class_loss': 3.014953,
           'conf_loss': 6.367949,
           'precision50': 0.28087187,
           'recall50': 0.23041247},
     '5': {'avg_iou': 0.819268,
           'avg_obj': 0.47496352,
           'box_loss': 1.2585448,
           'class_loss': 2.041122,
           'conf_loss': 3.5872848,
           'precision50': 0.4261194,
           'recall50': 0.4813897},
     'global': {'total_loss': 29.345345},
     'learning_rate': 0.000131,
     'training_loss': 29.345345}
I0421 02:06:56.037678 139894318675776 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-250000.
I0421 03:08:17.852015 139894318675776 controller.py:425] train | step:  260000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.65464413,
           'avg_obj': 0.17713997,
           'box_loss': 2.466812,
           'class_loss': 2.637266,
           'conf_loss': 5.5934315,
           'precision50': 0.14557922,
           'recall50': 0.07162319},
     '4': {'avg_iou': 0.75829095,
           'avg_obj': 0.32088774,
           'box_loss': 2.3102093,
           'class_loss': 2.9600208,
           'conf_loss': 6.3259163,
           'precision50': 0.28221685,
           'recall50': 0.23482549},
     '5': {'avg_iou': 0.82125056,
           'avg_obj': 0.4806232,
           'box_loss': 1.2450265,
           'class_loss': 1.9976139,
           'conf_loss': 3.5506535,
           'precision50': 0.42718676,
           'recall50': 0.48712504},
     'global': {'total_loss': 29.086979},
     'learning_rate': 0.000131,
     'training_loss': 29.086979}
I0421 03:08:31.768162 139894318675776 controller.py:252]  eval | step:  260000 | running 625 steps of evaluation...
I0421 03:12:47.070630 139894318675776 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0421 03:16:53.655756 139894318675776 controller.py:261]  eval | step:  260000 | eval time:  501.9 sec | output: 
    {'3': {'avg_iou': 0.48208472,
           'avg_obj': 0.1706164,
           'box_loss': 2.8596153,
           'class_loss': 2.112415,
           'conf_loss': 6.7116523,
           'precision50': 0.24067251,
           'recall50': 0.1467705},
     '4': {'avg_iou': 0.69622755,
           'avg_obj': 0.38723,
           'box_loss': 2.2061431,
           'class_loss': 1.7946802,
           'conf_loss': 5.51237,
           'precision50': 0.37088406,
           'recall50': 0.38104844},
     '5': {'avg_iou': 0.7708166,
           'avg_obj': 0.57739,
           'box_loss': 1.0979857,
           'class_loss': 0.9566595,
           'conf_loss': 2.5402749,
           'precision50': 0.44543236,
           'recall50': 0.5896873},
     'AP': 0.31533703,
     'AP50': 0.5335593,
     'AP75': 0.32861423,
     'APl': 0.4548618,
     'APm': 0.31967232,
     'APs': 0.12268495,
     'ARl': 0.637697,
     'ARm': 0.5205609,
     'ARmax1': 0.27337074,
     'ARmax10': 0.44806728,
     'ARmax100': 0.49147794,
     'ARs': 0.28297046,
     'global': {'total_loss': 25.791798},
     'validation_loss': 25.791798}

train | step:  220000 | training until step 240000...
train | step:  230000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.644004,
           'avg_obj': 0.15959655,
           'box_loss': 2.5334759,
           'class_loss': 2.847131,
           'conf_loss': 5.7014256,
           'precision50': 0.13341752,
           'recall50': 0.06047436},
     '4': {'avg_iou': 0.74717736,
           'avg_obj': 0.2954701,
           'box_loss': 2.4181304,
           'class_loss': 3.2878375,
           'conf_loss': 6.577545,
           'precision50': 0.2707836,
           'recall50': 0.21090251},
     '5': {'avg_iou': 0.8096974,
           'avg_obj': 0.44959393,
           'box_loss': 1.3296069,
           'class_loss': 2.2698786,
           'conf_loss': 3.777943,
           'precision50': 0.4229415,
           'recall50': 0.4544306},
     'global': {'total_loss': 30.743013},
     'learning_rate': 0.00131,
     'training_loss': 30.743013}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-230000.
train | step:  240000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.64461654,
           'avg_obj': 0.16116248,
           'box_loss': 2.5425284,
           'class_loss': 2.8413913,
           'conf_loss': 5.7218056,
           'precision50': 0.13488027,
           'recall50': 0.061508056},
     '4': {'avg_iou': 0.74781126,
           'avg_obj': 0.29800963,
           'box_loss': 2.4113307,
           'class_loss': 3.2578135,
           'conf_loss': 6.5526686,
           'precision50': 0.2729917,
           'recall50': 0.21327381},
     '5': {'avg_iou': 0.81048024,
           'avg_obj': 0.45192274,
           'box_loss': 1.3219566,
           'class_loss': 2.249616,
           'conf_loss': 3.7542875,
           'precision50': 0.42338043,
           'recall50': 0.4570675},
     'global': {'total_loss': 30.653412},
     'learning_rate': 0.00131,
     'training_loss': 30.653412}
 eval | step:  240000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=178.95s).
Accumulating evaluation results...
DONE (t=15.92s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.283
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.494
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.288
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.099
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.288
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.417
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.257
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.423
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.464
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.244
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.492
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.614
 eval | step:  240000 | eval time:  509.7 sec | output: 
    {'3': {'avg_iou': 0.47282833,
           'avg_obj': 0.16032778,
           'box_loss': 2.976576,
           'class_loss': 2.416236,
           'conf_loss': 6.933214,
           'precision50': 0.22314702,
           'recall50': 0.13327393},
     '4': {'avg_iou': 0.68255115,
           'avg_obj': 0.36648807,
           'box_loss': 2.3404953,
           'class_loss': 2.1183105,
           'conf_loss': 5.8120804,
           'precision50': 0.36110455,
           'recall50': 0.36064827},
     '5': {'avg_iou': 0.75752634,
           'avg_obj': 0.5410287,
           'box_loss': 1.1756086,
           'class_loss': 1.1431433,
           'conf_loss': 2.7129602,
           'precision50': 0.43994808,
           'recall50': 0.5541876},
     'AP': 0.28255287,
     'AP50': 0.49439016,
     'AP75': 0.28814864,
     'APl': 0.41661665,
     'APm': 0.28824824,
     'APs': 0.09872557,
     'ARl': 0.61429155,
     'ARm': 0.49164677,
     'ARmax1': 0.25685552,
     'ARmax10': 0.42251936,
     'ARmax100': 0.46372917,
     'ARs': 0.24421543,
     'global': {'total_loss': 27.628632},
     'validation_loss': 27.628632}
train | step:  240000 | training until step 260000...
train | step:  250000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6526317,
           'avg_obj': 0.1735161,
           'box_loss': 2.475393,
           'class_loss': 2.6662486,
           'conf_loss': 5.6098557,
           'precision50': 0.14338909,
           'recall50': 0.06936235},
     '4': {'avg_iou': 0.75666183,
           'avg_obj': 0.31568685,
           'box_loss': 2.3239806,
           'class_loss': 3.014953,
           'conf_loss': 6.367949,
           'precision50': 0.28087187,
           'recall50': 0.23041247},
     '5': {'avg_iou': 0.819268,
           'avg_obj': 0.47496352,
           'box_loss': 1.2585448,
           'class_loss': 2.041122,
           'conf_loss': 3.5872848,
           'precision50': 0.4261194,
           'recall50': 0.4813897},
     'global': {'total_loss': 29.345345},
     'learning_rate': 0.000131,
     'training_loss': 29.345345}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-250000.
train | step:  260000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.65464413,
           'avg_obj': 0.17713997,
           'box_loss': 2.466812,
           'class_loss': 2.637266,
           'conf_loss': 5.5934315,
           'precision50': 0.14557922,
           'recall50': 0.07162319},
     '4': {'avg_iou': 0.75829095,
           'avg_obj': 0.32088774,
           'box_loss': 2.3102093,
           'class_loss': 2.9600208,
           'conf_loss': 6.3259163,
           'precision50': 0.28221685,
           'recall50': 0.23482549},
     '5': {'avg_iou': 0.82125056,
           'avg_obj': 0.4806232,
           'box_loss': 1.2450265,
           'class_loss': 1.9976139,
           'conf_loss': 3.5506535,
           'precision50': 0.42718676,
           'recall50': 0.48712504},
     'global': {'total_loss': 29.086979},
     'learning_rate': 0.000131,
     'training_loss': 29.086979}
 eval | step:  260000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=177.72s).
Accumulating evaluation results...
DONE (t=14.88s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.315
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.534
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.329
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.123
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.320
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.455
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.273
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.448
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.283
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.521
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.638
 eval | step:  260000 | eval time:  501.9 sec | output: 
    {'3': {'avg_iou': 0.48208472,
           'avg_obj': 0.1706164,
           'box_loss': 2.8596153,
           'class_loss': 2.112415,
           'conf_loss': 6.7116523,
           'precision50': 0.24067251,
           'recall50': 0.1467705},
     '4': {'avg_iou': 0.69622755,
           'avg_obj': 0.38723,
           'box_loss': 2.2061431,
           'class_loss': 1.7946802,
           'conf_loss': 5.51237,
           'precision50': 0.37088406,
           'recall50': 0.38104844},
     '5': {'avg_iou': 0.7708166,
           'avg_obj': 0.57739,
           'box_loss': 1.0979857,
           'class_loss': 0.9566595,
           'conf_loss': 2.5402749,
           'precision50': 0.44543236,
           'recall50': 0.5896873},
     'AP': 0.31533703,
     'AP50': 0.5335593,
     'AP75': 0.32861423,
     'APl': 0.4548618,
     'APm': 0.31967232,
     'APs': 0.12268495,
     'ARl': 0.637697,
     'ARm': 0.5205609,
     'ARmax1': 0.27337074,
     'ARmax10': 0.44806728,
     'ARmax100': 0.49147794,
     'ARs': 0.28297046,
     'global': {'total_loss': 25.791798},
     'validation_loss': 25.791798}I0421 03:17:10.811429 139894318675776 controller.py:211] train | step:  260000 | training until step 280000...
I0421 04:08:09.998124 139894318675776 controller.py:425] train | step:  270000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6552371,
           'avg_obj': 0.17908621,
           'box_loss': 2.4541485,
           'class_loss': 2.6079907,
           'conf_loss': 5.56063,
           'precision50': 0.14661202,
           'recall50': 0.07243406},
     '4': {'avg_iou': 0.75974786,
           'avg_obj': 0.32330224,
           'box_loss': 2.2890966,
           'class_loss': 2.920342,
           'conf_loss': 6.2856717,
           'precision50': 0.2823838,
           'recall50': 0.23684807},
     '5': {'avg_iou': 0.8224697,
           'avg_obj': 0.48357674,
           'box_loss': 1.2368587,
           'class_loss': 1.9725266,
           'conf_loss': 3.529653,
           'precision50': 0.42676303,
           'recall50': 0.49065375},
     'global': {'total_loss': 28.856947},
     'learning_rate': 1.31e-05,
     'training_loss': 28.856947}
I0421 04:08:59.010977 139894318675776 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-270000.
I0421 05:07:54.086463 139894318675776 controller.py:425] train | step:  280000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6555521,
           'avg_obj': 0.17916778,
           'box_loss': 2.4495642,
           'class_loss': 2.6011941,
           'conf_loss': 5.5542893,
           'precision50': 0.14640832,
           'recall50': 0.0730462},
     '4': {'avg_iou': 0.75974584,
           'avg_obj': 0.32338855,
           'box_loss': 2.3014283,
           'class_loss': 2.935137,
           'conf_loss': 6.3164625,
           'precision50': 0.28320366,
           'recall50': 0.23758425},
     '5': {'avg_iou': 0.8224667,
           'avg_obj': 0.48399946,
           'box_loss': 1.2414558,
           'class_loss': 1.9768254,
           'conf_loss': 3.5401785,
           'precision50': 0.4278046,
           'recall50': 0.49136826},
     'global': {'total_loss': 28.91647},
     'learning_rate': 1.31e-05,
     'training_loss': 28.91647}
I0421 05:08:11.635079 139894318675776 controller.py:252]  eval | step:  280000 | running 625 steps of evaluation...
I0421 05:12:29.278297 139894318675776 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0421 05:17:00.607074 139894318675776 controller.py:261]  eval | step:  280000 | eval time:  529.0 sec | output: 
    {'3': {'avg_iou': 0.48214003,
           'avg_obj': 0.17662857,
           'box_loss': 2.8591585,
           'class_loss': 2.0992694,
           'conf_loss': 6.695594,
           'precision50': 0.23955362,
           'recall50': 0.15278156},
     '4': {'avg_iou': 0.6960225,
           'avg_obj': 0.39358273,
           'box_loss': 2.209331,
           'class_loss': 1.7800127,
           'conf_loss': 5.499263,
           'precision50': 0.37165582,
           'recall50': 0.38756567},
     '5': {'avg_iou': 0.77178454,
           'avg_obj': 0.58281016,
           'box_loss': 1.0932413,
           'class_loss': 0.94254667,
           'conf_loss': 2.5407705,
           'precision50': 0.4433334,
           'recall50': 0.59614754},
     'AP': 0.31682843,
     'AP50': 0.53598034,
     'AP75': 0.32979754,
     'APl': 0.45681912,
     'APm': 0.32184535,
     'APs': 0.122223124,
     'ARl': 0.64180624,
     'ARm': 0.5188565,
     'ARmax1': 0.27411497,
     'ARmax10': 0.44981837,
     'ARmax100': 0.4923551,
     'ARs': 0.27964008,
     'global': {'total_loss': 25.71919},
     'validation_loss': 25.71919}
I0421 05:17:17.490076 139894318675776 controller.py:211] train | step:  280000 | training until step 300000...
I0421 06:08:27.268528 139894318675776 controller.py:425] train | step:  290000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6560596,
           'avg_obj': 0.17928317,
           'box_loss': 2.442111,
           'class_loss': 2.5931232,
           'conf_loss': 5.545325,
           'precision50': 0.14637513,
           'recall50': 0.07255641},
     '4': {'avg_iou': 0.7599791,
           'avg_obj': 0.32352775,
           'box_loss': 2.2928429,
           'class_loss': 2.9291503,
           'conf_loss': 6.298476,
           'precision50': 0.28251266,
           'recall50': 0.23716651},
     '5': {'avg_iou': 0.82273847,
           'avg_obj': 0.48422816,
           'box_loss': 1.2375914,
           'class_loss': 1.9720563,
           'conf_loss': 3.533211,
           'precision50': 0.42635205,
           'recall50': 0.49095455},
     'global': {'total_loss': 28.843893},
     'learning_rate': 1.31e-05,
     'training_loss': 28.843893}
I0421 06:09:16.452484 139894318675776 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-290000.
I0421 07:07:11.655650 139894318675776 controller.py:425] train | step:  300000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6555816,
           'avg_obj': 0.17992768,
           'box_loss': 2.45966,
           'class_loss': 2.6091557,
           'conf_loss': 5.576111,
           'precision50': 0.14714095,
           'recall50': 0.07311073},
     '4': {'avg_iou': 0.76012886,
           'avg_obj': 0.32405663,
           'box_loss': 2.2972105,
           'class_loss': 2.927266,
           'conf_loss': 6.307046,
           'precision50': 0.28339177,
           'recall50': 0.2378662},
     '5': {'avg_iou': 0.82276183,
           'avg_obj': 0.4851104,
           'box_loss': 1.2385066,
           'class_loss': 1.9692861,
           'conf_loss': 3.5312757,
           'precision50': 0.42788407,
           'recall50': 0.49240234},
     'global': {'total_loss': 28.915453},
     'learning_rate': 1.31e-05,
     'training_loss': 28.915453}
I0421 07:07:24.532369 139894318675776 controller.py:252]  eval | step:  300000 | running 625 steps of evaluation...
I0421 07:11:44.573017 139894318675776 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0421 07:15:55.281377 139894318675776 controller.py:261]  eval | step:  300000 | eval time:  510.7 sec | output: 
    {'3': {'avg_iou': 0.48233524,
           'avg_obj': 0.17845413,
           'box_loss': 2.8559191,
           'class_loss': 2.0944965,
           'conf_loss': 6.6942115,
           'precision50': 0.24071932,
           'recall50': 0.15496662},
     '4': {'avg_iou': 0.6965184,
           'avg_obj': 0.39439428,
           'box_loss': 2.2033963,
           'class_loss': 1.7744223,
           'conf_loss': 5.495585,
           'precision50': 0.37137765,
           'recall50': 0.38827386},
     '5': {'avg_iou': 0.77160984,
           'avg_obj': 0.58224833,
           'box_loss': 1.0935887,
           'class_loss': 0.94190586,
           'conf_loss': 2.54092,
           'precision50': 0.44372076,
           'recall50': 0.59519285},
     'AP': 0.3169813,
     'AP50': 0.53694546,
     'AP75': 0.330506,
     'APl': 0.4564367,
     'APm': 0.3233222,
     'APs': 0.1234078,
     'ARl': 0.6418311,
     'ARm': 0.51947546,
     'ARmax1': 0.27466866,
     'ARmax10': 0.45071018,
     'ARmax100': 0.49321848,
     'ARs': 0.28267515,
     'global': {'total_loss': 25.694452},
     'validation_loss': 25.694452}

train | step:  260000 | training until step 280000...
train | step:  270000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6552371,
           'avg_obj': 0.17908621,
           'box_loss': 2.4541485,
           'class_loss': 2.6079907,
           'conf_loss': 5.56063,
           'precision50': 0.14661202,
           'recall50': 0.07243406},
     '4': {'avg_iou': 0.75974786,
           'avg_obj': 0.32330224,
           'box_loss': 2.2890966,
           'class_loss': 2.920342,
           'conf_loss': 6.2856717,
           'precision50': 0.2823838,
           'recall50': 0.23684807},
     '5': {'avg_iou': 0.8224697,
           'avg_obj': 0.48357674,
           'box_loss': 1.2368587,
           'class_loss': 1.9725266,
           'conf_loss': 3.529653,
           'precision50': 0.42676303,
           'recall50': 0.49065375},
     'global': {'total_loss': 28.856947},
     'learning_rate': 1.31e-05,
     'training_loss': 28.856947}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-270000.
train | step:  280000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6555521,
           'avg_obj': 0.17916778,
           'box_loss': 2.4495642,
           'class_loss': 2.6011941,
           'conf_loss': 5.5542893,
           'precision50': 0.14640832,
           'recall50': 0.0730462},
     '4': {'avg_iou': 0.75974584,
           'avg_obj': 0.32338855,
           'box_loss': 2.3014283,
           'class_loss': 2.935137,
           'conf_loss': 6.3164625,
           'precision50': 0.28320366,
           'recall50': 0.23758425},
     '5': {'avg_iou': 0.8224667,
           'avg_obj': 0.48399946,
           'box_loss': 1.2414558,
           'class_loss': 1.9768254,
           'conf_loss': 3.5401785,
           'precision50': 0.4278046,
           'recall50': 0.49136826},
     'global': {'total_loss': 28.91647},
     'learning_rate': 1.31e-05,
     'training_loss': 28.91647}
 eval | step:  280000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=191.42s).
Accumulating evaluation results...
DONE (t=15.94s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.317
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.536
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.330
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.122
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.322
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.457
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.274
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.450
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.492
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.280
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.519
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.642
 eval | step:  280000 | eval time:  529.0 sec | output: 
    {'3': {'avg_iou': 0.48214003,
           'avg_obj': 0.17662857,
           'box_loss': 2.8591585,
           'class_loss': 2.0992694,
           'conf_loss': 6.695594,
           'precision50': 0.23955362,
           'recall50': 0.15278156},
     '4': {'avg_iou': 0.6960225,
           'avg_obj': 0.39358273,
           'box_loss': 2.209331,
           'class_loss': 1.7800127,
           'conf_loss': 5.499263,
           'precision50': 0.37165582,
           'recall50': 0.38756567},
     '5': {'avg_iou': 0.77178454,
           'avg_obj': 0.58281016,
           'box_loss': 1.0932413,
           'class_loss': 0.94254667,
           'conf_loss': 2.5407705,
           'precision50': 0.4433334,
           'recall50': 0.59614754},
     'AP': 0.31682843,
     'AP50': 0.53598034,
     'AP75': 0.32979754,
     'APl': 0.45681912,
     'APm': 0.32184535,
     'APs': 0.122223124,
     'ARl': 0.64180624,
     'ARm': 0.5188565,
     'ARmax1': 0.27411497,
     'ARmax10': 0.44981837,
     'ARmax100': 0.4923551,
     'ARs': 0.27964008,
     'global': {'total_loss': 25.71919},
     'validation_loss': 25.71919}
train | step:  280000 | training until step 300000...
train | step:  290000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6560596,
           'avg_obj': 0.17928317,
           'box_loss': 2.442111,
           'class_loss': 2.5931232,
           'conf_loss': 5.545325,
           'precision50': 0.14637513,
           'recall50': 0.07255641},
     '4': {'avg_iou': 0.7599791,
           'avg_obj': 0.32352775,
           'box_loss': 2.2928429,
           'class_loss': 2.9291503,
           'conf_loss': 6.298476,
           'precision50': 0.28251266,
           'recall50': 0.23716651},
     '5': {'avg_iou': 0.82273847,
           'avg_obj': 0.48422816,
           'box_loss': 1.2375914,
           'class_loss': 1.9720563,
           'conf_loss': 3.533211,
           'precision50': 0.42635205,
           'recall50': 0.49095455},
     'global': {'total_loss': 28.843893},
     'learning_rate': 1.31e-05,
     'training_loss': 28.843893}
saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-290000.
train | step:  300000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.6555816,
           'avg_obj': 0.17992768,
           'box_loss': 2.45966,
           'class_loss': 2.6091557,
           'conf_loss': 5.576111,
           'precision50': 0.14714095,
           'recall50': 0.07311073},
     '4': {'avg_iou': 0.76012886,
           'avg_obj': 0.32405663,
           'box_loss': 2.2972105,
           'class_loss': 2.927266,
           'conf_loss': 6.307046,
           'precision50': 0.28339177,
           'recall50': 0.2378662},
     '5': {'avg_iou': 0.82276183,
           'avg_obj': 0.4851104,
           'box_loss': 1.2385066,
           'class_loss': 1.9692861,
           'conf_loss': 3.5312757,
           'precision50': 0.42788407,
           'recall50': 0.49240234},
     'global': {'total_loss': 28.915453},
     'learning_rate': 1.31e-05,
     'training_loss': 28.915453}
 eval | step:  300000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=182.46s).
Accumulating evaluation results...
DONE (t=15.41s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.317
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.537
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.331
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.123
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.323
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.456
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.275
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.451
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.493
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.283
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.519
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.642
 eval | step:  300000 | eval time:  510.7 sec | output: 
    {'3': {'avg_iou': 0.48233524,
           'avg_obj': 0.17845413,
           'box_loss': 2.8559191,
           'class_loss': 2.0944965,
           'conf_loss': 6.6942115,
           'precision50': 0.24071932,
           'recall50': 0.15496662},
     '4': {'avg_iou': 0.6965184,
           'avg_obj': 0.39439428,
           'box_loss': 2.2033963,
           'class_loss': 1.7744223,
           'conf_loss': 5.495585,
           'precision50': 0.37137765,
           'recall50': 0.38827386},
     '5': {'avg_iou': 0.77160984,
           'avg_obj': 0.58224833,
           'box_loss': 1.0935887,
           'class_loss': 0.94190586,
           'conf_loss': 2.54092,
           'precision50': 0.44372076,
           'recall50': 0.59519285},
     'AP': 0.3169813,
     'AP50': 0.53694546,
     'AP75': 0.330506,
     'APl': 0.4564367,
     'APm': 0.3233222,
     'APs': 0.1234078,
     'ARl': 0.6418311,
     'ARm': 0.51947546,
     'ARmax1': 0.27466866,
     'ARmax10': 0.45071018,
     'ARmax100': 0.49321848,
     'ARs': 0.28267515,
     'global': {'total_loss': 25.694452},
     'validation_loss': 25.694452}I0421 07:16:50.167366 139894318675776 controller.py:455] saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-300000.
I0421 07:16:50.182659 139894318675776 train_lib.py:123] Number of trainable params in model: 64.488640 Millions.

saved checkpoint to gs://tensorflow2/config_tests/250k-512-aggressive-adam/ckpt-300000.
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   223    0     2  100   221     11   1300 --:--:-- --:--:-- --:--:--  1304100   223    0     2  100   221     11   1300 --:--:-- --:--:-- --:--:--  1304
okRequest issued for: [node-3]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-21T07:19:18.657495952Z'
  endTime: '2021-04-21T07:20:14.613837299Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618989558635-5c07661899cc7-9efa4522-f0c56649
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618989558635-5c07661899cc7-9efa4522-f0c56649] to complete...
.............................................................................................................................................................................................................................................................................................................................................................................................done.
