cat: .experiment_zone: No such file or directory
Request issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-03-29T23:57:29.686551085Z'
  endTime: '2021-03-29T23:58:06.938961049Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617062249674-5beb5a4f8b5c9-a2376e27-250981eb
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617062249674-5beb5a4f8b5c9-a2376e27-250981eb] to complete...
..................................................................................................................................................................................................done.
europe-west4-a
I0329 23:58:11.352908 140627772032832 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.2,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': True,
                                                     '4': True,
                                                     '5': True},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': False,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 80,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'bfloat16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': None,
                         'is_training': True,
                         'parser': {'aug_rand_angle': 7.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_transalate': 0.0,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_boxes': 0.2,
                                    'jitter_im': 0.3,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'max_process_size': 608,
                                    'min_process_size': 320,
                                    'mosaic': {'crop_area': [0.3, 0.35],
                                               'mosaic_frequency': 0.7,
                                               'output_size': [640, 640],
                                               'random_crop': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': 'gs://tensorflow2/tensorflow_datasets',
                         'tfds_download': True,
                         'tfds_name': 'coco',
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': 'train'},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'bfloat16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 64,
                              'input_path': None,
                              'is_training': False,
                              'parser': {'aug_rand_angle': 15.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_transalate': 0.0,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_boxes': 0.3,
                                         'jitter_im': 0.3,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'max_process_size': 608,
                                         'min_process_size': 320,
                                         'mosaic': {'crop_area': [0.3, 0.35],
                                                    'mosaic_frequency': 0.75,
                                                    'output_size': [640, 640],
                                                    'random_crop': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 2,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': 'gs://tensorflow2/tensorflow_datasets',
                              'tfds_download': True,
                              'tfds_name': 'coco',
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': 'validation'},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 5000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': None,
                                  'learning_rate': {'stepwise': {'boundaries': [40000,
                                                                                45000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.001,
                                                                            0.0001,
                                                                            1e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'adam': {'amsgrad': False,
                                                         'beta_1': 0.949,
                                                         'beta_2': 0.999,
                                                         'clipnorm': None,
                                                         'clipvalue': None,
                                                         'epsilon': 1e-07,
                                                         'global_clipnorm': None,
                                                         'name': 'adam'},
                                                'type': 'adam'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 50000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 5000,
             'validation_steps': 78}}
I0329 23:58:11.353907 140627772032832 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/debug-data-pipeline/yolov4-coco-all-50k-adam-aspect_t/params.yaml
I0329 23:58:12.869913 140627772032832 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0329 23:58:13.488666 140627772032832 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0329 23:58:13.488987 140627772032832 transport.py:157] Attempting refresh to obtain initial access_token
I0329 23:58:13.558153 140627772032832 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0329 23:58:13.699138 140627772032832 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0329 23:58:13.699645 140627772032832 transport.py:157] Attempting refresh to obtain initial access_token
2021-03-29 23:58:13.753587: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0329 23:58:13.754395 140627772032832 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0329 23:58:13.897840 140627772032832 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0329 23:58:13.898141 140627772032832 transport.py:157] Attempting refresh to obtain initial access_token
I0329 23:58:13.945375 140627772032832 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0329 23:58:14.087042 140627772032832 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0329 23:58:14.087557 140627772032832 transport.py:157] Attempting refresh to obtain initial access_token
2021-03-29 23:58:14.135918: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-03-29 23:58:14.148728: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-03-29 23:58:14.148799: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:39249}
2021-03-29 23:58:55.687114: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-03-29 23:58:55.687217: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:39249}
2021-03-29 23:58:55.687824: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:39249
I0329 23:58:55.688836 140627772032832 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-6
I0329 23:58:55.689969 140627772032832 tpu_strategy_util.py:74] Initializing the TPU system: node-6
INFO:tensorflow:Clearing out eager caches
I0329 23:59:03.887720 140627772032832 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0329 23:59:03.889753 140627772032832 tpu_strategy_util.py:133] Finished initializing TPU system.
I0329 23:59:03.891266 140627772032832 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0329 23:59:04.040955 140627772032832 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0329 23:59:04.041364 140627772032832 transport.py:157] Attempting refresh to obtain initial access_token
I0329 23:59:04.096954 140627772032832 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0329 23:59:04.243580 140627772032832 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0329 23:59:04.243987 140627772032832 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0329 23:59:04.298866 140627772032832 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0329 23:59:04.299180 140627772032832 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0329 23:59:04.299568 140627772032832 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0329 23:59:04.299667 140627772032832 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0329 23:59:04.299753 140627772032832 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0329 23:59:04.300000 140627772032832 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0329 23:59:04.300111 140627772032832 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0329 23:59:04.300192 140627772032832 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0329 23:59:04.300279 140627772032832 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0329 23:59:04.300359 140627772032832 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0329 23:59:04.300437 140627772032832 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0329 23:59:04.300512 140627772032832 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0329 23:59:04.300865 140627772032832 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0329 23:59:04.300998 140627772032832 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0329 23:59:04.301138 140627772032832 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0329 23:59:04.301245 140627772032832 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0329 23:59:04.339032 140627772032832 train_utils.py:214] Running default trainer.
2021-03-29 23:59:04.349900: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 80, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': True, '4': True, '5': True}, 'use_nms': False, 'iou_thresh': 0.2, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': None, 'tfds_name': 'coco', 'tfds_split': 'train', 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': 'gs://tensorflow2/tensorflow_datasets', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'bfloat16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 320, 'max_process_size': 608, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'jitter_boxes': 0.2, 'aug_rand_transalate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_zoom': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.7, 'crop_area': [0.3, 0.35], 'random_crop': False}}}, 'validation_data': {'input_path': None, 'tfds_name': 'coco', 'tfds_split': 'validation', 'global_batch_size': 64, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 2, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': 'gs://tensorflow2/tensorflow_datasets', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'bfloat16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 320, 'max_process_size': 608, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'jitter_boxes': 0.3, 'aug_rand_transalate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_zoom': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_angle': 15.0, 'use_tie_breaker': True, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.75, 'crop_area': [0.3, 0.35], 'random_crop': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'adam', 'adam': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'adam', 'beta_1': 0.949, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}}, 'ema': None, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [40000, 45000], 'values': [0.001, 0.0001, 1e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 5000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 50000, 'validation_steps': 78, 'validation_interval': 5000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
{'3': 1.2, '4': 1.1, '5': 1.05} 0.00025
{'num_classes': 80, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': True, '4': True, '5': True}, 'use_nms': False, 'iou_thresh': 0.2, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7fe61019aa58>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________/home/cam2tensorflow/.experiment_start.sh: line 22:  9249 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4-$5
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   230    0     2  100   228     12   1452 --:--:-- --:--:-- --:--:--  1455100   230    0     2  100   228     12   1452 --:--:-- --:--:-- --:--:--  1455
okRequest issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-03-30T01:06:19.631073686Z'
  endTime: '2021-03-30T01:06:30.754443336Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617066379618-5beb69b22aa16-a2428b21-6c79c824
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617066379618-5beb69b22aa16-a2428b21-6c79c824] to complete...
...............................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-5]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-03-30T01:08:41.388284417Z'
  endTime: '2021-03-30T01:09:16.548985034Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617066521375-5beb6a395b4a8-73edd4b3-6dbc1581
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617066521375-5beb6a395b4a8-73edd4b3-6dbc1581] to complete...
..................................................................................................................................................................................................done.
europe-west4-a
I0330 01:09:24.577265 139643354593088 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.2,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': True,
                                                     '4': True,
                                                     '5': True},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': False,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 80,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'bfloat16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': None,
                         'is_training': True,
                         'parser': {'aug_rand_angle': 7.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_transalate': 0.0,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_boxes': 0.2,
                                    'jitter_im': 0.3,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'max_process_size': 608,
                                    'min_process_size': 320,
                                    'mosaic': {'crop_area': [0.3, 0.35],
                                               'mosaic_frequency': 0.7,
                                               'output_size': [640, 640],
                                               'random_crop': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': 'gs://tensorflow2/tensorflow_datasets',
                         'tfds_download': True,
                         'tfds_name': 'coco',
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': 'train'},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'bfloat16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 64,
                              'input_path': None,
                              'is_training': False,
                              'parser': {'aug_rand_angle': 15.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_transalate': 0.0,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_boxes': 0.3,
                                         'jitter_im': 0.3,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'max_process_size': 608,
                                         'min_process_size': 320,
                                         'mosaic': {'crop_area': [0.3, 0.35],
                                                    'mosaic_frequency': 0.75,
                                                    'output_size': [640, 640],
                                                    'random_crop': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 2,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': 'gs://tensorflow2/tensorflow_datasets',
                              'tfds_download': True,
                              'tfds_name': 'coco',
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': 'validation'},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 5000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': None,
                                  'learning_rate': {'stepwise': {'boundaries': [40000,
                                                                                45000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.001,
                                                                            0.0001,
                                                                            1e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'adam': {'amsgrad': False,
                                                         'beta_1': 0.949,
                                                         'beta_2': 0.999,
                                                         'clipnorm': None,
                                                         'clipvalue': None,
                                                         'epsilon': 1e-07,
                                                         'global_clipnorm': None,
                                                         'name': 'adam'},
                                                'type': 'adam'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 50000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 5000,
             'validation_steps': 78}}
I0330 01:09:24.580144 139643354593088 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/debug-data-pipeline/yolov4-coco-all-50k-adam-aspect_t/params.yaml
I0330 01:09:25.364467 139643354593088 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0330 01:09:26.048267 139643354593088 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0330 01:09:26.048545 139643354593088 transport.py:157] Attempting refresh to obtain initial access_token
I0330 01:09:26.110606 139643354593088 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0330 01:09:26.254941 139643354593088 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0330 01:09:26.255208 139643354593088 transport.py:157] Attempting refresh to obtain initial access_token
2021-03-30 01:09:26.299189: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0330 01:09:26.299995 139643354593088 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0330 01:09:26.918160 139643354593088 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0330 01:09:26.918667 139643354593088 transport.py:157] Attempting refresh to obtain initial access_token
I0330 01:09:26.976435 139643354593088 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0330 01:09:27.126383 139643354593088 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0330 01:09:27.126747 139643354593088 transport.py:157] Attempting refresh to obtain initial access_token
2021-03-30 01:09:27.180696: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-03-30 01:09:27.213008: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.56.217.90:8470}
2021-03-30 01:09:27.213110: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:40334}
2021-03-30 01:10:08.847825: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.56.217.90:8470}
2021-03-30 01:10:08.847906: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:40334}
2021-03-30 01:10:08.848710: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:40334
I0330 01:10:08.850101 139643354593088 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-5
I0330 01:10:08.851061 139643354593088 tpu_strategy_util.py:74] Initializing the TPU system: node-5
INFO:tensorflow:Clearing out eager caches
I0330 01:10:16.849148 139643354593088 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0330 01:10:16.851550 139643354593088 tpu_strategy_util.py:133] Finished initializing TPU system.
I0330 01:10:16.853143 139643354593088 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0330 01:10:16.998993 139643354593088 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0330 01:10:16.999238 139643354593088 transport.py:157] Attempting refresh to obtain initial access_token
I0330 01:10:17.060189 139643354593088 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0330 01:10:17.678613 139643354593088 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0330 01:10:17.678991 139643354593088 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0330 01:10:17.740976 139643354593088 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0330 01:10:17.741259 139643354593088 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0330 01:10:17.741678 139643354593088 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0330 01:10:17.741767 139643354593088 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0330 01:10:17.741848 139643354593088 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0330 01:10:17.742139 139643354593088 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0330 01:10:17.742225 139643354593088 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0330 01:10:17.742307 139643354593088 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0330 01:10:17.742383 139643354593088 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0330 01:10:17.742458 139643354593088 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0330 01:10:17.742534 139643354593088 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0330 01:10:17.742612 139643354593088 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0330 01:10:17.742686 139643354593088 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0330 01:10:17.742762 139643354593088 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0330 01:10:17.742837 139643354593088 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0330 01:10:17.742912 139643354593088 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0330 01:10:17.777106 139643354593088 train_utils.py:214] Running default trainer.
2021-03-30 01:10:17.788315: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 80, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': True, '4': True, '5': True}, 'use_nms': False, 'iou_thresh': 0.2, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': None, 'tfds_name': 'coco', 'tfds_split': 'train', 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': 'gs://tensorflow2/tensorflow_datasets', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'bfloat16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 320, 'max_process_size': 608, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'jitter_boxes': 0.2, 'aug_rand_transalate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_zoom': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.7, 'crop_area': [0.3, 0.35], 'random_crop': False}}}, 'validation_data': {'input_path': None, 'tfds_name': 'coco', 'tfds_split': 'validation', 'global_batch_size': 64, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 2, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': 'gs://tensorflow2/tensorflow_datasets', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'bfloat16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 320, 'max_process_size': 608, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'jitter_boxes': 0.3, 'aug_rand_transalate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_zoom': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_angle': 15.0, 'use_tie_breaker': True, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.75, 'crop_area': [0.3, 0.35], 'random_crop': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'adam', 'adam': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'adam', 'beta_1': 0.949, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}}, 'ema': None, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [40000, 45000], 'values': [0.001, 0.0001, 1e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 5000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 50000, 'validation_steps': 78, 'validation_interval': 5000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
{'3': 1.2, '4': 1.1, '5': 1.05} 0.00025
{'num_classes': 80, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': True, '4': True, '5': True}, 'use_nms': False, 'iou_thresh': 0.2, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f00dc3dea20>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________I0330 01:10:42.981940 139643354593088 dataset_builder.py:811] No config specified, defaulting to first: coco/2014
I0330 01:10:43.719192 139643354593088 dataset_info.py:361] Load dataset info from gs://tensorflow2/tensorflow_datasets/coco/2014/1.1.0
I0330 01:10:44.759249 139643354593088 dataset_builder.py:299] Reusing dataset coco (gs://tensorflow2/tensorflow_datasets/coco/2014/1.1.0)
I0330 01:10:44.759589 139643354593088 dataset_builder.py:511] Constructing tf.data.Dataset for split train, from gs://tensorflow2/tensorflow_datasets/coco/2014/1.1.0

DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
conv1 512.0
conv2 1024.0
conv1 512.0
spp
conv1 512.0
conv2 1024.0
conv1 512.0
7
conv1 512.0
conv2 256.0
conv1 512.0
conv2 256.0
4








 ListWrapper([256, 512, 1024])
conv1 128
conv2 256
conv1 128
conv2 256
conv1 128
conv2 256
6
conv1 256
conv2 512
conv1 256
conv2 512
conv1 256
conv2 512
6
conv1 512
conv2 1024
conv1 512
conv2 1024
conv1 512
conv2 1024
6
detget {'3': 1.2, '4': 1.1, '5': 1.05}
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 37319168  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  457725    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 64,429,405
Trainable params: 64,363,101
Non-trainable params: 66,304
_________________________________________________________________
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 600, 8), 5: (8, 600, 8)}, inds: {3: (8, 600, 3), 4: (8, 600, 3), 5: (8, 600, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.bfloat16, {source_id: tf.int64, bbox: tf.bfloat16, classes: tf.bfloat16, area: tf.bfloat16, is_crowd: tf.int32, best_anchors: tf.bfloat16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.bfloat16, 4: tf.bfloat16, 5: tf.bfloat16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.bfloat16, 4: tf.bfloat16, 5: tf.bfloat16}})>I0330 01:11:00.133959 139643354593088 dataset_builder.py:811] No config specified, defaulting to first: coco/2014
I0330 01:11:00.860610 139643354593088 dataset_info.py:361] Load dataset info from gs://tensorflow2/tensorflow_datasets/coco/2014/1.1.0
I0330 01:11:01.810130 139643354593088 dataset_builder.py:299] Reusing dataset coco (gs://tensorflow2/tensorflow_datasets/coco/2014/1.1.0)
I0330 01:11:01.810383 139643354593088 dataset_builder.py:511] Constructing tf.data.Dataset for split validation, from gs://tensorflow2/tensorflow_datasets/coco/2014/1.1.0
I0330 01:11:08.039078 139643354593088 controller.py:362] restoring or initializing model...
I0330 01:11:17.099232 139643354593088 yolo.py:484] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0330 01:11:17.101474 139643354593088 controller.py:368] initialized model.
I0330 01:11:17.101744 139643354593088 train_lib.py:96] Starts to execute mode: train_and_eval
I0330 01:11:17.107557 139643354593088 controller.py:211] train | step:      0 | training until step 5000...
I0330 01:11:24.673004 139643354593088 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0330 01:12:39.703973 139643354593088 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0330 01:53:18.566435 139643354593088 controller.py:425] train | step:   5000 | steps/sec:    2.0 | output: 
    {'avg_iou_3': 0.5060156,
     'avg_iou_4': 0.56837565,
     'avg_iou_5': 0.4663593,
     'avg_obj_3': 0.14818546,
     'avg_obj_4': 0.23287302,
     'avg_obj_5': 0.32633373,
     'box_loss_3': 0.27072665,
     'box_loss_4': 0.2363152,
     'box_loss_5': 0.31780827,
     'class_loss_3': 0.8513471,
     'class_loss_4': 0.7204083,
     'class_loss_5': 0.7095209,
     'conf_loss_3': 0.7246705,
     'conf_loss_4': 0.67526186,
     'conf_loss_5': 0.9295024,
     'learning_rate': 0.001,
     'recall50_3': 0.08681292,
     'recall50_4': 0.16517481,
     'recall50_5': 0.2748678,
     'total_loss': 5.4355655,
     'training_loss': 5.4355655}
I0330 01:54:16.443229 139643354593088 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-pipeline/yolov4-coco-all-50k-adam-aspect_t/ckpt-5000.
I0330 01:54:16.448949 139643354593088 controller.py:252]  eval | step:   5000 | running 78 steps of evaluation...
I0330 01:54:22.083185 139643354593088 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0330 01:58:40.095416 139643354593088 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0330 02:00:58.116658 139643354593088 controller.py:261]  eval | step:   5000 | eval time:  401.7 sec | output: 
    {'AP': 0.06904081,
     'AP50': 0.17336936,
     'AP75': 0.037794363,
     'APl': 0.11034123,
     'APm': 0.07321351,
     'APs': 0.012458069,
     'ARl': 0.16102715,
     'ARm': 0.14348832,
     'ARmax1': 0.08361497,
     'ARmax10': 0.12605557,
     'ARmax100': 0.13258034,
     'ARs': 0.039642867,
     'avg_iou_3': 0.59189725,
     'avg_iou_4': 0.64102215,
     'avg_iou_5': 0.54504645,
     'avg_obj_3': 0.18783641,
     'avg_obj_4': 0.29937539,
     'avg_obj_5': 0.43215308,
     'box_loss_3': 0.21923275,
     'box_loss_4': 0.18571262,
     'box_loss_5': 0.2640899,
     'class_loss_3': 0.21493359,
     'class_loss_4': 0.17960161,
     'class_loss_5': 0.20991813,
     'conf_loss_3': 0.11044117,
     'conf_loss_4': 0.18194981,
     'conf_loss_5': 0.47297874,
     'recall50_3': 0.17135198,
     'recall50_4': 0.26537493,
     'recall50_5': 0.4501378,
     'total_loss': 2.0388582,
     'validation_loss': 2.0388582}
I0330 02:01:19.765782 139643354593088 controller.py:211] train | step:   5000 | training until step 10000...
I0330 02:36:24.441690 139643354593088 controller.py:425] train | step:  10000 | steps/sec:    1.9 | output: 
    {'avg_iou_3': 0.5984008,
     'avg_iou_4': 0.66313446,
     'avg_iou_5': 0.555738,
     'avg_obj_3': 0.16260332,
     'avg_obj_4': 0.29020393,
     'avg_obj_5': 0.39854407,
     'box_loss_3': 0.21262848,
     'box_loss_4': 0.18168692,
     'box_loss_5': 0.26162225,
     'class_loss_3': 0.21206081,
     'class_loss_4': 0.18591012,
     'class_loss_5': 0.21015759,
     'conf_loss_3': 0.12949425,
     'conf_loss_4': 0.25603253,
     'conf_loss_5': 0.55473083,
     'learning_rate': 0.001,
     'recall50_3': 0.120796256,
     'recall50_4': 0.26080203,
     'recall50_5': 0.40026942,
     'total_loss': 2.20432,
     'training_loss': 2.20432}
I0330 02:37:21.402031 139643354593088 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-pipeline/yolov4-coco-all-50k-adam-aspect_t/ckpt-10000.
I0330 02:37:21.410696 139643354593088 controller.py:252]  eval | step:  10000 | running 78 steps of evaluation...
I0330 02:38:07.134474 139643354593088 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0330 02:40:31.413630 139643354593088 controller.py:261]  eval | step:  10000 | eval time:  190.0 sec | output: 
    {'AP': 0.11614386,
     'AP50': 0.23941356,
     'AP75': 0.10196363,
     'APl': 0.17753473,
     'APm': 0.11866995,
     'APs': 0.033228762,
     'ARl': 0.24846126,
     'ARm': 0.20812368,
     'ARmax1': 0.12545039,
     'ARmax10': 0.18467426,
     'ARmax100': 0.19439681,
     'ARs': 0.074524,
     'avg_iou_3': 0.62904614,
     'avg_iou_4': 0.6847722,
     'avg_iou_5': 0.5937733,
     'avg_obj_3': 0.26780337,
     'avg_obj_4': 0.3770936,
     'avg_obj_5': 0.49829537,
     'box_loss_3': 0.19361496,
     'box_loss_4': 0.16244774,
     'box_loss_5': 0.23096447,
     'class_loss_3': 0.18256578,
     'class_loss_4': 0.1536649,
     'class_loss_5': 0.18229973,
     'conf_loss_3': 0.113863066,
     'conf_loss_4': 0.19217536,
     'conf_loss_5': 0.49213892,
     'recall50_3': 0.2800479,
     'recall50_4': 0.36096925,
     'recall50_5': 0.5349035,
     'total_loss': 1.9037348,
     'validation_loss': 1.9037348}
I0330 02:41:03.829913 139643354593088 controller.py:211] train | step:  10000 | training until step 15000...
I0330 03:15:40.318914 139643354593088 controller.py:425] train | step:  15000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.62220126,
     'avg_iou_4': 0.6878834,
     'avg_iou_5': 0.5826532,
     'avg_obj_3': 0.19992976,
     'avg_obj_4': 0.33580562,
     'avg_obj_5': 0.44457534,
     'box_loss_3': 0.19778499,
     'box_loss_4': 0.16756551,
     'box_loss_5': 0.24428537,
     'class_loss_3': 0.183102,
     'class_loss_4': 0.15867889,
     'class_loss_5': 0.1827025,
     'conf_loss_3': 0.13359092,
     'conf_loss_4': 0.25575843,
     'conf_loss_5': 0.54056406,
     'learning_rate': 0.001,
     'recall50_3': 0.18441826,
     'recall50_4': 0.32629308,
     'recall50_5': 0.46617046,
     'total_loss': 2.0640314,
     'training_loss': 2.0640314}
I0330 03:16:36.746989 139643354593088 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-pipeline/yolov4-coco-all-50k-adam-aspect_t/ckpt-15000.
I0330 03:16:36.753250 139643354593088 controller.py:252]  eval | step:  15000 | running 78 steps of evaluation...
I0330 03:17:25.935171 139643354593088 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.

{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 600, 8), 5: (8, 600, 8)}, inds: {3: (8, 600, 3), 4: (8, 600, 3), 5: (8, 600, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.bfloat16, {source_id: tf.int64, bbox: tf.bfloat16, classes: tf.bfloat16, area: tf.bfloat16, is_crowd: tf.int32, best_anchors: tf.bfloat16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.bfloat16, 4: tf.bfloat16, 5: tf.bfloat16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.bfloat16, 4: tf.bfloat16, 5: tf.bfloat16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 5000...
train | step:   5000 | steps/sec:    2.0 | output: 
    {'avg_iou_3': 0.5060156,
     'avg_iou_4': 0.56837565,
     'avg_iou_5': 0.4663593,
     'avg_obj_3': 0.14818546,
     'avg_obj_4': 0.23287302,
     'avg_obj_5': 0.32633373,
     'box_loss_3': 0.27072665,
     'box_loss_4': 0.2363152,
     'box_loss_5': 0.31780827,
     'class_loss_3': 0.8513471,
     'class_loss_4': 0.7204083,
     'class_loss_5': 0.7095209,
     'conf_loss_3': 0.7246705,
     'conf_loss_4': 0.67526186,
     'conf_loss_5': 0.9295024,
     'learning_rate': 0.001,
     'recall50_3': 0.08681292,
     'recall50_4': 0.16517481,
     'recall50_5': 0.2748678,
     'total_loss': 5.4355655,
     'training_loss': 5.4355655}
saved checkpoint to gs://tensorflow2/debug-data-pipeline/yolov4-coco-all-50k-adam-aspect_t/ckpt-5000.
 eval | step:   5000 | running 78 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=72.98s).
Accumulating evaluation results...
DONE (t=9.00s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.069
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.173
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.038
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.012
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.073
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.110
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.084
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.126
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.133
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.040
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.143
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.161
 eval | step:   5000 | eval time:  401.7 sec | output: 
    {'AP': 0.06904081,
     'AP50': 0.17336936,
     'AP75': 0.037794363,
     'APl': 0.11034123,
     'APm': 0.07321351,
     'APs': 0.012458069,
     'ARl': 0.16102715,
     'ARm': 0.14348832,
     'ARmax1': 0.08361497,
     'ARmax10': 0.12605557,
     'ARmax100': 0.13258034,
     'ARs': 0.039642867,
     'avg_iou_3': 0.59189725,
     'avg_iou_4': 0.64102215,
     'avg_iou_5': 0.54504645,
     'avg_obj_3': 0.18783641,
     'avg_obj_4': 0.29937539,
     'avg_obj_5': 0.43215308,
     'box_loss_3': 0.21923275,
     'box_loss_4': 0.18571262,
     'box_loss_5': 0.2640899,
     'class_loss_3': 0.21493359,
     'class_loss_4': 0.17960161,
     'class_loss_5': 0.20991813,
     'conf_loss_3': 0.11044117,
     'conf_loss_4': 0.18194981,
     'conf_loss_5': 0.47297874,
     'recall50_3': 0.17135198,
     'recall50_4': 0.26537493,
     'recall50_5': 0.4501378,
     'total_loss': 2.0388582,
     'validation_loss': 2.0388582}
train | step:   5000 | training until step 10000...
train | step:  10000 | steps/sec:    1.9 | output: 
    {'avg_iou_3': 0.5984008,
     'avg_iou_4': 0.66313446,
     'avg_iou_5': 0.555738,
     'avg_obj_3': 0.16260332,
     'avg_obj_4': 0.29020393,
     'avg_obj_5': 0.39854407,
     'box_loss_3': 0.21262848,
     'box_loss_4': 0.18168692,
     'box_loss_5': 0.26162225,
     'class_loss_3': 0.21206081,
     'class_loss_4': 0.18591012,
     'class_loss_5': 0.21015759,
     'conf_loss_3': 0.12949425,
     'conf_loss_4': 0.25603253,
     'conf_loss_5': 0.55473083,
     'learning_rate': 0.001,
     'recall50_3': 0.120796256,
     'recall50_4': 0.26080203,
     'recall50_5': 0.40026942,
     'total_loss': 2.20432,
     'training_loss': 2.20432}
saved checkpoint to gs://tensorflow2/debug-data-pipeline/yolov4-coco-all-50k-adam-aspect_t/ckpt-10000.
 eval | step:  10000 | running 78 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=76.74s).
Accumulating evaluation results...
DONE (t=9.29s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.116
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.239
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.102
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.033
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.119
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.178
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.125
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.185
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.194
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.075
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.208
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.248
 eval | step:  10000 | eval time:  190.0 sec | output: 
    {'AP': 0.11614386,
     'AP50': 0.23941356,
     'AP75': 0.10196363,
     'APl': 0.17753473,
     'APm': 0.11866995,
     'APs': 0.033228762,
     'ARl': 0.24846126,
     'ARm': 0.20812368,
     'ARmax1': 0.12545039,
     'ARmax10': 0.18467426,
     'ARmax100': 0.19439681,
     'ARs': 0.074524,
     'avg_iou_3': 0.62904614,
     'avg_iou_4': 0.6847722,
     'avg_iou_5': 0.5937733,
     'avg_obj_3': 0.26780337,
     'avg_obj_4': 0.3770936,
     'avg_obj_5': 0.49829537,
     'box_loss_3': 0.19361496,
     'box_loss_4': 0.16244774,
     'box_loss_5': 0.23096447,
     'class_loss_3': 0.18256578,
     'class_loss_4': 0.1536649,
     'class_loss_5': 0.18229973,
     'conf_loss_3': 0.113863066,
     'conf_loss_4': 0.19217536,
     'conf_loss_5': 0.49213892,
     'recall50_3': 0.2800479,
     'recall50_4': 0.36096925,
     'recall50_5': 0.5349035,
     'total_loss': 1.9037348,
     'validation_loss': 1.9037348}
train | step:  10000 | training until step 15000...
train | step:  15000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.62220126,
     'avg_iou_4': 0.6878834,
     'avg_iou_5': 0.5826532,
     'avg_obj_3': 0.19992976,
     'avg_obj_4': 0.33580562,
     'avg_obj_5': 0.44457534,
     'box_loss_3': 0.19778499,
     'box_loss_4': 0.16756551,
     'box_loss_5': 0.24428537,
     'class_loss_3': 0.183102,
     'class_loss_4': 0.15867889,
     'class_loss_5': 0.1827025,
     'conf_loss_3': 0.13359092,
     'conf_loss_4': 0.25575843,
     'conf_loss_5': 0.54056406,
     'learning_rate': 0.001,
     'recall50_3': 0.18441826,
     'recall50_4': 0.32629308,
     'recall50_5': 0.46617046,
     'total_loss': 2.0640314,
     'training_loss': 2.0640314}
saved checkpoint to gs://tensorflow2/debug-data-pipeline/yolov4-coco-all-50k-adam-aspect_t/ckpt-15000.
 eval | step:  15000 | running 78 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=71.11s).
Accumulating evaluation results...
DONE (t=9.14s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.150I0330 03:19:44.633077 139643354593088 controller.py:261]  eval | step:  15000 | eval time:  187.9 sec | output: 
    {'AP': 0.15045218,
     'AP50': 0.29629537,
     'AP75': 0.14047378,
     'APl': 0.22566973,
     'APm': 0.15544793,
     'APs': 0.042264417,
     'ARl': 0.2969016,
     'ARm': 0.23860481,
     'ARmax1': 0.1490794,
     'ARmax10': 0.2143349,
     'ARmax100': 0.22172232,
     'ARs': 0.075517766,
     'avg_iou_3': 0.6537308,
     'avg_iou_4': 0.69463825,
     'avg_iou_5': 0.60808086,
     'avg_obj_3': 0.2608786,
     'avg_obj_4': 0.3749508,
     'avg_obj_5': 0.5074854,
     'box_loss_3': 0.1777381,
     'box_loss_4': 0.1564468,
     'box_loss_5': 0.22293878,
     'class_loss_3': 0.15520687,
     'class_loss_4': 0.12921582,
     'class_loss_5': 0.1561652,
     'conf_loss_3': 0.10593519,
     'conf_loss_4': 0.18305251,
     'conf_loss_5': 0.45198637,
     'recall50_3': 0.29035407,
     'recall50_4': 0.37373215,
     'recall50_5': 0.5598326,
     'total_loss': 1.7386854,
     'validation_loss': 1.7386854}
I0330 03:20:16.450285 139643354593088 controller.py:211] train | step:  15000 | training until step 20000...
I0330 03:54:42.603023 139643354593088 controller.py:425] train | step:  20000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.64000124,
     'avg_iou_4': 0.70676196,
     'avg_iou_5': 0.6036812,
     'avg_obj_3': 0.23362254,
     'avg_obj_4': 0.3780976,
     'avg_obj_5': 0.4881279,
     'box_loss_3': 0.18652622,
     'box_loss_4': 0.15674838,
     'box_loss_5': 0.23104866,
     'class_loss_3': 0.15721196,
     'class_loss_4': 0.13398612,
     'class_loss_5': 0.15627834,
     'conf_loss_3': 0.1366144,
     'conf_loss_4': 0.2541184,
     'conf_loss_5': 0.52590996,
     'learning_rate': 0.001,
     'recall50_3': 0.24864419,
     'recall50_4': 0.38516164,
     'recall50_5': 0.526217,
     'total_loss': 1.9384422,
     'training_loss': 1.9384422}
I0330 03:55:39.937673 139643354593088 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-pipeline/yolov4-coco-all-50k-adam-aspect_t/ckpt-20000.
I0330 03:55:39.944701 139643354593088 controller.py:252]  eval | step:  20000 | running 78 steps of evaluation...
I0330 03:56:27.194015 139643354593088 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0330 03:58:37.994580 139643354593088 controller.py:261]  eval | step:  20000 | eval time:  178.0 sec | output: 
    {'AP': 0.18711558,
     'AP50': 0.3395083,
     'AP75': 0.18665448,
     'APl': 0.27545843,
     'APm': 0.19267848,
     'APs': 0.05842498,
     'ARl': 0.34039918,
     'ARm': 0.27524388,
     'ARmax1': 0.17516898,
     'ARmax10': 0.2520028,
     'ARmax100': 0.26054692,
     'ARs': 0.098383866,
     'avg_iou_3': 0.6679694,
     'avg_iou_4': 0.71796143,
     'avg_iou_5': 0.6355763,
     'avg_obj_3': 0.27601713,
     'avg_obj_4': 0.42694795,
     'avg_obj_5': 0.5206588,
     'box_loss_3': 0.16547486,
     'box_loss_4': 0.14248826,
     'box_loss_5': 0.2049474,
     'class_loss_3': 0.13953762,
     'class_loss_4': 0.115667,
     'class_loss_5': 0.1381967,
     'conf_loss_3': 0.10516151,
     'conf_loss_4': 0.1844243,
     'conf_loss_5': 0.42827317,
     'recall50_3': 0.32081416,
     'recall50_4': 0.42906877,
     'recall50_5': 0.5752028,
     'total_loss': 1.6241711,
     'validation_loss': 1.6241711}
I0330 03:59:10.182111 139643354593088 controller.py:211] train | step:  20000 | training until step 25000...
I0330 04:35:20.615214 139643354593088 controller.py:425] train | step:  25000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.6517869,
     'avg_iou_4': 0.7193898,
     'avg_iou_5': 0.6180754,
     'avg_obj_3': 0.25730398,
     'avg_obj_4': 0.4088105,
     'avg_obj_5': 0.518437,
     'box_loss_3': 0.17888881,
     'box_loss_4': 0.14932676,
     'box_loss_5': 0.2220605,
     'class_loss_3': 0.13951692,
     'class_loss_4': 0.11710161,
     'class_loss_5': 0.13823715,
     'conf_loss_3': 0.13735127,
     'conf_loss_4': 0.25061843,
     'conf_loss_5': 0.51138896,
     'learning_rate': 0.001,
     'recall50_3': 0.29246232,
     'recall50_4': 0.4257801,
     'recall50_5': 0.56544304,
     'total_loss': 1.8444908,
     'training_loss': 1.8444908}
I0330 04:36:17.998872 139643354593088 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-pipeline/yolov4-coco-all-50k-adam-aspect_t/ckpt-25000.
I0330 04:36:18.006213 139643354593088 controller.py:252]  eval | step:  25000 | running 78 steps of evaluation...
I0330 04:37:05.719931 139643354593088 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0330 04:39:19.284050 139643354593088 controller.py:261]  eval | step:  25000 | eval time:  181.3 sec | output: 
    {'AP': 0.21193066,
     'AP50': 0.37019217,
     'AP75': 0.2193218,
     'APl': 0.32313904,
     'APm': 0.22281949,
     'APs': 0.05685651,
     'ARl': 0.39617968,
     'ARm': 0.3146703,
     'ARmax1': 0.19402625,
     'ARmax10': 0.2789597,
     'ARmax100': 0.28817248,
     'ARs': 0.09461516,
     'avg_iou_3': 0.6750261,
     'avg_iou_4': 0.7338058,
     'avg_iou_5': 0.64845455,
     'avg_obj_3': 0.2970272,
     'avg_obj_4': 0.4427379,
     'avg_obj_5': 0.5545619,
     'box_loss_3': 0.16124262,
     'box_loss_4': 0.13430995,
     'box_loss_5': 0.19782853,
     'class_loss_3': 0.12454682,
     'class_loss_4': 0.10293063,
     'class_loss_5': 0.12597655,
     'conf_loss_3': 0.107760616,
     'conf_loss_4': 0.18548557,
     'conf_loss_5': 0.43758783,
     'recall50_3': 0.3503963,
     'recall50_4': 0.4507612,
     'recall50_5': 0.61939824,
     'total_loss': 1.5776693,
     'validation_loss': 1.5776693}
I0330 04:39:51.062772 139643354593088 controller.py:211] train | step:  25000 | training until step 30000...
I0330 05:15:34.289421 139643354593088 controller.py:425] train | step:  30000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.660202,
     'avg_iou_4': 0.7282717,
     'avg_iou_5': 0.6282247,
     'avg_obj_3': 0.27497673,
     'avg_obj_4': 0.43144375,
     'avg_obj_5': 0.540925,
     'box_loss_3': 0.17365448,
     'box_loss_4': 0.14430179,
     'box_loss_5': 0.21561262,
     'class_loss_3': 0.1270858,
     'class_loss_4': 0.105664134,
     'class_loss_5': 0.12550315,
     'conf_loss_3': 0.13743298,
     'conf_loss_4': 0.24809104,
     'conf_loss_5': 0.5007468,
     'learning_rate': 0.001,
     'recall50_3': 0.32369435,
     'recall50_4': 0.45435777,
     'recall50_5': 0.59357786,
     'total_loss': 1.7780902,
     'training_loss': 1.7780902}

 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.296
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.140
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.042
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.155
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.226
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.149
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.214
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.222
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.076
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.239
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.297
 eval | step:  15000 | eval time:  187.9 sec | output: 
    {'AP': 0.15045218,
     'AP50': 0.29629537,
     'AP75': 0.14047378,
     'APl': 0.22566973,
     'APm': 0.15544793,
     'APs': 0.042264417,
     'ARl': 0.2969016,
     'ARm': 0.23860481,
     'ARmax1': 0.1490794,
     'ARmax10': 0.2143349,
     'ARmax100': 0.22172232,
     'ARs': 0.075517766,
     'avg_iou_3': 0.6537308,
     'avg_iou_4': 0.69463825,
     'avg_iou_5': 0.60808086,
     'avg_obj_3': 0.2608786,
     'avg_obj_4': 0.3749508,
     'avg_obj_5': 0.5074854,
     'box_loss_3': 0.1777381,
     'box_loss_4': 0.1564468,
     'box_loss_5': 0.22293878,
     'class_loss_3': 0.15520687,
     'class_loss_4': 0.12921582,
     'class_loss_5': 0.1561652,
     'conf_loss_3': 0.10593519,
     'conf_loss_4': 0.18305251,
     'conf_loss_5': 0.45198637,
     'recall50_3': 0.29035407,
     'recall50_4': 0.37373215,
     'recall50_5': 0.5598326,
     'total_loss': 1.7386854,
     'validation_loss': 1.7386854}
train | step:  15000 | training until step 20000...
train | step:  20000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.64000124,
     'avg_iou_4': 0.70676196,
     'avg_iou_5': 0.6036812,
     'avg_obj_3': 0.23362254,
     'avg_obj_4': 0.3780976,
     'avg_obj_5': 0.4881279,
     'box_loss_3': 0.18652622,
     'box_loss_4': 0.15674838,
     'box_loss_5': 0.23104866,
     'class_loss_3': 0.15721196,
     'class_loss_4': 0.13398612,
     'class_loss_5': 0.15627834,
     'conf_loss_3': 0.1366144,
     'conf_loss_4': 0.2541184,
     'conf_loss_5': 0.52590996,
     'learning_rate': 0.001,
     'recall50_3': 0.24864419,
     'recall50_4': 0.38516164,
     'recall50_5': 0.526217,
     'total_loss': 1.9384422,
     'training_loss': 1.9384422}
saved checkpoint to gs://tensorflow2/debug-data-pipeline/yolov4-coco-all-50k-adam-aspect_t/ckpt-20000.
 eval | step:  20000 | running 78 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=70.52s).
Accumulating evaluation results...
DONE (t=8.22s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.187
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.340
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.187
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.058
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.193
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.275
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.175
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.252
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.261
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.098
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.275
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.340
 eval | step:  20000 | eval time:  178.0 sec | output: 
    {'AP': 0.18711558,
     'AP50': 0.3395083,
     'AP75': 0.18665448,
     'APl': 0.27545843,
     'APm': 0.19267848,
     'APs': 0.05842498,
     'ARl': 0.34039918,
     'ARm': 0.27524388,
     'ARmax1': 0.17516898,
     'ARmax10': 0.2520028,
     'ARmax100': 0.26054692,
     'ARs': 0.098383866,
     'avg_iou_3': 0.6679694,
     'avg_iou_4': 0.71796143,
     'avg_iou_5': 0.6355763,
     'avg_obj_3': 0.27601713,
     'avg_obj_4': 0.42694795,
     'avg_obj_5': 0.5206588,
     'box_loss_3': 0.16547486,
     'box_loss_4': 0.14248826,
     'box_loss_5': 0.2049474,
     'class_loss_3': 0.13953762,
     'class_loss_4': 0.115667,
     'class_loss_5': 0.1381967,
     'conf_loss_3': 0.10516151,
     'conf_loss_4': 0.1844243,
     'conf_loss_5': 0.42827317,
     'recall50_3': 0.32081416,
     'recall50_4': 0.42906877,
     'recall50_5': 0.5752028,
     'total_loss': 1.6241711,
     'validation_loss': 1.6241711}
train | step:  20000 | training until step 25000...
train | step:  25000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.6517869,
     'avg_iou_4': 0.7193898,
     'avg_iou_5': 0.6180754,
     'avg_obj_3': 0.25730398,
     'avg_obj_4': 0.4088105,
     'avg_obj_5': 0.518437,
     'box_loss_3': 0.17888881,
     'box_loss_4': 0.14932676,
     'box_loss_5': 0.2220605,
     'class_loss_3': 0.13951692,
     'class_loss_4': 0.11710161,
     'class_loss_5': 0.13823715,
     'conf_loss_3': 0.13735127,
     'conf_loss_4': 0.25061843,
     'conf_loss_5': 0.51138896,
     'learning_rate': 0.001,
     'recall50_3': 0.29246232,
     'recall50_4': 0.4257801,
     'recall50_5': 0.56544304,
     'total_loss': 1.8444908,
     'training_loss': 1.8444908}
saved checkpoint to gs://tensorflow2/debug-data-pipeline/yolov4-coco-all-50k-adam-aspect_t/ckpt-25000.
 eval | step:  25000 | running 78 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=71.45s).
Accumulating evaluation results...
DONE (t=8.30s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.212
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.370
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.219
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.057
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.223
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.323
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.194
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.279
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.288
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.095
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.315
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.396
 eval | step:  25000 | eval time:  181.3 sec | output: 
    {'AP': 0.21193066,
     'AP50': 0.37019217,
     'AP75': 0.2193218,
     'APl': 0.32313904,
     'APm': 0.22281949,
     'APs': 0.05685651,
     'ARl': 0.39617968,
     'ARm': 0.3146703,
     'ARmax1': 0.19402625,
     'ARmax10': 0.2789597,
     'ARmax100': 0.28817248,
     'ARs': 0.09461516,
     'avg_iou_3': 0.6750261,
     'avg_iou_4': 0.7338058,
     'avg_iou_5': 0.64845455,
     'avg_obj_3': 0.2970272,
     'avg_obj_4': 0.4427379,
     'avg_obj_5': 0.5545619,
     'box_loss_3': 0.16124262,
     'box_loss_4': 0.13430995,
     'box_loss_5': 0.19782853,
     'class_loss_3': 0.12454682,
     'class_loss_4': 0.10293063,
     'class_loss_5': 0.12597655,
     'conf_loss_3': 0.107760616,
     'conf_loss_4': 0.18548557,
     'conf_loss_5': 0.43758783,
     'recall50_3': 0.3503963,
     'recall50_4': 0.4507612,
     'recall50_5': 0.61939824,
     'total_loss': 1.5776693,
     'validation_loss': 1.5776693}
train | step:  25000 | training until step 30000...
train | step:  30000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.660202,
     'avg_iou_4': 0.7282717,
     'avg_iou_5': 0.6282247,
     'avg_obj_3': 0.27497673,
     'avg_obj_4': 0.43144375,
     'avg_obj_5': 0.540925,
     'box_loss_3': 0.17365448,
     'box_loss_4': 0.14430179,
     'box_loss_5': 0.21561262,
     'class_loss_3': 0.1270858,
     'class_loss_4': 0.105664134,
     'class_loss_5': 0.12550315,
     'conf_loss_3': 0.13743298,
     'conf_loss_4': 0.24809104,
     'conf_loss_5': 0.5007468,
     'learning_rate': 0.001,
     'recall50_3': 0.32369435,
     'recall50_4': 0.45435777,
     'recall50_5': 0.59357786,
     'total_loss': 1.7780902,
     'training_loss': 1.7780902}I0330 05:16:32.779855 139643354593088 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-pipeline/yolov4-coco-all-50k-adam-aspect_t/ckpt-30000.
I0330 05:16:32.786477 139643354593088 controller.py:252]  eval | step:  30000 | running 78 steps of evaluation...
I0330 05:17:17.596653 139643354593088 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0330 05:19:30.878617 139643354593088 controller.py:261]  eval | step:  30000 | eval time:  178.1 sec | output: 
    {'AP': 0.2220993,
     'AP50': 0.38388938,
     'AP75': 0.23405655,
     'APl': 0.34097517,
     'APm': 0.22658041,
     'APs': 0.06452957,
     'ARl': 0.40779352,
     'ARm': 0.3063011,
     'ARmax1': 0.19991514,
     'ARmax10': 0.2831407,
     'ARmax100': 0.28986025,
     'ARs': 0.09984967,
     'avg_iou_3': 0.677983,
     'avg_iou_4': 0.7308659,
     'avg_iou_5': 0.65495896,
     'avg_obj_3': 0.31550834,
     'avg_obj_4': 0.43707243,
     'avg_obj_5': 0.53412503,
     'box_loss_3': 0.15759073,
     'box_loss_4': 0.13593265,
     'box_loss_5': 0.19506478,
     'class_loss_3': 0.1162863,
     'class_loss_4': 0.097134225,
     'class_loss_5': 0.11842627,
     'conf_loss_3': 0.110007845,
     'conf_loss_4': 0.18100761,
     'conf_loss_5': 0.41927877,
     'recall50_3': 0.39152095,
     'recall50_4': 0.45644403,
     'recall50_5': 0.60378444,
     'total_loss': 1.5307293,
     'validation_loss': 1.5307293}
I0330 05:19:55.276222 139643354593088 controller.py:211] train | step:  30000 | training until step 35000...
I0330 05:54:45.803435 139643354593088 controller.py:425] train | step:  35000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.66667247,
     'avg_iou_4': 0.7350656,
     'avg_iou_5': 0.6358435,
     'avg_obj_3': 0.28947458,
     'avg_obj_4': 0.44942096,
     'avg_obj_5': 0.55869895,
     'box_loss_3': 0.16970345,
     'box_loss_4': 0.14041583,
     'box_loss_5': 0.21104592,
     'class_loss_3': 0.117386304,
     'class_loss_4': 0.0964132,
     'class_loss_5': 0.11590309,
     'conf_loss_3': 0.13734753,
     'conf_loss_4': 0.24553284,
     'conf_loss_5': 0.49278042,
     'learning_rate': 0.001,
     'recall50_3': 0.3480625,
     'recall50_4': 0.47692183,
     'recall50_5': 0.6160533,
     'total_loss': 1.726524,
     'training_loss': 1.726524}
I0330 05:55:43.939804 139643354593088 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-pipeline/yolov4-coco-all-50k-adam-aspect_t/ckpt-35000.
I0330 05:55:43.945846 139643354593088 controller.py:252]  eval | step:  35000 | running 78 steps of evaluation...
I0330 05:56:29.970635 139643354593088 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0330 05:58:44.721569 139643354593088 controller.py:261]  eval | step:  35000 | eval time:  180.8 sec | output: 
    {'AP': 0.24448092,
     'AP50': 0.4159595,
     'AP75': 0.25732863,
     'APl': 0.36220306,
     'APm': 0.24907342,
     'APs': 0.07751169,
     'ARl': 0.42969933,
     'ARm': 0.33803645,
     'ARmax1': 0.2151124,
     'ARmax10': 0.30893824,
     'ARmax100': 0.31982246,
     'ARs': 0.1286017,
     'avg_iou_3': 0.68939525,
     'avg_iou_4': 0.74516755,
     'avg_iou_5': 0.6664081,
     'avg_obj_3': 0.34987634,
     'avg_obj_4': 0.47728318,
     'avg_obj_5': 0.5765914,
     'box_loss_3': 0.1532719,
     'box_loss_4': 0.1291607,
     'box_loss_5': 0.18824981,
     'class_loss_3': 0.10582985,
     'class_loss_4': 0.089052044,
     'class_loss_5': 0.10723139,
     'conf_loss_3': 0.10940588,
     'conf_loss_4': 0.17945227,
     'conf_loss_5': 0.4215243,
     'recall50_3': 0.42616296,
     'recall50_4': 0.4970909,
     'recall50_5': 0.6482617,
     'total_loss': 1.4831785,
     'validation_loss': 1.4831785}
I0330 05:59:17.815046 139643354593088 controller.py:211] train | step:  35000 | training until step 40000...
I0330 06:33:58.092972 139643354593088 controller.py:425] train | step:  40000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.6715997,
     'avg_iou_4': 0.7403877,
     'avg_iou_5': 0.6422761,
     'avg_obj_3': 0.30150574,
     'avg_obj_4': 0.46430624,
     'avg_obj_5': 0.57307667,
     'box_loss_3': 0.16663417,
     'box_loss_4': 0.13728248,
     'box_loss_5': 0.20715925,
     'class_loss_3': 0.11006781,
     'class_loss_4': 0.08976861,
     'class_loss_5': 0.10847492,
     'conf_loss_3': 0.13680892,
     'conf_loss_4': 0.24377196,
     'conf_loss_5': 0.4833381,
     'learning_rate': 0.001,
     'recall50_3': 0.36728215,
     'recall50_4': 0.49633768,
     'recall50_5': 0.6337201,
     'total_loss': 1.6833067,
     'training_loss': 1.6833067}
I0330 06:34:55.450714 139643354593088 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-pipeline/yolov4-coco-all-50k-adam-aspect_t/ckpt-40000.
I0330 06:34:55.457320 139643354593088 controller.py:252]  eval | step:  40000 | running 78 steps of evaluation...
I0330 06:35:43.295718 139643354593088 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0330 06:37:46.544178 139643354593088 controller.py:261]  eval | step:  40000 | eval time:  171.1 sec | output: 
    {'AP': 0.24324964,
     'AP50': 0.41960365,
     'AP75': 0.258433,
     'APl': 0.35933596,
     'APm': 0.25592527,
     'APs': 0.0732051,
     'ARl': 0.42812002,
     'ARm': 0.33872858,
     'ARmax1': 0.21409747,
     'ARmax10': 0.3089572,
     'ARmax100': 0.31768262,
     'ARs': 0.11811622,
     'avg_iou_3': 0.69115615,
     'avg_iou_4': 0.74511886,
     'avg_iou_5': 0.66159785,
     'avg_obj_3': 0.3301484,
     'avg_obj_4': 0.46951607,
     'avg_obj_5': 0.5700848,
     'box_loss_3': 0.1534728,
     'box_loss_4': 0.12804225,
     'box_loss_5': 0.19047637,
     'class_loss_3': 0.10381992,
     'class_loss_4': 0.087106936,
     'class_loss_5': 0.105500795,
     'conf_loss_3': 0.11239788,
     'conf_loss_4': 0.17968877,
     'conf_loss_5': 0.42001948,
     'recall50_3': 0.42275068,
     'recall50_4': 0.48942003,
     'recall50_5': 0.64293116,
     'total_loss': 1.4805253,
     'validation_loss': 1.4805253}

saved checkpoint to gs://tensorflow2/debug-data-pipeline/yolov4-coco-all-50k-adam-aspect_t/ckpt-30000.
 eval | step:  30000 | running 78 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=68.52s).
Accumulating evaluation results...
DONE (t=7.95s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.222
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.384
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.234
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.065
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.227
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.341
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.200
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.283
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.290
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.100
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.306
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.408
 eval | step:  30000 | eval time:  178.1 sec | output: 
    {'AP': 0.2220993,
     'AP50': 0.38388938,
     'AP75': 0.23405655,
     'APl': 0.34097517,
     'APm': 0.22658041,
     'APs': 0.06452957,
     'ARl': 0.40779352,
     'ARm': 0.3063011,
     'ARmax1': 0.19991514,
     'ARmax10': 0.2831407,
     'ARmax100': 0.28986025,
     'ARs': 0.09984967,
     'avg_iou_3': 0.677983,
     'avg_iou_4': 0.7308659,
     'avg_iou_5': 0.65495896,
     'avg_obj_3': 0.31550834,
     'avg_obj_4': 0.43707243,
     'avg_obj_5': 0.53412503,
     'box_loss_3': 0.15759073,
     'box_loss_4': 0.13593265,
     'box_loss_5': 0.19506478,
     'class_loss_3': 0.1162863,
     'class_loss_4': 0.097134225,
     'class_loss_5': 0.11842627,
     'conf_loss_3': 0.110007845,
     'conf_loss_4': 0.18100761,
     'conf_loss_5': 0.41927877,
     'recall50_3': 0.39152095,
     'recall50_4': 0.45644403,
     'recall50_5': 0.60378444,
     'total_loss': 1.5307293,
     'validation_loss': 1.5307293}
train | step:  30000 | training until step 35000...
train | step:  35000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.66667247,
     'avg_iou_4': 0.7350656,
     'avg_iou_5': 0.6358435,
     'avg_obj_3': 0.28947458,
     'avg_obj_4': 0.44942096,
     'avg_obj_5': 0.55869895,
     'box_loss_3': 0.16970345,
     'box_loss_4': 0.14041583,
     'box_loss_5': 0.21104592,
     'class_loss_3': 0.117386304,
     'class_loss_4': 0.0964132,
     'class_loss_5': 0.11590309,
     'conf_loss_3': 0.13734753,
     'conf_loss_4': 0.24553284,
     'conf_loss_5': 0.49278042,
     'learning_rate': 0.001,
     'recall50_3': 0.3480625,
     'recall50_4': 0.47692183,
     'recall50_5': 0.6160533,
     'total_loss': 1.726524,
     'training_loss': 1.726524}
saved checkpoint to gs://tensorflow2/debug-data-pipeline/yolov4-coco-all-50k-adam-aspect_t/ckpt-35000.
 eval | step:  35000 | running 78 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=70.25s).
Accumulating evaluation results...
DONE (t=8.46s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.244
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.416
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.257
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.078
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.249
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.362
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.215
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.309
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.320
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.129
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.338
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.430
 eval | step:  35000 | eval time:  180.8 sec | output: 
    {'AP': 0.24448092,
     'AP50': 0.4159595,
     'AP75': 0.25732863,
     'APl': 0.36220306,
     'APm': 0.24907342,
     'APs': 0.07751169,
     'ARl': 0.42969933,
     'ARm': 0.33803645,
     'ARmax1': 0.2151124,
     'ARmax10': 0.30893824,
     'ARmax100': 0.31982246,
     'ARs': 0.1286017,
     'avg_iou_3': 0.68939525,
     'avg_iou_4': 0.74516755,
     'avg_iou_5': 0.6664081,
     'avg_obj_3': 0.34987634,
     'avg_obj_4': 0.47728318,
     'avg_obj_5': 0.5765914,
     'box_loss_3': 0.1532719,
     'box_loss_4': 0.1291607,
     'box_loss_5': 0.18824981,
     'class_loss_3': 0.10582985,
     'class_loss_4': 0.089052044,
     'class_loss_5': 0.10723139,
     'conf_loss_3': 0.10940588,
     'conf_loss_4': 0.17945227,
     'conf_loss_5': 0.4215243,
     'recall50_3': 0.42616296,
     'recall50_4': 0.4970909,
     'recall50_5': 0.6482617,
     'total_loss': 1.4831785,
     'validation_loss': 1.4831785}
train | step:  35000 | training until step 40000...
train | step:  40000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.6715997,
     'avg_iou_4': 0.7403877,
     'avg_iou_5': 0.6422761,
     'avg_obj_3': 0.30150574,
     'avg_obj_4': 0.46430624,
     'avg_obj_5': 0.57307667,
     'box_loss_3': 0.16663417,
     'box_loss_4': 0.13728248,
     'box_loss_5': 0.20715925,
     'class_loss_3': 0.11006781,
     'class_loss_4': 0.08976861,
     'class_loss_5': 0.10847492,
     'conf_loss_3': 0.13680892,
     'conf_loss_4': 0.24377196,
     'conf_loss_5': 0.4833381,
     'learning_rate': 0.001,
     'recall50_3': 0.36728215,
     'recall50_4': 0.49633768,
     'recall50_5': 0.6337201,
     'total_loss': 1.6833067,
     'training_loss': 1.6833067}
saved checkpoint to gs://tensorflow2/debug-data-pipeline/yolov4-coco-all-50k-adam-aspect_t/ckpt-40000.
 eval | step:  40000 | running 78 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=64.42s).
Accumulating evaluation results...
DONE (t=8.19s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.243
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.420
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.258
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.073
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.256
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.359
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.214
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.309
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.318
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.118
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.339
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.428
 eval | step:  40000 | eval time:  171.1 sec | output: 
    {'AP': 0.24324964,
     'AP50': 0.41960365,
     'AP75': 0.258433,
     'APl': 0.35933596,
     'APm': 0.25592527,
     'APs': 0.0732051,
     'ARl': 0.42812002,
     'ARm': 0.33872858,
     'ARmax1': 0.21409747,
     'ARmax10': 0.3089572,
     'ARmax100': 0.31768262,
     'ARs': 0.11811622,
     'avg_iou_3': 0.69115615,
     'avg_iou_4': 0.74511886,
     'avg_iou_5': 0.66159785,
     'avg_obj_3': 0.3301484,
     'avg_obj_4': 0.46951607,
     'avg_obj_5': 0.5700848,
     'box_loss_3': 0.1534728,
     'box_loss_4': 0.12804225,
     'box_loss_5': 0.19047637,
     'class_loss_3': 0.10381992,
     'class_loss_4': 0.087106936,
     'class_loss_5': 0.105500795,
     'conf_loss_3': 0.11239788,
     'conf_loss_4': 0.17968877,
     'conf_loss_5': 0.42001948,
     'recall50_3': 0.42275068,
     'recall50_4': 0.48942003,
     'recall50_5': 0.64293116,
     'total_loss': 1.4805253,
     'validation_loss': 1.4805253}I0330 06:38:19.326971 139643354593088 controller.py:211] train | step:  40000 | training until step 45000...
I0330 07:10:51.945427 139643354593088 controller.py:425] train | step:  45000 | steps/sec:    2.3 | output: 
    {'avg_iou_3': 0.68738765,
     'avg_iou_4': 0.75735044,
     'avg_iou_5': 0.66253364,
     'avg_obj_3': 0.33697894,
     'avg_obj_4': 0.5068987,
     'avg_obj_5': 0.6156508,
     'box_loss_3': 0.15591353,
     'box_loss_4': 0.12734519,
     'box_loss_5': 0.19413887,
     'class_loss_3': 0.0888042,
     'class_loss_4': 0.07039911,
     'class_loss_5': 0.08729384,
     'conf_loss_3': 0.13477544,
     'conf_loss_4': 0.23815942,
     'conf_loss_5': 0.46125743,
     'learning_rate': 1e-04,
     'recall50_3': 0.4252083,
     'recall50_4': 0.5491571,
     'recall50_5': 0.6834545,
     'total_loss': 1.5580873,
     'training_loss': 1.5580873}
I0330 07:11:43.395112 139643354593088 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-pipeline/yolov4-coco-all-50k-adam-aspect_t/ckpt-45000.
I0330 07:11:43.401068 139643354593088 controller.py:252]  eval | step:  45000 | running 78 steps of evaluation...
I0330 07:12:31.843332 139643354593088 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0330 07:14:43.308408 139643354593088 controller.py:261]  eval | step:  45000 | eval time:  179.9 sec | output: 
    {'AP': 0.28407362,
     'AP50': 0.46520144,
     'AP75': 0.30463082,
     'APl': 0.41899586,
     'APm': 0.29849818,
     'APs': 0.08996125,
     'ARl': 0.48761672,
     'ARm': 0.38535598,
     'ARmax1': 0.24133651,
     'ARmax10': 0.34815124,
     'ARmax100': 0.35879493,
     'ARs': 0.14004329,
     'avg_iou_3': 0.7065476,
     'avg_iou_4': 0.7605186,
     'avg_iou_5': 0.6841531,
     'avg_obj_3': 0.3726824,
     'avg_obj_4': 0.5146968,
     'avg_obj_5': 0.6111808,
     'box_loss_3': 0.14225018,
     'box_loss_4': 0.11947886,
     'box_loss_5': 0.17602918,
     'class_loss_3': 0.088193886,
     'class_loss_4': 0.07295794,
     'class_loss_5': 0.088839546,
     'conf_loss_3': 0.106451094,
     'conf_loss_4': 0.1795235,
     'conf_loss_5': 0.4019423,
     'recall50_3': 0.47807908,
     'recall50_4': 0.5440532,
     'recall50_5': 0.68641293,
     'total_loss': 1.3756667,
     'validation_loss': 1.3756667}
I0330 07:15:02.737298 139643354593088 controller.py:211] train | step:  45000 | training until step 50000...
I0330 07:46:49.816849 139643354593088 controller.py:425] train | step:  50000 | steps/sec:    2.3 | output: 
    {'avg_iou_3': 0.69060594,
     'avg_iou_4': 0.7612055,
     'avg_iou_5': 0.6667858,
     'avg_obj_3': 0.346314,
     'avg_obj_4': 0.5186977,
     'avg_obj_5': 0.6272307,
     'box_loss_3': 0.15375736,
     'box_loss_4': 0.12501526,
     'box_loss_5': 0.19140115,
     'class_loss_3': 0.084162295,
     'class_loss_4': 0.06589156,
     'class_loss_5': 0.08260144,
     'conf_loss_3': 0.13270633,
     'conf_loss_4': 0.23620977,
     'conf_loss_5': 0.45460424,
     'learning_rate': 1e-05,
     'recall50_3': 0.43987432,
     'recall50_4': 0.56295466,
     'recall50_5': 0.6958605,
     'total_loss': 1.526351,
     'training_loss': 1.526351}
I0330 07:47:48.876807 139643354593088 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-pipeline/yolov4-coco-all-50k-adam-aspect_t/ckpt-50000.
I0330 07:47:48.883309 139643354593088 controller.py:252]  eval | step:  50000 | running 78 steps of evaluation...
I0330 07:48:37.152987 139643354593088 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0330 07:50:43.976203 139643354593088 controller.py:261]  eval | step:  50000 | eval time:  175.1 sec | output: 
    {'AP': 0.2879101,
     'AP50': 0.46753597,
     'AP75': 0.31079847,
     'APl': 0.42828542,
     'APm': 0.30114874,
     'APs': 0.09153496,
     'ARl': 0.4960426,
     'ARm': 0.3883391,
     'ARmax1': 0.24418385,
     'ARmax10': 0.35167763,
     'ARmax100': 0.36202684,
     'ARs': 0.14051855,
     'avg_iou_3': 0.7085614,
     'avg_iou_4': 0.76201725,
     'avg_iou_5': 0.6869919,
     'avg_obj_3': 0.37084612,
     'avg_obj_4': 0.5149404,
     'avg_obj_5': 0.6096639,
     'box_loss_3': 0.14065753,
     'box_loss_4': 0.11856094,
     'box_loss_5': 0.17467351,
     'class_loss_3': 0.08649386,
     'class_loss_4': 0.07170247,
     'class_loss_5': 0.08715655,
     'conf_loss_3': 0.105856575,
     'conf_loss_4': 0.17821091,
     'conf_loss_5': 0.40072545,
     'recall50_3': 0.48135415,
     'recall50_4': 0.54481167,
     'recall50_5': 0.68591154,
     'total_loss': 1.364038,
     'validation_loss': 1.364038}
I0330 07:51:15.286472 139643354593088 train_lib.py:123] Number of trainable params in model: 64.429405 Millions.

train | step:  40000 | training until step 45000...
train | step:  45000 | steps/sec:    2.3 | output: 
    {'avg_iou_3': 0.68738765,
     'avg_iou_4': 0.75735044,
     'avg_iou_5': 0.66253364,
     'avg_obj_3': 0.33697894,
     'avg_obj_4': 0.5068987,
     'avg_obj_5': 0.6156508,
     'box_loss_3': 0.15591353,
     'box_loss_4': 0.12734519,
     'box_loss_5': 0.19413887,
     'class_loss_3': 0.0888042,
     'class_loss_4': 0.07039911,
     'class_loss_5': 0.08729384,
     'conf_loss_3': 0.13477544,
     'conf_loss_4': 0.23815942,
     'conf_loss_5': 0.46125743,
     'learning_rate': 1e-04,
     'recall50_3': 0.4252083,
     'recall50_4': 0.5491571,
     'recall50_5': 0.6834545,
     'total_loss': 1.5580873,
     'training_loss': 1.5580873}
saved checkpoint to gs://tensorflow2/debug-data-pipeline/yolov4-coco-all-50k-adam-aspect_t/ckpt-45000.
 eval | step:  45000 | running 78 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=65.03s).
Accumulating evaluation results...
DONE (t=8.04s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.284
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.465
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.305
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.090
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.298
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.419
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.241
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.348
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.359
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.140
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.385
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.488
 eval | step:  45000 | eval time:  179.9 sec | output: 
    {'AP': 0.28407362,
     'AP50': 0.46520144,
     'AP75': 0.30463082,
     'APl': 0.41899586,
     'APm': 0.29849818,
     'APs': 0.08996125,
     'ARl': 0.48761672,
     'ARm': 0.38535598,
     'ARmax1': 0.24133651,
     'ARmax10': 0.34815124,
     'ARmax100': 0.35879493,
     'ARs': 0.14004329,
     'avg_iou_3': 0.7065476,
     'avg_iou_4': 0.7605186,
     'avg_iou_5': 0.6841531,
     'avg_obj_3': 0.3726824,
     'avg_obj_4': 0.5146968,
     'avg_obj_5': 0.6111808,
     'box_loss_3': 0.14225018,
     'box_loss_4': 0.11947886,
     'box_loss_5': 0.17602918,
     'class_loss_3': 0.088193886,
     'class_loss_4': 0.07295794,
     'class_loss_5': 0.088839546,
     'conf_loss_3': 0.106451094,
     'conf_loss_4': 0.1795235,
     'conf_loss_5': 0.4019423,
     'recall50_3': 0.47807908,
     'recall50_4': 0.5440532,
     'recall50_5': 0.68641293,
     'total_loss': 1.3756667,
     'validation_loss': 1.3756667}
train | step:  45000 | training until step 50000...
train | step:  50000 | steps/sec:    2.3 | output: 
    {'avg_iou_3': 0.69060594,
     'avg_iou_4': 0.7612055,
     'avg_iou_5': 0.6667858,
     'avg_obj_3': 0.346314,
     'avg_obj_4': 0.5186977,
     'avg_obj_5': 0.6272307,
     'box_loss_3': 0.15375736,
     'box_loss_4': 0.12501526,
     'box_loss_5': 0.19140115,
     'class_loss_3': 0.084162295,
     'class_loss_4': 0.06589156,
     'class_loss_5': 0.08260144,
     'conf_loss_3': 0.13270633,
     'conf_loss_4': 0.23620977,
     'conf_loss_5': 0.45460424,
     'learning_rate': 1e-05,
     'recall50_3': 0.43987432,
     'recall50_4': 0.56295466,
     'recall50_5': 0.6958605,
     'total_loss': 1.526351,
     'training_loss': 1.526351}
saved checkpoint to gs://tensorflow2/debug-data-pipeline/yolov4-coco-all-50k-adam-aspect_t/ckpt-50000.
 eval | step:  50000 | running 78 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=66.85s).
Accumulating evaluation results...
DONE (t=7.98s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.288
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.468
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.311
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.092
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.301
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.428
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.244
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.352
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.362
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.141
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.388
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.496
 eval | step:  50000 | eval time:  175.1 sec | output: 
    {'AP': 0.2879101,
     'AP50': 0.46753597,
     'AP75': 0.31079847,
     'APl': 0.42828542,
     'APm': 0.30114874,
     'APs': 0.09153496,
     'ARl': 0.4960426,
     'ARm': 0.3883391,
     'ARmax1': 0.24418385,
     'ARmax10': 0.35167763,
     'ARmax100': 0.36202684,
     'ARs': 0.14051855,
     'avg_iou_3': 0.7085614,
     'avg_iou_4': 0.76201725,
     'avg_iou_5': 0.6869919,
     'avg_obj_3': 0.37084612,
     'avg_obj_4': 0.5149404,
     'avg_obj_5': 0.6096639,
     'box_loss_3': 0.14065753,
     'box_loss_4': 0.11856094,
     'box_loss_5': 0.17467351,
     'class_loss_3': 0.08649386,
     'class_loss_4': 0.07170247,
     'class_loss_5': 0.08715655,
     'conf_loss_3': 0.105856575,
     'conf_loss_4': 0.17821091,
     'conf_loss_5': 0.40072545,
     'recall50_3': 0.48135415,
     'recall50_4': 0.54481167,
     'recall50_5': 0.68591154,
     'total_loss': 1.364038,
     'validation_loss': 1.364038}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   230    0     2  100   228     12   1480 --:--:-- --:--:-- --:--:--  1493
okRequest issued for: [node-5]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-03-30T07:51:28.883780476Z'
  endTime: '2021-03-30T07:52:24.708257922Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617090688869-5bebc441465a0-5a769bcf-0e9154e0
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617090688869-5bebc441465a0-5a769bcf-0e9154e0] to complete...
................................................................................................................................................................................................................................................................................................................................................................................................done.
