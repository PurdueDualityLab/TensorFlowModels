cat: .experiment_zone: No such file or directory
Request issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-06T15:53:29.855818347Z'
  endTime: '2021-04-06T15:54:08.134240003Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617724409844-5bf4fd0cb149c-32be474a-dd854225
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617724409844-5bf4fd0cb149c-32be474a-dd854225] to complete...
.................................................................................................................................................................................................................................................................................done.
europe-west4-a
I0406 15:54:15.492465 140690734946112 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [608, 608, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_translate': 0.2,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 608,
                                    'image_w': 608,
                                    'jitter_boxes': 0.4,
                                    'jitter_im': 0.3,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 608,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.75],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_translate': 0.25,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 608,
                                         'image_w': 608,
                                         'jitter_boxes': 0.4,
                                         'jitter_im': 0.3,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 416,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.75],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': True,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.001},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': 'str = "AP50"',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'str = "higher"',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine_epoch': {'alpha': 0.2,
                                                                     'decay_steps': 203000,
                                                                     'initial_learning_rate': 0.001,
                                                                     'name': 'CosineEpoch',
                                                                     'steps_per_epoch': 680},
                                                    'type': 'cosine_epoch'},
                                  'optimizer': {'adam': {'amsgrad': False,
                                                         'beta_1': 0.949,
                                                         'beta_2': 0.999,
                                                         'clipnorm': None,
                                                         'clipvalue': None,
                                                         'epsilon': 1e-07,
                                                         'global_clipnorm': None,
                                                         'name': 'adam'},
                                                'type': 'adam'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 20000,
             'summary_interval': 20000,
             'train_steps': 204000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0406 15:54:15.494113 140690734946112 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/full_cfg_exp/yolov4-coco-adam-mo2017-epoch-letterbox/params.yaml
I0406 15:54:17.167013 140690734946112 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0406 15:54:17.312056 140690734946112 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0406 15:54:17.312369 140690734946112 transport.py:157] Attempting refresh to obtain initial access_token
I0406 15:54:17.367106 140690734946112 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0406 15:54:17.520442 140690734946112 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0406 15:54:17.520747 140690734946112 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-06 15:54:17.566229: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0406 15:54:17.566902 140690734946112 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0406 15:54:17.709827 140690734946112 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0406 15:54:17.710129 140690734946112 transport.py:157] Attempting refresh to obtain initial access_token
I0406 15:54:17.763231 140690734946112 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0406 15:54:18.383558 140690734946112 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0406 15:54:18.384017 140690734946112 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-06 15:54:18.425732: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-06 15:54:18.434632: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-06 15:54:18.434697: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:60685}
2021-04-06 15:54:39.620124: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-06 15:54:39.620219: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:60685}
2021-04-06 15:54:39.620824: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:60685
I0406 15:54:39.621644 140690734946112 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-6
I0406 15:54:39.622518 140690734946112 tpu_strategy_util.py:74] Initializing the TPU system: node-6
INFO:tensorflow:Clearing out eager caches
I0406 15:54:48.105170 140690734946112 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0406 15:54:48.106903 140690734946112 tpu_strategy_util.py:133] Finished initializing TPU system.
I0406 15:54:48.108152 140690734946112 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0406 15:54:48.729219 140690734946112 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0406 15:54:48.729717 140690734946112 transport.py:157] Attempting refresh to obtain initial access_token
I0406 15:54:48.783004 140690734946112 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0406 15:54:49.397897 140690734946112 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0406 15:54:49.398125 140690734946112 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0406 15:54:49.439532 140690734946112 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0406 15:54:49.439956 140690734946112 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0406 15:54:49.440402 140690734946112 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0406 15:54:49.440528 140690734946112 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0406 15:54:49.440651 140690734946112 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0406 15:54:49.440978 140690734946112 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0406 15:54:49.441086 140690734946112 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0406 15:54:49.441192 140690734946112 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0406 15:54:49.441295 140690734946112 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0406 15:54:49.441403 140690734946112 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0406 15:54:49.441510 140690734946112 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0406 15:54:49.441615 140690734946112 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0406 15:54:49.441755 140690734946112 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0406 15:54:49.441862 140690734946112 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0406 15:54:49.441962 140690734946112 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0406 15:54:49.442062 140690734946112 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0406 15:54:49.470474 140690734946112 train_utils.py:214] Running default trainer.
2021-04-06 15:54:49.486322: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [608, 608, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 608, 'image_h': 608, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 608, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'jitter_boxes': 0.4, 'aug_rand_translate': 0.2, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_zoom': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.75], 'random_crop': True, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 608, 'image_h': 608, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 416, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'jitter_boxes': 0.4, 'aug_rand_translate': 0.25, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_zoom': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.75], 'random_crop': True, 'random_crop_mosaic': False}}}, 'weight_decay': 0.001, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'adam', 'adam': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'adam', 'beta_1': 0.949, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine_epoch', 'cosine_epoch': {'name': 'CosineEpoch', 'initial_learning_rate': 0.001, 'decay_steps': 203000, 'steps_per_epoch': 680, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 20000, 'summary_interval': 20000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 204000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': 'str = "AP50"', 'best_checkpoint_metric_comp': 'str = "higher"', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
{'3': 2.0, '4': 2.0, '5': 2.0} 0.0005
{'num_classes': 91, '_input_size': [608, 608, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 608, 608, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7ff4b474e080>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 608, 608, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 608, 608, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 304, 304, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 304, 304, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 304, 304, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 152, 152, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 152, 152, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 152, 152, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 152, 152, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 76, 76, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 76, 76, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 38, 38, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 38, 38, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 19, 19, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 19, 19, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 19, 19, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 19, 19, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 19, 19, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 19, 19, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
conv1 512.0
conv2 1024.0
conv1 512.0
spp
conv1 512.0
conv2 1024.0
conv1 512.0
7
conv1 512.0
conv2 256.0
conv1 512.0
conv2 256.0
4








 ListWrapper([256, 512, 1024])
conv1 128
conv2 256
conv1 128
conv2 256
conv1 128
conv2 256
6
conv1 256
conv2 512
conv1 256
conv2 512
conv1 256
conv2 512
6
conv1 512
conv2 1024
conv1 512
conv2 1024
conv1 512
conv2 1024
6
detget {'3': 2.0, '4': 2.0, '5': 2.0}
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 76, 76, 256) 37319168  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 64,488,640
Trainable params: 64,422,336
Non-trainable params: 66,304
_________________________________________________________________
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 608, 608, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4), num_detections: (8,), upds: {3: (8, 400, 8), 4: (8, 400, 8), 5: (8, 400, 8)}, inds: {3: (8, 400, 3), 4: (8, 400, 3), 5: (8, 400, 3)}, true_conf: {3: (8, 76, 76, 3, 1), 4: (8, 38, 38, 3, 1), 5: (8, 19, 19, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>I0406 15:55:35.136013 140690734946112 controller.py:362] restoring or initializing model...
I0406 15:55:41.650499 140690734946112 yolo.py:456] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0406 15:55:41.653740 140690734946112 controller.py:368] initialized model.
I0406 15:55:41.654065 140690734946112 train_lib.py:96] Starts to execute mode: train_and_eval
I0406 15:55:41.659303 140690734946112 controller.py:211] train | step:      0 | training until step 20000...
I0406 15:55:49.931537 140690734946112 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0406 15:56:28.403511 140690734946112 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0406 18:09:18.600559 140690734946112 controller.py:425] train | step:  20000 | steps/sec:    2.5 | output: 
    {'avg_iou_3': 0.567349,
     'avg_iou_4': 0.6636099,
     'avg_iou_5': 0.7268835,
     'avg_obj_3': 0.12133879,
     'avg_obj_4': 0.21891887,
     'avg_obj_5': 0.3432673,
     'box_loss_3': 0.017345909,
     'box_loss_4': 0.015467392,
     'box_loss_5': 0.0137677975,
     'class_loss_3': 0.020024102,
     'class_loss_4': 0.019775141,
     'class_loss_5': 0.018399665,
     'conf_loss_3': 0.0927376,
     'conf_loss_4': 0.036263566,
     'conf_loss_5': 0.022029808,
     'learning_rate': 0.0009814516,
     'recall50_3': 0.042836413,
     'recall50_4': 0.14185499,
     'recall50_5': 0.30661336,
     'total_loss': 2.0464914,
     'training_loss': 2.0464914}
I0406 18:10:15.451388 140690734946112 controller.py:455] saved checkpoint to gs://tensorflow2/full_cfg_exp/yolov4-coco-adam-mo2017-epoch-letterbox/ckpt-20000.
I0406 18:10:15.458001 140690734946112 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0406 18:10:16.066633 140690734946112 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0406 18:10:32.035353 140690734946112 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0406 18:15:09.688732 140690734946112 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0406 18:19:24.250703 140690734946112 controller.py:261]  eval | step:  20000 | eval time:  548.8 sec | output: 
    {'AP': 0.308893,
     'AP50': 0.48592693,
     'AP75': 0.32656038,
     'APl': 0.40977702,
     'APm': 0.2744929,
     'APs': 0.098971434,
     'ARl': 0.6297235,
     'ARm': 0.49893767,
     'ARmax1': 0.28000998,
     'ARmax10': 0.46903533,
     'ARmax100': 0.5161102,
     'ARs': 0.24402958,
     'avg_iou_3': 0.44156918,
     'avg_iou_4': 0.65527165,
     'avg_iou_5': 0.79347444,
     'avg_obj_3': 0.1471944,
     'avg_obj_4': 0.3127823,
     'avg_obj_5': 0.4755656,
     'box_loss_3': 0.00847491,
     'box_loss_4': 0.009213036,
     'box_loss_5': 0.008774452,
     'class_loss_3': 0.0038934285,
     'class_loss_4': 0.0046679275,
     'class_loss_5': 0.004858371,
     'conf_loss_3': 0.007286479,
     'conf_loss_4': 0.009088726,
     'conf_loss_5': 0.009882309,
     'recall50_3': 0.11912626,
     'recall50_4': 0.31554282,
     'recall50_5': 0.51854485,
     'total_loss': 0.06613964,
     'validation_loss': 0.06613964}
I0406 18:19:43.276132 140690734946112 controller.py:211] train | step:  20000 | training until step 40000...
I0406 20:29:55.456802 140690734946112 controller.py:425] train | step:  40000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.6270179,
     'avg_iou_4': 0.7336218,
     'avg_iou_5': 0.7968143,
     'avg_obj_3': 0.17036484,
     'avg_obj_4': 0.30375445,
     'avg_obj_5': 0.451807,
     'box_loss_3': 0.014862839,
     'box_loss_4': 0.012081624,
     'box_loss_5': 0.010069195,
     'class_loss_3': 0.007817676,
     'class_loss_4': 0.0074168365,
     'class_loss_5': 0.0071744546,
     'conf_loss_3': 0.019151077,
     'conf_loss_4': 0.020153243,
     'conf_loss_5': 0.015454161,
     'learning_rate': 0.0009275264,
     'recall50_3': 0.08180434,
     'recall50_4': 0.24845815,
     'recall50_5': 0.46248764,
     'total_loss': 0.91345155,
     'training_loss': 0.91345155}
I0406 20:30:55.271479 140690734946112 controller.py:455] saved checkpoint to gs://tensorflow2/full_cfg_exp/yolov4-coco-adam-mo2017-epoch-letterbox/ckpt-40000.
I0406 20:30:55.277363 140690734946112 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0406 20:35:01.616310 140690734946112 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0406 20:39:17.316053 140690734946112 controller.py:261]  eval | step:  40000 | eval time:  502.0 sec | output: 
    {'AP': 0.3665823,
     'AP50': 0.55726963,
     'AP75': 0.39061975,
     'APl': 0.486546,
     'APm': 0.32942823,
     'APs': 0.131492,
     'ARl': 0.678334,
     'ARm': 0.5453425,
     'ARmax1': 0.30985504,
     'ARmax10': 0.5124133,
     'ARmax100': 0.5596315,
     'ARs': 0.28698662,
     'avg_iou_3': 0.45073813,
     'avg_iou_4': 0.66995645,
     'avg_iou_5': 0.8105657,
     'avg_obj_3': 0.17029822,
     'avg_obj_4': 0.35500607,
     'avg_obj_5': 0.5360279,
     'box_loss_3': 0.008016152,
     'box_loss_4': 0.008466782,
     'box_loss_5': 0.007905016,
     'class_loss_3': 0.0030427447,
     'class_loss_4': 0.0036264183,
     'class_loss_5': 0.003742995,
     'conf_loss_3': 0.007143643,
     'conf_loss_4': 0.009105274,
     'conf_loss_5': 0.010114655,
     'recall50_3': 0.15021984,
     'recall50_4': 0.36973062,
     'recall50_5': 0.5932907,
     'total_loss': 0.061163682,
     'validation_loss': 0.061163682}
I0406 20:39:33.373481 140690734946112 controller.py:211] train | step:  40000 | training until step 60000...
I0406 22:55:07.959867 140690734946112 controller.py:425] train | step:  60000 | steps/sec:    2.3 | output: 
    {'avg_iou_3': 0.64299905,
     'avg_iou_4': 0.7528348,
     'avg_iou_5': 0.81451124,
     'avg_obj_3': 0.19562028,
     'avg_obj_4': 0.34042162,
     'avg_obj_5': 0.49238148,
     'box_loss_3': 0.014206764,
     'box_loss_4': 0.011174682,
     'box_loss_5': 0.0091543095,
     'class_loss_3': 0.00671941,
     'class_loss_4': 0.0061433376,
     'class_loss_5': 0.005902931,
     'conf_loss_3': 0.018488245,
     'conf_loss_4': 0.019207517,
     'conf_loss_5': 0.014515843,
     'learning_rate': 0.00083986454,
     'recall50_3': 0.10439994,
     'recall50_4': 0.29401538,
     'recall50_5': 0.5142092,
     'total_loss': 0.8441049,
     'training_loss': 0.8441049}
I0406 22:56:06.944418 140690734946112 controller.py:455] saved checkpoint to gs://tensorflow2/full_cfg_exp/yolov4-coco-adam-mo2017-epoch-letterbox/ckpt-60000.
I0406 22:56:06.952776 140690734946112 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0406 23:00:16.117042 140690734946112 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.

{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 608, 608, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 76, 76, 3, 1), 4: (1, 38, 38, 3, 1), 5: (1, 19, 19, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
train | step:  20000 | steps/sec:    2.5 | output: 
    {'avg_iou_3': 0.567349,
     'avg_iou_4': 0.6636099,
     'avg_iou_5': 0.7268835,
     'avg_obj_3': 0.12133879,
     'avg_obj_4': 0.21891887,
     'avg_obj_5': 0.3432673,
     'box_loss_3': 0.017345909,
     'box_loss_4': 0.015467392,
     'box_loss_5': 0.0137677975,
     'class_loss_3': 0.020024102,
     'class_loss_4': 0.019775141,
     'class_loss_5': 0.018399665,
     'conf_loss_3': 0.0927376,
     'conf_loss_4': 0.036263566,
     'conf_loss_5': 0.022029808,
     'learning_rate': 0.0009814516,
     'recall50_3': 0.042836413,
     'recall50_4': 0.14185499,
     'recall50_5': 0.30661336,
     'total_loss': 2.0464914,
     'training_loss': 2.0464914}
saved checkpoint to gs://tensorflow2/full_cfg_exp/yolov4-coco-adam-mo2017-epoch-letterbox/ckpt-20000.
 eval | step:  20000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=180.75s).
Accumulating evaluation results...
DONE (t=18.12s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.309
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.486
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.327
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.099
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.274
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.410
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.280
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.469
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.516
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.244
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.499
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.630
 eval | step:  20000 | eval time:  548.8 sec | output: 
    {'AP': 0.308893,
     'AP50': 0.48592693,
     'AP75': 0.32656038,
     'APl': 0.40977702,
     'APm': 0.2744929,
     'APs': 0.098971434,
     'ARl': 0.6297235,
     'ARm': 0.49893767,
     'ARmax1': 0.28000998,
     'ARmax10': 0.46903533,
     'ARmax100': 0.5161102,
     'ARs': 0.24402958,
     'avg_iou_3': 0.44156918,
     'avg_iou_4': 0.65527165,
     'avg_iou_5': 0.79347444,
     'avg_obj_3': 0.1471944,
     'avg_obj_4': 0.3127823,
     'avg_obj_5': 0.4755656,
     'box_loss_3': 0.00847491,
     'box_loss_4': 0.009213036,
     'box_loss_5': 0.008774452,
     'class_loss_3': 0.0038934285,
     'class_loss_4': 0.0046679275,
     'class_loss_5': 0.004858371,
     'conf_loss_3': 0.007286479,
     'conf_loss_4': 0.009088726,
     'conf_loss_5': 0.009882309,
     'recall50_3': 0.11912626,
     'recall50_4': 0.31554282,
     'recall50_5': 0.51854485,
     'total_loss': 0.06613964,
     'validation_loss': 0.06613964}
train | step:  20000 | training until step 40000...
train | step:  40000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.6270179,
     'avg_iou_4': 0.7336218,
     'avg_iou_5': 0.7968143,
     'avg_obj_3': 0.17036484,
     'avg_obj_4': 0.30375445,
     'avg_obj_5': 0.451807,
     'box_loss_3': 0.014862839,
     'box_loss_4': 0.012081624,
     'box_loss_5': 0.010069195,
     'class_loss_3': 0.007817676,
     'class_loss_4': 0.0074168365,
     'class_loss_5': 0.0071744546,
     'conf_loss_3': 0.019151077,
     'conf_loss_4': 0.020153243,
     'conf_loss_5': 0.015454161,
     'learning_rate': 0.0009275264,
     'recall50_3': 0.08180434,
     'recall50_4': 0.24845815,
     'recall50_5': 0.46248764,
     'total_loss': 0.91345155,
     'training_loss': 0.91345155}
saved checkpoint to gs://tensorflow2/full_cfg_exp/yolov4-coco-adam-mo2017-epoch-letterbox/ckpt-40000.
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=181.35s).
Accumulating evaluation results...
DONE (t=16.39s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.367
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.557
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.391
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.131
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.329
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.487
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.310
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.512
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.560
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.287
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.545
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.678
 eval | step:  40000 | eval time:  502.0 sec | output: 
    {'AP': 0.3665823,
     'AP50': 0.55726963,
     'AP75': 0.39061975,
     'APl': 0.486546,
     'APm': 0.32942823,
     'APs': 0.131492,
     'ARl': 0.678334,
     'ARm': 0.5453425,
     'ARmax1': 0.30985504,
     'ARmax10': 0.5124133,
     'ARmax100': 0.5596315,
     'ARs': 0.28698662,
     'avg_iou_3': 0.45073813,
     'avg_iou_4': 0.66995645,
     'avg_iou_5': 0.8105657,
     'avg_obj_3': 0.17029822,
     'avg_obj_4': 0.35500607,
     'avg_obj_5': 0.5360279,
     'box_loss_3': 0.008016152,
     'box_loss_4': 0.008466782,
     'box_loss_5': 0.007905016,
     'class_loss_3': 0.0030427447,
     'class_loss_4': 0.0036264183,
     'class_loss_5': 0.003742995,
     'conf_loss_3': 0.007143643,
     'conf_loss_4': 0.009105274,
     'conf_loss_5': 0.010114655,
     'recall50_3': 0.15021984,
     'recall50_4': 0.36973062,
     'recall50_5': 0.5932907,
     'total_loss': 0.061163682,
     'validation_loss': 0.061163682}
train | step:  40000 | training until step 60000...
train | step:  60000 | steps/sec:    2.3 | output: 
    {'avg_iou_3': 0.64299905,
     'avg_iou_4': 0.7528348,
     'avg_iou_5': 0.81451124,
     'avg_obj_3': 0.19562028,
     'avg_obj_4': 0.34042162,
     'avg_obj_5': 0.49238148,
     'box_loss_3': 0.014206764,
     'box_loss_4': 0.011174682,
     'box_loss_5': 0.0091543095,
     'class_loss_3': 0.00671941,
     'class_loss_4': 0.0061433376,
     'class_loss_5': 0.005902931,
     'conf_loss_3': 0.018488245,
     'conf_loss_4': 0.019207517,
     'conf_loss_5': 0.014515843,
     'learning_rate': 0.00083986454,
     'recall50_3': 0.10439994,
     'recall50_4': 0.29401538,
     'recall50_5': 0.5142092,
     'total_loss': 0.8441049,
     'training_loss': 0.8441049}
saved checkpoint to gs://tensorflow2/full_cfg_exp/yolov4-coco-adam-mo2017-epoch-letterbox/ckpt-60000.
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=174.62s).
Accumulating evaluation results...I0406 23:04:29.231696 140690734946112 controller.py:261]  eval | step:  60000 | eval time:  502.3 sec | output: 
    {'AP': 0.39007694,
     'AP50': 0.5846127,
     'AP75': 0.41821647,
     'APl': 0.51670164,
     'APm': 0.3562643,
     'APs': 0.14897744,
     'ARl': 0.69353193,
     'ARm': 0.5660374,
     'ARmax1': 0.3191945,
     'ARmax10': 0.5276421,
     'ARmax100': 0.5751359,
     'ARs': 0.29998064,
     'avg_iou_3': 0.45474526,
     'avg_iou_4': 0.67642796,
     'avg_iou_5': 0.8176948,
     'avg_obj_3': 0.18222971,
     'avg_obj_4': 0.37703806,
     'avg_obj_5': 0.56279314,
     'box_loss_3': 0.007814633,
     'box_loss_4': 0.008140464,
     'box_loss_5': 0.0075443788,
     'class_loss_3': 0.002749957,
     'class_loss_4': 0.0032333946,
     'class_loss_5': 0.003360312,
     'conf_loss_3': 0.00716744,
     'conf_loss_4': 0.009221906,
     'conf_loss_5': 0.01030161,
     'recall50_3': 0.16737248,
     'recall50_4': 0.39671928,
     'recall50_5': 0.6242972,
     'total_loss': 0.059534095,
     'validation_loss': 0.059534095}
I0406 23:04:45.766007 140690734946112 controller.py:211] train | step:  60000 | training until step 80000...
I0407 01:19:04.250338 140690734946112 controller.py:425] train | step:  80000 | steps/sec:    2.3 | output: 
    {'avg_iou_3': 0.65245765,
     'avg_iou_4': 0.7640156,
     'avg_iou_5': 0.8249262,
     'avg_obj_3': 0.21174653,
     'avg_obj_4': 0.36420184,
     'avg_obj_5': 0.5179604,
     'box_loss_3': 0.013815796,
     'box_loss_4': 0.01065342,
     'box_loss_5': 0.008622091,
     'class_loss_3': 0.0060780966,
     'class_loss_4': 0.005425623,
     'class_loss_5': 0.0052078394,
     'conf_loss_3': 0.018049696,
     'conf_loss_4': 0.018574288,
     'conf_loss_5': 0.013900953,
     'learning_rate': 0.00073239586,
     'recall50_3': 0.11935962,
     'recall50_4': 0.32313183,
     'recall50_5': 0.5454021,
     'total_loss': 0.8026251,
     'training_loss': 0.8026251}
I0407 01:20:04.653592 140690734946112 controller.py:455] saved checkpoint to gs://tensorflow2/full_cfg_exp/yolov4-coco-adam-mo2017-epoch-letterbox/ckpt-80000.
I0407 01:20:04.660477 140690734946112 controller.py:252]  eval | step:  80000 | running 625 steps of evaluation...
I0407 01:24:16.824555 140690734946112 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0407 01:28:17.351753 140690734946112 controller.py:261]  eval | step:  80000 | eval time:  492.7 sec | output: 
    {'AP': 0.40282312,
     'AP50': 0.59872144,
     'AP75': 0.43246692,
     'APl': 0.5330745,
     'APm': 0.36747393,
     'APs': 0.1548392,
     'ARl': 0.70118517,
     'ARm': 0.5765673,
     'ARmax1': 0.32699773,
     'ARmax10': 0.5362836,
     'ARmax100': 0.5853003,
     'ARs': 0.32143024,
     'avg_iou_3': 0.45675868,
     'avg_iou_4': 0.6791044,
     'avg_iou_5': 0.82118934,
     'avg_obj_3': 0.18972681,
     'avg_obj_4': 0.39111,
     'avg_obj_5': 0.5796704,
     'box_loss_3': 0.0077124764,
     'box_loss_4': 0.008004826,
     'box_loss_5': 0.0073659294,
     'class_loss_3': 0.0026284913,
     'class_loss_4': 0.0031073338,
     'class_loss_5': 0.0031834843,
     'conf_loss_3': 0.007180976,
     'conf_loss_4': 0.009334858,
     'conf_loss_5': 0.010502513,
     'recall50_3': 0.17716654,
     'recall50_4': 0.41832358,
     'recall50_5': 0.63973457,
     'total_loss': 0.059020888,
     'validation_loss': 0.059020888}
I0407 01:28:34.575248 140690734946112 controller.py:211] train | step:  80000 | training until step 100000...
I0407 03:37:02.978846 140690734946112 controller.py:425] train | step:  100000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.65999615,
     'avg_iou_4': 0.772321,
     'avg_iou_5': 0.83265597,
     'avg_obj_3': 0.22512516,
     'avg_obj_4': 0.382763,
     'avg_obj_5': 0.5380262,
     'box_loss_3': 0.013493242,
     'box_loss_4': 0.0102445735,
     'box_loss_5': 0.008218218,
     'class_loss_3': 0.005620673,
     'class_loss_4': 0.0049113347,
     'class_loss_5': 0.004701795,
     'conf_loss_3': 0.01763869,
     'conf_loss_4': 0.01803034,
     'conf_loss_5': 0.013379449,
     'learning_rate': 0.0006084332,
     'recall50_3': 0.13168222,
     'recall50_4': 0.34559375,
     'recall50_5': 0.5697936,
     'total_loss': 0.7699066,
     'training_loss': 0.7699066}
I0407 03:37:59.986559 140690734946112 controller.py:455] saved checkpoint to gs://tensorflow2/full_cfg_exp/yolov4-coco-adam-mo2017-epoch-letterbox/ckpt-100000.
I0407 03:37:59.993324 140690734946112 controller.py:252]  eval | step:  100000 | running 625 steps of evaluation...
I0407 03:42:12.886928 140690734946112 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0407 03:46:20.118647 140690734946112 controller.py:261]  eval | step:  100000 | eval time:  500.1 sec | output: 
    {'AP': 0.4098175,
     'AP50': 0.6058648,
     'AP75': 0.43917114,
     'APl': 0.53938997,
     'APm': 0.3741947,
     'APs': 0.16008072,
     'ARl': 0.7091619,
     'ARm': 0.5814924,
     'ARmax1': 0.33064887,
     'ARmax10': 0.5428183,
     'ARmax100': 0.59098697,
     'ARs': 0.32589376,
     'avg_iou_3': 0.45805752,
     'avg_iou_4': 0.6810381,
     'avg_iou_5': 0.82277304,
     'avg_obj_3': 0.19375627,
     'avg_obj_4': 0.39817625,
     'avg_obj_5': 0.58807623,
     'box_loss_3': 0.0076457113,
     'box_loss_4': 0.0079084225,
     'box_loss_5': 0.0072841546,
     'class_loss_3': 0.0025983895,
     'class_loss_4': 0.0030113151,
     'class_loss_5': 0.0031152174,
     'conf_loss_3': 0.007150748,
     'conf_loss_4': 0.009374833,
     'conf_loss_5': 0.010579314,
     'recall50_3': 0.18280305,
     'recall50_4': 0.42461538,
     'recall50_5': 0.64480793,
     'total_loss': 0.058668103,
     'validation_loss': 0.058668103}
I0407 03:46:38.167003 140690734946112 controller.py:211] train | step:  100000 | training until step 120000...
I0407 05:55:34.402223 140690734946112 controller.py:425] train | step:  120000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.6657047,
     'avg_iou_4': 0.77903855,
     'avg_iou_5': 0.8390393,
     'avg_obj_3': 0.23654611,
     'avg_obj_4': 0.3992162,
     'avg_obj_5': 0.55621,
     'box_loss_3': 0.013263243,
     'box_loss_4': 0.00994004,
     'box_loss_5': 0.007893469,
     'class_loss_3': 0.005261522,
     'class_loss_4': 0.0045124143,
     'class_loss_5': 0.0043114964,
     'conf_loss_3': 0.017368253,
     'conf_loss_4': 0.01760117,
     'conf_loss_5': 0.012929976,
     'learning_rate': 0.0004876749,
     'recall50_3': 0.14276095,
     'recall50_4': 0.36557084,
     'recall50_5': 0.59079933,
     'total_loss': 0.74465305,
     'training_loss': 0.74465305}

DONE (t=18.54s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.390
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.585
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.418
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.149
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.356
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.517
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.319
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.528
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.575
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.300
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.566
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.694
 eval | step:  60000 | eval time:  502.3 sec | output: 
    {'AP': 0.39007694,
     'AP50': 0.5846127,
     'AP75': 0.41821647,
     'APl': 0.51670164,
     'APm': 0.3562643,
     'APs': 0.14897744,
     'ARl': 0.69353193,
     'ARm': 0.5660374,
     'ARmax1': 0.3191945,
     'ARmax10': 0.5276421,
     'ARmax100': 0.5751359,
     'ARs': 0.29998064,
     'avg_iou_3': 0.45474526,
     'avg_iou_4': 0.67642796,
     'avg_iou_5': 0.8176948,
     'avg_obj_3': 0.18222971,
     'avg_obj_4': 0.37703806,
     'avg_obj_5': 0.56279314,
     'box_loss_3': 0.007814633,
     'box_loss_4': 0.008140464,
     'box_loss_5': 0.0075443788,
     'class_loss_3': 0.002749957,
     'class_loss_4': 0.0032333946,
     'class_loss_5': 0.003360312,
     'conf_loss_3': 0.00716744,
     'conf_loss_4': 0.009221906,
     'conf_loss_5': 0.01030161,
     'recall50_3': 0.16737248,
     'recall50_4': 0.39671928,
     'recall50_5': 0.6242972,
     'total_loss': 0.059534095,
     'validation_loss': 0.059534095}
train | step:  60000 | training until step 80000...
train | step:  80000 | steps/sec:    2.3 | output: 
    {'avg_iou_3': 0.65245765,
     'avg_iou_4': 0.7640156,
     'avg_iou_5': 0.8249262,
     'avg_obj_3': 0.21174653,
     'avg_obj_4': 0.36420184,
     'avg_obj_5': 0.5179604,
     'box_loss_3': 0.013815796,
     'box_loss_4': 0.01065342,
     'box_loss_5': 0.008622091,
     'class_loss_3': 0.0060780966,
     'class_loss_4': 0.005425623,
     'class_loss_5': 0.0052078394,
     'conf_loss_3': 0.018049696,
     'conf_loss_4': 0.018574288,
     'conf_loss_5': 0.013900953,
     'learning_rate': 0.00073239586,
     'recall50_3': 0.11935962,
     'recall50_4': 0.32313183,
     'recall50_5': 0.5454021,
     'total_loss': 0.8026251,
     'training_loss': 0.8026251}
saved checkpoint to gs://tensorflow2/full_cfg_exp/yolov4-coco-adam-mo2017-epoch-letterbox/ckpt-80000.
 eval | step:  80000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=174.65s).
Accumulating evaluation results...
DONE (t=14.61s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.403
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.599
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.432
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.155
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.367
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.533
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.327
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.536
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.585
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.321
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.577
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.701
 eval | step:  80000 | eval time:  492.7 sec | output: 
    {'AP': 0.40282312,
     'AP50': 0.59872144,
     'AP75': 0.43246692,
     'APl': 0.5330745,
     'APm': 0.36747393,
     'APs': 0.1548392,
     'ARl': 0.70118517,
     'ARm': 0.5765673,
     'ARmax1': 0.32699773,
     'ARmax10': 0.5362836,
     'ARmax100': 0.5853003,
     'ARs': 0.32143024,
     'avg_iou_3': 0.45675868,
     'avg_iou_4': 0.6791044,
     'avg_iou_5': 0.82118934,
     'avg_obj_3': 0.18972681,
     'avg_obj_4': 0.39111,
     'avg_obj_5': 0.5796704,
     'box_loss_3': 0.0077124764,
     'box_loss_4': 0.008004826,
     'box_loss_5': 0.0073659294,
     'class_loss_3': 0.0026284913,
     'class_loss_4': 0.0031073338,
     'class_loss_5': 0.0031834843,
     'conf_loss_3': 0.007180976,
     'conf_loss_4': 0.009334858,
     'conf_loss_5': 0.010502513,
     'recall50_3': 0.17716654,
     'recall50_4': 0.41832358,
     'recall50_5': 0.63973457,
     'total_loss': 0.059020888,
     'validation_loss': 0.059020888}
train | step:  80000 | training until step 100000...
train | step:  100000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.65999615,
     'avg_iou_4': 0.772321,
     'avg_iou_5': 0.83265597,
     'avg_obj_3': 0.22512516,
     'avg_obj_4': 0.382763,
     'avg_obj_5': 0.5380262,
     'box_loss_3': 0.013493242,
     'box_loss_4': 0.0102445735,
     'box_loss_5': 0.008218218,
     'class_loss_3': 0.005620673,
     'class_loss_4': 0.0049113347,
     'class_loss_5': 0.004701795,
     'conf_loss_3': 0.01763869,
     'conf_loss_4': 0.01803034,
     'conf_loss_5': 0.013379449,
     'learning_rate': 0.0006084332,
     'recall50_3': 0.13168222,
     'recall50_4': 0.34559375,
     'recall50_5': 0.5697936,
     'total_loss': 0.7699066,
     'training_loss': 0.7699066}
saved checkpoint to gs://tensorflow2/full_cfg_exp/yolov4-coco-adam-mo2017-epoch-letterbox/ckpt-100000.
 eval | step:  100000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.00s).
Accumulating evaluation results...
DONE (t=13.77s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.410
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.606
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.439
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.160
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.374
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.539
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.331
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.543
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.591
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.326
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.581
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.709
 eval | step:  100000 | eval time:  500.1 sec | output: 
    {'AP': 0.4098175,
     'AP50': 0.6058648,
     'AP75': 0.43917114,
     'APl': 0.53938997,
     'APm': 0.3741947,
     'APs': 0.16008072,
     'ARl': 0.7091619,
     'ARm': 0.5814924,
     'ARmax1': 0.33064887,
     'ARmax10': 0.5428183,
     'ARmax100': 0.59098697,
     'ARs': 0.32589376,
     'avg_iou_3': 0.45805752,
     'avg_iou_4': 0.6810381,
     'avg_iou_5': 0.82277304,
     'avg_obj_3': 0.19375627,
     'avg_obj_4': 0.39817625,
     'avg_obj_5': 0.58807623,
     'box_loss_3': 0.0076457113,
     'box_loss_4': 0.0079084225,
     'box_loss_5': 0.0072841546,
     'class_loss_3': 0.0025983895,
     'class_loss_4': 0.0030113151,
     'class_loss_5': 0.0031152174,
     'conf_loss_3': 0.007150748,
     'conf_loss_4': 0.009374833,
     'conf_loss_5': 0.010579314,
     'recall50_3': 0.18280305,
     'recall50_4': 0.42461538,
     'recall50_5': 0.64480793,
     'total_loss': 0.058668103,
     'validation_loss': 0.058668103}
train | step:  100000 | training until step 120000...
train | step:  120000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.6657047,
     'avg_iou_4': 0.77903855,
     'avg_iou_5': 0.8390393,
     'avg_obj_3': 0.23654611,
     'avg_obj_4': 0.3992162,
     'avg_obj_5': 0.55621,
     'box_loss_3': 0.013263243,
     'box_loss_4': 0.00994004,
     'box_loss_5': 0.007893469,
     'class_loss_3': 0.005261522,
     'class_loss_4': 0.0045124143,
     'class_loss_5': 0.0043114964,
     'conf_loss_3': 0.017368253,
     'conf_loss_4': 0.01760117,
     'conf_loss_5': 0.012929976,
     'learning_rate': 0.0004876749,
     'recall50_3': 0.14276095,
     'recall50_4': 0.36557084,
     'recall50_5': 0.59079933,
     'total_loss': 0.74465305,
     'training_loss': 0.74465305}I0407 05:56:35.514587 140690734946112 controller.py:455] saved checkpoint to gs://tensorflow2/full_cfg_exp/yolov4-coco-adam-mo2017-epoch-letterbox/ckpt-120000.
I0407 05:56:35.521040 140690734946112 controller.py:252]  eval | step:  120000 | running 625 steps of evaluation...
I0407 06:00:43.710389 140690734946112 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0407 06:04:52.354537 140690734946112 controller.py:261]  eval | step:  120000 | eval time:  496.8 sec | output: 
    {'AP': 0.41059202,
     'AP50': 0.6059398,
     'AP75': 0.44020402,
     'APl': 0.5421552,
     'APm': 0.3746386,
     'APs': 0.16074876,
     'ARl': 0.7071573,
     'ARm': 0.582658,
     'ARmax1': 0.33190703,
     'ARmax10': 0.54525405,
     'ARmax100': 0.5935607,
     'ARs': 0.34194094,
     'avg_iou_3': 0.45874062,
     'avg_iou_4': 0.68169475,
     'avg_iou_5': 0.8230022,
     'avg_obj_3': 0.19689608,
     'avg_obj_4': 0.40365905,
     'avg_obj_5': 0.59324884,
     'box_loss_3': 0.007611387,
     'box_loss_4': 0.007875762,
     'box_loss_5': 0.007274334,
     'class_loss_3': 0.0025827861,
     'class_loss_4': 0.0030057018,
     'class_loss_5': 0.0031018283,
     'conf_loss_3': 0.007141108,
     'conf_loss_4': 0.0094038285,
     'conf_loss_5': 0.01068854,
     'recall50_3': 0.18879248,
     'recall50_4': 0.43345132,
     'recall50_5': 0.6523266,
     'total_loss': 0.058685247,
     'validation_loss': 0.058685247}
I0407 06:05:08.015732 140690734946112 controller.py:211] train | step:  120000 | training until step 140000...
I0407 08:15:24.015523 140690734946112 controller.py:425] train | step:  140000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.6707022,
     'avg_iou_4': 0.784771,
     'avg_iou_5': 0.8445898,
     'avg_obj_3': 0.246854,
     'avg_obj_4': 0.41388568,
     'avg_obj_5': 0.57220083,
     'box_loss_3': 0.013066519,
     'box_loss_4': 0.009672197,
     'box_loss_5': 0.0076135444,
     'class_loss_3': 0.004979882,
     'class_loss_4': 0.0042049796,
     'class_loss_5': 0.004006136,
     'conf_loss_3': 0.017092023,
     'conf_loss_4': 0.017195512,
     'conf_loss_5': 0.012520235,
     'learning_rate': 0.0003773339,
     'recall50_3': 0.15268508,
     'recall50_4': 0.38322085,
     'recall50_5': 0.6093424,
     'total_loss': 0.72281003,
     'training_loss': 0.72281003}
I0407 08:16:22.264232 140690734946112 controller.py:455] saved checkpoint to gs://tensorflow2/full_cfg_exp/yolov4-coco-adam-mo2017-epoch-letterbox/ckpt-140000.
I0407 08:16:22.270055 140690734946112 controller.py:252]  eval | step:  140000 | running 625 steps of evaluation...
I0407 08:20:31.766103 140690734946112 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0407 08:24:29.944949 140690734946112 controller.py:261]  eval | step:  140000 | eval time:  487.7 sec | output: 
    {'AP': 0.41164225,
     'AP50': 0.6076705,
     'AP75': 0.442951,
     'APl': 0.5387319,
     'APm': 0.37666476,
     'APs': 0.16263738,
     'ARl': 0.7090555,
     'ARm': 0.5805438,
     'ARmax1': 0.33221373,
     'ARmax10': 0.5465097,
     'ARmax100': 0.5935742,
     'ARs': 0.33589765,
     'avg_iou_3': 0.4592048,
     'avg_iou_4': 0.6815919,
     'avg_iou_5': 0.8229963,
     'avg_obj_3': 0.20004185,
     'avg_obj_4': 0.4070001,
     'avg_obj_5': 0.59658426,
     'box_loss_3': 0.007589162,
     'box_loss_4': 0.007882312,
     'box_loss_5': 0.0072756563,
     'class_loss_3': 0.002627573,
     'class_loss_4': 0.0031063855,
     'class_loss_5': 0.0031578026,
     'conf_loss_3': 0.0071395584,
     'conf_loss_4': 0.009442169,
     'conf_loss_5': 0.010775088,
     'recall50_3': 0.19145271,
     'recall50_4': 0.43959165,
     'recall50_5': 0.6539893,
     'total_loss': 0.05899569,
     'validation_loss': 0.05899569}
I0407 08:24:45.800506 140690734946112 controller.py:211] train | step:  140000 | training until step 160000...
I0407 10:35:17.366609 140690734946112 controller.py:425] train | step:  160000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.67441565,
     'avg_iou_4': 0.78928363,
     'avg_iou_5': 0.8491037,
     'avg_obj_3': 0.25529358,
     'avg_obj_4': 0.42605078,
     'avg_obj_5': 0.58602047,
     'box_loss_3': 0.0129150925,
     'box_loss_4': 0.009457084,
     'box_loss_5': 0.0073831575,
     'class_loss_3': 0.0047427276,
     'class_loss_4': 0.0039524343,
     'class_loss_5': 0.003762415,
     'conf_loss_3': 0.016844861,
     'conf_loss_4': 0.016833859,
     'conf_loss_5': 0.012150311,
     'learning_rate': 0.0002850266,
     'recall50_3': 0.16078654,
     'recall50_4': 0.39806357,
     'recall50_5': 0.6245108,
     'total_loss': 0.70433587,
     'training_loss': 0.70433587}
I0407 10:36:16.542141 140690734946112 controller.py:455] saved checkpoint to gs://tensorflow2/full_cfg_exp/yolov4-coco-adam-mo2017-epoch-letterbox/ckpt-160000.
I0407 10:36:16.548021 140690734946112 controller.py:252]  eval | step:  160000 | running 625 steps of evaluation...
I0407 10:40:28.961329 140690734946112 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0407 10:44:44.709006 140690734946112 controller.py:261]  eval | step:  160000 | eval time:  508.2 sec | output: 
    {'AP': 0.41087615,
     'AP50': 0.6073761,
     'AP75': 0.4399548,
     'APl': 0.54068637,
     'APm': 0.3759787,
     'APs': 0.16506518,
     'ARl': 0.7063496,
     'ARm': 0.58052117,
     'ARmax1': 0.332947,
     'ARmax10': 0.5444281,
     'ARmax100': 0.5922592,
     'ARs': 0.33847395,
     'avg_iou_3': 0.45963183,
     'avg_iou_4': 0.68120396,
     'avg_iou_5': 0.8225291,
     'avg_obj_3': 0.20087202,
     'avg_obj_4': 0.40935558,
     'avg_obj_5': 0.5994151,
     'box_loss_3': 0.007568313,
     'box_loss_4': 0.007901131,
     'box_loss_5': 0.0073012896,
     'class_loss_3': 0.0026641593,
     'class_loss_4': 0.0031054341,
     'class_loss_5': 0.003186661,
     'conf_loss_3': 0.00716188,
     'conf_loss_4': 0.009484148,
     'conf_loss_5': 0.010837456,
     'recall50_3': 0.19387564,
     'recall50_4': 0.44105166,
     'recall50_5': 0.65622956,
     'total_loss': 0.05921047,
     'validation_loss': 0.05921047}

saved checkpoint to gs://tensorflow2/full_cfg_exp/yolov4-coco-adam-mo2017-epoch-letterbox/ckpt-120000.
 eval | step:  120000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=177.18s).
Accumulating evaluation results...
DONE (t=13.29s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.411
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.606
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.440
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.161
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.375
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.542
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.332
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.545
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.594
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.342
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.583
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.707
 eval | step:  120000 | eval time:  496.8 sec | output: 
    {'AP': 0.41059202,
     'AP50': 0.6059398,
     'AP75': 0.44020402,
     'APl': 0.5421552,
     'APm': 0.3746386,
     'APs': 0.16074876,
     'ARl': 0.7071573,
     'ARm': 0.582658,
     'ARmax1': 0.33190703,
     'ARmax10': 0.54525405,
     'ARmax100': 0.5935607,
     'ARs': 0.34194094,
     'avg_iou_3': 0.45874062,
     'avg_iou_4': 0.68169475,
     'avg_iou_5': 0.8230022,
     'avg_obj_3': 0.19689608,
     'avg_obj_4': 0.40365905,
     'avg_obj_5': 0.59324884,
     'box_loss_3': 0.007611387,
     'box_loss_4': 0.007875762,
     'box_loss_5': 0.007274334,
     'class_loss_3': 0.0025827861,
     'class_loss_4': 0.0030057018,
     'class_loss_5': 0.0031018283,
     'conf_loss_3': 0.007141108,
     'conf_loss_4': 0.0094038285,
     'conf_loss_5': 0.01068854,
     'recall50_3': 0.18879248,
     'recall50_4': 0.43345132,
     'recall50_5': 0.6523266,
     'total_loss': 0.058685247,
     'validation_loss': 0.058685247}
train | step:  120000 | training until step 140000...
train | step:  140000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.6707022,
     'avg_iou_4': 0.784771,
     'avg_iou_5': 0.8445898,
     'avg_obj_3': 0.246854,
     'avg_obj_4': 0.41388568,
     'avg_obj_5': 0.57220083,
     'box_loss_3': 0.013066519,
     'box_loss_4': 0.009672197,
     'box_loss_5': 0.0076135444,
     'class_loss_3': 0.004979882,
     'class_loss_4': 0.0042049796,
     'class_loss_5': 0.004006136,
     'conf_loss_3': 0.017092023,
     'conf_loss_4': 0.017195512,
     'conf_loss_5': 0.012520235,
     'learning_rate': 0.0003773339,
     'recall50_3': 0.15268508,
     'recall50_4': 0.38322085,
     'recall50_5': 0.6093424,
     'total_loss': 0.72281003,
     'training_loss': 0.72281003}
saved checkpoint to gs://tensorflow2/full_cfg_exp/yolov4-coco-adam-mo2017-epoch-letterbox/ckpt-140000.
 eval | step:  140000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=175.84s).
Accumulating evaluation results...
DONE (t=13.04s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.412
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.608
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.443
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.163
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.377
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.539
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.332
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.547
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.594
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.336
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.581
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.709
 eval | step:  140000 | eval time:  487.7 sec | output: 
    {'AP': 0.41164225,
     'AP50': 0.6076705,
     'AP75': 0.442951,
     'APl': 0.5387319,
     'APm': 0.37666476,
     'APs': 0.16263738,
     'ARl': 0.7090555,
     'ARm': 0.5805438,
     'ARmax1': 0.33221373,
     'ARmax10': 0.5465097,
     'ARmax100': 0.5935742,
     'ARs': 0.33589765,
     'avg_iou_3': 0.4592048,
     'avg_iou_4': 0.6815919,
     'avg_iou_5': 0.8229963,
     'avg_obj_3': 0.20004185,
     'avg_obj_4': 0.4070001,
     'avg_obj_5': 0.59658426,
     'box_loss_3': 0.007589162,
     'box_loss_4': 0.007882312,
     'box_loss_5': 0.0072756563,
     'class_loss_3': 0.002627573,
     'class_loss_4': 0.0031063855,
     'class_loss_5': 0.0031578026,
     'conf_loss_3': 0.0071395584,
     'conf_loss_4': 0.009442169,
     'conf_loss_5': 0.010775088,
     'recall50_3': 0.19145271,
     'recall50_4': 0.43959165,
     'recall50_5': 0.6539893,
     'total_loss': 0.05899569,
     'validation_loss': 0.05899569}
train | step:  140000 | training until step 160000...
train | step:  160000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.67441565,
     'avg_iou_4': 0.78928363,
     'avg_iou_5': 0.8491037,
     'avg_obj_3': 0.25529358,
     'avg_obj_4': 0.42605078,
     'avg_obj_5': 0.58602047,
     'box_loss_3': 0.0129150925,
     'box_loss_4': 0.009457084,
     'box_loss_5': 0.0073831575,
     'class_loss_3': 0.0047427276,
     'class_loss_4': 0.0039524343,
     'class_loss_5': 0.003762415,
     'conf_loss_3': 0.016844861,
     'conf_loss_4': 0.016833859,
     'conf_loss_5': 0.012150311,
     'learning_rate': 0.0002850266,
     'recall50_3': 0.16078654,
     'recall50_4': 0.39806357,
     'recall50_5': 0.6245108,
     'total_loss': 0.70433587,
     'training_loss': 0.70433587}
saved checkpoint to gs://tensorflow2/full_cfg_exp/yolov4-coco-adam-mo2017-epoch-letterbox/ckpt-160000.
 eval | step:  160000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=186.00s).
Accumulating evaluation results...
DONE (t=13.45s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.411
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.607
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.440
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.165
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.376
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.541
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.333
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.544
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.592
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.338
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.581
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.706
 eval | step:  160000 | eval time:  508.2 sec | output: 
    {'AP': 0.41087615,
     'AP50': 0.6073761,
     'AP75': 0.4399548,
     'APl': 0.54068637,
     'APm': 0.3759787,
     'APs': 0.16506518,
     'ARl': 0.7063496,
     'ARm': 0.58052117,
     'ARmax1': 0.332947,
     'ARmax10': 0.5444281,
     'ARmax100': 0.5922592,
     'ARs': 0.33847395,
     'avg_iou_3': 0.45963183,
     'avg_iou_4': 0.68120396,
     'avg_iou_5': 0.8225291,
     'avg_obj_3': 0.20087202,
     'avg_obj_4': 0.40935558,
     'avg_obj_5': 0.5994151,
     'box_loss_3': 0.007568313,
     'box_loss_4': 0.007901131,
     'box_loss_5': 0.0073012896,
     'class_loss_3': 0.0026641593,
     'class_loss_4': 0.0031054341,
     'class_loss_5': 0.003186661,
     'conf_loss_3': 0.00716188,
     'conf_loss_4': 0.009484148,
     'conf_loss_5': 0.010837456,
     'recall50_3': 0.19387564,
     'recall50_4': 0.44105166,
     'recall50_5': 0.65622956,
     'total_loss': 0.05921047,
     'validation_loss': 0.05921047}I0407 10:45:00.263581 140690734946112 controller.py:211] train | step:  160000 | training until step 180000...
I0407 13:00:30.219137 140690734946112 controller.py:425] train | step:  180000 | steps/sec:    2.3 | output: 
    {'avg_iou_3': 0.6775603,
     'avg_iou_4': 0.7929014,
     'avg_iou_5': 0.85265964,
     'avg_obj_3': 0.26261988,
     'avg_obj_4': 0.43597862,
     'avg_obj_5': 0.5969329,
     'box_loss_3': 0.012793654,
     'box_loss_4': 0.009290798,
     'box_loss_5': 0.007202083,
     'class_loss_3': 0.004568237,
     'class_loss_4': 0.003771244,
     'class_loss_5': 0.0035678025,
     'conf_loss_3': 0.016626472,
     'conf_loss_4': 0.016524952,
     'conf_loss_5': 0.011846344,
     'learning_rate': 0.00022542146,
     'recall50_3': 0.16824333,
     'recall50_4': 0.40995434,
     'recall50_5': 0.6369121,
     'total_loss': 0.68953216,
     'training_loss': 0.68953216}
I0407 13:01:29.510092 140690734946112 controller.py:455] saved checkpoint to gs://tensorflow2/full_cfg_exp/yolov4-coco-adam-mo2017-epoch-letterbox/ckpt-180000.
I0407 13:01:29.517783 140690734946112 controller.py:252]  eval | step:  180000 | running 625 steps of evaluation...
I0407 13:05:48.236302 140690734946112 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0407 13:09:57.034683 140690734946112 controller.py:261]  eval | step:  180000 | eval time:  507.5 sec | output: 
    {'AP': 0.4106823,
     'AP50': 0.60746133,
     'AP75': 0.43857214,
     'APl': 0.5400344,
     'APm': 0.3769674,
     'APs': 0.16379537,
     'ARl': 0.7029155,
     'ARm': 0.5789262,
     'ARmax1': 0.3322803,
     'ARmax10': 0.54428244,
     'ARmax100': 0.59065306,
     'ARs': 0.33408496,
     'avg_iou_3': 0.45995644,
     'avg_iou_4': 0.6811868,
     'avg_iou_5': 0.82189655,
     'avg_obj_3': 0.20188682,
     'avg_obj_4': 0.41051954,
     'avg_obj_5': 0.6027194,
     'box_loss_3': 0.0075512067,
     'box_loss_4': 0.007902646,
     'box_loss_5': 0.0073349252,
     'class_loss_3': 0.0026446092,
     'class_loss_4': 0.0031649123,
     'class_loss_5': 0.0032599655,
     'conf_loss_3': 0.0071795913,
     'conf_loss_4': 0.009547294,
     'conf_loss_5': 0.010967576,
     'recall50_3': 0.19722079,
     'recall50_4': 0.44080395,
     'recall50_5': 0.6585703,
     'total_loss': 0.059552714,
     'validation_loss': 0.059552714}
I0407 13:10:31.788027 140690734946112 controller.py:211] train | step:  180000 | training until step 200000...
I0407 15:20:46.738857 140690734946112 controller.py:425] train | step:  200000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.67977995,
     'avg_iou_4': 0.79557544,
     'avg_iou_5': 0.85525733,
     'avg_obj_3': 0.26790026,
     'avg_obj_4': 0.4438348,
     'avg_obj_5': 0.60559165,
     'box_loss_3': 0.012675922,
     'box_loss_4': 0.009162085,
     'box_loss_5': 0.007072438,
     'class_loss_3': 0.004423995,
     'class_loss_4': 0.0036314342,
     'class_loss_5': 0.003438226,
     'conf_loss_3': 0.016472993,
     'conf_loss_4': 0.01630765,
     'conf_loss_5': 0.011620517,
     'learning_rate': 0.00020035561,
     'recall50_3': 0.17343386,
     'recall50_4': 0.41939244,
     'recall50_5': 0.6461818,
     'total_loss': 0.6784407,
     'training_loss': 0.6784407}
I0407 15:21:44.198429 140690734946112 controller.py:455] saved checkpoint to gs://tensorflow2/full_cfg_exp/yolov4-coco-adam-mo2017-epoch-letterbox/ckpt-200000.
I0407 15:21:44.204207 140690734946112 controller.py:252]  eval | step:  200000 | running 625 steps of evaluation...
I0407 15:26:03.166063 140690734946112 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0407 15:30:20.400388 140690734946112 controller.py:261]  eval | step:  200000 | eval time:  516.2 sec | output: 
    {'AP': 0.409417,
     'AP50': 0.6045912,
     'AP75': 0.43761972,
     'APl': 0.5376525,
     'APm': 0.37475124,
     'APs': 0.16128941,
     'ARl': 0.6985829,
     'ARm': 0.57543314,
     'ARmax1': 0.33082467,
     'ARmax10': 0.5419227,
     'ARmax100': 0.5886052,
     'ARs': 0.3361151,
     'avg_iou_3': 0.45983037,
     'avg_iou_4': 0.6803816,
     'avg_iou_5': 0.82113606,
     'avg_obj_3': 0.20271537,
     'avg_obj_4': 0.41212514,
     'avg_obj_5': 0.6034731,
     'box_loss_3': 0.007557737,
     'box_loss_4': 0.007944249,
     'box_loss_5': 0.0073747155,
     'class_loss_3': 0.0026685193,
     'class_loss_4': 0.0032060165,
     'class_loss_5': 0.0033179768,
     'conf_loss_3': 0.0071867555,
     'conf_loss_4': 0.009584328,
     'conf_loss_5': 0.011040838,
     'recall50_3': 0.19797766,
     'recall50_4': 0.44263956,
     'recall50_5': 0.6586959,
     'total_loss': 0.05988115,
     'validation_loss': 0.05988115}
I0407 15:30:35.793858 140690734946112 controller.py:211] train | step:  200000 | training until step 204000...
I0407 15:51:35.983330 140690734946112 controller.py:425] train | step:  204000 | steps/sec:    2.2 | output: 
    {'avg_iou_3': 0.68091184,
     'avg_iou_4': 0.7965959,
     'avg_iou_5': 0.856347,
     'avg_obj_3': 0.26950046,
     'avg_obj_4': 0.44643033,
     'avg_obj_5': 0.6089906,
     'box_loss_3': 0.012651848,
     'box_loss_4': 0.009121095,
     'box_loss_5': 0.0070242365,
     'class_loss_3': 0.0043822182,
     'class_loss_4': 0.0035841058,
     'class_loss_5': 0.0033845857,
     'conf_loss_3': 0.016402422,
     'conf_loss_4': 0.016215239,
     'conf_loss_5': 0.011516446,
     'learning_rate': 0.00020000001,
     'recall50_3': 0.17559066,
     'recall50_4': 0.42307392,
     'recall50_5': 0.64977896,
     'total_loss': 0.67425704,
     'training_loss': 0.67425704}
I0407 15:51:49.057098 140690734946112 controller.py:252]  eval | step:  204000 | running 625 steps of evaluation...
I0407 15:56:06.612572 140690734946112 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0407 16:00:02.981516 140690734946112 controller.py:261]  eval | step:  204000 | eval time:  493.9 sec | output: 
    {'AP': 0.4085198,
     'AP50': 0.6031214,
     'AP75': 0.4377852,
     'APl': 0.5374361,
     'APm': 0.37385705,
     'APs': 0.16237083,
     'ARl': 0.7025693,
     'ARm': 0.57474726,
     'ARmax1': 0.33037215,
     'ARmax10': 0.5426581,
     'ARmax100': 0.5905051,
     'ARs': 0.34313852,
     'avg_iou_3': 0.45974296,
     'avg_iou_4': 0.6804235,
     'avg_iou_5': 0.8210791,
     'avg_obj_3': 0.20253357,
     'avg_obj_4': 0.41253525,
     'avg_obj_5': 0.60424614,
     'box_loss_3': 0.0075621232,
     'box_loss_4': 0.0079417275,
     'box_loss_5': 0.007377498,
     'class_loss_3': 0.00268487,
     'class_loss_4': 0.0031970427,
     'class_loss_5': 0.0033399987,
     'conf_loss_3': 0.0071711657,
     'conf_loss_4': 0.009599835,
     'conf_loss_5': 0.011058949,
     'recall50_3': 0.19803889,
     'recall50_4': 0.44362003,
     'recall50_5': 0.6588623,
     'total_loss': 0.059933174,
     'validation_loss': 0.059933174}

train | step:  160000 | training until step 180000...
train | step:  180000 | steps/sec:    2.3 | output: 
    {'avg_iou_3': 0.6775603,
     'avg_iou_4': 0.7929014,
     'avg_iou_5': 0.85265964,
     'avg_obj_3': 0.26261988,
     'avg_obj_4': 0.43597862,
     'avg_obj_5': 0.5969329,
     'box_loss_3': 0.012793654,
     'box_loss_4': 0.009290798,
     'box_loss_5': 0.007202083,
     'class_loss_3': 0.004568237,
     'class_loss_4': 0.003771244,
     'class_loss_5': 0.0035678025,
     'conf_loss_3': 0.016626472,
     'conf_loss_4': 0.016524952,
     'conf_loss_5': 0.011846344,
     'learning_rate': 0.00022542146,
     'recall50_3': 0.16824333,
     'recall50_4': 0.40995434,
     'recall50_5': 0.6369121,
     'total_loss': 0.68953216,
     'training_loss': 0.68953216}
saved checkpoint to gs://tensorflow2/full_cfg_exp/yolov4-coco-adam-mo2017-epoch-letterbox/ckpt-180000.
 eval | step:  180000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=179.83s).
Accumulating evaluation results...
DONE (t=12.46s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.411
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.607
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.439
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.164
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.377
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.540
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.332
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.544
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.591
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.334
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.579
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.703
 eval | step:  180000 | eval time:  507.5 sec | output: 
    {'AP': 0.4106823,
     'AP50': 0.60746133,
     'AP75': 0.43857214,
     'APl': 0.5400344,
     'APm': 0.3769674,
     'APs': 0.16379537,
     'ARl': 0.7029155,
     'ARm': 0.5789262,
     'ARmax1': 0.3322803,
     'ARmax10': 0.54428244,
     'ARmax100': 0.59065306,
     'ARs': 0.33408496,
     'avg_iou_3': 0.45995644,
     'avg_iou_4': 0.6811868,
     'avg_iou_5': 0.82189655,
     'avg_obj_3': 0.20188682,
     'avg_obj_4': 0.41051954,
     'avg_obj_5': 0.6027194,
     'box_loss_3': 0.0075512067,
     'box_loss_4': 0.007902646,
     'box_loss_5': 0.0073349252,
     'class_loss_3': 0.0026446092,
     'class_loss_4': 0.0031649123,
     'class_loss_5': 0.0032599655,
     'conf_loss_3': 0.0071795913,
     'conf_loss_4': 0.009547294,
     'conf_loss_5': 0.010967576,
     'recall50_3': 0.19722079,
     'recall50_4': 0.44080395,
     'recall50_5': 0.6585703,
     'total_loss': 0.059552714,
     'validation_loss': 0.059552714}
train | step:  180000 | training until step 200000...
train | step:  200000 | steps/sec:    2.4 | output: 
    {'avg_iou_3': 0.67977995,
     'avg_iou_4': 0.79557544,
     'avg_iou_5': 0.85525733,
     'avg_obj_3': 0.26790026,
     'avg_obj_4': 0.4438348,
     'avg_obj_5': 0.60559165,
     'box_loss_3': 0.012675922,
     'box_loss_4': 0.009162085,
     'box_loss_5': 0.007072438,
     'class_loss_3': 0.004423995,
     'class_loss_4': 0.0036314342,
     'class_loss_5': 0.003438226,
     'conf_loss_3': 0.016472993,
     'conf_loss_4': 0.01630765,
     'conf_loss_5': 0.011620517,
     'learning_rate': 0.00020035561,
     'recall50_3': 0.17343386,
     'recall50_4': 0.41939244,
     'recall50_5': 0.6461818,
     'total_loss': 0.6784407,
     'training_loss': 0.6784407}
saved checkpoint to gs://tensorflow2/full_cfg_exp/yolov4-coco-adam-mo2017-epoch-letterbox/ckpt-200000.
 eval | step:  200000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=191.88s).
Accumulating evaluation results...
DONE (t=12.11s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.409
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.605
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.438
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.161
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.375
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.538
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.331
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.542
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.589
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.336
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.575
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.699
 eval | step:  200000 | eval time:  516.2 sec | output: 
    {'AP': 0.409417,
     'AP50': 0.6045912,
     'AP75': 0.43761972,
     'APl': 0.5376525,
     'APm': 0.37475124,
     'APs': 0.16128941,
     'ARl': 0.6985829,
     'ARm': 0.57543314,
     'ARmax1': 0.33082467,
     'ARmax10': 0.5419227,
     'ARmax100': 0.5886052,
     'ARs': 0.3361151,
     'avg_iou_3': 0.45983037,
     'avg_iou_4': 0.6803816,
     'avg_iou_5': 0.82113606,
     'avg_obj_3': 0.20271537,
     'avg_obj_4': 0.41212514,
     'avg_obj_5': 0.6034731,
     'box_loss_3': 0.007557737,
     'box_loss_4': 0.007944249,
     'box_loss_5': 0.0073747155,
     'class_loss_3': 0.0026685193,
     'class_loss_4': 0.0032060165,
     'class_loss_5': 0.0033179768,
     'conf_loss_3': 0.0071867555,
     'conf_loss_4': 0.009584328,
     'conf_loss_5': 0.011040838,
     'recall50_3': 0.19797766,
     'recall50_4': 0.44263956,
     'recall50_5': 0.6586959,
     'total_loss': 0.05988115,
     'validation_loss': 0.05988115}
train | step:  200000 | training until step 204000...
train | step:  204000 | steps/sec:    2.2 | output: 
    {'avg_iou_3': 0.68091184,
     'avg_iou_4': 0.7965959,
     'avg_iou_5': 0.856347,
     'avg_obj_3': 0.26950046,
     'avg_obj_4': 0.44643033,
     'avg_obj_5': 0.6089906,
     'box_loss_3': 0.012651848,
     'box_loss_4': 0.009121095,
     'box_loss_5': 0.0070242365,
     'class_loss_3': 0.0043822182,
     'class_loss_4': 0.0035841058,
     'class_loss_5': 0.0033845857,
     'conf_loss_3': 0.016402422,
     'conf_loss_4': 0.016215239,
     'conf_loss_5': 0.011516446,
     'learning_rate': 0.00020000001,
     'recall50_3': 0.17559066,
     'recall50_4': 0.42307392,
     'recall50_5': 0.64977896,
     'total_loss': 0.67425704,
     'training_loss': 0.67425704}
 eval | step:  204000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.17s).
Accumulating evaluation results...
DONE (t=12.28s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.409
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.603
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.438
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.162
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.374
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.537
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.330
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.543
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.591
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.343
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.575
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.703
 eval | step:  204000 | eval time:  493.9 sec | output: 
    {'AP': 0.4085198,
     'AP50': 0.6031214,
     'AP75': 0.4377852,
     'APl': 0.5374361,
     'APm': 0.37385705,
     'APs': 0.16237083,
     'ARl': 0.7025693,
     'ARm': 0.57474726,
     'ARmax1': 0.33037215,
     'ARmax10': 0.5426581,
     'ARmax100': 0.5905051,
     'ARs': 0.34313852,
     'avg_iou_3': 0.45974296,
     'avg_iou_4': 0.6804235,
     'avg_iou_5': 0.8210791,
     'avg_obj_3': 0.20253357,
     'avg_obj_4': 0.41253525,
     'avg_obj_5': 0.60424614,
     'box_loss_3': 0.0075621232,
     'box_loss_4': 0.0079417275,
     'box_loss_5': 0.007377498,
     'class_loss_3': 0.00268487,
     'class_loss_4': 0.0031970427,
     'class_loss_5': 0.0033399987,
     'conf_loss_3': 0.0071711657,
     'conf_loss_4': 0.009599835,
     'conf_loss_5': 0.011058949,
     'recall50_3': 0.19803889,
     'recall50_4': 0.44362003,
     'recall50_5': 0.6588623,
     'total_loss': 0.059933174,
     'validation_loss': 0.059933174}I0407 16:01:04.174500 140690734946112 controller.py:455] saved checkpoint to gs://tensorflow2/full_cfg_exp/yolov4-coco-adam-mo2017-epoch-letterbox/ckpt-204000.
I0407 16:01:04.191159 140690734946112 train_lib.py:123] Number of trainable params in model: 64.488640 Millions.

saved checkpoint to gs://tensorflow2/full_cfg_exp/yolov4-coco-adam-mo2017-epoch-letterbox/ckpt-204000.
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   238    0     2  100   236     11   1356 --:--:-- --:--:-- --:--:--  1367
okRequest issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-07T16:01:36.831133257Z'
  endTime: '2021-04-07T16:02:15.872085898Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617811296817-5bf640ba9103b-43467203-1dcfab6d
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617811296817-5bf640ba9103b-43467203-1dcfab6d] to complete...
.....................................................................................................................................................................................................................................................................................done.
