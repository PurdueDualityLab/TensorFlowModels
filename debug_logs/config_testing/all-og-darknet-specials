cat: .experiment_zone: No such file or directory
Request issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-12T06:56:34.231811Z'
  endTime: '2021-04-12T06:57:11.797890994Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618210594218-5bfc103a3e361-e55c323c-5e6e96ed
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618210594218-5bfc103a3e361-e55c323c-5e6e96ed] to complete...
...................................................................................................................................................................................................done.
europe-west4-a
I0412 06:56:30.763065 140117220173632 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.075,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.2,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 0.6,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.05,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.2,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.667,
                                                    'output_size': [640, 640],
                                                    'random_crop': True,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': 'str = "AP50"',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'str = "higher"',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine_epoch': {'alpha': 0.2,
                                                                     'decay_steps': 294375,
                                                                     'initial_learning_rate': 0.01,
                                                                     'name': 'CosineEpoch',
                                                                     'steps_per_epoch': 1875},
                                                    'type': 'cosine_epoch'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.937,
                                                        'name': 'SGD',
                                                        'nesterov': False},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5625},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0412 06:56:30.764225 140117220173632 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_testing/all-og-darknet-specials/params.yaml
I0412 06:56:32.311081 140117220173632 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0412 06:56:32.930301 140117220173632 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0412 06:56:32.930568 140117220173632 transport.py:157] Attempting refresh to obtain initial access_token
I0412 06:56:32.981184 140117220173632 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0412 06:56:33.597589 140117220173632 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0412 06:56:33.597858 140117220173632 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-12 06:56:33.658679: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0412 06:56:33.659515 140117220173632 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0412 06:56:34.275155 140117220173632 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0412 06:56:34.275418 140117220173632 transport.py:157] Attempting refresh to obtain initial access_token
I0412 06:56:34.326806 140117220173632 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0412 06:56:34.946341 140117220173632 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0412 06:56:34.946628 140117220173632 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-12 06:56:34.992200: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-12 06:56:35.032086: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-04-12 06:56:35.032169: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:42414}
2021-04-12 06:56:59.045755: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-04-12 06:56:59.045892: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:42414}
2021-04-12 06:56:59.047140: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:42414
I0412 06:56:59.048050 140117220173632 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-1
I0412 06:56:59.048546 140117220173632 tpu_strategy_util.py:74] Initializing the TPU system: node-1
INFO:tensorflow:Clearing out eager caches
I0412 06:57:07.707626 140117220173632 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0412 06:57:07.710030 140117220173632 tpu_strategy_util.py:133] Finished initializing TPU system.
I0412 06:57:07.713327 140117220173632 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0412 06:57:07.855215 140117220173632 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0412 06:57:07.855555 140117220173632 transport.py:157] Attempting refresh to obtain initial access_token
I0412 06:57:07.963148 140117220173632 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0412 06:57:08.580030 140117220173632 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0412 06:57:08.580363 140117220173632 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0412 06:57:08.648764 140117220173632 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0412 06:57:08.649114 140117220173632 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0412 06:57:08.649627 140117220173632 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0412 06:57:08.649745 140117220173632 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0412 06:57:08.649798 140117220173632 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0412 06:57:08.649967 140117220173632 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0412 06:57:08.650019 140117220173632 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0412 06:57:08.650066 140117220173632 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0412 06:57:08.650118 140117220173632 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0412 06:57:08.650166 140117220173632 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0412 06:57:08.650212 140117220173632 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0412 06:57:08.650257 140117220173632 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0412 06:57:08.650345 140117220173632 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0412 06:57:08.650396 140117220173632 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0412 06:57:08.650443 140117220173632 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0412 06:57:08.650488 140117220173632 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0412 06:57:08.679270 140117220173632 train_utils.py:214] Running default trainer.
2021-04-12 06:57:08.789846: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.05, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.6, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.667, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': False, 'momentum': 0.937}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine_epoch', 'cosine_epoch': {'name': 'CosineEpoch', 'initial_learning_rate': 0.01, 'decay_steps': 294375, 'steps_per_epoch': 1875, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5625}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': 'str = "AP50"', 'best_checkpoint_metric_comp': 'str = "higher"', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
{'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f6f30d92780>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
route_split 512.0 512.0
conv2 512.0
conv1 512.0
spp
conv1 512.0
conv2 512.0
connect
conv1 512.0
8
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
route_split 256.0 256.0
conv2 256.0
conv1 256.0
conv2 256.0
connect
conv1 256.0
6
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)








 ListWrapper([128, 256, 512])
route_split 128 128
conv2 128
conv1 128
conv2 128
connect
conv1 128
conv2 256
7
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
route_split 256 256
conv2 256
conv1 256
conv2 256
connect
conv1 256
conv2 512
7
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
route_split 512 512
conv2 512
conv1 512
conv2 512
connect
conv1 512
conv2 1024
7
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
detget {'3': 2.0, '4': 2.0, '5': 2.0}I0412 06:58:00.316021 140117220173632 controller.py:362] restoring or initializing model...
I0412 06:58:12.552849 140117220173632 yolo.py:519] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0412 06:58:12.554709 140117220173632 controller.py:368] initialized model.
I0412 06:58:12.554959 140117220173632 train_lib.py:96] Starts to execute mode: train_and_eval
I0412 06:58:12.560180 140117220173632 controller.py:211] train | step:      0 | training until step 20000...
I0412 06:58:21.066925 140117220173632 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 149, in main
    model_dir=model_dir)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_lib.py", line 104, in run_experiment
    eval_interval=params.trainer.validation_interval)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 303, in train_and_evaluate
    self.train(steps=num_steps, checkpoint_at_completion=False)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 215, in train
    self._train_n_steps(num_steps)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 410, in _train_n_steps
    train_output = self.trainer.train(num_steps_tensor)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/standard_runner.py", line 141, in train
    self._train_loop_fn(self._train_iter, num_steps)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py", line 828, in __call__
    result = self._call(*args, **kwds)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py", line 871, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py", line 726, in _initialize
    *args, **kwds))
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py", line 2969, in _get_concrete_function_internal_garbage_collected
    graph_function, _ = self._maybe_define_function(args, kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py", line 3361, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py", line 3206, in _create_graph_function
    capture_by_value=self._capture_by_value),
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/func_graph.py", line 990, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py", line 634, in wrapped_fn
    out = weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/func_graph.py", line 977, in wrapper
    raise e.ag_error_metadata.to_exception(e)
ValueError: in user code:

    /home/cam2tensorflow/TensorFlowModels/orbit/utils/loop_fns.py:118 loop_fn  *
        step_fn(iterator)
    /home/cam2tensorflow/TensorFlowModels/official/core/base_trainer.py:292 step_fn  *
        logs = self.task.train_step(
    /home/cam2tensorflow/TensorFlowModels/yolo/tasks/yolo.py:253 train_step  *
        scaled_loss, loss_metrics = self.build_losses(
    /home/cam2tensorflow/TensorFlowModels/yolo/tasks/yolo.py:203 build_losses  *
        (_loss, _loss_box, _loss_conf, _loss_class, _avg_iou, _avg_obj,
    /home/cam2tensorflow/TensorFlowModels/yolo/losses/yolo_loss.py:674 __call__  *
        return self.call_pytorch(true_counts, inds, y_true, boxes, classes, y_pred)
    /home/cam2tensorflow/TensorFlowModels/yolo/losses/yolo_loss.py:476 call_pytorch  *
        pred_xy, pred_wh, pred_box = self._decode_boxes(fwidth, fheight, pred_box,
    /home/cam2tensorflow/TensorFlowModels/yolo/losses/yolo_loss.py:150 get_predicted_box_newcords  *
        box_xy, box_wh, pred_box = darknet_new_coord_boxes(pred_xy, pred_wh, width, height, anchor_grid, grid_points)

    ValueError: not enough values to unpack (expected 3, got 2)


(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 80, 80, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 640, 640, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 400, 8), 5: (8, 200, 8)}, inds: {3: (8, 600, 3), 4: (8, 400, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 80, 80, 3, 1), 4: (8, 40, 40, 3, 1), 5: (8, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 640, 640, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 80, 80, 3, 1), 4: (1, 40, 40, 3, 1), 5: (1, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   207    0     2  100   205     11   1227 --:--:-- --:--:-- --:--:--  1239
okRequest issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-12T06:59:28.956569654Z'
  endTime: '2021-04-12T07:00:19.890501934Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618210768942-5bfc10e0df61c-7db6ed11-93fa17f5
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618210768942-5bfc10e0df61c-7db6ed11-93fa17f5] to complete...
..........................................................................................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-1]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618210881213-5bfc114bf15e1-2d9d8957-61a8ef5f] to complete...
...aborted by ctrl-c.
ERROR: (gcloud.compute.tpus.start) Aborting wait for operation https://tpu.googleapis.com/v1alpha1/projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618210881213-5bfc114bf15e1-2d9d8957-61a8ef5f.

europe-west4-a
I0412 07:00:28.911316 140171005892416 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.075,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.2,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 0.6,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.05,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.2,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.667,
                                                    'output_size': [640, 640],
                                                    'random_crop': True,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': 'str = "AP50"',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'str = "higher"',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine_epoch': {'alpha': 0.2,
                                                                     'decay_steps': 294375,
                                                                     'initial_learning_rate': 0.01,
                                                                     'name': 'CosineEpoch',
                                                                     'steps_per_epoch': 1875},
                                                    'type': 'cosine_epoch'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.937,
                                                        'name': 'SGD',
                                                        'nesterov': False},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5625},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0412 07:00:28.912231 140171005892416 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_testing/all-og-darknet-specials/params.yaml
I0412 07:00:29.773984 140171005892416 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0412 07:00:30.395241 140171005892416 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0412 07:00:30.395481 140171005892416 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-1" is not yet ready; state: "STARTING"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.05, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.6, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.667, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': False, 'momentum': 0.937}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine_epoch', 'cosine_epoch': {'name': 'CosineEpoch', 'initial_learning_rate': 0.01, 'decay_steps': 294375, 'steps_per_epoch': 1875, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5625}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': 'str = "AP50"', 'best_checkpoint_metric_comp': 'str = "higher"', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   207    0     2  100   205     11   1227 --:--:-- --:--:-- --:--:--  1239
okRequest issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-12T07:01:28.625663181Z'
  endTime: '2021-04-12T07:04:58.602426377Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618210888614-5bfc11530020a-93550840-7a0078b9
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618210888614-5bfc11530020a-93550840-7a0078b9] to complete...
..........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-12T07:06:33.930451328Z'
  endTime: '2021-04-12T07:07:11.168282604Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618211193916-5bfc127628a9f-7e716332-474bee81
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618211193916-5bfc127628a9f-7e716332-474bee81] to complete...
............................................................................................................................................................................................................................................................................done.
europe-west4-a
I0412 07:06:33.331026 140219636086592 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.075,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.2,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 0.6,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.05,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.2,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.667,
                                                    'output_size': [640, 640],
                                                    'random_crop': True,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': 'str = "AP50"',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'str = "higher"',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine_epoch': {'alpha': 0.2,
                                                                     'decay_steps': 294375,
                                                                     'initial_learning_rate': 0.01,
                                                                     'name': 'CosineEpoch',
                                                                     'steps_per_epoch': 1875},
                                                    'type': 'cosine_epoch'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.937,
                                                        'name': 'SGD',
                                                        'nesterov': False},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5625},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0412 07:06:33.332706 140219636086592 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_testing/all-og-darknet-specials/params.yaml
I0412 07:06:34.152474 140219636086592 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0412 07:06:34.773795 140219636086592 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0412 07:06:34.777088 140219636086592 transport.py:157] Attempting refresh to obtain initial access_token
I0412 07:06:34.830686 140219636086592 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0412 07:06:35.451009 140219636086592 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0412 07:06:35.451298 140219636086592 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-12 07:06:35.493740: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0412 07:06:35.494364 140219636086592 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0412 07:06:35.635714 140219636086592 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0412 07:06:35.636001 140219636086592 transport.py:157] Attempting refresh to obtain initial access_token
I0412 07:06:35.687777 140219636086592 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0412 07:06:35.830677 140219636086592 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0412 07:06:35.830934 140219636086592 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-12 07:06:35.874801: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-12 07:06:35.884272: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-04-12 07:06:35.884349: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:42714}
2021-04-12 07:06:51.200502: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-04-12 07:06:51.200613: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:42714}
2021-04-12 07:06:51.201200: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:42714
I0412 07:06:51.202633 140219636086592 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-1
I0412 07:06:51.205370 140219636086592 tpu_strategy_util.py:74] Initializing the TPU system: node-1
INFO:tensorflow:Clearing out eager caches
I0412 07:06:59.537603 140219636086592 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0412 07:06:59.539877 140219636086592 tpu_strategy_util.py:133] Finished initializing TPU system.
I0412 07:06:59.541350 140219636086592 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0412 07:06:59.685302 140219636086592 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0412 07:06:59.685620 140219636086592 transport.py:157] Attempting refresh to obtain initial access_token
I0412 07:06:59.757440 140219636086592 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0412 07:06:59.912881 140219636086592 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0412 07:06:59.913149 140219636086592 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0412 07:06:59.961740 140219636086592 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0412 07:06:59.962067 140219636086592 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0412 07:06:59.962407 140219636086592 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0412 07:06:59.962496 140219636086592 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0412 07:06:59.962547 140219636086592 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0412 07:06:59.962694 140219636086592 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0412 07:06:59.962742 140219636086592 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0412 07:06:59.962788 140219636086592 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0412 07:06:59.962838 140219636086592 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0412 07:06:59.962883 140219636086592 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0412 07:06:59.962927 140219636086592 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0412 07:06:59.962971 140219636086592 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0412 07:06:59.963033 140219636086592 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0412 07:06:59.963078 140219636086592 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0412 07:06:59.963123 140219636086592 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0412 07:06:59.963168 140219636086592 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0412 07:06:59.992149 140219636086592 train_utils.py:214] Running default trainer.
2021-04-12 07:07:00.002051: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.05, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.6, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.667, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': False, 'momentum': 0.937}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine_epoch', 'cosine_epoch': {'name': 'CosineEpoch', 'initial_learning_rate': 0.01, 'decay_steps': 294375, 'steps_per_epoch': 1875, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5625}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': 'str = "AP50"', 'best_checkpoint_metric_comp': 'str = "higher"', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
{'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f8709493eb8>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
route_split 512.0 512.0
conv2 512.0
conv1 512.0
spp
conv1 512.0
conv2 512.0
connect
conv1 512.0
8
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
route_split 256.0 256.0
conv2 256.0
conv1 256.0
conv2 256.0
connect
conv1 256.0
6
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)








 ListWrapper([128, 256, 512])
route_split 128 128
conv2 128
conv1 128
conv2 128
connect
conv1 128
conv2 256
7
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
route_split 256 256
conv2 256
conv1 256
conv2 256
connect
conv1 256
conv2 512
7
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
route_split 512 512
conv2 512
conv1 512
conv2 512
connect
conv1 512
conv2 1024
7
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
detget {'3': 2.0, '4': 2.0, '5': 2.0}I0412 07:07:48.821773 140219636086592 controller.py:362] restoring or initializing model...
I0412 07:07:59.856973 140219636086592 yolo.py:519] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0412 07:07:59.859026 140219636086592 controller.py:368] initialized model.
I0412 07:07:59.859331 140219636086592 train_lib.py:96] Starts to execute mode: train_and_eval
I0412 07:07:59.864498 140219636086592 controller.py:211] train | step:      0 | training until step 20000...
I0412 07:08:06.405875 140219636086592 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0412 07:08:43.286505 140219636086592 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0412 07:45:07.909583 140219636086592 controller.py:425] train | step:   5000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.4594418,
           'avg_obj': 0.08971592,
           'box_loss': 0.020396052,
           'class_loss': 0.102763124,
           'conf_loss': 0.3833932,
           'precision50': 0.0025805382,
           'recall50': 0.05018047},
     '4': {'avg_iou': 0.48541847,
           'avg_obj': 0.11223744,
           'box_loss': 0.023244932,
           'class_loss': 0.11396791,
           'conf_loss': 0.10307456,
           'precision50': 0.045269474,
           'recall50': 0.042147927},
     '5': {'avg_iou': 0.50291944,
           'avg_obj': 0.18448402,
           'box_loss': 0.024352001,
           'class_loss': 0.110252805,
           'conf_loss': 0.06825704,
           'precision50': 0.17714243,
           'recall50': 0.10317633},
     'global': {'total_loss': 7.5975914},
     'learning_rate': 0.006238453,
     'training_loss': 7.5975914}
I0412 07:46:00.789524 140219636086592 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-og-darknet-specials/ckpt-5000.
I0412 08:17:52.758862 140219636086592 controller.py:425] train | step:  10000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.54584724,
           'avg_obj': 0.02702344,
           'box_loss': 0.016845742,
           'class_loss': 0.02149494,
           'conf_loss': 0.018480506,
           'precision50': 0.0144609315,
           'recall50': 0.000853262},
     '4': {'avg_iou': 0.606937,
           'avg_obj': 0.071725264,
           'box_loss': 0.017358838,
           'class_loss': 0.022812733,
           'conf_loss': 0.022945473,
           'precision50': 0.119995885,
           'recall50': 0.012243779},
     '5': {'avg_iou': 0.65833694,
           'avg_obj': 0.14394586,
           'box_loss': 0.01654628,
           'class_loss': 0.021522595,
           'conf_loss': 0.023110462,
           'precision50': 0.30626568,
           'recall50': 0.050499123},
     'global': {'total_loss': 1.4489415},
     'learning_rate': 0.009979997,
     'training_loss': 1.4489415}
I0412 08:49:38.570200 140219636086592 controller.py:425] train | step:  15000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.57768273,
           'avg_obj': 0.04472764,
           'box_loss': 0.015553278,
           'class_loss': 0.019416431,
           'conf_loss': 0.01782327,
           'precision50': 0.041881453,
           'recall50': 0.0030355249},
     '4': {'avg_iou': 0.6502537,
           'avg_obj': 0.10777786,
           'box_loss': 0.015258665,
           'class_loss': 0.021582874,
           'conf_loss': 0.02215927,
           'precision50': 0.25312355,
           'recall50': 0.03361217},
     '5': {'avg_iou': 0.7073819,
           'avg_obj': 0.20084095,
           'box_loss': 0.013949726,
           'class_loss': 0.01911065,
           'conf_loss': 0.021930775,
           'precision50': 0.47238222,
           'recall50': 0.116183616},
     'global': {'total_loss': 1.3342797},
     'learning_rate': 0.009948857,
     'training_loss': 1.3342797}

(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 80, 80, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 640, 640, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 400, 8), 5: (8, 200, 8)}, inds: {3: (8, 600, 3), 4: (8, 400, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 80, 80, 3, 1), 4: (8, 40, 40, 3, 1), 5: (8, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 640, 640, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 80, 80, 3, 1), 4: (1, 40, 40, 3, 1), 5: (1, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
train | step:   5000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.4594418,
           'avg_obj': 0.08971592,
           'box_loss': 0.020396052,
           'class_loss': 0.102763124,
           'conf_loss': 0.3833932,
           'precision50': 0.0025805382,
           'recall50': 0.05018047},
     '4': {'avg_iou': 0.48541847,
           'avg_obj': 0.11223744,
           'box_loss': 0.023244932,
           'class_loss': 0.11396791,
           'conf_loss': 0.10307456,
           'precision50': 0.045269474,
           'recall50': 0.042147927},
     '5': {'avg_iou': 0.50291944,
           'avg_obj': 0.18448402,
           'box_loss': 0.024352001,
           'class_loss': 0.110252805,
           'conf_loss': 0.06825704,
           'precision50': 0.17714243,
           'recall50': 0.10317633},
     'global': {'total_loss': 7.5975914},
     'learning_rate': 0.006238453,
     'training_loss': 7.5975914}
saved checkpoint to gs://tensorflow2/config_testing/all-og-darknet-specials/ckpt-5000.
train | step:  10000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.54584724,
           'avg_obj': 0.02702344,
           'box_loss': 0.016845742,
           'class_loss': 0.02149494,
           'conf_loss': 0.018480506,
           'precision50': 0.0144609315,
           'recall50': 0.000853262},
     '4': {'avg_iou': 0.606937,
           'avg_obj': 0.071725264,
           'box_loss': 0.017358838,
           'class_loss': 0.022812733,
           'conf_loss': 0.022945473,
           'precision50': 0.119995885,
           'recall50': 0.012243779},
     '5': {'avg_iou': 0.65833694,
           'avg_obj': 0.14394586,
           'box_loss': 0.01654628,
           'class_loss': 0.021522595,
           'conf_loss': 0.023110462,
           'precision50': 0.30626568,
           'recall50': 0.050499123},
     'global': {'total_loss': 1.4489415},
     'learning_rate': 0.009979997,
     'training_loss': 1.4489415}
train | step:  15000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.57768273,
           'avg_obj': 0.04472764,
           'box_loss': 0.015553278,
           'class_loss': 0.019416431,
           'conf_loss': 0.01782327,
           'precision50': 0.041881453,
           'recall50': 0.0030355249},
     '4': {'avg_iou': 0.6502537,
           'avg_obj': 0.10777786,
           'box_loss': 0.015258665,
           'class_loss': 0.021582874,
           'conf_loss': 0.02215927,
           'precision50': 0.25312355,
           'recall50': 0.03361217},
     '5': {'avg_iou': 0.7073819,
           'avg_obj': 0.20084095,
           'box_loss': 0.013949726,
           'class_loss': 0.01911065,
           'conf_loss': 0.021930775,
           'precision50': 0.47238222,
           'recall50': 0.116183616},
     'global': {'total_loss': 1.3342797},
     'learning_rate': 0.009948857,
     'training_loss': 1.3342797}I0412 09:24:12.014895 140219636086592 controller.py:425] train | step:  20000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.5969346,
           'avg_obj': 0.060708392,
           'box_loss': 0.01486114,
           'class_loss': 0.01878968,
           'conf_loss': 0.01737231,
           'precision50': 0.07565385,
           'recall50': 0.006803872},
     '4': {'avg_iou': 0.6713459,
           'avg_obj': 0.13207462,
           'box_loss': 0.014304319,
           'class_loss': 0.020832004,
           'conf_loss': 0.02162538,
           'precision50': 0.3289813,
           'recall50': 0.053233728},
     '5': {'avg_iou': 0.7284439,
           'avg_obj': 0.23378213,
           'box_loss': 0.012863977,
           'class_loss': 0.017508429,
           'conf_loss': 0.021239495,
           'precision50': 0.5362765,
           'recall50': 0.16155158},
     'global': {'total_loss': 1.2751745},
     'learning_rate': 0.009920185,
     'training_loss': 1.2751745}
I0412 09:24:25.626179 140219636086592 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0412 09:24:26.198964 140219636086592 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0412 09:24:43.511351 140219636086592 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0412 09:30:00.156801 140219636086592 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0412 09:34:33.072298 140219636086592 controller.py:261]  eval | step:  20000 | eval time:  607.4 sec | output: 
    {'3': {'avg_iou': 0.41659874,
           'avg_obj': 0.047562595,
           'box_loss': 0.008985588,
           'class_loss': 0.014453448,
           'conf_loss': 0.006403334,
           'precision50': 0.051738422,
           'recall50': 0.0122301},
     '4': {'avg_iou': 0.6185337,
           'avg_obj': 0.14034554,
           'box_loss': 0.010524613,
           'class_loss': 0.018752156,
           'conf_loss': 0.008095007,
           'precision50': 0.13926846,
           'recall50': 0.085189104},
     '5': {'avg_iou': 0.7511317,
           'avg_obj': 0.25127998,
           'box_loss': 0.010858754,
           'class_loss': 0.015432114,
           'conf_loss': 0.00853606,
           'precision50': 0.21273218,
           'recall50': 0.20232056},
     'AP': 0.053040627,
     'AP50': 0.08263868,
     'AP75': 0.055588726,
     'APl': 0.081237,
     'APm': 0.02031001,
     'APs': 0.0023937353,
     'ARl': 0.3789318,
     'ARm': 0.15988441,
     'ARmax1': 0.13989401,
     'ARmax10': 0.24800636,
     'ARmax100': 0.25498286,
     'ARs': 0.031522475,
     'global': {'total_loss': 0.10204107},
     'validation_loss': 0.10204107}
I0412 09:34:57.997920 140219636086592 controller.py:211] train | step:  20000 | training until step 40000...
I0412 10:09:48.994870 140219636086592 controller.py:425] train | step:  25000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.606345,
           'avg_obj': 0.06974136,
           'box_loss': 0.014475424,
           'class_loss': 0.01832884,
           'conf_loss': 0.017019348,
           'precision50': 0.09642064,
           'recall50': 0.009816923},
     '4': {'avg_iou': 0.6832714,
           'avg_obj': 0.14699453,
           'box_loss': 0.013727815,
           'class_loss': 0.020007445,
           'conf_loss': 0.021161232,
           'precision50': 0.367874,
           'recall50': 0.066984296},
     '5': {'avg_iou': 0.7404819,
           'avg_obj': 0.25452003,
           'box_loss': 0.012231176,
           'class_loss': 0.016403932,
           'conf_loss': 0.020718917,
           'precision50': 0.5688772,
           'recall50': 0.1913706},
     'global': {'total_loss': 1.2325919},
     'learning_rate': 0.009865424,
     'training_loss': 1.2325919}
I0412 10:10:37.809607 140219636086592 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-og-darknet-specials/ckpt-25000.
I0412 10:42:08.760736 140219636086592 controller.py:425] train | step:  30000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.61322254,
           'avg_obj': 0.07744199,
           'box_loss': 0.014249863,
           'class_loss': 0.01802544,
           'conf_loss': 0.016829327,
           'precision50': 0.113638535,
           'recall50': 0.012821599},
     '4': {'avg_iou': 0.6914037,
           'avg_obj': 0.15809974,
           'box_loss': 0.013390526,
           'class_loss': 0.019293657,
           'conf_loss': 0.020945279,
           'precision50': 0.39448416,
           'recall50': 0.07831922},
     '5': {'avg_iou': 0.7485885,
           'avg_obj': 0.2687687,
           'box_loss': 0.011829447,
           'class_loss': 0.015670862,
           'conf_loss': 0.02046964,
           'precision50': 0.59174156,
           'recall50': 0.21271709},
     'global': {'total_loss': 1.2056338},
     'learning_rate': 0.009796737,
     'training_loss': 1.2056338}
I0412 11:14:33.356474 140219636086592 controller.py:425] train | step:  35000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6178674,
           'avg_obj': 0.082055315,
           'box_loss': 0.014088,
           'class_loss': 0.01779553,
           'conf_loss': 0.016727712,
           'precision50': 0.124462135,
           'recall50': 0.015094864},
     '4': {'avg_iou': 0.69544125,
           'avg_obj': 0.16352269,
           'box_loss': 0.013205258,
           'class_loss': 0.01867505,
           'conf_loss': 0.02079521,
           'precision50': 0.40373775,
           'recall50': 0.08440196},
     '5': {'avg_iou': 0.7510218,
           'avg_obj': 0.27296144,
           'box_loss': 0.011719662,
           'class_loss': 0.015271681,
           'conf_loss': 0.020345507,
           'precision50': 0.59135866,
           'recall50': 0.21840084},
     'global': {'total_loss': 1.1889889},
     'learning_rate': 0.00974333,
     'training_loss': 1.1889889}
I0412 11:46:26.633094 140219636086592 controller.py:425] train | step:  40000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6228565,
           'avg_obj': 0.088608734,
           'box_loss': 0.013887927,
           'class_loss': 0.01753056,
           'conf_loss': 0.016554551,
           'precision50': 0.1418788,
           'recall50': 0.018066686},
     '4': {'avg_iou': 0.7021687,
           'avg_obj': 0.17357558,
           'box_loss': 0.012893547,
           'class_loss': 0.017981987,
           'conf_loss': 0.020557813,
           'precision50': 0.42493936,
           'recall50': 0.09447474},
     '5': {'avg_iou': 0.7589253,
           'avg_obj': 0.28818715,
           'box_loss': 0.011305841,
           'class_loss': 0.014556491,
           'conf_loss': 0.020042919,
           'precision50': 0.6159101,
           'recall50': 0.24142905},
     'global': {'total_loss': 1.1624938},
     'learning_rate': 0.009652007,
     'training_loss': 1.1624938}
I0412 11:46:39.681994 140219636086592 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0412 11:51:15.318359 140219636086592 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.

train | step:  20000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.5969346,
           'avg_obj': 0.060708392,
           'box_loss': 0.01486114,
           'class_loss': 0.01878968,
           'conf_loss': 0.01737231,
           'precision50': 0.07565385,
           'recall50': 0.006803872},
     '4': {'avg_iou': 0.6713459,
           'avg_obj': 0.13207462,
           'box_loss': 0.014304319,
           'class_loss': 0.020832004,
           'conf_loss': 0.02162538,
           'precision50': 0.3289813,
           'recall50': 0.053233728},
     '5': {'avg_iou': 0.7284439,
           'avg_obj': 0.23378213,
           'box_loss': 0.012863977,
           'class_loss': 0.017508429,
           'conf_loss': 0.021239495,
           'precision50': 0.5362765,
           'recall50': 0.16155158},
     'global': {'total_loss': 1.2751745},
     'learning_rate': 0.009920185,
     'training_loss': 1.2751745}
 eval | step:  20000 | running 625 steps of evaluation...
(1, 20, 20, 512) (1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 2048)
(1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 1024)
(1, 20, 20, 512)
(1, 40, 40, 256) (1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 512)
(1, 40, 40, 256)
(1, 80, 80, 128) (1, 80, 80, 128)
(1, 80, 80, 128)
(1, 80, 80, 128)
(1, 80, 80, 128)
(1, 80, 80, 256)
(1, 80, 80, 128)
(1, 80, 80, 256)
(1, 40, 40, 256) (1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 512)
(1, 40, 40, 256)
(1, 40, 40, 512)
(1, 20, 20, 512) (1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 1024)
(1, 20, 20, 512)
(1, 20, 20, 1024)
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=182.52s).
Accumulating evaluation results...
DONE (t=35.40s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.053
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.083
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.056
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.002
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.020
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.081
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.140
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.248
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.255
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.032
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.160
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.379
 eval | step:  20000 | eval time:  607.4 sec | output: 
    {'3': {'avg_iou': 0.41659874,
           'avg_obj': 0.047562595,
           'box_loss': 0.008985588,
           'class_loss': 0.014453448,
           'conf_loss': 0.006403334,
           'precision50': 0.051738422,
           'recall50': 0.0122301},
     '4': {'avg_iou': 0.6185337,
           'avg_obj': 0.14034554,
           'box_loss': 0.010524613,
           'class_loss': 0.018752156,
           'conf_loss': 0.008095007,
           'precision50': 0.13926846,
           'recall50': 0.085189104},
     '5': {'avg_iou': 0.7511317,
           'avg_obj': 0.25127998,
           'box_loss': 0.010858754,
           'class_loss': 0.015432114,
           'conf_loss': 0.00853606,
           'precision50': 0.21273218,
           'recall50': 0.20232056},
     'AP': 0.053040627,
     'AP50': 0.08263868,
     'AP75': 0.055588726,
     'APl': 0.081237,
     'APm': 0.02031001,
     'APs': 0.0023937353,
     'ARl': 0.3789318,
     'ARm': 0.15988441,
     'ARmax1': 0.13989401,
     'ARmax10': 0.24800636,
     'ARmax100': 0.25498286,
     'ARs': 0.031522475,
     'global': {'total_loss': 0.10204107},
     'validation_loss': 0.10204107}
train | step:  20000 | training until step 40000...
train | step:  25000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.606345,
           'avg_obj': 0.06974136,
           'box_loss': 0.014475424,
           'class_loss': 0.01832884,
           'conf_loss': 0.017019348,
           'precision50': 0.09642064,
           'recall50': 0.009816923},
     '4': {'avg_iou': 0.6832714,
           'avg_obj': 0.14699453,
           'box_loss': 0.013727815,
           'class_loss': 0.020007445,
           'conf_loss': 0.021161232,
           'precision50': 0.367874,
           'recall50': 0.066984296},
     '5': {'avg_iou': 0.7404819,
           'avg_obj': 0.25452003,
           'box_loss': 0.012231176,
           'class_loss': 0.016403932,
           'conf_loss': 0.020718917,
           'precision50': 0.5688772,
           'recall50': 0.1913706},
     'global': {'total_loss': 1.2325919},
     'learning_rate': 0.009865424,
     'training_loss': 1.2325919}
saved checkpoint to gs://tensorflow2/config_testing/all-og-darknet-specials/ckpt-25000.
train | step:  30000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.61322254,
           'avg_obj': 0.07744199,
           'box_loss': 0.014249863,
           'class_loss': 0.01802544,
           'conf_loss': 0.016829327,
           'precision50': 0.113638535,
           'recall50': 0.012821599},
     '4': {'avg_iou': 0.6914037,
           'avg_obj': 0.15809974,
           'box_loss': 0.013390526,
           'class_loss': 0.019293657,
           'conf_loss': 0.020945279,
           'precision50': 0.39448416,
           'recall50': 0.07831922},
     '5': {'avg_iou': 0.7485885,
           'avg_obj': 0.2687687,
           'box_loss': 0.011829447,
           'class_loss': 0.015670862,
           'conf_loss': 0.02046964,
           'precision50': 0.59174156,
           'recall50': 0.21271709},
     'global': {'total_loss': 1.2056338},
     'learning_rate': 0.009796737,
     'training_loss': 1.2056338}
train | step:  35000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6178674,
           'avg_obj': 0.082055315,
           'box_loss': 0.014088,
           'class_loss': 0.01779553,
           'conf_loss': 0.016727712,
           'precision50': 0.124462135,
           'recall50': 0.015094864},
     '4': {'avg_iou': 0.69544125,
           'avg_obj': 0.16352269,
           'box_loss': 0.013205258,
           'class_loss': 0.01867505,
           'conf_loss': 0.02079521,
           'precision50': 0.40373775,
           'recall50': 0.08440196},
     '5': {'avg_iou': 0.7510218,
           'avg_obj': 0.27296144,
           'box_loss': 0.011719662,
           'class_loss': 0.015271681,
           'conf_loss': 0.020345507,
           'precision50': 0.59135866,
           'recall50': 0.21840084},
     'global': {'total_loss': 1.1889889},
     'learning_rate': 0.00974333,
     'training_loss': 1.1889889}
train | step:  40000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6228565,
           'avg_obj': 0.088608734,
           'box_loss': 0.013887927,
           'class_loss': 0.01753056,
           'conf_loss': 0.016554551,
           'precision50': 0.1418788,
           'recall50': 0.018066686},
     '4': {'avg_iou': 0.7021687,
           'avg_obj': 0.17357558,
           'box_loss': 0.012893547,
           'class_loss': 0.017981987,
           'conf_loss': 0.020557813,
           'precision50': 0.42493936,
           'recall50': 0.09447474},
     '5': {'avg_iou': 0.7589253,
           'avg_obj': 0.28818715,
           'box_loss': 0.011305841,
           'class_loss': 0.014556491,
           'conf_loss': 0.020042919,
           'precision50': 0.6159101,
           'recall50': 0.24142905},
     'global': {'total_loss': 1.1624938},
     'learning_rate': 0.009652007,
     'training_loss': 1.1624938}
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=178.55s).
Accumulating evaluation results...
DONE (t=33.33s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.104
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.155I0412 11:55:46.628754 140219636086592 controller.py:261]  eval | step:  40000 | eval time:  546.9 sec | output: 
    {'3': {'avg_iou': 0.42800483,
           'avg_obj': 0.07500446,
           'box_loss': 0.008416165,
           'class_loss': 0.01325542,
           'conf_loss': 0.0064238748,
           'precision50': 0.07850534,
           'recall50': 0.03380942},
     '4': {'avg_iou': 0.6394571,
           'avg_obj': 0.19806889,
           'box_loss': 0.009472594,
           'class_loss': 0.015525479,
           'conf_loss': 0.008087637,
           'precision50': 0.18227535,
           'recall50': 0.15855098},
     '5': {'avg_iou': 0.7784521,
           'avg_obj': 0.34820637,
           'box_loss': 0.009485947,
           'class_loss': 0.011866861,
           'conf_loss': 0.008867519,
           'precision50': 0.2609218,
           'recall50': 0.33599856},
     'AP': 0.104021214,
     'AP50': 0.15523855,
     'AP75': 0.11226641,
     'APl': 0.15623133,
     'APm': 0.05158355,
     'APs': 0.0078102835,
     'ARl': 0.49727184,
     'ARm': 0.25722477,
     'ARmax1': 0.18823561,
     'ARmax10': 0.32894194,
     'ARmax100': 0.3430231,
     'ARs': 0.050192904,
     'global': {'total_loss': 0.09140148},
     'validation_loss': 0.09140148}
I0412 11:56:02.581745 140219636086592 controller.py:211] train | step:  40000 | training until step 60000...
I0412 12:27:28.809387 140219636086592 controller.py:425] train | step:  45000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.62618095,
           'avg_obj': 0.09174966,
           'box_loss': 0.013815471,
           'class_loss': 0.017369699,
           'conf_loss': 0.016568327,
           'precision50': 0.149304,
           'recall50': 0.02021568},
     '4': {'avg_iou': 0.70516205,
           'avg_obj': 0.17713632,
           'box_loss': 0.012770503,
           'class_loss': 0.017568301,
           'conf_loss': 0.020540643,
           'precision50': 0.43042436,
           'recall50': 0.09925606},
     '5': {'avg_iou': 0.7608345,
           'avg_obj': 0.29045722,
           'box_loss': 0.011213979,
           'class_loss': 0.014359964,
           'conf_loss': 0.020028172,
           'precision50': 0.61640483,
           'recall50': 0.24526548},
     'global': {'total_loss': 1.1538813},
     'learning_rate': 0.00954753,
     'training_loss': 1.1538813}
I0412 12:28:18.165272 140219636086592 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-og-darknet-specials/ckpt-45000.
I0412 13:00:44.420698 140219636086592 controller.py:425] train | step:  50000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.63029027,
           'avg_obj': 0.09759631,
           'box_loss': 0.013642345,
           'class_loss': 0.01711139,
           'conf_loss': 0.016344614,
           'precision50': 0.1633077,
           'recall50': 0.023359748},
     '4': {'avg_iou': 0.7101846,
           'avg_obj': 0.18679549,
           'box_loss': 0.012526501,
           'class_loss': 0.01696342,
           'conf_loss': 0.020201849,
           'precision50': 0.4490445,
           'recall50': 0.10995369},
     '5': {'avg_iou': 0.7669687,
           'avg_obj': 0.3041321,
           'box_loss': 0.010897392,
           'class_loss': 0.013682501,
           'conf_loss': 0.019632911,
           'precision50': 0.6352355,
           'recall50': 0.26532882},
     'global': {'total_loss': 1.1280234},
     'learning_rate': 0.009470752,
     'training_loss': 1.1280234}
I0412 13:34:09.404622 140219636086592 controller.py:425] train | step:  55000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6327932,
           'avg_obj': 0.10111653,
           'box_loss': 0.013536705,
           'class_loss': 0.016958216,
           'conf_loss': 0.016177919,
           'precision50': 0.17199595,
           'recall50': 0.025622787},
     '4': {'avg_iou': 0.7139291,
           'avg_obj': 0.19212973,
           'box_loss': 0.012370141,
           'class_loss': 0.016560443,
           'conf_loss': 0.02006254,
           'precision50': 0.45842364,
           'recall50': 0.11576244},
     '5': {'avg_iou': 0.77032304,
           'avg_obj': 0.31114894,
           'box_loss': 0.010728319,
           'class_loss': 0.013266994,
           'conf_loss': 0.019483812,
           'precision50': 0.64330554,
           'recall50': 0.27540848},
     'global': {'total_loss': 1.1131623},
     'learning_rate': 0.0093452055,
     'training_loss': 1.1131623}
I0412 14:07:29.086561 140219636086592 controller.py:425] train | step:  60000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6354745,
           'avg_obj': 0.1047683,
           'box_loss': 0.013449081,
           'class_loss': 0.016776947,
           'conf_loss': 0.016115783,
           'precision50': 0.17994389,
           'recall50': 0.027846271},
     '4': {'avg_iou': 0.7167544,
           'avg_obj': 0.19789161,
           'box_loss': 0.012236335,
           'class_loss': 0.016113816,
           'conf_loss': 0.019965207,
           'precision50': 0.46824452,
           'recall50': 0.12242352},
     '5': {'avg_iou': 0.77288675,
           'avg_obj': 0.3178382,
           'box_loss': 0.010595229,
           'class_loss': 0.012901199,
           'conf_loss': 0.019310394,
           'precision50': 0.6509044,
           'recall50': 0.2852259},
     'global': {'total_loss': 1.0997128},
     'learning_rate': 0.009207607,
     'training_loss': 1.0997128}
I0412 14:07:42.437816 140219636086592 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0412 14:12:25.531495 140219636086592 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0412 14:16:54.498070 140219636086592 controller.py:261]  eval | step:  60000 | eval time:  552.1 sec | output: 
    {'3': {'avg_iou': 0.4331629,
           'avg_obj': 0.087962344,
           'box_loss': 0.008157496,
           'class_loss': 0.01255489,
           'conf_loss': 0.0063102064,
           'precision50': 0.091494925,
           'recall50': 0.04738328},
     '4': {'avg_iou': 0.6474828,
           'avg_obj': 0.22786182,
           'box_loss': 0.0090694465,
           'class_loss': 0.013402786,
           'conf_loss': 0.008062156,
           'precision50': 0.19926381,
           'recall50': 0.19986162},
     '5': {'avg_iou': 0.78933,
           'avg_obj': 0.39369276,
           'box_loss': 0.008939539,
           'class_loss': 0.010104743,
           'conf_loss': 0.00902507,
           'precision50': 0.27854812,
           'recall50': 0.39367294},
     'AP': 0.1410301,
     'AP50': 0.20818743,
     'AP75': 0.15192801,
     'APl': 0.20859994,
     'APm': 0.07933376,
     'APs': 0.015698459,
     'ARl': 0.55119437,
     'ARm': 0.3120999,
     'ARmax1': 0.21161689,
     'ARmax10': 0.3700451,
     'ARmax100': 0.38935497,
     'ARs': 0.0768961,
     'global': {'total_loss': 0.0856263},
     'validation_loss': 0.0856263}

 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.112
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.008
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.052
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.156
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.188
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.329
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.343
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.257
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.497
 eval | step:  40000 | eval time:  546.9 sec | output: 
    {'3': {'avg_iou': 0.42800483,
           'avg_obj': 0.07500446,
           'box_loss': 0.008416165,
           'class_loss': 0.01325542,
           'conf_loss': 0.0064238748,
           'precision50': 0.07850534,
           'recall50': 0.03380942},
     '4': {'avg_iou': 0.6394571,
           'avg_obj': 0.19806889,
           'box_loss': 0.009472594,
           'class_loss': 0.015525479,
           'conf_loss': 0.008087637,
           'precision50': 0.18227535,
           'recall50': 0.15855098},
     '5': {'avg_iou': 0.7784521,
           'avg_obj': 0.34820637,
           'box_loss': 0.009485947,
           'class_loss': 0.011866861,
           'conf_loss': 0.008867519,
           'precision50': 0.2609218,
           'recall50': 0.33599856},
     'AP': 0.104021214,
     'AP50': 0.15523855,
     'AP75': 0.11226641,
     'APl': 0.15623133,
     'APm': 0.05158355,
     'APs': 0.0078102835,
     'ARl': 0.49727184,
     'ARm': 0.25722477,
     'ARmax1': 0.18823561,
     'ARmax10': 0.32894194,
     'ARmax100': 0.3430231,
     'ARs': 0.050192904,
     'global': {'total_loss': 0.09140148},
     'validation_loss': 0.09140148}
train | step:  40000 | training until step 60000...
train | step:  45000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.62618095,
           'avg_obj': 0.09174966,
           'box_loss': 0.013815471,
           'class_loss': 0.017369699,
           'conf_loss': 0.016568327,
           'precision50': 0.149304,
           'recall50': 0.02021568},
     '4': {'avg_iou': 0.70516205,
           'avg_obj': 0.17713632,
           'box_loss': 0.012770503,
           'class_loss': 0.017568301,
           'conf_loss': 0.020540643,
           'precision50': 0.43042436,
           'recall50': 0.09925606},
     '5': {'avg_iou': 0.7608345,
           'avg_obj': 0.29045722,
           'box_loss': 0.011213979,
           'class_loss': 0.014359964,
           'conf_loss': 0.020028172,
           'precision50': 0.61640483,
           'recall50': 0.24526548},
     'global': {'total_loss': 1.1538813},
     'learning_rate': 0.00954753,
     'training_loss': 1.1538813}
saved checkpoint to gs://tensorflow2/config_testing/all-og-darknet-specials/ckpt-45000.
train | step:  50000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.63029027,
           'avg_obj': 0.09759631,
           'box_loss': 0.013642345,
           'class_loss': 0.01711139,
           'conf_loss': 0.016344614,
           'precision50': 0.1633077,
           'recall50': 0.023359748},
     '4': {'avg_iou': 0.7101846,
           'avg_obj': 0.18679549,
           'box_loss': 0.012526501,
           'class_loss': 0.01696342,
           'conf_loss': 0.020201849,
           'precision50': 0.4490445,
           'recall50': 0.10995369},
     '5': {'avg_iou': 0.7669687,
           'avg_obj': 0.3041321,
           'box_loss': 0.010897392,
           'class_loss': 0.013682501,
           'conf_loss': 0.019632911,
           'precision50': 0.6352355,
           'recall50': 0.26532882},
     'global': {'total_loss': 1.1280234},
     'learning_rate': 0.009470752,
     'training_loss': 1.1280234}
train | step:  55000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6327932,
           'avg_obj': 0.10111653,
           'box_loss': 0.013536705,
           'class_loss': 0.016958216,
           'conf_loss': 0.016177919,
           'precision50': 0.17199595,
           'recall50': 0.025622787},
     '4': {'avg_iou': 0.7139291,
           'avg_obj': 0.19212973,
           'box_loss': 0.012370141,
           'class_loss': 0.016560443,
           'conf_loss': 0.02006254,
           'precision50': 0.45842364,
           'recall50': 0.11576244},
     '5': {'avg_iou': 0.77032304,
           'avg_obj': 0.31114894,
           'box_loss': 0.010728319,
           'class_loss': 0.013266994,
           'conf_loss': 0.019483812,
           'precision50': 0.64330554,
           'recall50': 0.27540848},
     'global': {'total_loss': 1.1131623},
     'learning_rate': 0.0093452055,
     'training_loss': 1.1131623}
train | step:  60000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6354745,
           'avg_obj': 0.1047683,
           'box_loss': 0.013449081,
           'class_loss': 0.016776947,
           'conf_loss': 0.016115783,
           'precision50': 0.17994389,
           'recall50': 0.027846271},
     '4': {'avg_iou': 0.7167544,
           'avg_obj': 0.19789161,
           'box_loss': 0.012236335,
           'class_loss': 0.016113816,
           'conf_loss': 0.019965207,
           'precision50': 0.46824452,
           'recall50': 0.12242352},
     '5': {'avg_iou': 0.77288675,
           'avg_obj': 0.3178382,
           'box_loss': 0.010595229,
           'class_loss': 0.012901199,
           'conf_loss': 0.019310394,
           'precision50': 0.6509044,
           'recall50': 0.2852259},
     'global': {'total_loss': 1.0997128},
     'learning_rate': 0.009207607,
     'training_loss': 1.0997128}
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=180.44s).
Accumulating evaluation results...
DONE (t=35.65s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.141
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.208
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.152
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.016
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.079
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.209
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.212
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.370
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.389
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.077
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.312
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.551
 eval | step:  60000 | eval time:  552.1 sec | output: 
    {'3': {'avg_iou': 0.4331629,
           'avg_obj': 0.087962344,
           'box_loss': 0.008157496,
           'class_loss': 0.01255489,
           'conf_loss': 0.0063102064,
           'precision50': 0.091494925,
           'recall50': 0.04738328},
     '4': {'avg_iou': 0.6474828,
           'avg_obj': 0.22786182,
           'box_loss': 0.0090694465,
           'class_loss': 0.013402786,
           'conf_loss': 0.008062156,
           'precision50': 0.19926381,
           'recall50': 0.19986162},
     '5': {'avg_iou': 0.78933,
           'avg_obj': 0.39369276,
           'box_loss': 0.008939539,
           'class_loss': 0.010104743,
           'conf_loss': 0.00902507,
           'precision50': 0.27854812,
           'recall50': 0.39367294},
     'AP': 0.1410301,
     'AP50': 0.20818743,
     'AP75': 0.15192801,
     'APl': 0.20859994,
     'APm': 0.07933376,
     'APs': 0.015698459,
     'ARl': 0.55119437,
     'ARm': 0.3120999,
     'ARmax1': 0.21161689,
     'ARmax10': 0.3700451,
     'ARmax100': 0.38935497,
     'ARs': 0.0768961,
     'global': {'total_loss': 0.0856263},
     'validation_loss': 0.0856263}I0412 14:17:11.031544 140219636086592 controller.py:211] train | step:  60000 | training until step 80000...
I0412 14:54:50.533435 140219636086592 controller.py:425] train | step:  65000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6386631,
           'avg_obj': 0.1078626,
           'box_loss': 0.013316867,
           'class_loss': 0.016580358,
           'conf_loss': 0.016012251,
           'precision50': 0.18719897,
           'recall50': 0.02995326},
     '4': {'avg_iou': 0.7197237,
           'avg_obj': 0.20217642,
           'box_loss': 0.012100414,
           'class_loss': 0.015715437,
           'conf_loss': 0.019773398,
           'precision50': 0.47361392,
           'recall50': 0.1269547},
     '5': {'avg_iou': 0.77598274,
           'avg_obj': 0.32342118,
           'box_loss': 0.010446768,
           'class_loss': 0.012582909,
           'conf_loss': 0.019147595,
           'precision50': 0.6563818,
           'recall50': 0.29379728},
     'global': {'total_loss': 1.0854071},
     'learning_rate': 0.009109423,
     'training_loss': 1.0854071}
I0412 14:55:36.608926 140219636086592 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-og-darknet-specials/ckpt-65000.
I0412 15:27:43.167085 140219636086592 controller.py:425] train | step:  70000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.64054126,
           'avg_obj': 0.11107328,
           'box_loss': 0.013259549,
           'class_loss': 0.016439386,
           'conf_loss': 0.015855258,
           'precision50': 0.1932561,
           'recall50': 0.03172344},
     '4': {'avg_iou': 0.72215265,
           'avg_obj': 0.20692544,
           'box_loss': 0.0119897565,
           'class_loss': 0.015362352,
           'conf_loss': 0.019628838,
           'precision50': 0.48273847,
           'recall50': 0.13356096},
     '5': {'avg_iou': 0.77808154,
           'avg_obj': 0.32873765,
           'box_loss': 0.0103361355,
           'class_loss': 0.012283292,
           'conf_loss': 0.019033268,
           'precision50': 0.6619453,
           'recall50': 0.30217877},
     'global': {'total_loss': 1.0735036},
     'learning_rate': 0.008952862,
     'training_loss': 1.0735036}
I0412 15:59:55.232778 140219636086592 controller.py:425] train | step:  75000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.64234775,
           'avg_obj': 0.113097094,
           'box_loss': 0.0132064605,
           'class_loss': 0.016284565,
           'conf_loss': 0.015836863,
           'precision50': 0.19860476,
           'recall50': 0.033331502},
     '4': {'avg_iou': 0.72445095,
           'avg_obj': 0.21013708,
           'box_loss': 0.011898427,
           'class_loss': 0.015056161,
           'conf_loss': 0.0195717,
           'precision50': 0.48796996,
           'recall50': 0.13719174},
     '5': {'avg_iou': 0.7803392,
           'avg_obj': 0.33329841,
           'box_loss': 0.010228421,
           'class_loss': 0.011998635,
           'conf_loss': 0.018936688,
           'precision50': 0.6668092,
           'recall50': 0.30826095},
     'global': {'total_loss': 1.064144},
     'learning_rate': 0.008785662,
     'training_loss': 1.064144}
I0412 16:32:14.193751 140219636086592 controller.py:425] train | step:  80000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.64459026,
           'avg_obj': 0.1161447,
           'box_loss': 0.013119253,
           'class_loss': 0.016089637,
           'conf_loss': 0.015776064,
           'precision50': 0.20630613,
           'recall50': 0.03573975},
     '4': {'avg_iou': 0.7266469,
           'avg_obj': 0.21465613,
           'box_loss': 0.0118033,
           'class_loss': 0.014719093,
           'conf_loss': 0.019491198,
           'precision50': 0.4956268,
           'recall50': 0.14279905},
     '5': {'avg_iou': 0.78274786,
           'avg_obj': 0.33860987,
           'box_loss': 0.010109967,
           'class_loss': 0.0117249545,
           'conf_loss': 0.0188346,
           'precision50': 0.6713563,
           'recall50': 0.3159967},
     'global': {'total_loss': 1.0533466},
     'learning_rate': 0.008668582,
     'training_loss': 1.0533466}
I0412 16:32:30.162160 140219636086592 controller.py:252]  eval | step:  80000 | running 625 steps of evaluation...
I0412 16:37:13.928672 140219636086592 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0412 16:41:31.559870 140219636086592 controller.py:261]  eval | step:  80000 | eval time:  541.4 sec | output: 
    {'3': {'avg_iou': 0.43668368,
           'avg_obj': 0.09989625,
           'box_loss': 0.007981094,
           'class_loss': 0.011850653,
           'conf_loss': 0.00631002,
           'precision50': 0.103295065,
           'recall50': 0.06390924},
     '4': {'avg_iou': 0.653166,
           'avg_obj': 0.24895494,
           'box_loss': 0.008782727,
           'class_loss': 0.011715993,
           'conf_loss': 0.008064492,
           'precision50': 0.21109748,
           'recall50': 0.22875449},
     '5': {'avg_iou': 0.79718673,
           'avg_obj': 0.4194247,
           'box_loss': 0.008543683,
           'class_loss': 0.00877873,
           'conf_loss': 0.009108732,
           'precision50': 0.2844463,
           'recall50': 0.4311766},
     'AP': 0.17482409,
     'AP50': 0.25628257,
     'AP75': 0.18746968,
     'APl': 0.2545837,
     'APm': 0.10700528,
     'APs': 0.025155481,
     'ARl': 0.58196783,
     'ARm': 0.35400832,
     'ARmax1': 0.23103526,
     'ARmax10': 0.39753067,
     'ARmax100': 0.42191598,
     'ARs': 0.097347885,
     'global': {'total_loss': 0.08113609},
     'validation_loss': 0.08113609}
I0412 16:41:48.759280 140219636086592 controller.py:211] train | step:  80000 | training until step 100000...
/home/cam2tensorflow/.experiment_start.sh: line 22: 12714 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4-$5
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   207    0     2  100   205     13   1375 --:--:-- --:--:-- --:--:--  1389
okRequest issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-12T16:49:37.890449749Z'
  endTime: '2021-04-12T16:50:39.744455037Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618246177877-5bfc94c976c1d-246a70e0-017c72fb
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618246177877-5bfc94c976c1d-246a70e0-017c72fb] to complete...
...........................................................................................................................................................................................................................................................................................................................................................................................done.
