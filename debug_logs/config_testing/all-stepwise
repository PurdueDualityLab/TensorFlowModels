cat: .experiment_zone: No such file or directory
Request issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-11T07:20:44.370558229Z'
  endTime: '2021-04-11T07:21:23.610841317Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618125644358-5bfad3c3be4b7-931cb05a-5dc8ac7c
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618125644358-5bfad3c3be4b7-931cb05a-5dc8ac7c] to complete...
..................................................................................................................................................................................................................................................................................done.
europe-west4-a
I0411 07:20:54.336927 140530602018624 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.075,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.2,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 0.6,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.05,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.2,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.667,
                                                    'output_size': [640, 640],
                                                    'random_crop': True,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': 'str = "AP50"',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'str = "higher"',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [200000,
                                                                                250000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.01,
                                                                            0.006,
                                                                            0.002]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.937,
                                                        'name': 'SGD',
                                                        'nesterov': False},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5625},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0411 07:20:54.339676 140530602018624 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_testing/all-stepwise/params.yaml
I0411 07:20:56.584744 140530602018624 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 07:20:56.726845 140530602018624 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0411 07:20:56.727202 140530602018624 transport.py:157] Attempting refresh to obtain initial access_token
I0411 07:20:56.772878 140530602018624 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 07:20:56.915886 140530602018624 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0411 07:20:56.916143 140530602018624 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-11 07:20:56.959507: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0411 07:20:56.960166 140530602018624 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 07:20:57.100111 140530602018624 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0411 07:20:57.100358 140530602018624 transport.py:157] Attempting refresh to obtain initial access_token
I0411 07:20:57.169475 140530602018624 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 07:20:57.785488 140530602018624 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0411 07:20:57.785979 140530602018624 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-11 07:20:57.841523: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-11 07:20:57.868681: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-04-11 07:20:57.868763: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:55166}
2021-04-11 07:21:09.090662: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-04-11 07:21:09.090779: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:55166}
2021-04-11 07:21:09.091723: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:55166
I0411 07:21:09.092526 140530602018624 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-1
I0411 07:21:09.093273 140530602018624 tpu_strategy_util.py:74] Initializing the TPU system: node-1
INFO:tensorflow:Clearing out eager caches
I0411 07:21:17.314701 140530602018624 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0411 07:21:17.317067 140530602018624 tpu_strategy_util.py:133] Finished initializing TPU system.
I0411 07:21:17.318634 140530602018624 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 07:21:17.939622 140530602018624 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0411 07:21:17.939906 140530602018624 transport.py:157] Attempting refresh to obtain initial access_token
I0411 07:21:17.998329 140530602018624 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 07:21:18.615605 140530602018624 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0411 07:21:18.615883 140530602018624 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0411 07:21:18.654822 140530602018624 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0411 07:21:18.655053 140530602018624 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0411 07:21:18.655307 140530602018624 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0411 07:21:18.655365 140530602018624 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0411 07:21:18.655411 140530602018624 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0411 07:21:18.655520 140530602018624 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0411 07:21:18.655566 140530602018624 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0411 07:21:18.655609 140530602018624 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0411 07:21:18.655651 140530602018624 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0411 07:21:18.655691 140530602018624 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0411 07:21:18.655731 140530602018624 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0411 07:21:18.655835 140530602018624 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0411 07:21:18.655912 140530602018624 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0411 07:21:18.655953 140530602018624 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0411 07:21:18.655994 140530602018624 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0411 07:21:18.656035 140530602018624 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0411 07:21:18.693467 140530602018624 train_utils.py:214] Running default trainer.
2021-04-11 07:21:18.704571: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.05, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.6, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.667, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': False, 'momentum': 0.937}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [200000, 250000], 'values': [0.01, 0.006, 0.002]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5625}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': 'str = "AP50"', 'best_checkpoint_metric_comp': 'str = "higher"', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
{'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7fcf70624048>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
route_split 512.0 512.0
conv2 512.0
conv1 512.0
spp
conv1 512.0
conv2 512.0
connect
conv1 512.0
8
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
route_split 256.0 256.0
conv2 256.0
conv1 256.0
conv2 256.0
connect
conv1 256.0
6
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)








 ListWrapper([128, 256, 512])
route_split 128 128
conv2 128
conv1 128
conv2 128
connect
conv1 128
conv2 256
7
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
route_split 256 256
conv2 256
conv1 256
conv2 256
connect
conv1 256
conv2 512
7
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
route_split 512 512
conv2 512
conv1 512
conv2 512
connect
conv1 512
conv2 1024
7
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
detget {'3': 2.0, '4': 2.0, '5': 2.0}I0411 07:22:09.798915 140530602018624 controller.py:362] restoring or initializing model...
I0411 07:22:19.358838 140530602018624 yolo.py:517] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0411 07:22:19.360425 140530602018624 controller.py:368] initialized model.
I0411 07:22:19.360622 140530602018624 train_lib.py:96] Starts to execute mode: train_and_eval
I0411 07:22:19.365620 140530602018624 controller.py:211] train | step:      0 | training until step 20000...
I0411 07:22:28.365756 140530602018624 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0411 07:23:24.062609 140530602018624 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0411 08:01:22.604230 140530602018624 controller.py:425] train | step:   5000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.4242869,
           'avg_obj': 0.086449176,
           'box_loss': 0.02184647,
           'class_loss': 0.10132405,
           'conf_loss': 0.36155826,
           'precision50': 0.011156831,
           'recall50': 0.037739735},
     '4': {'avg_iou': 0.4687151,
           'avg_obj': 0.12431858,
           'box_loss': 0.02398352,
           'class_loss': 0.11222139,
           'conf_loss': 0.11592613,
           'precision50': 0.08219665,
           'recall50': 0.05653557},
     '5': {'avg_iou': 0.4844294,
           'avg_obj': 0.17380778,
           'box_loss': 0.025310759,
           'class_loss': 0.112333596,
           'conf_loss': 0.06357326,
           'precision50': 0.20689408,
           'recall50': 0.08614679},
     'global': {'total_loss': 7.504639},
     'learning_rate': 0.006242951,
     'training_loss': 7.504639}
I0411 08:02:14.506224 140530602018624 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-stepwise/ckpt-5000.
I0411 08:35:07.286241 140530602018624 controller.py:425] train | step:  10000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.55239177,
           'avg_obj': 0.07818086,
           'box_loss': 0.016586274,
           'class_loss': 0.012447978,
           'conf_loss': 0.015172805,
           'precision50': 0.13093391,
           'recall50': 0.0148159955},
     '4': {'avg_iou': 0.6178965,
           'avg_obj': 0.14759713,
           'box_loss': 0.016824558,
           'class_loss': 0.013167543,
           'conf_loss': 0.019142127,
           'precision50': 0.37733278,
           'recall50': 0.062897205},
     '5': {'avg_iou': 0.66104627,
           'avg_obj': 0.23390026,
           'box_loss': 0.016291063,
           'class_loss': 0.012522206,
           'conf_loss': 0.019255009,
           'precision50': 0.56778914,
           'recall50': 0.15406722},
     'global': {'total_loss': 1.1312766},
     'learning_rate': 0.01,
     'training_loss': 1.1312766}
I0411 09:06:49.855420 140530602018624 controller.py:425] train | step:  15000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.5888737,
           'avg_obj': 0.111786254,
           'box_loss': 0.015185937,
           'class_loss': 0.009443349,
           'conf_loss': 0.014444415,
           'precision50': 0.21408506,
           'recall50': 0.03268536},
     '4': {'avg_iou': 0.6685373,
           'avg_obj': 0.20133092,
           'box_loss': 0.014469546,
           'class_loss': 0.009655308,
           'conf_loss': 0.018243775,
           'precision50': 0.5014415,
           'recall50': 0.119265676},
     '5': {'avg_iou': 0.71907604,
           'avg_obj': 0.30454665,
           'box_loss': 0.013345159,
           'class_loss': 0.009173141,
           'conf_loss': 0.01824158,
           'precision50': 0.6741204,
           'recall50': 0.261297},
     'global': {'total_loss': 0.97761756},
     'learning_rate': 0.01,
     'training_loss': 0.97761756}

(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 80, 80, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 640, 640, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 400, 8), 5: (8, 200, 8)}, inds: {3: (8, 600, 3), 4: (8, 400, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 80, 80, 3, 1), 4: (8, 40, 40, 3, 1), 5: (8, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 640, 640, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 80, 80, 3, 1), 4: (1, 40, 40, 3, 1), 5: (1, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
train | step:   5000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.4242869,
           'avg_obj': 0.086449176,
           'box_loss': 0.02184647,
           'class_loss': 0.10132405,
           'conf_loss': 0.36155826,
           'precision50': 0.011156831,
           'recall50': 0.037739735},
     '4': {'avg_iou': 0.4687151,
           'avg_obj': 0.12431858,
           'box_loss': 0.02398352,
           'class_loss': 0.11222139,
           'conf_loss': 0.11592613,
           'precision50': 0.08219665,
           'recall50': 0.05653557},
     '5': {'avg_iou': 0.4844294,
           'avg_obj': 0.17380778,
           'box_loss': 0.025310759,
           'class_loss': 0.112333596,
           'conf_loss': 0.06357326,
           'precision50': 0.20689408,
           'recall50': 0.08614679},
     'global': {'total_loss': 7.504639},
     'learning_rate': 0.006242951,
     'training_loss': 7.504639}
saved checkpoint to gs://tensorflow2/config_testing/all-stepwise/ckpt-5000.
train | step:  10000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.55239177,
           'avg_obj': 0.07818086,
           'box_loss': 0.016586274,
           'class_loss': 0.012447978,
           'conf_loss': 0.015172805,
           'precision50': 0.13093391,
           'recall50': 0.0148159955},
     '4': {'avg_iou': 0.6178965,
           'avg_obj': 0.14759713,
           'box_loss': 0.016824558,
           'class_loss': 0.013167543,
           'conf_loss': 0.019142127,
           'precision50': 0.37733278,
           'recall50': 0.062897205},
     '5': {'avg_iou': 0.66104627,
           'avg_obj': 0.23390026,
           'box_loss': 0.016291063,
           'class_loss': 0.012522206,
           'conf_loss': 0.019255009,
           'precision50': 0.56778914,
           'recall50': 0.15406722},
     'global': {'total_loss': 1.1312766},
     'learning_rate': 0.01,
     'training_loss': 1.1312766}
train | step:  15000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.5888737,
           'avg_obj': 0.111786254,
           'box_loss': 0.015185937,
           'class_loss': 0.009443349,
           'conf_loss': 0.014444415,
           'precision50': 0.21408506,
           'recall50': 0.03268536},
     '4': {'avg_iou': 0.6685373,
           'avg_obj': 0.20133092,
           'box_loss': 0.014469546,
           'class_loss': 0.009655308,
           'conf_loss': 0.018243775,
           'precision50': 0.5014415,
           'recall50': 0.119265676},
     '5': {'avg_iou': 0.71907604,
           'avg_obj': 0.30454665,
           'box_loss': 0.013345159,
           'class_loss': 0.009173141,
           'conf_loss': 0.01824158,
           'precision50': 0.6741204,
           'recall50': 0.261297},
     'global': {'total_loss': 0.97761756},
     'learning_rate': 0.01,
     'training_loss': 0.97761756}I0411 09:38:59.241814 140530602018624 controller.py:425] train | step:  20000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6056032,
           'avg_obj': 0.12877747,
           'box_loss': 0.014575696,
           'class_loss': 0.008385415,
           'conf_loss': 0.014178873,
           'precision50': 0.25229806,
           'recall50': 0.044992927},
     '4': {'avg_iou': 0.6895148,
           'avg_obj': 0.22756504,
           'box_loss': 0.013520485,
           'class_loss': 0.008425953,
           'conf_loss': 0.017778113,
           'precision50': 0.5392824,
           'recall50': 0.15182497},
     '5': {'avg_iou': 0.7418671,
           'avg_obj': 0.33775032,
           'box_loss': 0.012199472,
           'class_loss': 0.00797531,
           'conf_loss': 0.017690292,
           'precision50': 0.7036986,
           'recall50': 0.31349337},
     'global': {'total_loss': 0.91783625},
     'learning_rate': 0.01,
     'training_loss': 0.91783625}
I0411 09:39:10.902426 140530602018624 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0411 09:39:11.575501 140530602018624 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0411 09:39:29.748941 140530602018624 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0411 09:44:50.874318 140530602018624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0411 09:49:41.544718 140530602018624 controller.py:261]  eval | step:  20000 | eval time:  630.6 sec | output: 
    {'3': {'avg_iou': 0.42682353,
           'avg_obj': 0.124522544,
           'box_loss': 0.008474723,
           'class_loss': 0.004034756,
           'conf_loss': 0.0059571867,
           'precision50': 0.13798611,
           'recall50': 0.0935287},
     '4': {'avg_iou': 0.64248043,
           'avg_obj': 0.2799658,
           'box_loss': 0.009314211,
           'class_loss': 0.004567151,
           'conf_loss': 0.007654911,
           'precision50': 0.25219807,
           'recall50': 0.27158433},
     '5': {'avg_iou': 0.7872028,
           'avg_obj': 0.43033648,
           'box_loss': 0.009040414,
           'class_loss': 0.0046378304,
           'conf_loss': 0.008511863,
           'precision50': 0.3270799,
           'recall50': 0.46409434},
     'AP': 0.29696718,
     'AP50': 0.48393437,
     'AP75': 0.31286693,
     'APl': 0.39813805,
     'APm': 0.24878268,
     'APs': 0.08851511,
     'ARl': 0.6160222,
     'ARm': 0.46641624,
     'ARmax1': 0.26913112,
     'ARmax10': 0.45068368,
     'ARmax100': 0.49568516,
     'ARs': 0.20551383,
     'global': {'total_loss': 0.062193047},
     'validation_loss': 0.062193047}
I0411 09:50:04.019797 140530602018624 controller.py:211] train | step:  20000 | training until step 40000...
I0411 10:21:27.332621 140530602018624 controller.py:425] train | step:  25000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.6172898,
           'avg_obj': 0.14131624,
           'box_loss': 0.014118811,
           'class_loss': 0.0077216653,
           'conf_loss': 0.014006959,
           'precision50': 0.27553844,
           'recall50': 0.0543237},
     '4': {'avg_iou': 0.7025013,
           'avg_obj': 0.24508916,
           'box_loss': 0.012937962,
           'class_loss': 0.007687957,
           'conf_loss': 0.017512929,
           'precision50': 0.55911666,
           'recall50': 0.17313308},
     '5': {'avg_iou': 0.7555568,
           'avg_obj': 0.35908377,
           'box_loss': 0.0115185,
           'class_loss': 0.007255346,
           'conf_loss': 0.0173211,
           'precision50': 0.7185214,
           'recall50': 0.34534964},
     'global': {'total_loss': 0.8806489},
     'learning_rate': 0.01,
     'training_loss': 0.8806489}
I0411 10:22:13.820467 140530602018624 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-stepwise/ckpt-25000.
I0411 10:54:54.661998 140530602018624 controller.py:425] train | step:  30000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6247378,
           'avg_obj': 0.14966427,
           'box_loss': 0.013870682,
           'class_loss': 0.0072871484,
           'conf_loss': 0.013879552,
           'precision50': 0.29210696,
           'recall50': 0.060952477},
     '4': {'avg_iou': 0.7116845,
           'avg_obj': 0.25806862,
           'box_loss': 0.012514705,
           'class_loss': 0.00719942,
           'conf_loss': 0.01729382,
           'precision50': 0.5725391,
           'recall50': 0.18958476},
     '5': {'avg_iou': 0.7657734,
           'avg_obj': 0.37515065,
           'box_loss': 0.011003037,
           'class_loss': 0.006755406,
           'conf_loss': 0.01704171,
           'precision50': 0.7294271,
           'recall50': 0.36984128},
     'global': {'total_loss': 0.854764},
     'learning_rate': 0.01,
     'training_loss': 0.854764}
I0411 11:26:26.865997 140530602018624 controller.py:425] train | step:  35000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.63140893,
           'avg_obj': 0.1569252,
           'box_loss': 0.013612895,
           'class_loss': 0.006962646,
           'conf_loss': 0.013732802,
           'precision50': 0.30374208,
           'recall50': 0.06673223},
     '4': {'avg_iou': 0.7188793,
           'avg_obj': 0.26862177,
           'box_loss': 0.012181586,
           'class_loss': 0.006810221,
           'conf_loss': 0.017069027,
           'precision50': 0.581497,
           'recall50': 0.20226492},
     '5': {'avg_iou': 0.7730914,
           'avg_obj': 0.38759917,
           'box_loss': 0.010635182,
           'class_loss': 0.0063994126,
           'conf_loss': 0.016777163,
           'precision50': 0.73613155,
           'recall50': 0.38748983},
     'global': {'total_loss': 0.8334479},
     'learning_rate': 0.01,
     'training_loss': 0.8334479}
I0411 11:59:17.978398 140530602018624 controller.py:425] train | step:  40000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.63682014,
           'avg_obj': 0.16316062,
           'box_loss': 0.013404094,
           'class_loss': 0.0066640778,
           'conf_loss': 0.013633882,
           'precision50': 0.31537932,
           'recall50': 0.071673095},
     '4': {'avg_iou': 0.7258657,
           'avg_obj': 0.27851146,
           'box_loss': 0.011861631,
           'class_loss': 0.006477468,
           'conf_loss': 0.016919844,
           'precision50': 0.5906929,
           'recall50': 0.21520759},
     '5': {'avg_iou': 0.7787766,
           'avg_obj': 0.39807892,
           'box_loss': 0.010359736,
           'class_loss': 0.0060920697,
           'conf_loss': 0.0165559,
           'precision50': 0.7428733,
           'recall50': 0.40308148},
     'global': {'total_loss': 0.81574905},
     'learning_rate': 0.01,
     'training_loss': 0.81574905}
I0411 11:59:31.260445 140530602018624 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0411 12:04:12.514933 140530602018624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.

train | step:  20000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6056032,
           'avg_obj': 0.12877747,
           'box_loss': 0.014575696,
           'class_loss': 0.008385415,
           'conf_loss': 0.014178873,
           'precision50': 0.25229806,
           'recall50': 0.044992927},
     '4': {'avg_iou': 0.6895148,
           'avg_obj': 0.22756504,
           'box_loss': 0.013520485,
           'class_loss': 0.008425953,
           'conf_loss': 0.017778113,
           'precision50': 0.5392824,
           'recall50': 0.15182497},
     '5': {'avg_iou': 0.7418671,
           'avg_obj': 0.33775032,
           'box_loss': 0.012199472,
           'class_loss': 0.00797531,
           'conf_loss': 0.017690292,
           'precision50': 0.7036986,
           'recall50': 0.31349337},
     'global': {'total_loss': 0.91783625},
     'learning_rate': 0.01,
     'training_loss': 0.91783625}
 eval | step:  20000 | running 625 steps of evaluation...
(1, 20, 20, 512) (1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 2048)
(1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 1024)
(1, 20, 20, 512)
(1, 40, 40, 256) (1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 512)
(1, 40, 40, 256)
(1, 80, 80, 128) (1, 80, 80, 128)
(1, 80, 80, 128)
(1, 80, 80, 128)
(1, 80, 80, 128)
(1, 80, 80, 256)
(1, 80, 80, 128)
(1, 80, 80, 256)
(1, 40, 40, 256) (1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 512)
(1, 40, 40, 256)
(1, 40, 40, 512)
(1, 20, 20, 512) (1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 1024)
(1, 20, 20, 512)
(1, 20, 20, 1024)
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=201.57s).
Accumulating evaluation results...
DONE (t=20.81s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.297
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.484
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.313
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.089
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.249
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.398
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.269
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.451
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.496
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.206
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.466
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.616
 eval | step:  20000 | eval time:  630.6 sec | output: 
    {'3': {'avg_iou': 0.42682353,
           'avg_obj': 0.124522544,
           'box_loss': 0.008474723,
           'class_loss': 0.004034756,
           'conf_loss': 0.0059571867,
           'precision50': 0.13798611,
           'recall50': 0.0935287},
     '4': {'avg_iou': 0.64248043,
           'avg_obj': 0.2799658,
           'box_loss': 0.009314211,
           'class_loss': 0.004567151,
           'conf_loss': 0.007654911,
           'precision50': 0.25219807,
           'recall50': 0.27158433},
     '5': {'avg_iou': 0.7872028,
           'avg_obj': 0.43033648,
           'box_loss': 0.009040414,
           'class_loss': 0.0046378304,
           'conf_loss': 0.008511863,
           'precision50': 0.3270799,
           'recall50': 0.46409434},
     'AP': 0.29696718,
     'AP50': 0.48393437,
     'AP75': 0.31286693,
     'APl': 0.39813805,
     'APm': 0.24878268,
     'APs': 0.08851511,
     'ARl': 0.6160222,
     'ARm': 0.46641624,
     'ARmax1': 0.26913112,
     'ARmax10': 0.45068368,
     'ARmax100': 0.49568516,
     'ARs': 0.20551383,
     'global': {'total_loss': 0.062193047},
     'validation_loss': 0.062193047}
train | step:  20000 | training until step 40000...
train | step:  25000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.6172898,
           'avg_obj': 0.14131624,
           'box_loss': 0.014118811,
           'class_loss': 0.0077216653,
           'conf_loss': 0.014006959,
           'precision50': 0.27553844,
           'recall50': 0.0543237},
     '4': {'avg_iou': 0.7025013,
           'avg_obj': 0.24508916,
           'box_loss': 0.012937962,
           'class_loss': 0.007687957,
           'conf_loss': 0.017512929,
           'precision50': 0.55911666,
           'recall50': 0.17313308},
     '5': {'avg_iou': 0.7555568,
           'avg_obj': 0.35908377,
           'box_loss': 0.0115185,
           'class_loss': 0.007255346,
           'conf_loss': 0.0173211,
           'precision50': 0.7185214,
           'recall50': 0.34534964},
     'global': {'total_loss': 0.8806489},
     'learning_rate': 0.01,
     'training_loss': 0.8806489}
saved checkpoint to gs://tensorflow2/config_testing/all-stepwise/ckpt-25000.
train | step:  30000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6247378,
           'avg_obj': 0.14966427,
           'box_loss': 0.013870682,
           'class_loss': 0.0072871484,
           'conf_loss': 0.013879552,
           'precision50': 0.29210696,
           'recall50': 0.060952477},
     '4': {'avg_iou': 0.7116845,
           'avg_obj': 0.25806862,
           'box_loss': 0.012514705,
           'class_loss': 0.00719942,
           'conf_loss': 0.01729382,
           'precision50': 0.5725391,
           'recall50': 0.18958476},
     '5': {'avg_iou': 0.7657734,
           'avg_obj': 0.37515065,
           'box_loss': 0.011003037,
           'class_loss': 0.006755406,
           'conf_loss': 0.01704171,
           'precision50': 0.7294271,
           'recall50': 0.36984128},
     'global': {'total_loss': 0.854764},
     'learning_rate': 0.01,
     'training_loss': 0.854764}
train | step:  35000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.63140893,
           'avg_obj': 0.1569252,
           'box_loss': 0.013612895,
           'class_loss': 0.006962646,
           'conf_loss': 0.013732802,
           'precision50': 0.30374208,
           'recall50': 0.06673223},
     '4': {'avg_iou': 0.7188793,
           'avg_obj': 0.26862177,
           'box_loss': 0.012181586,
           'class_loss': 0.006810221,
           'conf_loss': 0.017069027,
           'precision50': 0.581497,
           'recall50': 0.20226492},
     '5': {'avg_iou': 0.7730914,
           'avg_obj': 0.38759917,
           'box_loss': 0.010635182,
           'class_loss': 0.0063994126,
           'conf_loss': 0.016777163,
           'precision50': 0.73613155,
           'recall50': 0.38748983},
     'global': {'total_loss': 0.8334479},
     'learning_rate': 0.01,
     'training_loss': 0.8334479}
train | step:  40000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.63682014,
           'avg_obj': 0.16316062,
           'box_loss': 0.013404094,
           'class_loss': 0.0066640778,
           'conf_loss': 0.013633882,
           'precision50': 0.31537932,
           'recall50': 0.071673095},
     '4': {'avg_iou': 0.7258657,
           'avg_obj': 0.27851146,
           'box_loss': 0.011861631,
           'class_loss': 0.006477468,
           'conf_loss': 0.016919844,
           'precision50': 0.5906929,
           'recall50': 0.21520759},
     '5': {'avg_iou': 0.7787766,
           'avg_obj': 0.39807892,
           'box_loss': 0.010359736,
           'class_loss': 0.0060920697,
           'conf_loss': 0.0165559,
           'precision50': 0.7428733,
           'recall50': 0.40308148},
     'global': {'total_loss': 0.81574905},
     'learning_rate': 0.01,
     'training_loss': 0.81574905}
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=225.06s).
Accumulating evaluation results...
DONE (t=25.40s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.357
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.555
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.381I0411 12:09:26.867544 140530602018624 controller.py:261]  eval | step:  40000 | eval time:  595.6 sec | output: 
    {'3': {'avg_iou': 0.43631494,
           'avg_obj': 0.14653389,
           'box_loss': 0.007999305,
           'class_loss': 0.0031043,
           'conf_loss': 0.005940298,
           'precision50': 0.14804952,
           'recall50': 0.12063557},
     '4': {'avg_iou': 0.65726644,
           'avg_obj': 0.31818426,
           'box_loss': 0.008572707,
           'class_loss': 0.003522843,
           'conf_loss': 0.007714661,
           'precision50': 0.25347504,
           'recall50': 0.32307866},
     '5': {'avg_iou': 0.8062208,
           'avg_obj': 0.4903251,
           'box_loss': 0.008085131,
           'class_loss': 0.003570498,
           'conf_loss': 0.008763172,
           'precision50': 0.32281733,
           'recall50': 0.54321194},
     'AP': 0.35683158,
     'AP50': 0.5549844,
     'AP75': 0.3814038,
     'APl': 0.47310957,
     'APm': 0.30737165,
     'APs': 0.1169823,
     'ARl': 0.66369,
     'ARm': 0.5250003,
     'ARmax1': 0.30339065,
     'ARmax10': 0.49988344,
     'ARmax100': 0.5466912,
     'ARs': 0.25724936,
     'global': {'total_loss': 0.057272892},
     'validation_loss': 0.057272892}
I0411 12:09:46.284832 140530602018624 controller.py:211] train | step:  40000 | training until step 60000...
I0411 12:45:05.680094 140530602018624 controller.py:425] train | step:  45000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6413957,
           'avg_obj': 0.16931345,
           'box_loss': 0.013195002,
           'class_loss': 0.0064267297,
           'conf_loss': 0.013525299,
           'precision50': 0.32181928,
           'recall50': 0.076079324},
     '4': {'avg_iou': 0.7299178,
           'avg_obj': 0.28581434,
           'box_loss': 0.011658059,
           'class_loss': 0.0062377634,
           'conf_loss': 0.016709289,
           'precision50': 0.59448135,
           'recall50': 0.22337219},
     '5': {'avg_iou': 0.7839052,
           'avg_obj': 0.40699518,
           'box_loss': 0.010091741,
           'class_loss': 0.0058723814,
           'conf_loss': 0.016343603,
           'precision50': 0.7463767,
           'recall50': 0.41505703},
     'global': {'total_loss': 0.8004766},
     'learning_rate': 0.01,
     'training_loss': 0.8004766}
I0411 12:45:54.841049 140530602018624 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-stepwise/ckpt-45000.
I0411 13:17:51.914800 140530602018624 controller.py:425] train | step:  50000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.64484036,
           'avg_obj': 0.17351724,
           'box_loss': 0.013098619,
           'class_loss': 0.006272444,
           'conf_loss': 0.013474579,
           'precision50': 0.32907367,
           'recall50': 0.08026042},
     '4': {'avg_iou': 0.73460174,
           'avg_obj': 0.29224178,
           'box_loss': 0.011471446,
           'class_loss': 0.0060368436,
           'conf_loss': 0.016649876,
           'precision50': 0.6009807,
           'recall50': 0.23156284},
     '5': {'avg_iou': 0.7884433,
           'avg_obj': 0.41444904,
           'box_loss': 0.009880836,
           'class_loss': 0.005664556,
           'conf_loss': 0.016243104,
           'precision50': 0.75052756,
           'recall50': 0.4257208},
     'global': {'total_loss': 0.7903388},
     'learning_rate': 0.01,
     'training_loss': 0.7903388}
I0411 13:49:46.937989 140530602018624 controller.py:425] train | step:  55000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.64852285,
           'avg_obj': 0.17796901,
           'box_loss': 0.012971878,
           'class_loss': 0.0061080707,
           'conf_loss': 0.013336404,
           'precision50': 0.33616033,
           'recall50': 0.08373304},
     '4': {'avg_iou': 0.73853713,
           'avg_obj': 0.29858932,
           'box_loss': 0.011300089,
           'class_loss': 0.00586087,
           'conf_loss': 0.016496414,
           'precision50': 0.6049463,
           'recall50': 0.23946008},
     '5': {'avg_iou': 0.79216,
           'avg_obj': 0.42174077,
           'box_loss': 0.009691386,
           'class_loss': 0.005483044,
           'conf_loss': 0.01607391,
           'precision50': 0.7539148,
           'recall50': 0.43590292},
     'global': {'total_loss': 0.77857506},
     'learning_rate': 0.01,
     'training_loss': 0.77857506}
I0411 14:22:57.161749 140530602018624 controller.py:425] train | step:  60000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.65086186,
           'avg_obj': 0.18199785,
           'box_loss': 0.012891806,
           'class_loss': 0.005962147,
           'conf_loss': 0.013283255,
           'precision50': 0.34226328,
           'recall50': 0.0872073},
     '4': {'avg_iou': 0.7418425,
           'avg_obj': 0.30422735,
           'box_loss': 0.01114369,
           'class_loss': 0.005709302,
           'conf_loss': 0.01640472,
           'precision50': 0.61074156,
           'recall50': 0.24724329},
     '5': {'avg_iou': 0.7961527,
           'avg_obj': 0.42825866,
           'box_loss': 0.009495222,
           'class_loss': 0.005348525,
           'conf_loss': 0.015965328,
           'precision50': 0.75737303,
           'recall50': 0.44500023},
     'global': {'total_loss': 0.76963216},
     'learning_rate': 0.01,
     'training_loss': 0.76963216}
I0411 14:23:10.918972 140530602018624 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0411 14:27:56.594523 140530602018624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0411 14:33:11.062392 140530602018624 controller.py:261]  eval | step:  60000 | eval time:  600.1 sec | output: 
    {'3': {'avg_iou': 0.44098338,
           'avg_obj': 0.1569683,
           'box_loss': 0.007765495,
           'class_loss': 0.002799915,
           'conf_loss': 0.005911615,
           'precision50': 0.14859934,
           'recall50': 0.13448931},
     '4': {'avg_iou': 0.6641524,
           'avg_obj': 0.33776602,
           'box_loss': 0.008227124,
           'class_loss': 0.00314972,
           'conf_loss': 0.00775926,
           'precision50': 0.2532035,
           'recall50': 0.35027072},
     '5': {'avg_iou': 0.81427383,
           'avg_obj': 0.51623625,
           'box_loss': 0.007681067,
           'class_loss': 0.003164781,
           'conf_loss': 0.0088941865,
           'precision50': 0.31960812,
           'recall50': 0.5751053},
     'AP': 0.38351586,
     'AP50': 0.58405435,
     'AP75': 0.41150165,
     'APl': 0.5043856,
     'APm': 0.33562443,
     'APs': 0.134037,
     'ARl': 0.6839817,
     'ARm': 0.54421514,
     'ARmax1': 0.31628746,
     'ARmax10': 0.51934844,
     'ARmax100': 0.5657332,
     'ARs': 0.27936846,
     'global': {'total_loss': 0.055353172},
     'validation_loss': 0.055353172}
I0411 14:33:27.418175 140530602018624 controller.py:211] train | step:  60000 | training until step 80000...
I0411 15:06:35.641809 140530602018624 controller.py:425] train | step:  65000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6537384,
           'avg_obj': 0.18546775,
           'box_loss': 0.012744135,
           'class_loss': 0.0058339136,
           'conf_loss': 0.013247172,
           'precision50': 0.3463393,
           'recall50': 0.0900689},
     '4': {'avg_iou': 0.744933,
           'avg_obj': 0.30951408,
           'box_loss': 0.011009268,
           'class_loss': 0.0055684485,
           'conf_loss': 0.0162807,
           'precision50': 0.61367655,
           'recall50': 0.25380504},
     '5': {'avg_iou': 0.7988021,
           'avg_obj': 0.4336011,
           'box_loss': 0.009367813,
           'class_loss': 0.0052173105,
           'conf_loss': 0.015825512,
           'precision50': 0.76052225,
           'recall50': 0.4523227},
     'global': {'total_loss': 0.7607532},
     'learning_rate': 0.01,
     'training_loss': 0.7607532}

 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.117
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.307
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.473
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.303
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.500
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.547
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.257
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.525
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.664
 eval | step:  40000 | eval time:  595.6 sec | output: 
    {'3': {'avg_iou': 0.43631494,
           'avg_obj': 0.14653389,
           'box_loss': 0.007999305,
           'class_loss': 0.0031043,
           'conf_loss': 0.005940298,
           'precision50': 0.14804952,
           'recall50': 0.12063557},
     '4': {'avg_iou': 0.65726644,
           'avg_obj': 0.31818426,
           'box_loss': 0.008572707,
           'class_loss': 0.003522843,
           'conf_loss': 0.007714661,
           'precision50': 0.25347504,
           'recall50': 0.32307866},
     '5': {'avg_iou': 0.8062208,
           'avg_obj': 0.4903251,
           'box_loss': 0.008085131,
           'class_loss': 0.003570498,
           'conf_loss': 0.008763172,
           'precision50': 0.32281733,
           'recall50': 0.54321194},
     'AP': 0.35683158,
     'AP50': 0.5549844,
     'AP75': 0.3814038,
     'APl': 0.47310957,
     'APm': 0.30737165,
     'APs': 0.1169823,
     'ARl': 0.66369,
     'ARm': 0.5250003,
     'ARmax1': 0.30339065,
     'ARmax10': 0.49988344,
     'ARmax100': 0.5466912,
     'ARs': 0.25724936,
     'global': {'total_loss': 0.057272892},
     'validation_loss': 0.057272892}
train | step:  40000 | training until step 60000...
train | step:  45000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.6413957,
           'avg_obj': 0.16931345,
           'box_loss': 0.013195002,
           'class_loss': 0.0064267297,
           'conf_loss': 0.013525299,
           'precision50': 0.32181928,
           'recall50': 0.076079324},
     '4': {'avg_iou': 0.7299178,
           'avg_obj': 0.28581434,
           'box_loss': 0.011658059,
           'class_loss': 0.0062377634,
           'conf_loss': 0.016709289,
           'precision50': 0.59448135,
           'recall50': 0.22337219},
     '5': {'avg_iou': 0.7839052,
           'avg_obj': 0.40699518,
           'box_loss': 0.010091741,
           'class_loss': 0.0058723814,
           'conf_loss': 0.016343603,
           'precision50': 0.7463767,
           'recall50': 0.41505703},
     'global': {'total_loss': 0.8004766},
     'learning_rate': 0.01,
     'training_loss': 0.8004766}
saved checkpoint to gs://tensorflow2/config_testing/all-stepwise/ckpt-45000.
train | step:  50000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.64484036,
           'avg_obj': 0.17351724,
           'box_loss': 0.013098619,
           'class_loss': 0.006272444,
           'conf_loss': 0.013474579,
           'precision50': 0.32907367,
           'recall50': 0.08026042},
     '4': {'avg_iou': 0.73460174,
           'avg_obj': 0.29224178,
           'box_loss': 0.011471446,
           'class_loss': 0.0060368436,
           'conf_loss': 0.016649876,
           'precision50': 0.6009807,
           'recall50': 0.23156284},
     '5': {'avg_iou': 0.7884433,
           'avg_obj': 0.41444904,
           'box_loss': 0.009880836,
           'class_loss': 0.005664556,
           'conf_loss': 0.016243104,
           'precision50': 0.75052756,
           'recall50': 0.4257208},
     'global': {'total_loss': 0.7903388},
     'learning_rate': 0.01,
     'training_loss': 0.7903388}
train | step:  55000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.64852285,
           'avg_obj': 0.17796901,
           'box_loss': 0.012971878,
           'class_loss': 0.0061080707,
           'conf_loss': 0.013336404,
           'precision50': 0.33616033,
           'recall50': 0.08373304},
     '4': {'avg_iou': 0.73853713,
           'avg_obj': 0.29858932,
           'box_loss': 0.011300089,
           'class_loss': 0.00586087,
           'conf_loss': 0.016496414,
           'precision50': 0.6049463,
           'recall50': 0.23946008},
     '5': {'avg_iou': 0.79216,
           'avg_obj': 0.42174077,
           'box_loss': 0.009691386,
           'class_loss': 0.005483044,
           'conf_loss': 0.01607391,
           'precision50': 0.7539148,
           'recall50': 0.43590292},
     'global': {'total_loss': 0.77857506},
     'learning_rate': 0.01,
     'training_loss': 0.77857506}
train | step:  60000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.65086186,
           'avg_obj': 0.18199785,
           'box_loss': 0.012891806,
           'class_loss': 0.005962147,
           'conf_loss': 0.013283255,
           'precision50': 0.34226328,
           'recall50': 0.0872073},
     '4': {'avg_iou': 0.7418425,
           'avg_obj': 0.30422735,
           'box_loss': 0.01114369,
           'class_loss': 0.005709302,
           'conf_loss': 0.01640472,
           'precision50': 0.61074156,
           'recall50': 0.24724329},
     '5': {'avg_iou': 0.7961527,
           'avg_obj': 0.42825866,
           'box_loss': 0.009495222,
           'class_loss': 0.005348525,
           'conf_loss': 0.015965328,
           'precision50': 0.75737303,
           'recall50': 0.44500023},
     'global': {'total_loss': 0.76963216},
     'learning_rate': 0.01,
     'training_loss': 0.76963216}
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=214.64s).
Accumulating evaluation results...
DONE (t=16.70s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.384
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.584
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.412
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.134
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.336
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.504
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.316
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.519
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.566
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.279
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.544
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.684
 eval | step:  60000 | eval time:  600.1 sec | output: 
    {'3': {'avg_iou': 0.44098338,
           'avg_obj': 0.1569683,
           'box_loss': 0.007765495,
           'class_loss': 0.002799915,
           'conf_loss': 0.005911615,
           'precision50': 0.14859934,
           'recall50': 0.13448931},
     '4': {'avg_iou': 0.6641524,
           'avg_obj': 0.33776602,
           'box_loss': 0.008227124,
           'class_loss': 0.00314972,
           'conf_loss': 0.00775926,
           'precision50': 0.2532035,
           'recall50': 0.35027072},
     '5': {'avg_iou': 0.81427383,
           'avg_obj': 0.51623625,
           'box_loss': 0.007681067,
           'class_loss': 0.003164781,
           'conf_loss': 0.0088941865,
           'precision50': 0.31960812,
           'recall50': 0.5751053},
     'AP': 0.38351586,
     'AP50': 0.58405435,
     'AP75': 0.41150165,
     'APl': 0.5043856,
     'APm': 0.33562443,
     'APs': 0.134037,
     'ARl': 0.6839817,
     'ARm': 0.54421514,
     'ARmax1': 0.31628746,
     'ARmax10': 0.51934844,
     'ARmax100': 0.5657332,
     'ARs': 0.27936846,
     'global': {'total_loss': 0.055353172},
     'validation_loss': 0.055353172}
train | step:  60000 | training until step 80000...
train | step:  65000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6537384,
           'avg_obj': 0.18546775,
           'box_loss': 0.012744135,
           'class_loss': 0.0058339136,
           'conf_loss': 0.013247172,
           'precision50': 0.3463393,
           'recall50': 0.0900689},
     '4': {'avg_iou': 0.744933,
           'avg_obj': 0.30951408,
           'box_loss': 0.011009268,
           'class_loss': 0.0055684485,
           'conf_loss': 0.0162807,
           'precision50': 0.61367655,
           'recall50': 0.25380504},
     '5': {'avg_iou': 0.7988021,
           'avg_obj': 0.4336011,
           'box_loss': 0.009367813,
           'class_loss': 0.0052173105,
           'conf_loss': 0.015825512,
           'precision50': 0.76052225,
           'recall50': 0.4523227},
     'global': {'total_loss': 0.7607532},
     'learning_rate': 0.01,
     'training_loss': 0.7607532}I0411 15:07:22.875383 140530602018624 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-stepwise/ckpt-65000.
I0411 15:38:32.992903 140530602018624 controller.py:425] train | step:  70000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6561132,
           'avg_obj': 0.18904413,
           'box_loss': 0.012690238,
           'class_loss': 0.0057299277,
           'conf_loss': 0.01318736,
           'precision50': 0.35200253,
           'recall50': 0.09298893},
     '4': {'avg_iou': 0.7476159,
           'avg_obj': 0.31399557,
           'box_loss': 0.010891346,
           'class_loss': 0.0054465407,
           'conf_loss': 0.016201666,
           'precision50': 0.6171126,
           'recall50': 0.25932422},
     '5': {'avg_iou': 0.80050105,
           'avg_obj': 0.43813428,
           'box_loss': 0.009285028,
           'class_loss': 0.0051015457,
           'conf_loss': 0.015722176,
           'precision50': 0.7627492,
           'recall50': 0.45806324},
     'global': {'total_loss': 0.75404555},
     'learning_rate': 0.01,
     'training_loss': 0.75404555}
I0411 16:11:59.986045 140530602018624 controller.py:425] train | step:  75000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.65828913,
           'avg_obj': 0.19238207,
           'box_loss': 0.01261454,
           'class_loss': 0.005631707,
           'conf_loss': 0.013117888,
           'precision50': 0.3563671,
           'recall50': 0.09594947},
     '4': {'avg_iou': 0.7499984,
           'avg_obj': 0.31843668,
           'box_loss': 0.010776156,
           'class_loss': 0.005327325,
           'conf_loss': 0.01609307,
           'precision50': 0.61984724,
           'recall50': 0.26445717},
     '5': {'avg_iou': 0.80325085,
           'avg_obj': 0.44295624,
           'box_loss': 0.009144762,
           'class_loss': 0.004994287,
           'conf_loss': 0.015606177,
           'precision50': 0.76484925,
           'recall50': 0.46466187},
     'global': {'total_loss': 0.7464479},
     'learning_rate': 0.01,
     'training_loss': 0.7464479}
I0411 16:45:06.511005 140530602018624 controller.py:425] train | step:  80000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.66033596,
           'avg_obj': 0.19528314,
           'box_loss': 0.01251538,
           'class_loss': 0.0055203997,
           'conf_loss': 0.013021289,
           'precision50': 0.36005,
           'recall50': 0.09839119},
     '4': {'avg_iou': 0.75240964,
           'avg_obj': 0.32287797,
           'box_loss': 0.010666689,
           'class_loss': 0.0052112783,
           'conf_loss': 0.015982183,
           'precision50': 0.62426907,
           'recall50': 0.270596},
     '5': {'avg_iou': 0.80630106,
           'avg_obj': 0.4487144,
           'box_loss': 0.008987779,
           'class_loss': 0.0048733344,
           'conf_loss': 0.015497313,
           'precision50': 0.7672889,
           'recall50': 0.47210357},
     'global': {'total_loss': 0.7382035},
     'learning_rate': 0.01,
     'training_loss': 0.7382035}
I0411 16:45:20.123228 140530602018624 controller.py:252]  eval | step:  80000 | running 625 steps of evaluation...
I0411 16:50:01.951477 140530602018624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0411 16:54:30.852823 140530602018624 controller.py:261]  eval | step:  80000 | eval time:  550.7 sec | output: 
    {'3': {'avg_iou': 0.44388285,
           'avg_obj': 0.16410899,
           'box_loss': 0.0076179113,
           'class_loss': 0.0026173706,
           'conf_loss': 0.005933361,
           'precision50': 0.15026425,
           'recall50': 0.14546959},
     '4': {'avg_iou': 0.66741526,
           'avg_obj': 0.35036778,
           'box_loss': 0.0080639785,
           'class_loss': 0.002980489,
           'conf_loss': 0.007828889,
           'precision50': 0.25191063,
           'recall50': 0.36965832},
     '5': {'avg_iou': 0.81908834,
           'avg_obj': 0.5326188,
           'box_loss': 0.007439621,
           'class_loss': 0.0029554632,
           'conf_loss': 0.00902207,
           'precision50': 0.31478977,
           'recall50': 0.59071743},
     'AP': 0.39678583,
     'AP50': 0.59593123,
     'AP75': 0.4283781,
     'APl': 0.5209007,
     'APm': 0.3496044,
     'APs': 0.14201826,
     'ARl': 0.6935775,
     'ARm': 0.55632406,
     'ARmax1': 0.32276502,
     'ARmax10': 0.5292829,
     'ARmax100': 0.57669824,
     'ARs': 0.29393226,
     'global': {'total_loss': 0.05445915},
     'validation_loss': 0.05445915}
I0411 16:54:47.001831 140530602018624 controller.py:211] train | step:  80000 | training until step 100000...
I0411 17:25:24.762215 140530602018624 controller.py:425] train | step:  85000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.662269,
           'avg_obj': 0.19812444,
           'box_loss': 0.012465293,
           'class_loss': 0.005446574,
           'conf_loss': 0.013042471,
           'precision50': 0.36429566,
           'recall50': 0.10099276},
     '4': {'avg_iou': 0.75430906,
           'avg_obj': 0.326912,
           'box_loss': 0.010584869,
           'class_loss': 0.0051167733,
           'conf_loss': 0.015964497,
           'precision50': 0.62588847,
           'recall50': 0.2750201},
     '5': {'avg_iou': 0.8083287,
           'avg_obj': 0.45233712,
           'box_loss': 0.008900943,
           'class_loss': 0.00479539,
           'conf_loss': 0.015449539,
           'precision50': 0.7691692,
           'recall50': 0.47688428},
     'global': {'total_loss': 0.7341302},
     'learning_rate': 0.01,
     'training_loss': 0.7341302}
I0411 17:26:12.955175 140530602018624 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-stepwise/ckpt-85000.
I0411 17:57:08.660317 140530602018624 controller.py:425] train | step:  90000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.66359246,
           'avg_obj': 0.20062245,
           'box_loss': 0.012403393,
           'class_loss': 0.0053808047,
           'conf_loss': 0.0129416045,
           'precision50': 0.36629638,
           'recall50': 0.102683045},
     '4': {'avg_iou': 0.75623155,
           'avg_obj': 0.32994545,
           'box_loss': 0.010501317,
           'class_loss': 0.0050565894,
           'conf_loss': 0.01583974,
           'precision50': 0.62819636,
           'recall50': 0.27843776},
     '5': {'avg_iou': 0.81031793,
           'avg_obj': 0.4567126,
           'box_loss': 0.008807959,
           'class_loss': 0.0047168634,
           'conf_loss': 0.015328214,
           'precision50': 0.7711659,
           'recall50': 0.4828186},
     'global': {'total_loss': 0.72781193},
     'learning_rate': 0.01,
     'training_loss': 0.72781193}
I0411 18:28:46.935646 140530602018624 controller.py:425] train | step:  95000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.66496414,
           'avg_obj': 0.20296058,
           'box_loss': 0.012333433,
           'class_loss': 0.0053057787,
           'conf_loss': 0.012889425,
           'precision50': 0.36934915,
           'recall50': 0.10490463},
     '4': {'avg_iou': 0.7581119,
           'avg_obj': 0.33310375,
           'box_loss': 0.010418293,
           'class_loss': 0.004998143,
           'conf_loss': 0.015791425,
           'precision50': 0.62926507,
           'recall50': 0.28158602},
     '5': {'avg_iou': 0.8114381,
           'avg_obj': 0.4592529,
           'box_loss': 0.008745269,
           'class_loss': 0.0046725497,
           'conf_loss': 0.015262816,
           'precision50': 0.7720149,
           'recall50': 0.4859522},
     'global': {'total_loss': 0.72333735},
     'learning_rate': 0.01,
     'training_loss': 0.72333735}
I0411 19:00:30.397954 140530602018624 controller.py:425] train | step:  100000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.66715467,
           'avg_obj': 0.20556931,
           'box_loss': 0.012273369,
           'class_loss': 0.005219317,
           'conf_loss': 0.01286073,
           'precision50': 0.37273538,
           'recall50': 0.106863186},
     '4': {'avg_iou': 0.7597304,
           'avg_obj': 0.336783,
           'box_loss': 0.010341037,
           'class_loss': 0.004899106,
           'conf_loss': 0.015688822,
           'precision50': 0.63150895,
           'recall50': 0.28651744},
     '5': {'avg_iou': 0.81334627,
           'avg_obj': 0.46312124,
           'box_loss': 0.008654761,
           'class_loss': 0.004580303,
           'conf_loss': 0.015165561,
           'precision50': 0.7740215,
           'recall50': 0.49082714},
     'global': {'total_loss': 0.7174653},
     'learning_rate': 0.01,
     'training_loss': 0.7174653}

saved checkpoint to gs://tensorflow2/config_testing/all-stepwise/ckpt-65000.
train | step:  70000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6561132,
           'avg_obj': 0.18904413,
           'box_loss': 0.012690238,
           'class_loss': 0.0057299277,
           'conf_loss': 0.01318736,
           'precision50': 0.35200253,
           'recall50': 0.09298893},
     '4': {'avg_iou': 0.7476159,
           'avg_obj': 0.31399557,
           'box_loss': 0.010891346,
           'class_loss': 0.0054465407,
           'conf_loss': 0.016201666,
           'precision50': 0.6171126,
           'recall50': 0.25932422},
     '5': {'avg_iou': 0.80050105,
           'avg_obj': 0.43813428,
           'box_loss': 0.009285028,
           'class_loss': 0.0051015457,
           'conf_loss': 0.015722176,
           'precision50': 0.7627492,
           'recall50': 0.45806324},
     'global': {'total_loss': 0.75404555},
     'learning_rate': 0.01,
     'training_loss': 0.75404555}
train | step:  75000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.65828913,
           'avg_obj': 0.19238207,
           'box_loss': 0.01261454,
           'class_loss': 0.005631707,
           'conf_loss': 0.013117888,
           'precision50': 0.3563671,
           'recall50': 0.09594947},
     '4': {'avg_iou': 0.7499984,
           'avg_obj': 0.31843668,
           'box_loss': 0.010776156,
           'class_loss': 0.005327325,
           'conf_loss': 0.01609307,
           'precision50': 0.61984724,
           'recall50': 0.26445717},
     '5': {'avg_iou': 0.80325085,
           'avg_obj': 0.44295624,
           'box_loss': 0.009144762,
           'class_loss': 0.004994287,
           'conf_loss': 0.015606177,
           'precision50': 0.76484925,
           'recall50': 0.46466187},
     'global': {'total_loss': 0.7464479},
     'learning_rate': 0.01,
     'training_loss': 0.7464479}
train | step:  80000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.66033596,
           'avg_obj': 0.19528314,
           'box_loss': 0.01251538,
           'class_loss': 0.0055203997,
           'conf_loss': 0.013021289,
           'precision50': 0.36005,
           'recall50': 0.09839119},
     '4': {'avg_iou': 0.75240964,
           'avg_obj': 0.32287797,
           'box_loss': 0.010666689,
           'class_loss': 0.0052112783,
           'conf_loss': 0.015982183,
           'precision50': 0.62426907,
           'recall50': 0.270596},
     '5': {'avg_iou': 0.80630106,
           'avg_obj': 0.4487144,
           'box_loss': 0.008987779,
           'class_loss': 0.0048733344,
           'conf_loss': 0.015497313,
           'precision50': 0.7672889,
           'recall50': 0.47210357},
     'global': {'total_loss': 0.7382035},
     'learning_rate': 0.01,
     'training_loss': 0.7382035}
 eval | step:  80000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=184.48s).
Accumulating evaluation results...
DONE (t=15.78s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.397
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.596
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.428
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.142
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.350
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.521
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.323
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.529
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.577
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.294
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.556
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.694
 eval | step:  80000 | eval time:  550.7 sec | output: 
    {'3': {'avg_iou': 0.44388285,
           'avg_obj': 0.16410899,
           'box_loss': 0.0076179113,
           'class_loss': 0.0026173706,
           'conf_loss': 0.005933361,
           'precision50': 0.15026425,
           'recall50': 0.14546959},
     '4': {'avg_iou': 0.66741526,
           'avg_obj': 0.35036778,
           'box_loss': 0.0080639785,
           'class_loss': 0.002980489,
           'conf_loss': 0.007828889,
           'precision50': 0.25191063,
           'recall50': 0.36965832},
     '5': {'avg_iou': 0.81908834,
           'avg_obj': 0.5326188,
           'box_loss': 0.007439621,
           'class_loss': 0.0029554632,
           'conf_loss': 0.00902207,
           'precision50': 0.31478977,
           'recall50': 0.59071743},
     'AP': 0.39678583,
     'AP50': 0.59593123,
     'AP75': 0.4283781,
     'APl': 0.5209007,
     'APm': 0.3496044,
     'APs': 0.14201826,
     'ARl': 0.6935775,
     'ARm': 0.55632406,
     'ARmax1': 0.32276502,
     'ARmax10': 0.5292829,
     'ARmax100': 0.57669824,
     'ARs': 0.29393226,
     'global': {'total_loss': 0.05445915},
     'validation_loss': 0.05445915}
train | step:  80000 | training until step 100000...
train | step:  85000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.662269,
           'avg_obj': 0.19812444,
           'box_loss': 0.012465293,
           'class_loss': 0.005446574,
           'conf_loss': 0.013042471,
           'precision50': 0.36429566,
           'recall50': 0.10099276},
     '4': {'avg_iou': 0.75430906,
           'avg_obj': 0.326912,
           'box_loss': 0.010584869,
           'class_loss': 0.0051167733,
           'conf_loss': 0.015964497,
           'precision50': 0.62588847,
           'recall50': 0.2750201},
     '5': {'avg_iou': 0.8083287,
           'avg_obj': 0.45233712,
           'box_loss': 0.008900943,
           'class_loss': 0.00479539,
           'conf_loss': 0.015449539,
           'precision50': 0.7691692,
           'recall50': 0.47688428},
     'global': {'total_loss': 0.7341302},
     'learning_rate': 0.01,
     'training_loss': 0.7341302}
saved checkpoint to gs://tensorflow2/config_testing/all-stepwise/ckpt-85000.
train | step:  90000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.66359246,
           'avg_obj': 0.20062245,
           'box_loss': 0.012403393,
           'class_loss': 0.0053808047,
           'conf_loss': 0.0129416045,
           'precision50': 0.36629638,
           'recall50': 0.102683045},
     '4': {'avg_iou': 0.75623155,
           'avg_obj': 0.32994545,
           'box_loss': 0.010501317,
           'class_loss': 0.0050565894,
           'conf_loss': 0.01583974,
           'precision50': 0.62819636,
           'recall50': 0.27843776},
     '5': {'avg_iou': 0.81031793,
           'avg_obj': 0.4567126,
           'box_loss': 0.008807959,
           'class_loss': 0.0047168634,
           'conf_loss': 0.015328214,
           'precision50': 0.7711659,
           'recall50': 0.4828186},
     'global': {'total_loss': 0.72781193},
     'learning_rate': 0.01,
     'training_loss': 0.72781193}
train | step:  95000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.66496414,
           'avg_obj': 0.20296058,
           'box_loss': 0.012333433,
           'class_loss': 0.0053057787,
           'conf_loss': 0.012889425,
           'precision50': 0.36934915,
           'recall50': 0.10490463},
     '4': {'avg_iou': 0.7581119,
           'avg_obj': 0.33310375,
           'box_loss': 0.010418293,
           'class_loss': 0.004998143,
           'conf_loss': 0.015791425,
           'precision50': 0.62926507,
           'recall50': 0.28158602},
     '5': {'avg_iou': 0.8114381,
           'avg_obj': 0.4592529,
           'box_loss': 0.008745269,
           'class_loss': 0.0046725497,
           'conf_loss': 0.015262816,
           'precision50': 0.7720149,
           'recall50': 0.4859522},
     'global': {'total_loss': 0.72333735},
     'learning_rate': 0.01,
     'training_loss': 0.72333735}
train | step:  100000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.66715467,
           'avg_obj': 0.20556931,
           'box_loss': 0.012273369,
           'class_loss': 0.005219317,
           'conf_loss': 0.01286073,
           'precision50': 0.37273538,
           'recall50': 0.106863186},
     '4': {'avg_iou': 0.7597304,
           'avg_obj': 0.336783,
           'box_loss': 0.010341037,
           'class_loss': 0.004899106,
           'conf_loss': 0.015688822,
           'precision50': 0.63150895,
           'recall50': 0.28651744},
     '5': {'avg_iou': 0.81334627,
           'avg_obj': 0.46312124,
           'box_loss': 0.008654761,
           'class_loss': 0.004580303,
           'conf_loss': 0.015165561,
           'precision50': 0.7740215,
           'recall50': 0.49082714},
     'global': {'total_loss': 0.7174653},
     'learning_rate': 0.01,
     'training_loss': 0.7174653}I0411 19:00:43.388098 140530602018624 controller.py:252]  eval | step:  100000 | running 625 steps of evaluation...
I0411 19:05:29.944163 140530602018624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0411 19:09:48.042739 140530602018624 controller.py:261]  eval | step:  100000 | eval time:  544.7 sec | output: 
    {'3': {'avg_iou': 0.44529516,
           'avg_obj': 0.16943207,
           'box_loss': 0.007549234,
           'class_loss': 0.0025803624,
           'conf_loss': 0.0059708767,
           'precision50': 0.15001793,
           'recall50': 0.15207396},
     '4': {'avg_iou': 0.6700762,
           'avg_obj': 0.36010888,
           'box_loss': 0.007930406,
           'class_loss': 0.0029275944,
           'conf_loss': 0.007917955,
           'precision50': 0.25088292,
           'recall50': 0.38186035},
     '5': {'avg_iou': 0.82161653,
           'avg_obj': 0.5465555,
           'box_loss': 0.007314164,
           'class_loss': 0.002879329,
           'conf_loss': 0.009154663,
           'precision50': 0.31427133,
           'recall50': 0.61105883},
     'AP': 0.40335107,
     'AP50': 0.603443,
     'AP75': 0.4312364,
     'APl': 0.5316599,
     'APm': 0.35346946,
     'APs': 0.140035,
     'ARl': 0.6974441,
     'ARm': 0.567256,
     'ARmax1': 0.32674387,
     'ARmax10': 0.53565985,
     'ARmax100': 0.5834379,
     'ARs': 0.2914178,
     'global': {'total_loss': 0.054224584},
     'validation_loss': 0.054224584}
I0411 19:10:04.435443 140530602018624 controller.py:211] train | step:  100000 | training until step 120000...
I0411 19:38:47.218261 140530602018624 controller.py:425] train | step:  105000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6677865,
           'avg_obj': 0.20763353,
           'box_loss': 0.012239108,
           'class_loss': 0.005144459,
           'conf_loss': 0.0128275575,
           'precision50': 0.37528738,
           'recall50': 0.10868495},
     '4': {'avg_iou': 0.7616087,
           'avg_obj': 0.33994618,
           'box_loss': 0.010240696,
           'class_loss': 0.004807978,
           'conf_loss': 0.01564509,
           'precision50': 0.63290846,
           'recall50': 0.29028147},
     '5': {'avg_iou': 0.81493634,
           'avg_obj': 0.46701235,
           'box_loss': 0.008568634,
           'class_loss': 0.004503908,
           'conf_loss': 0.015079073,
           'precision50': 0.7750268,
           'recall50': 0.49542344},
     'global': {'total_loss': 0.712451},
     'learning_rate': 0.01,
     'training_loss': 0.712451}
I0411 19:39:36.380789 140530602018624 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-stepwise/ckpt-105000.
I0411 20:10:40.086819 140530602018624 controller.py:425] train | step:  110000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6694103,
           'avg_obj': 0.21002963,
           'box_loss': 0.012194805,
           'class_loss': 0.0051002707,
           'conf_loss': 0.0128063215,
           'precision50': 0.3792464,
           'recall50': 0.11091619},
     '4': {'avg_iou': 0.7626257,
           'avg_obj': 0.34279895,
           'box_loss': 0.010199411,
           'class_loss': 0.004744185,
           'conf_loss': 0.015570308,
           'precision50': 0.6356532,
           'recall50': 0.29370692},
     '5': {'avg_iou': 0.81665677,
           'avg_obj': 0.47000107,
           'box_loss': 0.00849026,
           'class_loss': 0.0044380934,
           'conf_loss': 0.015026094,
           'precision50': 0.7763424,
           'recall50': 0.49964556},
     'global': {'total_loss': 0.70855856},
     'learning_rate': 0.01,
     'training_loss': 0.70855856}
I0411 20:44:15.137074 140530602018624 controller.py:425] train | step:  115000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.670745,
           'avg_obj': 0.21227117,
           'box_loss': 0.0121357255,
           'class_loss': 0.0050537116,
           'conf_loss': 0.012734122,
           'precision50': 0.38226995,
           'recall50': 0.11329944},
     '4': {'avg_iou': 0.7643079,
           'avg_obj': 0.34605324,
           'box_loss': 0.010131117,
           'class_loss': 0.0047086286,
           'conf_loss': 0.015508269,
           'precision50': 0.6375536,
           'recall50': 0.29781085},
     '5': {'avg_iou': 0.8180843,
           'avg_obj': 0.47312632,
           'box_loss': 0.008414286,
           'class_loss': 0.0043981667,
           'conf_loss': 0.014961026,
           'precision50': 0.77802074,
           'recall50': 0.50317764},
     'global': {'total_loss': 0.70435977},
     'learning_rate': 0.01,
     'training_loss': 0.70435977}
I0411 21:15:48.702402 140530602018624 controller.py:425] train | step:  120000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.67221516,
           'avg_obj': 0.21466061,
           'box_loss': 0.012095395,
           'class_loss': 0.0049923793,
           'conf_loss': 0.012724272,
           'precision50': 0.38375884,
           'recall50': 0.11504093},
     '4': {'avg_iou': 0.76602834,
           'avg_obj': 0.3494714,
           'box_loss': 0.010065147,
           'class_loss': 0.0046409825,
           'conf_loss': 0.01545016,
           'precision50': 0.64013547,
           'recall50': 0.302095},
     '5': {'avg_iou': 0.81951463,
           'avg_obj': 0.47627383,
           'box_loss': 0.008358382,
           'class_loss': 0.004331729,
           'conf_loss': 0.014884229,
           'precision50': 0.77971226,
           'recall50': 0.50765556},
     'global': {'total_loss': 0.70034105},
     'learning_rate': 0.01,
     'training_loss': 0.70034105}
I0411 21:16:00.890907 140530602018624 controller.py:252]  eval | step:  120000 | running 625 steps of evaluation...
I0411 21:20:50.767145 140530602018624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0411 21:25:15.717514 140530602018624 controller.py:261]  eval | step:  120000 | eval time:  554.8 sec | output: 
    {'3': {'avg_iou': 0.44691744,
           'avg_obj': 0.17269118,
           'box_loss': 0.0074666315,
           'class_loss': 0.0024986905,
           'conf_loss': 0.005988572,
           'precision50': 0.1503504,
           'recall50': 0.15812115},
     '4': {'avg_iou': 0.67154974,
           'avg_obj': 0.3654967,
           'box_loss': 0.00785758,
           'class_loss': 0.0028636763,
           'conf_loss': 0.007975124,
           'precision50': 0.24795847,
           'recall50': 0.3885483},
     '5': {'avg_iou': 0.82328576,
           'avg_obj': 0.5530138,
           'box_loss': 0.007231446,
           'class_loss': 0.0028066928,
           'conf_loss': 0.0092093,
           'precision50': 0.31451622,
           'recall50': 0.61695904},
     'AP': 0.41013172,
     'AP50': 0.60834414,
     'AP75': 0.44219193,
     'APl': 0.5370708,
     'APm': 0.36025044,
     'APs': 0.14856999,
     'ARl': 0.70809895,
     'ARm': 0.57003576,
     'ARmax1': 0.3293732,
     'ARmax10': 0.54211384,
     'ARmax100': 0.5898779,
     'ARs': 0.30438802,
     'global': {'total_loss': 0.05389773},
     'validation_loss': 0.05389773}

 eval | step:  100000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=192.01s).
Accumulating evaluation results...
DONE (t=15.30s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.403
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.603
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.431
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.140
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.353
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.532
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.327
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.536
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.583
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.291
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.567
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.697
 eval | step:  100000 | eval time:  544.7 sec | output: 
    {'3': {'avg_iou': 0.44529516,
           'avg_obj': 0.16943207,
           'box_loss': 0.007549234,
           'class_loss': 0.0025803624,
           'conf_loss': 0.0059708767,
           'precision50': 0.15001793,
           'recall50': 0.15207396},
     '4': {'avg_iou': 0.6700762,
           'avg_obj': 0.36010888,
           'box_loss': 0.007930406,
           'class_loss': 0.0029275944,
           'conf_loss': 0.007917955,
           'precision50': 0.25088292,
           'recall50': 0.38186035},
     '5': {'avg_iou': 0.82161653,
           'avg_obj': 0.5465555,
           'box_loss': 0.007314164,
           'class_loss': 0.002879329,
           'conf_loss': 0.009154663,
           'precision50': 0.31427133,
           'recall50': 0.61105883},
     'AP': 0.40335107,
     'AP50': 0.603443,
     'AP75': 0.4312364,
     'APl': 0.5316599,
     'APm': 0.35346946,
     'APs': 0.140035,
     'ARl': 0.6974441,
     'ARm': 0.567256,
     'ARmax1': 0.32674387,
     'ARmax10': 0.53565985,
     'ARmax100': 0.5834379,
     'ARs': 0.2914178,
     'global': {'total_loss': 0.054224584},
     'validation_loss': 0.054224584}
train | step:  100000 | training until step 120000...
train | step:  105000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6677865,
           'avg_obj': 0.20763353,
           'box_loss': 0.012239108,
           'class_loss': 0.005144459,
           'conf_loss': 0.0128275575,
           'precision50': 0.37528738,
           'recall50': 0.10868495},
     '4': {'avg_iou': 0.7616087,
           'avg_obj': 0.33994618,
           'box_loss': 0.010240696,
           'class_loss': 0.004807978,
           'conf_loss': 0.01564509,
           'precision50': 0.63290846,
           'recall50': 0.29028147},
     '5': {'avg_iou': 0.81493634,
           'avg_obj': 0.46701235,
           'box_loss': 0.008568634,
           'class_loss': 0.004503908,
           'conf_loss': 0.015079073,
           'precision50': 0.7750268,
           'recall50': 0.49542344},
     'global': {'total_loss': 0.712451},
     'learning_rate': 0.01,
     'training_loss': 0.712451}
saved checkpoint to gs://tensorflow2/config_testing/all-stepwise/ckpt-105000.
train | step:  110000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6694103,
           'avg_obj': 0.21002963,
           'box_loss': 0.012194805,
           'class_loss': 0.0051002707,
           'conf_loss': 0.0128063215,
           'precision50': 0.3792464,
           'recall50': 0.11091619},
     '4': {'avg_iou': 0.7626257,
           'avg_obj': 0.34279895,
           'box_loss': 0.010199411,
           'class_loss': 0.004744185,
           'conf_loss': 0.015570308,
           'precision50': 0.6356532,
           'recall50': 0.29370692},
     '5': {'avg_iou': 0.81665677,
           'avg_obj': 0.47000107,
           'box_loss': 0.00849026,
           'class_loss': 0.0044380934,
           'conf_loss': 0.015026094,
           'precision50': 0.7763424,
           'recall50': 0.49964556},
     'global': {'total_loss': 0.70855856},
     'learning_rate': 0.01,
     'training_loss': 0.70855856}
train | step:  115000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.670745,
           'avg_obj': 0.21227117,
           'box_loss': 0.0121357255,
           'class_loss': 0.0050537116,
           'conf_loss': 0.012734122,
           'precision50': 0.38226995,
           'recall50': 0.11329944},
     '4': {'avg_iou': 0.7643079,
           'avg_obj': 0.34605324,
           'box_loss': 0.010131117,
           'class_loss': 0.0047086286,
           'conf_loss': 0.015508269,
           'precision50': 0.6375536,
           'recall50': 0.29781085},
     '5': {'avg_iou': 0.8180843,
           'avg_obj': 0.47312632,
           'box_loss': 0.008414286,
           'class_loss': 0.0043981667,
           'conf_loss': 0.014961026,
           'precision50': 0.77802074,
           'recall50': 0.50317764},
     'global': {'total_loss': 0.70435977},
     'learning_rate': 0.01,
     'training_loss': 0.70435977}
train | step:  120000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.67221516,
           'avg_obj': 0.21466061,
           'box_loss': 0.012095395,
           'class_loss': 0.0049923793,
           'conf_loss': 0.012724272,
           'precision50': 0.38375884,
           'recall50': 0.11504093},
     '4': {'avg_iou': 0.76602834,
           'avg_obj': 0.3494714,
           'box_loss': 0.010065147,
           'class_loss': 0.0046409825,
           'conf_loss': 0.01545016,
           'precision50': 0.64013547,
           'recall50': 0.302095},
     '5': {'avg_iou': 0.81951463,
           'avg_obj': 0.47627383,
           'box_loss': 0.008358382,
           'class_loss': 0.004331729,
           'conf_loss': 0.014884229,
           'precision50': 0.77971226,
           'recall50': 0.50765556},
     'global': {'total_loss': 0.70034105},
     'learning_rate': 0.01,
     'training_loss': 0.70034105}
 eval | step:  120000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=191.01s).
Accumulating evaluation results...
DONE (t=15.47s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.410
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.608
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.442
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.149
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.360
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.537
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.329
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.542
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.590
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.304
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.570
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.708
 eval | step:  120000 | eval time:  554.8 sec | output: 
    {'3': {'avg_iou': 0.44691744,
           'avg_obj': 0.17269118,
           'box_loss': 0.0074666315,
           'class_loss': 0.0024986905,
           'conf_loss': 0.005988572,
           'precision50': 0.1503504,
           'recall50': 0.15812115},
     '4': {'avg_iou': 0.67154974,
           'avg_obj': 0.3654967,
           'box_loss': 0.00785758,
           'class_loss': 0.0028636763,
           'conf_loss': 0.007975124,
           'precision50': 0.24795847,
           'recall50': 0.3885483},
     '5': {'avg_iou': 0.82328576,
           'avg_obj': 0.5530138,
           'box_loss': 0.007231446,
           'class_loss': 0.0028066928,
           'conf_loss': 0.0092093,
           'precision50': 0.31451622,
           'recall50': 0.61695904},
     'AP': 0.41013172,
     'AP50': 0.60834414,
     'AP75': 0.44219193,
     'APl': 0.5370708,
     'APm': 0.36025044,
     'APs': 0.14856999,
     'ARl': 0.70809895,
     'ARm': 0.57003576,
     'ARmax1': 0.3293732,
     'ARmax10': 0.54211384,
     'ARmax100': 0.5898779,
     'ARs': 0.30438802,
     'global': {'total_loss': 0.05389773},
     'validation_loss': 0.05389773}I0411 21:25:36.835452 140530602018624 controller.py:211] train | step:  120000 | training until step 140000...
I0411 21:53:15.647942 140530602018624 controller.py:425] train | step:  125000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6728483,
           'avg_obj': 0.2157843,
           'box_loss': 0.012077428,
           'class_loss': 0.004957734,
           'conf_loss': 0.012691182,
           'precision50': 0.38699585,
           'recall50': 0.1165103},
     '4': {'avg_iou': 0.7669235,
           'avg_obj': 0.3515918,
           'box_loss': 0.010010611,
           'class_loss': 0.0045895544,
           'conf_loss': 0.015411766,
           'precision50': 0.64176273,
           'recall50': 0.30452198},
     '5': {'avg_iou': 0.82070774,
           'avg_obj': 0.47971523,
           'box_loss': 0.00829177,
           'class_loss': 0.004288598,
           'conf_loss': 0.014822228,
           'precision50': 0.78147024,
           'recall50': 0.5124771},
     'global': {'total_loss': 0.69712657},
     'learning_rate': 0.01,
     'training_loss': 0.69712657}
I0411 21:54:02.641357 140530602018624 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-stepwise/ckpt-125000.
I0411 22:25:15.532631 140530602018624 controller.py:425] train | step:  130000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.67394036,
           'avg_obj': 0.21832488,
           'box_loss': 0.012028652,
           'class_loss': 0.0049063247,
           'conf_loss': 0.012635747,
           'precision50': 0.38895065,
           'recall50': 0.11836021},
     '4': {'avg_iou': 0.76844543,
           'avg_obj': 0.3543478,
           'box_loss': 0.009957683,
           'class_loss': 0.004539385,
           'conf_loss': 0.015333714,
           'precision50': 0.6432536,
           'recall50': 0.3085195},
     '5': {'avg_iou': 0.82186544,
           'avg_obj': 0.48234808,
           'box_loss': 0.008237149,
           'class_loss': 0.004233926,
           'conf_loss': 0.014730391,
           'precision50': 0.7822571,
           'recall50': 0.5151319},
     'global': {'total_loss': 0.69282436},
     'learning_rate': 0.01,
     'training_loss': 0.69282436}
I0411 23:00:32.992284 140530602018624 controller.py:425] train | step:  135000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.67475027,
           'avg_obj': 0.21962053,
           'box_loss': 0.011980803,
           'class_loss': 0.004837037,
           'conf_loss': 0.012625789,
           'precision50': 0.3908518,
           'recall50': 0.11906094},
     '4': {'avg_iou': 0.7689699,
           'avg_obj': 0.35673922,
           'box_loss': 0.009926088,
           'class_loss': 0.0044931984,
           'conf_loss': 0.01528084,
           'precision50': 0.64549446,
           'recall50': 0.31113946},
     '5': {'avg_iou': 0.8227946,
           'avg_obj': 0.48433593,
           'box_loss': 0.008195909,
           'class_loss': 0.004190116,
           'conf_loss': 0.014679409,
           'precision50': 0.78405803,
           'recall50': 0.5182646},
     'global': {'total_loss': 0.6896718},
     'learning_rate': 0.01,
     'training_loss': 0.6896718}
I0411 23:32:07.918484 140530602018624 controller.py:425] train | step:  140000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.676048,
           'avg_obj': 0.22165146,
           'box_loss': 0.0119416565,
           'class_loss': 0.0047865286,
           'conf_loss': 0.012584933,
           'precision50': 0.39483312,
           'recall50': 0.121407434},
     '4': {'avg_iou': 0.77044797,
           'avg_obj': 0.359318,
           'box_loss': 0.009873871,
           'class_loss': 0.0044314084,
           'conf_loss': 0.015250975,
           'precision50': 0.647325,
           'recall50': 0.31447762},
     '5': {'avg_iou': 0.82431847,
           'avg_obj': 0.48757198,
           'box_loss': 0.008115612,
           'class_loss': 0.004119784,
           'conf_loss': 0.014640657,
           'precision50': 0.784686,
           'recall50': 0.52249503},
     'global': {'total_loss': 0.6859618},
     'learning_rate': 0.01,
     'training_loss': 0.6859618}
I0411 23:32:21.441649 140530602018624 controller.py:252]  eval | step:  140000 | running 625 steps of evaluation...
I0411 23:37:05.114768 140530602018624 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
/home/cam2tensorflow/.experiment_start.sh: line 22: 25166 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   213    0     2  100   211      5    599 --:--:-- --:--:-- --:--:--   606
okRequest issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-11T23:40:50.554323436Z'
  endTime: '2021-04-11T23:41:49.268324566Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618184450544-5bfbaed5b127b-39a14bb4-35336a20
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618184450544-5bfbaed5b127b-39a14bb4-35336a20] to complete...
.............................................................................................................................................................................................................................................................................................................................................................................................done.
