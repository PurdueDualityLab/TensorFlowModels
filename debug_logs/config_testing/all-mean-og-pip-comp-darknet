cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is STOPPING
europe-west4-a
I0413 17:29:15.472898 139825251469120 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 7.0,
                                    'aug_rand_brightness': 0.7,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.1,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.4,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.75],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': False,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 0.75,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.75,
                                         'aug_rand_translate': 0.1,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.4,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.75],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': False,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [200000,
                                                                                250000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00261,
                                                                            0.000261,
                                                                            2.61e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0413 17:29:15.474008 139825251469120 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/params.yaml
I0413 17:29:17.029383 139825251469120 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 17:29:17.647108 139825251469120 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0413 17:29:17.647371 139825251469120 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-4" is not yet ready; state: "STOPPING"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.4, 'aug_rand_translate': 0.1, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.7, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.75], 'random_crop': False, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.4, 'aug_rand_translate': 0.1, 'aug_rand_saturation': 0.75, 'aug_rand_brightness': 0.75, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.75], 'random_crop': False, 'random_crop_mosaic': True}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [200000, 250000], 'values': [0.00261, 0.000261, 2.61e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   216    0     2  100   214     11   1273 --:--:-- --:--:-- --:--:--  1285
okRequest issued for: [node-4]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-13T17:30:27.372372196Z'
  endTime: '2021-04-13T17:30:55.371844905Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618335027358-5bfddfc6eebd8-20bba61d-dbe4932b
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.117.66.216/29
  createTime: '2021-03-13T04:41:22.291533178Z'
  health: HEALTHY
  ipAddress: 10.117.66.218
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.117.66.218
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618335027358-5bfddfc6eebd8-20bba61d-dbe4932b] to complete...
..............................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-4]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618335102186-5bfde00e4b237-11a8ba43-6e7908d2] to complete...
...............................................................................................................................aborted by ctrl-c.
ERROR: (gcloud.compute.tpus.start) Aborting wait for operation https://tpu.googleapis.com/v1alpha1/projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618335102186-5bfde00e4b237-11a8ba43-6e7908d2.

europe-west4-a
I0413 17:31:02.088055 140222793107264 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 7.0,
                                    'aug_rand_brightness': 0.7,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.1,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.4,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.75],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': False,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 0.75,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.75,
                                         'aug_rand_translate': 0.1,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.4,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.75],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': False,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [200000,
                                                                                250000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00261,
                                                                            0.000261,
                                                                            2.61e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0413 17:31:02.088948 140222793107264 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/params.yaml
I0413 17:31:02.921765 140222793107264 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 17:31:03.539000 140222793107264 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0413 17:31:03.539218 140222793107264 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-4" is not yet ready; state: "STARTING"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.4, 'aug_rand_translate': 0.1, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.7, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.75], 'random_crop': False, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.4, 'aug_rand_translate': 0.1, 'aug_rand_saturation': 0.75, 'aug_rand_brightness': 0.75, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.75], 'random_crop': False, 'random_crop_mosaic': True}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [200000, 250000], 'values': [0.00261, 0.000261, 2.61e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   216    0     2  100   214     13   1496 --:--:-- --:--:-- --:--:--  1510
okRequest issued for: [node-4]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-13T17:32:13.284639121Z'
  endTime: '2021-04-13T17:34:41.631764880Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618335133272-5bfde02bf093f-7addb291-a54a983c
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.117.66.216/29
  createTime: '2021-03-13T04:41:22.291533178Z'
  health: HEALTHY
  ipAddress: 10.117.66.218
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.117.66.218
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618335133272-5bfde02bf093f-7addb291-a54a983c] to complete...
...................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-4]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618335955792-5bfde33c5b3fe-b876c53f-a746606e] to complete...
............................................aborted by ctrl-c.
ERROR: (gcloud.compute.tpus.start) Aborting wait for operation https://tpu.googleapis.com/v1alpha1/projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618335955792-5bfde33c5b3fe-b876c53f-a746606e.

europe-west4-a
I0413 17:44:59.359165 140604296320832 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 7.0,
                                    'aug_rand_brightness': 0.7,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.1,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.4,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.75],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': False,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 0.75,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.75,
                                         'aug_rand_translate': 0.1,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.4,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.75],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': False,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [200000,
                                                                                250000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00261,
                                                                            0.000261,
                                                                            2.61e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0413 17:44:59.360072 140604296320832 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/params.yaml
I0413 17:45:00.154711 140604296320832 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 17:45:00.298356 140604296320832 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0413 17:45:00.298593 140604296320832 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-4" is not yet ready; state: "STARTING"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.4, 'aug_rand_translate': 0.1, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.7, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.75], 'random_crop': False, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.4, 'aug_rand_translate': 0.1, 'aug_rand_saturation': 0.75, 'aug_rand_brightness': 0.75, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.75], 'random_crop': False, 'random_crop_mosaic': True}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [200000, 250000], 'values': [0.00261, 0.000261, 2.61e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   216    0     2  100   214     12   1320 --:--:-- --:--:-- --:--:--  1333
okRequest issued for: [node-4]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-13T17:46:10.103256534Z'
  endTime: '2021-04-13T17:49:42.297254532Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618335970089-5bfde349fdad0-c07e59ae-f106ce88
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.117.66.216/29
  createTime: '2021-03-13T04:41:22.291533178Z'
  health: HEALTHY
  ipAddress: 10.117.66.218
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.117.66.218
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618335970089-5bfde349fdad0-c07e59ae-f106ce88] to complete...
..................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-4]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-13T17:51:08.886909675Z'
  endTime: '2021-04-13T17:51:46.438700944Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618336268873-5bfde466eef21-d1150a27-c76af3f3
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.117.66.216/29
  createTime: '2021-03-13T04:41:22.291533178Z'
  health: HEALTHY
  ipAddress: 10.117.66.218
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.117.66.218
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618336268873-5bfde466eef21-d1150a27-c76af3f3] to complete...
..................................................................................................................................................................................................................................................................................done.
europe-west4-a
I0413 17:50:57.740480 140080120223552 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [608, 608, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 7.0,
                                    'aug_rand_brightness': 0.7,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.1,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 608,
                                    'image_w': 608,
                                    'jitter_boxes': 0.4,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 608,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.75],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': False,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 0.75,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.75,
                                         'aug_rand_translate': 0.1,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 608,
                                         'image_w': 608,
                                         'jitter_boxes': 0.4,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.75],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': False,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [200000,
                                                                                250000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00261,
                                                                            0.000261,
                                                                            2.61e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0413 17:50:57.741376 140080120223552 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/params.yaml
I0413 17:50:58.628929 140080120223552 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 17:50:59.245013 140080120223552 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0413 17:50:59.245267 140080120223552 transport.py:157] Attempting refresh to obtain initial access_token
I0413 17:50:59.306630 140080120223552 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 17:50:59.921401 140080120223552 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0413 17:50:59.921677 140080120223552 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-13 17:50:59.973324: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0413 17:50:59.973959 140080120223552 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 17:51:00.113967 140080120223552 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0413 17:51:00.114212 140080120223552 transport.py:157] Attempting refresh to obtain initial access_token
I0413 17:51:00.168401 140080120223552 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 17:51:00.782135 140080120223552 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0413 17:51:00.782399 140080120223552 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-13 17:51:00.822310: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-13 17:51:00.833482: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.117.66.218:8470}
2021-04-13 17:51:00.833555: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:41287}
2021-04-13 17:51:19.391574: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.117.66.218:8470}
2021-04-13 17:51:19.391732: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:41287}
2021-04-13 17:51:19.392287: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:41287
I0413 17:51:19.393324 140080120223552 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-4
I0413 17:51:19.394028 140080120223552 tpu_strategy_util.py:74] Initializing the TPU system: node-4
INFO:tensorflow:Clearing out eager caches
I0413 17:51:27.171262 140080120223552 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0413 17:51:27.173329 140080120223552 tpu_strategy_util.py:133] Finished initializing TPU system.
I0413 17:51:27.174912 140080120223552 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 17:51:27.323486 140080120223552 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0413 17:51:27.323757 140080120223552 transport.py:157] Attempting refresh to obtain initial access_token
I0413 17:51:27.382446 140080120223552 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 17:51:28.003391 140080120223552 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0413 17:51:28.003646 140080120223552 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0413 17:51:28.057304 140080120223552 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0413 17:51:28.057524 140080120223552 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0413 17:51:28.057780 140080120223552 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0413 17:51:28.057839 140080120223552 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0413 17:51:28.057977 140080120223552 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0413 17:51:28.058435 140080120223552 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0413 17:51:28.058495 140080120223552 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0413 17:51:28.058544 140080120223552 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0413 17:51:28.058590 140080120223552 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0413 17:51:28.058636 140080120223552 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0413 17:51:28.058681 140080120223552 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0413 17:51:28.058752 140080120223552 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0413 17:51:28.058844 140080120223552 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0413 17:51:28.058925 140080120223552 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0413 17:51:28.059020 140080120223552 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0413 17:51:28.059134 140080120223552 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0413 17:51:28.094151 140080120223552 train_utils.py:214] Running default trainer.
2021-04-13 17:51:28.102431: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [608, 608, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 608, 'image_h': 608, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 608, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.4, 'aug_rand_translate': 0.1, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.7, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.75], 'random_crop': False, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 608, 'image_h': 608, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.4, 'aug_rand_translate': 0.1, 'aug_rand_saturation': 0.75, 'aug_rand_brightness': 0.75, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.75], 'random_crop': False, 'random_crop_mosaic': True}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [200000, 250000], 'values': [0.00261, 0.000261, 2.61e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05} 0.00025
{'num_classes': 91, '_input_size': [608, 608, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 608, 608, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f668d817ef0>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 608, 608, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 608, 608, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 304, 304, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 304, 304, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 304, 304, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 152, 152, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 152, 152, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 152, 152, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 152, 152, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 76, 76, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 76, 76, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 38, 38, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 38, 38, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 19, 19, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 19, 19, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 19, 19, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 19, 19, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 19, 19, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 19, 19, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
conv1 512.0
conv2 1024.0
conv1 512.0
spp
conv1 512.0
conv2 1024.0
conv1 512.0
7
conv1 512.0
conv2 256.0
conv1 512.0
conv2 256.0
4








 ListWrapper([256, 512, 1024])
conv1 128
conv2 256
conv1 128
conv2 256
conv1 128
conv2 256
6
conv1 256
conv2 512
conv1 256
conv2 512
conv1 256
conv2 512
6
conv1 512
conv2 1024
conv1 512
conv2 1024
conv1 512
conv2 1024
6
detget {'3': 1.2, '4': 1.1, '5': 1.05}
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 76, 76, 256) 37319168  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 64,488,640
Trainable params: 64,422,336
Non-trainable params: 66,304
_________________________________________________________________I0413 17:52:15.988332 140080120223552 controller.py:362] restoring or initializing model...
I0413 17:52:25.541099 140080120223552 yolo.py:532] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0413 17:52:25.543307 140080120223552 controller.py:368] initialized model.
I0413 17:52:25.543576 140080120223552 train_lib.py:96] Starts to execute mode: train_and_eval
I0413 17:52:25.548222 140080120223552 controller.py:211] train | step:      0 | training until step 20000...
I0413 17:52:33.439781 140080120223552 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0413 17:53:38.194440 140080120223552 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0413 18:40:51.700376 140080120223552 controller.py:425] train | step:   5000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.53657395,
           'avg_obj': 0.08013963,
           'box_loss': 0.32130206,
           'class_loss': 16.227793,
           'conf_loss': 102.97746,
           'precision50': 0.06602234,
           'recall50': 0.023367137},
     '4': {'avg_iou': 0.58985156,
           'avg_obj': 0.14107881,
           'box_loss': 0.33906296,
           'class_loss': 18.740788,
           'conf_loss': 32.875942,
           'precision50': 0.17211194,
           'recall50': 0.07092598},
     '5': {'avg_iou': 0.6308218,
           'avg_obj': 0.20644575,
           'box_loss': 0.19718155,
           'class_loss': 12.246952,
           'conf_loss': 12.055037,
           'precision50': 0.2666792,
           'recall50': 0.1530048},
     'global': {'total_loss': 195.9813},
     'learning_rate': 0.00261,
     'training_loss': 195.9813}
I0413 18:41:50.945597 140080120223552 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/ckpt-5000.
I0413 19:22:08.809545 140080120223552 controller.py:425] train | step:  10000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.6171537,
           'avg_obj': 0.12363402,
           'box_loss': 0.26695397,
           'class_loss': 4.893537,
           'conf_loss': 8.413419,
           'precision50': 0.14013116,
           'recall50': 0.043862004},
     '4': {'avg_iou': 0.68334126,
           'avg_obj': 0.22076787,
           'box_loss': 0.26242265,
           'class_loss': 5.423702,
           'conf_loss': 9.095067,
           'precision50': 0.2871214,
           'recall50': 0.14355324},
     '5': {'avg_iou': 0.72119707,
           'avg_obj': 0.3194762,
           'box_loss': 0.14934942,
           'class_loss': 3.500008,
           'conf_loss': 5.1774135,
           'precision50': 0.4082767,
           'recall50': 0.2955401},
     'global': {'total_loss': 37.18183},
     'learning_rate': 0.00261,
     'training_loss': 37.18183}
I0413 20:02:56.417558 140080120223552 controller.py:425] train | step:  15000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.6358968,
           'avg_obj': 0.14695837,
           'box_loss': 0.25441623,
           'class_loss': 4.3146563,
           'conf_loss': 8.188077,
           'precision50': 0.16555053,
           'recall50': 0.05967935},
     '4': {'avg_iou': 0.7065298,
           'avg_obj': 0.25829625,
           'box_loss': 0.24288015,
           'class_loss': 4.696491,
           'conf_loss': 8.637324,
           'precision50': 0.31170756,
           'recall50': 0.1834854},
     '5': {'avg_iou': 0.743253,
           'avg_obj': 0.36647514,
           'box_loss': 0.13734438,
           'class_loss': 3.0371153,
           'conf_loss': 4.8126154,
           'precision50': 0.4291889,
           'recall50': 0.3551259},
     'global': {'total_loss': 34.32094},
     'learning_rate': 0.00261,
     'training_loss': 34.32094}
I0413 20:43:28.308088 140080120223552 controller.py:425] train | step:  20000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.64721435,
           'avg_obj': 0.16299154,
           'box_loss': 0.24587023,
           'class_loss': 3.9676118,
           'conf_loss': 8.007898,
           'precision50': 0.18166962,
           'recall50': 0.07147312},
     '4': {'avg_iou': 0.7200045,
           'avg_obj': 0.2826066,
           'box_loss': 0.23195429,
           'class_loss': 4.274402,
           'conf_loss': 8.358229,
           'precision50': 0.32530525,
           'recall50': 0.20954295},
     '5': {'avg_iou': 0.75705,
           'avg_obj': 0.39548275,
           'box_loss': 0.13008296,
           'class_loss': 2.7690852,
           'conf_loss': 4.5968256,
           'precision50': 0.4395261,
           'recall50': 0.39129323},
     'global': {'total_loss': 32.581955},
     'learning_rate': 0.00261,
     'training_loss': 32.581955}
I0413 20:43:41.120405 140080120223552 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0413 20:43:41.715310 140080120223552 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0413 20:43:58.287108 140080120223552 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0413 20:48:58.336496 140080120223552 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
/home/cam2tensorflow/.experiment_start.sh: line 22: 11287 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4-$5
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   216    0     2  100   214      7    769 --:--:-- --:--:-- --:--:--   776
okRequest issued for: [node-4]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-13T20:54:40.856728794Z'
  endTime: '2021-04-13T20:55:19.122652265Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618347280843-5bfe0d6cc437e-6cd022ca-a9012233
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.117.66.216/29
  createTime: '2021-03-13T04:41:22.291533178Z'
  health: HEALTHY
  ipAddress: 10.117.66.218
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.117.66.218
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618347280843-5bfe0d6cc437e-6cd022ca-a9012233] to complete...
.................................................................................................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-4]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-13T20:56:46.294583234Z'
  endTime: '2021-04-13T20:57:27.395164325Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618347406281-5bfe0de464968-ad8a04da-6d6cb9ef
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.117.66.216/29
  createTime: '2021-03-13T04:41:22.291533178Z'
  health: HEALTHY
  ipAddress: 10.117.66.218
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.117.66.218
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618347406281-5bfe0de464968-ad8a04da-6d6cb9ef] to complete...
...........................................................................................................................................................................................................................................................................done.
europe-west4-a
I0413 20:56:44.646846 140130872387392 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [608, 608, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 7.0,
                                    'aug_rand_brightness': 0.7,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.1,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 608,
                                    'image_w': 608,
                                    'jitter_boxes': 0.4,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 608,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.75],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': False,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 0.75,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.75,
                                         'aug_rand_translate': 0.1,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 608,
                                         'image_w': 608,
                                         'jitter_boxes': 0.4,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.75],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': False,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [200000,
                                                                                250000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00261,
                                                                            0.000261,
                                                                            2.61e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0413 20:56:44.647906 140130872387392 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/params.yaml
I0413 20:56:45.548453 140130872387392 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 20:56:45.690746 140130872387392 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0413 20:56:45.691020 140130872387392 transport.py:157] Attempting refresh to obtain initial access_token
I0413 20:56:45.745252 140130872387392 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 20:56:46.359961 140130872387392 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0413 20:56:46.360245 140130872387392 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-13 20:56:46.420302: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0413 20:56:46.421254 140130872387392 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 20:56:46.561268 140130872387392 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0413 20:56:46.561509 140130872387392 transport.py:157] Attempting refresh to obtain initial access_token
I0413 20:56:46.602117 140130872387392 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 20:56:46.740839 140130872387392 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0413 20:56:46.741125 140130872387392 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-13 20:56:46.810081: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-13 20:56:46.828958: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.117.66.218:8470}
2021-04-13 20:56:46.829029: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:43498}
2021-04-13 20:56:57.417780: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.117.66.218:8470}
2021-04-13 20:56:57.417860: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:43498}
2021-04-13 20:56:57.418492: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:43498
I0413 20:56:57.419310 140130872387392 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-4
I0413 20:56:57.420528 140130872387392 tpu_strategy_util.py:74] Initializing the TPU system: node-4
INFO:tensorflow:Clearing out eager caches
I0413 20:57:06.043568 140130872387392 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0413 20:57:06.045640 140130872387392 tpu_strategy_util.py:133] Finished initializing TPU system.
I0413 20:57:06.048825 140130872387392 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 20:57:06.661523 140130872387392 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0413 20:57:06.661792 140130872387392 transport.py:157] Attempting refresh to obtain initial access_token
I0413 20:57:06.703435 140130872387392 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 20:57:07.315026 140130872387392 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4?alt=json
I0413 20:57:07.315324 140130872387392 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0413 20:57:07.358858 140130872387392 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0413 20:57:07.359162 140130872387392 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0413 20:57:07.359521 140130872387392 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0413 20:57:07.359611 140130872387392 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0413 20:57:07.359710 140130872387392 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0413 20:57:07.359956 140130872387392 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0413 20:57:07.360019 140130872387392 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0413 20:57:07.360084 140130872387392 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0413 20:57:07.360137 140130872387392 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0413 20:57:07.360186 140130872387392 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0413 20:57:07.360239 140130872387392 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0413 20:57:07.360290 140130872387392 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0413 20:57:07.360342 140130872387392 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0413 20:57:07.360424 140130872387392 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0413 20:57:07.360474 140130872387392 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0413 20:57:07.360525 140130872387392 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0413 20:57:07.398265 140130872387392 train_utils.py:214] Running default trainer.
2021-04-13 20:57:07.549951: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [608, 608, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 608, 'image_h': 608, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 608, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.4, 'aug_rand_translate': 0.1, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.7, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.75], 'random_crop': False, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 608, 'image_h': 608, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.4, 'aug_rand_translate': 0.1, 'aug_rand_saturation': 0.75, 'aug_rand_brightness': 0.75, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.75], 'random_crop': False, 'random_crop_mosaic': True}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [200000, 250000], 'values': [0.00261, 0.000261, 2.61e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05} 0.00025
{'num_classes': 91, '_input_size': [608, 608, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 608, 608, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f725e926be0>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 608, 608, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 608, 608, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 304, 304, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 304, 304, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 304, 304, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 152, 152, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 152, 152, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 152, 152, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 152, 152, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 76, 76, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 76, 76, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 38, 38, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 38, 38, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 19, 19, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 19, 19, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 19, 19, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 19, 19, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 19, 19, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 19, 19, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
conv1 512.0
conv2 1024.0
conv1 512.0
spp
conv1 512.0
conv2 1024.0
conv1 512.0
7
conv1 512.0
conv2 256.0
conv1 512.0
conv2 256.0
4








 ListWrapper([256, 512, 1024])
conv1 128
conv2 256
conv1 128
conv2 256
conv1 128
conv2 256
6
conv1 256
conv2 512
conv1 256
conv2 512
conv1 256
conv2 512
6
conv1 512
conv2 1024
conv1 512
conv2 1024
conv1 512
conv2 1024
6
detget {'3': 1.2, '4': 1.1, '5': 1.05}
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 76, 76, 256) 37319168  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 64,488,640
Trainable params: 64,422,336
Non-trainable params: 66,304
_________________________________________________________________I0413 20:57:56.201173 140130872387392 controller.py:362] restoring or initializing model...
I0413 20:58:10.787828 140130872387392 controller.py:366] restored model from gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/ckpt-5000.
I0413 20:58:10.788352 140130872387392 controller.py:192] restored from checkpoint: gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/ckpt-5000
I0413 20:58:10.788521 140130872387392 train_lib.py:96] Starts to execute mode: train_and_eval
I0413 20:58:10.793628 140130872387392 controller.py:211] train | step:   5000 | training until step 25000...
I0413 20:58:17.687561 140130872387392 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0413 20:59:21.978291 140130872387392 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0413 21:45:27.857178 140130872387392 controller.py:425] train | step:  10000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.61723024,
           'avg_obj': 0.12316191,
           'box_loss': 0.26687092,
           'class_loss': 4.896732,
           'conf_loss': 8.412275,
           'precision50': 0.13932149,
           'recall50': 0.04352915},
     '4': {'avg_iou': 0.68357354,
           'avg_obj': 0.22048622,
           'box_loss': 0.26225093,
           'class_loss': 5.43719,
           'conf_loss': 9.101716,
           'precision50': 0.28646532,
           'recall50': 0.14366293},
     '5': {'avg_iou': 0.72133714,
           'avg_obj': 0.31899503,
           'box_loss': 0.1493193,
           'class_loss': 3.507408,
           'conf_loss': 5.1839514,
           'precision50': 0.40710455,
           'recall50': 0.29507414},
     'global': {'total_loss': 37.217678},
     'learning_rate': 0.00261,
     'training_loss': 37.217678}
I0413 22:25:59.263328 140130872387392 controller.py:425] train | step:  15000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.63561726,
           'avg_obj': 0.14723721,
           'box_loss': 0.25463274,
           'class_loss': 4.3271036,
           'conf_loss': 8.191187,
           'precision50': 0.16668023,
           'recall50': 0.060694292},
     '4': {'avg_iou': 0.7071538,
           'avg_obj': 0.258705,
           'box_loss': 0.24324456,
           'class_loss': 4.7199755,
           'conf_loss': 8.662375,
           'precision50': 0.31418705,
           'recall50': 0.1846143},
     '5': {'avg_iou': 0.7435627,
           'avg_obj': 0.3661718,
           'box_loss': 0.13771123,
           'class_loss': 3.0524566,
           'conf_loss': 4.8360043,
           'precision50': 0.4301653,
           'recall50': 0.35462308},
     'global': {'total_loss': 34.424675},
     'learning_rate': 0.00261,
     'training_loss': 34.424675}
I0413 23:06:54.141914 140130872387392 controller.py:425] train | step:  20000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.64721984,
           'avg_obj': 0.16210462,
           'box_loss': 0.2463045,
           'class_loss': 3.9804847,
           'conf_loss': 8.028105,
           'precision50': 0.18133771,
           'recall50': 0.07143897},
     '4': {'avg_iou': 0.7203165,
           'avg_obj': 0.2829769,
           'box_loss': 0.23143755,
           'class_loss': 4.278008,
           'conf_loss': 8.34143,
           'precision50': 0.3253908,
           'recall50': 0.20926587},
     '5': {'avg_iou': 0.7568482,
           'avg_obj': 0.39527714,
           'box_loss': 0.13010302,
           'class_loss': 2.7678964,
           'conf_loss': 4.5949016,
           'precision50': 0.43829483,
           'recall50': 0.38978866},
     'global': {'total_loss': 32.598724},
     'learning_rate': 0.00261,
     'training_loss': 32.598724}
I0413 23:47:27.263127 140130872387392 controller.py:425] train | step:  25000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.6548507,
           'avg_obj': 0.17341387,
           'box_loss': 0.24077088,
           'class_loss': 3.7378867,
           'conf_loss': 7.902518,
           'precision50': 0.18974888,
           'recall50': 0.07976252},
     '4': {'avg_iou': 0.72962034,
           'avg_obj': 0.30015773,
           'box_loss': 0.22428343,
           'class_loss': 3.992604,
           'conf_loss': 8.155172,
           'precision50': 0.33124554,
           'recall50': 0.22643568},
     '5': {'avg_iou': 0.76601267,
           'avg_obj': 0.4159663,
           'box_loss': 0.12538792,
           'class_loss': 2.5782006,
           'conf_loss': 4.444907,
           'precision50': 0.44333023,
           'recall50': 0.4144307},
     'global': {'total_loss': 31.401731},
     'learning_rate': 0.00261,
     'training_loss': 31.401731}
I0413 23:48:16.439039 140130872387392 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/ckpt-25000.
I0413 23:48:16.445743 140130872387392 controller.py:252]  eval | step:  25000 | running 625 steps of evaluation...
I0413 23:48:17.167642 140130872387392 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0413 23:48:33.624809 140130872387392 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0413 23:53:29.307517 140130872387392 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0413 23:57:36.535593 140130872387392 controller.py:261]  eval | step:  25000 | eval time:  560.1 sec | output: 
    {'3': {'avg_iou': 0.44300273,
           'avg_obj': 0.13340463,
           'box_loss': 0.16391641,
           'class_loss': 2.0490162,
           'conf_loss': 6.166937,
           'precision50': 0.1939984,
           'recall50': 0.109177746},
     '4': {'avg_iou': 0.64109546,
           'avg_obj': 0.30008823,
           'box_loss': 0.1829047,
           'class_loss': 2.4817152,
           'conf_loss': 6.8679547,
           'precision50': 0.33754328,
           'recall50': 0.2871498},
     '5': {'avg_iou': 0.7656814,
           'avg_obj': 0.4994058,
           'box_loss': 0.114658825,
           'class_loss': 1.6942732,
           'conf_loss': 3.9463136,
           'precision50': 0.44572666,
           'recall50': 0.50612754},
     'AP': 0.27825814,
     'AP50': 0.4789865,
     'AP75': 0.29117298,
     'APl': 0.35541815,
     'APm': 0.24825753,
     'APs': 0.1060861,
     'ARl': 0.57510513,
     'ARm': 0.46987504,
     'ARmax1': 0.25550258,
     'ARmax10': 0.4381712,
     'ARmax100': 0.48397318,
     'ARs': 0.25149524,
     'global': {'total_loss': 23.667696},
     'validation_loss': 23.667696}

defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((8, 608, 608, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 200, 8), 4: (8, 200, 8), 5: (8, 200, 8)}, inds: {3: (8, 200, 3), 4: (8, 200, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 76, 76, 3, 1), 4: (8, 38, 38, 3, 1), 5: (8, 19, 19, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((1, 608, 608, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 76, 76, 3, 1), 4: (1, 38, 38, 3, 1), 5: (1, 19, 19, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
restored model from gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/ckpt-5000.
restored from checkpoint: gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/ckpt-5000
train | step:   5000 | training until step 25000...
train | step:  10000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.61723024,
           'avg_obj': 0.12316191,
           'box_loss': 0.26687092,
           'class_loss': 4.896732,
           'conf_loss': 8.412275,
           'precision50': 0.13932149,
           'recall50': 0.04352915},
     '4': {'avg_iou': 0.68357354,
           'avg_obj': 0.22048622,
           'box_loss': 0.26225093,
           'class_loss': 5.43719,
           'conf_loss': 9.101716,
           'precision50': 0.28646532,
           'recall50': 0.14366293},
     '5': {'avg_iou': 0.72133714,
           'avg_obj': 0.31899503,
           'box_loss': 0.1493193,
           'class_loss': 3.507408,
           'conf_loss': 5.1839514,
           'precision50': 0.40710455,
           'recall50': 0.29507414},
     'global': {'total_loss': 37.217678},
     'learning_rate': 0.00261,
     'training_loss': 37.217678}
train | step:  15000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.63561726,
           'avg_obj': 0.14723721,
           'box_loss': 0.25463274,
           'class_loss': 4.3271036,
           'conf_loss': 8.191187,
           'precision50': 0.16668023,
           'recall50': 0.060694292},
     '4': {'avg_iou': 0.7071538,
           'avg_obj': 0.258705,
           'box_loss': 0.24324456,
           'class_loss': 4.7199755,
           'conf_loss': 8.662375,
           'precision50': 0.31418705,
           'recall50': 0.1846143},
     '5': {'avg_iou': 0.7435627,
           'avg_obj': 0.3661718,
           'box_loss': 0.13771123,
           'class_loss': 3.0524566,
           'conf_loss': 4.8360043,
           'precision50': 0.4301653,
           'recall50': 0.35462308},
     'global': {'total_loss': 34.424675},
     'learning_rate': 0.00261,
     'training_loss': 34.424675}
train | step:  20000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.64721984,
           'avg_obj': 0.16210462,
           'box_loss': 0.2463045,
           'class_loss': 3.9804847,
           'conf_loss': 8.028105,
           'precision50': 0.18133771,
           'recall50': 0.07143897},
     '4': {'avg_iou': 0.7203165,
           'avg_obj': 0.2829769,
           'box_loss': 0.23143755,
           'class_loss': 4.278008,
           'conf_loss': 8.34143,
           'precision50': 0.3253908,
           'recall50': 0.20926587},
     '5': {'avg_iou': 0.7568482,
           'avg_obj': 0.39527714,
           'box_loss': 0.13010302,
           'class_loss': 2.7678964,
           'conf_loss': 4.5949016,
           'precision50': 0.43829483,
           'recall50': 0.38978866},
     'global': {'total_loss': 32.598724},
     'learning_rate': 0.00261,
     'training_loss': 32.598724}
train | step:  25000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.6548507,
           'avg_obj': 0.17341387,
           'box_loss': 0.24077088,
           'class_loss': 3.7378867,
           'conf_loss': 7.902518,
           'precision50': 0.18974888,
           'recall50': 0.07976252},
     '4': {'avg_iou': 0.72962034,
           'avg_obj': 0.30015773,
           'box_loss': 0.22428343,
           'class_loss': 3.992604,
           'conf_loss': 8.155172,
           'precision50': 0.33124554,
           'recall50': 0.22643568},
     '5': {'avg_iou': 0.76601267,
           'avg_obj': 0.4159663,
           'box_loss': 0.12538792,
           'class_loss': 2.5782006,
           'conf_loss': 4.444907,
           'precision50': 0.44333023,
           'recall50': 0.4144307},
     'global': {'total_loss': 31.401731},
     'learning_rate': 0.00261,
     'training_loss': 31.401731}
saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/ckpt-25000.
 eval | step:  25000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=172.93s).
Accumulating evaluation results...
DONE (t=17.68s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.278
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.479
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.291
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.106
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.248
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.355
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.256
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.438
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.484
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.251
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.470
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.575
 eval | step:  25000 | eval time:  560.1 sec | output: 
    {'3': {'avg_iou': 0.44300273,
           'avg_obj': 0.13340463,
           'box_loss': 0.16391641,
           'class_loss': 2.0490162,
           'conf_loss': 6.166937,
           'precision50': 0.1939984,
           'recall50': 0.109177746},
     '4': {'avg_iou': 0.64109546,
           'avg_obj': 0.30008823,
           'box_loss': 0.1829047,
           'class_loss': 2.4817152,
           'conf_loss': 6.8679547,
           'precision50': 0.33754328,
           'recall50': 0.2871498},
     '5': {'avg_iou': 0.7656814,
           'avg_obj': 0.4994058,
           'box_loss': 0.114658825,
           'class_loss': 1.6942732,
           'conf_loss': 3.9463136,
           'precision50': 0.44572666,
           'recall50': 0.50612754},
     'AP': 0.27825814,
     'AP50': 0.4789865,
     'AP75': 0.29117298,
     'APl': 0.35541815,
     'APm': 0.24825753,
     'APs': 0.1060861,
     'ARl': 0.57510513,
     'ARm': 0.46987504,
     'ARmax1': 0.25550258,
     'ARmax10': 0.4381712,
     'ARmax100': 0.48397318,
     'ARs': 0.25149524,
     'global': {'total_loss': 23.667696},
     'validation_loss': 23.667696}I0413 23:58:05.642421 140130872387392 controller.py:211] train | step:  25000 | training until step 45000...
I0414 00:38:23.156011 140130872387392 controller.py:425] train | step:  30000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.66009796,
           'avg_obj': 0.18312593,
           'box_loss': 0.2378747,
           'class_loss': 3.564029,
           'conf_loss': 7.8380384,
           'precision50': 0.1966208,
           'recall50': 0.086349584},
     '4': {'avg_iou': 0.73676413,
           'avg_obj': 0.31520864,
           'box_loss': 0.21847248,
           'class_loss': 3.7667515,
           'conf_loss': 7.9851093,
           'precision50': 0.33822393,
           'recall50': 0.24259095},
     '5': {'avg_iou': 0.7734861,
           'avg_obj': 0.4337975,
           'box_loss': 0.12149474,
           'class_loss': 2.4309847,
           'conf_loss': 4.3126807,
           'precision50': 0.44698262,
           'recall50': 0.43533954},
     'global': {'total_loss': 30.475378},
     'learning_rate': 0.00261,
     'training_loss': 30.475378}
I0414 01:19:03.602042 140130872387392 controller.py:425] train | step:  35000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.66544384,
           'avg_obj': 0.19146314,
           'box_loss': 0.23491047,
           'class_loss': 3.4257934,
           'conf_loss': 7.7737484,
           'precision50': 0.20441765,
           'recall50': 0.0932332},
     '4': {'avg_iou': 0.74217194,
           'avg_obj': 0.3269615,
           'box_loss': 0.21456021,
           'class_loss': 3.592673,
           'conf_loss': 7.869017,
           'precision50': 0.3422376,
           'recall50': 0.25523692},
     '5': {'avg_iou': 0.7789186,
           'avg_obj': 0.44685787,
           'box_loss': 0.11879124,
           'class_loss': 2.31478,
           'conf_loss': 4.222275,
           'precision50': 0.44838437,
           'recall50': 0.45062724},
     'global': {'total_loss': 29.766535},
     'learning_rate': 0.00261,
     'training_loss': 29.766535}
I0414 01:59:34.649582 140130872387392 controller.py:425] train | step:  40000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.66860664,
           'avg_obj': 0.19556282,
           'box_loss': 0.23239446,
           'class_loss': 3.32743,
           'conf_loss': 7.7243094,
           'precision50': 0.20674516,
           'recall50': 0.09671218},
     '4': {'avg_iou': 0.74588025,
           'avg_obj': 0.3348164,
           'box_loss': 0.21134317,
           'class_loss': 3.4793632,
           'conf_loss': 7.7707725,
           'precision50': 0.34482968,
           'recall50': 0.26272264},
     '5': {'avg_iou': 0.78212523,
           'avg_obj': 0.45466962,
           'box_loss': 0.11660866,
           'class_loss': 2.2427533,
           'conf_loss': 4.148521,
           'precision50': 0.44939122,
           'recall50': 0.4592913},
     'global': {'total_loss': 29.253504},
     'learning_rate': 0.00261,
     'training_loss': 29.253504}
I0414 02:40:09.658653 140130872387392 controller.py:425] train | step:  45000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.6719588,
           'avg_obj': 0.20272012,
           'box_loss': 0.23057498,
           'class_loss': 3.2284064,
           'conf_loss': 7.6663594,
           'precision50': 0.21130379,
           'recall50': 0.10130121},
     '4': {'avg_iou': 0.7500796,
           'avg_obj': 0.34406656,
           'box_loss': 0.20792337,
           'class_loss': 3.3443441,
           'conf_loss': 7.661499,
           'precision50': 0.34667206,
           'recall50': 0.27194047},
     '5': {'avg_iou': 0.7865517,
           'avg_obj': 0.46589825,
           'box_loss': 0.114417404,
           'class_loss': 2.152904,
           'conf_loss': 4.0676413,
           'precision50': 0.45253208,
           'recall50': 0.47199488},
     'global': {'total_loss': 28.674078},
     'learning_rate': 0.00261,
     'training_loss': 28.674078}
I0414 02:41:05.105183 140130872387392 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/ckpt-45000.
I0414 02:41:05.111224 140130872387392 controller.py:252]  eval | step:  45000 | running 625 steps of evaluation...
I0414 02:45:24.917103 140130872387392 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0414 02:49:25.045748 140130872387392 controller.py:261]  eval | step:  45000 | eval time:  499.9 sec | output: 
    {'3': {'avg_iou': 0.44874844,
           'avg_obj': 0.14188665,
           'box_loss': 0.15849179,
           'class_loss': 1.7448275,
           'conf_loss': 5.9706535,
           'precision50': 0.20289041,
           'recall50': 0.11664692},
     '4': {'avg_iou': 0.65116227,
           'avg_obj': 0.32839823,
           'box_loss': 0.17430678,
           'class_loss': 2.1171858,
           'conf_loss': 6.5778556,
           'precision50': 0.3416775,
           'recall50': 0.3168194},
     '5': {'avg_iou': 0.77893686,
           'avg_obj': 0.54107416,
           'box_loss': 0.10768655,
           'class_loss': 1.4471256,
           'conf_loss': 3.7044375,
           'precision50': 0.4461395,
           'recall50': 0.55382055},
     'AP': 0.3148931,
     'AP50': 0.5295685,
     'AP75': 0.3341226,
     'APl': 0.40259707,
     'APm': 0.2869906,
     'APs': 0.11893101,
     'ARl': 0.61134124,
     'ARm': 0.50326264,
     'ARmax1': 0.27576715,
     'ARmax10': 0.46706668,
     'ARmax100': 0.51430386,
     'ARs': 0.27615497,
     'global': {'total_loss': 22.00256},
     'validation_loss': 22.00256}
I0414 02:49:41.591410 140130872387392 controller.py:211] train | step:  45000 | training until step 65000...
I0414 03:30:04.931571 140130872387392 controller.py:425] train | step:  50000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.67507213,
           'avg_obj': 0.20872104,
           'box_loss': 0.22768405,
           'class_loss': 3.1183727,
           'conf_loss': 7.5918946,
           'precision50': 0.21437141,
           'recall50': 0.10582513},
     '4': {'avg_iou': 0.7536027,
           'avg_obj': 0.3520895,
           'box_loss': 0.2047358,
           'class_loss': 3.2200954,
           'conf_loss': 7.560127,
           'precision50': 0.34874701,
           'recall50': 0.28026453},
     '5': {'avg_iou': 0.7902166,
           'avg_obj': 0.4748354,
           'box_loss': 0.11252919,
           'class_loss': 2.07592,
           'conf_loss': 4.0021787,
           'precision50': 0.4520945,
           'recall50': 0.4818646},
     'global': {'total_loss': 28.11356},
     'learning_rate': 0.00261,
     'training_loss': 28.11356}
I0414 04:10:40.286169 140130872387392 controller.py:425] train | step:  55000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.67767745,
           'avg_obj': 0.21367346,
           'box_loss': 0.22598736,
           'class_loss': 3.0461407,
           'conf_loss': 7.5451107,
           'precision50': 0.2180365,
           'recall50': 0.10984353},
     '4': {'avg_iou': 0.75663215,
           'avg_obj': 0.35902897,
           'box_loss': 0.20250314,
           'class_loss': 3.1351767,
           'conf_loss': 7.4852133,
           'precision50': 0.35193396,
           'recall50': 0.28784528},
     '5': {'avg_iou': 0.7930393,
           'avg_obj': 0.48275062,
           'box_loss': 0.11085422,
           'class_loss': 2.010462,
           'conf_loss': 3.9356816,
           'precision50': 0.45317173,
           'recall50': 0.4906838},
     'global': {'total_loss': 27.697168},
     'learning_rate': 0.00261,
     'training_loss': 27.697168}
I0414 04:51:14.229902 140130872387392 controller.py:425] train | step:  60000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.680226,
           'avg_obj': 0.21767646,
           'box_loss': 0.22430769,
           'class_loss': 2.981867,
           'conf_loss': 7.5033226,
           'precision50': 0.21888155,
           'recall50': 0.11270498},
     '4': {'avg_iou': 0.7595107,
           'avg_obj': 0.36609858,
           'box_loss': 0.19989133,
           'class_loss': 3.053334,
           'conf_loss': 7.3950257,
           'precision50': 0.35453618,
           'recall50': 0.29428244},
     '5': {'avg_iou': 0.79583174,
           'avg_obj': 0.48927906,
           'box_loss': 0.10947386,
           'class_loss': 1.9643093,
           'conf_loss': 3.892252,
           'precision50': 0.45525602,
           'recall50': 0.49788046},
     'global': {'total_loss': 27.323757},
     'learning_rate': 0.00261,
     'training_loss': 27.323757}

train | step:  25000 | training until step 45000...
train | step:  30000 | steps/sec:    1.6 | output: 
    {'3': {'avg_iou': 0.66009796,
           'avg_obj': 0.18312593,
           'box_loss': 0.2378747,
           'class_loss': 3.564029,
           'conf_loss': 7.8380384,
           'precision50': 0.1966208,
           'recall50': 0.086349584},
     '4': {'avg_iou': 0.73676413,
           'avg_obj': 0.31520864,
           'box_loss': 0.21847248,
           'class_loss': 3.7667515,
           'conf_loss': 7.9851093,
           'precision50': 0.33822393,
           'recall50': 0.24259095},
     '5': {'avg_iou': 0.7734861,
           'avg_obj': 0.4337975,
           'box_loss': 0.12149474,
           'class_loss': 2.4309847,
           'conf_loss': 4.3126807,
           'precision50': 0.44698262,
           'recall50': 0.43533954},
     'global': {'total_loss': 30.475378},
     'learning_rate': 0.00261,
     'training_loss': 30.475378}
train | step:  35000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.66544384,
           'avg_obj': 0.19146314,
           'box_loss': 0.23491047,
           'class_loss': 3.4257934,
           'conf_loss': 7.7737484,
           'precision50': 0.20441765,
           'recall50': 0.0932332},
     '4': {'avg_iou': 0.74217194,
           'avg_obj': 0.3269615,
           'box_loss': 0.21456021,
           'class_loss': 3.592673,
           'conf_loss': 7.869017,
           'precision50': 0.3422376,
           'recall50': 0.25523692},
     '5': {'avg_iou': 0.7789186,
           'avg_obj': 0.44685787,
           'box_loss': 0.11879124,
           'class_loss': 2.31478,
           'conf_loss': 4.222275,
           'precision50': 0.44838437,
           'recall50': 0.45062724},
     'global': {'total_loss': 29.766535},
     'learning_rate': 0.00261,
     'training_loss': 29.766535}
train | step:  40000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.66860664,
           'avg_obj': 0.19556282,
           'box_loss': 0.23239446,
           'class_loss': 3.32743,
           'conf_loss': 7.7243094,
           'precision50': 0.20674516,
           'recall50': 0.09671218},
     '4': {'avg_iou': 0.74588025,
           'avg_obj': 0.3348164,
           'box_loss': 0.21134317,
           'class_loss': 3.4793632,
           'conf_loss': 7.7707725,
           'precision50': 0.34482968,
           'recall50': 0.26272264},
     '5': {'avg_iou': 0.78212523,
           'avg_obj': 0.45466962,
           'box_loss': 0.11660866,
           'class_loss': 2.2427533,
           'conf_loss': 4.148521,
           'precision50': 0.44939122,
           'recall50': 0.4592913},
     'global': {'total_loss': 29.253504},
     'learning_rate': 0.00261,
     'training_loss': 29.253504}
train | step:  45000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.6719588,
           'avg_obj': 0.20272012,
           'box_loss': 0.23057498,
           'class_loss': 3.2284064,
           'conf_loss': 7.6663594,
           'precision50': 0.21130379,
           'recall50': 0.10130121},
     '4': {'avg_iou': 0.7500796,
           'avg_obj': 0.34406656,
           'box_loss': 0.20792337,
           'class_loss': 3.3443441,
           'conf_loss': 7.661499,
           'precision50': 0.34667206,
           'recall50': 0.27194047},
     '5': {'avg_iou': 0.7865517,
           'avg_obj': 0.46589825,
           'box_loss': 0.114417404,
           'class_loss': 2.152904,
           'conf_loss': 4.0676413,
           'precision50': 0.45253208,
           'recall50': 0.47199488},
     'global': {'total_loss': 28.674078},
     'learning_rate': 0.00261,
     'training_loss': 28.674078}
saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/ckpt-45000.
 eval | step:  45000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=171.22s).
Accumulating evaluation results...
DONE (t=16.40s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.315
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.530
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.334
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.119
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.287
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.403
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.276
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.467
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.514
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.276
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.503
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.611
 eval | step:  45000 | eval time:  499.9 sec | output: 
    {'3': {'avg_iou': 0.44874844,
           'avg_obj': 0.14188665,
           'box_loss': 0.15849179,
           'class_loss': 1.7448275,
           'conf_loss': 5.9706535,
           'precision50': 0.20289041,
           'recall50': 0.11664692},
     '4': {'avg_iou': 0.65116227,
           'avg_obj': 0.32839823,
           'box_loss': 0.17430678,
           'class_loss': 2.1171858,
           'conf_loss': 6.5778556,
           'precision50': 0.3416775,
           'recall50': 0.3168194},
     '5': {'avg_iou': 0.77893686,
           'avg_obj': 0.54107416,
           'box_loss': 0.10768655,
           'class_loss': 1.4471256,
           'conf_loss': 3.7044375,
           'precision50': 0.4461395,
           'recall50': 0.55382055},
     'AP': 0.3148931,
     'AP50': 0.5295685,
     'AP75': 0.3341226,
     'APl': 0.40259707,
     'APm': 0.2869906,
     'APs': 0.11893101,
     'ARl': 0.61134124,
     'ARm': 0.50326264,
     'ARmax1': 0.27576715,
     'ARmax10': 0.46706668,
     'ARmax100': 0.51430386,
     'ARs': 0.27615497,
     'global': {'total_loss': 22.00256},
     'validation_loss': 22.00256}
train | step:  45000 | training until step 65000...
train | step:  50000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.67507213,
           'avg_obj': 0.20872104,
           'box_loss': 0.22768405,
           'class_loss': 3.1183727,
           'conf_loss': 7.5918946,
           'precision50': 0.21437141,
           'recall50': 0.10582513},
     '4': {'avg_iou': 0.7536027,
           'avg_obj': 0.3520895,
           'box_loss': 0.2047358,
           'class_loss': 3.2200954,
           'conf_loss': 7.560127,
           'precision50': 0.34874701,
           'recall50': 0.28026453},
     '5': {'avg_iou': 0.7902166,
           'avg_obj': 0.4748354,
           'box_loss': 0.11252919,
           'class_loss': 2.07592,
           'conf_loss': 4.0021787,
           'precision50': 0.4520945,
           'recall50': 0.4818646},
     'global': {'total_loss': 28.11356},
     'learning_rate': 0.00261,
     'training_loss': 28.11356}
train | step:  55000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.67767745,
           'avg_obj': 0.21367346,
           'box_loss': 0.22598736,
           'class_loss': 3.0461407,
           'conf_loss': 7.5451107,
           'precision50': 0.2180365,
           'recall50': 0.10984353},
     '4': {'avg_iou': 0.75663215,
           'avg_obj': 0.35902897,
           'box_loss': 0.20250314,
           'class_loss': 3.1351767,
           'conf_loss': 7.4852133,
           'precision50': 0.35193396,
           'recall50': 0.28784528},
     '5': {'avg_iou': 0.7930393,
           'avg_obj': 0.48275062,
           'box_loss': 0.11085422,
           'class_loss': 2.010462,
           'conf_loss': 3.9356816,
           'precision50': 0.45317173,
           'recall50': 0.4906838},
     'global': {'total_loss': 27.697168},
     'learning_rate': 0.00261,
     'training_loss': 27.697168}
train | step:  60000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.680226,
           'avg_obj': 0.21767646,
           'box_loss': 0.22430769,
           'class_loss': 2.981867,
           'conf_loss': 7.5033226,
           'precision50': 0.21888155,
           'recall50': 0.11270498},
     '4': {'avg_iou': 0.7595107,
           'avg_obj': 0.36609858,
           'box_loss': 0.19989133,
           'class_loss': 3.053334,
           'conf_loss': 7.3950257,
           'precision50': 0.35453618,
           'recall50': 0.29428244},
     '5': {'avg_iou': 0.79583174,
           'avg_obj': 0.48927906,
           'box_loss': 0.10947386,
           'class_loss': 1.9643093,
           'conf_loss': 3.892252,
           'precision50': 0.45525602,
           'recall50': 0.49788046},
     'global': {'total_loss': 27.323757},
     'learning_rate': 0.00261,
     'training_loss': 27.323757}I0414 05:31:44.410790 140130872387392 controller.py:425] train | step:  65000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.6816807,
           'avg_obj': 0.22178157,
           'box_loss': 0.2229168,
           'class_loss': 2.9115853,
           'conf_loss': 7.4576015,
           'precision50': 0.22225462,
           'recall50': 0.11614843},
     '4': {'avg_iou': 0.76193476,
           'avg_obj': 0.3713734,
           'box_loss': 0.19759391,
           'class_loss': 2.9669406,
           'conf_loss': 7.3253736,
           'precision50': 0.35451284,
           'recall50': 0.29982474},
     '5': {'avg_iou': 0.79823184,
           'avg_obj': 0.49552384,
           'box_loss': 0.10812113,
           'class_loss': 1.9118931,
           'conf_loss': 3.8413663,
           'precision50': 0.45504916,
           'recall50': 0.5055291},
     'global': {'total_loss': 26.943325},
     'learning_rate': 0.00261,
     'training_loss': 26.943325}
I0414 05:32:34.332264 140130872387392 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/ckpt-65000.
I0414 05:32:34.338391 140130872387392 controller.py:252]  eval | step:  65000 | running 625 steps of evaluation...
I0414 05:37:00.226325 140130872387392 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0414 05:41:14.805371 140130872387392 controller.py:261]  eval | step:  65000 | eval time:  520.5 sec | output: 
    {'3': {'avg_iou': 0.45293194,
           'avg_obj': 0.15885337,
           'box_loss': 0.1548669,
           'class_loss': 1.6058072,
           'conf_loss': 5.8649964,
           'precision50': 0.21158928,
           'recall50': 0.13710839},
     '4': {'avg_iou': 0.65917265,
           'avg_obj': 0.35004526,
           'box_loss': 0.16759074,
           'class_loss': 1.9336166,
           'conf_loss': 6.3729877,
           'precision50': 0.34805584,
           'recall50': 0.3437274},
     '5': {'avg_iou': 0.7864882,
           'avg_obj': 0.56720626,
           'box_loss': 0.10352675,
           'class_loss': 1.3075167,
           'conf_loss': 3.5705254,
           'precision50': 0.437018,
           'recall50': 0.5792706},
     'AP': 0.3379069,
     'AP50': 0.5591806,
     'AP75': 0.36439937,
     'APl': 0.43209448,
     'APm': 0.30739558,
     'APs': 0.13533527,
     'ARl': 0.6253223,
     'ARm': 0.5175184,
     'ARmax1': 0.28843048,
     'ARmax10': 0.48345613,
     'ARmax100': 0.52934855,
     'ARs': 0.29108354,
     'global': {'total_loss': 21.081429},
     'validation_loss': 21.081429}
I0414 05:41:37.458479 140130872387392 controller.py:211] train | step:  65000 | training until step 85000...
I0414 06:22:01.034377 140130872387392 controller.py:425] train | step:  70000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6836149,
           'avg_obj': 0.22605039,
           'box_loss': 0.22095977,
           'class_loss': 2.858233,
           'conf_loss': 7.3945804,
           'precision50': 0.2238862,
           'recall50': 0.11888008},
     '4': {'avg_iou': 0.76397336,
           'avg_obj': 0.37622482,
           'box_loss': 0.1954032,
           'class_loss': 2.9044762,
           'conf_loss': 7.2464943,
           'precision50': 0.35523054,
           'recall50': 0.30516648},
     '5': {'avg_iou': 0.8001708,
           'avg_obj': 0.50030035,
           'box_loss': 0.10699647,
           'class_loss': 1.8703598,
           'conf_loss': 3.803919,
           'precision50': 0.45513207,
           'recall50': 0.5097476},
     'global': {'total_loss': 26.601435},
     'learning_rate': 0.00261,
     'training_loss': 26.601435}
I0414 07:02:31.560325 140130872387392 controller.py:425] train | step:  75000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.6858661,
           'avg_obj': 0.22949682,
           'box_loss': 0.21954288,
           'class_loss': 2.8014967,
           'conf_loss': 7.3671994,
           'precision50': 0.2254164,
           'recall50': 0.121027395},
     '4': {'avg_iou': 0.76595867,
           'avg_obj': 0.3807737,
           'box_loss': 0.1944914,
           'class_loss': 2.8488634,
           'conf_loss': 7.2216244,
           'precision50': 0.35584122,
           'recall50': 0.3091975},
     '5': {'avg_iou': 0.80198294,
           'avg_obj': 0.5061826,
           'box_loss': 0.10619727,
           'class_loss': 1.8258502,
           'conf_loss': 3.7664316,
           'precision50': 0.4541883,
           'recall50': 0.515514},
     'global': {'total_loss': 26.351656},
     'learning_rate': 0.00261,
     'training_loss': 26.351656}
I0414 07:42:52.786721 140130872387392 controller.py:425] train | step:  80000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.6868971,
           'avg_obj': 0.23178346,
           'box_loss': 0.21934907,
           'class_loss': 2.773601,
           'conf_loss': 7.358002,
           'precision50': 0.22706094,
           'recall50': 0.12307434},
     '4': {'avg_iou': 0.7676223,
           'avg_obj': 0.38537228,
           'box_loss': 0.19299352,
           'class_loss': 2.805829,
           'conf_loss': 7.1637,
           'precision50': 0.357238,
           'recall50': 0.31411994},
     '5': {'avg_iou': 0.80364305,
           'avg_obj': 0.5107723,
           'box_loss': 0.105230264,
           'class_loss': 1.7943615,
           'conf_loss': 3.7273464,
           'precision50': 0.45611924,
           'recall50': 0.5215485},
     'global': {'total_loss': 26.1404},
     'learning_rate': 0.00261,
     'training_loss': 26.1404}
I0414 08:23:18.354393 140130872387392 controller.py:425] train | step:  85000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.68872523,
           'avg_obj': 0.23439041,
           'box_loss': 0.21850055,
           'class_loss': 2.718547,
           'conf_loss': 7.3417506,
           'precision50': 0.22870049,
           'recall50': 0.12537557},
     '4': {'avg_iou': 0.76950085,
           'avg_obj': 0.38941154,
           'box_loss': 0.19194373,
           'class_loss': 2.7430112,
           'conf_loss': 7.134784,
           'precision50': 0.35886407,
           'recall50': 0.31852418},
     '5': {'avg_iou': 0.8052106,
           'avg_obj': 0.51540637,
           'box_loss': 0.10454911,
           'class_loss': 1.758681,
           'conf_loss': 3.6973348,
           'precision50': 0.4563169,
           'recall50': 0.52628404},
     'global': {'total_loss': 25.90911},
     'learning_rate': 0.00261,
     'training_loss': 25.90911}
I0414 08:24:10.740910 140130872387392 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/ckpt-85000.
I0414 08:24:10.747264 140130872387392 controller.py:252]  eval | step:  85000 | running 625 steps of evaluation...
I0414 08:28:37.717235 140130872387392 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.

train | step:  65000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.6816807,
           'avg_obj': 0.22178157,
           'box_loss': 0.2229168,
           'class_loss': 2.9115853,
           'conf_loss': 7.4576015,
           'precision50': 0.22225462,
           'recall50': 0.11614843},
     '4': {'avg_iou': 0.76193476,
           'avg_obj': 0.3713734,
           'box_loss': 0.19759391,
           'class_loss': 2.9669406,
           'conf_loss': 7.3253736,
           'precision50': 0.35451284,
           'recall50': 0.29982474},
     '5': {'avg_iou': 0.79823184,
           'avg_obj': 0.49552384,
           'box_loss': 0.10812113,
           'class_loss': 1.9118931,
           'conf_loss': 3.8413663,
           'precision50': 0.45504916,
           'recall50': 0.5055291},
     'global': {'total_loss': 26.943325},
     'learning_rate': 0.00261,
     'training_loss': 26.943325}
saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/ckpt-65000.
 eval | step:  65000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=173.52s).
Accumulating evaluation results...
DONE (t=20.02s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.338
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.559
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.364
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.135
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.307
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.432
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.288
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.483
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.529
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.291
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.518
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.625
 eval | step:  65000 | eval time:  520.5 sec | output: 
    {'3': {'avg_iou': 0.45293194,
           'avg_obj': 0.15885337,
           'box_loss': 0.1548669,
           'class_loss': 1.6058072,
           'conf_loss': 5.8649964,
           'precision50': 0.21158928,
           'recall50': 0.13710839},
     '4': {'avg_iou': 0.65917265,
           'avg_obj': 0.35004526,
           'box_loss': 0.16759074,
           'class_loss': 1.9336166,
           'conf_loss': 6.3729877,
           'precision50': 0.34805584,
           'recall50': 0.3437274},
     '5': {'avg_iou': 0.7864882,
           'avg_obj': 0.56720626,
           'box_loss': 0.10352675,
           'class_loss': 1.3075167,
           'conf_loss': 3.5705254,
           'precision50': 0.437018,
           'recall50': 0.5792706},
     'AP': 0.3379069,
     'AP50': 0.5591806,
     'AP75': 0.36439937,
     'APl': 0.43209448,
     'APm': 0.30739558,
     'APs': 0.13533527,
     'ARl': 0.6253223,
     'ARm': 0.5175184,
     'ARmax1': 0.28843048,
     'ARmax10': 0.48345613,
     'ARmax100': 0.52934855,
     'ARs': 0.29108354,
     'global': {'total_loss': 21.081429},
     'validation_loss': 21.081429}
train | step:  65000 | training until step 85000...
train | step:  70000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6836149,
           'avg_obj': 0.22605039,
           'box_loss': 0.22095977,
           'class_loss': 2.858233,
           'conf_loss': 7.3945804,
           'precision50': 0.2238862,
           'recall50': 0.11888008},
     '4': {'avg_iou': 0.76397336,
           'avg_obj': 0.37622482,
           'box_loss': 0.1954032,
           'class_loss': 2.9044762,
           'conf_loss': 7.2464943,
           'precision50': 0.35523054,
           'recall50': 0.30516648},
     '5': {'avg_iou': 0.8001708,
           'avg_obj': 0.50030035,
           'box_loss': 0.10699647,
           'class_loss': 1.8703598,
           'conf_loss': 3.803919,
           'precision50': 0.45513207,
           'recall50': 0.5097476},
     'global': {'total_loss': 26.601435},
     'learning_rate': 0.00261,
     'training_loss': 26.601435}
train | step:  75000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.6858661,
           'avg_obj': 0.22949682,
           'box_loss': 0.21954288,
           'class_loss': 2.8014967,
           'conf_loss': 7.3671994,
           'precision50': 0.2254164,
           'recall50': 0.121027395},
     '4': {'avg_iou': 0.76595867,
           'avg_obj': 0.3807737,
           'box_loss': 0.1944914,
           'class_loss': 2.8488634,
           'conf_loss': 7.2216244,
           'precision50': 0.35584122,
           'recall50': 0.3091975},
     '5': {'avg_iou': 0.80198294,
           'avg_obj': 0.5061826,
           'box_loss': 0.10619727,
           'class_loss': 1.8258502,
           'conf_loss': 3.7664316,
           'precision50': 0.4541883,
           'recall50': 0.515514},
     'global': {'total_loss': 26.351656},
     'learning_rate': 0.00261,
     'training_loss': 26.351656}
train | step:  80000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.6868971,
           'avg_obj': 0.23178346,
           'box_loss': 0.21934907,
           'class_loss': 2.773601,
           'conf_loss': 7.358002,
           'precision50': 0.22706094,
           'recall50': 0.12307434},
     '4': {'avg_iou': 0.7676223,
           'avg_obj': 0.38537228,
           'box_loss': 0.19299352,
           'class_loss': 2.805829,
           'conf_loss': 7.1637,
           'precision50': 0.357238,
           'recall50': 0.31411994},
     '5': {'avg_iou': 0.80364305,
           'avg_obj': 0.5107723,
           'box_loss': 0.105230264,
           'class_loss': 1.7943615,
           'conf_loss': 3.7273464,
           'precision50': 0.45611924,
           'recall50': 0.5215485},
     'global': {'total_loss': 26.1404},
     'learning_rate': 0.00261,
     'training_loss': 26.1404}
train | step:  85000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.68872523,
           'avg_obj': 0.23439041,
           'box_loss': 0.21850055,
           'class_loss': 2.718547,
           'conf_loss': 7.3417506,
           'precision50': 0.22870049,
           'recall50': 0.12537557},
     '4': {'avg_iou': 0.76950085,
           'avg_obj': 0.38941154,
           'box_loss': 0.19194373,
           'class_loss': 2.7430112,
           'conf_loss': 7.134784,
           'precision50': 0.35886407,
           'recall50': 0.31852418},
     '5': {'avg_iou': 0.8052106,
           'avg_obj': 0.51540637,
           'box_loss': 0.10454911,
           'class_loss': 1.758681,
           'conf_loss': 3.6973348,
           'precision50': 0.4563169,
           'recall50': 0.52628404},
     'global': {'total_loss': 25.90911},
     'learning_rate': 0.00261,
     'training_loss': 25.90911}
saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/ckpt-85000.
 eval | step:  85000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=175.81s).
Accumulating evaluation results...
DONE (t=15.50s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.352
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.575
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.378
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.142
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.322
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.453
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.297
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.497
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.544
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.306
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.536I0414 08:32:41.542890 140130872387392 controller.py:261]  eval | step:  85000 | eval time:  510.8 sec | output: 
    {'3': {'avg_iou': 0.45557207,
           'avg_obj': 0.16760439,
           'box_loss': 0.1523784,
           'class_loss': 1.5275648,
           'conf_loss': 5.803314,
           'precision50': 0.21619846,
           'recall50': 0.14992751},
     '4': {'avg_iou': 0.6636796,
           'avg_obj': 0.36365423,
           'box_loss': 0.16365582,
           'class_loss': 1.8238627,
           'conf_loss': 6.277446,
           'precision50': 0.34724218,
           'recall50': 0.3588574},
     '5': {'avg_iou': 0.79198474,
           'avg_obj': 0.58186394,
           'box_loss': 0.10054254,
           'class_loss': 1.2193236,
           'conf_loss': 3.4818425,
           'precision50': 0.43797866,
           'recall50': 0.59603184},
     'AP': 0.35218528,
     'AP50': 0.57499343,
     'AP75': 0.37785888,
     'APl': 0.45265144,
     'APm': 0.322233,
     'APs': 0.14183606,
     'ARl': 0.6413398,
     'ARm': 0.5358789,
     'ARmax1': 0.29689026,
     'ARmax10': 0.4969035,
     'ARmax100': 0.5443007,
     'ARs': 0.30562785,
     'global': {'total_loss': 20.549925},
     'validation_loss': 20.549925}
I0414 08:33:08.726465 140130872387392 controller.py:211] train | step:  85000 | training until step 105000...
I0414 09:13:32.424375 140130872387392 controller.py:425] train | step:  90000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6896419,
           'avg_obj': 0.23761523,
           'box_loss': 0.21815571,
           'class_loss': 2.6892264,
           'conf_loss': 7.3241744,
           'precision50': 0.23011987,
           'recall50': 0.1276141},
     '4': {'avg_iou': 0.77085227,
           'avg_obj': 0.39323014,
           'box_loss': 0.19044925,
           'class_loss': 2.6972663,
           'conf_loss': 7.07742,
           'precision50': 0.35993573,
           'recall50': 0.32249072},
     '5': {'avg_iou': 0.80682653,
           'avg_obj': 0.5196539,
           'box_loss': 0.10349872,
           'class_loss': 1.7232678,
           'conf_loss': 3.658657,
           'precision50': 0.4559466,
           'recall50': 0.53065336},
     'global': {'total_loss': 25.682129},
     'learning_rate': 0.00261,
     'training_loss': 25.682129}
I0414 09:54:15.686419 140130872387392 controller.py:425] train | step:  95000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.6910393,
           'avg_obj': 0.24029675,
           'box_loss': 0.21701814,
           'class_loss': 2.6492124,
           'conf_loss': 7.2916436,
           'precision50': 0.23123674,
           'recall50': 0.12920086},
     '4': {'avg_iou': 0.7723099,
           'avg_obj': 0.3970291,
           'box_loss': 0.1893497,
           'class_loss': 2.6496768,
           'conf_loss': 7.0359077,
           'precision50': 0.3593533,
           'recall50': 0.32575306},
     '5': {'avg_iou': 0.80837786,
           'avg_obj': 0.5233938,
           'box_loss': 0.10261964,
           'class_loss': 1.692916,
           'conf_loss': 3.6288886,
           'precision50': 0.45633247,
           'recall50': 0.5346861},
     'global': {'total_loss': 25.4572},
     'learning_rate': 0.00261,
     'training_loss': 25.4572}
I0414 10:34:40.362469 140130872387392 controller.py:425] train | step:  100000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.69216573,
           'avg_obj': 0.2429478,
           'box_loss': 0.21502769,
           'class_loss': 2.595645,
           'conf_loss': 7.227774,
           'precision50': 0.23235694,
           'recall50': 0.13201456},
     '4': {'avg_iou': 0.77369547,
           'avg_obj': 0.40107897,
           'box_loss': 0.18784834,
           'class_loss': 2.609723,
           'conf_loss': 6.9753046,
           'precision50': 0.36114508,
           'recall50': 0.3300835},
     '5': {'avg_iou': 0.8094064,
           'avg_obj': 0.5268421,
           'box_loss': 0.10210069,
           'class_loss': 1.671367,
           'conf_loss': 3.6044269,
           'precision50': 0.4562936,
           'recall50': 0.5388484},
     'global': {'total_loss': 25.189215},
     'learning_rate': 0.00261,
     'training_loss': 25.189215}
I0414 11:15:10.209675 140130872387392 controller.py:425] train | step:  105000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.69346905,
           'avg_obj': 0.2452624,
           'box_loss': 0.21526644,
           'class_loss': 2.569435,
           'conf_loss': 7.238921,
           'precision50': 0.23383784,
           'recall50': 0.1333222},
     '4': {'avg_iou': 0.77487344,
           'avg_obj': 0.40405178,
           'box_loss': 0.18700662,
           'class_loss': 2.5647244,
           'conf_loss': 6.9439807,
           'precision50': 0.36072874,
           'recall50': 0.3328578},
     '5': {'avg_iou': 0.81090564,
           'avg_obj': 0.5304601,
           'box_loss': 0.101346515,
           'class_loss': 1.642055,
           'conf_loss': 3.5789747,
           'precision50': 0.45703605,
           'recall50': 0.54289854},
     'global': {'total_loss': 25.041697},
     'learning_rate': 0.00261,
     'training_loss': 25.041697}
I0414 11:15:59.997820 140130872387392 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/ckpt-105000.
I0414 11:16:00.004815 140130872387392 controller.py:252]  eval | step:  105000 | running 625 steps of evaluation...
I0414 11:20:25.490867 140130872387392 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0414 11:24:27.460619 140130872387392 controller.py:261]  eval | step:  105000 | eval time:  507.5 sec | output: 
    {'3': {'avg_iou': 0.4573811,
           'avg_obj': 0.1721799,
           'box_loss': 0.15112895,
           'class_loss': 1.4844546,
           'conf_loss': 5.7610636,
           'precision50': 0.22173281,
           'recall50': 0.15538697},
     '4': {'avg_iou': 0.66684777,
           'avg_obj': 0.37573493,
           'box_loss': 0.16097057,
           'class_loss': 1.7531031,
           'conf_loss': 6.2015533,
           'precision50': 0.34740195,
           'recall50': 0.37159455},
     '5': {'avg_iou': 0.79554874,
           'avg_obj': 0.5950696,
           'box_loss': 0.09875897,
           'class_loss': 1.1630303,
           'conf_loss': 3.4135907,
           'precision50': 0.4357788,
           'recall50': 0.6105556},
     'AP': 0.3612042,
     'AP50': 0.5865191,
     'AP75': 0.3891917,
     'APl': 0.46222055,
     'APm': 0.3310837,
     'APs': 0.14240858,
     'ARl': 0.64489776,
     'ARm': 0.54027057,
     'ARmax1': 0.30064875,
     'ARmax10': 0.50218153,
     'ARmax100': 0.54828024,
     'ARs': 0.30954203,
     'global': {'total_loss': 20.18766},
     'validation_loss': 20.18766}
I0414 11:24:44.567191 140130872387392 controller.py:211] train | step:  105000 | training until step 125000...
I0414 12:04:52.346393 140130872387392 controller.py:425] train | step:  110000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6941397,
           'avg_obj': 0.24741043,
           'box_loss': 0.21415344,
           'class_loss': 2.5407572,
           'conf_loss': 7.199958,
           'precision50': 0.23386286,
           'recall50': 0.13490593},
     '4': {'avg_iou': 0.776138,
           'avg_obj': 0.40734878,
           'box_loss': 0.18620051,
           'class_loss': 2.5337977,
           'conf_loss': 6.9152775,
           'precision50': 0.36088347,
           'recall50': 0.3355136},
     '5': {'avg_iou': 0.8121395,
           'avg_obj': 0.5341617,
           'box_loss': 0.10082852,
           'class_loss': 1.6259439,
           'conf_loss': 3.5557551,
           'precision50': 0.4559038,
           'recall50': 0.54742336},
     'global': {'total_loss': 24.872688},
     'learning_rate': 0.00261,
     'training_loss': 24.872688}

 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.641
 eval | step:  85000 | eval time:  510.8 sec | output: 
    {'3': {'avg_iou': 0.45557207,
           'avg_obj': 0.16760439,
           'box_loss': 0.1523784,
           'class_loss': 1.5275648,
           'conf_loss': 5.803314,
           'precision50': 0.21619846,
           'recall50': 0.14992751},
     '4': {'avg_iou': 0.6636796,
           'avg_obj': 0.36365423,
           'box_loss': 0.16365582,
           'class_loss': 1.8238627,
           'conf_loss': 6.277446,
           'precision50': 0.34724218,
           'recall50': 0.3588574},
     '5': {'avg_iou': 0.79198474,
           'avg_obj': 0.58186394,
           'box_loss': 0.10054254,
           'class_loss': 1.2193236,
           'conf_loss': 3.4818425,
           'precision50': 0.43797866,
           'recall50': 0.59603184},
     'AP': 0.35218528,
     'AP50': 0.57499343,
     'AP75': 0.37785888,
     'APl': 0.45265144,
     'APm': 0.322233,
     'APs': 0.14183606,
     'ARl': 0.6413398,
     'ARm': 0.5358789,
     'ARmax1': 0.29689026,
     'ARmax10': 0.4969035,
     'ARmax100': 0.5443007,
     'ARs': 0.30562785,
     'global': {'total_loss': 20.549925},
     'validation_loss': 20.549925}
train | step:  85000 | training until step 105000...
train | step:  90000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6896419,
           'avg_obj': 0.23761523,
           'box_loss': 0.21815571,
           'class_loss': 2.6892264,
           'conf_loss': 7.3241744,
           'precision50': 0.23011987,
           'recall50': 0.1276141},
     '4': {'avg_iou': 0.77085227,
           'avg_obj': 0.39323014,
           'box_loss': 0.19044925,
           'class_loss': 2.6972663,
           'conf_loss': 7.07742,
           'precision50': 0.35993573,
           'recall50': 0.32249072},
     '5': {'avg_iou': 0.80682653,
           'avg_obj': 0.5196539,
           'box_loss': 0.10349872,
           'class_loss': 1.7232678,
           'conf_loss': 3.658657,
           'precision50': 0.4559466,
           'recall50': 0.53065336},
     'global': {'total_loss': 25.682129},
     'learning_rate': 0.00261,
     'training_loss': 25.682129}
train | step:  95000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.6910393,
           'avg_obj': 0.24029675,
           'box_loss': 0.21701814,
           'class_loss': 2.6492124,
           'conf_loss': 7.2916436,
           'precision50': 0.23123674,
           'recall50': 0.12920086},
     '4': {'avg_iou': 0.7723099,
           'avg_obj': 0.3970291,
           'box_loss': 0.1893497,
           'class_loss': 2.6496768,
           'conf_loss': 7.0359077,
           'precision50': 0.3593533,
           'recall50': 0.32575306},
     '5': {'avg_iou': 0.80837786,
           'avg_obj': 0.5233938,
           'box_loss': 0.10261964,
           'class_loss': 1.692916,
           'conf_loss': 3.6288886,
           'precision50': 0.45633247,
           'recall50': 0.5346861},
     'global': {'total_loss': 25.4572},
     'learning_rate': 0.00261,
     'training_loss': 25.4572}
train | step:  100000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.69216573,
           'avg_obj': 0.2429478,
           'box_loss': 0.21502769,
           'class_loss': 2.595645,
           'conf_loss': 7.227774,
           'precision50': 0.23235694,
           'recall50': 0.13201456},
     '4': {'avg_iou': 0.77369547,
           'avg_obj': 0.40107897,
           'box_loss': 0.18784834,
           'class_loss': 2.609723,
           'conf_loss': 6.9753046,
           'precision50': 0.36114508,
           'recall50': 0.3300835},
     '5': {'avg_iou': 0.8094064,
           'avg_obj': 0.5268421,
           'box_loss': 0.10210069,
           'class_loss': 1.671367,
           'conf_loss': 3.6044269,
           'precision50': 0.4562936,
           'recall50': 0.5388484},
     'global': {'total_loss': 25.189215},
     'learning_rate': 0.00261,
     'training_loss': 25.189215}
train | step:  105000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.69346905,
           'avg_obj': 0.2452624,
           'box_loss': 0.21526644,
           'class_loss': 2.569435,
           'conf_loss': 7.238921,
           'precision50': 0.23383784,
           'recall50': 0.1333222},
     '4': {'avg_iou': 0.77487344,
           'avg_obj': 0.40405178,
           'box_loss': 0.18700662,
           'class_loss': 2.5647244,
           'conf_loss': 6.9439807,
           'precision50': 0.36072874,
           'recall50': 0.3328578},
     '5': {'avg_iou': 0.81090564,
           'avg_obj': 0.5304601,
           'box_loss': 0.101346515,
           'class_loss': 1.642055,
           'conf_loss': 3.5789747,
           'precision50': 0.45703605,
           'recall50': 0.54289854},
     'global': {'total_loss': 25.041697},
     'learning_rate': 0.00261,
     'training_loss': 25.041697}
saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/ckpt-105000.
 eval | step:  105000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=174.02s).
Accumulating evaluation results...
DONE (t=14.84s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.361
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.587
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.389
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.142
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.331
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.462
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.301
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.502
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.548
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.310
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.540
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.645
 eval | step:  105000 | eval time:  507.5 sec | output: 
    {'3': {'avg_iou': 0.4573811,
           'avg_obj': 0.1721799,
           'box_loss': 0.15112895,
           'class_loss': 1.4844546,
           'conf_loss': 5.7610636,
           'precision50': 0.22173281,
           'recall50': 0.15538697},
     '4': {'avg_iou': 0.66684777,
           'avg_obj': 0.37573493,
           'box_loss': 0.16097057,
           'class_loss': 1.7531031,
           'conf_loss': 6.2015533,
           'precision50': 0.34740195,
           'recall50': 0.37159455},
     '5': {'avg_iou': 0.79554874,
           'avg_obj': 0.5950696,
           'box_loss': 0.09875897,
           'class_loss': 1.1630303,
           'conf_loss': 3.4135907,
           'precision50': 0.4357788,
           'recall50': 0.6105556},
     'AP': 0.3612042,
     'AP50': 0.5865191,
     'AP75': 0.3891917,
     'APl': 0.46222055,
     'APm': 0.3310837,
     'APs': 0.14240858,
     'ARl': 0.64489776,
     'ARm': 0.54027057,
     'ARmax1': 0.30064875,
     'ARmax10': 0.50218153,
     'ARmax100': 0.54828024,
     'ARs': 0.30954203,
     'global': {'total_loss': 20.18766},
     'validation_loss': 20.18766}
train | step:  105000 | training until step 125000...
train | step:  110000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6941397,
           'avg_obj': 0.24741043,
           'box_loss': 0.21415344,
           'class_loss': 2.5407572,
           'conf_loss': 7.199958,
           'precision50': 0.23386286,
           'recall50': 0.13490593},
     '4': {'avg_iou': 0.776138,
           'avg_obj': 0.40734878,
           'box_loss': 0.18620051,
           'class_loss': 2.5337977,
           'conf_loss': 6.9152775,
           'precision50': 0.36088347,
           'recall50': 0.3355136},
     '5': {'avg_iou': 0.8121395,
           'avg_obj': 0.5341617,
           'box_loss': 0.10082852,
           'class_loss': 1.6259439,
           'conf_loss': 3.5557551,
           'precision50': 0.4559038,
           'recall50': 0.54742336},
     'global': {'total_loss': 24.872688},
     'learning_rate': 0.00261,
     'training_loss': 24.872688}I0414 12:45:25.911024 140130872387392 controller.py:425] train | step:  115000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.69512004,
           'avg_obj': 0.24952537,
           'box_loss': 0.21393132,
           'class_loss': 2.5093684,
           'conf_loss': 7.1916757,
           'precision50': 0.23558342,
           'recall50': 0.13664186},
     '4': {'avg_iou': 0.7770761,
           'avg_obj': 0.41029674,
           'box_loss': 0.18508169,
           'class_loss': 2.4953277,
           'conf_loss': 6.8645024,
           'precision50': 0.36116284,
           'recall50': 0.33870894},
     '5': {'avg_iou': 0.81291544,
           'avg_obj': 0.53767616,
           'box_loss': 0.10011167,
           'class_loss': 1.5928541,
           'conf_loss': 3.5186765,
           'precision50': 0.4561226,
           'recall50': 0.5509764},
     'global': {'total_loss': 24.671534},
     'learning_rate': 0.00261,
     'training_loss': 24.671534}
I0414 13:25:53.918251 140130872387392 controller.py:425] train | step:  120000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.6962353,
           'avg_obj': 0.25256976,
           'box_loss': 0.21364129,
           'class_loss': 2.4858558,
           'conf_loss': 7.181435,
           'precision50': 0.23635986,
           'recall50': 0.13829145},
     '4': {'avg_iou': 0.77818316,
           'avg_obj': 0.4137883,
           'box_loss': 0.1842944,
           'class_loss': 2.4628813,
           'conf_loss': 6.8329773,
           'precision50': 0.3625625,
           'recall50': 0.3417161},
     '5': {'avg_iou': 0.8141453,
           'avg_obj': 0.5408885,
           'box_loss': 0.09965213,
           'class_loss': 1.57408,
           'conf_loss': 3.5010598,
           'precision50': 0.4550662,
           'recall50': 0.5530019},
     'global': {'total_loss': 24.535856},
     'learning_rate': 0.00261,
     'training_loss': 24.535856}
I0414 14:06:25.509331 140130872387392 controller.py:425] train | step:  125000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.6970111,
           'avg_obj': 0.254107,
           'box_loss': 0.21283762,
           'class_loss': 2.45626,
           'conf_loss': 7.15434,
           'precision50': 0.23778081,
           'recall50': 0.14000167},
     '4': {'avg_iou': 0.7791331,
           'avg_obj': 0.41578546,
           'box_loss': 0.1835417,
           'class_loss': 2.4353938,
           'conf_loss': 6.808957,
           'precision50': 0.36357912,
           'recall50': 0.34420198},
     '5': {'avg_iou': 0.81493556,
           'avg_obj': 0.54279935,
           'box_loss': 0.09921028,
           'class_loss': 1.5600145,
           'conf_loss': 3.48593,
           'precision50': 0.45639366,
           'recall50': 0.5559049},
     'global': {'total_loss': 24.396496},
     'learning_rate': 0.00261,
     'training_loss': 24.396496}
I0414 14:07:15.329846 140130872387392 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/ckpt-125000.
I0414 14:07:15.337687 140130872387392 controller.py:252]  eval | step:  125000 | running 625 steps of evaluation...
I0414 14:11:47.030950 140130872387392 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0414 14:16:05.712823 140130872387392 controller.py:261]  eval | step:  125000 | eval time:  530.4 sec | output: 
    {'3': {'avg_iou': 0.45909145,
           'avg_obj': 0.17720135,
           'box_loss': 0.14968058,
           'class_loss': 1.4527184,
           'conf_loss': 5.736896,
           'precision50': 0.22241424,
           'recall50': 0.16271321},
     '4': {'avg_iou': 0.6694548,
           'avg_obj': 0.38419202,
           'box_loss': 0.15899163,
           'class_loss': 1.7097089,
           'conf_loss': 6.1636696,
           'precision50': 0.34984994,
           'recall50': 0.3824448},
     '5': {'avg_iou': 0.7973209,
           'avg_obj': 0.602844,
           'box_loss': 0.09752715,
           'class_loss': 1.1261393,
           'conf_loss': 3.3754637,
           'precision50': 0.43440822,
           'recall50': 0.6180564},
     'AP': 0.36834204,
     'AP50': 0.5945174,
     'AP75': 0.39934677,
     'APl': 0.47509146,
     'APm': 0.3368938,
     'APs': 0.1462432,
     'ARl': 0.6493947,
     'ARm': 0.5442285,
     'ARmax1': 0.3039918,
     'ARmax10': 0.5071677,
     'ARmax100': 0.5535326,
     'ARs': 0.32155433,
     'global': {'total_loss': 19.970798},
     'validation_loss': 19.970798}
I0414 14:16:23.057687 140130872387392 controller.py:211] train | step:  125000 | training until step 145000...
I0414 14:56:44.241528 140130872387392 controller.py:425] train | step:  130000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6980789,
           'avg_obj': 0.2564559,
           'box_loss': 0.21177807,
           'class_loss': 2.4251008,
           'conf_loss': 7.1257052,
           'precision50': 0.23758677,
           'recall50': 0.1413573},
     '4': {'avg_iou': 0.7801974,
           'avg_obj': 0.41912085,
           'box_loss': 0.18262267,
           'class_loss': 2.4019845,
           'conf_loss': 6.767134,
           'precision50': 0.36350533,
           'recall50': 0.34769174},
     '5': {'avg_iou': 0.81576985,
           'avg_obj': 0.546051,
           'box_loss': 0.09866887,
           'class_loss': 1.5353053,
           'conf_loss': 3.4582362,
           'precision50': 0.45623365,
           'recall50': 0.5589652},
     'global': {'total_loss': 24.20654},
     'learning_rate': 0.00261,
     'training_loss': 24.20654}
I0414 15:37:03.184767 140130872387392 controller.py:425] train | step:  135000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.6987753,
           'avg_obj': 0.2580533,
           'box_loss': 0.21219862,
           'class_loss': 2.4096155,
           'conf_loss': 7.1412735,
           'precision50': 0.24031334,
           'recall50': 0.14351064},
     '4': {'avg_iou': 0.78087366,
           'avg_obj': 0.42153364,
           'box_loss': 0.18278919,
           'class_loss': 2.3807242,
           'conf_loss': 6.763645,
           'precision50': 0.36516905,
           'recall50': 0.35152668},
     '5': {'avg_iou': 0.81663007,
           'avg_obj': 0.5488018,
           'box_loss': 0.09841545,
           'class_loss': 1.5224358,
           'conf_loss': 3.4448707,
           'precision50': 0.45655942,
           'recall50': 0.56171775},
     'global': {'total_loss': 24.155987},
     'learning_rate': 0.00261,
     'training_loss': 24.155987}
I0414 16:17:27.026938 140130872387392 controller.py:425] train | step:  140000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.69918334,
           'avg_obj': 0.25952724,
           'box_loss': 0.2109031,
           'class_loss': 2.3792055,
           'conf_loss': 7.0896173,
           'precision50': 0.23978603,
           'recall50': 0.14390135},
     '4': {'avg_iou': 0.78181785,
           'avg_obj': 0.4237195,
           'box_loss': 0.1811119,
           'class_loss': 2.3539948,
           'conf_loss': 6.7103024,
           'precision50': 0.3627761,
           'recall50': 0.35230607},
     '5': {'avg_iou': 0.8173198,
           'avg_obj': 0.55161536,
           'box_loss': 0.097879246,
           'class_loss': 1.5071102,
           'conf_loss': 3.41756,
           'precision50': 0.45541328,
           'recall50': 0.56382453},
     'global': {'total_loss': 23.9477},
     'learning_rate': 0.00261,
     'training_loss': 23.9477}
I0414 16:57:52.522179 140130872387392 controller.py:425] train | step:  145000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.69990075,
           'avg_obj': 0.26115534,
           'box_loss': 0.21032739,
           'class_loss': 2.3551695,
           'conf_loss': 7.072204,
           'precision50': 0.24089769,
           'recall50': 0.14520866},
     '4': {'avg_iou': 0.7824445,
           'avg_obj': 0.42601025,
           'box_loss': 0.1805524,
           'class_loss': 2.318857,
           'conf_loss': 6.680047,
           'precision50': 0.36387706,
           'recall50': 0.35412604},
     '5': {'avg_iou': 0.8184416,
           'avg_obj': 0.5544771,
           'box_loss': 0.09732727,
           'class_loss': 1.4801672,
           'conf_loss': 3.3958774,
           'precision50': 0.45667744,
           'recall50': 0.5678704},
     'global': {'total_loss': 23.790533},
     'learning_rate': 0.00261,
     'training_loss': 23.790533}

train | step:  115000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.69512004,
           'avg_obj': 0.24952537,
           'box_loss': 0.21393132,
           'class_loss': 2.5093684,
           'conf_loss': 7.1916757,
           'precision50': 0.23558342,
           'recall50': 0.13664186},
     '4': {'avg_iou': 0.7770761,
           'avg_obj': 0.41029674,
           'box_loss': 0.18508169,
           'class_loss': 2.4953277,
           'conf_loss': 6.8645024,
           'precision50': 0.36116284,
           'recall50': 0.33870894},
     '5': {'avg_iou': 0.81291544,
           'avg_obj': 0.53767616,
           'box_loss': 0.10011167,
           'class_loss': 1.5928541,
           'conf_loss': 3.5186765,
           'precision50': 0.4561226,
           'recall50': 0.5509764},
     'global': {'total_loss': 24.671534},
     'learning_rate': 0.00261,
     'training_loss': 24.671534}
train | step:  120000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.6962353,
           'avg_obj': 0.25256976,
           'box_loss': 0.21364129,
           'class_loss': 2.4858558,
           'conf_loss': 7.181435,
           'precision50': 0.23635986,
           'recall50': 0.13829145},
     '4': {'avg_iou': 0.77818316,
           'avg_obj': 0.4137883,
           'box_loss': 0.1842944,
           'class_loss': 2.4628813,
           'conf_loss': 6.8329773,
           'precision50': 0.3625625,
           'recall50': 0.3417161},
     '5': {'avg_iou': 0.8141453,
           'avg_obj': 0.5408885,
           'box_loss': 0.09965213,
           'class_loss': 1.57408,
           'conf_loss': 3.5010598,
           'precision50': 0.4550662,
           'recall50': 0.5530019},
     'global': {'total_loss': 24.535856},
     'learning_rate': 0.00261,
     'training_loss': 24.535856}
train | step:  125000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.6970111,
           'avg_obj': 0.254107,
           'box_loss': 0.21283762,
           'class_loss': 2.45626,
           'conf_loss': 7.15434,
           'precision50': 0.23778081,
           'recall50': 0.14000167},
     '4': {'avg_iou': 0.7791331,
           'avg_obj': 0.41578546,
           'box_loss': 0.1835417,
           'class_loss': 2.4353938,
           'conf_loss': 6.808957,
           'precision50': 0.36357912,
           'recall50': 0.34420198},
     '5': {'avg_iou': 0.81493556,
           'avg_obj': 0.54279935,
           'box_loss': 0.09921028,
           'class_loss': 1.5600145,
           'conf_loss': 3.48593,
           'precision50': 0.45639366,
           'recall50': 0.5559049},
     'global': {'total_loss': 24.396496},
     'learning_rate': 0.00261,
     'training_loss': 24.396496}
saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/ckpt-125000.
 eval | step:  125000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=178.58s).
Accumulating evaluation results...
DONE (t=17.42s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.368
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.595
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.399
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.146
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.337
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.475
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.304
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.507
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.554
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.322
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.544
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.649
 eval | step:  125000 | eval time:  530.4 sec | output: 
    {'3': {'avg_iou': 0.45909145,
           'avg_obj': 0.17720135,
           'box_loss': 0.14968058,
           'class_loss': 1.4527184,
           'conf_loss': 5.736896,
           'precision50': 0.22241424,
           'recall50': 0.16271321},
     '4': {'avg_iou': 0.6694548,
           'avg_obj': 0.38419202,
           'box_loss': 0.15899163,
           'class_loss': 1.7097089,
           'conf_loss': 6.1636696,
           'precision50': 0.34984994,
           'recall50': 0.3824448},
     '5': {'avg_iou': 0.7973209,
           'avg_obj': 0.602844,
           'box_loss': 0.09752715,
           'class_loss': 1.1261393,
           'conf_loss': 3.3754637,
           'precision50': 0.43440822,
           'recall50': 0.6180564},
     'AP': 0.36834204,
     'AP50': 0.5945174,
     'AP75': 0.39934677,
     'APl': 0.47509146,
     'APm': 0.3368938,
     'APs': 0.1462432,
     'ARl': 0.6493947,
     'ARm': 0.5442285,
     'ARmax1': 0.3039918,
     'ARmax10': 0.5071677,
     'ARmax100': 0.5535326,
     'ARs': 0.32155433,
     'global': {'total_loss': 19.970798},
     'validation_loss': 19.970798}
train | step:  125000 | training until step 145000...
train | step:  130000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6980789,
           'avg_obj': 0.2564559,
           'box_loss': 0.21177807,
           'class_loss': 2.4251008,
           'conf_loss': 7.1257052,
           'precision50': 0.23758677,
           'recall50': 0.1413573},
     '4': {'avg_iou': 0.7801974,
           'avg_obj': 0.41912085,
           'box_loss': 0.18262267,
           'class_loss': 2.4019845,
           'conf_loss': 6.767134,
           'precision50': 0.36350533,
           'recall50': 0.34769174},
     '5': {'avg_iou': 0.81576985,
           'avg_obj': 0.546051,
           'box_loss': 0.09866887,
           'class_loss': 1.5353053,
           'conf_loss': 3.4582362,
           'precision50': 0.45623365,
           'recall50': 0.5589652},
     'global': {'total_loss': 24.20654},
     'learning_rate': 0.00261,
     'training_loss': 24.20654}
train | step:  135000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.6987753,
           'avg_obj': 0.2580533,
           'box_loss': 0.21219862,
           'class_loss': 2.4096155,
           'conf_loss': 7.1412735,
           'precision50': 0.24031334,
           'recall50': 0.14351064},
     '4': {'avg_iou': 0.78087366,
           'avg_obj': 0.42153364,
           'box_loss': 0.18278919,
           'class_loss': 2.3807242,
           'conf_loss': 6.763645,
           'precision50': 0.36516905,
           'recall50': 0.35152668},
     '5': {'avg_iou': 0.81663007,
           'avg_obj': 0.5488018,
           'box_loss': 0.09841545,
           'class_loss': 1.5224358,
           'conf_loss': 3.4448707,
           'precision50': 0.45655942,
           'recall50': 0.56171775},
     'global': {'total_loss': 24.155987},
     'learning_rate': 0.00261,
     'training_loss': 24.155987}
train | step:  140000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.69918334,
           'avg_obj': 0.25952724,
           'box_loss': 0.2109031,
           'class_loss': 2.3792055,
           'conf_loss': 7.0896173,
           'precision50': 0.23978603,
           'recall50': 0.14390135},
     '4': {'avg_iou': 0.78181785,
           'avg_obj': 0.4237195,
           'box_loss': 0.1811119,
           'class_loss': 2.3539948,
           'conf_loss': 6.7103024,
           'precision50': 0.3627761,
           'recall50': 0.35230607},
     '5': {'avg_iou': 0.8173198,
           'avg_obj': 0.55161536,
           'box_loss': 0.097879246,
           'class_loss': 1.5071102,
           'conf_loss': 3.41756,
           'precision50': 0.45541328,
           'recall50': 0.56382453},
     'global': {'total_loss': 23.9477},
     'learning_rate': 0.00261,
     'training_loss': 23.9477}
train | step:  145000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.69990075,
           'avg_obj': 0.26115534,
           'box_loss': 0.21032739,
           'class_loss': 2.3551695,
           'conf_loss': 7.072204,
           'precision50': 0.24089769,
           'recall50': 0.14520866},
     '4': {'avg_iou': 0.7824445,
           'avg_obj': 0.42601025,
           'box_loss': 0.1805524,
           'class_loss': 2.318857,
           'conf_loss': 6.680047,
           'precision50': 0.36387706,
           'recall50': 0.35412604},
     '5': {'avg_iou': 0.8184416,
           'avg_obj': 0.5544771,
           'box_loss': 0.09732727,
           'class_loss': 1.4801672,
           'conf_loss': 3.3958774,
           'precision50': 0.45667744,
           'recall50': 0.5678704},
     'global': {'total_loss': 23.790533},
     'learning_rate': 0.00261,
     'training_loss': 23.790533}I0414 16:58:43.666705 140130872387392 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/ckpt-145000.
I0414 16:58:43.672594 140130872387392 controller.py:252]  eval | step:  145000 | running 625 steps of evaluation...
I0414 17:03:07.691357 140130872387392 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0414 17:07:19.662190 140130872387392 controller.py:261]  eval | step:  145000 | eval time:  516.0 sec | output: 
    {'3': {'avg_iou': 0.46014404,
           'avg_obj': 0.17996429,
           'box_loss': 0.14896403,
           'class_loss': 1.4281392,
           'conf_loss': 5.698231,
           'precision50': 0.22251047,
           'recall50': 0.164001},
     '4': {'avg_iou': 0.6707569,
           'avg_obj': 0.390251,
           'box_loss': 0.15756686,
           'class_loss': 1.6803532,
           'conf_loss': 6.114559,
           'precision50': 0.35048035,
           'recall50': 0.38879287},
     '5': {'avg_iou': 0.7995336,
           'avg_obj': 0.6107397,
           'box_loss': 0.09634852,
           'class_loss': 1.1037184,
           'conf_loss': 3.3470554,
           'precision50': 0.43113834,
           'recall50': 0.6243667},
     'AP': 0.3736191,
     'AP50': 0.6011225,
     'AP75': 0.40576422,
     'APl': 0.48092812,
     'APm': 0.34212613,
     'APs': 0.15165631,
     'ARl': 0.65430236,
     'ARm': 0.548698,
     'ARmax1': 0.30462143,
     'ARmax10': 0.51126766,
     'ARmax100': 0.5576241,
     'ARs': 0.31979108,
     'global': {'total_loss': 19.77493},
     'validation_loss': 19.77493}
I0414 17:07:36.219868 140130872387392 controller.py:211] train | step:  145000 | training until step 165000...
I0414 17:47:53.163058 140130872387392 controller.py:425] train | step:  150000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.70055544,
           'avg_obj': 0.262984,
           'box_loss': 0.21053924,
           'class_loss': 2.3379226,
           'conf_loss': 7.0741615,
           'precision50': 0.24075659,
           'recall50': 0.14631465},
     '4': {'avg_iou': 0.78331476,
           'avg_obj': 0.42866024,
           'box_loss': 0.1802785,
           'class_loss': 2.3033218,
           'conf_loss': 6.6701155,
           'precision50': 0.3645944,
           'recall50': 0.35636425},
     '5': {'avg_iou': 0.81895185,
           'avg_obj': 0.55641824,
           'box_loss': 0.097013466,
           'class_loss': 1.4686359,
           'conf_loss': 3.381522,
           'precision50': 0.45633656,
           'recall50': 0.5698767},
     'global': {'total_loss': 23.723467},
     'learning_rate': 0.00261,
     'training_loss': 23.723467}
I0414 18:28:10.130455 140130872387392 controller.py:425] train | step:  155000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.70126975,
           'avg_obj': 0.26386574,
           'box_loss': 0.2094315,
           'class_loss': 2.314581,
           'conf_loss': 7.043704,
           'precision50': 0.2420112,
           'recall50': 0.1468974},
     '4': {'avg_iou': 0.78410286,
           'avg_obj': 0.43133032,
           'box_loss': 0.17910019,
           'class_loss': 2.2730749,
           'conf_loss': 6.6183796,
           'precision50': 0.36491922,
           'recall50': 0.35956573},
     '5': {'avg_iou': 0.8197629,
           'avg_obj': 0.5592295,
           'box_loss': 0.096516356,
           'class_loss': 1.452817,
           'conf_loss': 3.3601024,
           'precision50': 0.45594808,
           'recall50': 0.5728074},
     'global': {'total_loss': 23.54769},
     'learning_rate': 0.00261,
     'training_loss': 23.54769}
I0414 19:08:28.545922 140130872387392 controller.py:425] train | step:  160000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.70187926,
           'avg_obj': 0.26681876,
           'box_loss': 0.20949839,
           'class_loss': 2.299119,
           'conf_loss': 7.0395913,
           'precision50': 0.24368657,
           'recall50': 0.1496128},
     '4': {'avg_iou': 0.78503525,
           'avg_obj': 0.43314683,
           'box_loss': 0.17920499,
           'class_loss': 2.255824,
           'conf_loss': 6.623332,
           'precision50': 0.36419708,
           'recall50': 0.3605743},
     '5': {'avg_iou': 0.82056445,
           'avg_obj': 0.56050247,
           'box_loss': 0.09634334,
           'class_loss': 1.442545,
           'conf_loss': 3.3562686,
           'precision50': 0.45599702,
           'recall50': 0.57350856},
     'global': {'total_loss': 23.501785},
     'learning_rate': 0.00261,
     'training_loss': 23.501785}
I0414 19:48:57.897691 140130872387392 controller.py:425] train | step:  165000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.70226705,
           'avg_obj': 0.26790375,
           'box_loss': 0.20888759,
           'class_loss': 2.283571,
           'conf_loss': 7.0166245,
           'precision50': 0.2419177,
           'recall50': 0.14896296},
     '4': {'avg_iou': 0.785579,
           'avg_obj': 0.4349559,
           'box_loss': 0.17822197,
           'class_loss': 2.2284634,
           'conf_loss': 6.5857525,
           'precision50': 0.36465338,
           'recall50': 0.36288938},
     '5': {'avg_iou': 0.8213053,
           'avg_obj': 0.5635167,
           'box_loss': 0.09586873,
           'class_loss': 1.4216803,
           'conf_loss': 3.3333008,
           'precision50': 0.45556518,
           'recall50': 0.57613987},
     'global': {'total_loss': 23.352371},
     'learning_rate': 0.00261,
     'training_loss': 23.352371}
I0414 19:49:48.529181 140130872387392 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/ckpt-165000.
I0414 19:49:48.535297 140130872387392 controller.py:252]  eval | step:  165000 | running 625 steps of evaluation...
I0414 19:54:12.624028 140130872387392 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0414 19:58:27.346291 140130872387392 controller.py:261]  eval | step:  165000 | eval time:  518.8 sec | output: 
    {'3': {'avg_iou': 0.46132037,
           'avg_obj': 0.18187329,
           'box_loss': 0.14800678,
           'class_loss': 1.4103307,
           'conf_loss': 5.6937757,
           'precision50': 0.22168325,
           'recall50': 0.16578247},
     '4': {'avg_iou': 0.6718938,
           'avg_obj': 0.39306077,
           'box_loss': 0.15645485,
           'class_loss': 1.6584926,
           'conf_loss': 6.106249,
           'precision50': 0.34739876,
           'recall50': 0.3901649},
     '5': {'avg_iou': 0.80159813,
           'avg_obj': 0.61464393,
           'box_loss': 0.09520222,
           'class_loss': 1.0791337,
           'conf_loss': 3.3331609,
           'precision50': 0.42913675,
           'recall50': 0.6273293},
     'AP': 0.3784275,
     'AP50': 0.6042729,
     'AP75': 0.41233036,
     'APl': 0.48828965,
     'APm': 0.346227,
     'APs': 0.1573721,
     'ARl': 0.66048,
     'ARm': 0.5531983,
     'ARmax1': 0.3079298,
     'ARmax10': 0.5147847,
     'ARmax100': 0.56157357,
     'ARs': 0.32647955,
     'global': {'total_loss': 19.680813},
     'validation_loss': 19.680813}

saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/ckpt-145000.
 eval | step:  145000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=178.16s).
Accumulating evaluation results...
DONE (t=13.95s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.374
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.601
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.406
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.152
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.342
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.481
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.305
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.511
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.558
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.320
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.549
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.654
 eval | step:  145000 | eval time:  516.0 sec | output: 
    {'3': {'avg_iou': 0.46014404,
           'avg_obj': 0.17996429,
           'box_loss': 0.14896403,
           'class_loss': 1.4281392,
           'conf_loss': 5.698231,
           'precision50': 0.22251047,
           'recall50': 0.164001},
     '4': {'avg_iou': 0.6707569,
           'avg_obj': 0.390251,
           'box_loss': 0.15756686,
           'class_loss': 1.6803532,
           'conf_loss': 6.114559,
           'precision50': 0.35048035,
           'recall50': 0.38879287},
     '5': {'avg_iou': 0.7995336,
           'avg_obj': 0.6107397,
           'box_loss': 0.09634852,
           'class_loss': 1.1037184,
           'conf_loss': 3.3470554,
           'precision50': 0.43113834,
           'recall50': 0.6243667},
     'AP': 0.3736191,
     'AP50': 0.6011225,
     'AP75': 0.40576422,
     'APl': 0.48092812,
     'APm': 0.34212613,
     'APs': 0.15165631,
     'ARl': 0.65430236,
     'ARm': 0.548698,
     'ARmax1': 0.30462143,
     'ARmax10': 0.51126766,
     'ARmax100': 0.5576241,
     'ARs': 0.31979108,
     'global': {'total_loss': 19.77493},
     'validation_loss': 19.77493}
train | step:  145000 | training until step 165000...
train | step:  150000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.70055544,
           'avg_obj': 0.262984,
           'box_loss': 0.21053924,
           'class_loss': 2.3379226,
           'conf_loss': 7.0741615,
           'precision50': 0.24075659,
           'recall50': 0.14631465},
     '4': {'avg_iou': 0.78331476,
           'avg_obj': 0.42866024,
           'box_loss': 0.1802785,
           'class_loss': 2.3033218,
           'conf_loss': 6.6701155,
           'precision50': 0.3645944,
           'recall50': 0.35636425},
     '5': {'avg_iou': 0.81895185,
           'avg_obj': 0.55641824,
           'box_loss': 0.097013466,
           'class_loss': 1.4686359,
           'conf_loss': 3.381522,
           'precision50': 0.45633656,
           'recall50': 0.5698767},
     'global': {'total_loss': 23.723467},
     'learning_rate': 0.00261,
     'training_loss': 23.723467}
train | step:  155000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.70126975,
           'avg_obj': 0.26386574,
           'box_loss': 0.2094315,
           'class_loss': 2.314581,
           'conf_loss': 7.043704,
           'precision50': 0.2420112,
           'recall50': 0.1468974},
     '4': {'avg_iou': 0.78410286,
           'avg_obj': 0.43133032,
           'box_loss': 0.17910019,
           'class_loss': 2.2730749,
           'conf_loss': 6.6183796,
           'precision50': 0.36491922,
           'recall50': 0.35956573},
     '5': {'avg_iou': 0.8197629,
           'avg_obj': 0.5592295,
           'box_loss': 0.096516356,
           'class_loss': 1.452817,
           'conf_loss': 3.3601024,
           'precision50': 0.45594808,
           'recall50': 0.5728074},
     'global': {'total_loss': 23.54769},
     'learning_rate': 0.00261,
     'training_loss': 23.54769}
train | step:  160000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.70187926,
           'avg_obj': 0.26681876,
           'box_loss': 0.20949839,
           'class_loss': 2.299119,
           'conf_loss': 7.0395913,
           'precision50': 0.24368657,
           'recall50': 0.1496128},
     '4': {'avg_iou': 0.78503525,
           'avg_obj': 0.43314683,
           'box_loss': 0.17920499,
           'class_loss': 2.255824,
           'conf_loss': 6.623332,
           'precision50': 0.36419708,
           'recall50': 0.3605743},
     '5': {'avg_iou': 0.82056445,
           'avg_obj': 0.56050247,
           'box_loss': 0.09634334,
           'class_loss': 1.442545,
           'conf_loss': 3.3562686,
           'precision50': 0.45599702,
           'recall50': 0.57350856},
     'global': {'total_loss': 23.501785},
     'learning_rate': 0.00261,
     'training_loss': 23.501785}
train | step:  165000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.70226705,
           'avg_obj': 0.26790375,
           'box_loss': 0.20888759,
           'class_loss': 2.283571,
           'conf_loss': 7.0166245,
           'precision50': 0.2419177,
           'recall50': 0.14896296},
     '4': {'avg_iou': 0.785579,
           'avg_obj': 0.4349559,
           'box_loss': 0.17822197,
           'class_loss': 2.2284634,
           'conf_loss': 6.5857525,
           'precision50': 0.36465338,
           'recall50': 0.36288938},
     '5': {'avg_iou': 0.8213053,
           'avg_obj': 0.5635167,
           'box_loss': 0.09586873,
           'class_loss': 1.4216803,
           'conf_loss': 3.3333008,
           'precision50': 0.45556518,
           'recall50': 0.57613987},
     'global': {'total_loss': 23.352371},
     'learning_rate': 0.00261,
     'training_loss': 23.352371}
saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/ckpt-165000.
 eval | step:  165000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=183.04s).
Accumulating evaluation results...
DONE (t=13.98s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.378
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.604
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.412
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.157
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.346
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.488
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.308
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.515
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.562
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.326
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.553
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.660
 eval | step:  165000 | eval time:  518.8 sec | output: 
    {'3': {'avg_iou': 0.46132037,
           'avg_obj': 0.18187329,
           'box_loss': 0.14800678,
           'class_loss': 1.4103307,
           'conf_loss': 5.6937757,
           'precision50': 0.22168325,
           'recall50': 0.16578247},
     '4': {'avg_iou': 0.6718938,
           'avg_obj': 0.39306077,
           'box_loss': 0.15645485,
           'class_loss': 1.6584926,
           'conf_loss': 6.106249,
           'precision50': 0.34739876,
           'recall50': 0.3901649},
     '5': {'avg_iou': 0.80159813,
           'avg_obj': 0.61464393,
           'box_loss': 0.09520222,
           'class_loss': 1.0791337,
           'conf_loss': 3.3331609,
           'precision50': 0.42913675,
           'recall50': 0.6273293},
     'AP': 0.3784275,
     'AP50': 0.6042729,
     'AP75': 0.41233036,
     'APl': 0.48828965,
     'APm': 0.346227,
     'APs': 0.1573721,
     'ARl': 0.66048,
     'ARm': 0.5531983,
     'ARmax1': 0.3079298,
     'ARmax10': 0.5147847,
     'ARmax100': 0.56157357,
     'ARs': 0.32647955,
     'global': {'total_loss': 19.680813},
     'validation_loss': 19.680813}I0414 19:58:44.120519 140130872387392 controller.py:211] train | step:  165000 | training until step 185000...
I0414 20:39:06.146781 140130872387392 controller.py:425] train | step:  170000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.702455,
           'avg_obj': 0.26892436,
           'box_loss': 0.20980701,
           'class_loss': 2.2815669,
           'conf_loss': 7.0385756,
           'precision50': 0.24414729,
           'recall50': 0.15088913},
     '4': {'avg_iou': 0.7862491,
           'avg_obj': 0.43682083,
           'box_loss': 0.17821297,
           'class_loss': 2.2197354,
           'conf_loss': 6.5838966,
           'precision50': 0.36605114,
           'recall50': 0.36568955},
     '5': {'avg_iou': 0.82159084,
           'avg_obj': 0.56537557,
           'box_loss': 0.09568106,
           'class_loss': 1.409273,
           'conf_loss': 3.3162103,
           'precision50': 0.4547501,
           'recall50': 0.5782863},
     'global': {'total_loss': 23.332949},
     'learning_rate': 0.00261,
     'training_loss': 23.332949}
I0414 21:19:32.991333 140130872387392 controller.py:425] train | step:  175000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.703717,
           'avg_obj': 0.27184582,
           'box_loss': 0.2077311,
           'class_loss': 2.2447715,
           'conf_loss': 6.9691744,
           'precision50': 0.24567632,
           'recall50': 0.15337531},
     '4': {'avg_iou': 0.7871582,
           'avg_obj': 0.44026372,
           'box_loss': 0.17678994,
           'class_loss': 2.1863165,
           'conf_loss': 6.519983,
           'precision50': 0.36644349,
           'recall50': 0.3685596},
     '5': {'avg_iou': 0.8226834,
           'avg_obj': 0.5681746,
           'box_loss': 0.09500816,
           'class_loss': 1.3973207,
           'conf_loss': 3.2918608,
           'precision50': 0.45566928,
           'recall50': 0.58164024},
     'global': {'total_loss': 23.088957},
     'learning_rate': 0.00261,
     'training_loss': 23.088957}
I0414 22:00:06.818846 140130872387392 controller.py:425] train | step:  180000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.70406353,
           'avg_obj': 0.2721358,
           'box_loss': 0.20774864,
           'class_loss': 2.2218819,
           'conf_loss': 6.9792624,
           'precision50': 0.24485232,
           'recall50': 0.15306845},
     '4': {'avg_iou': 0.7874787,
           'avg_obj': 0.44188818,
           'box_loss': 0.17686234,
           'class_loss': 2.170146,
           'conf_loss': 6.513079,
           'precision50': 0.36664203,
           'recall50': 0.36911538},
     '5': {'avg_iou': 0.8229836,
           'avg_obj': 0.57041866,
           'box_loss': 0.09483866,
           'class_loss': 1.3844401,
           'conf_loss': 3.274459,
           'precision50': 0.45555472,
           'recall50': 0.5838324},
     'global': {'total_loss': 23.022703},
     'learning_rate': 0.00261,
     'training_loss': 23.022703}
I0414 22:40:28.513710 140130872387392 controller.py:425] train | step:  185000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.7044002,
           'avg_obj': 0.2735371,
           'box_loss': 0.20748803,
           'class_loss': 2.2096584,
           'conf_loss': 6.95825,
           'precision50': 0.2462853,
           'recall50': 0.15419959},
     '4': {'avg_iou': 0.7880966,
           'avg_obj': 0.4434664,
           'box_loss': 0.17606238,
           'class_loss': 2.147953,
           'conf_loss': 6.482259,
           'precision50': 0.36696568,
           'recall50': 0.3713732},
     '5': {'avg_iou': 0.8239131,
           'avg_obj': 0.57220316,
           'box_loss': 0.09440976,
           'class_loss': 1.3708504,
           'conf_loss': 3.2627091,
           'precision50': 0.45680556,
           'recall50': 0.58607936},
     'global': {'total_loss': 22.90966},
     'learning_rate': 0.00261,
     'training_loss': 22.90966}
I0414 22:41:18.920430 140130872387392 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/ckpt-185000.
I0414 22:41:18.926845 140130872387392 controller.py:252]  eval | step:  185000 | running 625 steps of evaluation...
I0414 22:45:41.015594 140130872387392 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0414 22:49:52.737559 140130872387392 controller.py:261]  eval | step:  185000 | eval time:  513.8 sec | output: 
    {'3': {'avg_iou': 0.46199986,
           'avg_obj': 0.18372662,
           'box_loss': 0.14732628,
           'class_loss': 1.3834025,
           'conf_loss': 5.678651,
           'precision50': 0.22188497,
           'recall50': 0.1690776},
     '4': {'avg_iou': 0.67356575,
           'avg_obj': 0.39706743,
           'box_loss': 0.15523636,
           'class_loss': 1.6533713,
           'conf_loss': 6.0941906,
           'precision50': 0.34402102,
           'recall50': 0.3947465},
     '5': {'avg_iou': 0.8027028,
           'avg_obj': 0.6189932,
           'box_loss': 0.09465805,
           'class_loss': 1.0675436,
           'conf_loss': 3.3226314,
           'precision50': 0.42841646,
           'recall50': 0.63269895},
     'AP': 0.3804305,
     'AP50': 0.6058711,
     'AP75': 0.41306236,
     'APl': 0.4902545,
     'APm': 0.34795165,
     'APs': 0.15777493,
     'ARl': 0.66091627,
     'ARm': 0.5539894,
     'ARmax1': 0.30906925,
     'ARmax10': 0.5172693,
     'ARmax100': 0.56429017,
     'ARs': 0.33018342,
     'global': {'total_loss': 19.597002},
     'validation_loss': 19.597002}
I0414 22:50:09.426799 140130872387392 controller.py:211] train | step:  185000 | training until step 205000...
I0414 23:30:20.721914 140130872387392 controller.py:425] train | step:  190000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.7052437,
           'avg_obj': 0.2750531,
           'box_loss': 0.20630181,
           'class_loss': 2.1789157,
           'conf_loss': 6.9254,
           'precision50': 0.24595056,
           'recall50': 0.15580477},
     '4': {'avg_iou': 0.78870267,
           'avg_obj': 0.44573194,
           'box_loss': 0.17566168,
           'class_loss': 2.1309168,
           'conf_loss': 6.456898,
           'precision50': 0.3662222,
           'recall50': 0.37387496},
     '5': {'avg_iou': 0.8243006,
           'avg_obj': 0.5747304,
           'box_loss': 0.09422702,
           'class_loss': 1.3603988,
           'conf_loss': 3.2442544,
           'precision50': 0.45584273,
           'recall50': 0.58815134},
     'global': {'total_loss': 22.773037},
     'learning_rate': 0.00261,
     'training_loss': 22.773037}
I0415 00:44:14.243907 140130872387392 controller.py:425] train | step:  195000 | steps/sec:    1.1 | output: 
    {'3': {'avg_iou': 0.70553654,
           'avg_obj': 0.27630082,
           'box_loss': 0.20702322,
           'class_loss': 2.1745865,
           'conf_loss': 6.941272,
           'precision50': 0.24655546,
           'recall50': 0.15667208},
     '4': {'avg_iou': 0.78934383,
           'avg_obj': 0.4472757,
           'box_loss': 0.1751165,
           'class_loss': 2.118508,
           'conf_loss': 6.446037,
           'precision50': 0.36741573,
           'recall50': 0.37511715},
     '5': {'avg_iou': 0.8246375,
           'avg_obj': 0.5768092,
           'box_loss': 0.09409328,
           'class_loss': 1.3516935,
           'conf_loss': 3.2313886,
           'precision50': 0.45621783,
           'recall50': 0.5902198},
     'global': {'total_loss': 22.73972},
     'learning_rate': 0.00261,
     'training_loss': 22.73972}
I0415 01:24:51.728746 140130872387392 controller.py:425] train | step:  200000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.7061626,
           'avg_obj': 0.2784136,
           'box_loss': 0.20646901,
           'class_loss': 2.1614814,
           'conf_loss': 6.918939,
           'precision50': 0.24648818,
           'recall50': 0.15720989},
     '4': {'avg_iou': 0.78992444,
           'avg_obj': 0.4500867,
           'box_loss': 0.1748451,
           'class_loss': 2.0970337,
           'conf_loss': 6.4163103,
           'precision50': 0.36686328,
           'recall50': 0.37770277},
     '5': {'avg_iou': 0.8252871,
           'avg_obj': 0.5783108,
           'box_loss': 0.09363366,
           'class_loss': 1.3375741,
           'conf_loss': 3.2160358,
           'precision50': 0.4557602,
           'recall50': 0.5917085},
     'global': {'total_loss': 22.622313},
     'learning_rate': 0.00261,
     'training_loss': 22.622313}

train | step:  165000 | training until step 185000...
train | step:  170000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.702455,
           'avg_obj': 0.26892436,
           'box_loss': 0.20980701,
           'class_loss': 2.2815669,
           'conf_loss': 7.0385756,
           'precision50': 0.24414729,
           'recall50': 0.15088913},
     '4': {'avg_iou': 0.7862491,
           'avg_obj': 0.43682083,
           'box_loss': 0.17821297,
           'class_loss': 2.2197354,
           'conf_loss': 6.5838966,
           'precision50': 0.36605114,
           'recall50': 0.36568955},
     '5': {'avg_iou': 0.82159084,
           'avg_obj': 0.56537557,
           'box_loss': 0.09568106,
           'class_loss': 1.409273,
           'conf_loss': 3.3162103,
           'precision50': 0.4547501,
           'recall50': 0.5782863},
     'global': {'total_loss': 23.332949},
     'learning_rate': 0.00261,
     'training_loss': 23.332949}
train | step:  175000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.703717,
           'avg_obj': 0.27184582,
           'box_loss': 0.2077311,
           'class_loss': 2.2447715,
           'conf_loss': 6.9691744,
           'precision50': 0.24567632,
           'recall50': 0.15337531},
     '4': {'avg_iou': 0.7871582,
           'avg_obj': 0.44026372,
           'box_loss': 0.17678994,
           'class_loss': 2.1863165,
           'conf_loss': 6.519983,
           'precision50': 0.36644349,
           'recall50': 0.3685596},
     '5': {'avg_iou': 0.8226834,
           'avg_obj': 0.5681746,
           'box_loss': 0.09500816,
           'class_loss': 1.3973207,
           'conf_loss': 3.2918608,
           'precision50': 0.45566928,
           'recall50': 0.58164024},
     'global': {'total_loss': 23.088957},
     'learning_rate': 0.00261,
     'training_loss': 23.088957}
train | step:  180000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.70406353,
           'avg_obj': 0.2721358,
           'box_loss': 0.20774864,
           'class_loss': 2.2218819,
           'conf_loss': 6.9792624,
           'precision50': 0.24485232,
           'recall50': 0.15306845},
     '4': {'avg_iou': 0.7874787,
           'avg_obj': 0.44188818,
           'box_loss': 0.17686234,
           'class_loss': 2.170146,
           'conf_loss': 6.513079,
           'precision50': 0.36664203,
           'recall50': 0.36911538},
     '5': {'avg_iou': 0.8229836,
           'avg_obj': 0.57041866,
           'box_loss': 0.09483866,
           'class_loss': 1.3844401,
           'conf_loss': 3.274459,
           'precision50': 0.45555472,
           'recall50': 0.5838324},
     'global': {'total_loss': 23.022703},
     'learning_rate': 0.00261,
     'training_loss': 23.022703}
train | step:  185000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.7044002,
           'avg_obj': 0.2735371,
           'box_loss': 0.20748803,
           'class_loss': 2.2096584,
           'conf_loss': 6.95825,
           'precision50': 0.2462853,
           'recall50': 0.15419959},
     '4': {'avg_iou': 0.7880966,
           'avg_obj': 0.4434664,
           'box_loss': 0.17606238,
           'class_loss': 2.147953,
           'conf_loss': 6.482259,
           'precision50': 0.36696568,
           'recall50': 0.3713732},
     '5': {'avg_iou': 0.8239131,
           'avg_obj': 0.57220316,
           'box_loss': 0.09440976,
           'class_loss': 1.3708504,
           'conf_loss': 3.2627091,
           'precision50': 0.45680556,
           'recall50': 0.58607936},
     'global': {'total_loss': 22.90966},
     'learning_rate': 0.00261,
     'training_loss': 22.90966}
saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/ckpt-185000.
 eval | step:  185000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=174.83s).
Accumulating evaluation results...
DONE (t=13.54s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.380
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.606
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.413
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.158
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.348
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.490
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.309
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.517
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.564
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.330
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.554
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.661
 eval | step:  185000 | eval time:  513.8 sec | output: 
    {'3': {'avg_iou': 0.46199986,
           'avg_obj': 0.18372662,
           'box_loss': 0.14732628,
           'class_loss': 1.3834025,
           'conf_loss': 5.678651,
           'precision50': 0.22188497,
           'recall50': 0.1690776},
     '4': {'avg_iou': 0.67356575,
           'avg_obj': 0.39706743,
           'box_loss': 0.15523636,
           'class_loss': 1.6533713,
           'conf_loss': 6.0941906,
           'precision50': 0.34402102,
           'recall50': 0.3947465},
     '5': {'avg_iou': 0.8027028,
           'avg_obj': 0.6189932,
           'box_loss': 0.09465805,
           'class_loss': 1.0675436,
           'conf_loss': 3.3226314,
           'precision50': 0.42841646,
           'recall50': 0.63269895},
     'AP': 0.3804305,
     'AP50': 0.6058711,
     'AP75': 0.41306236,
     'APl': 0.4902545,
     'APm': 0.34795165,
     'APs': 0.15777493,
     'ARl': 0.66091627,
     'ARm': 0.5539894,
     'ARmax1': 0.30906925,
     'ARmax10': 0.5172693,
     'ARmax100': 0.56429017,
     'ARs': 0.33018342,
     'global': {'total_loss': 19.597002},
     'validation_loss': 19.597002}
train | step:  185000 | training until step 205000...
train | step:  190000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.7052437,
           'avg_obj': 0.2750531,
           'box_loss': 0.20630181,
           'class_loss': 2.1789157,
           'conf_loss': 6.9254,
           'precision50': 0.24595056,
           'recall50': 0.15580477},
     '4': {'avg_iou': 0.78870267,
           'avg_obj': 0.44573194,
           'box_loss': 0.17566168,
           'class_loss': 2.1309168,
           'conf_loss': 6.456898,
           'precision50': 0.3662222,
           'recall50': 0.37387496},
     '5': {'avg_iou': 0.8243006,
           'avg_obj': 0.5747304,
           'box_loss': 0.09422702,
           'class_loss': 1.3603988,
           'conf_loss': 3.2442544,
           'precision50': 0.45584273,
           'recall50': 0.58815134},
     'global': {'total_loss': 22.773037},
     'learning_rate': 0.00261,
     'training_loss': 22.773037}
train | step:  195000 | steps/sec:    1.1 | output: 
    {'3': {'avg_iou': 0.70553654,
           'avg_obj': 0.27630082,
           'box_loss': 0.20702322,
           'class_loss': 2.1745865,
           'conf_loss': 6.941272,
           'precision50': 0.24655546,
           'recall50': 0.15667208},
     '4': {'avg_iou': 0.78934383,
           'avg_obj': 0.4472757,
           'box_loss': 0.1751165,
           'class_loss': 2.118508,
           'conf_loss': 6.446037,
           'precision50': 0.36741573,
           'recall50': 0.37511715},
     '5': {'avg_iou': 0.8246375,
           'avg_obj': 0.5768092,
           'box_loss': 0.09409328,
           'class_loss': 1.3516935,
           'conf_loss': 3.2313886,
           'precision50': 0.45621783,
           'recall50': 0.5902198},
     'global': {'total_loss': 22.73972},
     'learning_rate': 0.00261,
     'training_loss': 22.73972}
train | step:  200000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.7061626,
           'avg_obj': 0.2784136,
           'box_loss': 0.20646901,
           'class_loss': 2.1614814,
           'conf_loss': 6.918939,
           'precision50': 0.24648818,
           'recall50': 0.15720989},
     '4': {'avg_iou': 0.78992444,
           'avg_obj': 0.4500867,
           'box_loss': 0.1748451,
           'class_loss': 2.0970337,
           'conf_loss': 6.4163103,
           'precision50': 0.36686328,
           'recall50': 0.37770277},
     '5': {'avg_iou': 0.8252871,
           'avg_obj': 0.5783108,
           'box_loss': 0.09363366,
           'class_loss': 1.3375741,
           'conf_loss': 3.2160358,
           'precision50': 0.4557602,
           'recall50': 0.5917085},
     'global': {'total_loss': 22.622313},
     'learning_rate': 0.00261,
     'training_loss': 22.622313}I0415 02:05:11.745930 140130872387392 controller.py:425] train | step:  205000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.7161111,
           'avg_obj': 0.29536498,
           'box_loss': 0.19947258,
           'class_loss': 1.9778466,
           'conf_loss': 6.741479,
           'precision50': 0.2528075,
           'recall50': 0.17121509},
     '4': {'avg_iou': 0.80024606,
           'avg_obj': 0.47295108,
           'box_loss': 0.16619718,
           'class_loss': 1.8855543,
           'conf_loss': 6.139816,
           'precision50': 0.36763996,
           'recall50': 0.39993235},
     '5': {'avg_iou': 0.8351794,
           'avg_obj': 0.60256594,
           'box_loss': 0.0883267,
           'class_loss': 1.1862037,
           'conf_loss': 3.0294561,
           'precision50': 0.4539666,
           'recall50': 0.61676294},
     'global': {'total_loss': 21.414322},
     'learning_rate': 0.000261,
     'training_loss': 21.414322}
I0415 02:06:01.661810 140130872387392 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-comp-darknet/ckpt-205000.
I0415 02:06:01.667414 140130872387392 controller.py:252]  eval | step:  205000 | running 625 steps of evaluation...
I0415 02:10:25.709351 140130872387392 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
/home/cam2tensorflow/.experiment_start.sh: line 22: 13498 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4-$5
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   214    0     0  100   214      0    597 --:--:-- --:--:-- --:--:--   597100   216    0     2  100   214      4    525 --:--:-- --:--:-- --:--:--   530
okRequest issued for: [node-4]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-15T02:14:03.176130553Z'
  endTime: '2021-04-15T02:15:01.551189506Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618452843163-5bff96acd6dd8-65b2c2e7-015d5f48
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.117.66.216/29
  createTime: '2021-03-13T04:41:22.291533178Z'
  health: HEALTHY
  ipAddress: 10.117.66.218
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-4
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.117.66.218
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618452843163-5bff96acd6dd8-65b2c2e7-015d5f48] to complete...
................................................................................................................................................................................................................................................................................................................................................................................................done.
