cat: .experiment_zone: No such file or directory
Request issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-11T19:17:16.281361456Z'
  endTime: '2021-04-11T19:17:51.536276022Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618168636266-5bfb73ec05909-eab4b828-09a67d90
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618168636266-5bfb73ec05909-eab4b828-09a67d90] to complete...
.............................................................................................................................................................................................done.
europe-west4-a
I0411 19:17:05.212757 139689465972544 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'mirrored',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': 'dynamic',
             'mixed_precision_dtype': 'float16',
             'num_cores_per_replica': 1,
             'num_gpus': 1,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.075,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.2,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 0.6,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.05,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.2,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.667,
                                                    'output_size': [640, 640],
                                                    'random_crop': True,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [200000,
                                                                                250000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00261,
                                                                            0.000261,
                                                                            2.61e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0411 19:17:05.213956 139689465972544 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_testing/all-mean-og/params.yaml
2021-04-11 19:17:06.697245: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
WARNING:tensorflow:Mixed precision compatibility check (mixed_float16): WARNING
The dtype policy mixed_float16 may run slowly because this machine does not have a GPU. Only Nvidia GPUs with compute capability of at least 7.0 run quickly with mixed_float16.
If you will use compatible GPU(s) not attached to this host, e.g. by running a multi-worker model, you can ignore this warning. This message will only be logged once
W0411 19:17:06.697501 139689465972544 device_compatibility_check.py:118] Mixed precision compatibility check (mixed_float16): WARNING
The dtype policy mixed_float16 may run slowly because this machine does not have a GPU. Only Nvidia GPUs with compute capability of at least 7.0 run quickly with mixed_float16.
If you will use compatible GPU(s) not attached to this host, e.g. by running a multi-worker model, you can ignore this warning. This message will only be logged once
WARNING:tensorflow:From /usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/mixed_precision/loss_scale.py:56: DynamicLossScale.__init__ (from tensorflow.python.training.experimental.loss_scale) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.keras.mixed_precision.LossScaleOptimizer instead. LossScaleOptimizer now has all the functionality of DynamicLossScale
W0411 19:17:06.697932 139689465972544 deprecation.py:339] From /usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/mixed_precision/loss_scale.py:56: DynamicLossScale.__init__ (from tensorflow.python.training.experimental.loss_scale) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.keras.mixed_precision.LossScaleOptimizer instead. LossScaleOptimizer now has all the functionality of DynamicLossScale
2021-04-11 19:17:06.700138: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
WARNING:tensorflow:Some requested devices in `tf.distribute.Strategy` are not visible to TensorFlow: /job:localhost/replica:0/task:0/device:GPU:0
W0411 19:17:06.716439 139689465972544 cross_device_ops.py:1318] Some requested devices in `tf.distribute.Strategy` are not visible to TensorFlow: /job:localhost/replica:0/task:0/device:GPU:0
INFO:tensorflow:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0',)
I0411 19:17:06.718241 139689465972544 mirrored_strategy.py:350] Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0',)
I0411 19:17:06.729249 139689465972544 train_utils.py:214] Running default trainer.
2021-04-11 19:17:06.737891: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.05, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.6, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.667, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [200000, 250000], 'values': [0.00261, 0.000261, 2.61e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'mirrored', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 1, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'float16', 'loss_scale': 'dynamic', 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05} 0.00025
{'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f0b98bfb9e8>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
conv1 512.0
conv2 1024.0
conv1 512.0
spp
conv1 512.0
conv2 1024.0
conv1 512.0
7
conv1 512.0
conv2 256.0
conv1 512.0
conv2 256.0
4








 ListWrapper([256, 512, 1024])
conv1 128
conv2 256
conv1 128
conv2 256
conv1 128
conv2 256
6
conv1 256
conv2 512
conv1 256
conv2 512
conv1 256
conv2 512
6
conv1 512
conv2 1024
conv1 512
conv2 1024
conv1 512
conv2 1024
6
detget {'3': 1.2, '4': 1.1, '5': 1.05}
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 80, 80, 256) 37319168  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 64,488,640
Trainable params: 64,422,336
Non-trainable params: 66,304
_________________________________________________________________WARNING:tensorflow:tf.keras.mixed_precision.experimental.LossScaleOptimizer is deprecated. Please use tf.keras.mixed_precision.LossScaleOptimizer instead. For example
  opt = tf.keras.mixed_precision.experimental.LossScaleOptimizer(opt)
W0411 19:17:15.835410 139689465972544 loss_scale_optimizer.py:1040] tf.keras.mixed_precision.experimental.LossScaleOptimizer is deprecated. Please use tf.keras.mixed_precision.LossScaleOptimizer instead. For example
  opt = tf.keras.mixed_precision.experimental.LossScaleOptimizer(opt)
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 149, in main
    model_dir=model_dir)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_lib.py", line 68, in run_experiment
    params, model_dir))
  File "/usr/local/lib/python3.7/dist-packages/gin/config.py", line 1069, in gin_wrapper
    utils.augment_exception_message_and_reraise(e, err_str)
  File "/usr/local/lib/python3.7/dist-packages/gin/utils.py", line 41, in augment_exception_message_and_reraise
    raise proxy.with_traceback(exception.__traceback__) from None
  File "/usr/local/lib/python3.7/dist-packages/gin/config.py", line 1046, in gin_wrapper
    return fn(*new_args, **new_kwargs)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_utils.py", line 217, in create_trainer
    params.runtime)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/base_task.py", line 83, in create_optimizer
    loss_scale=runtime_config.loss_scale)
  File "/home/cam2tensorflow/TensorFlowModels/official/modeling/performance.py", line 34, in configure_optimizer
    optimizer, loss_scale=loss_scale))
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/mixed_precision/loss_scale_optimizer.py", line 1043, in __init__
    super(LossScaleOptimizerV1, self).__init__(optimizer)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/mixed_precision/loss_scale_optimizer.py", line 559, in __init__
    'base_optimizer')
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/mixed_precision/loss_scale_optimizer.py", line 156, in _track_trackable
    return self._trackable._track_trackable(trackable, name, overwrite)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/training/tracking/base.py", line 899, in _track_trackable
    "dependency. Names must be unique (or overwrite=True).") % (name,))
ValueError: Called Trackable._track_trackable() with name='base_optimizer', but a Trackable with this name is already declared as a dependency. Names must be unique (or overwrite=True).
  In call to configurable 'create_trainer' (<function create_trainer at 0x7f0baae766a8>)

  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   212    0     2  100   210     12   1265 --:--:-- --:--:-- --:--:--  1277
okRequest issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-11T19:18:10.332457481Z'
  endTime: '2021-04-11T19:18:31.470377524Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618168690319-5bfb741f920f9-8b72c73e-959bce83
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618168690319-5bfb741f920f9-8b72c73e-959bce83] to complete...
.....................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-11T19:20:46.411374594Z'
  endTime: '2021-04-11T19:21:23.273181468Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618168846398-5bfb74b46b513-eca85a5c-cb146a4b
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618168846398-5bfb74b46b513-eca85a5c-cb146a4b] to complete...
..................................................................................................................................................................................................done.
europe-west4-a
I0411 19:20:35.034150 140669647185728 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.075,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.2,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 0.6,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.05,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.2,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.667,
                                                    'output_size': [640, 640],
                                                    'random_crop': True,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [200000,
                                                                                250000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00261,
                                                                            0.000261,
                                                                            2.61e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0411 19:20:35.036735 140669647185728 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_testing/all-mean-og/params.yaml
I0411 19:20:35.900337 140669647185728 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 19:20:36.043415 140669647185728 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0411 19:20:36.043690 140669647185728 transport.py:157] Attempting refresh to obtain initial access_token
I0411 19:20:36.099981 140669647185728 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 19:20:36.241854 140669647185728 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0411 19:20:36.242108 140669647185728 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-11 19:20:36.285246: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0411 19:20:36.285870 140669647185728 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 19:20:36.905906 140669647185728 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0411 19:20:36.906441 140669647185728 transport.py:157] Attempting refresh to obtain initial access_token
I0411 19:20:36.945855 140669647185728 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 19:20:37.563145 140669647185728 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0411 19:20:37.563422 140669647185728 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-11 19:20:37.629023: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-11 19:20:37.641329: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-11 19:20:37.641407: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:32606}
2021-04-11 19:21:14.728947: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-11 19:21:14.729119: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:32606}
2021-04-11 19:21:14.729865: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:32606
I0411 19:21:14.731076 140669647185728 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-6
I0411 19:21:14.731868 140669647185728 tpu_strategy_util.py:74] Initializing the TPU system: node-6
INFO:tensorflow:Clearing out eager caches
I0411 19:21:23.449496 140669647185728 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0411 19:21:23.451474 140669647185728 tpu_strategy_util.py:133] Finished initializing TPU system.
I0411 19:21:23.453295 140669647185728 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 19:21:24.072433 140669647185728 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0411 19:21:24.072695 140669647185728 transport.py:157] Attempting refresh to obtain initial access_token
I0411 19:21:24.132084 140669647185728 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 19:21:24.745536 140669647185728 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0411 19:21:24.745866 140669647185728 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0411 19:21:24.787088 140669647185728 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0411 19:21:24.787365 140669647185728 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0411 19:21:24.787801 140669647185728 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0411 19:21:24.787966 140669647185728 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0411 19:21:24.788079 140669647185728 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0411 19:21:24.788340 140669647185728 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0411 19:21:24.788458 140669647185728 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0411 19:21:24.788562 140669647185728 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0411 19:21:24.788689 140669647185728 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0411 19:21:24.788778 140669647185728 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0411 19:21:24.788869 140669647185728 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0411 19:21:24.788954 140669647185728 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0411 19:21:24.789037 140669647185728 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0411 19:21:24.789119 140669647185728 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0411 19:21:24.789202 140669647185728 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0411 19:21:24.789294 140669647185728 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0411 19:21:24.825069 140669647185728 train_utils.py:214] Running default trainer.
2021-04-11 19:21:24.833345: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.05, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.6, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.667, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [200000, 250000], 'values': [0.00261, 0.000261, 2.61e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05} 0.00025
{'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7fefd00d58d0>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
conv1 512.0
conv2 1024.0
conv1 512.0
spp
conv1 512.0
conv2 1024.0
conv1 512.0
7
conv1 512.0
conv2 256.0
conv1 512.0
conv2 256.0
4








 ListWrapper([256, 512, 1024])
conv1 128
conv2 256
conv1 128
conv2 256
conv1 128
conv2 256
6
conv1 256
conv2 512
conv1 256
conv2 512
conv1 256
conv2 512
6
conv1 512
conv2 1024
conv1 512
conv2 1024
conv1 512
conv2 1024
6
detget {'3': 1.2, '4': 1.1, '5': 1.05}
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 80, 80, 256) 37319168  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 64,488,640
Trainable params: 64,422,336
Non-trainable params: 66,304
_________________________________________________________________I0411 19:22:15.391921 140669647185728 controller.py:362] restoring or initializing model...
I0411 19:22:24.183492 140669647185728 yolo.py:519] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0411 19:22:24.185305 140669647185728 controller.py:368] initialized model.
I0411 19:22:24.185537 140669647185728 train_lib.py:96] Starts to execute mode: train_and_eval
I0411 19:22:24.190907 140669647185728 controller.py:211] train | step:      0 | training until step 20000...
I0411 19:22:31.746793 140669647185728 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0411 19:23:34.497123 140669647185728 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0411 20:00:30.031353 140669647185728 controller.py:425] train | step:   5000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.070086725,
           'avg_obj': 0.009713647,
           'box_loss': 0.037589435,
           'class_loss': 6.958642,
           'conf_loss': 30.376127,
           'precision50': 0.009734817,
           'recall50': 0.0030740013},
     '4': {'avg_iou': 0.07674935,
           'avg_obj': 0.017279014,
           'box_loss': 0.046620775,
           'class_loss': 9.397553,
           'conf_loss': 14.162332,
           'precision50': 0.025552755,
           'recall50': 0.0097424565},
     '5': {'avg_iou': 0.08194698,
           'avg_obj': 0.028841486,
           'box_loss': 0.031243034,
           'class_loss': 6.9782157,
           'conf_loss': 6.851608,
           'precision50': 0.039433148,
           'recall50': 0.022870973},
     'global': {'total_loss': 598.72003},
     'learning_rate': 0.00261,
     'training_loss': 598.72003}
I0411 20:01:29.533754 140669647185728 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og/ckpt-5000.
/home/cam2tensorflow/.experiment_start.sh: line 22:  2606 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   212    0     2  100   210     11   1206 --:--:-- --:--:-- --:--:--  1225
okRequest issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-11T20:17:41.650380627Z'
  endTime: '2021-04-11T20:18:34.832404492Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618172261639-5bfb816d72699-4e297089-4f0057f0
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618172261639-5bfb816d72699-4e297089-4f0057f0] to complete...
................................................................................................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-11T20:21:57.200439470Z'
  endTime: '2021-04-11T20:22:35.506776050Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618172517189-5bfb82612886a-a8195497-9f51bb4c
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618172517189-5bfb82612886a-a8195497-9f51bb4c] to complete...
............................................................................................................................................................................................................................................................................done.
europe-west4-a
I0411 20:22:00.079059 140650773251904 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.075,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.2,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 0.6,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.05,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.2,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.667,
                                                    'output_size': [640, 640],
                                                    'random_crop': True,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [200000,
                                                                                250000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00261,
                                                                            0.000261,
                                                                            2.61e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0411 20:22:00.080036 140650773251904 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_testing/all-mean-og/params.yaml
I0411 20:22:00.865659 140650773251904 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 20:22:01.498996 140650773251904 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0411 20:22:01.499286 140650773251904 transport.py:157] Attempting refresh to obtain initial access_token
I0411 20:22:01.549482 140650773251904 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 20:22:01.690040 140650773251904 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0411 20:22:01.690297 140650773251904 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-11 20:22:01.747457: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0411 20:22:01.748092 140650773251904 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 20:22:02.365930 140650773251904 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0411 20:22:02.366170 140650773251904 transport.py:157] Attempting refresh to obtain initial access_token
I0411 20:22:02.417717 140650773251904 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 20:22:02.557703 140650773251904 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0411 20:22:02.557943 140650773251904 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-11 20:22:02.604441: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-11 20:22:02.613355: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-11 20:22:02.613427: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:34148}
2021-04-11 20:22:26.682147: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-11 20:22:26.682245: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:34148}
2021-04-11 20:22:26.682996: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:34148
I0411 20:22:26.684124 140650773251904 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-6
I0411 20:22:26.685278 140650773251904 tpu_strategy_util.py:74] Initializing the TPU system: node-6
INFO:tensorflow:Clearing out eager caches
I0411 20:22:34.806348 140650773251904 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0411 20:22:34.808437 140650773251904 tpu_strategy_util.py:133] Finished initializing TPU system.
I0411 20:22:34.810113 140650773251904 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 20:22:35.434998 140650773251904 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0411 20:22:35.435240 140650773251904 transport.py:157] Attempting refresh to obtain initial access_token
I0411 20:22:35.479694 140650773251904 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 20:22:36.093677 140650773251904 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0411 20:22:36.093971 140650773251904 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0411 20:22:36.139978 140650773251904 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0411 20:22:36.140552 140650773251904 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0411 20:22:36.141025 140650773251904 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0411 20:22:36.141225 140650773251904 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0411 20:22:36.141339 140650773251904 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0411 20:22:36.141542 140650773251904 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0411 20:22:36.141607 140650773251904 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0411 20:22:36.141657 140650773251904 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0411 20:22:36.141704 140650773251904 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0411 20:22:36.141759 140650773251904 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0411 20:22:36.141815 140650773251904 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0411 20:22:36.141861 140650773251904 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0411 20:22:36.141955 140650773251904 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0411 20:22:36.142002 140650773251904 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0411 20:22:36.142047 140650773251904 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0411 20:22:36.142097 140650773251904 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0411 20:22:36.176355 140650773251904 train_utils.py:214] Running default trainer.
2021-04-11 20:22:36.184387: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.05, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.6, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.667, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [200000, 250000], 'values': [0.00261, 0.000261, 2.61e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05} 0.00025
{'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7feb6b1436a0>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
conv1 512.0
conv2 1024.0
conv1 512.0
spp
conv1 512.0
conv2 1024.0
conv1 512.0
7
conv1 512.0
conv2 256.0
conv1 512.0
conv2 256.0
4








 ListWrapper([256, 512, 1024])
conv1 128
conv2 256
conv1 128
conv2 256
conv1 128
conv2 256
6
conv1 256
conv2 512
conv1 256
conv2 512
conv1 256
conv2 512
6
conv1 512
conv2 1024
conv1 512
conv2 1024
conv1 512
conv2 1024
6
detget {'3': 1.2, '4': 1.1, '5': 1.05}
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 80, 80, 256) 37319168  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 64,488,640
Trainable params: 64,422,336
Non-trainable params: 66,304
_________________________________________________________________I0411 20:23:24.088865 140650773251904 controller.py:362] restoring or initializing model...
I0411 20:23:39.505819 140650773251904 controller.py:366] restored model from gs://tensorflow2/config_testing/all-mean-og/ckpt-5000.
I0411 20:23:39.506124 140650773251904 controller.py:192] restored from checkpoint: gs://tensorflow2/config_testing/all-mean-og/ckpt-5000
I0411 20:23:39.506234 140650773251904 train_lib.py:96] Starts to execute mode: train_and_eval
I0411 20:23:39.510987 140650773251904 controller.py:211] train | step:   5000 | training until step 25000...
I0411 20:23:46.415894 140650773251904 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0411 20:24:42.529588 140650773251904 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0411 21:03:02.748184 140650773251904 controller.py:425] train | step:  10000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.6389727,
           'avg_obj': 0.12611139,
           'box_loss': 0.24907854,
           'class_loss': 18.344995,
           'conf_loss': 43.861916,
           'precision50': 0.15933906,
           'recall50': 0.054016657},
     '4': {'avg_iou': 0.70269525,
           'avg_obj': 0.2224562,
           'box_loss': 0.2882651,
           'class_loss': 24.732016,
           'conf_loss': 49.243065,
           'precision50': 0.32785705,
           'recall50': 0.16173741},
     '5': {'avg_iou': 0.7464171,
           'avg_obj': 0.3514361,
           'box_loss': 0.18448283,
           'class_loss': 18.50239,
           'conf_loss': 27.69959,
           'precision50': 0.44136527,
           'recall50': 0.33266696},
     'global': {'total_loss': 183.10579},
     'learning_rate': 0.00261,
     'training_loss': 183.10579}
I0411 21:38:28.032855 140650773251904 controller.py:425] train | step:  15000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.65726805,
           'avg_obj': 0.15027706,
           'box_loss': 0.23663016,
           'class_loss': 15.92092,
           'conf_loss': 41.604694,
           'precision50': 0.18575116,
           'recall50': 0.07194678},
     '4': {'avg_iou': 0.72380435,
           'avg_obj': 0.2602407,
           'box_loss': 0.26844144,
           'class_loss': 21.227327,
           'conf_loss': 46.14655,
           'precision50': 0.34957054,
           'recall50': 0.20190616},
     '5': {'avg_iou': 0.7654296,
           'avg_obj': 0.3953982,
           'box_loss': 0.17063236,
           'class_loss': 15.855605,
           'conf_loss': 25.611397,
           'precision50': 0.45454103,
           'recall50': 0.3871538},
     'global': {'total_loss': 167.04224},
     'learning_rate': 0.00261,
     'training_loss': 167.04224}
I0411 22:11:46.727666 140650773251904 controller.py:425] train | step:  20000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.66693693,
           'avg_obj': 0.16540544,
           'box_loss': 0.22939432,
           'class_loss': 14.545093,
           'conf_loss': 40.22086,
           'precision50': 0.20040286,
           'recall50': 0.08409684},
     '4': {'avg_iou': 0.73594034,
           'avg_obj': 0.28353295,
           'box_loss': 0.25618127,
           'class_loss': 19.213127,
           'conf_loss': 44.191467,
           'precision50': 0.36105388,
           'recall50': 0.22767346},
     '5': {'avg_iou': 0.7769828,
           'avg_obj': 0.4233696,
           'box_loss': 0.16232663,
           'class_loss': 14.363103,
           'conf_loss': 24.33061,
           'precision50': 0.461254,
           'recall50': 0.42136958},
     'global': {'total_loss': 157.51207},
     'learning_rate': 0.00261,
     'training_loss': 157.51207}
I0411 22:44:49.258711 140650773251904 controller.py:425] train | step:  25000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6740482,
           'avg_obj': 0.17694372,
           'box_loss': 0.22436918,
           'class_loss': 13.621559,
           'conf_loss': 39.211227,
           'precision50': 0.20949544,
           'recall50': 0.09269592},
     '4': {'avg_iou': 0.7447359,
           'avg_obj': 0.30137148,
           'box_loss': 0.24722534,
           'class_loss': 17.782774,
           'conf_loss': 42.700344,
           'precision50': 0.3649919,
           'recall50': 0.24590896},
     '5': {'avg_iou': 0.785051,
           'avg_obj': 0.44288096,
           'box_loss': 0.15612888,
           'class_loss': 13.283901,
           'conf_loss': 23.397457,
           'precision50': 0.46353623,
           'recall50': 0.44375595},
     'global': {'total_loss': 150.62518},
     'learning_rate': 0.00261,
     'training_loss': 150.62518}
I0411 22:45:46.574437 140650773251904 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og/ckpt-25000.
I0411 22:45:46.580170 140650773251904 controller.py:252]  eval | step:  25000 | running 625 steps of evaluation...
I0411 22:45:47.235794 140650773251904 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0411 22:46:05.804373 140650773251904 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0411 22:51:12.045303 140650773251904 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0411 22:55:18.578564 140650773251904 controller.py:261]  eval | step:  25000 | eval time:  572.0 sec | output: 
    {'3': {'avg_iou': 0.43692186,
           'avg_obj': 0.13174771,
           'box_loss': 0.15560308,
           'class_loss': 7.224821,
           'conf_loss': 28.204407,
           'precision50': 0.18615445,
           'recall50': 0.1088433},
     '4': {'avg_iou': 0.6446745,
           'avg_obj': 0.30037826,
           'box_loss': 0.1766516,
           'class_loss': 8.795147,
           'conf_loss': 29.270365,
           'precision50': 0.3339715,
           'recall50': 0.28584644},
     '5': {'avg_iou': 0.7708395,
           'avg_obj': 0.4892529,
           'box_loss': 0.11650863,
           'class_loss': 6.091921,
           'conf_loss': 16.804035,
           'precision50': 0.45182577,
           'recall50': 0.4907329},
     'AP': 0.2970638,
     'AP50': 0.49988392,
     'AP75': 0.31634623,
     'APl': 0.3838419,
     'APm': 0.25524458,
     'APs': 0.10741246,
     'ARl': 0.589119,
     'ARm': 0.48472843,
     'ARmax1': 0.2679475,
     'ARmax10': 0.454931,
     'ARmax100': 0.50148433,
     'ARs': 0.2619284,
     'global': {'total_loss': 96.83948},
     'validation_loss': 96.83948}

defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((8, 640, 640, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 200, 8), 4: (8, 200, 8), 5: (8, 200, 8)}, inds: {3: (8, 200, 3), 4: (8, 200, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 80, 80, 3, 1), 4: (8, 40, 40, 3, 1), 5: (8, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((1, 640, 640, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 80, 80, 3, 1), 4: (1, 40, 40, 3, 1), 5: (1, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
restored model from gs://tensorflow2/config_testing/all-mean-og/ckpt-5000.
restored from checkpoint: gs://tensorflow2/config_testing/all-mean-og/ckpt-5000
train | step:   5000 | training until step 25000...
train | step:  10000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.6389727,
           'avg_obj': 0.12611139,
           'box_loss': 0.24907854,
           'class_loss': 18.344995,
           'conf_loss': 43.861916,
           'precision50': 0.15933906,
           'recall50': 0.054016657},
     '4': {'avg_iou': 0.70269525,
           'avg_obj': 0.2224562,
           'box_loss': 0.2882651,
           'class_loss': 24.732016,
           'conf_loss': 49.243065,
           'precision50': 0.32785705,
           'recall50': 0.16173741},
     '5': {'avg_iou': 0.7464171,
           'avg_obj': 0.3514361,
           'box_loss': 0.18448283,
           'class_loss': 18.50239,
           'conf_loss': 27.69959,
           'precision50': 0.44136527,
           'recall50': 0.33266696},
     'global': {'total_loss': 183.10579},
     'learning_rate': 0.00261,
     'training_loss': 183.10579}
train | step:  15000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.65726805,
           'avg_obj': 0.15027706,
           'box_loss': 0.23663016,
           'class_loss': 15.92092,
           'conf_loss': 41.604694,
           'precision50': 0.18575116,
           'recall50': 0.07194678},
     '4': {'avg_iou': 0.72380435,
           'avg_obj': 0.2602407,
           'box_loss': 0.26844144,
           'class_loss': 21.227327,
           'conf_loss': 46.14655,
           'precision50': 0.34957054,
           'recall50': 0.20190616},
     '5': {'avg_iou': 0.7654296,
           'avg_obj': 0.3953982,
           'box_loss': 0.17063236,
           'class_loss': 15.855605,
           'conf_loss': 25.611397,
           'precision50': 0.45454103,
           'recall50': 0.3871538},
     'global': {'total_loss': 167.04224},
     'learning_rate': 0.00261,
     'training_loss': 167.04224}
train | step:  20000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.66693693,
           'avg_obj': 0.16540544,
           'box_loss': 0.22939432,
           'class_loss': 14.545093,
           'conf_loss': 40.22086,
           'precision50': 0.20040286,
           'recall50': 0.08409684},
     '4': {'avg_iou': 0.73594034,
           'avg_obj': 0.28353295,
           'box_loss': 0.25618127,
           'class_loss': 19.213127,
           'conf_loss': 44.191467,
           'precision50': 0.36105388,
           'recall50': 0.22767346},
     '5': {'avg_iou': 0.7769828,
           'avg_obj': 0.4233696,
           'box_loss': 0.16232663,
           'class_loss': 14.363103,
           'conf_loss': 24.33061,
           'precision50': 0.461254,
           'recall50': 0.42136958},
     'global': {'total_loss': 157.51207},
     'learning_rate': 0.00261,
     'training_loss': 157.51207}
train | step:  25000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6740482,
           'avg_obj': 0.17694372,
           'box_loss': 0.22436918,
           'class_loss': 13.621559,
           'conf_loss': 39.211227,
           'precision50': 0.20949544,
           'recall50': 0.09269592},
     '4': {'avg_iou': 0.7447359,
           'avg_obj': 0.30137148,
           'box_loss': 0.24722534,
           'class_loss': 17.782774,
           'conf_loss': 42.700344,
           'precision50': 0.3649919,
           'recall50': 0.24590896},
     '5': {'avg_iou': 0.785051,
           'avg_obj': 0.44288096,
           'box_loss': 0.15612888,
           'class_loss': 13.283901,
           'conf_loss': 23.397457,
           'precision50': 0.46353623,
           'recall50': 0.44375595},
     'global': {'total_loss': 150.62518},
     'learning_rate': 0.00261,
     'training_loss': 150.62518}
saved checkpoint to gs://tensorflow2/config_testing/all-mean-og/ckpt-25000.
 eval | step:  25000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=173.29s).
Accumulating evaluation results...
DONE (t=17.14s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.297
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.500
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.316
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.107
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.255
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.384
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.268
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.455
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.501
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.262
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.589
 eval | step:  25000 | eval time:  572.0 sec | output: 
    {'3': {'avg_iou': 0.43692186,
           'avg_obj': 0.13174771,
           'box_loss': 0.15560308,
           'class_loss': 7.224821,
           'conf_loss': 28.204407,
           'precision50': 0.18615445,
           'recall50': 0.1088433},
     '4': {'avg_iou': 0.6446745,
           'avg_obj': 0.30037826,
           'box_loss': 0.1766516,
           'class_loss': 8.795147,
           'conf_loss': 29.270365,
           'precision50': 0.3339715,
           'recall50': 0.28584644},
     '5': {'avg_iou': 0.7708395,
           'avg_obj': 0.4892529,
           'box_loss': 0.11650863,
           'class_loss': 6.091921,
           'conf_loss': 16.804035,
           'precision50': 0.45182577,
           'recall50': 0.4907329},
     'AP': 0.2970638,
     'AP50': 0.49988392,
     'AP75': 0.31634623,
     'APl': 0.3838419,
     'APm': 0.25524458,
     'APs': 0.10741246,
     'ARl': 0.589119,
     'ARm': 0.48472843,
     'ARmax1': 0.2679475,
     'ARmax10': 0.454931,
     'ARmax100': 0.50148433,
     'ARs': 0.2619284,
     'global': {'total_loss': 96.83948},
     'validation_loss': 96.83948}I0411 22:55:42.996720 140650773251904 controller.py:211] train | step:  25000 | training until step 45000...
I0411 23:33:07.077886 140650773251904 controller.py:425] train | step:  30000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6793216,
           'avg_obj': 0.18622538,
           'box_loss': 0.22173862,
           'class_loss': 12.976642,
           'conf_loss': 38.59838,
           'precision50': 0.2176043,
           'recall50': 0.10050568},
     '4': {'avg_iou': 0.75088775,
           'avg_obj': 0.3139453,
           'box_loss': 0.24145396,
           'class_loss': 16.817207,
           'conf_loss': 41.73537,
           'precision50': 0.369382,
           'recall50': 0.25964782},
     '5': {'avg_iou': 0.79117876,
           'avg_obj': 0.45722798,
           'box_loss': 0.15165262,
           'class_loss': 12.521563,
           'conf_loss': 22.735693,
           'precision50': 0.46360448,
           'recall50': 0.46086943},
     'global': {'total_loss': 145.99945},
     'learning_rate': 0.00261,
     'training_loss': 145.99945}
I0412 00:10:02.956193 140650773251904 controller.py:425] train | step:  35000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.68326277,
           'avg_obj': 0.19350803,
           'box_loss': 0.21945374,
           'class_loss': 12.473305,
           'conf_loss': 38.095364,
           'precision50': 0.22215004,
           'recall50': 0.10634905},
     '4': {'avg_iou': 0.7559511,
           'avg_obj': 0.3257437,
           'box_loss': 0.23783472,
           'class_loss': 16.087566,
           'conf_loss': 41.050686,
           'precision50': 0.3737923,
           'recall50': 0.27244008},
     '5': {'avg_iou': 0.79610765,
           'avg_obj': 0.47102255,
           'box_loss': 0.14875591,
           'class_loss': 11.927314,
           'conf_loss': 22.206781,
           'precision50': 0.46610263,
           'recall50': 0.47717723},
     'global': {'total_loss': 142.4473},
     'learning_rate': 0.00261,
     'training_loss': 142.4473}
I0412 00:41:20.556401 140650773251904 controller.py:425] train | step:  40000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6867058,
           'avg_obj': 0.19947399,
           'box_loss': 0.21643323,
           'class_loss': 11.964785,
           'conf_loss': 37.515984,
           'precision50': 0.22690554,
           'recall50': 0.111418724},
     '4': {'avg_iou': 0.7600894,
           'avg_obj': 0.33487698,
           'box_loss': 0.23351748,
           'class_loss': 15.416432,
           'conf_loss': 40.29414,
           'precision50': 0.3765388,
           'recall50': 0.2823081},
     '5': {'avg_iou': 0.8003601,
           'avg_obj': 0.48119193,
           'box_loss': 0.14574003,
           'class_loss': 11.476873,
           'conf_loss': 21.752493,
           'precision50': 0.46636617,
           'recall50': 0.48871773},
     'global': {'total_loss': 139.01663},
     'learning_rate': 0.00261,
     'training_loss': 139.01663}
I0412 01:16:03.832455 140650773251904 controller.py:425] train | step:  45000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6899038,
           'avg_obj': 0.20601362,
           'box_loss': 0.21426104,
           'class_loss': 11.566865,
           'conf_loss': 36.974255,
           'precision50': 0.22925994,
           'recall50': 0.115418985},
     '4': {'avg_iou': 0.76366884,
           'avg_obj': 0.3428818,
           'box_loss': 0.22896746,
           'class_loss': 14.770912,
           'conf_loss': 39.48019,
           'precision50': 0.37592342,
           'recall50': 0.28962806},
     '5': {'avg_iou': 0.80376595,
           'avg_obj': 0.48991612,
           'box_loss': 0.14252366,
           'class_loss': 10.970131,
           'conf_loss': 21.251257,
           'precision50': 0.46617573,
           'recall50': 0.49808994},
     'global': {'total_loss': 135.59932},
     'learning_rate': 0.00261,
     'training_loss': 135.59932}
I0412 01:17:00.744080 140650773251904 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og/ckpt-45000.
I0412 01:17:00.750354 140650773251904 controller.py:252]  eval | step:  45000 | running 625 steps of evaluation...
I0412 01:21:32.240634 140650773251904 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0412 01:25:43.875388 140650773251904 controller.py:261]  eval | step:  45000 | eval time:  523.1 sec | output: 
    {'3': {'avg_iou': 0.44288594,
           'avg_obj': 0.14530778,
           'box_loss': 0.15014687,
           'class_loss': 6.1932673,
           'conf_loss': 26.956697,
           'precision50': 0.19557987,
           'recall50': 0.12219594},
     '4': {'avg_iou': 0.65545696,
           'avg_obj': 0.32980356,
           'box_loss': 0.16708638,
           'class_loss': 7.554062,
           'conf_loss': 27.641869,
           'precision50': 0.346457,
           'recall50': 0.31887263},
     '5': {'avg_iou': 0.7856969,
           'avg_obj': 0.5325165,
           'box_loss': 0.10853644,
           'class_loss': 5.1797285,
           'conf_loss': 15.620661,
           'precision50': 0.447561,
           'recall50': 0.540726},
     'AP': 0.33789465,
     'AP50': 0.5509424,
     'AP75': 0.36087668,
     'APl': 0.4356438,
     'APm': 0.2965678,
     'APs': 0.1267568,
     'ARl': 0.62163633,
     'ARm': 0.5188893,
     'ARmax1': 0.28940454,
     'ARmax10': 0.48347676,
     'ARmax100': 0.5320301,
     'ARs': 0.28635204,
     'global': {'total_loss': 89.57192},
     'validation_loss': 89.57192}
I0412 01:26:03.609833 140650773251904 controller.py:211] train | step:  45000 | training until step 65000...
I0412 02:02:00.952248 140650773251904 controller.py:425] train | step:  50000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.692212,
           'avg_obj': 0.2111218,
           'box_loss': 0.21225932,
           'class_loss': 11.234357,
           'conf_loss': 36.583683,
           'precision50': 0.23392943,
           'recall50': 0.11977182},
     '4': {'avg_iou': 0.76684326,
           'avg_obj': 0.3506135,
           'box_loss': 0.22608337,
           'class_loss': 14.299612,
           'conf_loss': 38.945415,
           'precision50': 0.37785077,
           'recall50': 0.29712772},
     '5': {'avg_iou': 0.8068979,
           'avg_obj': 0.49874496,
           'box_loss': 0.14032067,
           'class_loss': 10.594648,
           'conf_loss': 20.894083,
           'precision50': 0.46714473,
           'recall50': 0.50845915},
     'global': {'total_loss': 133.13017},
     'learning_rate': 0.00261,
     'training_loss': 133.13017}
I0412 02:34:42.500509 140650773251904 controller.py:425] train | step:  55000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.694562,
           'avg_obj': 0.21554153,
           'box_loss': 0.21125185,
           'class_loss': 10.956649,
           'conf_loss': 36.340652,
           'precision50': 0.23669043,
           'recall50': 0.12327138},
     '4': {'avg_iou': 0.7694459,
           'avg_obj': 0.3572561,
           'box_loss': 0.22417861,
           'class_loss': 13.9279,
           'conf_loss': 38.57082,
           'precision50': 0.3797402,
           'recall50': 0.30464134},
     '5': {'avg_iou': 0.8093796,
           'avg_obj': 0.50542486,
           'box_loss': 0.13879971,
           'class_loss': 10.304231,
           'conf_loss': 20.614767,
           'precision50': 0.4671237,
           'recall50': 0.5161211},
     'global': {'total_loss': 131.28929},
     'learning_rate': 0.00261,
     'training_loss': 131.28929}
I0412 03:08:28.743046 140650773251904 controller.py:425] train | step:  60000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6964487,
           'avg_obj': 0.22035263,
           'box_loss': 0.20960976,
           'class_loss': 10.686134,
           'conf_loss': 35.963245,
           'precision50': 0.2394039,
           'recall50': 0.12789159},
     '4': {'avg_iou': 0.7719943,
           'avg_obj': 0.36434063,
           'box_loss': 0.22166912,
           'class_loss': 13.520711,
           'conf_loss': 38.06955,
           'precision50': 0.38115436,
           'recall50': 0.31197318},
     '5': {'avg_iou': 0.8116886,
           'avg_obj': 0.5121136,
           'box_loss': 0.13708027,
           'class_loss': 10.003775,
           'conf_loss': 20.317812,
           'precision50': 0.46714604,
           'recall50': 0.52319366},
     'global': {'total_loss': 129.12946},
     'learning_rate': 0.00261,
     'training_loss': 129.12946}

train | step:  25000 | training until step 45000...
train | step:  30000 | steps/sec:    1.7 | output: 
    {'3': {'avg_iou': 0.6793216,
           'avg_obj': 0.18622538,
           'box_loss': 0.22173862,
           'class_loss': 12.976642,
           'conf_loss': 38.59838,
           'precision50': 0.2176043,
           'recall50': 0.10050568},
     '4': {'avg_iou': 0.75088775,
           'avg_obj': 0.3139453,
           'box_loss': 0.24145396,
           'class_loss': 16.817207,
           'conf_loss': 41.73537,
           'precision50': 0.369382,
           'recall50': 0.25964782},
     '5': {'avg_iou': 0.79117876,
           'avg_obj': 0.45722798,
           'box_loss': 0.15165262,
           'class_loss': 12.521563,
           'conf_loss': 22.735693,
           'precision50': 0.46360448,
           'recall50': 0.46086943},
     'global': {'total_loss': 145.99945},
     'learning_rate': 0.00261,
     'training_loss': 145.99945}
train | step:  35000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.68326277,
           'avg_obj': 0.19350803,
           'box_loss': 0.21945374,
           'class_loss': 12.473305,
           'conf_loss': 38.095364,
           'precision50': 0.22215004,
           'recall50': 0.10634905},
     '4': {'avg_iou': 0.7559511,
           'avg_obj': 0.3257437,
           'box_loss': 0.23783472,
           'class_loss': 16.087566,
           'conf_loss': 41.050686,
           'precision50': 0.3737923,
           'recall50': 0.27244008},
     '5': {'avg_iou': 0.79610765,
           'avg_obj': 0.47102255,
           'box_loss': 0.14875591,
           'class_loss': 11.927314,
           'conf_loss': 22.206781,
           'precision50': 0.46610263,
           'recall50': 0.47717723},
     'global': {'total_loss': 142.4473},
     'learning_rate': 0.00261,
     'training_loss': 142.4473}
train | step:  40000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6867058,
           'avg_obj': 0.19947399,
           'box_loss': 0.21643323,
           'class_loss': 11.964785,
           'conf_loss': 37.515984,
           'precision50': 0.22690554,
           'recall50': 0.111418724},
     '4': {'avg_iou': 0.7600894,
           'avg_obj': 0.33487698,
           'box_loss': 0.23351748,
           'class_loss': 15.416432,
           'conf_loss': 40.29414,
           'precision50': 0.3765388,
           'recall50': 0.2823081},
     '5': {'avg_iou': 0.8003601,
           'avg_obj': 0.48119193,
           'box_loss': 0.14574003,
           'class_loss': 11.476873,
           'conf_loss': 21.752493,
           'precision50': 0.46636617,
           'recall50': 0.48871773},
     'global': {'total_loss': 139.01663},
     'learning_rate': 0.00261,
     'training_loss': 139.01663}
train | step:  45000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6899038,
           'avg_obj': 0.20601362,
           'box_loss': 0.21426104,
           'class_loss': 11.566865,
           'conf_loss': 36.974255,
           'precision50': 0.22925994,
           'recall50': 0.115418985},
     '4': {'avg_iou': 0.76366884,
           'avg_obj': 0.3428818,
           'box_loss': 0.22896746,
           'class_loss': 14.770912,
           'conf_loss': 39.48019,
           'precision50': 0.37592342,
           'recall50': 0.28962806},
     '5': {'avg_iou': 0.80376595,
           'avg_obj': 0.48991612,
           'box_loss': 0.14252366,
           'class_loss': 10.970131,
           'conf_loss': 21.251257,
           'precision50': 0.46617573,
           'recall50': 0.49808994},
     'global': {'total_loss': 135.59932},
     'learning_rate': 0.00261,
     'training_loss': 135.59932}
saved checkpoint to gs://tensorflow2/config_testing/all-mean-og/ckpt-45000.
 eval | step:  45000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=178.00s).
Accumulating evaluation results...
DONE (t=15.71s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.338
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.551
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.361
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.127
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.297
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.436
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.289
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.483
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.532
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.286
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.519
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.622
 eval | step:  45000 | eval time:  523.1 sec | output: 
    {'3': {'avg_iou': 0.44288594,
           'avg_obj': 0.14530778,
           'box_loss': 0.15014687,
           'class_loss': 6.1932673,
           'conf_loss': 26.956697,
           'precision50': 0.19557987,
           'recall50': 0.12219594},
     '4': {'avg_iou': 0.65545696,
           'avg_obj': 0.32980356,
           'box_loss': 0.16708638,
           'class_loss': 7.554062,
           'conf_loss': 27.641869,
           'precision50': 0.346457,
           'recall50': 0.31887263},
     '5': {'avg_iou': 0.7856969,
           'avg_obj': 0.5325165,
           'box_loss': 0.10853644,
           'class_loss': 5.1797285,
           'conf_loss': 15.620661,
           'precision50': 0.447561,
           'recall50': 0.540726},
     'AP': 0.33789465,
     'AP50': 0.5509424,
     'AP75': 0.36087668,
     'APl': 0.4356438,
     'APm': 0.2965678,
     'APs': 0.1267568,
     'ARl': 0.62163633,
     'ARm': 0.5188893,
     'ARmax1': 0.28940454,
     'ARmax10': 0.48347676,
     'ARmax100': 0.5320301,
     'ARs': 0.28635204,
     'global': {'total_loss': 89.57192},
     'validation_loss': 89.57192}
train | step:  45000 | training until step 65000...
train | step:  50000 | steps/sec:    1.8 | output: 
    {'3': {'avg_iou': 0.692212,
           'avg_obj': 0.2111218,
           'box_loss': 0.21225932,
           'class_loss': 11.234357,
           'conf_loss': 36.583683,
           'precision50': 0.23392943,
           'recall50': 0.11977182},
     '4': {'avg_iou': 0.76684326,
           'avg_obj': 0.3506135,
           'box_loss': 0.22608337,
           'class_loss': 14.299612,
           'conf_loss': 38.945415,
           'precision50': 0.37785077,
           'recall50': 0.29712772},
     '5': {'avg_iou': 0.8068979,
           'avg_obj': 0.49874496,
           'box_loss': 0.14032067,
           'class_loss': 10.594648,
           'conf_loss': 20.894083,
           'precision50': 0.46714473,
           'recall50': 0.50845915},
     'global': {'total_loss': 133.13017},
     'learning_rate': 0.00261,
     'training_loss': 133.13017}
train | step:  55000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.694562,
           'avg_obj': 0.21554153,
           'box_loss': 0.21125185,
           'class_loss': 10.956649,
           'conf_loss': 36.340652,
           'precision50': 0.23669043,
           'recall50': 0.12327138},
     '4': {'avg_iou': 0.7694459,
           'avg_obj': 0.3572561,
           'box_loss': 0.22417861,
           'class_loss': 13.9279,
           'conf_loss': 38.57082,
           'precision50': 0.3797402,
           'recall50': 0.30464134},
     '5': {'avg_iou': 0.8093796,
           'avg_obj': 0.50542486,
           'box_loss': 0.13879971,
           'class_loss': 10.304231,
           'conf_loss': 20.614767,
           'precision50': 0.4671237,
           'recall50': 0.5161211},
     'global': {'total_loss': 131.28929},
     'learning_rate': 0.00261,
     'training_loss': 131.28929}
train | step:  60000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6964487,
           'avg_obj': 0.22035263,
           'box_loss': 0.20960976,
           'class_loss': 10.686134,
           'conf_loss': 35.963245,
           'precision50': 0.2394039,
           'recall50': 0.12789159},
     '4': {'avg_iou': 0.7719943,
           'avg_obj': 0.36434063,
           'box_loss': 0.22166912,
           'class_loss': 13.520711,
           'conf_loss': 38.06955,
           'precision50': 0.38115436,
           'recall50': 0.31197318},
     '5': {'avg_iou': 0.8116886,
           'avg_obj': 0.5121136,
           'box_loss': 0.13708027,
           'class_loss': 10.003775,
           'conf_loss': 20.317812,
           'precision50': 0.46714604,
           'recall50': 0.52319366},
     'global': {'total_loss': 129.12946},
     'learning_rate': 0.00261,
     'training_loss': 129.12946}I0412 03:39:49.869272 140650773251904 controller.py:425] train | step:  65000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.698129,
           'avg_obj': 0.22370696,
           'box_loss': 0.20819849,
           'class_loss': 10.438007,
           'conf_loss': 35.640728,
           'precision50': 0.24238457,
           'recall50': 0.13065274},
     '4': {'avg_iou': 0.7739247,
           'avg_obj': 0.3691604,
           'box_loss': 0.21948935,
           'class_loss': 13.180326,
           'conf_loss': 37.64229,
           'precision50': 0.38131818,
           'recall50': 0.3165743},
     '5': {'avg_iou': 0.81372005,
           'avg_obj': 0.51762176,
           'box_loss': 0.13570206,
           'class_loss': 9.754764,
           'conf_loss': 20.082188,
           'precision50': 0.46728545,
           'recall50': 0.52976286},
     'global': {'total_loss': 127.30177},
     'learning_rate': 0.00261,
     'training_loss': 127.30177}
I0412 03:40:39.568777 140650773251904 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og/ckpt-65000.
I0412 03:40:39.574337 140650773251904 controller.py:252]  eval | step:  65000 | running 625 steps of evaluation...
I0412 03:45:07.230805 140650773251904 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0412 03:49:08.896541 140650773251904 controller.py:261]  eval | step:  65000 | eval time:  509.3 sec | output: 
    {'3': {'avg_iou': 0.44620445,
           'avg_obj': 0.15606232,
           'box_loss': 0.14722991,
           'class_loss': 5.8187056,
           'conf_loss': 26.3678,
           'precision50': 0.20288013,
           'recall50': 0.13612849},
     '4': {'avg_iou': 0.6613458,
           'avg_obj': 0.349621,
           'box_loss': 0.1616809,
           'class_loss': 6.999431,
           'conf_loss': 26.87015,
           'precision50': 0.35080075,
           'recall50': 0.34377423},
     '5': {'avg_iou': 0.7931412,
           'avg_obj': 0.5539382,
           'box_loss': 0.10442572,
           'class_loss': 4.7517605,
           'conf_loss': 15.076575,
           'precision50': 0.43931943,
           'recall50': 0.5643207},
     'AP': 0.3586841,
     'AP50': 0.5739338,
     'AP75': 0.39020076,
     'APl': 0.4606297,
     'APm': 0.3181745,
     'APs': 0.13631657,
     'ARl': 0.63750803,
     'ARm': 0.53425777,
     'ARmax1': 0.29994598,
     'ARmax10': 0.49858418,
     'ARmax100': 0.54701835,
     'ARs': 0.29738978,
     'global': {'total_loss': 86.297806},
     'validation_loss': 86.297806}
I0412 03:49:25.788633 140650773251904 controller.py:211] train | step:  65000 | training until step 85000...
I0412 04:21:10.741333 140650773251904 controller.py:425] train | step:  70000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.69981587,
           'avg_obj': 0.22815044,
           'box_loss': 0.20814592,
           'class_loss': 10.303321,
           'conf_loss': 35.467045,
           'precision50': 0.24346836,
           'recall50': 0.13344297},
     '4': {'avg_iou': 0.7758578,
           'avg_obj': 0.37490478,
           'box_loss': 0.2179095,
           'class_loss': 12.910787,
           'conf_loss': 37.241245,
           'precision50': 0.38233304,
           'recall50': 0.32278556},
     '5': {'avg_iou': 0.81568074,
           'avg_obj': 0.5234477,
           'box_loss': 0.13408327,
           'class_loss': 9.5129385,
           'conf_loss': 19.797777,
           'precision50': 0.46716452,
           'recall50': 0.53575474},
     'global': {'total_loss': 125.79315},
     'learning_rate': 0.00261,
     'training_loss': 125.79315}
I0412 04:54:52.595541 140650773251904 controller.py:425] train | step:  75000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.70102805,
           'avg_obj': 0.23039177,
           'box_loss': 0.20651552,
           'class_loss': 10.0713,
           'conf_loss': 35.16843,
           'precision50': 0.24551848,
           'recall50': 0.13540572},
     '4': {'avg_iou': 0.77787006,
           'avg_obj': 0.3794912,
           'box_loss': 0.2157398,
           'class_loss': 12.644609,
           'conf_loss': 36.902546,
           'precision50': 0.3833924,
           'recall50': 0.327359},
     '5': {'avg_iou': 0.81740123,
           'avg_obj': 0.5292019,
           'box_loss': 0.13287702,
           'class_loss': 9.346062,
           'conf_loss': 19.576061,
           'precision50': 0.4676422,
           'recall50': 0.5429188},
     'global': {'total_loss': 124.264114},
     'learning_rate': 0.00261,
     'training_loss': 124.264114}
I0412 05:34:10.681843 140650773251904 controller.py:425] train | step:  80000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.702414,
           'avg_obj': 0.2340447,
           'box_loss': 0.20576772,
           'class_loss': 9.889093,
           'conf_loss': 34.96675,
           'precision50': 0.24715996,
           'recall50': 0.13816546},
     '4': {'avg_iou': 0.77926797,
           'avg_obj': 0.38305643,
           'box_loss': 0.2141657,
           'class_loss': 12.358136,
           'conf_loss': 36.574757,
           'precision50': 0.3836538,
           'recall50': 0.33130893},
     '5': {'avg_iou': 0.81890476,
           'avg_obj': 0.53246456,
           'box_loss': 0.13175116,
           'class_loss': 9.137991,
           'conf_loss': 19.39047,
           'precision50': 0.4675183,
           'recall50': 0.545659},
     'global': {'total_loss': 122.8689},
     'learning_rate': 0.00261,
     'training_loss': 122.8689}
I0412 06:05:30.315240 140650773251904 controller.py:425] train | step:  85000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.70420593,
           'avg_obj': 0.23716208,
           'box_loss': 0.20431066,
           'class_loss': 9.683132,
           'conf_loss': 34.717663,
           'precision50': 0.24788137,
           'recall50': 0.14036064},
     '4': {'avg_iou': 0.7808372,
           'avg_obj': 0.38758388,
           'box_loss': 0.21295676,
           'class_loss': 12.117916,
           'conf_loss': 36.31421,
           'precision50': 0.3840577,
           'recall50': 0.3359901},
     '5': {'avg_iou': 0.8200797,
           'avg_obj': 0.5367001,
           'box_loss': 0.1308755,
           'class_loss': 8.961703,
           'conf_loss': 19.216045,
           'precision50': 0.466798,
           'recall50': 0.5506691},
     'global': {'total_loss': 121.55919},
     'learning_rate': 0.00261,
     'training_loss': 121.55919}
I0412 06:06:22.305234 140650773251904 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og/ckpt-85000.
I0412 06:06:22.311908 140650773251904 controller.py:252]  eval | step:  85000 | running 625 steps of evaluation...
I0412 06:11:01.485572 140650773251904 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.

train | step:  65000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.698129,
           'avg_obj': 0.22370696,
           'box_loss': 0.20819849,
           'class_loss': 10.438007,
           'conf_loss': 35.640728,
           'precision50': 0.24238457,
           'recall50': 0.13065274},
     '4': {'avg_iou': 0.7739247,
           'avg_obj': 0.3691604,
           'box_loss': 0.21948935,
           'class_loss': 13.180326,
           'conf_loss': 37.64229,
           'precision50': 0.38131818,
           'recall50': 0.3165743},
     '5': {'avg_iou': 0.81372005,
           'avg_obj': 0.51762176,
           'box_loss': 0.13570206,
           'class_loss': 9.754764,
           'conf_loss': 20.082188,
           'precision50': 0.46728545,
           'recall50': 0.52976286},
     'global': {'total_loss': 127.30177},
     'learning_rate': 0.00261,
     'training_loss': 127.30177}
saved checkpoint to gs://tensorflow2/config_testing/all-mean-og/ckpt-65000.
 eval | step:  65000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=173.94s).
Accumulating evaluation results...
DONE (t=14.30s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.359
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.574
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.390
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.136
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.318
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.461
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.300
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.499
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.547
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.297
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.534
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.638
 eval | step:  65000 | eval time:  509.3 sec | output: 
    {'3': {'avg_iou': 0.44620445,
           'avg_obj': 0.15606232,
           'box_loss': 0.14722991,
           'class_loss': 5.8187056,
           'conf_loss': 26.3678,
           'precision50': 0.20288013,
           'recall50': 0.13612849},
     '4': {'avg_iou': 0.6613458,
           'avg_obj': 0.349621,
           'box_loss': 0.1616809,
           'class_loss': 6.999431,
           'conf_loss': 26.87015,
           'precision50': 0.35080075,
           'recall50': 0.34377423},
     '5': {'avg_iou': 0.7931412,
           'avg_obj': 0.5539382,
           'box_loss': 0.10442572,
           'class_loss': 4.7517605,
           'conf_loss': 15.076575,
           'precision50': 0.43931943,
           'recall50': 0.5643207},
     'AP': 0.3586841,
     'AP50': 0.5739338,
     'AP75': 0.39020076,
     'APl': 0.4606297,
     'APm': 0.3181745,
     'APs': 0.13631657,
     'ARl': 0.63750803,
     'ARm': 0.53425777,
     'ARmax1': 0.29994598,
     'ARmax10': 0.49858418,
     'ARmax100': 0.54701835,
     'ARs': 0.29738978,
     'global': {'total_loss': 86.297806},
     'validation_loss': 86.297806}
train | step:  65000 | training until step 85000...
train | step:  70000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.69981587,
           'avg_obj': 0.22815044,
           'box_loss': 0.20814592,
           'class_loss': 10.303321,
           'conf_loss': 35.467045,
           'precision50': 0.24346836,
           'recall50': 0.13344297},
     '4': {'avg_iou': 0.7758578,
           'avg_obj': 0.37490478,
           'box_loss': 0.2179095,
           'class_loss': 12.910787,
           'conf_loss': 37.241245,
           'precision50': 0.38233304,
           'recall50': 0.32278556},
     '5': {'avg_iou': 0.81568074,
           'avg_obj': 0.5234477,
           'box_loss': 0.13408327,
           'class_loss': 9.5129385,
           'conf_loss': 19.797777,
           'precision50': 0.46716452,
           'recall50': 0.53575474},
     'global': {'total_loss': 125.79315},
     'learning_rate': 0.00261,
     'training_loss': 125.79315}
train | step:  75000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.70102805,
           'avg_obj': 0.23039177,
           'box_loss': 0.20651552,
           'class_loss': 10.0713,
           'conf_loss': 35.16843,
           'precision50': 0.24551848,
           'recall50': 0.13540572},
     '4': {'avg_iou': 0.77787006,
           'avg_obj': 0.3794912,
           'box_loss': 0.2157398,
           'class_loss': 12.644609,
           'conf_loss': 36.902546,
           'precision50': 0.3833924,
           'recall50': 0.327359},
     '5': {'avg_iou': 0.81740123,
           'avg_obj': 0.5292019,
           'box_loss': 0.13287702,
           'class_loss': 9.346062,
           'conf_loss': 19.576061,
           'precision50': 0.4676422,
           'recall50': 0.5429188},
     'global': {'total_loss': 124.264114},
     'learning_rate': 0.00261,
     'training_loss': 124.264114}
train | step:  80000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.702414,
           'avg_obj': 0.2340447,
           'box_loss': 0.20576772,
           'class_loss': 9.889093,
           'conf_loss': 34.96675,
           'precision50': 0.24715996,
           'recall50': 0.13816546},
     '4': {'avg_iou': 0.77926797,
           'avg_obj': 0.38305643,
           'box_loss': 0.2141657,
           'class_loss': 12.358136,
           'conf_loss': 36.574757,
           'precision50': 0.3836538,
           'recall50': 0.33130893},
     '5': {'avg_iou': 0.81890476,
           'avg_obj': 0.53246456,
           'box_loss': 0.13175116,
           'class_loss': 9.137991,
           'conf_loss': 19.39047,
           'precision50': 0.4675183,
           'recall50': 0.545659},
     'global': {'total_loss': 122.8689},
     'learning_rate': 0.00261,
     'training_loss': 122.8689}
train | step:  85000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.70420593,
           'avg_obj': 0.23716208,
           'box_loss': 0.20431066,
           'class_loss': 9.683132,
           'conf_loss': 34.717663,
           'precision50': 0.24788137,
           'recall50': 0.14036064},
     '4': {'avg_iou': 0.7808372,
           'avg_obj': 0.38758388,
           'box_loss': 0.21295676,
           'class_loss': 12.117916,
           'conf_loss': 36.31421,
           'precision50': 0.3840577,
           'recall50': 0.3359901},
     '5': {'avg_iou': 0.8200797,
           'avg_obj': 0.5367001,
           'box_loss': 0.1308755,
           'class_loss': 8.961703,
           'conf_loss': 19.216045,
           'precision50': 0.466798,
           'recall50': 0.5506691},
     'global': {'total_loss': 121.55919},
     'learning_rate': 0.00261,
     'training_loss': 121.55919}
saved checkpoint to gs://tensorflow2/config_testing/all-mean-og/ckpt-85000.
 eval | step:  85000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=183.29s).
Accumulating evaluation results...
DONE (t=14.82s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.371
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.590
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.402
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.147
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.333
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.473
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.306
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.511
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.560
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.301
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.545
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.656I0412 06:15:21.550032 140650773251904 controller.py:261]  eval | step:  85000 | eval time:  539.2 sec | output: 
    {'3': {'avg_iou': 0.44839507,
           'avg_obj': 0.16256215,
           'box_loss': 0.14526094,
           'class_loss': 5.531897,
           'conf_loss': 26.070644,
           'precision50': 0.20802681,
           'recall50': 0.14424594},
     '4': {'avg_iou': 0.6652141,
           'avg_obj': 0.36286354,
           'box_loss': 0.15832421,
           'class_loss': 6.6414986,
           'conf_loss': 26.383966,
           'precision50': 0.34601688,
           'recall50': 0.35772562},
     '5': {'avg_iou': 0.7981438,
           'avg_obj': 0.5699838,
           'box_loss': 0.10177642,
           'class_loss': 4.510709,
           'conf_loss': 14.763209,
           'precision50': 0.4333775,
           'recall50': 0.57986516},
     'AP': 0.37062564,
     'AP50': 0.58976585,
     'AP75': 0.40187714,
     'APl': 0.4725083,
     'APm': 0.33266747,
     'APs': 0.1469747,
     'ARl': 0.65563375,
     'ARm': 0.5445689,
     'ARmax1': 0.30627313,
     'ARmax10': 0.5111488,
     'ARmax100': 0.55994856,
     'ARs': 0.3012086,
     'global': {'total_loss': 84.30732},
     'validation_loss': 84.30732}
I0412 06:15:42.394497 140650773251904 controller.py:211] train | step:  85000 | training until step 105000...
I0412 06:46:46.712825 140650773251904 controller.py:425] train | step:  90000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.70529073,
           'avg_obj': 0.23902148,
           'box_loss': 0.20309328,
           'class_loss': 9.5671,
           'conf_loss': 34.48504,
           'precision50': 0.24929221,
           'recall50': 0.1420521},
     '4': {'avg_iou': 0.78244674,
           'avg_obj': 0.39152586,
           'box_loss': 0.21126337,
           'class_loss': 11.934749,
           'conf_loss': 35.98266,
           'precision50': 0.38351828,
           'recall50': 0.33951434},
     '5': {'avg_iou': 0.82149845,
           'avg_obj': 0.5409353,
           'box_loss': 0.12996227,
           'class_loss': 8.792054,
           'conf_loss': 19.048742,
           'precision50': 0.4679798,
           'recall50': 0.5558246},
     'global': {'total_loss': 120.3548},
     'learning_rate': 0.00261,
     'training_loss': 120.3548}
I0412 07:23:43.134294 140650773251904 controller.py:425] train | step:  95000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.70654124,
           'avg_obj': 0.24246232,
           'box_loss': 0.20223372,
           'class_loss': 9.4313,
           'conf_loss': 34.214096,
           'precision50': 0.25103685,
           'recall50': 0.14490917},
     '4': {'avg_iou': 0.78352207,
           'avg_obj': 0.39537176,
           'box_loss': 0.20995003,
           'class_loss': 11.738188,
           'conf_loss': 35.6956,
           'precision50': 0.38392186,
           'recall50': 0.3428298},
     '5': {'avg_iou': 0.82275146,
           'avg_obj': 0.54413056,
           'box_loss': 0.1288756,
           'class_loss': 8.663664,
           'conf_loss': 18.8847,
           'precision50': 0.46649256,
           'recall50': 0.5578418},
     'global': {'total_loss': 119.16847},
     'learning_rate': 0.00261,
     'training_loss': 119.16847}
I0412 07:55:02.827489 140650773251904 controller.py:425] train | step:  100000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.70738024,
           'avg_obj': 0.24559376,
           'box_loss': 0.20228544,
           'class_loss': 9.343592,
           'conf_loss': 34.16928,
           'precision50': 0.25262648,
           'recall50': 0.14728652},
     '4': {'avg_iou': 0.78465915,
           'avg_obj': 0.3994749,
           'box_loss': 0.20900473,
           'class_loss': 11.612386,
           'conf_loss': 35.463604,
           'precision50': 0.38475665,
           'recall50': 0.34704518},
     '5': {'avg_iou': 0.8244093,
           'avg_obj': 0.54897535,
           'box_loss': 0.12777254,
           'class_loss': 8.5348015,
           'conf_loss': 18.695074,
           'precision50': 0.4664311,
           'recall50': 0.56377214},
     'global': {'total_loss': 118.35789},
     'learning_rate': 0.00261,
     'training_loss': 118.35789}
I0412 08:28:11.848837 140650773251904 controller.py:425] train | step:  105000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.7084517,
           'avg_obj': 0.24779433,
           'box_loss': 0.20198429,
           'class_loss': 9.214425,
           'conf_loss': 34.03799,
           'precision50': 0.25381556,
           'recall50': 0.14926368},
     '4': {'avg_iou': 0.7860153,
           'avg_obj': 0.4030264,
           'box_loss': 0.20821062,
           'class_loss': 11.421224,
           'conf_loss': 35.273808,
           'precision50': 0.38494483,
           'recall50': 0.35132396},
     '5': {'avg_iou': 0.8250595,
           'avg_obj': 0.5516568,
           'box_loss': 0.12732522,
           'class_loss': 8.413011,
           'conf_loss': 18.57335,
           'precision50': 0.46574223,
           'recall50': 0.56648314},
     'global': {'total_loss': 117.4713},
     'learning_rate': 0.00261,
     'training_loss': 117.4713}
I0412 08:29:04.095192 140650773251904 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og/ckpt-105000.
I0412 08:29:04.102112 140650773251904 controller.py:252]  eval | step:  105000 | running 625 steps of evaluation...
I0412 08:33:46.153970 140650773251904 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0412 08:37:50.816797 140650773251904 controller.py:261]  eval | step:  105000 | eval time:  526.7 sec | output: 
    {'3': {'avg_iou': 0.4498874,
           'avg_obj': 0.16774108,
           'box_loss': 0.1439528,
           'class_loss': 5.4106393,
           'conf_loss': 25.897942,
           'precision50': 0.20797175,
           'recall50': 0.15024635},
     '4': {'avg_iou': 0.6671217,
           'avg_obj': 0.37140527,
           'box_loss': 0.15595262,
           'class_loss': 6.507073,
           'conf_loss': 26.175928,
           'precision50': 0.3455827,
           'recall50': 0.36695346},
     '5': {'avg_iou': 0.8009906,
           'avg_obj': 0.5806889,
           'box_loss': 0.10008827,
           'class_loss': 4.40071,
           'conf_loss': 14.571036,
           'precision50': 0.4316421,
           'recall50': 0.59359634},
     'AP': 0.37849608,
     'AP50': 0.59652156,
     'AP75': 0.4147312,
     'APl': 0.48427105,
     'APm': 0.34051207,
     'APs': 0.14877522,
     'ARl': 0.65885264,
     'ARm': 0.5503116,
     'ARmax1': 0.3093303,
     'ARmax10': 0.5139792,
     'ARmax100': 0.56307566,
     'ARs': 0.31459802,
     'global': {'total_loss': 83.36339},
     'validation_loss': 83.36339}
I0412 08:38:08.201839 140650773251904 controller.py:211] train | step:  105000 | training until step 125000...
I0412 09:09:15.943779 140650773251904 controller.py:425] train | step:  110000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.7092058,
           'avg_obj': 0.2506216,
           'box_loss': 0.20102763,
           'class_loss': 9.070691,
           'conf_loss': 33.765842,
           'precision50': 0.2551571,
           'recall50': 0.15131995},
     '4': {'avg_iou': 0.7870014,
           'avg_obj': 0.40569994,
           'box_loss': 0.20614944,
           'class_loss': 11.211346,
           'conf_loss': 34.90602,
           'precision50': 0.38555375,
           'recall50': 0.35416827},
     '5': {'avg_iou': 0.826161,
           'avg_obj': 0.5556758,
           'box_loss': 0.12622857,
           'class_loss': 8.246293,
           'conf_loss': 18.361376,
           'precision50': 0.46582374,
           'recall50': 0.570984},
     'global': {'total_loss': 116.094765},
     'learning_rate': 0.00261,
     'training_loss': 116.094765}

 eval | step:  85000 | eval time:  539.2 sec | output: 
    {'3': {'avg_iou': 0.44839507,
           'avg_obj': 0.16256215,
           'box_loss': 0.14526094,
           'class_loss': 5.531897,
           'conf_loss': 26.070644,
           'precision50': 0.20802681,
           'recall50': 0.14424594},
     '4': {'avg_iou': 0.6652141,
           'avg_obj': 0.36286354,
           'box_loss': 0.15832421,
           'class_loss': 6.6414986,
           'conf_loss': 26.383966,
           'precision50': 0.34601688,
           'recall50': 0.35772562},
     '5': {'avg_iou': 0.7981438,
           'avg_obj': 0.5699838,
           'box_loss': 0.10177642,
           'class_loss': 4.510709,
           'conf_loss': 14.763209,
           'precision50': 0.4333775,
           'recall50': 0.57986516},
     'AP': 0.37062564,
     'AP50': 0.58976585,
     'AP75': 0.40187714,
     'APl': 0.4725083,
     'APm': 0.33266747,
     'APs': 0.1469747,
     'ARl': 0.65563375,
     'ARm': 0.5445689,
     'ARmax1': 0.30627313,
     'ARmax10': 0.5111488,
     'ARmax100': 0.55994856,
     'ARs': 0.3012086,
     'global': {'total_loss': 84.30732},
     'validation_loss': 84.30732}
train | step:  85000 | training until step 105000...
train | step:  90000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.70529073,
           'avg_obj': 0.23902148,
           'box_loss': 0.20309328,
           'class_loss': 9.5671,
           'conf_loss': 34.48504,
           'precision50': 0.24929221,
           'recall50': 0.1420521},
     '4': {'avg_iou': 0.78244674,
           'avg_obj': 0.39152586,
           'box_loss': 0.21126337,
           'class_loss': 11.934749,
           'conf_loss': 35.98266,
           'precision50': 0.38351828,
           'recall50': 0.33951434},
     '5': {'avg_iou': 0.82149845,
           'avg_obj': 0.5409353,
           'box_loss': 0.12996227,
           'class_loss': 8.792054,
           'conf_loss': 19.048742,
           'precision50': 0.4679798,
           'recall50': 0.5558246},
     'global': {'total_loss': 120.3548},
     'learning_rate': 0.00261,
     'training_loss': 120.3548}
train | step:  95000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.70654124,
           'avg_obj': 0.24246232,
           'box_loss': 0.20223372,
           'class_loss': 9.4313,
           'conf_loss': 34.214096,
           'precision50': 0.25103685,
           'recall50': 0.14490917},
     '4': {'avg_iou': 0.78352207,
           'avg_obj': 0.39537176,
           'box_loss': 0.20995003,
           'class_loss': 11.738188,
           'conf_loss': 35.6956,
           'precision50': 0.38392186,
           'recall50': 0.3428298},
     '5': {'avg_iou': 0.82275146,
           'avg_obj': 0.54413056,
           'box_loss': 0.1288756,
           'class_loss': 8.663664,
           'conf_loss': 18.8847,
           'precision50': 0.46649256,
           'recall50': 0.5578418},
     'global': {'total_loss': 119.16847},
     'learning_rate': 0.00261,
     'training_loss': 119.16847}
train | step:  100000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.70738024,
           'avg_obj': 0.24559376,
           'box_loss': 0.20228544,
           'class_loss': 9.343592,
           'conf_loss': 34.16928,
           'precision50': 0.25262648,
           'recall50': 0.14728652},
     '4': {'avg_iou': 0.78465915,
           'avg_obj': 0.3994749,
           'box_loss': 0.20900473,
           'class_loss': 11.612386,
           'conf_loss': 35.463604,
           'precision50': 0.38475665,
           'recall50': 0.34704518},
     '5': {'avg_iou': 0.8244093,
           'avg_obj': 0.54897535,
           'box_loss': 0.12777254,
           'class_loss': 8.5348015,
           'conf_loss': 18.695074,
           'precision50': 0.4664311,
           'recall50': 0.56377214},
     'global': {'total_loss': 118.35789},
     'learning_rate': 0.00261,
     'training_loss': 118.35789}
train | step:  105000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.7084517,
           'avg_obj': 0.24779433,
           'box_loss': 0.20198429,
           'class_loss': 9.214425,
           'conf_loss': 34.03799,
           'precision50': 0.25381556,
           'recall50': 0.14926368},
     '4': {'avg_iou': 0.7860153,
           'avg_obj': 0.4030264,
           'box_loss': 0.20821062,
           'class_loss': 11.421224,
           'conf_loss': 35.273808,
           'precision50': 0.38494483,
           'recall50': 0.35132396},
     '5': {'avg_iou': 0.8250595,
           'avg_obj': 0.5516568,
           'box_loss': 0.12732522,
           'class_loss': 8.413011,
           'conf_loss': 18.57335,
           'precision50': 0.46574223,
           'recall50': 0.56648314},
     'global': {'total_loss': 117.4713},
     'learning_rate': 0.00261,
     'training_loss': 117.4713}
saved checkpoint to gs://tensorflow2/config_testing/all-mean-og/ckpt-105000.
 eval | step:  105000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=178.42s).
Accumulating evaluation results...
DONE (t=13.74s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.378
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.597
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.415
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.149
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.341
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.484
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.309
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.514
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.563
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.315
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.550
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.659
 eval | step:  105000 | eval time:  526.7 sec | output: 
    {'3': {'avg_iou': 0.4498874,
           'avg_obj': 0.16774108,
           'box_loss': 0.1439528,
           'class_loss': 5.4106393,
           'conf_loss': 25.897942,
           'precision50': 0.20797175,
           'recall50': 0.15024635},
     '4': {'avg_iou': 0.6671217,
           'avg_obj': 0.37140527,
           'box_loss': 0.15595262,
           'class_loss': 6.507073,
           'conf_loss': 26.175928,
           'precision50': 0.3455827,
           'recall50': 0.36695346},
     '5': {'avg_iou': 0.8009906,
           'avg_obj': 0.5806889,
           'box_loss': 0.10008827,
           'class_loss': 4.40071,
           'conf_loss': 14.571036,
           'precision50': 0.4316421,
           'recall50': 0.59359634},
     'AP': 0.37849608,
     'AP50': 0.59652156,
     'AP75': 0.4147312,
     'APl': 0.48427105,
     'APm': 0.34051207,
     'APs': 0.14877522,
     'ARl': 0.65885264,
     'ARm': 0.5503116,
     'ARmax1': 0.3093303,
     'ARmax10': 0.5139792,
     'ARmax100': 0.56307566,
     'ARs': 0.31459802,
     'global': {'total_loss': 83.36339},
     'validation_loss': 83.36339}
train | step:  105000 | training until step 125000...
train | step:  110000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.7092058,
           'avg_obj': 0.2506216,
           'box_loss': 0.20102763,
           'class_loss': 9.070691,
           'conf_loss': 33.765842,
           'precision50': 0.2551571,
           'recall50': 0.15131995},
     '4': {'avg_iou': 0.7870014,
           'avg_obj': 0.40569994,
           'box_loss': 0.20614944,
           'class_loss': 11.211346,
           'conf_loss': 34.90602,
           'precision50': 0.38555375,
           'recall50': 0.35416827},
     '5': {'avg_iou': 0.826161,
           'avg_obj': 0.5556758,
           'box_loss': 0.12622857,
           'class_loss': 8.246293,
           'conf_loss': 18.361376,
           'precision50': 0.46582374,
           'recall50': 0.570984},
     'global': {'total_loss': 116.094765},
     'learning_rate': 0.00261,
     'training_loss': 116.094765}I0412 09:40:35.449527 140650773251904 controller.py:425] train | step:  115000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.7099177,
           'avg_obj': 0.2527176,
           'box_loss': 0.20137657,
           'class_loss': 9.003037,
           'conf_loss': 33.763767,
           'precision50': 0.25662374,
           'recall50': 0.15319934},
     '4': {'avg_iou': 0.7880572,
           'avg_obj': 0.40992853,
           'box_loss': 0.20645085,
           'class_loss': 11.116425,
           'conf_loss': 34.796223,
           'precision50': 0.38630766,
           'recall50': 0.35810846},
     '5': {'avg_iou': 0.8271134,
           'avg_obj': 0.55881035,
           'box_loss': 0.12591127,
           'class_loss': 8.164577,
           'conf_loss': 18.273897,
           'precision50': 0.46574628,
           'recall50': 0.5743204},
     'global': {'total_loss': 115.65161},
     'learning_rate': 0.00261,
     'training_loss': 115.65161}
I0412 10:11:52.539158 140650773251904 controller.py:425] train | step:  120000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.7110925,
           'avg_obj': 0.25522482,
           'box_loss': 0.19910191,
           'class_loss': 8.864754,
           'conf_loss': 33.39805,
           'precision50': 0.2574052,
           'recall50': 0.15489407},
     '4': {'avg_iou': 0.78927463,
           'avg_obj': 0.4133543,
           'box_loss': 0.20447333,
           'class_loss': 10.983764,
           'conf_loss': 34.497814,
           'precision50': 0.38595122,
           'recall50': 0.3616072},
     '5': {'avg_iou': 0.828121,
           'avg_obj': 0.56278634,
           'box_loss': 0.12500727,
           'class_loss': 8.046023,
           'conf_loss': 18.110632,
           'precision50': 0.4653727,
           'recall50': 0.5779928},
     'global': {'total_loss': 114.42981},
     'learning_rate': 0.00261,
     'training_loss': 114.42981}
I0412 10:43:12.260742 140650773251904 controller.py:425] train | step:  125000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.7114473,
           'avg_obj': 0.25754535,
           'box_loss': 0.1997021,
           'class_loss': 8.792832,
           'conf_loss': 33.383286,
           'precision50': 0.25872153,
           'recall50': 0.15703389},
     '4': {'avg_iou': 0.7902085,
           'avg_obj': 0.41587636,
           'box_loss': 0.20404914,
           'class_loss': 10.8619995,
           'conf_loss': 34.37263,
           'precision50': 0.38674566,
           'recall50': 0.3642377},
     '5': {'avg_iou': 0.8291617,
           'avg_obj': 0.5654206,
           'box_loss': 0.12447301,
           'class_loss': 7.9618526,
           'conf_loss': 17.999434,
           'precision50': 0.4660439,
           'recall50': 0.5806382},
     'global': {'total_loss': 113.900375},
     'learning_rate': 0.00261,
     'training_loss': 113.900375}
I0412 10:44:06.790019 140650773251904 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og/ckpt-125000.
I0412 10:44:06.796141 140650773251904 controller.py:252]  eval | step:  125000 | running 625 steps of evaluation...
I0412 10:48:44.247291 140650773251904 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0412 10:52:52.961249 140650773251904 controller.py:261]  eval | step:  125000 | eval time:  526.2 sec | output: 
    {'3': {'avg_iou': 0.45083165,
           'avg_obj': 0.1704645,
           'box_loss': 0.14288826,
           'class_loss': 5.2919197,
           'conf_loss': 25.741993,
           'precision50': 0.21002024,
           'recall50': 0.15446392},
     '4': {'avg_iou': 0.6690974,
           'avg_obj': 0.37796098,
           'box_loss': 0.15468775,
           'class_loss': 6.340896,
           'conf_loss': 26.041504,
           'precision50': 0.33883062,
           'recall50': 0.3749468},
     '5': {'avg_iou': 0.8036627,
           'avg_obj': 0.58892155,
           'box_loss': 0.098698094,
           'class_loss': 4.305519,
           'conf_loss': 14.451503,
           'precision50': 0.4257109,
           'recall50': 0.60102737},
     'AP': 0.38267678,
     'AP50': 0.60047394,
     'AP75': 0.41812056,
     'APl': 0.49098578,
     'APm': 0.34509912,
     'APs': 0.14775117,
     'ARl': 0.6641568,
     'ARm': 0.5556554,
     'ARmax1': 0.3107278,
     'ARmax10': 0.5203682,
     'ARmax100': 0.56807834,
     'ARs': 0.3152668,
     'global': {'total_loss': 82.56958},
     'validation_loss': 82.56958}
I0412 10:53:09.735035 140650773251904 controller.py:211] train | step:  125000 | training until step 145000...
I0412 11:24:21.323886 140650773251904 controller.py:425] train | step:  130000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.71240973,
           'avg_obj': 0.25854895,
           'box_loss': 0.19861005,
           'class_loss': 8.714666,
           'conf_loss': 33.21945,
           'precision50': 0.25937623,
           'recall50': 0.1580555},
     '4': {'avg_iou': 0.790965,
           'avg_obj': 0.41825303,
           'box_loss': 0.20335628,
           'class_loss': 10.730316,
           'conf_loss': 34.210697,
           'precision50': 0.38532653,
           'recall50': 0.3661503},
     '5': {'avg_iou': 0.82980764,
           'avg_obj': 0.5680293,
           'box_loss': 0.12396802,
           'class_loss': 7.8532915,
           'conf_loss': 17.880915,
           'precision50': 0.46383262,
           'recall50': 0.5835577},
     'global': {'total_loss': 113.13539},
     'learning_rate': 0.00261,
     'training_loss': 113.13539}
I0412 11:55:37.363717 140650773251904 controller.py:425] train | step:  135000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.71285844,
           'avg_obj': 0.2607575,
           'box_loss': 0.19840524,
           'class_loss': 8.583636,
           'conf_loss': 33.06759,
           'precision50': 0.25928304,
           'recall50': 0.15949604},
     '4': {'avg_iou': 0.79183525,
           'avg_obj': 0.4211432,
           'box_loss': 0.20187432,
           'class_loss': 10.588417,
           'conf_loss': 33.880505,
           'precision50': 0.38674003,
           'recall50': 0.3696484},
     '5': {'avg_iou': 0.8307974,
           'avg_obj': 0.5707542,
           'box_loss': 0.12296935,
           'class_loss': 7.7271843,
           'conf_loss': 17.72253,
           'precision50': 0.46465275,
           'recall50': 0.58671474},
     'global': {'total_loss': 112.093185},
     'learning_rate': 0.00261,
     'training_loss': 112.093185}
I0412 12:26:58.924476 140650773251904 controller.py:425] train | step:  140000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.71391875,
           'avg_obj': 0.26315,
           'box_loss': 0.19725837,
           'class_loss': 8.511705,
           'conf_loss': 32.891567,
           'precision50': 0.2607018,
           'recall50': 0.16111329},
     '4': {'avg_iou': 0.7927433,
           'avg_obj': 0.4241844,
           'box_loss': 0.20135728,
           'class_loss': 10.467938,
           'conf_loss': 33.75966,
           'precision50': 0.38565013,
           'recall50': 0.372442},
     '5': {'avg_iou': 0.8314189,
           'avg_obj': 0.57303274,
           'box_loss': 0.12268185,
           'class_loss': 7.673401,
           'conf_loss': 17.652035,
           'precision50': 0.46414903,
           'recall50': 0.5889308},
     'global': {'total_loss': 111.47764},
     'learning_rate': 0.00261,
     'training_loss': 111.47764}
I0412 12:58:52.518941 140650773251904 controller.py:425] train | step:  145000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.71461976,
           'avg_obj': 0.264894,
           'box_loss': 0.19715698,
           'class_loss': 8.439567,
           'conf_loss': 32.802727,
           'precision50': 0.26189795,
           'recall50': 0.16264199},
     '4': {'avg_iou': 0.7932002,
           'avg_obj': 0.42632958,
           'box_loss': 0.20107469,
           'class_loss': 10.37685,
           'conf_loss': 33.626568,
           'precision50': 0.38719732,
           'recall50': 0.37541407},
     '5': {'avg_iou': 0.8320993,
           'avg_obj': 0.57612747,
           'box_loss': 0.12221654,
           'class_loss': 7.567399,
           'conf_loss': 17.531164,
           'precision50': 0.46427235,
           'recall50': 0.59234697},
     'global': {'total_loss': 110.86464},
     'learning_rate': 0.00261,
     'training_loss': 110.86464}

train | step:  115000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.7099177,
           'avg_obj': 0.2527176,
           'box_loss': 0.20137657,
           'class_loss': 9.003037,
           'conf_loss': 33.763767,
           'precision50': 0.25662374,
           'recall50': 0.15319934},
     '4': {'avg_iou': 0.7880572,
           'avg_obj': 0.40992853,
           'box_loss': 0.20645085,
           'class_loss': 11.116425,
           'conf_loss': 34.796223,
           'precision50': 0.38630766,
           'recall50': 0.35810846},
     '5': {'avg_iou': 0.8271134,
           'avg_obj': 0.55881035,
           'box_loss': 0.12591127,
           'class_loss': 8.164577,
           'conf_loss': 18.273897,
           'precision50': 0.46574628,
           'recall50': 0.5743204},
     'global': {'total_loss': 115.65161},
     'learning_rate': 0.00261,
     'training_loss': 115.65161}
train | step:  120000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.7110925,
           'avg_obj': 0.25522482,
           'box_loss': 0.19910191,
           'class_loss': 8.864754,
           'conf_loss': 33.39805,
           'precision50': 0.2574052,
           'recall50': 0.15489407},
     '4': {'avg_iou': 0.78927463,
           'avg_obj': 0.4133543,
           'box_loss': 0.20447333,
           'class_loss': 10.983764,
           'conf_loss': 34.497814,
           'precision50': 0.38595122,
           'recall50': 0.3616072},
     '5': {'avg_iou': 0.828121,
           'avg_obj': 0.56278634,
           'box_loss': 0.12500727,
           'class_loss': 8.046023,
           'conf_loss': 18.110632,
           'precision50': 0.4653727,
           'recall50': 0.5779928},
     'global': {'total_loss': 114.42981},
     'learning_rate': 0.00261,
     'training_loss': 114.42981}
train | step:  125000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.7114473,
           'avg_obj': 0.25754535,
           'box_loss': 0.1997021,
           'class_loss': 8.792832,
           'conf_loss': 33.383286,
           'precision50': 0.25872153,
           'recall50': 0.15703389},
     '4': {'avg_iou': 0.7902085,
           'avg_obj': 0.41587636,
           'box_loss': 0.20404914,
           'class_loss': 10.8619995,
           'conf_loss': 34.37263,
           'precision50': 0.38674566,
           'recall50': 0.3642377},
     '5': {'avg_iou': 0.8291617,
           'avg_obj': 0.5654206,
           'box_loss': 0.12447301,
           'class_loss': 7.9618526,
           'conf_loss': 17.999434,
           'precision50': 0.4660439,
           'recall50': 0.5806382},
     'global': {'total_loss': 113.900375},
     'learning_rate': 0.00261,
     'training_loss': 113.900375}
saved checkpoint to gs://tensorflow2/config_testing/all-mean-og/ckpt-125000.
 eval | step:  125000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=177.38s).
Accumulating evaluation results...
DONE (t=13.59s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.383
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.600
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.418
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.148
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.345
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.311
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.520
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.568
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.315
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.556
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.664
 eval | step:  125000 | eval time:  526.2 sec | output: 
    {'3': {'avg_iou': 0.45083165,
           'avg_obj': 0.1704645,
           'box_loss': 0.14288826,
           'class_loss': 5.2919197,
           'conf_loss': 25.741993,
           'precision50': 0.21002024,
           'recall50': 0.15446392},
     '4': {'avg_iou': 0.6690974,
           'avg_obj': 0.37796098,
           'box_loss': 0.15468775,
           'class_loss': 6.340896,
           'conf_loss': 26.041504,
           'precision50': 0.33883062,
           'recall50': 0.3749468},
     '5': {'avg_iou': 0.8036627,
           'avg_obj': 0.58892155,
           'box_loss': 0.098698094,
           'class_loss': 4.305519,
           'conf_loss': 14.451503,
           'precision50': 0.4257109,
           'recall50': 0.60102737},
     'AP': 0.38267678,
     'AP50': 0.60047394,
     'AP75': 0.41812056,
     'APl': 0.49098578,
     'APm': 0.34509912,
     'APs': 0.14775117,
     'ARl': 0.6641568,
     'ARm': 0.5556554,
     'ARmax1': 0.3107278,
     'ARmax10': 0.5203682,
     'ARmax100': 0.56807834,
     'ARs': 0.3152668,
     'global': {'total_loss': 82.56958},
     'validation_loss': 82.56958}
train | step:  125000 | training until step 145000...
train | step:  130000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.71240973,
           'avg_obj': 0.25854895,
           'box_loss': 0.19861005,
           'class_loss': 8.714666,
           'conf_loss': 33.21945,
           'precision50': 0.25937623,
           'recall50': 0.1580555},
     '4': {'avg_iou': 0.790965,
           'avg_obj': 0.41825303,
           'box_loss': 0.20335628,
           'class_loss': 10.730316,
           'conf_loss': 34.210697,
           'precision50': 0.38532653,
           'recall50': 0.3661503},
     '5': {'avg_iou': 0.82980764,
           'avg_obj': 0.5680293,
           'box_loss': 0.12396802,
           'class_loss': 7.8532915,
           'conf_loss': 17.880915,
           'precision50': 0.46383262,
           'recall50': 0.5835577},
     'global': {'total_loss': 113.13539},
     'learning_rate': 0.00261,
     'training_loss': 113.13539}
train | step:  135000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.71285844,
           'avg_obj': 0.2607575,
           'box_loss': 0.19840524,
           'class_loss': 8.583636,
           'conf_loss': 33.06759,
           'precision50': 0.25928304,
           'recall50': 0.15949604},
     '4': {'avg_iou': 0.79183525,
           'avg_obj': 0.4211432,
           'box_loss': 0.20187432,
           'class_loss': 10.588417,
           'conf_loss': 33.880505,
           'precision50': 0.38674003,
           'recall50': 0.3696484},
     '5': {'avg_iou': 0.8307974,
           'avg_obj': 0.5707542,
           'box_loss': 0.12296935,
           'class_loss': 7.7271843,
           'conf_loss': 17.72253,
           'precision50': 0.46465275,
           'recall50': 0.58671474},
     'global': {'total_loss': 112.093185},
     'learning_rate': 0.00261,
     'training_loss': 112.093185}
train | step:  140000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.71391875,
           'avg_obj': 0.26315,
           'box_loss': 0.19725837,
           'class_loss': 8.511705,
           'conf_loss': 32.891567,
           'precision50': 0.2607018,
           'recall50': 0.16111329},
     '4': {'avg_iou': 0.7927433,
           'avg_obj': 0.4241844,
           'box_loss': 0.20135728,
           'class_loss': 10.467938,
           'conf_loss': 33.75966,
           'precision50': 0.38565013,
           'recall50': 0.372442},
     '5': {'avg_iou': 0.8314189,
           'avg_obj': 0.57303274,
           'box_loss': 0.12268185,
           'class_loss': 7.673401,
           'conf_loss': 17.652035,
           'precision50': 0.46414903,
           'recall50': 0.5889308},
     'global': {'total_loss': 111.47764},
     'learning_rate': 0.00261,
     'training_loss': 111.47764}
train | step:  145000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.71461976,
           'avg_obj': 0.264894,
           'box_loss': 0.19715698,
           'class_loss': 8.439567,
           'conf_loss': 32.802727,
           'precision50': 0.26189795,
           'recall50': 0.16264199},
     '4': {'avg_iou': 0.7932002,
           'avg_obj': 0.42632958,
           'box_loss': 0.20107469,
           'class_loss': 10.37685,
           'conf_loss': 33.626568,
           'precision50': 0.38719732,
           'recall50': 0.37541407},
     '5': {'avg_iou': 0.8320993,
           'avg_obj': 0.57612747,
           'box_loss': 0.12221654,
           'class_loss': 7.567399,
           'conf_loss': 17.531164,
           'precision50': 0.46427235,
           'recall50': 0.59234697},
     'global': {'total_loss': 110.86464},
     'learning_rate': 0.00261,
     'training_loss': 110.86464}I0412 12:59:43.871683 140650773251904 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og/ckpt-145000.
I0412 12:59:43.877827 140650773251904 controller.py:252]  eval | step:  145000 | running 625 steps of evaluation...
I0412 13:04:29.501992 140650773251904 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0412 13:08:38.232091 140650773251904 controller.py:261]  eval | step:  145000 | eval time:  534.4 sec | output: 
    {'3': {'avg_iou': 0.451838,
           'avg_obj': 0.17435098,
           'box_loss': 0.14226471,
           'class_loss': 5.2609363,
           'conf_loss': 25.692385,
           'precision50': 0.20872562,
           'recall50': 0.15759842},
     '4': {'avg_iou': 0.67096627,
           'avg_obj': 0.38409534,
           'box_loss': 0.15307197,
           'class_loss': 6.3231025,
           'conf_loss': 26.008156,
           'precision50': 0.33820704,
           'recall50': 0.38055077},
     '5': {'avg_iou': 0.8056352,
           'avg_obj': 0.59528935,
           'box_loss': 0.097636186,
           'class_loss': 4.243556,
           'conf_loss': 14.40225,
           'precision50': 0.425612,
           'recall50': 0.6067037},
     'AP': 0.38689387,
     'AP50': 0.6055531,
     'AP75': 0.422546,
     'APl': 0.49734074,
     'APm': 0.34715295,
     'APs': 0.14964983,
     'ARl': 0.66839,
     'ARm': 0.5559743,
     'ARmax1': 0.31322384,
     'ARmax10': 0.5239262,
     'ARmax100': 0.5709189,
     'ARs': 0.32371962,
     'global': {'total_loss': 82.323326},
     'validation_loss': 82.323326}
I0412 13:09:02.466031 140650773251904 controller.py:211] train | step:  145000 | training until step 165000...
I0412 14:05:04.029792 140650773251904 controller.py:425] train | step:  150000 | steps/sec:    1.3 | output: 
    {'3': {'avg_iou': 0.7153086,
           'avg_obj': 0.26676178,
           'box_loss': 0.19642825,
           'class_loss': 8.325245,
           'conf_loss': 32.61415,
           'precision50': 0.26238725,
           'recall50': 0.16420661},
     '4': {'avg_iou': 0.7939019,
           'avg_obj': 0.42914486,
           'box_loss': 0.19994405,
           'class_loss': 10.228833,
           'conf_loss': 33.379883,
           'precision50': 0.3868761,
           'recall50': 0.37696552},
     '5': {'avg_iou': 0.83269435,
           'avg_obj': 0.57859236,
           'box_loss': 0.12163576,
           'class_loss': 7.504174,
           'conf_loss': 17.408182,
           'precision50': 0.46414638,
           'recall50': 0.5942694},
     'global': {'total_loss': 109.978516},
     'learning_rate': 0.00261,
     'training_loss': 109.978516}
I0412 15:20:08.718568 140650773251904 controller.py:425] train | step:  155000 | steps/sec:    1.1 | output: 
    {'3': {'avg_iou': 0.71572787,
           'avg_obj': 0.26844153,
           'box_loss': 0.19651522,
           'class_loss': 8.301852,
           'conf_loss': 32.55824,
           'precision50': 0.26342636,
           'recall50': 0.166232},
     '4': {'avg_iou': 0.794795,
           'avg_obj': 0.43205878,
           'box_loss': 0.19881544,
           'class_loss': 10.124241,
           'conf_loss': 33.13272,
           'precision50': 0.38609862,
           'recall50': 0.38023555},
     '5': {'avg_iou': 0.8334212,
           'avg_obj': 0.5807395,
           'box_loss': 0.12092777,
           'class_loss': 7.386005,
           'conf_loss': 17.2797,
           'precision50': 0.46303755,
           'recall50': 0.59679586},
     'global': {'total_loss': 109.29909},
     'learning_rate': 0.00261,
     'training_loss': 109.29909}
I0412 16:38:15.021281 140650773251904 controller.py:425] train | step:  160000 | steps/sec:    1.1 | output: 
    {'3': {'avg_iou': 0.71627253,
           'avg_obj': 0.27033693,
           'box_loss': 0.19627362,
           'class_loss': 8.213874,
           'conf_loss': 32.485504,
           'precision50': 0.2645668,
           'recall50': 0.16792229},
     '4': {'avg_iou': 0.7952615,
           'avg_obj': 0.4337978,
           'box_loss': 0.19875339,
           'class_loss': 10.059032,
           'conf_loss': 33.068214,
           'precision50': 0.38709852,
           'recall50': 0.3823748},
     '5': {'avg_iou': 0.8340714,
           'avg_obj': 0.5824203,
           'box_loss': 0.12067052,
           'class_loss': 7.3253,
           'conf_loss': 17.222902,
           'precision50': 0.46344507,
           'recall50': 0.5991439},
     'global': {'total_loss': 108.8906},
     'learning_rate': 0.00261,
     'training_loss': 108.8906}
I0412 17:53:12.152978 140650773251904 controller.py:425] train | step:  165000 | steps/sec:    1.1 | output: 
    {'3': {'avg_iou': 0.716757,
           'avg_obj': 0.27183998,
           'box_loss': 0.19590648,
           'class_loss': 8.169877,
           'conf_loss': 32.374557,
           'precision50': 0.2644688,
           'recall50': 0.16867863},
     '4': {'avg_iou': 0.7960922,
           'avg_obj': 0.4363277,
           'box_loss': 0.19840838,
           'class_loss': 9.97477,
           'conf_loss': 32.978645,
           'precision50': 0.38727042,
           'recall50': 0.38468575},
     '5': {'avg_iou': 0.8345742,
           'avg_obj': 0.5850683,
           'box_loss': 0.12040646,
           'class_loss': 7.2434196,
           'conf_loss': 17.139277,
           'precision50': 0.46288955,
           'recall50': 0.60216755},
     'global': {'total_loss': 108.39546},
     'learning_rate': 0.00261,
     'training_loss': 108.39546}
I0412 17:54:03.481763 140650773251904 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og/ckpt-165000.
I0412 17:54:03.489960 140650773251904 controller.py:252]  eval | step:  165000 | running 625 steps of evaluation...
I0412 18:00:12.906404 140650773251904 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0412 18:04:19.282130 140650773251904 controller.py:261]  eval | step:  165000 | eval time:  615.8 sec | output: 
    {'3': {'avg_iou': 0.45252398,
           'avg_obj': 0.1762981,
           'box_loss': 0.14158739,
           'class_loss': 5.1760454,
           'conf_loss': 25.691666,
           'precision50': 0.20944092,
           'recall50': 0.16164789},
     '4': {'avg_iou': 0.6716559,
           'avg_obj': 0.38695583,
           'box_loss': 0.15261331,
           'class_loss': 6.2252717,
           'conf_loss': 26.091578,
           'precision50': 0.3342898,
           'recall50': 0.38365173},
     '5': {'avg_iou': 0.80637395,
           'avg_obj': 0.5998243,
           'box_loss': 0.0972095,
           'class_loss': 4.2286983,
           'conf_loss': 14.433828,
           'precision50': 0.42141294,
           'recall50': 0.6117585},
     'AP': 0.38944134,
     'AP50': 0.606439,
     'AP75': 0.42559323,
     'APl': 0.49793556,
     'APm': 0.3537824,
     'APs': 0.15613446,
     'ARl': 0.66543597,
     'ARm': 0.56140816,
     'ARmax1': 0.3163642,
     'ARmax10': 0.52545404,
     'ARmax100': 0.5727116,
     'ARs': 0.32800844,
     'global': {'total_loss': 82.23844},
     'validation_loss': 82.23844}

saved checkpoint to gs://tensorflow2/config_testing/all-mean-og/ckpt-145000.
 eval | step:  145000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=178.85s).
Accumulating evaluation results...
DONE (t=13.37s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.387
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.606
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.423
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.150
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.347
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.497
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.313
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.524
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.571
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.324
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.556
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.668
 eval | step:  145000 | eval time:  534.4 sec | output: 
    {'3': {'avg_iou': 0.451838,
           'avg_obj': 0.17435098,
           'box_loss': 0.14226471,
           'class_loss': 5.2609363,
           'conf_loss': 25.692385,
           'precision50': 0.20872562,
           'recall50': 0.15759842},
     '4': {'avg_iou': 0.67096627,
           'avg_obj': 0.38409534,
           'box_loss': 0.15307197,
           'class_loss': 6.3231025,
           'conf_loss': 26.008156,
           'precision50': 0.33820704,
           'recall50': 0.38055077},
     '5': {'avg_iou': 0.8056352,
           'avg_obj': 0.59528935,
           'box_loss': 0.097636186,
           'class_loss': 4.243556,
           'conf_loss': 14.40225,
           'precision50': 0.425612,
           'recall50': 0.6067037},
     'AP': 0.38689387,
     'AP50': 0.6055531,
     'AP75': 0.422546,
     'APl': 0.49734074,
     'APm': 0.34715295,
     'APs': 0.14964983,
     'ARl': 0.66839,
     'ARm': 0.5559743,
     'ARmax1': 0.31322384,
     'ARmax10': 0.5239262,
     'ARmax100': 0.5709189,
     'ARs': 0.32371962,
     'global': {'total_loss': 82.323326},
     'validation_loss': 82.323326}
train | step:  145000 | training until step 165000...
train | step:  150000 | steps/sec:    1.3 | output: 
    {'3': {'avg_iou': 0.7153086,
           'avg_obj': 0.26676178,
           'box_loss': 0.19642825,
           'class_loss': 8.325245,
           'conf_loss': 32.61415,
           'precision50': 0.26238725,
           'recall50': 0.16420661},
     '4': {'avg_iou': 0.7939019,
           'avg_obj': 0.42914486,
           'box_loss': 0.19994405,
           'class_loss': 10.228833,
           'conf_loss': 33.379883,
           'precision50': 0.3868761,
           'recall50': 0.37696552},
     '5': {'avg_iou': 0.83269435,
           'avg_obj': 0.57859236,
           'box_loss': 0.12163576,
           'class_loss': 7.504174,
           'conf_loss': 17.408182,
           'precision50': 0.46414638,
           'recall50': 0.5942694},
     'global': {'total_loss': 109.978516},
     'learning_rate': 0.00261,
     'training_loss': 109.978516}
train | step:  155000 | steps/sec:    1.1 | output: 
    {'3': {'avg_iou': 0.71572787,
           'avg_obj': 0.26844153,
           'box_loss': 0.19651522,
           'class_loss': 8.301852,
           'conf_loss': 32.55824,
           'precision50': 0.26342636,
           'recall50': 0.166232},
     '4': {'avg_iou': 0.794795,
           'avg_obj': 0.43205878,
           'box_loss': 0.19881544,
           'class_loss': 10.124241,
           'conf_loss': 33.13272,
           'precision50': 0.38609862,
           'recall50': 0.38023555},
     '5': {'avg_iou': 0.8334212,
           'avg_obj': 0.5807395,
           'box_loss': 0.12092777,
           'class_loss': 7.386005,
           'conf_loss': 17.2797,
           'precision50': 0.46303755,
           'recall50': 0.59679586},
     'global': {'total_loss': 109.29909},
     'learning_rate': 0.00261,
     'training_loss': 109.29909}
train | step:  160000 | steps/sec:    1.1 | output: 
    {'3': {'avg_iou': 0.71627253,
           'avg_obj': 0.27033693,
           'box_loss': 0.19627362,
           'class_loss': 8.213874,
           'conf_loss': 32.485504,
           'precision50': 0.2645668,
           'recall50': 0.16792229},
     '4': {'avg_iou': 0.7952615,
           'avg_obj': 0.4337978,
           'box_loss': 0.19875339,
           'class_loss': 10.059032,
           'conf_loss': 33.068214,
           'precision50': 0.38709852,
           'recall50': 0.3823748},
     '5': {'avg_iou': 0.8340714,
           'avg_obj': 0.5824203,
           'box_loss': 0.12067052,
           'class_loss': 7.3253,
           'conf_loss': 17.222902,
           'precision50': 0.46344507,
           'recall50': 0.5991439},
     'global': {'total_loss': 108.8906},
     'learning_rate': 0.00261,
     'training_loss': 108.8906}
train | step:  165000 | steps/sec:    1.1 | output: 
    {'3': {'avg_iou': 0.716757,
           'avg_obj': 0.27183998,
           'box_loss': 0.19590648,
           'class_loss': 8.169877,
           'conf_loss': 32.374557,
           'precision50': 0.2644688,
           'recall50': 0.16867863},
     '4': {'avg_iou': 0.7960922,
           'avg_obj': 0.4363277,
           'box_loss': 0.19840838,
           'class_loss': 9.97477,
           'conf_loss': 32.978645,
           'precision50': 0.38727042,
           'recall50': 0.38468575},
     '5': {'avg_iou': 0.8345742,
           'avg_obj': 0.5850683,
           'box_loss': 0.12040646,
           'class_loss': 7.2434196,
           'conf_loss': 17.139277,
           'precision50': 0.46288955,
           'recall50': 0.60216755},
     'global': {'total_loss': 108.39546},
     'learning_rate': 0.00261,
     'training_loss': 108.39546}
saved checkpoint to gs://tensorflow2/config_testing/all-mean-og/ckpt-165000.
 eval | step:  165000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=175.73s).
Accumulating evaluation results...
DONE (t=13.03s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.389
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.606
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.426
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.156
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.354
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.498
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.316
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.525
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.573
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.328
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.561
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.665
 eval | step:  165000 | eval time:  615.8 sec | output: 
    {'3': {'avg_iou': 0.45252398,
           'avg_obj': 0.1762981,
           'box_loss': 0.14158739,
           'class_loss': 5.1760454,
           'conf_loss': 25.691666,
           'precision50': 0.20944092,
           'recall50': 0.16164789},
     '4': {'avg_iou': 0.6716559,
           'avg_obj': 0.38695583,
           'box_loss': 0.15261331,
           'class_loss': 6.2252717,
           'conf_loss': 26.091578,
           'precision50': 0.3342898,
           'recall50': 0.38365173},
     '5': {'avg_iou': 0.80637395,
           'avg_obj': 0.5998243,
           'box_loss': 0.0972095,
           'class_loss': 4.2286983,
           'conf_loss': 14.433828,
           'precision50': 0.42141294,
           'recall50': 0.6117585},
     'AP': 0.38944134,
     'AP50': 0.606439,
     'AP75': 0.42559323,
     'APl': 0.49793556,
     'APm': 0.3537824,
     'APs': 0.15613446,
     'ARl': 0.66543597,
     'ARm': 0.56140816,
     'ARmax1': 0.3163642,
     'ARmax10': 0.52545404,
     'ARmax100': 0.5727116,
     'ARs': 0.32800844,
     'global': {'total_loss': 82.23844},
     'validation_loss': 82.23844}I0412 18:04:39.934933 140650773251904 controller.py:211] train | step:  165000 | training until step 185000...
I0412 18:58:36.589511 140650773251904 controller.py:425] train | step:  170000 | steps/sec:    1.3 | output: 
    {'3': {'avg_iou': 0.7170932,
           'avg_obj': 0.27363566,
           'box_loss': 0.19586924,
           'class_loss': 8.105625,
           'conf_loss': 32.278824,
           'precision50': 0.26569074,
           'recall50': 0.17016938},
     '4': {'avg_iou': 0.79694366,
           'avg_obj': 0.43961596,
           'box_loss': 0.19731304,
           'class_loss': 9.874687,
           'conf_loss': 32.72792,
           'precision50': 0.38679615,
           'recall50': 0.38785973},
     '5': {'avg_iou': 0.83567256,
           'avg_obj': 0.5878836,
           'box_loss': 0.119672805,
           'class_loss': 7.21465,
           'conf_loss': 17.013103,
           'precision50': 0.46300277,
           'recall50': 0.6045148},
     'global': {'total_loss': 107.72764},
     'learning_rate': 0.00261,
     'training_loss': 107.72764}
I0412 20:14:32.482492 140650773251904 controller.py:425] train | step:  175000 | steps/sec:    1.1 | output: 
    {'3': {'avg_iou': 0.7177503,
           'avg_obj': 0.275334,
           'box_loss': 0.19445744,
           'class_loss': 8.0005665,
           'conf_loss': 32.047962,
           'precision50': 0.2657493,
           'recall50': 0.17128083},
     '4': {'avg_iou': 0.7975946,
           'avg_obj': 0.44142714,
           'box_loss': 0.19626401,
           'class_loss': 9.799804,
           'conf_loss': 32.550922,
           'precision50': 0.38666847,
           'recall50': 0.38914236},
     '5': {'avg_iou': 0.8362047,
           'avg_obj': 0.5903054,
           'box_loss': 0.11902732,
           'class_loss': 7.1457467,
           'conf_loss': 16.90419,
           'precision50': 0.46265596,
           'recall50': 0.60723174},
     'global': {'total_loss': 106.9588},
     'learning_rate': 0.00261,
     'training_loss': 106.9588}
I0412 21:30:00.598876 140650773251904 controller.py:425] train | step:  180000 | steps/sec:    1.1 | output: 
    {'3': {'avg_iou': 0.71834993,
           'avg_obj': 0.2766631,
           'box_loss': 0.19462943,
           'class_loss': 7.989736,
           'conf_loss': 32.05124,
           'precision50': 0.26696163,
           'recall50': 0.17266189},
     '4': {'avg_iou': 0.797804,
           'avg_obj': 0.4434952,
           'box_loss': 0.19662593,
           'class_loss': 9.755266,
           'conf_loss': 32.490208,
           'precision50': 0.38692433,
           'recall50': 0.3904078},
     '5': {'avg_iou': 0.8364778,
           'avg_obj': 0.59197825,
           'box_loss': 0.11900526,
           'class_loss': 7.0895233,
           'conf_loss': 16.84063,
           'precision50': 0.46122998,
           'recall50': 0.6083053},
     'global': {'total_loss': 106.72695},
     'learning_rate': 0.00261,
     'training_loss': 106.72695}
I0412 22:45:53.674914 140650773251904 controller.py:425] train | step:  185000 | steps/sec:    1.1 | output: 
    {'3': {'avg_iou': 0.71841437,
           'avg_obj': 0.27864796,
           'box_loss': 0.19445232,
           'class_loss': 7.941243,
           'conf_loss': 31.907482,
           'precision50': 0.26719773,
           'recall50': 0.17316854},
     '4': {'avg_iou': 0.79851204,
           'avg_obj': 0.44555748,
           'box_loss': 0.19570309,
           'class_loss': 9.667766,
           'conf_loss': 32.32045,
           'precision50': 0.38623604,
           'recall50': 0.39341053},
     '5': {'avg_iou': 0.8370277,
           'avg_obj': 0.5942905,
           'box_loss': 0.118645534,
           'class_loss': 7.01806,
           'conf_loss': 16.745977,
           'precision50': 0.4603125,
           'recall50': 0.6107851},
     'global': {'total_loss': 106.109924},
     'learning_rate': 0.00261,
     'training_loss': 106.109924}
I0412 22:46:46.182188 140650773251904 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og/ckpt-185000.
I0412 22:46:46.188400 140650773251904 controller.py:252]  eval | step:  185000 | running 625 steps of evaluation...
I0412 22:52:21.610290 140650773251904 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0412 22:56:35.989665 140650773251904 controller.py:261]  eval | step:  185000 | eval time:  589.8 sec | output: 
    {'3': {'avg_iou': 0.45308927,
           'avg_obj': 0.18024883,
           'box_loss': 0.1408939,
           'class_loss': 5.242897,
           'conf_loss': 25.627108,
           'precision50': 0.20903154,
           'recall50': 0.16525339},
     '4': {'avg_iou': 0.6727901,
           'avg_obj': 0.3932099,
           'box_loss': 0.15163027,
           'class_loss': 6.2489552,
           'conf_loss': 26.116331,
           'precision50': 0.33773482,
           'recall50': 0.39317796},
     '5': {'avg_iou': 0.8077581,
           'avg_obj': 0.6050715,
           'box_loss': 0.09638765,
           'class_loss': 4.2237787,
           'conf_loss': 14.484503,
           'precision50': 0.41574863,
           'recall50': 0.6143869},
     'AP': 0.39333767,
     'AP50': 0.6100668,
     'AP75': 0.42893648,
     'APl': 0.50179553,
     'APm': 0.35945368,
     'APs': 0.15362565,
     'ARl': 0.6741031,
     'ARm': 0.5592341,
     'ARmax1': 0.31879106,
     'ARmax10': 0.5290605,
     'ARmax100': 0.57566625,
     'ARs': 0.31934696,
     'global': {'total_loss': 82.3325},
     'validation_loss': 82.3325}
I0412 22:56:54.789580 140650773251904 controller.py:211] train | step:  185000 | training until step 205000...
I0413 00:06:53.161963 140650773251904 controller.py:425] train | step:  190000 | steps/sec:    1.0 | output: 
    {'3': {'avg_iou': 0.7190803,
           'avg_obj': 0.27996266,
           'box_loss': 0.19413146,
           'class_loss': 7.883619,
           'conf_loss': 31.824821,
           'precision50': 0.26769054,
           'recall50': 0.17531228},
     '4': {'avg_iou': 0.7989374,
           'avg_obj': 0.44821763,
           'box_loss': 0.19540462,
           'class_loss': 9.580187,
           'conf_loss': 32.169888,
           'precision50': 0.38646182,
           'recall50': 0.39570376},
     '5': {'avg_iou': 0.837413,
           'avg_obj': 0.59643614,
           'box_loss': 0.118196085,
           'class_loss': 6.938266,
           'conf_loss': 16.634666,
           'precision50': 0.46072525,
           'recall50': 0.6131774},
     'global': {'total_loss': 105.539116},
     'learning_rate': 0.00261,
     'training_loss': 105.539116}
/home/cam2tensorflow/.experiment_start.sh: line 22:  4148 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   212    0     2  100   210     10   1050 --:--:-- --:--:-- --:--:--  1060
okRequest issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-13T00:47:40.683010070Z'
  endTime: '2021-04-13T00:48:19.136775816Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618274860673-5bfcffa382934-e7d4db5b-189322d2
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618274860673-5bfcffa382934-e7d4db5b-189322d2] to complete...
...........................................................................................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-13T00:49:42.413659877Z'
  endTime: '2021-04-13T00:50:21.280966284Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618274982401-5bfd001799470-b3edc69e-4c0ef002
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618274982401-5bfd001799470-b3edc69e-4c0ef002] to complete...
...................................................................................................................................................................................................................................................................................done.
europe-west4-a
I0413 00:49:38.534023 139857494054720 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.075,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.2,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 0.6,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.05,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.2,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.667,
                                                    'output_size': [640, 640],
                                                    'random_crop': True,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [200000,
                                                                                250000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00261,
                                                                            0.000261,
                                                                            2.61e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0413 00:49:38.537925 139857494054720 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_testing/all-mean-og/params.yaml
I0413 00:49:40.347641 139857494054720 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 00:49:40.975766 139857494054720 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0413 00:49:40.976039 139857494054720 transport.py:157] Attempting refresh to obtain initial access_token
I0413 00:49:41.031834 139857494054720 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 00:49:41.169033 139857494054720 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0413 00:49:41.169281 139857494054720 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-13 00:49:41.224531: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0413 00:49:41.225236 139857494054720 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 00:49:41.846352 139857494054720 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0413 00:49:41.846766 139857494054720 transport.py:157] Attempting refresh to obtain initial access_token
I0413 00:49:41.980200 139857494054720 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 00:49:42.611547 139857494054720 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0413 00:49:42.611915 139857494054720 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-13 00:49:42.654646: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-13 00:49:42.680654: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-13 00:49:42.680734: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:57628}
2021-04-13 00:49:58.162152: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-13 00:49:58.162283: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:57628}
2021-04-13 00:49:58.163214: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:57628
I0413 00:49:58.164556 139857494054720 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-6
I0413 00:49:58.165297 139857494054720 tpu_strategy_util.py:74] Initializing the TPU system: node-6
INFO:tensorflow:Clearing out eager caches
I0413 00:50:06.295976 139857494054720 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0413 00:50:06.298418 139857494054720 tpu_strategy_util.py:133] Finished initializing TPU system.
I0413 00:50:06.299992 139857494054720 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 00:50:06.921464 139857494054720 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0413 00:50:06.921754 139857494054720 transport.py:157] Attempting refresh to obtain initial access_token
I0413 00:50:06.964477 139857494054720 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 00:50:07.104912 139857494054720 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0413 00:50:07.105184 139857494054720 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0413 00:50:07.148630 139857494054720 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0413 00:50:07.149179 139857494054720 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0413 00:50:07.149644 139857494054720 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0413 00:50:07.149877 139857494054720 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0413 00:50:07.150103 139857494054720 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0413 00:50:07.150449 139857494054720 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0413 00:50:07.150731 139857494054720 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0413 00:50:07.150954 139857494054720 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0413 00:50:07.151170 139857494054720 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0413 00:50:07.151388 139857494054720 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0413 00:50:07.151582 139857494054720 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0413 00:50:07.151804 139857494054720 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0413 00:50:07.152047 139857494054720 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0413 00:50:07.152265 139857494054720 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0413 00:50:07.152479 139857494054720 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0413 00:50:07.152694 139857494054720 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0413 00:50:07.177346 139857494054720 train_utils.py:214] Running default trainer.
2021-04-13 00:50:07.196192: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.05, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.6, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.667, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [200000, 250000], 'values': [0.00261, 0.000261, 2.61e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05} 0.00025
{'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f32b7ed8198>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
conv1 512.0
conv2 1024.0
conv1 512.0
spp
conv1 512.0
conv2 1024.0
conv1 512.0
7
conv1 512.0
conv2 256.0
conv1 512.0
conv2 256.0
4








 ListWrapper([256, 512, 1024])
conv1 128
conv2 256
conv1 128
conv2 256
conv1 128
conv2 256
6
conv1 256
conv2 512
conv1 256
conv2 512
conv1 256
conv2 512
6
conv1 512
conv2 1024
conv1 512
conv2 1024
conv1 512
conv2 1024
6
detget {'3': 1.2, '4': 1.1, '5': 1.05}
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 80, 80, 256) 37319168  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 64,488,640
Trainable params: 64,422,336
Non-trainable params: 66,304
_________________________________________________________________I0413 00:50:55.908363 139857494054720 controller.py:362] restoring or initializing model...
I0413 00:51:24.452236 139857494054720 controller.py:366] restored model from gs://tensorflow2/config_testing/all-mean-og/ckpt-185000.
I0413 00:51:24.452613 139857494054720 controller.py:192] restored from checkpoint: gs://tensorflow2/config_testing/all-mean-og/ckpt-185000
I0413 00:51:24.452697 139857494054720 train_lib.py:96] Starts to execute mode: train_and_eval
I0413 00:51:24.456879 139857494054720 controller.py:211] train | step:  185000 | training until step 205000...
I0413 00:51:31.398550 139857494054720 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0413 00:52:27.311236 139857494054720 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0413 01:31:08.745307 139857494054720 controller.py:425] train | step:  190000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.71558243,
           'avg_obj': 0.2794975,
           'box_loss': 0.19666776,
           'class_loss': 7.8816857,
           'conf_loss': 31.842312,
           'precision50': 0.27143678,
           'recall50': 0.17437537},
     '4': {'avg_iou': 0.78980124,
           'avg_obj': 0.44401494,
           'box_loss': 0.20437555,
           'class_loss': 9.571787,
           'conf_loss': 32.363464,
           'precision50': 0.3942661,
           'recall50': 0.3928971},
     '5': {'avg_iou': 0.83044094,
           'avg_obj': 0.5940451,
           'box_loss': 0.123471946,
           'class_loss': 6.927947,
           'conf_loss': 16.731148,
           'precision50': 0.46850327,
           'recall50': 0.6120476},
     'global': {'total_loss': 105.843},
     'learning_rate': 0.00261,
     'training_loss': 105.843}
I0413 02:08:05.909173 139857494054720 controller.py:425] train | step:  195000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.71709824,
           'avg_obj': 0.2806827,
           'box_loss': 0.19515061,
           'class_loss': 7.7823124,
           'conf_loss': 31.707191,
           'precision50': 0.27043733,
           'recall50': 0.17531218},
     '4': {'avg_iou': 0.7927526,
           'avg_obj': 0.4477244,
           'box_loss': 0.20169961,
           'class_loss': 9.479394,
           'conf_loss': 32.174603,
           'precision50': 0.39340895,
           'recall50': 0.39587477},
     '5': {'avg_iou': 0.8327069,
           'avg_obj': 0.5966107,
           'box_loss': 0.12196411,
           'class_loss': 6.8660164,
           'conf_loss': 16.635895,
           'precision50': 0.46679008,
           'recall50': 0.61454046},
     'global': {'total_loss': 105.164215},
     'learning_rate': 0.00261,
     'training_loss': 105.164215}
I0413 02:40:12.588931 139857494054720 controller.py:425] train | step:  200000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.7177219,
           'avg_obj': 0.28227732,
           'box_loss': 0.19528422,
           'class_loss': 7.7718563,
           'conf_loss': 31.67395,
           'precision50': 0.27160302,
           'recall50': 0.17707193},
     '4': {'avg_iou': 0.79441416,
           'avg_obj': 0.4495566,
           'box_loss': 0.1998147,
           'class_loss': 9.437596,
           'conf_loss': 32.028915,
           'precision50': 0.39111823,
           'recall50': 0.39785552},
     '5': {'avg_iou': 0.8343426,
           'avg_obj': 0.59946966,
           'box_loss': 0.12062488,
           'class_loss': 6.848,
           'conf_loss': 16.516634,
           'precision50': 0.46361366,
           'recall50': 0.61629766},
     'global': {'total_loss': 104.79282},
     'learning_rate': 0.00261,
     'training_loss': 104.79282}
I0413 03:12:17.701597 139857494054720 controller.py:425] train | step:  205000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.7295484,
           'avg_obj': 0.30206457,
           'box_loss': 0.18735798,
           'class_loss': 7.0867467,
           'conf_loss': 30.51919,
           'precision50': 0.2775901,
           'recall50': 0.19336568},
     '4': {'avg_iou': 0.8097174,
           'avg_obj': 0.47655645,
           'box_loss': 0.18526544,
           'class_loss': 8.487435,
           'conf_loss': 30.322624,
           'precision50': 0.38823795,
           'recall50': 0.42351288},
     '5': {'avg_iou': 0.84814316,
           'avg_obj': 0.62480193,
           'box_loss': 0.11064123,
           'class_loss': 6.054168,
           'conf_loss': 15.420006,
           'precision50': 0.45883188,
           'recall50': 0.6426509},
     'global': {'total_loss': 98.373604},
     'learning_rate': 0.000261,
     'training_loss': 98.373604}
I0413 03:13:08.820283 139857494054720 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og/ckpt-205000.
I0413 03:13:08.826541 139857494054720 controller.py:252]  eval | step:  205000 | running 625 steps of evaluation...
I0413 03:13:09.540480 139857494054720 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0413 03:13:26.545500 139857494054720 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0413 03:18:38.936882 139857494054720 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0413 03:22:45.438387 139857494054720 controller.py:261]  eval | step:  205000 | eval time:  576.6 sec | output: 
    {'3': {'avg_iou': 0.453611,
           'avg_obj': 0.18060988,
           'box_loss': 0.14066146,
           'class_loss': 5.262143,
           'conf_loss': 25.950502,
           'precision50': 0.21062295,
           'recall50': 0.16790432},
     '4': {'avg_iou': 0.67354935,
           'avg_obj': 0.39455372,
           'box_loss': 0.15107663,
           'class_loss': 6.3362837,
           'conf_loss': 26.466228,
           'precision50': 0.33730802,
           'recall50': 0.39475662},
     '5': {'avg_iou': 0.8091343,
           'avg_obj': 0.60584676,
           'box_loss': 0.0958508,
           'class_loss': 4.3343854,
           'conf_loss': 14.666804,
           'precision50': 0.4169375,
           'recall50': 0.61794895},
     'AP': 0.3918235,
     'AP50': 0.60731363,
     'AP75': 0.4294142,
     'APl': 0.50007784,
     'APm': 0.35533255,
     'APs': 0.15169479,
     'ARl': 0.6694852,
     'ARm': 0.56091404,
     'ARmax1': 0.31692132,
     'ARmax10': 0.5279963,
     'ARmax100': 0.5742564,
     'ARs': 0.3200518,
     'global': {'total_loss': 83.40393},
     'validation_loss': 83.40393}

defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((8, 640, 640, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 200, 8), 4: (8, 200, 8), 5: (8, 200, 8)}, inds: {3: (8, 200, 3), 4: (8, 200, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 80, 80, 3, 1), 4: (8, 40, 40, 3, 1), 5: (8, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((1, 640, 640, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 80, 80, 3, 1), 4: (1, 40, 40, 3, 1), 5: (1, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
restored model from gs://tensorflow2/config_testing/all-mean-og/ckpt-185000.
restored from checkpoint: gs://tensorflow2/config_testing/all-mean-og/ckpt-185000
train | step:  185000 | training until step 205000...
train | step:  190000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.71558243,
           'avg_obj': 0.2794975,
           'box_loss': 0.19666776,
           'class_loss': 7.8816857,
           'conf_loss': 31.842312,
           'precision50': 0.27143678,
           'recall50': 0.17437537},
     '4': {'avg_iou': 0.78980124,
           'avg_obj': 0.44401494,
           'box_loss': 0.20437555,
           'class_loss': 9.571787,
           'conf_loss': 32.363464,
           'precision50': 0.3942661,
           'recall50': 0.3928971},
     '5': {'avg_iou': 0.83044094,
           'avg_obj': 0.5940451,
           'box_loss': 0.123471946,
           'class_loss': 6.927947,
           'conf_loss': 16.731148,
           'precision50': 0.46850327,
           'recall50': 0.6120476},
     'global': {'total_loss': 105.843},
     'learning_rate': 0.00261,
     'training_loss': 105.843}
train | step:  195000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.71709824,
           'avg_obj': 0.2806827,
           'box_loss': 0.19515061,
           'class_loss': 7.7823124,
           'conf_loss': 31.707191,
           'precision50': 0.27043733,
           'recall50': 0.17531218},
     '4': {'avg_iou': 0.7927526,
           'avg_obj': 0.4477244,
           'box_loss': 0.20169961,
           'class_loss': 9.479394,
           'conf_loss': 32.174603,
           'precision50': 0.39340895,
           'recall50': 0.39587477},
     '5': {'avg_iou': 0.8327069,
           'avg_obj': 0.5966107,
           'box_loss': 0.12196411,
           'class_loss': 6.8660164,
           'conf_loss': 16.635895,
           'precision50': 0.46679008,
           'recall50': 0.61454046},
     'global': {'total_loss': 105.164215},
     'learning_rate': 0.00261,
     'training_loss': 105.164215}
train | step:  200000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.7177219,
           'avg_obj': 0.28227732,
           'box_loss': 0.19528422,
           'class_loss': 7.7718563,
           'conf_loss': 31.67395,
           'precision50': 0.27160302,
           'recall50': 0.17707193},
     '4': {'avg_iou': 0.79441416,
           'avg_obj': 0.4495566,
           'box_loss': 0.1998147,
           'class_loss': 9.437596,
           'conf_loss': 32.028915,
           'precision50': 0.39111823,
           'recall50': 0.39785552},
     '5': {'avg_iou': 0.8343426,
           'avg_obj': 0.59946966,
           'box_loss': 0.12062488,
           'class_loss': 6.848,
           'conf_loss': 16.516634,
           'precision50': 0.46361366,
           'recall50': 0.61629766},
     'global': {'total_loss': 104.79282},
     'learning_rate': 0.00261,
     'training_loss': 104.79282}
train | step:  205000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.7295484,
           'avg_obj': 0.30206457,
           'box_loss': 0.18735798,
           'class_loss': 7.0867467,
           'conf_loss': 30.51919,
           'precision50': 0.2775901,
           'recall50': 0.19336568},
     '4': {'avg_iou': 0.8097174,
           'avg_obj': 0.47655645,
           'box_loss': 0.18526544,
           'class_loss': 8.487435,
           'conf_loss': 30.322624,
           'precision50': 0.38823795,
           'recall50': 0.42351288},
     '5': {'avg_iou': 0.84814316,
           'avg_obj': 0.62480193,
           'box_loss': 0.11064123,
           'class_loss': 6.054168,
           'conf_loss': 15.420006,
           'precision50': 0.45883188,
           'recall50': 0.6426509},
     'global': {'total_loss': 98.373604},
     'learning_rate': 0.000261,
     'training_loss': 98.373604}
saved checkpoint to gs://tensorflow2/config_testing/all-mean-og/ckpt-205000.
 eval | step:  205000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=175.87s).
Accumulating evaluation results...
DONE (t=12.72s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.392
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.607
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.429
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.152
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.355
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.500
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.317
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.528
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.574
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.320
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.561
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.669
 eval | step:  205000 | eval time:  576.6 sec | output: 
    {'3': {'avg_iou': 0.453611,
           'avg_obj': 0.18060988,
           'box_loss': 0.14066146,
           'class_loss': 5.262143,
           'conf_loss': 25.950502,
           'precision50': 0.21062295,
           'recall50': 0.16790432},
     '4': {'avg_iou': 0.67354935,
           'avg_obj': 0.39455372,
           'box_loss': 0.15107663,
           'class_loss': 6.3362837,
           'conf_loss': 26.466228,
           'precision50': 0.33730802,
           'recall50': 0.39475662},
     '5': {'avg_iou': 0.8091343,
           'avg_obj': 0.60584676,
           'box_loss': 0.0958508,
           'class_loss': 4.3343854,
           'conf_loss': 14.666804,
           'precision50': 0.4169375,
           'recall50': 0.61794895},
     'AP': 0.3918235,
     'AP50': 0.60731363,
     'AP75': 0.4294142,
     'APl': 0.50007784,
     'APm': 0.35533255,
     'APs': 0.15169479,
     'ARl': 0.6694852,
     'ARm': 0.56091404,
     'ARmax1': 0.31692132,
     'ARmax10': 0.5279963,
     'ARmax100': 0.5742564,
     'ARs': 0.3200518,
     'global': {'total_loss': 83.40393},
     'validation_loss': 83.40393}I0413 03:23:04.891891 139857494054720 controller.py:211] train | step:  205000 | training until step 225000...
I0413 03:55:14.947050 139857494054720 controller.py:425] train | step:  210000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.7310873,
           'avg_obj': 0.30821362,
           'box_loss': 0.18621343,
           'class_loss': 6.8560815,
           'conf_loss': 30.144684,
           'precision50': 0.27836913,
           'recall50': 0.1982619},
     '4': {'avg_iou': 0.81164664,
           'avg_obj': 0.48491818,
           'box_loss': 0.18316135,
           'class_loss': 8.182512,
           'conf_loss': 29.744438,
           'precision50': 0.38599178,
           'recall50': 0.4313146},
     '5': {'avg_iou': 0.850444,
           'avg_obj': 0.6330257,
           'box_loss': 0.108782016,
           'class_loss': 5.813261,
           'conf_loss': 15.062153,
           'precision50': 0.45646837,
           'recall50': 0.6511035},
     'global': {'total_loss': 96.281235},
     'learning_rate': 0.000261,
     'training_loss': 96.281235}
I0413 04:27:16.653501 139857494054720 controller.py:425] train | step:  215000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.7320279,
           'avg_obj': 0.31099188,
           'box_loss': 0.18561552,
           'class_loss': 6.8062024,
           'conf_loss': 30.015865,
           'precision50': 0.27886188,
           'recall50': 0.20072117},
     '4': {'avg_iou': 0.8122258,
           'avg_obj': 0.4880212,
           'box_loss': 0.18282515,
           'class_loss': 8.12343,
           'conf_loss': 29.574287,
           'precision50': 0.38642374,
           'recall50': 0.4350816},
     '5': {'avg_iou': 0.8510836,
           'avg_obj': 0.6364256,
           'box_loss': 0.10843301,
           'class_loss': 5.7551417,
           'conf_loss': 14.935794,
           'precision50': 0.4562335,
           'recall50': 0.65424496},
     'global': {'total_loss': 95.687546},
     'learning_rate': 0.000261,
     'training_loss': 95.687546}
I0413 04:59:20.961413 139857494054720 controller.py:425] train | step:  220000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.7319958,
           'avg_obj': 0.3120371,
           'box_loss': 0.1848773,
           'class_loss': 6.735957,
           'conf_loss': 29.809065,
           'precision50': 0.27940768,
           'recall50': 0.20186059},
     '4': {'avg_iou': 0.8127254,
           'avg_obj': 0.49018192,
           'box_loss': 0.18153682,
           'class_loss': 8.018891,
           'conf_loss': 29.331362,
           'precision50': 0.384968,
           'recall50': 0.43661195},
     '5': {'avg_iou': 0.8515865,
           'avg_obj': 0.6390615,
           'box_loss': 0.107745156,
           'class_loss': 5.6603055,
           'conf_loss': 14.786952,
           'precision50': 0.455462,
           'recall50': 0.65713644},
     'global': {'total_loss': 94.816666},
     'learning_rate': 0.000261,
     'training_loss': 94.816666}
/home/cam2tensorflow/.experiment_start.sh: line 22: 27628 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   212    0     2  100   210     11   1220 --:--:-- --:--:-- --:--:--  1232
okRequest issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-13T05:24:12.830727655Z'
  endTime: '2021-04-13T05:25:05.715117826Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618291452819-5bfd3d730386a-01c38894-2e1fe9c6
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618291452819-5bfd3d730386a-01c38894-2e1fe9c6] to complete...
..................................................................................................................................................................................................................................................................................done.
