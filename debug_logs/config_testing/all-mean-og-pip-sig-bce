cat: .experiment_zone: No such file or directory
Request issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-13T16:38:05.081188942Z'
  endTime: '2021-04-13T16:38:39.988575394Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618331885065-5bfdd4123537c-fef4fabe-3672fbf0
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618331885065-5bfdd4123537c-fef4fabe-3672fbf0] to complete...
....................................................................................................................................................................................................done.
europe-west4-a
I0413 16:37:41.226055 140370326222656 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 7.0,
                                    'aug_rand_brightness': 0.7,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.1,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.4,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.75],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': False,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 0.75,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.75,
                                         'aug_rand_translate': 0.1,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.4,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.75],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': False,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [200000,
                                                                                250000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00261,
                                                                            0.000261,
                                                                            2.61e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0413 16:37:41.227093 140370326222656 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_testing/all-mean-og-pip-sig-bce/params.yaml
I0413 16:37:42.794887 140370326222656 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 16:37:43.406576 140370326222656 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0413 16:37:43.406967 140370326222656 transport.py:157] Attempting refresh to obtain initial access_token
I0413 16:37:43.475901 140370326222656 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 16:37:44.101375 140370326222656 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0413 16:37:44.101598 140370326222656 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-13 16:37:44.152566: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0413 16:37:44.153210 140370326222656 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 16:37:44.768595 140370326222656 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0413 16:37:44.768836 140370326222656 transport.py:157] Attempting refresh to obtain initial access_token
I0413 16:37:44.829742 140370326222656 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 16:37:45.446909 140370326222656 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0413 16:37:45.447181 140370326222656 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-13 16:37:45.494295: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-13 16:37:45.510983: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-04-13 16:37:45.511056: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:39831}
2021-04-13 16:38:18.329932: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-04-13 16:38:18.330025: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:39831}
2021-04-13 16:38:18.330782: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:39831
I0413 16:38:18.331587 140370326222656 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-1
I0413 16:38:18.332146 140370326222656 tpu_strategy_util.py:74] Initializing the TPU system: node-1
INFO:tensorflow:Clearing out eager caches
I0413 16:38:26.850278 140370326222656 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0413 16:38:26.852529 140370326222656 tpu_strategy_util.py:133] Finished initializing TPU system.
I0413 16:38:26.854093 140370326222656 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 16:38:26.998018 140370326222656 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0413 16:38:26.998260 140370326222656 transport.py:157] Attempting refresh to obtain initial access_token
I0413 16:38:27.062815 140370326222656 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 16:38:27.673798 140370326222656 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0413 16:38:27.674023 140370326222656 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0413 16:38:27.716004 140370326222656 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0413 16:38:27.716275 140370326222656 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0413 16:38:27.716613 140370326222656 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0413 16:38:27.716698 140370326222656 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0413 16:38:27.716775 140370326222656 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0413 16:38:27.716955 140370326222656 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0413 16:38:27.717034 140370326222656 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0413 16:38:27.717108 140370326222656 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0413 16:38:27.717183 140370326222656 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0413 16:38:27.717255 140370326222656 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0413 16:38:27.717327 140370326222656 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0413 16:38:27.717472 140370326222656 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0413 16:38:27.717548 140370326222656 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0413 16:38:27.717627 140370326222656 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0413 16:38:27.717700 140370326222656 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0413 16:38:27.717772 140370326222656 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0413 16:38:27.758591 140370326222656 train_utils.py:214] Running default trainer.
2021-04-13 16:38:27.770673: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.4, 'aug_rand_translate': 0.1, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.7, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.75], 'random_crop': False, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.4, 'aug_rand_translate': 0.1, 'aug_rand_saturation': 0.75, 'aug_rand_brightness': 0.75, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.75], 'random_crop': False, 'random_crop_mosaic': True}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [200000, 250000], 'values': [0.00261, 0.000261, 2.61e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05} 0.00025
{'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7faa1f246320>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
conv1 512.0
conv2 1024.0
conv1 512.0
spp
conv1 512.0
conv2 1024.0
conv1 512.0
7
conv1 512.0
conv2 256.0
conv1 512.0
conv2 256.0
4








 ListWrapper([256, 512, 1024])
conv1 128
conv2 256
conv1 128
conv2 256
conv1 128
conv2 256
6
conv1 256
conv2 512
conv1 256
conv2 512
conv1 256
conv2 512
6
conv1 512
conv2 1024
conv1 512
conv2 1024
conv1 512
conv2 1024
6
detget {'3': 1.2, '4': 1.1, '5': 1.05}
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 80, 80, 256) 37319168  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 64,488,640
Trainable params: 64,422,336
Non-trainable params: 66,304
_________________________________________________________________I0413 16:39:17.614511 140370326222656 controller.py:362] restoring or initializing model...
I0413 16:39:25.982713 140370326222656 yolo.py:532] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0413 16:39:25.984597 140370326222656 controller.py:368] initialized model.
I0413 16:39:25.984771 140370326222656 train_lib.py:96] Starts to execute mode: train_and_eval
I0413 16:39:25.990614 140370326222656 controller.py:211] train | step:      0 | training until step 20000...
I0413 16:39:34.859593 140370326222656 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0413 16:40:36.626918 140370326222656 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
/home/cam2tensorflow/.experiment_start.sh: line 22:  9831 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4-$5
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   216    0     2  100   214     11   1281 --:--:-- --:--:-- --:--:--  1293
okRequest issued for: [node-1]
cat: .experiment_zone: No such file or directory
Request issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-13T16:44:21.220973509Z'
  endTime: '2021-04-13T16:45:16.956315879Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618332261210-5bfdd578edaa6-bb5cb2d1-0850b26b
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618332261210-5bfdd578edaa6-bb5cb2d1-0850b26b] to complete...
........................................................................................................................................................................................................................................................................................................................................................................................done.
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-13T16:45:29.641985035Z'
  endTime: '2021-04-13T16:46:08.528262140Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618332329631-5bfdd5ba2dfe8-c9d6cdcf-9ff72444
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618332329631-5bfdd5ba2dfe8-c9d6cdcf-9ff72444] to complete...
..............................................................................................................................................................................................................................................................................done.
europe-west4-a
I0413 16:45:18.384943 140211523503936 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 7.0,
                                    'aug_rand_brightness': 0.7,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.1,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.4,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.75],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': False,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 0.75,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.75,
                                         'aug_rand_translate': 0.1,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.4,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.75],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': False,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [200000,
                                                                                250000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00261,
                                                                            0.000261,
                                                                            2.61e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0413 16:45:18.385837 140211523503936 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_testing/all-mean-og-pip-sig-bce/params.yaml
I0413 16:45:19.217707 140211523503936 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 16:45:19.359863 140211523503936 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0413 16:45:19.360126 140211523503936 transport.py:157] Attempting refresh to obtain initial access_token
I0413 16:45:19.411654 140211523503936 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 16:45:19.556401 140211523503936 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0413 16:45:19.556645 140211523503936 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-13 16:45:19.596596: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0413 16:45:19.597393 140211523503936 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 16:45:19.738174 140211523503936 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0413 16:45:19.738445 140211523503936 transport.py:157] Attempting refresh to obtain initial access_token
I0413 16:45:19.825541 140211523503936 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 16:45:19.966234 140211523503936 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0413 16:45:19.966707 140211523503936 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-13 16:45:20.006647: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-13 16:45:20.016240: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-04-13 16:45:20.016323: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:40075}
2021-04-13 16:45:44.192502: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-04-13 16:45:44.192663: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:40075}
2021-04-13 16:45:44.193167: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:40075
I0413 16:45:44.193946 140211523503936 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-1
I0413 16:45:44.194986 140211523503936 tpu_strategy_util.py:74] Initializing the TPU system: node-1
INFO:tensorflow:Clearing out eager caches
I0413 16:45:52.652035 140211523503936 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0413 16:45:52.653764 140211523503936 tpu_strategy_util.py:133] Finished initializing TPU system.
I0413 16:45:52.655056 140211523503936 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 16:45:53.274104 140211523503936 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0413 16:45:53.274352 140211523503936 transport.py:157] Attempting refresh to obtain initial access_token
I0413 16:45:53.330479 140211523503936 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 16:45:53.470317 140211523503936 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0413 16:45:53.470569 140211523503936 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0413 16:45:53.514499 140211523503936 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0413 16:45:53.515039 140211523503936 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0413 16:45:53.515561 140211523503936 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0413 16:45:53.516055 140211523503936 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0413 16:45:53.516238 140211523503936 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0413 16:45:53.516539 140211523503936 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0413 16:45:53.516692 140211523503936 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0413 16:45:53.516870 140211523503936 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0413 16:45:53.517123 140211523503936 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0413 16:45:53.517263 140211523503936 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0413 16:45:53.517364 140211523503936 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0413 16:45:53.517450 140211523503936 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0413 16:45:53.517566 140211523503936 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0413 16:45:53.517659 140211523503936 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0413 16:45:53.517745 140211523503936 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0413 16:45:53.517850 140211523503936 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0413 16:45:53.557681 140211523503936 train_utils.py:214] Running default trainer.
2021-04-13 16:45:53.567520: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.4, 'aug_rand_translate': 0.1, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.7, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.75], 'random_crop': False, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.4, 'aug_rand_translate': 0.1, 'aug_rand_saturation': 0.75, 'aug_rand_brightness': 0.75, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.75], 'random_crop': False, 'random_crop_mosaic': True}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [200000, 250000], 'values': [0.00261, 0.000261, 2.61e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05} 0.00025
{'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f8525c1aa20>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
conv1 512.0
conv2 1024.0
conv1 512.0
spp
conv1 512.0
conv2 1024.0
conv1 512.0
7
conv1 512.0
conv2 256.0
conv1 512.0
conv2 256.0
4








 ListWrapper([256, 512, 1024])
conv1 128
conv2 256
conv1 128
conv2 256
conv1 128
conv2 256
6
conv1 256
conv2 512
conv1 256
conv2 512
conv1 256
conv2 512
6
conv1 512
conv2 1024
conv1 512
conv2 1024
conv1 512
conv2 1024
6
detget {'3': 1.2, '4': 1.1, '5': 1.05}
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 80, 80, 256) 37319168  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 64,488,640
Trainable params: 64,422,336
Non-trainable params: 66,304
_________________________________________________________________I0413 16:46:49.197421 140211523503936 controller.py:362] restoring or initializing model...
I0413 16:46:56.956807 140211523503936 yolo.py:532] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0413 16:46:56.958761 140211523503936 controller.py:368] initialized model.
I0413 16:46:56.959032 140211523503936 train_lib.py:96] Starts to execute mode: train_and_eval
I0413 16:46:56.963665 140211523503936 controller.py:211] train | step:      0 | training until step 20000...
I0413 16:47:04.405753 140211523503936 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0413 16:48:12.732327 140211523503936 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
/home/cam2tensorflow/.experiment_start.sh: line 22: 10075 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4-$5
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   216    0     2  100   214     13   1398 --:--:-- --:--:-- --:--:--  1402100   216    0     2  100   214     13   1398 --:--:-- --:--:-- --:--:--  1402
okRequest issued for: [node-1]
cat: .experiment_zone: No such file or directory
Request issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-13T16:59:29.511140832Z'
  endTime: '2021-04-13T17:00:06.725826671Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618333169493-5bfdd8db224d9-70a2a463-3a5d2694
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618333169493-5bfdd8db224d9-70a2a463-3a5d2694] to complete...
.............................................................................................................................................................................................................................................................................done.
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-13T17:00:22.133108814Z'
  endTime: '2021-04-13T17:00:59.601665531Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618333222121-5bfdd90d52ffb-9764f34c-8e878733
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618333222121-5bfdd90d52ffb-9764f34c-8e878733] to complete...
..................................................................................................................................................................................................done.
europe-west4-a
I0413 16:59:56.030633 140082688317248 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 7.0,
                                    'aug_rand_brightness': 0.7,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.1,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.4,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.75],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': False,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 0.75,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.75,
                                         'aug_rand_translate': 0.1,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.4,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.75],
                                                    'mosaic_frequency': 0.85,
                                                    'output_size': [640, 640],
                                                    'random_crop': False,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [200000,
                                                                                250000],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00261,
                                                                            0.000261,
                                                                            2.61e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0413 16:59:56.032560 140082688317248 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_testing/all-mean-og-pip-sig-bce/params.yaml
I0413 16:59:56.878369 140082688317248 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 16:59:57.496025 140082688317248 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0413 16:59:57.496276 140082688317248 transport.py:157] Attempting refresh to obtain initial access_token
I0413 16:59:57.550679 140082688317248 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 16:59:57.687706 140082688317248 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0413 16:59:57.687986 140082688317248 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-13 16:59:57.744349: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0413 16:59:57.745047 140082688317248 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 16:59:58.360479 140082688317248 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0413 16:59:58.360722 140082688317248 transport.py:157] Attempting refresh to obtain initial access_token
I0413 16:59:58.403783 140082688317248 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 16:59:59.021453 140082688317248 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0413 16:59:59.021693 140082688317248 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-13 16:59:59.061489: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-13 16:59:59.074230: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-04-13 16:59:59.074311: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:40401}
2021-04-13 17:00:34.535070: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-04-13 17:00:34.535196: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:40401}
2021-04-13 17:00:34.536281: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:40401
I0413 17:00:34.537857 140082688317248 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-1
I0413 17:00:34.538886 140082688317248 tpu_strategy_util.py:74] Initializing the TPU system: node-1
INFO:tensorflow:Clearing out eager caches
I0413 17:00:43.236509 140082688317248 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0413 17:00:43.238535 140082688317248 tpu_strategy_util.py:133] Finished initializing TPU system.
I0413 17:00:43.239968 140082688317248 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 17:00:43.858246 140082688317248 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0413 17:00:43.858562 140082688317248 transport.py:157] Attempting refresh to obtain initial access_token
I0413 17:00:43.932714 140082688317248 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0413 17:00:44.549154 140082688317248 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0413 17:00:44.549562 140082688317248 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0413 17:00:44.610423 140082688317248 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0413 17:00:44.610821 140082688317248 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0413 17:00:44.611334 140082688317248 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0413 17:00:44.611668 140082688317248 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0413 17:00:44.611769 140082688317248 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0413 17:00:44.612146 140082688317248 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0413 17:00:44.612219 140082688317248 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0413 17:00:44.612281 140082688317248 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0413 17:00:44.612330 140082688317248 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0413 17:00:44.612378 140082688317248 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0413 17:00:44.612432 140082688317248 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0413 17:00:44.612488 140082688317248 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0413 17:00:44.612545 140082688317248 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0413 17:00:44.612607 140082688317248 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0413 17:00:44.612664 140082688317248 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0413 17:00:44.613141 140082688317248 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0413 17:00:44.651533 140082688317248 train_utils.py:214] Running default trainer.
2021-04-13 17:00:44.659958: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.4, 'aug_rand_translate': 0.1, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.7, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.75], 'random_crop': False, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.4, 'aug_rand_translate': 0.1, 'aug_rand_saturation': 0.75, 'aug_rand_brightness': 0.75, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.75], 'random_crop': False, 'random_crop_mosaic': True}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [200000, 250000], 'values': [0.00261, 0.000261, 2.61e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05} 0.00025
{'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f672694b208>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
conv1 512.0
conv2 1024.0
conv1 512.0
spp
conv1 512.0
conv2 1024.0
conv1 512.0
7
conv1 512.0
conv2 256.0
conv1 512.0
conv2 256.0
4








 ListWrapper([256, 512, 1024])
conv1 128
conv2 256
conv1 128
conv2 256
conv1 128
conv2 256
6
conv1 256
conv2 512
conv1 256
conv2 512
conv1 256
conv2 512
6
conv1 512
conv2 1024
conv1 512
conv2 1024
conv1 512
conv2 1024
6
detget {'3': 1.2, '4': 1.1, '5': 1.05}
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 80, 80, 256) 37319168  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 64,488,640
Trainable params: 64,422,336
Non-trainable params: 66,304
_________________________________________________________________I0413 17:01:32.790614 140082688317248 controller.py:362] restoring or initializing model...
I0413 17:01:40.904965 140082688317248 yolo.py:532] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0413 17:01:40.909044 140082688317248 controller.py:368] initialized model.
I0413 17:01:40.909655 140082688317248 train_lib.py:96] Starts to execute mode: train_and_eval
I0413 17:01:40.918541 140082688317248 controller.py:211] train | step:      0 | training until step 20000...
I0413 17:01:47.746815 140082688317248 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0413 17:02:50.653923 140082688317248 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0413 17:41:35.318932 140082688317248 controller.py:425] train | step:   5000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.52779275,
           'avg_obj': 0.053993054,
           'box_loss': 0.3193645,
           'class_loss': 58.02248,
           'conf_loss': 251.47482,
           'precision50': 0.034187403,
           'recall50': 0.010859749},
     '4': {'avg_iou': 0.58344585,
           'avg_obj': 0.10506238,
           'box_loss': 0.34525082,
           'class_loss': 67.56024,
           'conf_loss': 114.61292,
           'precision50': 0.116446055,
           'recall50': 0.043772224},
     '5': {'avg_iou': 0.6255473,
           'avg_obj': 0.15882483,
           'box_loss': 0.20738015,
           'class_loss': 45.332302,
           'conf_loss': 48.31691,
           'precision50': 0.19626409,
           'recall50': 0.0987014},
     'global': {'total_loss': 586.1923},
     'learning_rate': 0.00261,
     'training_loss': 586.1923}
I0413 17:42:34.242233 140082688317248 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-sig-bce/ckpt-5000.
I0413 18:16:53.834698 140082688317248 controller.py:425] train | step:  10000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.60486597,
           'avg_obj': 0.09373297,
           'box_loss': 0.2683198,
           'class_loss': 21.37944,
           'conf_loss': 44.155464,
           'precision50': 0.09924165,
           'recall50': 0.027674172},
     '4': {'avg_iou': 0.6733997,
           'avg_obj': 0.17893769,
           'box_loss': 0.2714251,
           'class_loss': 24.950233,
           'conf_loss': 44.349792,
           'precision50': 0.23802331,
           'recall50': 0.1031766},
     '5': {'avg_iou': 0.7152907,
           'avg_obj': 0.268432,
           'box_loss': 0.15798132,
           'class_loss': 16.373665,
           'conf_loss': 24.215902,
           'precision50': 0.3568606,
           'recall50': 0.22913168},
     'global': {'total_loss': 176.1221},
     'learning_rate': 0.00261,
     'training_loss': 176.1221}
I0413 18:51:19.107607 140082688317248 controller.py:425] train | step:  15000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.62466174,
           'avg_obj': 0.11752947,
           'box_loss': 0.25517076,
           'class_loss': 18.509607,
           'conf_loss': 41.695526,
           'precision50': 0.12955904,
           'recall50': 0.04147316},
     '4': {'avg_iou': 0.69735706,
           'avg_obj': 0.21970396,
           'box_loss': 0.25136176,
           'class_loss': 21.08024,
           'conf_loss': 41.22,
           'precision50': 0.27484593,
           'recall50': 0.14198765},
     '5': {'avg_iou': 0.7382058,
           'avg_obj': 0.32060698,
           'box_loss': 0.14523657,
           'class_loss': 13.848464,
           'conf_loss': 22.200853,
           'precision50': 0.39285716,
           'recall50': 0.2970226},
     'global': {'total_loss': 159.20674},
     'learning_rate': 0.00261,
     'training_loss': 159.20674}
I0413 19:24:55.458971 140082688317248 controller.py:425] train | step:  20000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.63686574,
           'avg_obj': 0.1333275,
           'box_loss': 0.24701437,
           'class_loss': 16.867338,
           'conf_loss': 40.200024,
           'precision50': 0.14799212,
           'recall50': 0.05253819},
     '4': {'avg_iou': 0.71107674,
           'avg_obj': 0.24550366,
           'box_loss': 0.24032019,
           'class_loss': 18.955143,
           'conf_loss': 39.4102,
           'precision50': 0.29312262,
           'recall50': 0.16905725},
     '5': {'avg_iou': 0.7516599,
           'avg_obj': 0.3533111,
           'box_loss': 0.13797913,
           'class_loss': 12.43445,
           'conf_loss': 21.023575,
           'precision50': 0.40743095,
           'recall50': 0.33755046},
     'global': {'total_loss': 149.516},
     'learning_rate': 0.00261,
     'training_loss': 149.516}
I0413 19:25:09.006485 140082688317248 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0413 19:25:09.690362 140082688317248 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0413 19:25:26.427537 140082688317248 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0413 19:30:41.524069 140082688317248 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0413 19:35:10.883871 140082688317248 controller.py:261]  eval | step:  20000 | eval time:  601.9 sec | output: 
    {'3': {'avg_iou': 0.42308974,
           'avg_obj': 0.10530085,
           'box_loss': 0.1672702,
           'class_loss': 9.29658,
           'conf_loss': 31.480453,
           'precision50': 0.15842971,
           'recall50': 0.079765506},
     '4': {'avg_iou': 0.62433666,
           'avg_obj': 0.24498089,
           'box_loss': 0.19493078,
           'class_loss': 11.66006,
           'conf_loss': 33.092342,
           'precision50': 0.300979,
           'recall50': 0.22281916},
     '5': {'avg_iou': 0.7537356,
           'avg_obj': 0.42112842,
           'box_loss': 0.12554152,
           'class_loss': 8.128999,
           'conf_loss': 19.179533,
           'precision50': 0.40868783,
           'recall50': 0.41349488},
     'AP': 0.22912419,
     'AP50': 0.40871006,
     'AP75': 0.23631565,
     'APl': 0.29544562,
     'APm': 0.19560562,
     'APs': 0.08134953,
     'ARl': 0.5380282,
     'ARm': 0.4215267,
     'ARmax1': 0.23021604,
     'ARmax10': 0.40438628,
     'ARmax100': 0.44786337,
     'ARs': 0.21492073,
     'global': {'total_loss': 113.32572},
     'validation_loss': 113.32572}

defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((8, 640, 640, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 200, 8), 4: (8, 200, 8), 5: (8, 200, 8)}, inds: {3: (8, 200, 3), 4: (8, 200, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 80, 80, 3, 1), 4: (8, 40, 40, 3, 1), 5: (8, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((1, 640, 640, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 80, 80, 3, 1), 4: (1, 40, 40, 3, 1), 5: (1, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
train | step:   5000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.52779275,
           'avg_obj': 0.053993054,
           'box_loss': 0.3193645,
           'class_loss': 58.02248,
           'conf_loss': 251.47482,
           'precision50': 0.034187403,
           'recall50': 0.010859749},
     '4': {'avg_iou': 0.58344585,
           'avg_obj': 0.10506238,
           'box_loss': 0.34525082,
           'class_loss': 67.56024,
           'conf_loss': 114.61292,
           'precision50': 0.116446055,
           'recall50': 0.043772224},
     '5': {'avg_iou': 0.6255473,
           'avg_obj': 0.15882483,
           'box_loss': 0.20738015,
           'class_loss': 45.332302,
           'conf_loss': 48.31691,
           'precision50': 0.19626409,
           'recall50': 0.0987014},
     'global': {'total_loss': 586.1923},
     'learning_rate': 0.00261,
     'training_loss': 586.1923}
saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-sig-bce/ckpt-5000.
train | step:  10000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.60486597,
           'avg_obj': 0.09373297,
           'box_loss': 0.2683198,
           'class_loss': 21.37944,
           'conf_loss': 44.155464,
           'precision50': 0.09924165,
           'recall50': 0.027674172},
     '4': {'avg_iou': 0.6733997,
           'avg_obj': 0.17893769,
           'box_loss': 0.2714251,
           'class_loss': 24.950233,
           'conf_loss': 44.349792,
           'precision50': 0.23802331,
           'recall50': 0.1031766},
     '5': {'avg_iou': 0.7152907,
           'avg_obj': 0.268432,
           'box_loss': 0.15798132,
           'class_loss': 16.373665,
           'conf_loss': 24.215902,
           'precision50': 0.3568606,
           'recall50': 0.22913168},
     'global': {'total_loss': 176.1221},
     'learning_rate': 0.00261,
     'training_loss': 176.1221}
train | step:  15000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.62466174,
           'avg_obj': 0.11752947,
           'box_loss': 0.25517076,
           'class_loss': 18.509607,
           'conf_loss': 41.695526,
           'precision50': 0.12955904,
           'recall50': 0.04147316},
     '4': {'avg_iou': 0.69735706,
           'avg_obj': 0.21970396,
           'box_loss': 0.25136176,
           'class_loss': 21.08024,
           'conf_loss': 41.22,
           'precision50': 0.27484593,
           'recall50': 0.14198765},
     '5': {'avg_iou': 0.7382058,
           'avg_obj': 0.32060698,
           'box_loss': 0.14523657,
           'class_loss': 13.848464,
           'conf_loss': 22.200853,
           'precision50': 0.39285716,
           'recall50': 0.2970226},
     'global': {'total_loss': 159.20674},
     'learning_rate': 0.00261,
     'training_loss': 159.20674}
train | step:  20000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.63686574,
           'avg_obj': 0.1333275,
           'box_loss': 0.24701437,
           'class_loss': 16.867338,
           'conf_loss': 40.200024,
           'precision50': 0.14799212,
           'recall50': 0.05253819},
     '4': {'avg_iou': 0.71107674,
           'avg_obj': 0.24550366,
           'box_loss': 0.24032019,
           'class_loss': 18.955143,
           'conf_loss': 39.4102,
           'precision50': 0.29312262,
           'recall50': 0.16905725},
     '5': {'avg_iou': 0.7516599,
           'avg_obj': 0.3533111,
           'box_loss': 0.13797913,
           'class_loss': 12.43445,
           'conf_loss': 21.023575,
           'precision50': 0.40743095,
           'recall50': 0.33755046},
     'global': {'total_loss': 149.516},
     'learning_rate': 0.00261,
     'training_loss': 149.516}
 eval | step:  20000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=186.66s).
Accumulating evaluation results...
DONE (t=23.33s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.229
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.409
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.236
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.081
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.196
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.295
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.230
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.404
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.448
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.215
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.422
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.538
 eval | step:  20000 | eval time:  601.9 sec | output: 
    {'3': {'avg_iou': 0.42308974,
           'avg_obj': 0.10530085,
           'box_loss': 0.1672702,
           'class_loss': 9.29658,
           'conf_loss': 31.480453,
           'precision50': 0.15842971,
           'recall50': 0.079765506},
     '4': {'avg_iou': 0.62433666,
           'avg_obj': 0.24498089,
           'box_loss': 0.19493078,
           'class_loss': 11.66006,
           'conf_loss': 33.092342,
           'precision50': 0.300979,
           'recall50': 0.22281916},
     '5': {'avg_iou': 0.7537356,
           'avg_obj': 0.42112842,
           'box_loss': 0.12554152,
           'class_loss': 8.128999,
           'conf_loss': 19.179533,
           'precision50': 0.40868783,
           'recall50': 0.41349488},
     'AP': 0.22912419,
     'AP50': 0.40871006,
     'AP75': 0.23631565,
     'APl': 0.29544562,
     'APm': 0.19560562,
     'APs': 0.08134953,
     'ARl': 0.5380282,
     'ARm': 0.4215267,
     'ARmax1': 0.23021604,
     'ARmax10': 0.40438628,
     'ARmax100': 0.44786337,
     'ARs': 0.21492073,
     'global': {'total_loss': 113.32572},
     'validation_loss': 113.32572}I0413 19:35:40.143944 140082688317248 controller.py:211] train | step:  20000 | training until step 40000...
I0413 20:08:58.726198 140082688317248 controller.py:425] train | step:  25000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.64568824,
           'avg_obj': 0.14647351,
           'box_loss': 0.24121572,
           'class_loss': 15.682866,
           'conf_loss': 39.06451,
           'precision50': 0.16130503,
           'recall50': 0.061174113},
     '4': {'avg_iou': 0.72103727,
           'avg_obj': 0.26548496,
           'box_loss': 0.23256946,
           'class_loss': 17.486143,
           'conf_loss': 38.109352,
           'precision50': 0.30527493,
           'recall50': 0.1894025},
     '5': {'avg_iou': 0.7609014,
           'avg_obj': 0.37727514,
           'box_loss': 0.13307458,
           'class_loss': 11.443999,
           'conf_loss': 20.183552,
           'precision50': 0.41827193,
           'recall50': 0.3672796},
     'global': {'total_loss': 142.57707},
     'learning_rate': 0.00261,
     'training_loss': 142.57707}
I0413 20:09:49.117788 140082688317248 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-sig-bce/ckpt-25000.
I0413 20:42:30.570477 140082688317248 controller.py:425] train | step:  30000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.65194803,
           'avg_obj': 0.15710296,
           'box_loss': 0.23669705,
           'class_loss': 14.775295,
           'conf_loss': 38.19009,
           'precision50': 0.17120501,
           'recall50': 0.06844471},
     '4': {'avg_iou': 0.72899354,
           'avg_obj': 0.2822346,
           'box_loss': 0.22544463,
           'class_loss': 16.319078,
           'conf_loss': 36.9428,
           'precision50': 0.3125734,
           'recall50': 0.20642148},
     '5': {'avg_iou': 0.76840144,
           'avg_obj': 0.39633048,
           'box_loss': 0.12867478,
           'class_loss': 10.691137,
           'conf_loss': 19.49086,
           'precision50': 0.42404863,
           'recall50': 0.39070418},
     'global': {'total_loss': 137.00037},
     'learning_rate': 0.00261,
     'training_loss': 137.00037}
I0413 21:15:47.621681 140082688317248 controller.py:425] train | step:  35000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.65701336,
           'avg_obj': 0.16546573,
           'box_loss': 0.23348793,
           'class_loss': 14.161786,
           'conf_loss': 37.552536,
           'precision50': 0.1781202,
           'recall50': 0.073748946},
     '4': {'avg_iou': 0.7342338,
           'avg_obj': 0.2936651,
           'box_loss': 0.22142234,
           'class_loss': 15.518488,
           'conf_loss': 36.186775,
           'precision50': 0.3171709,
           'recall50': 0.21755598},
     '5': {'avg_iou': 0.7741316,
           'avg_obj': 0.41126007,
           'box_loss': 0.12566023,
           'class_loss': 10.111553,
           'conf_loss': 18.96276,
           'precision50': 0.42770877,
           'recall50': 0.4075657},
     'global': {'total_loss': 133.0745},
     'learning_rate': 0.00261,
     'training_loss': 133.0745}
I0413 21:49:32.176095 140082688317248 controller.py:425] train | step:  40000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6615778,
           'avg_obj': 0.17383583,
           'box_loss': 0.23096238,
           'class_loss': 13.567475,
           'conf_loss': 36.973003,
           'precision50': 0.1858657,
           'recall50': 0.07997687},
     '4': {'avg_iou': 0.7398152,
           'avg_obj': 0.3051659,
           'box_loss': 0.2170012,
           'class_loss': 14.7362,
           'conf_loss': 35.474846,
           'precision50': 0.32298794,
           'recall50': 0.22982055},
     '5': {'avg_iou': 0.7789219,
           'avg_obj': 0.42448622,
           'box_loss': 0.123264834,
           'class_loss': 9.664071,
           'conf_loss': 18.535652,
           'precision50': 0.43085068,
           'recall50': 0.42332476},
     'global': {'total_loss': 129.52248},
     'learning_rate': 0.00261,
     'training_loss': 129.52248}
I0413 21:49:44.982925 140082688317248 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0413 21:54:21.885433 140082688317248 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0413 21:58:26.686668 140082688317248 controller.py:261]  eval | step:  40000 | eval time:  521.7 sec | output: 
    {'3': {'avg_iou': 0.43320513,
           'avg_obj': 0.12570983,
           'box_loss': 0.15875828,
           'class_loss': 7.454471,
           'conf_loss': 29.124178,
           'precision50': 0.18134688,
           'recall50': 0.10093074},
     '4': {'avg_iou': 0.63950944,
           'avg_obj': 0.28943792,
           'box_loss': 0.18088019,
           'class_loss': 9.293948,
           'conf_loss': 30.237343,
           'precision50': 0.323782,
           'recall50': 0.2750847},
     '5': {'avg_iou': 0.7739603,
           'avg_obj': 0.4869544,
           'box_loss': 0.114918105,
           'class_loss': 6.4847426,
           'conf_loss': 17.188978,
           'precision50': 0.41654503,
           'recall50': 0.48638585},
     'AP': 0.28797898,
     'AP50': 0.49035603,
     'AP75': 0.30524856,
     'APl': 0.3678415,
     'APm': 0.25316653,
     'APs': 0.10664588,
     'ARl': 0.58595186,
     'ARm': 0.4712213,
     'ARmax1': 0.26237988,
     'ARmax10': 0.44789898,
     'ARmax100': 0.4941521,
     'ARs': 0.25869003,
     'global': {'total_loss': 100.23823},
     'validation_loss': 100.23823}
I0413 21:58:44.523046 140082688317248 controller.py:211] train | step:  40000 | training until step 60000...
I0413 22:32:05.705195 140082688317248 controller.py:425] train | step:  45000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.6646945,
           'avg_obj': 0.1788972,
           'box_loss': 0.22788638,
           'class_loss': 13.031856,
           'conf_loss': 36.442142,
           'precision50': 0.18878378,
           'recall50': 0.08354425},
     '4': {'avg_iou': 0.74409914,
           'avg_obj': 0.31402507,
           'box_loss': 0.21289961,
           'class_loss': 14.136645,
           'conf_loss': 34.815475,
           'precision50': 0.32562676,
           'recall50': 0.23846765},
     '5': {'avg_iou': 0.783288,
           'avg_obj': 0.43454742,
           'box_loss': 0.12044623,
           'class_loss': 9.245856,
           'conf_loss': 18.12366,
           'precision50': 0.43252233,
           'recall50': 0.4345812},
     'global': {'total_loss': 126.35705},
     'learning_rate': 0.00261,
     'training_loss': 126.35705}
I0413 22:32:56.551874 140082688317248 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-sig-bce/ckpt-45000.
I0413 23:07:01.177700 140082688317248 controller.py:425] train | step:  50000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.66778183,
           'avg_obj': 0.18547387,
           'box_loss': 0.22719856,
           'class_loss': 12.694552,
           'conf_loss': 36.131046,
           'precision50': 0.19338848,
           'recall50': 0.08777232},
     '4': {'avg_iou': 0.74745536,
           'avg_obj': 0.3232718,
           'box_loss': 0.21060906,
           'class_loss': 13.663845,
           'conf_loss': 34.287273,
           'precision50': 0.32923695,
           'recall50': 0.24753828},
     '5': {'avg_iou': 0.7866197,
           'avg_obj': 0.44505116,
           'box_loss': 0.118699454,
           'class_loss': 8.884942,
           'conf_loss': 17.773727,
           'precision50': 0.43409365,
           'recall50': 0.44653696},
     'global': {'total_loss': 123.991585},
     'learning_rate': 0.00261,
     'training_loss': 123.991585}
I0413 23:40:38.988334 140082688317248 controller.py:425] train | step:  55000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.67108774,
           'avg_obj': 0.19139132,
           'box_loss': 0.22573687,
           'class_loss': 12.366281,
           'conf_loss': 35.781986,
           'precision50': 0.19816957,
           'recall50': 0.09197141},
     '4': {'avg_iou': 0.7507671,
           'avg_obj': 0.33093727,
           'box_loss': 0.20805137,
           'class_loss': 13.235247,
           'conf_loss': 33.82149,
           'precision50': 0.3311982,
           'recall50': 0.25454003},
     '5': {'avg_iou': 0.7897529,
           'avg_obj': 0.4535609,
           'box_loss': 0.1170855,
           'class_loss': 8.629184,
           'conf_loss': 17.498735,
           'precision50': 0.43637407,
           'recall50': 0.456677},
     'global': {'total_loss': 121.88405},
     'learning_rate': 0.00261,
     'training_loss': 121.88405}

train | step:  20000 | training until step 40000...
train | step:  25000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.64568824,
           'avg_obj': 0.14647351,
           'box_loss': 0.24121572,
           'class_loss': 15.682866,
           'conf_loss': 39.06451,
           'precision50': 0.16130503,
           'recall50': 0.061174113},
     '4': {'avg_iou': 0.72103727,
           'avg_obj': 0.26548496,
           'box_loss': 0.23256946,
           'class_loss': 17.486143,
           'conf_loss': 38.109352,
           'precision50': 0.30527493,
           'recall50': 0.1894025},
     '5': {'avg_iou': 0.7609014,
           'avg_obj': 0.37727514,
           'box_loss': 0.13307458,
           'class_loss': 11.443999,
           'conf_loss': 20.183552,
           'precision50': 0.41827193,
           'recall50': 0.3672796},
     'global': {'total_loss': 142.57707},
     'learning_rate': 0.00261,
     'training_loss': 142.57707}
saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-sig-bce/ckpt-25000.
train | step:  30000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.65194803,
           'avg_obj': 0.15710296,
           'box_loss': 0.23669705,
           'class_loss': 14.775295,
           'conf_loss': 38.19009,
           'precision50': 0.17120501,
           'recall50': 0.06844471},
     '4': {'avg_iou': 0.72899354,
           'avg_obj': 0.2822346,
           'box_loss': 0.22544463,
           'class_loss': 16.319078,
           'conf_loss': 36.9428,
           'precision50': 0.3125734,
           'recall50': 0.20642148},
     '5': {'avg_iou': 0.76840144,
           'avg_obj': 0.39633048,
           'box_loss': 0.12867478,
           'class_loss': 10.691137,
           'conf_loss': 19.49086,
           'precision50': 0.42404863,
           'recall50': 0.39070418},
     'global': {'total_loss': 137.00037},
     'learning_rate': 0.00261,
     'training_loss': 137.00037}
train | step:  35000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.65701336,
           'avg_obj': 0.16546573,
           'box_loss': 0.23348793,
           'class_loss': 14.161786,
           'conf_loss': 37.552536,
           'precision50': 0.1781202,
           'recall50': 0.073748946},
     '4': {'avg_iou': 0.7342338,
           'avg_obj': 0.2936651,
           'box_loss': 0.22142234,
           'class_loss': 15.518488,
           'conf_loss': 36.186775,
           'precision50': 0.3171709,
           'recall50': 0.21755598},
     '5': {'avg_iou': 0.7741316,
           'avg_obj': 0.41126007,
           'box_loss': 0.12566023,
           'class_loss': 10.111553,
           'conf_loss': 18.96276,
           'precision50': 0.42770877,
           'recall50': 0.4075657},
     'global': {'total_loss': 133.0745},
     'learning_rate': 0.00261,
     'training_loss': 133.0745}
train | step:  40000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6615778,
           'avg_obj': 0.17383583,
           'box_loss': 0.23096238,
           'class_loss': 13.567475,
           'conf_loss': 36.973003,
           'precision50': 0.1858657,
           'recall50': 0.07997687},
     '4': {'avg_iou': 0.7398152,
           'avg_obj': 0.3051659,
           'box_loss': 0.2170012,
           'class_loss': 14.7362,
           'conf_loss': 35.474846,
           'precision50': 0.32298794,
           'recall50': 0.22982055},
     '5': {'avg_iou': 0.7789219,
           'avg_obj': 0.42448622,
           'box_loss': 0.123264834,
           'class_loss': 9.664071,
           'conf_loss': 18.535652,
           'precision50': 0.43085068,
           'recall50': 0.42332476},
     'global': {'total_loss': 129.52248},
     'learning_rate': 0.00261,
     'training_loss': 129.52248}
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=171.43s).
Accumulating evaluation results...
DONE (t=17.33s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.288
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.490
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.305
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.107
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.253
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.368
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.262
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.448
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.494
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.259
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.471
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.586
 eval | step:  40000 | eval time:  521.7 sec | output: 
    {'3': {'avg_iou': 0.43320513,
           'avg_obj': 0.12570983,
           'box_loss': 0.15875828,
           'class_loss': 7.454471,
           'conf_loss': 29.124178,
           'precision50': 0.18134688,
           'recall50': 0.10093074},
     '4': {'avg_iou': 0.63950944,
           'avg_obj': 0.28943792,
           'box_loss': 0.18088019,
           'class_loss': 9.293948,
           'conf_loss': 30.237343,
           'precision50': 0.323782,
           'recall50': 0.2750847},
     '5': {'avg_iou': 0.7739603,
           'avg_obj': 0.4869544,
           'box_loss': 0.114918105,
           'class_loss': 6.4847426,
           'conf_loss': 17.188978,
           'precision50': 0.41654503,
           'recall50': 0.48638585},
     'AP': 0.28797898,
     'AP50': 0.49035603,
     'AP75': 0.30524856,
     'APl': 0.3678415,
     'APm': 0.25316653,
     'APs': 0.10664588,
     'ARl': 0.58595186,
     'ARm': 0.4712213,
     'ARmax1': 0.26237988,
     'ARmax10': 0.44789898,
     'ARmax100': 0.4941521,
     'ARs': 0.25869003,
     'global': {'total_loss': 100.23823},
     'validation_loss': 100.23823}
train | step:  40000 | training until step 60000...
train | step:  45000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.6646945,
           'avg_obj': 0.1788972,
           'box_loss': 0.22788638,
           'class_loss': 13.031856,
           'conf_loss': 36.442142,
           'precision50': 0.18878378,
           'recall50': 0.08354425},
     '4': {'avg_iou': 0.74409914,
           'avg_obj': 0.31402507,
           'box_loss': 0.21289961,
           'class_loss': 14.136645,
           'conf_loss': 34.815475,
           'precision50': 0.32562676,
           'recall50': 0.23846765},
     '5': {'avg_iou': 0.783288,
           'avg_obj': 0.43454742,
           'box_loss': 0.12044623,
           'class_loss': 9.245856,
           'conf_loss': 18.12366,
           'precision50': 0.43252233,
           'recall50': 0.4345812},
     'global': {'total_loss': 126.35705},
     'learning_rate': 0.00261,
     'training_loss': 126.35705}
saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-sig-bce/ckpt-45000.
train | step:  50000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.66778183,
           'avg_obj': 0.18547387,
           'box_loss': 0.22719856,
           'class_loss': 12.694552,
           'conf_loss': 36.131046,
           'precision50': 0.19338848,
           'recall50': 0.08777232},
     '4': {'avg_iou': 0.74745536,
           'avg_obj': 0.3232718,
           'box_loss': 0.21060906,
           'class_loss': 13.663845,
           'conf_loss': 34.287273,
           'precision50': 0.32923695,
           'recall50': 0.24753828},
     '5': {'avg_iou': 0.7866197,
           'avg_obj': 0.44505116,
           'box_loss': 0.118699454,
           'class_loss': 8.884942,
           'conf_loss': 17.773727,
           'precision50': 0.43409365,
           'recall50': 0.44653696},
     'global': {'total_loss': 123.991585},
     'learning_rate': 0.00261,
     'training_loss': 123.991585}
train | step:  55000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.67108774,
           'avg_obj': 0.19139132,
           'box_loss': 0.22573687,
           'class_loss': 12.366281,
           'conf_loss': 35.781986,
           'precision50': 0.19816957,
           'recall50': 0.09197141},
     '4': {'avg_iou': 0.7507671,
           'avg_obj': 0.33093727,
           'box_loss': 0.20805137,
           'class_loss': 13.235247,
           'conf_loss': 33.82149,
           'precision50': 0.3311982,
           'recall50': 0.25454003},
     '5': {'avg_iou': 0.7897529,
           'avg_obj': 0.4535609,
           'box_loss': 0.1170855,
           'class_loss': 8.629184,
           'conf_loss': 17.498735,
           'precision50': 0.43637407,
           'recall50': 0.456677},
     'global': {'total_loss': 121.88405},
     'learning_rate': 0.00261,
     'training_loss': 121.88405}I0414 00:13:48.574295 140082688317248 controller.py:425] train | step:  60000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6733394,
           'avg_obj': 0.19511329,
           'box_loss': 0.22284326,
           'class_loss': 12.007885,
           'conf_loss': 35.343163,
           'precision50': 0.20034672,
           'recall50': 0.09515906},
     '4': {'avg_iou': 0.75371575,
           'avg_obj': 0.33751574,
           'box_loss': 0.20521873,
           'class_loss': 12.773298,
           'conf_loss': 33.32667,
           'precision50': 0.33499476,
           'recall50': 0.26237297},
     '5': {'avg_iou': 0.7925256,
           'avg_obj': 0.46112782,
           'box_loss': 0.11551337,
           'class_loss': 8.329502,
           'conf_loss': 17.21547,
           'precision50': 0.43825382,
           'recall50': 0.4651279},
     'global': {'total_loss': 119.53944},
     'learning_rate': 0.00261,
     'training_loss': 119.53944}
I0414 00:14:01.323439 140082688317248 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0414 00:18:33.158313 140082688317248 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0414 00:22:39.451938 140082688317248 controller.py:261]  eval | step:  60000 | eval time:  518.1 sec | output: 
    {'3': {'avg_iou': 0.43808612,
           'avg_obj': 0.13814567,
           'box_loss': 0.15467376,
           'class_loss': 6.6417227,
           'conf_loss': 28.03335,
           'precision50': 0.19417481,
           'recall50': 0.11526044},
     '4': {'avg_iou': 0.64818776,
           'avg_obj': 0.31423026,
           'box_loss': 0.1733821,
           'class_loss': 8.232886,
           'conf_loss': 28.82135,
           'precision50': 0.3330309,
           'recall50': 0.30388507},
     '5': {'avg_iou': 0.78432244,
           'avg_obj': 0.5229642,
           'box_loss': 0.10936666,
           'class_loss': 5.740696,
           'conf_loss': 16.240437,
           'precision50': 0.4214774,
           'recall50': 0.5307465},
     'AP': 0.31804228,
     'AP50': 0.5299976,
     'AP75': 0.3408276,
     'APl': 0.40685558,
     'APm': 0.28343952,
     'APs': 0.12218753,
     'ARl': 0.60824376,
     'ARm': 0.49421492,
     'ARmax1': 0.2773913,
     'ARmax10': 0.46803236,
     'ARmax100': 0.51497495,
     'ARs': 0.2811509,
     'global': {'total_loss': 94.1479},
     'validation_loss': 94.1479}
I0414 00:23:00.651799 140082688317248 controller.py:211] train | step:  60000 | training until step 80000...
I0414 00:55:14.846946 140082688317248 controller.py:425] train | step:  65000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.67577523,
           'avg_obj': 0.19920644,
           'box_loss': 0.22052032,
           'class_loss': 11.696712,
           'conf_loss': 34.899113,
           'precision50': 0.20250233,
           'recall50': 0.097655185},
     '4': {'avg_iou': 0.75593174,
           'avg_obj': 0.34314823,
           'box_loss': 0.20267372,
           'class_loss': 12.4273615,
           'conf_loss': 32.87397,
           'precision50': 0.33616033,
           'recall50': 0.26759472},
     '5': {'avg_iou': 0.794949,
           'avg_obj': 0.4681216,
           'box_loss': 0.113858595,
           'class_loss': 8.072174,
           'conf_loss': 16.947613,
           'precision50': 0.4378335,
           'recall50': 0.4740153},
     'global': {'total_loss': 117.453865},
     'learning_rate': 0.00261,
     'training_loss': 117.453865}
I0414 00:56:06.967045 140082688317248 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-sig-bce/ckpt-65000.
I0414 01:28:27.272297 140082688317248 controller.py:425] train | step:  70000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.67733103,
           'avg_obj': 0.20397672,
           'box_loss': 0.22032379,
           'class_loss': 11.459112,
           'conf_loss': 34.72218,
           'precision50': 0.20523965,
           'recall50': 0.101085074},
     '4': {'avg_iou': 0.7584163,
           'avg_obj': 0.3498841,
           'box_loss': 0.20062643,
           'class_loss': 12.109691,
           'conf_loss': 32.461628,
           'precision50': 0.3378876,
           'recall50': 0.27400646},
     '5': {'avg_iou': 0.79741937,
           'avg_obj': 0.47562104,
           'box_loss': 0.11236422,
           'class_loss': 7.8486404,
           'conf_loss': 16.671862,
           'precision50': 0.4398752,
           'recall50': 0.48231217},
     'global': {'total_loss': 115.80659},
     'learning_rate': 0.00261,
     'training_loss': 115.80659}
I0414 02:02:06.456264 140082688317248 controller.py:425] train | step:  75000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.67905277,
           'avg_obj': 0.20719744,
           'box_loss': 0.21907859,
           'class_loss': 11.207469,
           'conf_loss': 34.48658,
           'precision50': 0.20739837,
           'recall50': 0.103591345},
     '4': {'avg_iou': 0.7603683,
           'avg_obj': 0.35434714,
           'box_loss': 0.19973512,
           'class_loss': 11.868154,
           'conf_loss': 32.297855,
           'precision50': 0.33964503,
           'recall50': 0.27875108},
     '5': {'avg_iou': 0.79918116,
           'avg_obj': 0.48067397,
           'box_loss': 0.11173617,
           'class_loss': 7.6840124,
           'conf_loss': 16.534077,
           'precision50': 0.4402615,
           'recall50': 0.4872552},
     'global': {'total_loss': 114.60879},
     'learning_rate': 0.00261,
     'training_loss': 114.60879}
I0414 02:35:56.835907 140082688317248 controller.py:425] train | step:  80000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.68142444,
           'avg_obj': 0.21133254,
           'box_loss': 0.21793704,
           'class_loss': 11.042518,
           'conf_loss': 34.25146,
           'precision50': 0.21043365,
           'recall50': 0.10667526},
     '4': {'avg_iou': 0.7626022,
           'avg_obj': 0.35983092,
           'box_loss': 0.19800203,
           'class_loss': 11.601115,
           'conf_loss': 31.981134,
           'precision50': 0.34121886,
           'recall50': 0.28422728},
     '5': {'avg_iou': 0.80116254,
           'avg_obj': 0.4854872,
           'box_loss': 0.11061031,
           'class_loss': 7.50787,
           'conf_loss': 16.360926,
           'precision50': 0.44185302,
           'recall50': 0.492881},
     'global': {'total_loss': 113.2716},
     'learning_rate': 0.00261,
     'training_loss': 113.2716}
I0414 02:36:11.999789 140082688317248 controller.py:252]  eval | step:  80000 | running 625 steps of evaluation...
I0414 02:40:41.071367 140082688317248 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.

train | step:  60000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6733394,
           'avg_obj': 0.19511329,
           'box_loss': 0.22284326,
           'class_loss': 12.007885,
           'conf_loss': 35.343163,
           'precision50': 0.20034672,
           'recall50': 0.09515906},
     '4': {'avg_iou': 0.75371575,
           'avg_obj': 0.33751574,
           'box_loss': 0.20521873,
           'class_loss': 12.773298,
           'conf_loss': 33.32667,
           'precision50': 0.33499476,
           'recall50': 0.26237297},
     '5': {'avg_iou': 0.7925256,
           'avg_obj': 0.46112782,
           'box_loss': 0.11551337,
           'class_loss': 8.329502,
           'conf_loss': 17.21547,
           'precision50': 0.43825382,
           'recall50': 0.4651279},
     'global': {'total_loss': 119.53944},
     'learning_rate': 0.00261,
     'training_loss': 119.53944}
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=174.40s).
Accumulating evaluation results...
DONE (t=16.03s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.318
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.530
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.341
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.122
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.283
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.407
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.277
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.468
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.515
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.281
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.494
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.608
 eval | step:  60000 | eval time:  518.1 sec | output: 
    {'3': {'avg_iou': 0.43808612,
           'avg_obj': 0.13814567,
           'box_loss': 0.15467376,
           'class_loss': 6.6417227,
           'conf_loss': 28.03335,
           'precision50': 0.19417481,
           'recall50': 0.11526044},
     '4': {'avg_iou': 0.64818776,
           'avg_obj': 0.31423026,
           'box_loss': 0.1733821,
           'class_loss': 8.232886,
           'conf_loss': 28.82135,
           'precision50': 0.3330309,
           'recall50': 0.30388507},
     '5': {'avg_iou': 0.78432244,
           'avg_obj': 0.5229642,
           'box_loss': 0.10936666,
           'class_loss': 5.740696,
           'conf_loss': 16.240437,
           'precision50': 0.4214774,
           'recall50': 0.5307465},
     'AP': 0.31804228,
     'AP50': 0.5299976,
     'AP75': 0.3408276,
     'APl': 0.40685558,
     'APm': 0.28343952,
     'APs': 0.12218753,
     'ARl': 0.60824376,
     'ARm': 0.49421492,
     'ARmax1': 0.2773913,
     'ARmax10': 0.46803236,
     'ARmax100': 0.51497495,
     'ARs': 0.2811509,
     'global': {'total_loss': 94.1479},
     'validation_loss': 94.1479}
train | step:  60000 | training until step 80000...
train | step:  65000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.67577523,
           'avg_obj': 0.19920644,
           'box_loss': 0.22052032,
           'class_loss': 11.696712,
           'conf_loss': 34.899113,
           'precision50': 0.20250233,
           'recall50': 0.097655185},
     '4': {'avg_iou': 0.75593174,
           'avg_obj': 0.34314823,
           'box_loss': 0.20267372,
           'class_loss': 12.4273615,
           'conf_loss': 32.87397,
           'precision50': 0.33616033,
           'recall50': 0.26759472},
     '5': {'avg_iou': 0.794949,
           'avg_obj': 0.4681216,
           'box_loss': 0.113858595,
           'class_loss': 8.072174,
           'conf_loss': 16.947613,
           'precision50': 0.4378335,
           'recall50': 0.4740153},
     'global': {'total_loss': 117.453865},
     'learning_rate': 0.00261,
     'training_loss': 117.453865}
saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-sig-bce/ckpt-65000.
train | step:  70000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.67733103,
           'avg_obj': 0.20397672,
           'box_loss': 0.22032379,
           'class_loss': 11.459112,
           'conf_loss': 34.72218,
           'precision50': 0.20523965,
           'recall50': 0.101085074},
     '4': {'avg_iou': 0.7584163,
           'avg_obj': 0.3498841,
           'box_loss': 0.20062643,
           'class_loss': 12.109691,
           'conf_loss': 32.461628,
           'precision50': 0.3378876,
           'recall50': 0.27400646},
     '5': {'avg_iou': 0.79741937,
           'avg_obj': 0.47562104,
           'box_loss': 0.11236422,
           'class_loss': 7.8486404,
           'conf_loss': 16.671862,
           'precision50': 0.4398752,
           'recall50': 0.48231217},
     'global': {'total_loss': 115.80659},
     'learning_rate': 0.00261,
     'training_loss': 115.80659}
train | step:  75000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.67905277,
           'avg_obj': 0.20719744,
           'box_loss': 0.21907859,
           'class_loss': 11.207469,
           'conf_loss': 34.48658,
           'precision50': 0.20739837,
           'recall50': 0.103591345},
     '4': {'avg_iou': 0.7603683,
           'avg_obj': 0.35434714,
           'box_loss': 0.19973512,
           'class_loss': 11.868154,
           'conf_loss': 32.297855,
           'precision50': 0.33964503,
           'recall50': 0.27875108},
     '5': {'avg_iou': 0.79918116,
           'avg_obj': 0.48067397,
           'box_loss': 0.11173617,
           'class_loss': 7.6840124,
           'conf_loss': 16.534077,
           'precision50': 0.4402615,
           'recall50': 0.4872552},
     'global': {'total_loss': 114.60879},
     'learning_rate': 0.00261,
     'training_loss': 114.60879}
train | step:  80000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.68142444,
           'avg_obj': 0.21133254,
           'box_loss': 0.21793704,
           'class_loss': 11.042518,
           'conf_loss': 34.25146,
           'precision50': 0.21043365,
           'recall50': 0.10667526},
     '4': {'avg_iou': 0.7626022,
           'avg_obj': 0.35983092,
           'box_loss': 0.19800203,
           'class_loss': 11.601115,
           'conf_loss': 31.981134,
           'precision50': 0.34121886,
           'recall50': 0.28422728},
     '5': {'avg_iou': 0.80116254,
           'avg_obj': 0.4854872,
           'box_loss': 0.11061031,
           'class_loss': 7.50787,
           'conf_loss': 16.360926,
           'precision50': 0.44185302,
           'recall50': 0.492881},
     'global': {'total_loss': 113.2716},
     'learning_rate': 0.00261,
     'training_loss': 113.2716}
 eval | step:  80000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=185.09s).
Accumulating evaluation results...
DONE (t=15.64s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.336
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.554
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.361
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.133
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.301
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.432
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.287
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.481
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.527
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.289
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.511
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.622I0414 02:44:59.364240 140082688317248 controller.py:261]  eval | step:  80000 | eval time:  527.4 sec | output: 
    {'3': {'avg_iou': 0.4415658,
           'avg_obj': 0.14650899,
           'box_loss': 0.15178978,
           'class_loss': 6.170764,
           'conf_loss': 27.381756,
           'precision50': 0.20099303,
           'recall50': 0.12538576},
     '4': {'avg_iou': 0.653553,
           'avg_obj': 0.33147675,
           'box_loss': 0.16809951,
           'class_loss': 7.5901365,
           'conf_loss': 27.967731,
           'precision50': 0.33728158,
           'recall50': 0.32289764},
     '5': {'avg_iou': 0.79039055,
           'avg_obj': 0.5431454,
           'box_loss': 0.10577253,
           'class_loss': 5.3171525,
           'conf_loss': 15.7073965,
           'precision50': 0.41767725,
           'recall50': 0.5491398},
     'AP': 0.33612686,
     'AP50': 0.5538143,
     'AP75': 0.36115912,
     'APl': 0.4316774,
     'APm': 0.3012017,
     'APs': 0.13296592,
     'ARl': 0.622415,
     'ARm': 0.51120305,
     'ARmax1': 0.2869195,
     'ARmax10': 0.4805185,
     'ARmax100': 0.52749324,
     'ARs': 0.2892466,
     'global': {'total_loss': 90.560555},
     'validation_loss': 90.560555}
I0414 02:45:15.441292 140082688317248 controller.py:211] train | step:  80000 | training until step 100000...
I0414 03:18:23.742542 140082688317248 controller.py:425] train | step:  85000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.6821366,
           'avg_obj': 0.21339953,
           'box_loss': 0.21686135,
           'class_loss': 10.850446,
           'conf_loss': 34.007187,
           'precision50': 0.21125297,
           'recall50': 0.1081478},
     '4': {'avg_iou': 0.76426613,
           'avg_obj': 0.3639588,
           'box_loss': 0.19643861,
           'class_loss': 11.338149,
           'conf_loss': 31.69679,
           'precision50': 0.3425245,
           'recall50': 0.2884413},
     '5': {'avg_iou': 0.80264544,
           'avg_obj': 0.49085483,
           'box_loss': 0.10987552,
           'class_loss': 7.3528156,
           'conf_loss': 16.203804,
           'precision50': 0.44321314,
           'recall50': 0.4990166},
     'global': {'total_loss': 111.97243},
     'learning_rate': 0.00261,
     'training_loss': 111.97243}
I0414 03:19:15.167662 140082688317248 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-sig-bce/ckpt-85000.
I0414 03:53:16.255294 140082688317248 controller.py:425] train | step:  90000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6841031,
           'avg_obj': 0.21647702,
           'box_loss': 0.21538338,
           'class_loss': 10.626842,
           'conf_loss': 33.776608,
           'precision50': 0.21320575,
           'recall50': 0.11074165},
     '4': {'avg_iou': 0.7655675,
           'avg_obj': 0.36781615,
           'box_loss': 0.1950581,
           'class_loss': 11.145764,
           'conf_loss': 31.432331,
           'precision50': 0.34323665,
           'recall50': 0.2929803},
     '5': {'avg_iou': 0.8043301,
           'avg_obj': 0.49573213,
           'box_loss': 0.10871694,
           'class_loss': 7.184712,
           'conf_loss': 15.990117,
           'precision50': 0.44282988,
           'recall50': 0.5041431},
     'global': {'total_loss': 110.67581},
     'learning_rate': 0.00261,
     'training_loss': 110.67581}
I0414 04:27:15.554093 140082688317248 controller.py:425] train | step:  95000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6857449,
           'avg_obj': 0.21989124,
           'box_loss': 0.21507558,
           'class_loss': 10.49786,
           'conf_loss': 33.67548,
           'precision50': 0.21510215,
           'recall50': 0.112735935},
     '4': {'avg_iou': 0.7670485,
           'avg_obj': 0.3720005,
           'box_loss': 0.19438708,
           'class_loss': 10.952102,
           'conf_loss': 31.237637,
           'precision50': 0.34469885,
           'recall50': 0.29658595},
     '5': {'avg_iou': 0.8057361,
           'avg_obj': 0.49887687,
           'box_loss': 0.108022384,
           'class_loss': 7.070091,
           'conf_loss': 15.904018,
           'precision50': 0.44308165,
           'recall50': 0.50746053},
     'global': {'total_loss': 109.85491},
     'learning_rate': 0.00261,
     'training_loss': 109.85491}
I0414 05:01:19.752561 140082688317248 controller.py:425] train | step:  100000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6865407,
           'avg_obj': 0.2221292,
           'box_loss': 0.21402109,
           'class_loss': 10.331068,
           'conf_loss': 33.425205,
           'precision50': 0.21583466,
           'recall50': 0.11403314},
     '4': {'avg_iou': 0.7688128,
           'avg_obj': 0.37610453,
           'box_loss': 0.19279478,
           'class_loss': 10.761384,
           'conf_loss': 30.980356,
           'precision50': 0.34398186,
           'recall50': 0.3001153},
     '5': {'avg_iou': 0.80739963,
           'avg_obj': 0.50450903,
           'box_loss': 0.107251085,
           'class_loss': 6.935728,
           'conf_loss': 15.731819,
           'precision50': 0.44363466,
           'recall50': 0.51345676},
     'global': {'total_loss': 108.6795},
     'learning_rate': 0.00261,
     'training_loss': 108.6795}
I0414 05:01:32.965732 140082688317248 controller.py:252]  eval | step:  100000 | running 625 steps of evaluation...
I0414 05:06:17.460390 140082688317248 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0414 05:10:32.410516 140082688317248 controller.py:261]  eval | step:  100000 | eval time:  539.4 sec | output: 
    {'3': {'avg_iou': 0.44406235,
           'avg_obj': 0.15242183,
           'box_loss': 0.14975561,
           'class_loss': 5.8702474,
           'conf_loss': 26.992754,
           'precision50': 0.20397654,
           'recall50': 0.13317214},
     '4': {'avg_iou': 0.6572653,
           'avg_obj': 0.34344995,
           'box_loss': 0.16495842,
           'class_loss': 7.209785,
           'conf_loss': 27.453415,
           'precision50': 0.34001768,
           'recall50': 0.33595166},
     '5': {'avg_iou': 0.79449695,
           'avg_obj': 0.5576012,
           'box_loss': 0.103581704,
           'class_loss': 5.012315,
           'conf_loss': 15.311754,
           'precision50': 0.41842803,
           'recall50': 0.56634104},
     'AP': 0.34862736,
     'AP50': 0.56728834,
     'AP75': 0.3756314,
     'APl': 0.4466855,
     'APm': 0.31206042,
     'APs': 0.14042988,
     'ARl': 0.6308811,
     'ARm': 0.520709,
     'ARmax1': 0.29420364,
     'ARmax10': 0.49135998,
     'ARmax100': 0.5366738,
     'ARs': 0.30556723,
     'global': {'total_loss': 88.26857},
     'validation_loss': 88.26857}
I0414 05:10:49.435091 140082688317248 controller.py:211] train | step:  100000 | training until step 120000...
I0414 05:43:01.276040 140082688317248 controller.py:425] train | step:  105000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.6877813,
           'avg_obj': 0.22556116,
           'box_loss': 0.21373792,
           'class_loss': 10.201266,
           'conf_loss': 33.278976,
           'precision50': 0.2171414,
           'recall50': 0.116492465},
     '4': {'avg_iou': 0.7703659,
           'avg_obj': 0.37979504,
           'box_loss': 0.19124818,
           'class_loss': 10.573313,
           'conf_loss': 30.712637,
           'precision50': 0.34653136,
           'recall50': 0.30437928},
     '5': {'avg_iou': 0.80875283,
           'avg_obj': 0.50823253,
           'box_loss': 0.10628749,
           'class_loss': 6.8165827,
           'conf_loss': 15.570863,
           'precision50': 0.44408607,
           'recall50': 0.5174437},
     'global': {'total_loss': 107.66479},
     'learning_rate': 0.00261,
     'training_loss': 107.66479}

 eval | step:  80000 | eval time:  527.4 sec | output: 
    {'3': {'avg_iou': 0.4415658,
           'avg_obj': 0.14650899,
           'box_loss': 0.15178978,
           'class_loss': 6.170764,
           'conf_loss': 27.381756,
           'precision50': 0.20099303,
           'recall50': 0.12538576},
     '4': {'avg_iou': 0.653553,
           'avg_obj': 0.33147675,
           'box_loss': 0.16809951,
           'class_loss': 7.5901365,
           'conf_loss': 27.967731,
           'precision50': 0.33728158,
           'recall50': 0.32289764},
     '5': {'avg_iou': 0.79039055,
           'avg_obj': 0.5431454,
           'box_loss': 0.10577253,
           'class_loss': 5.3171525,
           'conf_loss': 15.7073965,
           'precision50': 0.41767725,
           'recall50': 0.5491398},
     'AP': 0.33612686,
     'AP50': 0.5538143,
     'AP75': 0.36115912,
     'APl': 0.4316774,
     'APm': 0.3012017,
     'APs': 0.13296592,
     'ARl': 0.622415,
     'ARm': 0.51120305,
     'ARmax1': 0.2869195,
     'ARmax10': 0.4805185,
     'ARmax100': 0.52749324,
     'ARs': 0.2892466,
     'global': {'total_loss': 90.560555},
     'validation_loss': 90.560555}
train | step:  80000 | training until step 100000...
train | step:  85000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.6821366,
           'avg_obj': 0.21339953,
           'box_loss': 0.21686135,
           'class_loss': 10.850446,
           'conf_loss': 34.007187,
           'precision50': 0.21125297,
           'recall50': 0.1081478},
     '4': {'avg_iou': 0.76426613,
           'avg_obj': 0.3639588,
           'box_loss': 0.19643861,
           'class_loss': 11.338149,
           'conf_loss': 31.69679,
           'precision50': 0.3425245,
           'recall50': 0.2884413},
     '5': {'avg_iou': 0.80264544,
           'avg_obj': 0.49085483,
           'box_loss': 0.10987552,
           'class_loss': 7.3528156,
           'conf_loss': 16.203804,
           'precision50': 0.44321314,
           'recall50': 0.4990166},
     'global': {'total_loss': 111.97243},
     'learning_rate': 0.00261,
     'training_loss': 111.97243}
saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-sig-bce/ckpt-85000.
train | step:  90000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6841031,
           'avg_obj': 0.21647702,
           'box_loss': 0.21538338,
           'class_loss': 10.626842,
           'conf_loss': 33.776608,
           'precision50': 0.21320575,
           'recall50': 0.11074165},
     '4': {'avg_iou': 0.7655675,
           'avg_obj': 0.36781615,
           'box_loss': 0.1950581,
           'class_loss': 11.145764,
           'conf_loss': 31.432331,
           'precision50': 0.34323665,
           'recall50': 0.2929803},
     '5': {'avg_iou': 0.8043301,
           'avg_obj': 0.49573213,
           'box_loss': 0.10871694,
           'class_loss': 7.184712,
           'conf_loss': 15.990117,
           'precision50': 0.44282988,
           'recall50': 0.5041431},
     'global': {'total_loss': 110.67581},
     'learning_rate': 0.00261,
     'training_loss': 110.67581}
train | step:  95000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6857449,
           'avg_obj': 0.21989124,
           'box_loss': 0.21507558,
           'class_loss': 10.49786,
           'conf_loss': 33.67548,
           'precision50': 0.21510215,
           'recall50': 0.112735935},
     '4': {'avg_iou': 0.7670485,
           'avg_obj': 0.3720005,
           'box_loss': 0.19438708,
           'class_loss': 10.952102,
           'conf_loss': 31.237637,
           'precision50': 0.34469885,
           'recall50': 0.29658595},
     '5': {'avg_iou': 0.8057361,
           'avg_obj': 0.49887687,
           'box_loss': 0.108022384,
           'class_loss': 7.070091,
           'conf_loss': 15.904018,
           'precision50': 0.44308165,
           'recall50': 0.50746053},
     'global': {'total_loss': 109.85491},
     'learning_rate': 0.00261,
     'training_loss': 109.85491}
train | step:  100000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6865407,
           'avg_obj': 0.2221292,
           'box_loss': 0.21402109,
           'class_loss': 10.331068,
           'conf_loss': 33.425205,
           'precision50': 0.21583466,
           'recall50': 0.11403314},
     '4': {'avg_iou': 0.7688128,
           'avg_obj': 0.37610453,
           'box_loss': 0.19279478,
           'class_loss': 10.761384,
           'conf_loss': 30.980356,
           'precision50': 0.34398186,
           'recall50': 0.3001153},
     '5': {'avg_iou': 0.80739963,
           'avg_obj': 0.50450903,
           'box_loss': 0.107251085,
           'class_loss': 6.935728,
           'conf_loss': 15.731819,
           'precision50': 0.44363466,
           'recall50': 0.51345676},
     'global': {'total_loss': 108.6795},
     'learning_rate': 0.00261,
     'training_loss': 108.6795}
 eval | step:  100000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=181.27s).
Accumulating evaluation results...
DONE (t=15.34s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.349
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.567
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.376
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.140
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.312
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.447
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.294
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.537
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.306
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.521
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.631
 eval | step:  100000 | eval time:  539.4 sec | output: 
    {'3': {'avg_iou': 0.44406235,
           'avg_obj': 0.15242183,
           'box_loss': 0.14975561,
           'class_loss': 5.8702474,
           'conf_loss': 26.992754,
           'precision50': 0.20397654,
           'recall50': 0.13317214},
     '4': {'avg_iou': 0.6572653,
           'avg_obj': 0.34344995,
           'box_loss': 0.16495842,
           'class_loss': 7.209785,
           'conf_loss': 27.453415,
           'precision50': 0.34001768,
           'recall50': 0.33595166},
     '5': {'avg_iou': 0.79449695,
           'avg_obj': 0.5576012,
           'box_loss': 0.103581704,
           'class_loss': 5.012315,
           'conf_loss': 15.311754,
           'precision50': 0.41842803,
           'recall50': 0.56634104},
     'AP': 0.34862736,
     'AP50': 0.56728834,
     'AP75': 0.3756314,
     'APl': 0.4466855,
     'APm': 0.31206042,
     'APs': 0.14042988,
     'ARl': 0.6308811,
     'ARm': 0.520709,
     'ARmax1': 0.29420364,
     'ARmax10': 0.49135998,
     'ARmax100': 0.5366738,
     'ARs': 0.30556723,
     'global': {'total_loss': 88.26857},
     'validation_loss': 88.26857}
train | step:  100000 | training until step 120000...
train | step:  105000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.6877813,
           'avg_obj': 0.22556116,
           'box_loss': 0.21373792,
           'class_loss': 10.201266,
           'conf_loss': 33.278976,
           'precision50': 0.2171414,
           'recall50': 0.116492465},
     '4': {'avg_iou': 0.7703659,
           'avg_obj': 0.37979504,
           'box_loss': 0.19124818,
           'class_loss': 10.573313,
           'conf_loss': 30.712637,
           'precision50': 0.34653136,
           'recall50': 0.30437928},
     '5': {'avg_iou': 0.80875283,
           'avg_obj': 0.50823253,
           'box_loss': 0.10628749,
           'class_loss': 6.8165827,
           'conf_loss': 15.570863,
           'precision50': 0.44408607,
           'recall50': 0.5174437},
     'global': {'total_loss': 107.66479},
     'learning_rate': 0.00261,
     'training_loss': 107.66479}I0414 05:43:53.244023 140082688317248 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-sig-bce/ckpt-105000.
I0414 06:16:10.074328 140082688317248 controller.py:425] train | step:  110000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6890231,
           'avg_obj': 0.22770627,
           'box_loss': 0.21325335,
           'class_loss': 10.084886,
           'conf_loss': 33.170425,
           'precision50': 0.2192101,
           'recall50': 0.118527286},
     '4': {'avg_iou': 0.77134645,
           'avg_obj': 0.3836408,
           'box_loss': 0.19105716,
           'class_loss': 10.424414,
           'conf_loss': 30.589506,
           'precision50': 0.34722927,
           'recall50': 0.30851832},
     '5': {'avg_iou': 0.8097651,
           'avg_obj': 0.5124324,
           'box_loss': 0.10599466,
           'class_loss': 6.702197,
           'conf_loss': 15.478185,
           'precision50': 0.4453191,
           'recall50': 0.52279544},
     'global': {'total_loss': 106.96006},
     'learning_rate': 0.00261,
     'training_loss': 106.96006}
I0414 06:48:42.978124 140082688317248 controller.py:425] train | step:  115000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.68887055,
           'avg_obj': 0.22733958,
           'box_loss': 0.21271747,
           'class_loss': 10.094101,
           'conf_loss': 33.18269,
           'precision50': 0.21910107,
           'recall50': 0.118190914},
     '4': {'avg_iou': 0.77111346,
           'avg_obj': 0.38098502,
           'box_loss': 0.19070838,
           'class_loss': 10.488138,
           'conf_loss': 30.6701,
           'precision50': 0.3454871,
           'recall50': 0.30554038},
     '5': {'avg_iou': 0.8090935,
           'avg_obj': 0.5074389,
           'box_loss': 0.10623218,
           'class_loss': 6.7692623,
           'conf_loss': 15.631126,
           'precision50': 0.4434819,
           'recall50': 0.51640433},
     'global': {'total_loss': 107.34495},
     'learning_rate': 0.00261,
     'training_loss': 107.34495}
I0414 07:22:39.408705 140082688317248 controller.py:425] train | step:  120000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6903204,
           'avg_obj': 0.23026787,
           'box_loss': 0.2113334,
           'class_loss': 9.902566,
           'conf_loss': 32.874424,
           'precision50': 0.22035863,
           'recall50': 0.12037997},
     '4': {'avg_iou': 0.77278626,
           'avg_obj': 0.3864551,
           'box_loss': 0.1891411,
           'class_loss': 10.233467,
           'conf_loss': 30.313793,
           'precision50': 0.34734747,
           'recall50': 0.31095272},
     '5': {'avg_iou': 0.81066275,
           'avg_obj': 0.5129259,
           'box_loss': 0.10510786,
           'class_loss': 6.607352,
           'conf_loss': 15.400406,
           'precision50': 0.4443038,
           'recall50': 0.52311426},
     'global': {'total_loss': 105.8375},
     'learning_rate': 0.00261,
     'training_loss': 105.8375}
I0414 07:22:52.160539 140082688317248 controller.py:252]  eval | step:  120000 | running 625 steps of evaluation...
I0414 07:27:40.584290 140082688317248 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0414 07:31:52.441107 140082688317248 controller.py:261]  eval | step:  120000 | eval time:  540.3 sec | output: 
    {'3': {'avg_iou': 0.44500753,
           'avg_obj': 0.15636732,
           'box_loss': 0.14845118,
           'class_loss': 5.7020135,
           'conf_loss': 26.723488,
           'precision50': 0.20548029,
           'recall50': 0.13727085},
     '4': {'avg_iou': 0.6592981,
           'avg_obj': 0.3511286,
           'box_loss': 0.16306432,
           'class_loss': 6.999988,
           'conf_loss': 27.175282,
           'precision50': 0.3395536,
           'recall50': 0.3452557},
     '5': {'avg_iou': 0.79723215,
           'avg_obj': 0.562778,
           'box_loss': 0.1018816,
           'class_loss': 4.86605,
           'conf_loss': 15.121628,
           'precision50': 0.4168791,
           'recall50': 0.57348543},
     'AP': 0.35603726,
     'AP50': 0.5755607,
     'AP75': 0.3825779,
     'APl': 0.45315054,
     'APm': 0.31953177,
     'APs': 0.14450367,
     'ARl': 0.6401857,
     'ARm': 0.52872777,
     'ARmax1': 0.29885828,
     'ARmax10': 0.49973467,
     'ARmax100': 0.5461399,
     'ARs': 0.31492826,
     'global': {'total_loss': 87.00179},
     'validation_loss': 87.00179}
I0414 07:32:09.708512 140082688317248 controller.py:211] train | step:  120000 | training until step 140000...
I0414 08:04:21.510395 140082688317248 controller.py:425] train | step:  125000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.6913317,
           'avg_obj': 0.23342961,
           'box_loss': 0.21094775,
           'class_loss': 9.732861,
           'conf_loss': 32.69862,
           'precision50': 0.22189094,
           'recall50': 0.12276427},
     '4': {'avg_iou': 0.7743177,
           'avg_obj': 0.39105502,
           'box_loss': 0.18779115,
           'class_loss': 10.006445,
           'conf_loss': 30.015621,
           'precision50': 0.34811464,
           'recall50': 0.31470972},
     '5': {'avg_iou': 0.8127113,
           'avg_obj': 0.5196918,
           'box_loss': 0.10420145,
           'class_loss': 6.4488907,
           'conf_loss': 15.203872,
           'precision50': 0.44559926,
           'recall50': 0.5301426},
     'global': {'total_loss': 104.60918},
     'learning_rate': 0.00261,
     'training_loss': 104.60918}
I0414 08:05:11.899487 140082688317248 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-sig-bce/ckpt-125000.
I0414 08:37:57.779022 140082688317248 controller.py:425] train | step:  130000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.692481,
           'avg_obj': 0.23611853,
           'box_loss': 0.2115727,
           'class_loss': 9.663537,
           'conf_loss': 32.685993,
           'precision50': 0.22351976,
           'recall50': 0.124590494},
     '4': {'avg_iou': 0.7753127,
           'avg_obj': 0.39452755,
           'box_loss': 0.18743902,
           'class_loss': 9.921452,
           'conf_loss': 29.850866,
           'precision50': 0.34820428,
           'recall50': 0.31801403},
     '5': {'avg_iou': 0.81353754,
           'avg_obj': 0.5231803,
           'box_loss': 0.10358358,
           'class_loss': 6.35886,
           'conf_loss': 15.04991,
           'precision50': 0.4454137,
           'recall50': 0.53386277},
     'global': {'total_loss': 104.03322},
     'learning_rate': 0.00261,
     'training_loss': 104.03322}
I0414 09:12:28.348213 140082688317248 controller.py:425] train | step:  135000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.69380623,
           'avg_obj': 0.23798616,
           'box_loss': 0.2093687,
           'class_loss': 9.437022,
           'conf_loss': 32.371933,
           'precision50': 0.22379902,
           'recall50': 0.12506746},
     '4': {'avg_iou': 0.7765126,
           'avg_obj': 0.3972188,
           'box_loss': 0.18628903,
           'class_loss': 9.732232,
           'conf_loss': 29.665813,
           'precision50': 0.34882542,
           'recall50': 0.3201696},
     '5': {'avg_iou': 0.8146541,
           'avg_obj': 0.5260585,
           'box_loss': 0.103065066,
           'class_loss': 6.2633204,
           'conf_loss': 14.968722,
           'precision50': 0.4447629,
           'recall50': 0.53651446},
     'global': {'total_loss': 102.93786},
     'learning_rate': 0.00261,
     'training_loss': 102.93786}
I0414 09:45:47.001150 140082688317248 controller.py:425] train | step:  140000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6941386,
           'avg_obj': 0.23947129,
           'box_loss': 0.20835488,
           'class_loss': 9.356521,
           'conf_loss': 32.193577,
           'precision50': 0.22518069,
           'recall50': 0.12711656},
     '4': {'avg_iou': 0.7772534,
           'avg_obj': 0.39978606,
           'box_loss': 0.18486974,
           'class_loss': 9.583036,
           'conf_loss': 29.409584,
           'precision50': 0.35098523,
           'recall50': 0.32427716},
     '5': {'avg_iou': 0.815542,
           'avg_obj': 0.52943987,
           'box_loss': 0.10233069,
           'class_loss': 6.172492,
           'conf_loss': 14.8205595,
           'precision50': 0.44596514,
           'recall50': 0.5409439},
     'global': {'total_loss': 102.0313},
     'learning_rate': 0.00261,
     'training_loss': 102.0313}

saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-sig-bce/ckpt-105000.
train | step:  110000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6890231,
           'avg_obj': 0.22770627,
           'box_loss': 0.21325335,
           'class_loss': 10.084886,
           'conf_loss': 33.170425,
           'precision50': 0.2192101,
           'recall50': 0.118527286},
     '4': {'avg_iou': 0.77134645,
           'avg_obj': 0.3836408,
           'box_loss': 0.19105716,
           'class_loss': 10.424414,
           'conf_loss': 30.589506,
           'precision50': 0.34722927,
           'recall50': 0.30851832},
     '5': {'avg_iou': 0.8097651,
           'avg_obj': 0.5124324,
           'box_loss': 0.10599466,
           'class_loss': 6.702197,
           'conf_loss': 15.478185,
           'precision50': 0.4453191,
           'recall50': 0.52279544},
     'global': {'total_loss': 106.96006},
     'learning_rate': 0.00261,
     'training_loss': 106.96006}
train | step:  115000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.68887055,
           'avg_obj': 0.22733958,
           'box_loss': 0.21271747,
           'class_loss': 10.094101,
           'conf_loss': 33.18269,
           'precision50': 0.21910107,
           'recall50': 0.118190914},
     '4': {'avg_iou': 0.77111346,
           'avg_obj': 0.38098502,
           'box_loss': 0.19070838,
           'class_loss': 10.488138,
           'conf_loss': 30.6701,
           'precision50': 0.3454871,
           'recall50': 0.30554038},
     '5': {'avg_iou': 0.8090935,
           'avg_obj': 0.5074389,
           'box_loss': 0.10623218,
           'class_loss': 6.7692623,
           'conf_loss': 15.631126,
           'precision50': 0.4434819,
           'recall50': 0.51640433},
     'global': {'total_loss': 107.34495},
     'learning_rate': 0.00261,
     'training_loss': 107.34495}
train | step:  120000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6903204,
           'avg_obj': 0.23026787,
           'box_loss': 0.2113334,
           'class_loss': 9.902566,
           'conf_loss': 32.874424,
           'precision50': 0.22035863,
           'recall50': 0.12037997},
     '4': {'avg_iou': 0.77278626,
           'avg_obj': 0.3864551,
           'box_loss': 0.1891411,
           'class_loss': 10.233467,
           'conf_loss': 30.313793,
           'precision50': 0.34734747,
           'recall50': 0.31095272},
     '5': {'avg_iou': 0.81066275,
           'avg_obj': 0.5129259,
           'box_loss': 0.10510786,
           'class_loss': 6.607352,
           'conf_loss': 15.400406,
           'precision50': 0.4443038,
           'recall50': 0.52311426},
     'global': {'total_loss': 105.8375},
     'learning_rate': 0.00261,
     'training_loss': 105.8375}
 eval | step:  120000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=179.81s).
Accumulating evaluation results...
DONE (t=14.95s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.356
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.576
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.383
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.145
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.320
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.453
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.299
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.500
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.546
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.315
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.529
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.640
 eval | step:  120000 | eval time:  540.3 sec | output: 
    {'3': {'avg_iou': 0.44500753,
           'avg_obj': 0.15636732,
           'box_loss': 0.14845118,
           'class_loss': 5.7020135,
           'conf_loss': 26.723488,
           'precision50': 0.20548029,
           'recall50': 0.13727085},
     '4': {'avg_iou': 0.6592981,
           'avg_obj': 0.3511286,
           'box_loss': 0.16306432,
           'class_loss': 6.999988,
           'conf_loss': 27.175282,
           'precision50': 0.3395536,
           'recall50': 0.3452557},
     '5': {'avg_iou': 0.79723215,
           'avg_obj': 0.562778,
           'box_loss': 0.1018816,
           'class_loss': 4.86605,
           'conf_loss': 15.121628,
           'precision50': 0.4168791,
           'recall50': 0.57348543},
     'AP': 0.35603726,
     'AP50': 0.5755607,
     'AP75': 0.3825779,
     'APl': 0.45315054,
     'APm': 0.31953177,
     'APs': 0.14450367,
     'ARl': 0.6401857,
     'ARm': 0.52872777,
     'ARmax1': 0.29885828,
     'ARmax10': 0.49973467,
     'ARmax100': 0.5461399,
     'ARs': 0.31492826,
     'global': {'total_loss': 87.00179},
     'validation_loss': 87.00179}
train | step:  120000 | training until step 140000...
train | step:  125000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.6913317,
           'avg_obj': 0.23342961,
           'box_loss': 0.21094775,
           'class_loss': 9.732861,
           'conf_loss': 32.69862,
           'precision50': 0.22189094,
           'recall50': 0.12276427},
     '4': {'avg_iou': 0.7743177,
           'avg_obj': 0.39105502,
           'box_loss': 0.18779115,
           'class_loss': 10.006445,
           'conf_loss': 30.015621,
           'precision50': 0.34811464,
           'recall50': 0.31470972},
     '5': {'avg_iou': 0.8127113,
           'avg_obj': 0.5196918,
           'box_loss': 0.10420145,
           'class_loss': 6.4488907,
           'conf_loss': 15.203872,
           'precision50': 0.44559926,
           'recall50': 0.5301426},
     'global': {'total_loss': 104.60918},
     'learning_rate': 0.00261,
     'training_loss': 104.60918}
saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-sig-bce/ckpt-125000.
train | step:  130000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.692481,
           'avg_obj': 0.23611853,
           'box_loss': 0.2115727,
           'class_loss': 9.663537,
           'conf_loss': 32.685993,
           'precision50': 0.22351976,
           'recall50': 0.124590494},
     '4': {'avg_iou': 0.7753127,
           'avg_obj': 0.39452755,
           'box_loss': 0.18743902,
           'class_loss': 9.921452,
           'conf_loss': 29.850866,
           'precision50': 0.34820428,
           'recall50': 0.31801403},
     '5': {'avg_iou': 0.81353754,
           'avg_obj': 0.5231803,
           'box_loss': 0.10358358,
           'class_loss': 6.35886,
           'conf_loss': 15.04991,
           'precision50': 0.4454137,
           'recall50': 0.53386277},
     'global': {'total_loss': 104.03322},
     'learning_rate': 0.00261,
     'training_loss': 104.03322}
train | step:  135000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.69380623,
           'avg_obj': 0.23798616,
           'box_loss': 0.2093687,
           'class_loss': 9.437022,
           'conf_loss': 32.371933,
           'precision50': 0.22379902,
           'recall50': 0.12506746},
     '4': {'avg_iou': 0.7765126,
           'avg_obj': 0.3972188,
           'box_loss': 0.18628903,
           'class_loss': 9.732232,
           'conf_loss': 29.665813,
           'precision50': 0.34882542,
           'recall50': 0.3201696},
     '5': {'avg_iou': 0.8146541,
           'avg_obj': 0.5260585,
           'box_loss': 0.103065066,
           'class_loss': 6.2633204,
           'conf_loss': 14.968722,
           'precision50': 0.4447629,
           'recall50': 0.53651446},
     'global': {'total_loss': 102.93786},
     'learning_rate': 0.00261,
     'training_loss': 102.93786}
train | step:  140000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6941386,
           'avg_obj': 0.23947129,
           'box_loss': 0.20835488,
           'class_loss': 9.356521,
           'conf_loss': 32.193577,
           'precision50': 0.22518069,
           'recall50': 0.12711656},
     '4': {'avg_iou': 0.7772534,
           'avg_obj': 0.39978606,
           'box_loss': 0.18486974,
           'class_loss': 9.583036,
           'conf_loss': 29.409584,
           'precision50': 0.35098523,
           'recall50': 0.32427716},
     '5': {'avg_iou': 0.815542,
           'avg_obj': 0.52943987,
           'box_loss': 0.10233069,
           'class_loss': 6.172492,
           'conf_loss': 14.8205595,
           'precision50': 0.44596514,
           'recall50': 0.5409439},
     'global': {'total_loss': 102.0313},
     'learning_rate': 0.00261,
     'training_loss': 102.0313}I0414 09:45:59.944335 140082688317248 controller.py:252]  eval | step:  140000 | running 625 steps of evaluation...
I0414 09:50:45.905291 140082688317248 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0414 09:55:15.501011 140082688317248 controller.py:261]  eval | step:  140000 | eval time:  555.6 sec | output: 
    {'3': {'avg_iou': 0.44670287,
           'avg_obj': 0.15938541,
           'box_loss': 0.14708869,
           'class_loss': 5.5796704,
           'conf_loss': 26.507671,
           'precision50': 0.2073842,
           'recall50': 0.14066322},
     '4': {'avg_iou': 0.661718,
           'avg_obj': 0.3585047,
           'box_loss': 0.16099861,
           'class_loss': 6.8193116,
           'conf_loss': 26.873129,
           'precision50': 0.33517072,
           'recall50': 0.35156107},
     '5': {'avg_iou': 0.7998646,
           'avg_obj': 0.5745856,
           'box_loss': 0.10042089,
           'class_loss': 4.705271,
           'conf_loss': 14.897241,
           'precision50': 0.4144723,
           'recall50': 0.5829247},
     'AP': 0.36534724,
     'AP50': 0.58581054,
     'AP75': 0.3952604,
     'APl': 0.46416923,
     'APm': 0.32991156,
     'APs': 0.1525865,
     'ARl': 0.64299434,
     'ARm': 0.5365269,
     'ARmax1': 0.3020996,
     'ARmax10': 0.5038126,
     'ARmax100': 0.55060625,
     'ARs': 0.31409726,
     'global': {'total_loss': 85.790794},
     'validation_loss': 85.790794}
I0414 09:55:32.914570 140082688317248 controller.py:211] train | step:  140000 | training until step 160000...
I0414 10:43:02.694029 140082688317248 controller.py:425] train | step:  145000 | steps/sec:    1.5 | output: 
    {'3': {'avg_iou': 0.69510144,
           'avg_obj': 0.24201865,
           'box_loss': 0.20926592,
           'class_loss': 9.319428,
           'conf_loss': 32.23782,
           'precision50': 0.22645545,
           'recall50': 0.12898949},
     '4': {'avg_iou': 0.77821827,
           'avg_obj': 0.40321502,
           'box_loss': 0.18517657,
           'class_loss': 9.539117,
           'conf_loss': 29.38648,
           'precision50': 0.35097057,
           'recall50': 0.3265675},
     '5': {'avg_iou': 0.81662136,
           'avg_obj': 0.5327436,
           'box_loss': 0.10204283,
           'class_loss': 6.114959,
           'conf_loss': 14.758688,
           'precision50': 0.44499105,
           'recall50': 0.543297},
     'global': {'total_loss': 101.85308},
     'learning_rate': 0.00261,
     'training_loss': 101.85308}
I0414 10:43:55.159071 140082688317248 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-sig-bce/ckpt-145000.
I0414 12:04:14.002144 140082688317248 controller.py:425] train | step:  150000 | steps/sec:    1.0 | output: 
    {'3': {'avg_iou': 0.6957787,
           'avg_obj': 0.24305362,
           'box_loss': 0.20745157,
           'class_loss': 9.156568,
           'conf_loss': 31.960522,
           'precision50': 0.22647727,
           'recall50': 0.13024198},
     '4': {'avg_iou': 0.77935797,
           'avg_obj': 0.40552437,
           'box_loss': 0.18365957,
           'class_loss': 9.374457,
           'conf_loss': 29.144154,
           'precision50': 0.35174692,
           'recall50': 0.32956973},
     '5': {'avg_iou': 0.8173101,
           'avg_obj': 0.535531,
           'box_loss': 0.10151712,
           'class_loss': 6.019106,
           'conf_loss': 14.657219,
           'precision50': 0.44623405,
           'recall50': 0.5472718},
     'global': {'total_loss': 100.80458},
     'learning_rate': 0.00261,
     'training_loss': 100.80458}
I0414 13:25:16.717272 140082688317248 controller.py:425] train | step:  155000 | steps/sec:    1.0 | output: 
    {'3': {'avg_iou': 0.6966125,
           'avg_obj': 0.24546386,
           'box_loss': 0.20831367,
           'class_loss': 9.096567,
           'conf_loss': 31.994982,
           'precision50': 0.22831477,
           'recall50': 0.13110945},
     '4': {'avg_iou': 0.7798587,
           'avg_obj': 0.40749466,
           'box_loss': 0.18368761,
           'class_loss': 9.264796,
           'conf_loss': 29.056475,
           'precision50': 0.35239708,
           'recall50': 0.33182707},
     '5': {'avg_iou': 0.81798166,
           'avg_obj': 0.53697705,
           'box_loss': 0.10117551,
           'class_loss': 5.965601,
           'conf_loss': 14.596173,
           'precision50': 0.44622934,
           'recall50': 0.548268},
     'global': {'total_loss': 100.4678},
     'learning_rate': 0.00261,
     'training_loss': 100.4678}
I0414 14:45:41.454138 140082688317248 controller.py:425] train | step:  160000 | steps/sec:    1.0 | output: 
    {'3': {'avg_iou': 0.6974216,
           'avg_obj': 0.24733327,
           'box_loss': 0.20743632,
           'class_loss': 9.0139885,
           'conf_loss': 31.81489,
           'precision50': 0.22885525,
           'recall50': 0.13247529},
     '4': {'avg_iou': 0.7807457,
           'avg_obj': 0.41030493,
           'box_loss': 0.1830631,
           'class_loss': 9.194026,
           'conf_loss': 28.956932,
           'precision50': 0.35165524,
           'recall50': 0.33355558},
     '5': {'avg_iou': 0.8186548,
           'avg_obj': 0.54050505,
           'box_loss': 0.100982815,
           'class_loss': 5.8995924,
           'conf_loss': 14.513205,
           'precision50': 0.44677162,
           'recall50': 0.55252254},
     'global': {'total_loss': 99.88404},
     'learning_rate': 0.00261,
     'training_loss': 99.88404}
I0414 14:45:56.048310 140082688317248 controller.py:252]  eval | step:  160000 | running 625 steps of evaluation...
I0414 14:51:49.914177 140082688317248 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0414 14:55:59.475711 140082688317248 controller.py:261]  eval | step:  160000 | eval time:  603.4 sec | output: 
    {'3': {'avg_iou': 0.44773242,
           'avg_obj': 0.16326015,
           'box_loss': 0.14613916,
           'class_loss': 5.4572396,
           'conf_loss': 26.362257,
           'precision50': 0.20931551,
           'recall50': 0.14335087},
     '4': {'avg_iou': 0.6630745,
           'avg_obj': 0.367272,
           'box_loss': 0.15961783,
           'class_loss': 6.679453,
           'conf_loss': 26.669693,
           'precision50': 0.33681253,
           'recall50': 0.3628797},
     '5': {'avg_iou': 0.8023037,
           'avg_obj': 0.58274776,
           'box_loss': 0.09901562,
           'class_loss': 4.643847,
           'conf_loss': 14.725726,
           'precision50': 0.41199747,
           'recall50': 0.5916133},
     'AP': 0.3711339,
     'AP50': 0.5925478,
     'AP75': 0.40426543,
     'APl': 0.47372544,
     'APm': 0.33558202,
     'APs': 0.15393637,
     'ARl': 0.65160775,
     'ARm': 0.5374829,
     'ARmax1': 0.30567655,
     'ARmax10': 0.5082648,
     'ARmax100': 0.5544623,
     'ARs': 0.31600052,
     'global': {'total_loss': 84.94294},
     'validation_loss': 84.94294}

 eval | step:  140000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=185.39s).
Accumulating evaluation results...
DONE (t=17.37s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.365
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.586
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.395
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.153
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.330
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.464
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.302
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.504
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.551
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.314
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.537
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.643
 eval | step:  140000 | eval time:  555.6 sec | output: 
    {'3': {'avg_iou': 0.44670287,
           'avg_obj': 0.15938541,
           'box_loss': 0.14708869,
           'class_loss': 5.5796704,
           'conf_loss': 26.507671,
           'precision50': 0.2073842,
           'recall50': 0.14066322},
     '4': {'avg_iou': 0.661718,
           'avg_obj': 0.3585047,
           'box_loss': 0.16099861,
           'class_loss': 6.8193116,
           'conf_loss': 26.873129,
           'precision50': 0.33517072,
           'recall50': 0.35156107},
     '5': {'avg_iou': 0.7998646,
           'avg_obj': 0.5745856,
           'box_loss': 0.10042089,
           'class_loss': 4.705271,
           'conf_loss': 14.897241,
           'precision50': 0.4144723,
           'recall50': 0.5829247},
     'AP': 0.36534724,
     'AP50': 0.58581054,
     'AP75': 0.3952604,
     'APl': 0.46416923,
     'APm': 0.32991156,
     'APs': 0.1525865,
     'ARl': 0.64299434,
     'ARm': 0.5365269,
     'ARmax1': 0.3020996,
     'ARmax10': 0.5038126,
     'ARmax100': 0.55060625,
     'ARs': 0.31409726,
     'global': {'total_loss': 85.790794},
     'validation_loss': 85.790794}
train | step:  140000 | training until step 160000...
train | step:  145000 | steps/sec:    1.5 | output: 
    {'3': {'avg_iou': 0.69510144,
           'avg_obj': 0.24201865,
           'box_loss': 0.20926592,
           'class_loss': 9.319428,
           'conf_loss': 32.23782,
           'precision50': 0.22645545,
           'recall50': 0.12898949},
     '4': {'avg_iou': 0.77821827,
           'avg_obj': 0.40321502,
           'box_loss': 0.18517657,
           'class_loss': 9.539117,
           'conf_loss': 29.38648,
           'precision50': 0.35097057,
           'recall50': 0.3265675},
     '5': {'avg_iou': 0.81662136,
           'avg_obj': 0.5327436,
           'box_loss': 0.10204283,
           'class_loss': 6.114959,
           'conf_loss': 14.758688,
           'precision50': 0.44499105,
           'recall50': 0.543297},
     'global': {'total_loss': 101.85308},
     'learning_rate': 0.00261,
     'training_loss': 101.85308}
saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-sig-bce/ckpt-145000.
train | step:  150000 | steps/sec:    1.0 | output: 
    {'3': {'avg_iou': 0.6957787,
           'avg_obj': 0.24305362,
           'box_loss': 0.20745157,
           'class_loss': 9.156568,
           'conf_loss': 31.960522,
           'precision50': 0.22647727,
           'recall50': 0.13024198},
     '4': {'avg_iou': 0.77935797,
           'avg_obj': 0.40552437,
           'box_loss': 0.18365957,
           'class_loss': 9.374457,
           'conf_loss': 29.144154,
           'precision50': 0.35174692,
           'recall50': 0.32956973},
     '5': {'avg_iou': 0.8173101,
           'avg_obj': 0.535531,
           'box_loss': 0.10151712,
           'class_loss': 6.019106,
           'conf_loss': 14.657219,
           'precision50': 0.44623405,
           'recall50': 0.5472718},
     'global': {'total_loss': 100.80458},
     'learning_rate': 0.00261,
     'training_loss': 100.80458}
train | step:  155000 | steps/sec:    1.0 | output: 
    {'3': {'avg_iou': 0.6966125,
           'avg_obj': 0.24546386,
           'box_loss': 0.20831367,
           'class_loss': 9.096567,
           'conf_loss': 31.994982,
           'precision50': 0.22831477,
           'recall50': 0.13110945},
     '4': {'avg_iou': 0.7798587,
           'avg_obj': 0.40749466,
           'box_loss': 0.18368761,
           'class_loss': 9.264796,
           'conf_loss': 29.056475,
           'precision50': 0.35239708,
           'recall50': 0.33182707},
     '5': {'avg_iou': 0.81798166,
           'avg_obj': 0.53697705,
           'box_loss': 0.10117551,
           'class_loss': 5.965601,
           'conf_loss': 14.596173,
           'precision50': 0.44622934,
           'recall50': 0.548268},
     'global': {'total_loss': 100.4678},
     'learning_rate': 0.00261,
     'training_loss': 100.4678}
train | step:  160000 | steps/sec:    1.0 | output: 
    {'3': {'avg_iou': 0.6974216,
           'avg_obj': 0.24733327,
           'box_loss': 0.20743632,
           'class_loss': 9.0139885,
           'conf_loss': 31.81489,
           'precision50': 0.22885525,
           'recall50': 0.13247529},
     '4': {'avg_iou': 0.7807457,
           'avg_obj': 0.41030493,
           'box_loss': 0.1830631,
           'class_loss': 9.194026,
           'conf_loss': 28.956932,
           'precision50': 0.35165524,
           'recall50': 0.33355558},
     '5': {'avg_iou': 0.8186548,
           'avg_obj': 0.54050505,
           'box_loss': 0.100982815,
           'class_loss': 5.8995924,
           'conf_loss': 14.513205,
           'precision50': 0.44677162,
           'recall50': 0.55252254},
     'global': {'total_loss': 99.88404},
     'learning_rate': 0.00261,
     'training_loss': 99.88404}
 eval | step:  160000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.87s).
Accumulating evaluation results...
DONE (t=14.26s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.371
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.593
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.404
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.154
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.336
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.474
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.306
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.508
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.554
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.316
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.537
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.652
 eval | step:  160000 | eval time:  603.4 sec | output: 
    {'3': {'avg_iou': 0.44773242,
           'avg_obj': 0.16326015,
           'box_loss': 0.14613916,
           'class_loss': 5.4572396,
           'conf_loss': 26.362257,
           'precision50': 0.20931551,
           'recall50': 0.14335087},
     '4': {'avg_iou': 0.6630745,
           'avg_obj': 0.367272,
           'box_loss': 0.15961783,
           'class_loss': 6.679453,
           'conf_loss': 26.669693,
           'precision50': 0.33681253,
           'recall50': 0.3628797},
     '5': {'avg_iou': 0.8023037,
           'avg_obj': 0.58274776,
           'box_loss': 0.09901562,
           'class_loss': 4.643847,
           'conf_loss': 14.725726,
           'precision50': 0.41199747,
           'recall50': 0.5916133},
     'AP': 0.3711339,
     'AP50': 0.5925478,
     'AP75': 0.40426543,
     'APl': 0.47372544,
     'APm': 0.33558202,
     'APs': 0.15393637,
     'ARl': 0.65160775,
     'ARm': 0.5374829,
     'ARmax1': 0.30567655,
     'ARmax10': 0.5082648,
     'ARmax100': 0.5544623,
     'ARs': 0.31600052,
     'global': {'total_loss': 84.94294},
     'validation_loss': 84.94294}I0414 14:56:16.980493 140082688317248 controller.py:211] train | step:  160000 | training until step 180000...
I0414 15:43:20.732407 140082688317248 controller.py:425] train | step:  165000 | steps/sec:    1.4 | output: 
    {'3': {'avg_iou': 0.6978352,
           'avg_obj': 0.24856927,
           'box_loss': 0.20702048,
           'class_loss': 8.933525,
           'conf_loss': 31.710371,
           'precision50': 0.22930193,
           'recall50': 0.13330661},
     '4': {'avg_iou': 0.78155476,
           'avg_obj': 0.4131334,
           'box_loss': 0.18207867,
           'class_loss': 9.072105,
           'conf_loss': 28.736637,
           'precision50': 0.35328442,
           'recall50': 0.33716583},
     '5': {'avg_iou': 0.8196151,
           'avg_obj': 0.542263,
           'box_loss': 0.10025816,
           'class_loss': 5.8111677,
           'conf_loss': 14.423086,
           'precision50': 0.44671676,
           'recall50': 0.55420345},
     'global': {'total_loss': 99.17649},
     'learning_rate': 0.00261,
     'training_loss': 99.17649}
I0414 15:44:11.573407 140082688317248 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-mean-og-pip-sig-bce/ckpt-165000.
I0414 17:03:58.450279 140082688317248 controller.py:425] train | step:  170000 | steps/sec:    1.0 | output: 
    {'3': {'avg_iou': 0.6985494,
           'avg_obj': 0.25016007,
           'box_loss': 0.2061747,
           'class_loss': 8.859155,
           'conf_loss': 31.592537,
           'precision50': 0.23044144,
           'recall50': 0.13451897},
     '4': {'avg_iou': 0.7823876,
           'avg_obj': 0.41593683,
           'box_loss': 0.18160209,
           'class_loss': 9.0206995,
           'conf_loss': 28.626673,
           'precision50': 0.35259113,
           'recall50': 0.3386302},
     '5': {'avg_iou': 0.8202886,
           'avg_obj': 0.5446142,
           'box_loss': 0.0997686,
           'class_loss': 5.750545,
           'conf_loss': 14.326578,
           'precision50': 0.44628844,
           'recall50': 0.5563677},
     'global': {'total_loss': 98.663734},
     'learning_rate': 0.00261,
     'training_loss': 98.663734}
I0414 18:27:59.864447 140082688317248 controller.py:425] train | step:  175000 | steps/sec:    1.0 | output: 
    {'3': {'avg_iou': 0.6994811,
           'avg_obj': 0.25231504,
           'box_loss': 0.20491682,
           'class_loss': 8.76315,
           'conf_loss': 31.3492,
           'precision50': 0.2311616,
           'recall50': 0.13613652},
     '4': {'avg_iou': 0.7830405,
           'avg_obj': 0.41746947,
           'box_loss': 0.18045203,
           'class_loss': 8.866619,
           'conf_loss': 28.433132,
           'precision50': 0.3532995,
           'recall50': 0.34061185},
     '5': {'avg_iou': 0.82103574,
           'avg_obj': 0.54726774,
           'box_loss': 0.09938069,
           'class_loss': 5.675619,
           'conf_loss': 14.243172,
           'precision50': 0.44593737,
           'recall50': 0.5597065},
     'global': {'total_loss': 97.81552},
     'learning_rate': 0.00261,
     'training_loss': 97.81552}
I0414 19:51:48.819965 140082688317248 controller.py:425] train | step:  180000 | steps/sec:    1.0 | output: 
    {'3': {'avg_iou': 0.6993604,
           'avg_obj': 0.2540105,
           'box_loss': 0.2063176,
           'class_loss': 8.723738,
           'conf_loss': 31.435844,
           'precision50': 0.23189077,
           'recall50': 0.13743196},
     '4': {'avg_iou': 0.78358483,
           'avg_obj': 0.41897798,
           'box_loss': 0.18026529,
           'class_loss': 8.805995,
           'conf_loss': 28.361237,
           'precision50': 0.3518377,
           'recall50': 0.34161204},
     '5': {'avg_iou': 0.8216935,
           'avg_obj': 0.5493698,
           'box_loss': 0.0990167,
           'class_loss': 5.626165,
           'conf_loss': 14.170294,
           'precision50': 0.4455721,
           'recall50': 0.5615331},
     'global': {'total_loss': 97.60879},
     'learning_rate': 0.00261,
     'training_loss': 97.60879}
I0414 19:52:01.628843 140082688317248 controller.py:252]  eval | step:  180000 | running 625 steps of evaluation...
I0414 19:57:11.015004 140082688317248 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0414 20:01:25.380450 140082688317248 controller.py:261]  eval | step:  180000 | eval time:  563.8 sec | output: 
    {'3': {'avg_iou': 0.44847515,
           'avg_obj': 0.166387,
           'box_loss': 0.14557381,
           'class_loss': 5.461386,
           'conf_loss': 26.22775,
           'precision50': 0.21011953,
           'recall50': 0.14714949},
     '4': {'avg_iou': 0.6645561,
           'avg_obj': 0.37087718,
           'box_loss': 0.15851946,
           'class_loss': 6.6713986,
           'conf_loss': 26.527945,
           'precision50': 0.33823177,
           'recall50': 0.36700025},
     '5': {'avg_iou': 0.8032229,
           'avg_obj': 0.58885455,
           'box_loss': 0.0985865,
           'class_loss': 4.590771,
           'conf_loss': 14.612206,
           'precision50': 0.41075304,
           'recall50': 0.5998475},
     'AP': 0.3749446,
     'AP50': 0.59624547,
     'AP75': 0.41142824,
     'APl': 0.47751868,
     'APm': 0.33796844,
     'APs': 0.14777091,
     'ARl': 0.6560298,
     'ARm': 0.53735805,
     'ARmax1': 0.30681804,
     'ARmax10': 0.51154345,
     'ARmax100': 0.55806744,
     'ARs': 0.31441087,
     'global': {'total_loss': 84.49412},
     'validation_loss': 84.49412}
I0414 20:01:46.177361 140082688317248 controller.py:211] train | step:  180000 | training until step 200000...
/home/cam2tensorflow/.experiment_start.sh: line 22: 10401 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4-$5
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   216    0     2  100   214     12   1363 --:--:-- --:--:-- --:--:--  1367100   216    0     2  100   214     12   1363 --:--:-- --:--:-- --:--:--  1367
okRequest issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-14T20:19:07.657362406Z'
  endTime: '2021-04-14T20:19:58.854851646Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618431547643-5bff4757d97a4-c54a552d-2838e534
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618431547643-5bff4757d97a4-c54a552d-2838e534] to complete...
.....................................................................................................................................................................................................................................................................................done.
