cat: .experiment_zone: No such file or directory
Request issued for: [node-5]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-11T19:32:39.021635284Z'
  endTime: '2021-04-11T19:33:17.372121853Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618169559010-5bfb775c04bfd-9b890157-85a77688
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618169559010-5bfb775c04bfd-9b890157-85a77688] to complete...
.......................................................................................................................................................................................................done.
europe-west4-a
I0411 19:32:28.506117 139774564738880 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.075,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.2,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 0.6,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.05,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.2,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.667,
                                                    'output_size': [640, 640],
                                                    'random_crop': True,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': 'str = "AP50"',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'str = "higher"',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine_epoch': {'alpha': 0.2,
                                                                     'decay_steps': 294375,
                                                                     'initial_learning_rate': 0.01,
                                                                     'name': 'CosineEpoch',
                                                                     'steps_per_epoch': 1875},
                                                    'type': 'cosine_epoch'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.937,
                                                        'name': 'SGD',
                                                        'nesterov': False},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5625},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0411 19:32:28.507014 139774564738880 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_testing/all-og/params.yaml
I0411 19:32:30.024616 139774564738880 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 19:32:30.642763 139774564738880 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0411 19:32:30.643012 139774564738880 transport.py:157] Attempting refresh to obtain initial access_token
I0411 19:32:30.698801 139774564738880 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 19:32:31.310787 139774564738880 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0411 19:32:31.311060 139774564738880 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-11 19:32:31.352457: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0411 19:32:31.353127 139774564738880 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 19:32:31.969636 139774564738880 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0411 19:32:31.969859 139774564738880 transport.py:157] Attempting refresh to obtain initial access_token
I0411 19:32:32.012003 139774564738880 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 19:32:32.627684 139774564738880 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0411 19:32:32.627977 139774564738880 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-11 19:32:32.671233: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-11 19:32:32.681361: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.56.217.90:8470}
2021-04-11 19:32:32.681424: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:32852}
2021-04-11 19:33:07.987780: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.56.217.90:8470}
2021-04-11 19:33:07.987884: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:32852}
2021-04-11 19:33:07.988454: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:32852
I0411 19:33:07.989229 139774564738880 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-5
I0411 19:33:07.990169 139774564738880 tpu_strategy_util.py:74] Initializing the TPU system: node-5
INFO:tensorflow:Clearing out eager caches
I0411 19:33:16.446434 139774564738880 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0411 19:33:16.448448 139774564738880 tpu_strategy_util.py:133] Finished initializing TPU system.
I0411 19:33:16.449780 139774564738880 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 19:33:17.073311 139774564738880 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0411 19:33:17.073541 139774564738880 transport.py:157] Attempting refresh to obtain initial access_token
I0411 19:33:17.135374 139774564738880 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 19:33:17.748530 139774564738880 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0411 19:33:17.748753 139774564738880 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0411 19:33:17.807869 139774564738880 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0411 19:33:17.808076 139774564738880 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0411 19:33:17.808320 139774564738880 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0411 19:33:17.808369 139774564738880 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0411 19:33:17.808414 139774564738880 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0411 19:33:17.808527 139774564738880 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0411 19:33:17.808579 139774564738880 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0411 19:33:17.808622 139774564738880 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0411 19:33:17.808674 139774564738880 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0411 19:33:17.808717 139774564738880 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0411 19:33:17.808758 139774564738880 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0411 19:33:17.808799 139774564738880 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0411 19:33:17.808863 139774564738880 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0411 19:33:17.808910 139774564738880 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0411 19:33:17.808951 139774564738880 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0411 19:33:17.808992 139774564738880 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0411 19:33:17.833467 139774564738880 train_utils.py:214] Running default trainer.
2021-04-11 19:33:17.849071: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.05, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.6, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.667, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': False, 'momentum': 0.937}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine_epoch', 'cosine_epoch': {'name': 'CosineEpoch', 'initial_learning_rate': 0.01, 'decay_steps': 294375, 'steps_per_epoch': 1875, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5625}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': 'str = "AP50"', 'best_checkpoint_metric_comp': 'str = "higher"', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
{'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f1f69076b38>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
route_split 512.0 512.0
conv2 512.0
conv1 512.0
spp
conv1 512.0
conv2 512.0
connect
conv1 512.0
8
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
route_split 256.0 256.0
conv2 256.0
conv1 256.0
conv2 256.0
connect
conv1 256.0
6
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)








 ListWrapper([128, 256, 512])
route_split 128 128
conv2 128
conv1 128
conv2 128
connect
conv1 128
conv2 256
7
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
route_split 256 256
conv2 256
conv1 256
conv2 256
connect
conv1 256
conv2 512
7
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
route_split 512 512
conv2 512
conv1 512
conv2 512
connect
conv1 512
conv2 1024
7
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
detget {'3': 2.0, '4': 2.0, '5': 2.0}I0411 19:34:05.038078 139774564738880 controller.py:362] restoring or initializing model...
I0411 19:34:13.395524 139774564738880 yolo.py:519] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0411 19:34:13.398155 139774564738880 controller.py:368] initialized model.
I0411 19:34:13.398531 139774564738880 train_lib.py:96] Starts to execute mode: train_and_eval
I0411 19:34:13.403203 139774564738880 controller.py:211] train | step:      0 | training until step 20000...
I0411 19:34:22.229007 139774564738880 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0411 19:34:55.848080 139774564738880 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
/home/cam2tensorflow/.experiment_start.sh: line 22:  2852 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   207    0     2  100   205     11   1220 --:--:-- --:--:-- --:--:--  1224100   207    0     2  100   205     11   1220 --:--:-- --:--:-- --:--:--  1224
okRequest issued for: [node-5]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-11T19:58:16.400044234Z'
  endTime: '2021-04-11T19:58:52.597259248Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618171096388-5bfb7d162d2f4-18cddc42-2d31b046
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618171096388-5bfb7d162d2f4-18cddc42-2d31b046] to complete...
.............................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-5]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-11T20:18:16.452134207Z'
  endTime: '2021-04-11T20:18:51.461488649Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618172296425-5bfb818e9f02d-6bf46797-df5b929a
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618172296425-5bfb818e9f02d-6bf46797-df5b929a] to complete...
.................................................................................................................................................................................................done.
europe-west4-a
I0411 20:18:04.677865 140660118681408 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.075,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.2,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 0.6,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.05,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.2,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.667,
                                                    'output_size': [640, 640],
                                                    'random_crop': True,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': 'str = "AP50"',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'str = "higher"',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine_epoch': {'alpha': 0.2,
                                                                     'decay_steps': 294375,
                                                                     'initial_learning_rate': 0.01,
                                                                     'name': 'CosineEpoch',
                                                                     'steps_per_epoch': 1875},
                                                    'type': 'cosine_epoch'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.937,
                                                        'name': 'SGD',
                                                        'nesterov': False},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5625},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0411 20:18:04.678792 140660118681408 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_testing/all-og/params.yaml
I0411 20:18:05.565595 140660118681408 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 20:18:06.182206 140660118681408 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0411 20:18:06.182482 140660118681408 transport.py:157] Attempting refresh to obtain initial access_token
I0411 20:18:06.238701 140660118681408 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 20:18:06.853099 140660118681408 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0411 20:18:06.853546 140660118681408 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-11 20:18:06.909014: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0411 20:18:06.909723 140660118681408 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 20:18:07.053980 140660118681408 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0411 20:18:07.054228 140660118681408 transport.py:157] Attempting refresh to obtain initial access_token
I0411 20:18:07.096559 140660118681408 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 20:18:07.717279 140660118681408 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0411 20:18:07.717567 140660118681408 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-11 20:18:07.789177: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-11 20:18:07.805753: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.56.217.90:8470}
2021-04-11 20:18:07.805829: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:33914}
2021-04-11 20:18:47.899135: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.56.217.90:8470}
2021-04-11 20:18:47.899224: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:33914}
2021-04-11 20:18:47.900124: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:33914
I0411 20:18:47.901158 140660118681408 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-5
I0411 20:18:47.902095 140660118681408 tpu_strategy_util.py:74] Initializing the TPU system: node-5
INFO:tensorflow:Clearing out eager caches
I0411 20:18:56.659879 140660118681408 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0411 20:18:56.662009 140660118681408 tpu_strategy_util.py:133] Finished initializing TPU system.
I0411 20:18:56.663251 140660118681408 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 20:18:57.281473 140660118681408 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0411 20:18:57.281803 140660118681408 transport.py:157] Attempting refresh to obtain initial access_token
I0411 20:18:57.344643 140660118681408 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 20:18:57.485156 140660118681408 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0411 20:18:57.485430 140660118681408 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0411 20:18:57.540925 140660118681408 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0411 20:18:57.541234 140660118681408 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0411 20:18:57.541639 140660118681408 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0411 20:18:57.541850 140660118681408 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0411 20:18:57.541949 140660118681408 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0411 20:18:57.542348 140660118681408 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0411 20:18:57.542498 140660118681408 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0411 20:18:57.542614 140660118681408 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0411 20:18:57.542821 140660118681408 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0411 20:18:57.542966 140660118681408 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0411 20:18:57.543091 140660118681408 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0411 20:18:57.543255 140660118681408 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0411 20:18:57.543356 140660118681408 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0411 20:18:57.543447 140660118681408 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0411 20:18:57.543535 140660118681408 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0411 20:18:57.543622 140660118681408 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0411 20:18:57.566900 140660118681408 train_utils.py:214] Running default trainer.
2021-04-11 20:18:57.582215: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.05, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.6, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.667, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': False, 'momentum': 0.937}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine_epoch', 'cosine_epoch': {'name': 'CosineEpoch', 'initial_learning_rate': 0.01, 'decay_steps': 294375, 'steps_per_epoch': 1875, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5625}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': 'str = "AP50"', 'best_checkpoint_metric_comp': 'str = "higher"', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
{'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7fed981118d0>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
route_split 512.0 512.0
conv2 512.0
conv1 512.0
spp
conv1 512.0
conv2 512.0
connect
conv1 512.0
8
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
route_split 256.0 256.0
conv2 256.0
conv1 256.0
conv2 256.0
connect
conv1 256.0
6
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)








 ListWrapper([128, 256, 512])
route_split 128 128
conv2 128
conv1 128
conv2 128
connect
conv1 128
conv2 256
7
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
route_split 256 256
conv2 256
conv1 256
conv2 256
connect
conv1 256
conv2 512
7
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
route_split 512 512
conv2 512
conv1 512
conv2 512
connect
conv1 512
conv2 1024
7
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
detget {'3': 2.0, '4': 2.0, '5': 2.0}I0411 20:19:47.476293 140660118681408 controller.py:362] restoring or initializing model...
I0411 20:19:56.428359 140660118681408 yolo.py:519] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0411 20:19:56.429937 140660118681408 controller.py:368] initialized model.
I0411 20:19:56.430130 140660118681408 train_lib.py:96] Starts to execute mode: train_and_eval
I0411 20:19:56.435448 140660118681408 controller.py:211] train | step:      0 | training until step 20000...
I0411 20:20:03.192300 140660118681408 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0411 20:20:38.457655 140660118681408 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0411 20:57:01.192324 140660118681408 controller.py:425] train | step:   5000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.44440177,
           'avg_obj': 0.083543465,
           'box_loss': 0.020903911,
           'class_loss': 0.09748325,
           'conf_loss': 0.36737844,
           'precision50': 0.0108557595,
           'recall50': 0.03089607},
     '4': {'avg_iou': 0.48007992,
           'avg_obj': 0.13992721,
           'box_loss': 0.023433134,
           'class_loss': 0.109993495,
           'conf_loss': 0.13832965,
           'precision50': 0.07554132,
           'recall50': 0.07817869},
     '5': {'avg_iou': 0.4911126,
           'avg_obj': 0.17267065,
           'box_loss': 0.024898903,
           'class_loss': 0.1102111,
           'conf_loss': 0.057985045,
           'precision50': 0.19989553,
           'recall50': 0.08048956},
     'global': {'total_loss': 7.604936},
     'learning_rate': 0.006238453,
     'training_loss': 7.604936}
I0411 20:57:53.264063 140660118681408 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-og/ckpt-5000.
I0411 21:29:24.023560 140660118681408 controller.py:425] train | step:  10000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.5553163,
           'avg_obj': 0.076337054,
           'box_loss': 0.016447421,
           'class_loss': 0.012242672,
           'conf_loss': 0.01535968,
           'precision50': 0.11892423,
           'recall50': 0.012490523},
     '4': {'avg_iou': 0.6164343,
           'avg_obj': 0.14380588,
           'box_loss': 0.016903888,
           'class_loss': 0.013018639,
           'conf_loss': 0.019234862,
           'precision50': 0.36529627,
           'recall50': 0.05685284},
     '5': {'avg_iou': 0.6586604,
           'avg_obj': 0.22865579,
           'box_loss': 0.016412396,
           'class_loss': 0.012365734,
           'conf_loss': 0.019322915,
           'precision50': 0.5577559,
           'recall50': 0.14389145},
     'global': {'total_loss': 1.1304654},
     'learning_rate': 0.009979997,
     'training_loss': 1.1304654}
I0411 22:01:06.292459 140660118681408 controller.py:425] train | step:  15000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.5865659,
           'avg_obj': 0.108039774,
           'box_loss': 0.015302395,
           'class_loss': 0.009292052,
           'conf_loss': 0.014589061,
           'precision50': 0.20120834,
           'recall50': 0.028565874},
     '4': {'avg_iou': 0.66121614,
           'avg_obj': 0.19534917,
           'box_loss': 0.014839743,
           'class_loss': 0.0095342975,
           'conf_loss': 0.018264918,
           'precision50': 0.4961385,
           'recall50': 0.11034005},
     '5': {'avg_iou': 0.7098176,
           'avg_obj': 0.29561424,
           'box_loss': 0.013823964,
           'class_loss': 0.009098263,
           'conf_loss': 0.018247187,
           'precision50': 0.67380404,
           'recall50': 0.2472953},
     'global': {'total_loss': 0.9839364},
     'learning_rate': 0.009948857,
     'training_loss': 0.9839364}

(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 80, 80, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 640, 640, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 400, 8), 5: (8, 200, 8)}, inds: {3: (8, 600, 3), 4: (8, 400, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 80, 80, 3, 1), 4: (8, 40, 40, 3, 1), 5: (8, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 640, 640, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 80, 80, 3, 1), 4: (1, 40, 40, 3, 1), 5: (1, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
train | step:   5000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.44440177,
           'avg_obj': 0.083543465,
           'box_loss': 0.020903911,
           'class_loss': 0.09748325,
           'conf_loss': 0.36737844,
           'precision50': 0.0108557595,
           'recall50': 0.03089607},
     '4': {'avg_iou': 0.48007992,
           'avg_obj': 0.13992721,
           'box_loss': 0.023433134,
           'class_loss': 0.109993495,
           'conf_loss': 0.13832965,
           'precision50': 0.07554132,
           'recall50': 0.07817869},
     '5': {'avg_iou': 0.4911126,
           'avg_obj': 0.17267065,
           'box_loss': 0.024898903,
           'class_loss': 0.1102111,
           'conf_loss': 0.057985045,
           'precision50': 0.19989553,
           'recall50': 0.08048956},
     'global': {'total_loss': 7.604936},
     'learning_rate': 0.006238453,
     'training_loss': 7.604936}
saved checkpoint to gs://tensorflow2/config_testing/all-og/ckpt-5000.
train | step:  10000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.5553163,
           'avg_obj': 0.076337054,
           'box_loss': 0.016447421,
           'class_loss': 0.012242672,
           'conf_loss': 0.01535968,
           'precision50': 0.11892423,
           'recall50': 0.012490523},
     '4': {'avg_iou': 0.6164343,
           'avg_obj': 0.14380588,
           'box_loss': 0.016903888,
           'class_loss': 0.013018639,
           'conf_loss': 0.019234862,
           'precision50': 0.36529627,
           'recall50': 0.05685284},
     '5': {'avg_iou': 0.6586604,
           'avg_obj': 0.22865579,
           'box_loss': 0.016412396,
           'class_loss': 0.012365734,
           'conf_loss': 0.019322915,
           'precision50': 0.5577559,
           'recall50': 0.14389145},
     'global': {'total_loss': 1.1304654},
     'learning_rate': 0.009979997,
     'training_loss': 1.1304654}
train | step:  15000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.5865659,
           'avg_obj': 0.108039774,
           'box_loss': 0.015302395,
           'class_loss': 0.009292052,
           'conf_loss': 0.014589061,
           'precision50': 0.20120834,
           'recall50': 0.028565874},
     '4': {'avg_iou': 0.66121614,
           'avg_obj': 0.19534917,
           'box_loss': 0.014839743,
           'class_loss': 0.0095342975,
           'conf_loss': 0.018264918,
           'precision50': 0.4961385,
           'recall50': 0.11034005},
     '5': {'avg_iou': 0.7098176,
           'avg_obj': 0.29561424,
           'box_loss': 0.013823964,
           'class_loss': 0.009098263,
           'conf_loss': 0.018247187,
           'precision50': 0.67380404,
           'recall50': 0.2472953},
     'global': {'total_loss': 0.9839364},
     'learning_rate': 0.009948857,
     'training_loss': 0.9839364}I0411 22:32:51.016724 140660118681408 controller.py:425] train | step:  20000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6027034,
           'avg_obj': 0.12463616,
           'box_loss': 0.0147217885,
           'class_loss': 0.00826846,
           'conf_loss': 0.014285188,
           'precision50': 0.23852211,
           'recall50': 0.040267903},
     '4': {'avg_iou': 0.6801106,
           'avg_obj': 0.21998519,
           'box_loss': 0.013998715,
           'class_loss': 0.008315189,
           'conf_loss': 0.017836425,
           'precision50': 0.53454953,
           'recall50': 0.14059235},
     '5': {'avg_iou': 0.73036593,
           'avg_obj': 0.3268102,
           'box_loss': 0.01277393,
           'class_loss': 0.007881988,
           'conf_loss': 0.017719619,
           'precision50': 0.7028918,
           'recall50': 0.2973526},
     'global': {'total_loss': 0.9264098},
     'learning_rate': 0.009920185,
     'training_loss': 0.9264098}
I0411 22:33:05.286701 140660118681408 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0411 22:33:05.958224 140660118681408 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0411 22:33:23.656051 140660118681408 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0411 22:38:33.537763 140660118681408 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0411 22:42:34.861292 140660118681408 controller.py:261]  eval | step:  20000 | eval time:  569.6 sec | output: 
    {'3': {'avg_iou': 0.41563705,
           'avg_obj': 0.12000155,
           'box_loss': 0.009038993,
           'class_loss': 0.003990848,
           'conf_loss': 0.0058995374,
           'precision50': 0.13340147,
           'recall50': 0.08677029},
     '4': {'avg_iou': 0.62515205,
           'avg_obj': 0.26898932,
           'box_loss': 0.010198746,
           'class_loss': 0.0045704893,
           'conf_loss': 0.007529494,
           'precision50': 0.25333458,
           'recall50': 0.25540975},
     '5': {'avg_iou': 0.767301,
           'avg_obj': 0.41610995,
           'box_loss': 0.010056808,
           'class_loss': 0.0045735817,
           'conf_loss': 0.008353317,
           'precision50': 0.32922348,
           'recall50': 0.44282958},
     'AP': 0.20998463,
     'AP50': 0.3564655,
     'AP75': 0.21719128,
     'APl': 0.3137472,
     'APm': 0.13944635,
     'APs': 0.04388419,
     'ARl': 0.5699643,
     'ARm': 0.4089029,
     'ARmax1': 0.23412894,
     'ARmax10': 0.3901288,
     'ARmax100': 0.44680744,
     'ARs': 0.15636083,
     'global': {'total_loss': 0.06421183},
     'validation_loss': 0.06421183}
I0411 22:42:57.641472 140660118681408 controller.py:211] train | step:  20000 | training until step 40000...
/home/cam2tensorflow/.experiment_start.sh: line 22:  3914 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   207    0     2  100   205      8    854 --:--:-- --:--:-- --:--:--   862
okRequest issued for: [node-5]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-11T23:16:25.278342241Z'
  endTime: '2021-04-11T23:17:02.954162988Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618182985266-5bfba9604b655-d0869c78-ce66f571
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618182985266-5bfba9604b655-d0869c78-ce66f571] to complete...
.........................................................................................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-5]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-11T23:18:05.573246333Z'
  endTime: '2021-04-11T23:18:39.502827564Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618183085561-5bfba9bff1623-00abea8c-80b3b0f4
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618183085561-5bfba9bff1623-00abea8c-80b3b0f4] to complete...
...............................................................................................................................................................................................done.
europe-west4-a
I0411 23:18:01.022116 140137030780736 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.075,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.2,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 0.6,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.05,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.2,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.667,
                                                    'output_size': [640, 640],
                                                    'random_crop': True,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': 'str = "AP50"',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'str = "higher"',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine_epoch': {'alpha': 0.2,
                                                                     'decay_steps': 294375,
                                                                     'initial_learning_rate': 0.01,
                                                                     'name': 'CosineEpoch',
                                                                     'steps_per_epoch': 1875},
                                                    'type': 'cosine_epoch'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.937,
                                                        'name': 'SGD',
                                                        'nesterov': False},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5625},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0411 23:18:01.023262 140137030780736 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_testing/all-og/params.yaml
I0411 23:18:01.888246 140137030780736 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 23:18:02.034575 140137030780736 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0411 23:18:02.034834 140137030780736 transport.py:157] Attempting refresh to obtain initial access_token
I0411 23:18:02.098334 140137030780736 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 23:18:02.241669 140137030780736 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0411 23:18:02.241919 140137030780736 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-11 23:18:02.297497: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0411 23:18:02.298130 140137030780736 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 23:18:02.436791 140137030780736 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0411 23:18:02.437028 140137030780736 transport.py:157] Attempting refresh to obtain initial access_token
I0411 23:18:02.480437 140137030780736 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 23:18:03.095969 140137030780736 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0411 23:18:03.096244 140137030780736 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-11 23:18:03.141550: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-11 23:18:03.181933: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.56.217.90:8470}
2021-04-11 23:18:03.182015: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:36492}
2021-04-11 23:18:37.981627: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.56.217.90:8470}
2021-04-11 23:18:37.981717: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:36492}
2021-04-11 23:18:37.983613: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:36492
I0411 23:18:37.991269 140137030780736 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-5
I0411 23:18:37.992958 140137030780736 tpu_strategy_util.py:74] Initializing the TPU system: node-5
INFO:tensorflow:Clearing out eager caches
I0411 23:18:46.619292 140137030780736 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0411 23:18:46.621467 140137030780736 tpu_strategy_util.py:133] Finished initializing TPU system.
I0411 23:18:46.622812 140137030780736 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 23:18:46.767701 140137030780736 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0411 23:18:46.768018 140137030780736 transport.py:157] Attempting refresh to obtain initial access_token
I0411 23:18:46.823743 140137030780736 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0411 23:18:47.434519 140137030780736 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0411 23:18:47.434797 140137030780736 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0411 23:18:47.494615 140137030780736 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0411 23:18:47.494850 140137030780736 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0411 23:18:47.495193 140137030780736 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0411 23:18:47.495246 140137030780736 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0411 23:18:47.495292 140137030780736 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0411 23:18:47.495410 140137030780736 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0411 23:18:47.495462 140137030780736 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0411 23:18:47.495508 140137030780736 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0411 23:18:47.495566 140137030780736 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0411 23:18:47.495611 140137030780736 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0411 23:18:47.495656 140137030780736 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0411 23:18:47.495702 140137030780736 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0411 23:18:47.495746 140137030780736 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0411 23:18:47.495790 140137030780736 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0411 23:18:47.495834 140137030780736 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0411 23:18:47.495921 140137030780736 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0411 23:18:47.524261 140137030780736 train_utils.py:214] Running default trainer.
2021-04-11 23:18:47.604641: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.05, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.6, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.667, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': False, 'momentum': 0.937}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine_epoch', 'cosine_epoch': {'name': 'CosineEpoch', 'initial_learning_rate': 0.01, 'decay_steps': 294375, 'steps_per_epoch': 1875, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5625}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': 'str = "AP50"', 'best_checkpoint_metric_comp': 'str = "higher"', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
{'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f73cd9920b8>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
route_split 512.0 512.0
conv2 512.0
conv1 512.0
spp
conv1 512.0
conv2 512.0
connect
conv1 512.0
8
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
route_split 256.0 256.0
conv2 256.0
conv1 256.0
conv2 256.0
connect
conv1 256.0
6
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)








 ListWrapper([128, 256, 512])
route_split 128 128
conv2 128
conv1 128
conv2 128
connect
conv1 128
conv2 256
7
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
route_split 256 256
conv2 256
conv1 256
conv2 256
connect
conv1 256
conv2 512
7
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
route_split 512 512
conv2 512
conv1 512
conv2 512
connect
conv1 512
conv2 1024
7
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
detget {'3': 2.0, '4': 2.0, '5': 2.0}I0411 23:19:36.508866 140137030780736 controller.py:362] restoring or initializing model...
I0411 23:19:52.468649 140137030780736 controller.py:366] restored model from gs://tensorflow2/config_testing/all-og/ckpt-5000.
I0411 23:19:52.468911 140137030780736 controller.py:192] restored from checkpoint: gs://tensorflow2/config_testing/all-og/ckpt-5000
I0411 23:19:52.469127 140137030780736 train_lib.py:96] Starts to execute mode: train_and_eval
I0411 23:19:52.472735 140137030780736 controller.py:211] train | step:   5000 | training until step 25000...
I0411 23:19:59.304138 140137030780736 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0411 23:20:38.507279 140137030780736 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0411 23:58:02.703056 140137030780736 controller.py:425] train | step:  10000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.5557085,
           'avg_obj': 0.078343,
           'box_loss': 0.016484588,
           'class_loss': 0.012169464,
           'conf_loss': 0.015343499,
           'precision50': 0.12503773,
           'recall50': 0.013245769},
     '4': {'avg_iou': 0.61764836,
           'avg_obj': 0.14729635,
           'box_loss': 0.01688025,
           'class_loss': 0.012885046,
           'conf_loss': 0.019187596,
           'precision50': 0.37342855,
           'recall50': 0.059663903},
     '5': {'avg_iou': 0.65823615,
           'avg_obj': 0.23275909,
           'box_loss': 0.01645118,
           'class_loss': 0.012176756,
           'conf_loss': 0.019272616,
           'precision50': 0.5685477,
           'recall50': 0.14904821},
     'global': {'total_loss': 1.1268077},
     'learning_rate': 0.009979997,
     'training_loss': 1.1268077}
I0412 00:30:04.064261 140137030780736 controller.py:425] train | step:  15000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.58767885,
           'avg_obj': 0.11015547,
           'box_loss': 0.015276438,
           'class_loss': 0.009231747,
           'conf_loss': 0.014574252,
           'precision50': 0.20558076,
           'recall50': 0.029782211},
     '4': {'avg_iou': 0.66167414,
           'avg_obj': 0.19800465,
           'box_loss': 0.014825763,
           'class_loss': 0.009425687,
           'conf_loss': 0.018221619,
           'precision50': 0.5006329,
           'recall50': 0.11368087},
     '5': {'avg_iou': 0.7114853,
           'avg_obj': 0.30112177,
           'box_loss': 0.013714737,
           'class_loss': 0.008961796,
           'conf_loss': 0.018213538,
           'precision50': 0.6777528,
           'recall50': 0.25620067},
     'global': {'total_loss': 0.97956496},
     'learning_rate': 0.009948857,
     'training_loss': 0.97956496}
I0412 01:05:07.122107 140137030780736 controller.py:425] train | step:  20000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6018151,
           'avg_obj': 0.125287,
           'box_loss': 0.014745402,
           'class_loss': 0.008207087,
           'conf_loss': 0.01424245,
           'precision50': 0.23989756,
           'recall50': 0.04065987},
     '4': {'avg_iou': 0.6802485,
           'avg_obj': 0.22219329,
           'box_loss': 0.013964311,
           'class_loss': 0.008222816,
           'conf_loss': 0.017783815,
           'precision50': 0.5362907,
           'recall50': 0.14376058},
     '5': {'avg_iou': 0.7317915,
           'avg_obj': 0.33157086,
           'box_loss': 0.01269609,
           'class_loss': 0.0078092515,
           'conf_loss': 0.017664863,
           'precision50': 0.70476025,
           'recall50': 0.304978},
     'global': {'total_loss': 0.92269033},
     'learning_rate': 0.009920185,
     'training_loss': 0.92269033}

(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 80, 80, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 640, 640, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 400, 8), 5: (8, 200, 8)}, inds: {3: (8, 600, 3), 4: (8, 400, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 80, 80, 3, 1), 4: (8, 40, 40, 3, 1), 5: (8, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 640, 640, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 80, 80, 3, 1), 4: (1, 40, 40, 3, 1), 5: (1, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
restored model from gs://tensorflow2/config_testing/all-og/ckpt-5000.
restored from checkpoint: gs://tensorflow2/config_testing/all-og/ckpt-5000
train | step:   5000 | training until step 25000...
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
train | step:  10000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.5557085,
           'avg_obj': 0.078343,
           'box_loss': 0.016484588,
           'class_loss': 0.012169464,
           'conf_loss': 0.015343499,
           'precision50': 0.12503773,
           'recall50': 0.013245769},
     '4': {'avg_iou': 0.61764836,
           'avg_obj': 0.14729635,
           'box_loss': 0.01688025,
           'class_loss': 0.012885046,
           'conf_loss': 0.019187596,
           'precision50': 0.37342855,
           'recall50': 0.059663903},
     '5': {'avg_iou': 0.65823615,
           'avg_obj': 0.23275909,
           'box_loss': 0.01645118,
           'class_loss': 0.012176756,
           'conf_loss': 0.019272616,
           'precision50': 0.5685477,
           'recall50': 0.14904821},
     'global': {'total_loss': 1.1268077},
     'learning_rate': 0.009979997,
     'training_loss': 1.1268077}
train | step:  15000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.58767885,
           'avg_obj': 0.11015547,
           'box_loss': 0.015276438,
           'class_loss': 0.009231747,
           'conf_loss': 0.014574252,
           'precision50': 0.20558076,
           'recall50': 0.029782211},
     '4': {'avg_iou': 0.66167414,
           'avg_obj': 0.19800465,
           'box_loss': 0.014825763,
           'class_loss': 0.009425687,
           'conf_loss': 0.018221619,
           'precision50': 0.5006329,
           'recall50': 0.11368087},
     '5': {'avg_iou': 0.7114853,
           'avg_obj': 0.30112177,
           'box_loss': 0.013714737,
           'class_loss': 0.008961796,
           'conf_loss': 0.018213538,
           'precision50': 0.6777528,
           'recall50': 0.25620067},
     'global': {'total_loss': 0.97956496},
     'learning_rate': 0.009948857,
     'training_loss': 0.97956496}
train | step:  20000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6018151,
           'avg_obj': 0.125287,
           'box_loss': 0.014745402,
           'class_loss': 0.008207087,
           'conf_loss': 0.01424245,
           'precision50': 0.23989756,
           'recall50': 0.04065987},
     '4': {'avg_iou': 0.6802485,
           'avg_obj': 0.22219329,
           'box_loss': 0.013964311,
           'class_loss': 0.008222816,
           'conf_loss': 0.017783815,
           'precision50': 0.5362907,
           'recall50': 0.14376058},
     '5': {'avg_iou': 0.7317915,
           'avg_obj': 0.33157086,
           'box_loss': 0.01269609,
           'class_loss': 0.0078092515,
           'conf_loss': 0.017664863,
           'precision50': 0.70476025,
           'recall50': 0.304978},
     'global': {'total_loss': 0.92269033},
     'learning_rate': 0.009920185,
     'training_loss': 0.92269033}I0412 01:37:50.521129 140137030780736 controller.py:425] train | step:  25000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6125253,
           'avg_obj': 0.13693202,
           'box_loss': 0.014327671,
           'class_loss': 0.0075851767,
           'conf_loss': 0.014091119,
           'precision50': 0.26410407,
           'recall50': 0.048942406},
     '4': {'avg_iou': 0.69261354,
           'avg_obj': 0.23860054,
           'box_loss': 0.013392513,
           'class_loss': 0.00756464,
           'conf_loss': 0.017512405,
           'precision50': 0.55507976,
           'recall50': 0.16398482},
     '5': {'avg_iou': 0.7438771,
           'avg_obj': 0.3508199,
           'box_loss': 0.012090328,
           'class_loss': 0.007166762,
           'conf_loss': 0.017304052,
           'precision50': 0.7191577,
           'recall50': 0.33446544},
     'global': {'total_loss': 0.8882797},
     'learning_rate': 0.009865424,
     'training_loss': 0.8882797}
I0412 01:38:38.762550 140137030780736 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-og/ckpt-25000.
I0412 01:38:38.767587 140137030780736 controller.py:252]  eval | step:  25000 | running 625 steps of evaluation...
I0412 01:38:39.762773 140137030780736 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0412 01:38:57.979243 140137030780736 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0412 01:44:12.933810 140137030780736 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0412 01:48:14.089585 140137030780736 controller.py:261]  eval | step:  25000 | eval time:  575.3 sec | output: 
    {'3': {'avg_iou': 0.41852143,
           'avg_obj': 0.12743495,
           'box_loss': 0.00889371,
           'class_loss': 0.003616465,
           'conf_loss': 0.0058581904,
           'precision50': 0.13703062,
           'recall50': 0.096618354},
     '4': {'avg_iou': 0.6306182,
           'avg_obj': 0.285003,
           'box_loss': 0.0099243615,
           'class_loss': 0.0040962114,
           'conf_loss': 0.007532997,
           'precision50': 0.25773236,
           'recall50': 0.27949545},
     '5': {'avg_iou': 0.774093,
           'avg_obj': 0.43994728,
           'box_loss': 0.009716636,
           'class_loss': 0.00409641,
           'conf_loss': 0.008440753,
           'precision50': 0.3313741,
           'recall50': 0.48067665},
     'AP': 0.22925815,
     'AP50': 0.379984,
     'AP75': 0.2396364,
     'APl': 0.3402114,
     'APm': 0.15944447,
     'APs': 0.054125898,
     'ARl': 0.59250975,
     'ARm': 0.43191242,
     'ARmax1': 0.2481775,
     'ARmax10': 0.40878493,
     'ARmax100': 0.4661747,
     'ARs': 0.16930628,
     'global': {'total_loss': 0.062175713},
     'validation_loss': 0.062175713}
I0412 01:48:33.365924 140137030780736 controller.py:211] train | step:  25000 | training until step 45000...
I0412 02:20:21.374924 140137030780736 controller.py:425] train | step:  30000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.6193306,
           'avg_obj': 0.14524235,
           'box_loss': 0.014089008,
           'class_loss': 0.007174628,
           'conf_loss': 0.013915802,
           'precision50': 0.2799997,
           'recall50': 0.05494117},
     '4': {'avg_iou': 0.7011693,
           'avg_obj': 0.25194445,
           'box_loss': 0.013011217,
           'class_loss': 0.007061854,
           'conf_loss': 0.017271278,
           'precision50': 0.57103485,
           'recall50': 0.18104279},
     '5': {'avg_iou': 0.75362176,
           'avg_obj': 0.36745563,
           'box_loss': 0.011608302,
           'class_loss': 0.006646632,
           'conf_loss': 0.0170416,
           'precision50': 0.73194414,
           'recall50': 0.36034438},
     'global': {'total_loss': 0.8625618},
     'learning_rate': 0.009796737,
     'training_loss': 0.8625618}
I0412 02:59:00.607903 140137030780736 controller.py:425] train | step:  35000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6245624,
           'avg_obj': 0.15268496,
           'box_loss': 0.013894594,
           'class_loss': 0.0068451706,
           'conf_loss': 0.013762089,
           'precision50': 0.29424736,
           'recall50': 0.06105027},
     '4': {'avg_iou': 0.7077419,
           'avg_obj': 0.26178882,
           'box_loss': 0.012712415,
           'class_loss': 0.006706372,
           'conf_loss': 0.017035818,
           'precision50': 0.579829,
           'recall50': 0.1935383},
     '5': {'avg_iou': 0.76015925,
           'avg_obj': 0.3787358,
           'box_loss': 0.011270848,
           'class_loss': 0.006302299,
           'conf_loss': 0.01675191,
           'precision50': 0.7389796,
           'recall50': 0.37705708},
     'global': {'total_loss': 0.84225243},
     'learning_rate': 0.00974333,
     'training_loss': 0.84225243}
I0412 03:37:33.264902 140137030780736 controller.py:425] train | step:  40000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6295759,
           'avg_obj': 0.15865633,
           'box_loss': 0.013701489,
           'class_loss': 0.0065723658,
           'conf_loss': 0.013687841,
           'precision50': 0.30562598,
           'recall50': 0.06606995},
     '4': {'avg_iou': 0.712411,
           'avg_obj': 0.27050152,
           'box_loss': 0.012493403,
           'class_loss': 0.006398911,
           'conf_loss': 0.016870933,
           'precision50': 0.5909798,
           'recall50': 0.20549443},
     '5': {'avg_iou': 0.7659972,
           'avg_obj': 0.38978738,
           'box_loss': 0.01098163,
           'class_loss': 0.0060187513,
           'conf_loss': 0.01653205,
           'precision50': 0.74450886,
           'recall50': 0.39351073},
     'global': {'total_loss': 0.8260579},
     'learning_rate': 0.009652007,
     'training_loss': 0.8260579}
I0412 04:11:34.365477 140137030780736 controller.py:425] train | step:  45000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6334201,
           'avg_obj': 0.16359149,
           'box_loss': 0.013511014,
           'class_loss': 0.0063482504,
           'conf_loss': 0.0135573745,
           'precision50': 0.3130312,
           'recall50': 0.06935441},
     '4': {'avg_iou': 0.7179499,
           'avg_obj': 0.2776868,
           'box_loss': 0.012222481,
           'class_loss': 0.0061553284,
           'conf_loss': 0.016700944,
           'precision50': 0.5959591,
           'recall50': 0.21464504},
     '5': {'avg_iou': 0.7705797,
           'avg_obj': 0.3975974,
           'box_loss': 0.01075206,
           'class_loss': 0.005782671,
           'conf_loss': 0.016359325,
           'precision50': 0.7494538,
           'recall50': 0.4054169},
     'global': {'total_loss': 0.81111515},
     'learning_rate': 0.00954753,
     'training_loss': 0.81111515}
I0412 04:12:21.739180 140137030780736 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-og/ckpt-45000.
I0412 04:12:21.748165 140137030780736 controller.py:252]  eval | step:  45000 | running 625 steps of evaluation...
I0412 04:16:43.678433 140137030780736 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.

train | step:  25000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6125253,
           'avg_obj': 0.13693202,
           'box_loss': 0.014327671,
           'class_loss': 0.0075851767,
           'conf_loss': 0.014091119,
           'precision50': 0.26410407,
           'recall50': 0.048942406},
     '4': {'avg_iou': 0.69261354,
           'avg_obj': 0.23860054,
           'box_loss': 0.013392513,
           'class_loss': 0.00756464,
           'conf_loss': 0.017512405,
           'precision50': 0.55507976,
           'recall50': 0.16398482},
     '5': {'avg_iou': 0.7438771,
           'avg_obj': 0.3508199,
           'box_loss': 0.012090328,
           'class_loss': 0.007166762,
           'conf_loss': 0.017304052,
           'precision50': 0.7191577,
           'recall50': 0.33446544},
     'global': {'total_loss': 0.8882797},
     'learning_rate': 0.009865424,
     'training_loss': 0.8882797}
saved checkpoint to gs://tensorflow2/config_testing/all-og/ckpt-25000.
 eval | step:  25000 | running 625 steps of evaluation...
(1, 20, 20, 512) (1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 2048)
(1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 1024)
(1, 20, 20, 512)
(1, 40, 40, 256) (1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 512)
(1, 40, 40, 256)
(1, 80, 80, 128) (1, 80, 80, 128)
(1, 80, 80, 128)
(1, 80, 80, 128)
(1, 80, 80, 128)
(1, 80, 80, 256)
(1, 80, 80, 128)
(1, 80, 80, 256)
(1, 40, 40, 256) (1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 512)
(1, 40, 40, 256)
(1, 40, 40, 512)
(1, 20, 20, 512) (1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 1024)
(1, 20, 20, 512)
(1, 20, 20, 1024)
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=167.26s).
Accumulating evaluation results...
DONE (t=17.13s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.229
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.380
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.240
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.054
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.159
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.340
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.248
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.409
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.466
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.169
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.432
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.593
 eval | step:  25000 | eval time:  575.3 sec | output: 
    {'3': {'avg_iou': 0.41852143,
           'avg_obj': 0.12743495,
           'box_loss': 0.00889371,
           'class_loss': 0.003616465,
           'conf_loss': 0.0058581904,
           'precision50': 0.13703062,
           'recall50': 0.096618354},
     '4': {'avg_iou': 0.6306182,
           'avg_obj': 0.285003,
           'box_loss': 0.0099243615,
           'class_loss': 0.0040962114,
           'conf_loss': 0.007532997,
           'precision50': 0.25773236,
           'recall50': 0.27949545},
     '5': {'avg_iou': 0.774093,
           'avg_obj': 0.43994728,
           'box_loss': 0.009716636,
           'class_loss': 0.00409641,
           'conf_loss': 0.008440753,
           'precision50': 0.3313741,
           'recall50': 0.48067665},
     'AP': 0.22925815,
     'AP50': 0.379984,
     'AP75': 0.2396364,
     'APl': 0.3402114,
     'APm': 0.15944447,
     'APs': 0.054125898,
     'ARl': 0.59250975,
     'ARm': 0.43191242,
     'ARmax1': 0.2481775,
     'ARmax10': 0.40878493,
     'ARmax100': 0.4661747,
     'ARs': 0.16930628,
     'global': {'total_loss': 0.062175713},
     'validation_loss': 0.062175713}
train | step:  25000 | training until step 45000...
train | step:  30000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.6193306,
           'avg_obj': 0.14524235,
           'box_loss': 0.014089008,
           'class_loss': 0.007174628,
           'conf_loss': 0.013915802,
           'precision50': 0.2799997,
           'recall50': 0.05494117},
     '4': {'avg_iou': 0.7011693,
           'avg_obj': 0.25194445,
           'box_loss': 0.013011217,
           'class_loss': 0.007061854,
           'conf_loss': 0.017271278,
           'precision50': 0.57103485,
           'recall50': 0.18104279},
     '5': {'avg_iou': 0.75362176,
           'avg_obj': 0.36745563,
           'box_loss': 0.011608302,
           'class_loss': 0.006646632,
           'conf_loss': 0.0170416,
           'precision50': 0.73194414,
           'recall50': 0.36034438},
     'global': {'total_loss': 0.8625618},
     'learning_rate': 0.009796737,
     'training_loss': 0.8625618}
train | step:  35000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6245624,
           'avg_obj': 0.15268496,
           'box_loss': 0.013894594,
           'class_loss': 0.0068451706,
           'conf_loss': 0.013762089,
           'precision50': 0.29424736,
           'recall50': 0.06105027},
     '4': {'avg_iou': 0.7077419,
           'avg_obj': 0.26178882,
           'box_loss': 0.012712415,
           'class_loss': 0.006706372,
           'conf_loss': 0.017035818,
           'precision50': 0.579829,
           'recall50': 0.1935383},
     '5': {'avg_iou': 0.76015925,
           'avg_obj': 0.3787358,
           'box_loss': 0.011270848,
           'class_loss': 0.006302299,
           'conf_loss': 0.01675191,
           'precision50': 0.7389796,
           'recall50': 0.37705708},
     'global': {'total_loss': 0.84225243},
     'learning_rate': 0.00974333,
     'training_loss': 0.84225243}
train | step:  40000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6295759,
           'avg_obj': 0.15865633,
           'box_loss': 0.013701489,
           'class_loss': 0.0065723658,
           'conf_loss': 0.013687841,
           'precision50': 0.30562598,
           'recall50': 0.06606995},
     '4': {'avg_iou': 0.712411,
           'avg_obj': 0.27050152,
           'box_loss': 0.012493403,
           'class_loss': 0.006398911,
           'conf_loss': 0.016870933,
           'precision50': 0.5909798,
           'recall50': 0.20549443},
     '5': {'avg_iou': 0.7659972,
           'avg_obj': 0.38978738,
           'box_loss': 0.01098163,
           'class_loss': 0.0060187513,
           'conf_loss': 0.01653205,
           'precision50': 0.74450886,
           'recall50': 0.39351073},
     'global': {'total_loss': 0.8260579},
     'learning_rate': 0.009652007,
     'training_loss': 0.8260579}
train | step:  45000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6334201,
           'avg_obj': 0.16359149,
           'box_loss': 0.013511014,
           'class_loss': 0.0063482504,
           'conf_loss': 0.0135573745,
           'precision50': 0.3130312,
           'recall50': 0.06935441},
     '4': {'avg_iou': 0.7179499,
           'avg_obj': 0.2776868,
           'box_loss': 0.012222481,
           'class_loss': 0.0061553284,
           'conf_loss': 0.016700944,
           'precision50': 0.5959591,
           'recall50': 0.21464504},
     '5': {'avg_iou': 0.7705797,
           'avg_obj': 0.3975974,
           'box_loss': 0.01075206,
           'class_loss': 0.005782671,
           'conf_loss': 0.016359325,
           'precision50': 0.7494538,
           'recall50': 0.4054169},
     'global': {'total_loss': 0.81111515},
     'learning_rate': 0.00954753,
     'training_loss': 0.81111515}
saved checkpoint to gs://tensorflow2/config_testing/all-og/ckpt-45000.
 eval | step:  45000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=172.07s).
Accumulating evaluation results...
DONE (t=18.15s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.259I0412 04:20:46.442237 140137030780736 controller.py:261]  eval | step:  45000 | eval time:  504.7 sec | output: 
    {'3': {'avg_iou': 0.42550454,
           'avg_obj': 0.14470221,
           'box_loss': 0.008545827,
           'class_loss': 0.003006364,
           'conf_loss': 0.0058285706,
           'precision50': 0.14700875,
           'recall50': 0.119288795},
     '4': {'avg_iou': 0.64109945,
           'avg_obj': 0.31470507,
           'box_loss': 0.009400612,
           'class_loss': 0.003388583,
           'conf_loss': 0.0075656464,
           'precision50': 0.2578412,
           'recall50': 0.32034367},
     '5': {'avg_iou': 0.788004,
           'avg_obj': 0.484172,
           'box_loss': 0.009019998,
           'class_loss': 0.0033989095,
           'conf_loss': 0.008630011,
           'precision50': 0.32638583,
           'recall50': 0.54220486},
     'AP': 0.25862923,
     'AP50': 0.41116616,
     'AP75': 0.27450985,
     'APl': 0.3811681,
     'APm': 0.1820804,
     'APs': 0.062544286,
     'ARl': 0.6233316,
     'ARm': 0.46873116,
     'ARmax1': 0.27015796,
     'ARmax10': 0.43839237,
     'ARmax100': 0.49919346,
     'ARs': 0.2014474,
     'global': {'total_loss': 0.058784522},
     'validation_loss': 0.058784522}
I0412 04:21:03.136340 140137030780736 controller.py:211] train | step:  45000 | training until step 65000...
I0412 04:52:28.684200 140137030780736 controller.py:425] train | step:  50000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.63662386,
           'avg_obj': 0.16823025,
           'box_loss': 0.013412628,
           'class_loss': 0.0061558113,
           'conf_loss': 0.013472354,
           'precision50': 0.32184595,
           'recall50': 0.07334467},
     '4': {'avg_iou': 0.7216737,
           'avg_obj': 0.2840893,
           'box_loss': 0.012051302,
           'class_loss': 0.005936227,
           'conf_loss': 0.016565863,
           'precision50': 0.60064524,
           'recall50': 0.22243911},
     '5': {'avg_iou': 0.7750383,
           'avg_obj': 0.40538087,
           'box_loss': 0.010533594,
           'class_loss': 0.005562295,
           'conf_loss': 0.016198242,
           'precision50': 0.75362283,
           'recall50': 0.4164987},
     'global': {'total_loss': 0.79910725},
     'learning_rate': 0.009470752,
     'training_loss': 0.79910725}
I0412 05:24:25.195557 140137030780736 controller.py:425] train | step:  55000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.63997483,
           'avg_obj': 0.17273854,
           'box_loss': 0.013330111,
           'class_loss': 0.0060170614,
           'conf_loss': 0.01338725,
           'precision50': 0.3283012,
           'recall50': 0.07738244},
     '4': {'avg_iou': 0.7254735,
           'avg_obj': 0.29080802,
           'box_loss': 0.011897389,
           'class_loss': 0.005764051,
           'conf_loss': 0.016472314,
           'precision50': 0.6063848,
           'recall50': 0.23026887},
     '5': {'avg_iou': 0.7792311,
           'avg_obj': 0.41297436,
           'box_loss': 0.010326573,
           'class_loss': 0.005397843,
           'conf_loss': 0.016073646,
           'precision50': 0.7577283,
           'recall50': 0.42714447},
     'global': {'total_loss': 0.7893299},
     'learning_rate': 0.0093452055,
     'training_loss': 0.7893299}
I0412 05:56:30.641395 140137030780736 controller.py:425] train | step:  60000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.64226145,
           'avg_obj': 0.17571573,
           'box_loss': 0.013236854,
           'class_loss': 0.0058786804,
           'conf_loss': 0.013339879,
           'precision50': 0.3344032,
           'recall50': 0.079674855},
     '4': {'avg_iou': 0.7282462,
           'avg_obj': 0.29548818,
           'box_loss': 0.011768421,
           'class_loss': 0.0056140325,
           'conf_loss': 0.016367925,
           'precision50': 0.6104235,
           'recall50': 0.23682287},
     '5': {'avg_iou': 0.78225446,
           'avg_obj': 0.41862777,
           'box_loss': 0.010177464,
           'class_loss': 0.005258755,
           'conf_loss': 0.015953036,
           'precision50': 0.76047754,
           'recall50': 0.43502867},
     'global': {'total_loss': 0.7807612},
     'learning_rate': 0.009207607,
     'training_loss': 0.7807612}
I0412 06:28:27.704227 140137030780736 controller.py:425] train | step:  65000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.64474076,
           'avg_obj': 0.17972104,
           'box_loss': 0.013113632,
           'class_loss': 0.005718959,
           'conf_loss': 0.013232468,
           'precision50': 0.34031427,
           'recall50': 0.083005756},
     '4': {'avg_iou': 0.73094773,
           'avg_obj': 0.30067185,
           'box_loss': 0.01164527,
           'class_loss': 0.0054608565,
           'conf_loss': 0.016227614,
           'precision50': 0.614538,
           'recall50': 0.24314262},
     '5': {'avg_iou': 0.78519994,
           'avg_obj': 0.42488325,
           'box_loss': 0.010030719,
           'class_loss': 0.0051248493,
           'conf_loss': 0.01580547,
           'precision50': 0.7625187,
           'recall50': 0.44309297},
     'global': {'total_loss': 0.7708794},
     'learning_rate': 0.009109423,
     'training_loss': 0.7708794}
I0412 06:29:19.429016 140137030780736 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-og/ckpt-65000.
I0412 06:29:19.435018 140137030780736 controller.py:252]  eval | step:  65000 | running 625 steps of evaluation...
I0412 06:33:52.813489 140137030780736 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0412 06:37:55.498170 140137030780736 controller.py:261]  eval | step:  65000 | eval time:  516.1 sec | output: 
    {'3': {'avg_iou': 0.42884347,
           'avg_obj': 0.15329933,
           'box_loss': 0.008382066,
           'class_loss': 0.002710848,
           'conf_loss': 0.005829838,
           'precision50': 0.14985347,
           'recall50': 0.13034968},
     '4': {'avg_iou': 0.64686793,
           'avg_obj': 0.33157116,
           'box_loss': 0.009110461,
           'class_loss': 0.0030982322,
           'conf_loss': 0.007640078,
           'precision50': 0.2551207,
           'recall50': 0.34599245},
     '5': {'avg_iou': 0.79544514,
           'avg_obj': 0.5081282,
           'box_loss': 0.008648041,
           'class_loss': 0.0030999754,
           'conf_loss': 0.008763077,
           'precision50': 0.32048696,
           'recall50': 0.57063955},
     'AP': 0.27108514,
     'AP50': 0.4236663,
     'AP75': 0.28575665,
     'APl': 0.39787158,
     'APm': 0.19096267,
     'APs': 0.06877298,
     'ARl': 0.6380669,
     'ARm': 0.4847241,
     'ARmax1': 0.27865624,
     'ARmax10': 0.45213646,
     'ARmax100': 0.5137182,
     'ARs': 0.21633801,
     'global': {'total_loss': 0.05728264},
     'validation_loss': 0.05728264}

 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.411
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.275
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.063
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.182
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.381
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.270
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.438
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.499
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.201
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.469
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.623
 eval | step:  45000 | eval time:  504.7 sec | output: 
    {'3': {'avg_iou': 0.42550454,
           'avg_obj': 0.14470221,
           'box_loss': 0.008545827,
           'class_loss': 0.003006364,
           'conf_loss': 0.0058285706,
           'precision50': 0.14700875,
           'recall50': 0.119288795},
     '4': {'avg_iou': 0.64109945,
           'avg_obj': 0.31470507,
           'box_loss': 0.009400612,
           'class_loss': 0.003388583,
           'conf_loss': 0.0075656464,
           'precision50': 0.2578412,
           'recall50': 0.32034367},
     '5': {'avg_iou': 0.788004,
           'avg_obj': 0.484172,
           'box_loss': 0.009019998,
           'class_loss': 0.0033989095,
           'conf_loss': 0.008630011,
           'precision50': 0.32638583,
           'recall50': 0.54220486},
     'AP': 0.25862923,
     'AP50': 0.41116616,
     'AP75': 0.27450985,
     'APl': 0.3811681,
     'APm': 0.1820804,
     'APs': 0.062544286,
     'ARl': 0.6233316,
     'ARm': 0.46873116,
     'ARmax1': 0.27015796,
     'ARmax10': 0.43839237,
     'ARmax100': 0.49919346,
     'ARs': 0.2014474,
     'global': {'total_loss': 0.058784522},
     'validation_loss': 0.058784522}
train | step:  45000 | training until step 65000...
train | step:  50000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.63662386,
           'avg_obj': 0.16823025,
           'box_loss': 0.013412628,
           'class_loss': 0.0061558113,
           'conf_loss': 0.013472354,
           'precision50': 0.32184595,
           'recall50': 0.07334467},
     '4': {'avg_iou': 0.7216737,
           'avg_obj': 0.2840893,
           'box_loss': 0.012051302,
           'class_loss': 0.005936227,
           'conf_loss': 0.016565863,
           'precision50': 0.60064524,
           'recall50': 0.22243911},
     '5': {'avg_iou': 0.7750383,
           'avg_obj': 0.40538087,
           'box_loss': 0.010533594,
           'class_loss': 0.005562295,
           'conf_loss': 0.016198242,
           'precision50': 0.75362283,
           'recall50': 0.4164987},
     'global': {'total_loss': 0.79910725},
     'learning_rate': 0.009470752,
     'training_loss': 0.79910725}
train | step:  55000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.63997483,
           'avg_obj': 0.17273854,
           'box_loss': 0.013330111,
           'class_loss': 0.0060170614,
           'conf_loss': 0.01338725,
           'precision50': 0.3283012,
           'recall50': 0.07738244},
     '4': {'avg_iou': 0.7254735,
           'avg_obj': 0.29080802,
           'box_loss': 0.011897389,
           'class_loss': 0.005764051,
           'conf_loss': 0.016472314,
           'precision50': 0.6063848,
           'recall50': 0.23026887},
     '5': {'avg_iou': 0.7792311,
           'avg_obj': 0.41297436,
           'box_loss': 0.010326573,
           'class_loss': 0.005397843,
           'conf_loss': 0.016073646,
           'precision50': 0.7577283,
           'recall50': 0.42714447},
     'global': {'total_loss': 0.7893299},
     'learning_rate': 0.0093452055,
     'training_loss': 0.7893299}
train | step:  60000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.64226145,
           'avg_obj': 0.17571573,
           'box_loss': 0.013236854,
           'class_loss': 0.0058786804,
           'conf_loss': 0.013339879,
           'precision50': 0.3344032,
           'recall50': 0.079674855},
     '4': {'avg_iou': 0.7282462,
           'avg_obj': 0.29548818,
           'box_loss': 0.011768421,
           'class_loss': 0.0056140325,
           'conf_loss': 0.016367925,
           'precision50': 0.6104235,
           'recall50': 0.23682287},
     '5': {'avg_iou': 0.78225446,
           'avg_obj': 0.41862777,
           'box_loss': 0.010177464,
           'class_loss': 0.005258755,
           'conf_loss': 0.015953036,
           'precision50': 0.76047754,
           'recall50': 0.43502867},
     'global': {'total_loss': 0.7807612},
     'learning_rate': 0.009207607,
     'training_loss': 0.7807612}
train | step:  65000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.64474076,
           'avg_obj': 0.17972104,
           'box_loss': 0.013113632,
           'class_loss': 0.005718959,
           'conf_loss': 0.013232468,
           'precision50': 0.34031427,
           'recall50': 0.083005756},
     '4': {'avg_iou': 0.73094773,
           'avg_obj': 0.30067185,
           'box_loss': 0.01164527,
           'class_loss': 0.0054608565,
           'conf_loss': 0.016227614,
           'precision50': 0.614538,
           'recall50': 0.24314262},
     '5': {'avg_iou': 0.78519994,
           'avg_obj': 0.42488325,
           'box_loss': 0.010030719,
           'class_loss': 0.0051248493,
           'conf_loss': 0.01580547,
           'precision50': 0.7625187,
           'recall50': 0.44309297},
     'global': {'total_loss': 0.7708794},
     'learning_rate': 0.009109423,
     'training_loss': 0.7708794}
saved checkpoint to gs://tensorflow2/config_testing/all-og/ckpt-65000.
 eval | step:  65000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=170.89s).
Accumulating evaluation results...
DONE (t=15.26s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.271
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.424
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.286
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.069
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.191
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.398
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.279
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.452
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.514
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.216
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.638
 eval | step:  65000 | eval time:  516.1 sec | output: 
    {'3': {'avg_iou': 0.42884347,
           'avg_obj': 0.15329933,
           'box_loss': 0.008382066,
           'class_loss': 0.002710848,
           'conf_loss': 0.005829838,
           'precision50': 0.14985347,
           'recall50': 0.13034968},
     '4': {'avg_iou': 0.64686793,
           'avg_obj': 0.33157116,
           'box_loss': 0.009110461,
           'class_loss': 0.0030982322,
           'conf_loss': 0.007640078,
           'precision50': 0.2551207,
           'recall50': 0.34599245},
     '5': {'avg_iou': 0.79544514,
           'avg_obj': 0.5081282,
           'box_loss': 0.008648041,
           'class_loss': 0.0030999754,
           'conf_loss': 0.008763077,
           'precision50': 0.32048696,
           'recall50': 0.57063955},
     'AP': 0.27108514,
     'AP50': 0.4236663,
     'AP75': 0.28575665,
     'APl': 0.39787158,
     'APm': 0.19096267,
     'APs': 0.06877298,
     'ARl': 0.6380669,
     'ARm': 0.4847241,
     'ARmax1': 0.27865624,
     'ARmax10': 0.45213646,
     'ARmax100': 0.5137182,
     'ARs': 0.21633801,
     'global': {'total_loss': 0.05728264},
     'validation_loss': 0.05728264}I0412 06:38:17.312587 140137030780736 controller.py:211] train | step:  65000 | training until step 85000...
I0412 07:13:06.911824 140137030780736 controller.py:425] train | step:  70000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.64644325,
           'avg_obj': 0.1832675,
           'box_loss': 0.01307421,
           'class_loss': 0.0056348387,
           'conf_loss': 0.013199395,
           'precision50': 0.34517312,
           'recall50': 0.08561446},
     '4': {'avg_iou': 0.7339165,
           'avg_obj': 0.30567706,
           'box_loss': 0.011516542,
           'class_loss': 0.0053295065,
           'conf_loss': 0.016188568,
           'precision50': 0.6179117,
           'recall50': 0.24929878},
     '5': {'avg_iou': 0.7875622,
           'avg_obj': 0.42963013,
           'box_loss': 0.009910003,
           'class_loss': 0.0049875863,
           'conf_loss': 0.015738217,
           'precision50': 0.7661131,
           'recall50': 0.45030957},
     'global': {'total_loss': 0.76463103},
     'learning_rate': 0.008952862,
     'training_loss': 0.76463103}
I0412 07:45:45.139568 140137030780736 controller.py:425] train | step:  75000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6488294,
           'avg_obj': 0.18606195,
           'box_loss': 0.012976563,
           'class_loss': 0.005524326,
           'conf_loss': 0.013100908,
           'precision50': 0.34785905,
           'recall50': 0.08826256},
     '4': {'avg_iou': 0.7361746,
           'avg_obj': 0.30959198,
           'box_loss': 0.011389419,
           'class_loss': 0.005206337,
           'conf_loss': 0.016022442,
           'precision50': 0.62014234,
           'recall50': 0.25486356},
     '5': {'avg_iou': 0.7904892,
           'avg_obj': 0.43522003,
           'box_loss': 0.009760605,
           'class_loss': 0.0048719337,
           'conf_loss': 0.015532166,
           'precision50': 0.7682113,
           'recall50': 0.4577805},
     'global': {'total_loss': 0.75507754},
     'learning_rate': 0.008785662,
     'training_loss': 0.75507754}
I0412 08:17:40.596956 140137030780736 controller.py:425] train | step:  80000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6500406,
           'avg_obj': 0.18896465,
           'box_loss': 0.012938121,
           'class_loss': 0.005478967,
           'conf_loss': 0.013083415,
           'precision50': 0.35449433,
           'recall50': 0.09132762},
     '4': {'avg_iou': 0.7387258,
           'avg_obj': 0.31398314,
           'box_loss': 0.011287622,
           'class_loss': 0.005139675,
           'conf_loss': 0.015980557,
           'precision50': 0.62453777,
           'recall50': 0.26021704},
     '5': {'avg_iou': 0.792641,
           'avg_obj': 0.43922466,
           'box_loss': 0.009669312,
           'class_loss': 0.004792593,
           'conf_loss': 0.015485424,
           'precision50': 0.7698836,
           'recall50': 0.46336722},
     'global': {'total_loss': 0.7508449},
     'learning_rate': 0.008668582,
     'training_loss': 0.7508449}
I0412 08:50:01.363907 140137030780736 controller.py:425] train | step:  85000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.65273803,
           'avg_obj': 0.1922557,
           'box_loss': 0.012827247,
           'class_loss': 0.005348304,
           'conf_loss': 0.012999281,
           'precision50': 0.35800877,
           'recall50': 0.09377487},
     '4': {'avg_iou': 0.7405367,
           'avg_obj': 0.31792167,
           'box_loss': 0.011190129,
           'class_loss': 0.0050091487,
           'conf_loss': 0.015859868,
           'precision50': 0.6269733,
           'recall50': 0.26469597},
     '5': {'avg_iou': 0.7947872,
           'avg_obj': 0.44410104,
           'box_loss': 0.009551528,
           'class_loss': 0.0046753315,
           'conf_loss': 0.015346912,
           'precision50': 0.7723745,
           'recall50': 0.4696895},
     'global': {'total_loss': 0.74246144},
     'learning_rate': 0.008485009,
     'training_loss': 0.74246144}
I0412 08:50:49.590889 140137030780736 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-og/ckpt-85000.
I0412 08:50:49.596271 140137030780736 controller.py:252]  eval | step:  85000 | running 625 steps of evaluation...
I0412 08:55:28.811417 140137030780736 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0412 08:59:32.202927 140137030780736 controller.py:261]  eval | step:  85000 | eval time:  522.6 sec | output: 
    {'3': {'avg_iou': 0.430888,
           'avg_obj': 0.15951994,
           'box_loss': 0.008279425,
           'class_loss': 0.0025735246,
           'conf_loss': 0.0058489596,
           'precision50': 0.15255801,
           'recall50': 0.1409215},
     '4': {'avg_iou': 0.65005785,
           'avg_obj': 0.34285825,
           'box_loss': 0.008951044,
           'class_loss': 0.002967161,
           'conf_loss': 0.0076881456,
           'precision50': 0.25367752,
           'recall50': 0.36274374},
     '5': {'avg_iou': 0.7995041,
           'avg_obj': 0.5223687,
           'box_loss': 0.008443158,
           'class_loss': 0.0029395858,
           'conf_loss': 0.008854303,
           'precision50': 0.3182299,
           'recall50': 0.58844876},
     'AP': 0.27710852,
     'AP50': 0.42777103,
     'AP75': 0.29351905,
     'APl': 0.4089466,
     'APm': 0.19472946,
     'APs': 0.07158702,
     'ARl': 0.6468172,
     'ARm': 0.4996239,
     'ARmax1': 0.28488347,
     'ARmax10': 0.46028903,
     'ARmax100': 0.5249037,
     'ARs': 0.22664395,
     'global': {'total_loss': 0.0565453},
     'validation_loss': 0.0565453}
I0412 08:59:53.357706 140137030780736 controller.py:211] train | step:  85000 | training until step 105000...
I0412 09:29:58.157943 140137030780736 controller.py:425] train | step:  90000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.6541008,
           'avg_obj': 0.19469555,
           'box_loss': 0.012800679,
           'class_loss': 0.0052724644,
           'conf_loss': 0.012970958,
           'precision50': 0.36015284,
           'recall50': 0.09576932},
     '4': {'avg_iou': 0.74274135,
           'avg_obj': 0.32157943,
           'box_loss': 0.011106891,
           'class_loss': 0.0049531395,
           'conf_loss': 0.01580281,
           'precision50': 0.6288101,
           'recall50': 0.2692199},
     '5': {'avg_iou': 0.7968554,
           'avg_obj': 0.44785982,
           'box_loss': 0.009451624,
           'class_loss': 0.0045967284,
           'conf_loss': 0.015291693,
           'precision50': 0.7745904,
           'recall50': 0.47528848},
     'global': {'total_loss': 0.73797554},
     'learning_rate': 0.008292484,
     'training_loss': 0.73797554}
I0412 10:03:44.508986 140137030780736 controller.py:425] train | step:  95000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6555917,
           'avg_obj': 0.19711922,
           'box_loss': 0.012735288,
           'class_loss': 0.0051920596,
           'conf_loss': 0.012936723,
           'precision50': 0.36557186,
           'recall50': 0.09820273},
     '4': {'avg_iou': 0.7443618,
           'avg_obj': 0.32515198,
           'box_loss': 0.011028755,
           'class_loss': 0.0048461813,
           'conf_loss': 0.015749393,
           'precision50': 0.6319838,
           'recall50': 0.2740077},
     '5': {'avg_iou': 0.79832417,
           'avg_obj': 0.45115352,
           'box_loss': 0.009375805,
           'class_loss': 0.004525367,
           'conf_loss': 0.015238291,
           'precision50': 0.7755371,
           'recall50': 0.47933426},
     'global': {'total_loss': 0.7330222},
     'learning_rate': 0.0081595015,
     'training_loss': 0.7330222}
I0412 10:37:30.931271 140137030780736 controller.py:425] train | step:  100000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.65663236,
           'avg_obj': 0.19940881,
           'box_loss': 0.012682827,
           'class_loss': 0.0051048067,
           'conf_loss': 0.012852966,
           'precision50': 0.36778885,
           'recall50': 0.100124985},
     '4': {'avg_iou': 0.74627167,
           'avg_obj': 0.32853836,
           'box_loss': 0.010933916,
           'class_loss': 0.004744524,
           'conf_loss': 0.01564488,
           'precision50': 0.63516086,
           'recall50': 0.27859294},
     '5': {'avg_iou': 0.8006702,
           'avg_obj': 0.45595077,
           'box_loss': 0.009265371,
           'class_loss': 0.0044468553,
           'conf_loss': 0.015107277,
           'precision50': 0.7771964,
           'recall50': 0.4853369},
     'global': {'total_loss': 0.72626734},
     'learning_rate': 0.007953611,
     'training_loss': 0.72626734}

train | step:  65000 | training until step 85000...
train | step:  70000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.64644325,
           'avg_obj': 0.1832675,
           'box_loss': 0.01307421,
           'class_loss': 0.0056348387,
           'conf_loss': 0.013199395,
           'precision50': 0.34517312,
           'recall50': 0.08561446},
     '4': {'avg_iou': 0.7339165,
           'avg_obj': 0.30567706,
           'box_loss': 0.011516542,
           'class_loss': 0.0053295065,
           'conf_loss': 0.016188568,
           'precision50': 0.6179117,
           'recall50': 0.24929878},
     '5': {'avg_iou': 0.7875622,
           'avg_obj': 0.42963013,
           'box_loss': 0.009910003,
           'class_loss': 0.0049875863,
           'conf_loss': 0.015738217,
           'precision50': 0.7661131,
           'recall50': 0.45030957},
     'global': {'total_loss': 0.76463103},
     'learning_rate': 0.008952862,
     'training_loss': 0.76463103}
train | step:  75000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6488294,
           'avg_obj': 0.18606195,
           'box_loss': 0.012976563,
           'class_loss': 0.005524326,
           'conf_loss': 0.013100908,
           'precision50': 0.34785905,
           'recall50': 0.08826256},
     '4': {'avg_iou': 0.7361746,
           'avg_obj': 0.30959198,
           'box_loss': 0.011389419,
           'class_loss': 0.005206337,
           'conf_loss': 0.016022442,
           'precision50': 0.62014234,
           'recall50': 0.25486356},
     '5': {'avg_iou': 0.7904892,
           'avg_obj': 0.43522003,
           'box_loss': 0.009760605,
           'class_loss': 0.0048719337,
           'conf_loss': 0.015532166,
           'precision50': 0.7682113,
           'recall50': 0.4577805},
     'global': {'total_loss': 0.75507754},
     'learning_rate': 0.008785662,
     'training_loss': 0.75507754}
train | step:  80000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6500406,
           'avg_obj': 0.18896465,
           'box_loss': 0.012938121,
           'class_loss': 0.005478967,
           'conf_loss': 0.013083415,
           'precision50': 0.35449433,
           'recall50': 0.09132762},
     '4': {'avg_iou': 0.7387258,
           'avg_obj': 0.31398314,
           'box_loss': 0.011287622,
           'class_loss': 0.005139675,
           'conf_loss': 0.015980557,
           'precision50': 0.62453777,
           'recall50': 0.26021704},
     '5': {'avg_iou': 0.792641,
           'avg_obj': 0.43922466,
           'box_loss': 0.009669312,
           'class_loss': 0.004792593,
           'conf_loss': 0.015485424,
           'precision50': 0.7698836,
           'recall50': 0.46336722},
     'global': {'total_loss': 0.7508449},
     'learning_rate': 0.008668582,
     'training_loss': 0.7508449}
train | step:  85000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.65273803,
           'avg_obj': 0.1922557,
           'box_loss': 0.012827247,
           'class_loss': 0.005348304,
           'conf_loss': 0.012999281,
           'precision50': 0.35800877,
           'recall50': 0.09377487},
     '4': {'avg_iou': 0.7405367,
           'avg_obj': 0.31792167,
           'box_loss': 0.011190129,
           'class_loss': 0.0050091487,
           'conf_loss': 0.015859868,
           'precision50': 0.6269733,
           'recall50': 0.26469597},
     '5': {'avg_iou': 0.7947872,
           'avg_obj': 0.44410104,
           'box_loss': 0.009551528,
           'class_loss': 0.0046753315,
           'conf_loss': 0.015346912,
           'precision50': 0.7723745,
           'recall50': 0.4696895},
     'global': {'total_loss': 0.74246144},
     'learning_rate': 0.008485009,
     'training_loss': 0.74246144}
saved checkpoint to gs://tensorflow2/config_testing/all-og/ckpt-85000.
 eval | step:  85000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=173.53s).
Accumulating evaluation results...
DONE (t=14.74s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.277
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.428
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.294
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.072
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.195
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.409
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.285
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.460
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.525
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.227
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.500
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.647
 eval | step:  85000 | eval time:  522.6 sec | output: 
    {'3': {'avg_iou': 0.430888,
           'avg_obj': 0.15951994,
           'box_loss': 0.008279425,
           'class_loss': 0.0025735246,
           'conf_loss': 0.0058489596,
           'precision50': 0.15255801,
           'recall50': 0.1409215},
     '4': {'avg_iou': 0.65005785,
           'avg_obj': 0.34285825,
           'box_loss': 0.008951044,
           'class_loss': 0.002967161,
           'conf_loss': 0.0076881456,
           'precision50': 0.25367752,
           'recall50': 0.36274374},
     '5': {'avg_iou': 0.7995041,
           'avg_obj': 0.5223687,
           'box_loss': 0.008443158,
           'class_loss': 0.0029395858,
           'conf_loss': 0.008854303,
           'precision50': 0.3182299,
           'recall50': 0.58844876},
     'AP': 0.27710852,
     'AP50': 0.42777103,
     'AP75': 0.29351905,
     'APl': 0.4089466,
     'APm': 0.19472946,
     'APs': 0.07158702,
     'ARl': 0.6468172,
     'ARm': 0.4996239,
     'ARmax1': 0.28488347,
     'ARmax10': 0.46028903,
     'ARmax100': 0.5249037,
     'ARs': 0.22664395,
     'global': {'total_loss': 0.0565453},
     'validation_loss': 0.0565453}
train | step:  85000 | training until step 105000...
train | step:  90000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.6541008,
           'avg_obj': 0.19469555,
           'box_loss': 0.012800679,
           'class_loss': 0.0052724644,
           'conf_loss': 0.012970958,
           'precision50': 0.36015284,
           'recall50': 0.09576932},
     '4': {'avg_iou': 0.74274135,
           'avg_obj': 0.32157943,
           'box_loss': 0.011106891,
           'class_loss': 0.0049531395,
           'conf_loss': 0.01580281,
           'precision50': 0.6288101,
           'recall50': 0.2692199},
     '5': {'avg_iou': 0.7968554,
           'avg_obj': 0.44785982,
           'box_loss': 0.009451624,
           'class_loss': 0.0045967284,
           'conf_loss': 0.015291693,
           'precision50': 0.7745904,
           'recall50': 0.47528848},
     'global': {'total_loss': 0.73797554},
     'learning_rate': 0.008292484,
     'training_loss': 0.73797554}
train | step:  95000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6555917,
           'avg_obj': 0.19711922,
           'box_loss': 0.012735288,
           'class_loss': 0.0051920596,
           'conf_loss': 0.012936723,
           'precision50': 0.36557186,
           'recall50': 0.09820273},
     '4': {'avg_iou': 0.7443618,
           'avg_obj': 0.32515198,
           'box_loss': 0.011028755,
           'class_loss': 0.0048461813,
           'conf_loss': 0.015749393,
           'precision50': 0.6319838,
           'recall50': 0.2740077},
     '5': {'avg_iou': 0.79832417,
           'avg_obj': 0.45115352,
           'box_loss': 0.009375805,
           'class_loss': 0.004525367,
           'conf_loss': 0.015238291,
           'precision50': 0.7755371,
           'recall50': 0.47933426},
     'global': {'total_loss': 0.7330222},
     'learning_rate': 0.0081595015,
     'training_loss': 0.7330222}
train | step:  100000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.65663236,
           'avg_obj': 0.19940881,
           'box_loss': 0.012682827,
           'class_loss': 0.0051048067,
           'conf_loss': 0.012852966,
           'precision50': 0.36778885,
           'recall50': 0.100124985},
     '4': {'avg_iou': 0.74627167,
           'avg_obj': 0.32853836,
           'box_loss': 0.010933916,
           'class_loss': 0.004744524,
           'conf_loss': 0.01564488,
           'precision50': 0.63516086,
           'recall50': 0.27859294},
     '5': {'avg_iou': 0.8006702,
           'avg_obj': 0.45595077,
           'box_loss': 0.009265371,
           'class_loss': 0.0044468553,
           'conf_loss': 0.015107277,
           'precision50': 0.7771964,
           'recall50': 0.4853369},
     'global': {'total_loss': 0.72626734},
     'learning_rate': 0.007953611,
     'training_loss': 0.72626734}I0412 11:09:41.413335 140137030780736 controller.py:425] train | step:  105000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.65875596,
           'avg_obj': 0.20237932,
           'box_loss': 0.01261851,
           'class_loss': 0.0050415136,
           'conf_loss': 0.0127978455,
           'precision50': 0.37148002,
           'recall50': 0.10207856},
     '4': {'avg_iou': 0.7477727,
           'avg_obj': 0.33238417,
           'box_loss': 0.0108733475,
           'class_loss': 0.004680186,
           'conf_loss': 0.015550262,
           'precision50': 0.63553196,
           'recall50': 0.28236148},
     '5': {'avg_iou': 0.8023111,
           'avg_obj': 0.4598253,
           'box_loss': 0.00918158,
           'class_loss': 0.004364261,
           'conf_loss': 0.015013195,
           'precision50': 0.77937096,
           'recall50': 0.49067003},
     'global': {'total_loss': 0.72096604},
     'learning_rate': 0.007740684,
     'training_loss': 0.72096604}
I0412 11:10:28.126230 140137030780736 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-og/ckpt-105000.
I0412 11:10:28.132291 140137030780736 controller.py:252]  eval | step:  105000 | running 625 steps of evaluation...
I0412 11:15:12.726116 140137030780736 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0412 11:19:16.581644 140137030780736 controller.py:261]  eval | step:  105000 | eval time:  528.4 sec | output: 
    {'3': {'avg_iou': 0.43232226,
           'avg_obj': 0.16440815,
           'box_loss': 0.0082101375,
           'class_loss': 0.002518737,
           'conf_loss': 0.005859121,
           'precision50': 0.1538849,
           'recall50': 0.1481064},
     '4': {'avg_iou': 0.651753,
           'avg_obj': 0.35018182,
           'box_loss': 0.008866118,
           'class_loss': 0.0028757285,
           'conf_loss': 0.007725032,
           'precision50': 0.25312886,
           'recall50': 0.37463418},
     '5': {'avg_iou': 0.80118185,
           'avg_obj': 0.5325514,
           'box_loss': 0.008360727,
           'class_loss': 0.0028352328,
           'conf_loss': 0.008941809,
           'precision50': 0.3156603,
           'recall50': 0.6003983},
     'AP': 0.2801078,
     'AP50': 0.43086436,
     'AP75': 0.29751533,
     'APl': 0.41423002,
     'APm': 0.1966594,
     'APs': 0.0725823,
     'ARl': 0.6525179,
     'ARm': 0.5036449,
     'ARmax1': 0.2882628,
     'ARmax10': 0.46550015,
     'ARmax100': 0.5310841,
     'ARs': 0.2334974,
     'global': {'total_loss': 0.056192633},
     'validation_loss': 0.056192633}
I0412 11:19:33.560141 140137030780736 controller.py:211] train | step:  105000 | training until step 125000...
I0412 11:48:52.569873 140137030780736 controller.py:425] train | step:  110000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.65971136,
           'avg_obj': 0.2050655,
           'box_loss': 0.012584864,
           'class_loss': 0.0049877656,
           'conf_loss': 0.012759183,
           'precision50': 0.37578985,
           'recall50': 0.10492997},
     '4': {'avg_iou': 0.74987024,
           'avg_obj': 0.3359824,
           'box_loss': 0.010799383,
           'class_loss': 0.004617936,
           'conf_loss': 0.015500197,
           'precision50': 0.6391555,
           'recall50': 0.28739274},
     '5': {'avg_iou': 0.8043333,
           'avg_obj': 0.46328622,
           'box_loss': 0.009079885,
           'class_loss': 0.0042964155,
           'conf_loss': 0.0149466125,
           'precision50': 0.7807052,
           'recall50': 0.49529594},
     'global': {'total_loss': 0.71657777},
     'learning_rate': 0.0075951996,
     'training_loss': 0.71657777}
I0412 12:20:42.276751 140137030780736 controller.py:425] train | step:  115000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6610568,
           'avg_obj': 0.20643792,
           'box_loss': 0.012556158,
           'class_loss': 0.0049259546,
           'conf_loss': 0.01278631,
           'precision50': 0.3790959,
           'recall50': 0.106537014},
     '4': {'avg_iou': 0.7508573,
           'avg_obj': 0.33857378,
           'box_loss': 0.010739944,
           'class_loss': 0.0045474884,
           'conf_loss': 0.015485969,
           'precision50': 0.6428178,
           'recall50': 0.29118812},
     '5': {'avg_iou': 0.80561614,
           'avg_obj': 0.4668668,
           'box_loss': 0.009027611,
           'class_loss': 0.004233762,
           'conf_loss': 0.014915153,
           'precision50': 0.78323877,
           'recall50': 0.49998242},
     'global': {'total_loss': 0.7137471},
     'learning_rate': 0.007372258,
     'training_loss': 0.7137471}
I0412 12:52:47.179627 140137030780736 controller.py:425] train | step:  120000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.66235095,
           'avg_obj': 0.20842092,
           'box_loss': 0.012463308,
           'class_loss': 0.0048491037,
           'conf_loss': 0.012652237,
           'precision50': 0.37905213,
           'recall50': 0.107553445},
     '4': {'avg_iou': 0.75261843,
           'avg_obj': 0.34129256,
           'box_loss': 0.010652792,
           'class_loss': 0.0044792257,
           'conf_loss': 0.015344926,
           'precision50': 0.6424466,
           'recall50': 0.29412785},
     '5': {'avg_iou': 0.80757105,
           'avg_obj': 0.4699502,
           'box_loss': 0.008923989,
           'class_loss': 0.00416679,
           'conf_loss': 0.014793195,
           'precision50': 0.78405577,
           'recall50': 0.5042811},
     'global': {'total_loss': 0.70660365},
     'learning_rate': 0.0071443724,
     'training_loss': 0.70660365}
I0412 13:24:11.563695 140137030780736 controller.py:425] train | step:  125000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6638541,
           'avg_obj': 0.21142547,
           'box_loss': 0.0123896,
           'class_loss': 0.0047847982,
           'conf_loss': 0.012590887,
           'precision50': 0.3827117,
           'recall50': 0.1100329},
     '4': {'avg_iou': 0.7540669,
           'avg_obj': 0.34503356,
           'box_loss': 0.010585261,
           'class_loss': 0.004399518,
           'conf_loss': 0.015233539,
           'precision50': 0.6434794,
           'recall50': 0.29759625},
     '5': {'avg_iou': 0.80902994,
           'avg_obj': 0.47355846,
           'box_loss': 0.008853222,
           'class_loss': 0.0040933876,
           'conf_loss': 0.014673243,
           'precision50': 0.78498065,
           'recall50': 0.5081973},
     'global': {'total_loss': 0.7008267},
     'learning_rate': 0.0069901072,
     'training_loss': 0.7008267}
I0412 13:24:58.088696 140137030780736 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-og/ckpt-125000.
I0412 13:24:58.094297 140137030780736 controller.py:252]  eval | step:  125000 | running 625 steps of evaluation...
I0412 13:29:40.923554 140137030780736 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.

train | step:  105000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.65875596,
           'avg_obj': 0.20237932,
           'box_loss': 0.01261851,
           'class_loss': 0.0050415136,
           'conf_loss': 0.0127978455,
           'precision50': 0.37148002,
           'recall50': 0.10207856},
     '4': {'avg_iou': 0.7477727,
           'avg_obj': 0.33238417,
           'box_loss': 0.0108733475,
           'class_loss': 0.004680186,
           'conf_loss': 0.015550262,
           'precision50': 0.63553196,
           'recall50': 0.28236148},
     '5': {'avg_iou': 0.8023111,
           'avg_obj': 0.4598253,
           'box_loss': 0.00918158,
           'class_loss': 0.004364261,
           'conf_loss': 0.015013195,
           'precision50': 0.77937096,
           'recall50': 0.49067003},
     'global': {'total_loss': 0.72096604},
     'learning_rate': 0.007740684,
     'training_loss': 0.72096604}
saved checkpoint to gs://tensorflow2/config_testing/all-og/ckpt-105000.
 eval | step:  105000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=171.98s).
Accumulating evaluation results...
DONE (t=14.25s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.280
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.431
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.298
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.073
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.197
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.414
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.288
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.466
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.531
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.233
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.504
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.653
 eval | step:  105000 | eval time:  528.4 sec | output: 
    {'3': {'avg_iou': 0.43232226,
           'avg_obj': 0.16440815,
           'box_loss': 0.0082101375,
           'class_loss': 0.002518737,
           'conf_loss': 0.005859121,
           'precision50': 0.1538849,
           'recall50': 0.1481064},
     '4': {'avg_iou': 0.651753,
           'avg_obj': 0.35018182,
           'box_loss': 0.008866118,
           'class_loss': 0.0028757285,
           'conf_loss': 0.007725032,
           'precision50': 0.25312886,
           'recall50': 0.37463418},
     '5': {'avg_iou': 0.80118185,
           'avg_obj': 0.5325514,
           'box_loss': 0.008360727,
           'class_loss': 0.0028352328,
           'conf_loss': 0.008941809,
           'precision50': 0.3156603,
           'recall50': 0.6003983},
     'AP': 0.2801078,
     'AP50': 0.43086436,
     'AP75': 0.29751533,
     'APl': 0.41423002,
     'APm': 0.1966594,
     'APs': 0.0725823,
     'ARl': 0.6525179,
     'ARm': 0.5036449,
     'ARmax1': 0.2882628,
     'ARmax10': 0.46550015,
     'ARmax100': 0.5310841,
     'ARs': 0.2334974,
     'global': {'total_loss': 0.056192633},
     'validation_loss': 0.056192633}
train | step:  105000 | training until step 125000...
train | step:  110000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.65971136,
           'avg_obj': 0.2050655,
           'box_loss': 0.012584864,
           'class_loss': 0.0049877656,
           'conf_loss': 0.012759183,
           'precision50': 0.37578985,
           'recall50': 0.10492997},
     '4': {'avg_iou': 0.74987024,
           'avg_obj': 0.3359824,
           'box_loss': 0.010799383,
           'class_loss': 0.004617936,
           'conf_loss': 0.015500197,
           'precision50': 0.6391555,
           'recall50': 0.28739274},
     '5': {'avg_iou': 0.8043333,
           'avg_obj': 0.46328622,
           'box_loss': 0.009079885,
           'class_loss': 0.0042964155,
           'conf_loss': 0.0149466125,
           'precision50': 0.7807052,
           'recall50': 0.49529594},
     'global': {'total_loss': 0.71657777},
     'learning_rate': 0.0075951996,
     'training_loss': 0.71657777}
train | step:  115000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6610568,
           'avg_obj': 0.20643792,
           'box_loss': 0.012556158,
           'class_loss': 0.0049259546,
           'conf_loss': 0.01278631,
           'precision50': 0.3790959,
           'recall50': 0.106537014},
     '4': {'avg_iou': 0.7508573,
           'avg_obj': 0.33857378,
           'box_loss': 0.010739944,
           'class_loss': 0.0045474884,
           'conf_loss': 0.015485969,
           'precision50': 0.6428178,
           'recall50': 0.29118812},
     '5': {'avg_iou': 0.80561614,
           'avg_obj': 0.4668668,
           'box_loss': 0.009027611,
           'class_loss': 0.004233762,
           'conf_loss': 0.014915153,
           'precision50': 0.78323877,
           'recall50': 0.49998242},
     'global': {'total_loss': 0.7137471},
     'learning_rate': 0.007372258,
     'training_loss': 0.7137471}
train | step:  120000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.66235095,
           'avg_obj': 0.20842092,
           'box_loss': 0.012463308,
           'class_loss': 0.0048491037,
           'conf_loss': 0.012652237,
           'precision50': 0.37905213,
           'recall50': 0.107553445},
     '4': {'avg_iou': 0.75261843,
           'avg_obj': 0.34129256,
           'box_loss': 0.010652792,
           'class_loss': 0.0044792257,
           'conf_loss': 0.015344926,
           'precision50': 0.6424466,
           'recall50': 0.29412785},
     '5': {'avg_iou': 0.80757105,
           'avg_obj': 0.4699502,
           'box_loss': 0.008923989,
           'class_loss': 0.00416679,
           'conf_loss': 0.014793195,
           'precision50': 0.78405577,
           'recall50': 0.5042811},
     'global': {'total_loss': 0.70660365},
     'learning_rate': 0.0071443724,
     'training_loss': 0.70660365}
train | step:  125000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6638541,
           'avg_obj': 0.21142547,
           'box_loss': 0.0123896,
           'class_loss': 0.0047847982,
           'conf_loss': 0.012590887,
           'precision50': 0.3827117,
           'recall50': 0.1100329},
     '4': {'avg_iou': 0.7540669,
           'avg_obj': 0.34503356,
           'box_loss': 0.010585261,
           'class_loss': 0.004399518,
           'conf_loss': 0.015233539,
           'precision50': 0.6434794,
           'recall50': 0.29759625},
     '5': {'avg_iou': 0.80902994,
           'avg_obj': 0.47355846,
           'box_loss': 0.008853222,
           'class_loss': 0.0040933876,
           'conf_loss': 0.014673243,
           'precision50': 0.78498065,
           'recall50': 0.5081973},
     'global': {'total_loss': 0.7008267},
     'learning_rate': 0.0069901072,
     'training_loss': 0.7008267}
saved checkpoint to gs://tensorflow2/config_testing/all-og/ckpt-125000.
 eval | step:  125000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=169.34s).
Accumulating evaluation results...
DONE (t=13.76s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.279
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.432
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.294
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.077
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.194
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.415
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.286
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.468
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.532
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.237I0412 13:33:34.944734 140137030780736 controller.py:261]  eval | step:  125000 | eval time:  516.8 sec | output: 
    {'3': {'avg_iou': 0.4332954,
           'avg_obj': 0.16757473,
           'box_loss': 0.008162249,
           'class_loss': 0.0024740277,
           'conf_loss': 0.0058664484,
           'precision50': 0.15284553,
           'recall50': 0.15175845},
     '4': {'avg_iou': 0.652427,
           'avg_obj': 0.35660106,
           'box_loss': 0.008832516,
           'class_loss': 0.0028457143,
           'conf_loss': 0.007801797,
           'precision50': 0.24799849,
           'recall50': 0.38180345},
     '5': {'avg_iou': 0.803182,
           'avg_obj': 0.5409642,
           'box_loss': 0.008259543,
           'class_loss': 0.002792608,
           'conf_loss': 0.009053941,
           'precision50': 0.31201518,
           'recall50': 0.6080515},
     'AP': 0.2793809,
     'AP50': 0.4317631,
     'AP75': 0.293832,
     'APl': 0.41517153,
     'APm': 0.19418456,
     'APs': 0.07745416,
     'ARl': 0.65335,
     'ARm': 0.5023518,
     'ARmax1': 0.2863514,
     'ARmax10': 0.46785203,
     'ARmax100': 0.532035,
     'ARs': 0.23689637,
     'global': {'total_loss': 0.05608883},
     'validation_loss': 0.05608883}
I0412 13:33:51.105855 140137030780736 controller.py:211] train | step:  125000 | training until step 145000...
I0412 14:02:50.315654 140137030780736 controller.py:425] train | step:  130000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6650815,
           'avg_obj': 0.21307737,
           'box_loss': 0.012374756,
           'class_loss': 0.0047638468,
           'conf_loss': 0.012580731,
           'precision50': 0.3865527,
           'recall50': 0.11190129},
     '4': {'avg_iou': 0.7554563,
           'avg_obj': 0.34769538,
           'box_loss': 0.010526955,
           'class_loss': 0.004357597,
           'conf_loss': 0.015230249,
           'precision50': 0.64754957,
           'recall50': 0.30181572},
     '5': {'avg_iou': 0.8102675,
           'avg_obj': 0.47674438,
           'box_loss': 0.008788135,
           'class_loss': 0.004046626,
           'conf_loss': 0.014628105,
           'precision50': 0.7860715,
           'recall50': 0.5119805},
     'global': {'total_loss': 0.6983768},
     'learning_rate': 0.006755814,
     'training_loss': 0.6983768}
I0412 14:37:15.387295 140137030780736 controller.py:425] train | step:  135000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.66583866,
           'avg_obj': 0.21506847,
           'box_loss': 0.012352233,
           'class_loss': 0.0047089094,
           'conf_loss': 0.012529409,
           'precision50': 0.39007774,
           'recall50': 0.11410205},
     '4': {'avg_iou': 0.7568254,
           'avg_obj': 0.35080373,
           'box_loss': 0.010474446,
           'class_loss': 0.004303256,
           'conf_loss': 0.01515876,
           'precision50': 0.6497359,
           'recall50': 0.30624962},
     '5': {'avg_iou': 0.81186336,
           'avg_obj': 0.47990513,
           'box_loss': 0.00871419,
           'class_loss': 0.0040047085,
           'conf_loss': 0.014582801,
           'precision50': 0.78915066,
           'recall50': 0.51699054},
     'global': {'total_loss': 0.69463044},
     'learning_rate': 0.006518798,
     'training_loss': 0.69463044}
I0412 15:08:55.252125 140137030780736 controller.py:425] train | step:  140000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6667475,
           'avg_obj': 0.21717502,
           'box_loss': 0.012302574,
           'class_loss': 0.0046451823,
           'conf_loss': 0.012506884,
           'precision50': 0.3906749,
           'recall50': 0.1155407},
     '4': {'avg_iou': 0.7582553,
           'avg_obj': 0.35332513,
           'box_loss': 0.010401637,
           'class_loss': 0.004239822,
           'conf_loss': 0.015098435,
           'precision50': 0.65001094,
           'recall50': 0.3090092},
     '5': {'avg_iou': 0.8133233,
           'avg_obj': 0.48319447,
           'box_loss': 0.008644025,
           'class_loss': 0.003930445,
           'conf_loss': 0.014492206,
           'precision50': 0.78921235,
           'recall50': 0.52074987},
     'global': {'total_loss': 0.69008875},
     'learning_rate': 0.0063596955,
     'training_loss': 0.69008875}
I0412 15:41:01.479614 140137030780736 controller.py:425] train | step:  145000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6681042,
           'avg_obj': 0.21932693,
           'box_loss': 0.012270748,
           'class_loss': 0.0045861807,
           'conf_loss': 0.012471644,
           'precision50': 0.3949296,
           'recall50': 0.11812261},
     '4': {'avg_iou': 0.7590512,
           'avg_obj': 0.35690546,
           'box_loss': 0.010353981,
           'class_loss': 0.0041752327,
           'conf_loss': 0.015020234,
           'precision50': 0.6527198,
           'recall50': 0.31346744},
     '5': {'avg_iou': 0.8145583,
           'avg_obj': 0.48676625,
           'box_loss': 0.008572675,
           'class_loss': 0.003880036,
           'conf_loss': 0.014375536,
           'precision50': 0.7913274,
           'recall50': 0.52566254},
     'global': {'total_loss': 0.6856486},
     'learning_rate': 0.006120043,
     'training_loss': 0.6856486}
I0412 15:41:51.513038 140137030780736 controller.py:455] saved checkpoint to gs://tensorflow2/config_testing/all-og/ckpt-145000.
I0412 15:41:51.519676 140137030780736 controller.py:252]  eval | step:  145000 | running 625 steps of evaluation...
I0412 15:46:32.576387 140137030780736 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0412 15:50:28.265275 140137030780736 controller.py:261]  eval | step:  145000 | eval time:  516.7 sec | output: 
    {'3': {'avg_iou': 0.43388095,
           'avg_obj': 0.16970052,
           'box_loss': 0.008134056,
           'class_loss': 0.0024885267,
           'conf_loss': 0.0058823614,
           'precision50': 0.1516734,
           'recall50': 0.15675561},
     '4': {'avg_iou': 0.6532871,
           'avg_obj': 0.36071882,
           'box_loss': 0.008790176,
           'class_loss': 0.002827012,
           'conf_loss': 0.00785646,
           'precision50': 0.24684133,
           'recall50': 0.38606966},
     '5': {'avg_iou': 0.8039418,
           'avg_obj': 0.54766864,
           'box_loss': 0.008222042,
           'class_loss': 0.0027519914,
           'conf_loss': 0.009148272,
           'precision50': 0.30827412,
           'recall50': 0.61385864},
     'AP': 0.28070506,
     'AP50': 0.42949563,
     'AP75': 0.29619294,
     'APl': 0.41920915,
     'APm': 0.19250095,
     'APs': 0.07533633,
     'ARl': 0.6630528,
     'ARm': 0.5047234,
     'ARmax1': 0.29117873,
     'ARmax10': 0.4709331,
     'ARmax100': 0.5362108,
     'ARs': 0.24155723,
     'global': {'total_loss': 0.056100886},
     'validation_loss': 0.056100886}
I0412 15:50:45.270080 140137030780736 controller.py:211] train | step:  145000 | training until step 165000...
I0412 16:19:14.984566 140137030780736 controller.py:425] train | step:  150000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.66894627,
           'avg_obj': 0.221198,
           'box_loss': 0.0122278,
           'class_loss': 0.0045560496,
           'conf_loss': 0.012428401,
           'precision50': 0.3962541,
           'recall50': 0.1193928},
     '4': {'avg_iou': 0.76066667,
           'avg_obj': 0.35895354,
           'box_loss': 0.010297368,
           'class_loss': 0.004149904,
           'conf_loss': 0.014980313,
           'precision50': 0.654157,
           'recall50': 0.3161842},
     '5': {'avg_iou': 0.8156221,
           'avg_obj': 0.488823,
           'box_loss': 0.008529728,
           'class_loss': 0.0038428078,
           'conf_loss': 0.014341826,
           'precision50': 0.7918141,
           'recall50': 0.52772635},
     'global': {'total_loss': 0.68283355},
     'learning_rate': 0.0058799568,
     'training_loss': 0.68283355}

 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.502
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.653
 eval | step:  125000 | eval time:  516.8 sec | output: 
    {'3': {'avg_iou': 0.4332954,
           'avg_obj': 0.16757473,
           'box_loss': 0.008162249,
           'class_loss': 0.0024740277,
           'conf_loss': 0.0058664484,
           'precision50': 0.15284553,
           'recall50': 0.15175845},
     '4': {'avg_iou': 0.652427,
           'avg_obj': 0.35660106,
           'box_loss': 0.008832516,
           'class_loss': 0.0028457143,
           'conf_loss': 0.007801797,
           'precision50': 0.24799849,
           'recall50': 0.38180345},
     '5': {'avg_iou': 0.803182,
           'avg_obj': 0.5409642,
           'box_loss': 0.008259543,
           'class_loss': 0.002792608,
           'conf_loss': 0.009053941,
           'precision50': 0.31201518,
           'recall50': 0.6080515},
     'AP': 0.2793809,
     'AP50': 0.4317631,
     'AP75': 0.293832,
     'APl': 0.41517153,
     'APm': 0.19418456,
     'APs': 0.07745416,
     'ARl': 0.65335,
     'ARm': 0.5023518,
     'ARmax1': 0.2863514,
     'ARmax10': 0.46785203,
     'ARmax100': 0.532035,
     'ARs': 0.23689637,
     'global': {'total_loss': 0.05608883},
     'validation_loss': 0.05608883}
train | step:  125000 | training until step 145000...
train | step:  130000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6650815,
           'avg_obj': 0.21307737,
           'box_loss': 0.012374756,
           'class_loss': 0.0047638468,
           'conf_loss': 0.012580731,
           'precision50': 0.3865527,
           'recall50': 0.11190129},
     '4': {'avg_iou': 0.7554563,
           'avg_obj': 0.34769538,
           'box_loss': 0.010526955,
           'class_loss': 0.004357597,
           'conf_loss': 0.015230249,
           'precision50': 0.64754957,
           'recall50': 0.30181572},
     '5': {'avg_iou': 0.8102675,
           'avg_obj': 0.47674438,
           'box_loss': 0.008788135,
           'class_loss': 0.004046626,
           'conf_loss': 0.014628105,
           'precision50': 0.7860715,
           'recall50': 0.5119805},
     'global': {'total_loss': 0.6983768},
     'learning_rate': 0.006755814,
     'training_loss': 0.6983768}
train | step:  135000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.66583866,
           'avg_obj': 0.21506847,
           'box_loss': 0.012352233,
           'class_loss': 0.0047089094,
           'conf_loss': 0.012529409,
           'precision50': 0.39007774,
           'recall50': 0.11410205},
     '4': {'avg_iou': 0.7568254,
           'avg_obj': 0.35080373,
           'box_loss': 0.010474446,
           'class_loss': 0.004303256,
           'conf_loss': 0.01515876,
           'precision50': 0.6497359,
           'recall50': 0.30624962},
     '5': {'avg_iou': 0.81186336,
           'avg_obj': 0.47990513,
           'box_loss': 0.00871419,
           'class_loss': 0.0040047085,
           'conf_loss': 0.014582801,
           'precision50': 0.78915066,
           'recall50': 0.51699054},
     'global': {'total_loss': 0.69463044},
     'learning_rate': 0.006518798,
     'training_loss': 0.69463044}
train | step:  140000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6667475,
           'avg_obj': 0.21717502,
           'box_loss': 0.012302574,
           'class_loss': 0.0046451823,
           'conf_loss': 0.012506884,
           'precision50': 0.3906749,
           'recall50': 0.1155407},
     '4': {'avg_iou': 0.7582553,
           'avg_obj': 0.35332513,
           'box_loss': 0.010401637,
           'class_loss': 0.004239822,
           'conf_loss': 0.015098435,
           'precision50': 0.65001094,
           'recall50': 0.3090092},
     '5': {'avg_iou': 0.8133233,
           'avg_obj': 0.48319447,
           'box_loss': 0.008644025,
           'class_loss': 0.003930445,
           'conf_loss': 0.014492206,
           'precision50': 0.78921235,
           'recall50': 0.52074987},
     'global': {'total_loss': 0.69008875},
     'learning_rate': 0.0063596955,
     'training_loss': 0.69008875}
train | step:  145000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6681042,
           'avg_obj': 0.21932693,
           'box_loss': 0.012270748,
           'class_loss': 0.0045861807,
           'conf_loss': 0.012471644,
           'precision50': 0.3949296,
           'recall50': 0.11812261},
     '4': {'avg_iou': 0.7590512,
           'avg_obj': 0.35690546,
           'box_loss': 0.010353981,
           'class_loss': 0.0041752327,
           'conf_loss': 0.015020234,
           'precision50': 0.6527198,
           'recall50': 0.31346744},
     '5': {'avg_iou': 0.8145583,
           'avg_obj': 0.48676625,
           'box_loss': 0.008572675,
           'class_loss': 0.003880036,
           'conf_loss': 0.014375536,
           'precision50': 0.7913274,
           'recall50': 0.52566254},
     'global': {'total_loss': 0.6856486},
     'learning_rate': 0.006120043,
     'training_loss': 0.6856486}
saved checkpoint to gs://tensorflow2/config_testing/all-og/ckpt-145000.
 eval | step:  145000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=170.34s).
Accumulating evaluation results...
DONE (t=13.33s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.281
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.429
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.296
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.075
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.193
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.419
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.291
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.471
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.536
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.242
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.505
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.663
 eval | step:  145000 | eval time:  516.7 sec | output: 
    {'3': {'avg_iou': 0.43388095,
           'avg_obj': 0.16970052,
           'box_loss': 0.008134056,
           'class_loss': 0.0024885267,
           'conf_loss': 0.0058823614,
           'precision50': 0.1516734,
           'recall50': 0.15675561},
     '4': {'avg_iou': 0.6532871,
           'avg_obj': 0.36071882,
           'box_loss': 0.008790176,
           'class_loss': 0.002827012,
           'conf_loss': 0.00785646,
           'precision50': 0.24684133,
           'recall50': 0.38606966},
     '5': {'avg_iou': 0.8039418,
           'avg_obj': 0.54766864,
           'box_loss': 0.008222042,
           'class_loss': 0.0027519914,
           'conf_loss': 0.009148272,
           'precision50': 0.30827412,
           'recall50': 0.61385864},
     'AP': 0.28070506,
     'AP50': 0.42949563,
     'AP75': 0.29619294,
     'APl': 0.41920915,
     'APm': 0.19250095,
     'APs': 0.07533633,
     'ARl': 0.6630528,
     'ARm': 0.5047234,
     'ARmax1': 0.29117873,
     'ARmax10': 0.4709331,
     'ARmax100': 0.5362108,
     'ARs': 0.24155723,
     'global': {'total_loss': 0.056100886},
     'validation_loss': 0.056100886}
train | step:  145000 | training until step 165000...
train | step:  150000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.66894627,
           'avg_obj': 0.221198,
           'box_loss': 0.0122278,
           'class_loss': 0.0045560496,
           'conf_loss': 0.012428401,
           'precision50': 0.3962541,
           'recall50': 0.1193928},
     '4': {'avg_iou': 0.76066667,
           'avg_obj': 0.35895354,
           'box_loss': 0.010297368,
           'class_loss': 0.004149904,
           'conf_loss': 0.014980313,
           'precision50': 0.654157,
           'recall50': 0.3161842},
     '5': {'avg_iou': 0.8156221,
           'avg_obj': 0.488823,
           'box_loss': 0.008529728,
           'class_loss': 0.0038428078,
           'conf_loss': 0.014341826,
           'precision50': 0.7918141,
           'recall50': 0.52772635},
     'global': {'total_loss': 0.68283355},
     'learning_rate': 0.0058799568,
     'training_loss': 0.68283355}I0412 16:48:43.599041 140137030780736 controller.py:425] train | step:  155000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.669906,
           'avg_obj': 0.223176,
           'box_loss': 0.012195304,
           'class_loss': 0.004513599,
           'conf_loss': 0.012398744,
           'precision50': 0.39930132,
           'recall50': 0.12146515},
     '4': {'avg_iou': 0.7618221,
           'avg_obj': 0.3618158,
           'box_loss': 0.0102618635,
           'class_loss': 0.0041144276,
           'conf_loss': 0.014923602,
           'precision50': 0.6559196,
           'recall50': 0.31906945},
     '5': {'avg_iou': 0.8168152,
           'avg_obj': 0.49197692,
           'box_loss': 0.0084660845,
           'class_loss': 0.0037825503,
           'conf_loss': 0.01428595,
           'precision50': 0.79383045,
           'recall50': 0.53150827},
     'global': {'total_loss': 0.67953646},
     'learning_rate': 0.0057200873,
     'training_loss': 0.67953646}
/home/cam2tensorflow/.experiment_start.sh: line 22:  6492 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   207    0     2  100   205     11   1220 --:--:-- --:--:-- --:--:--  1232
okRequest issued for: [node-5]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-12T16:49:57.325008011Z'
  endTime: '2021-04-12T16:50:57.325788397Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618246197310-5bfc94dbff4a5-3593107a-b56511b6
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618246197310-5bfc94dbff4a5-3593107a-b56511b6] to complete...
...............................................................................................................................................................................................................................................................................................................................................................................................done.
