cat: .experiment_zone: No such file or directory
Request issued for: [node-3]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-16T03:14:51.164806186Z'
  endTime: '2021-04-16T03:15:27.471734117Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618542891151-5c00e6214afab-577f7411-96fa5976
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618542891151-5c00e6214afab-577f7411-96fa5976] to complete...
............................................................................................................................................................................................done.
europe-west4-a
I0416 03:14:03.781797 140519489697600 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [608, 608, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.75,
                                    'aug_rand_translate': 0.075,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 608,
                                    'image_w': 608,
                                    'jitter_boxes': 0.3,
                                    'jitter_im': 0.6,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 608,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.0,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.213,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 0.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.75,
                                         'aug_rand_translate': 0.075,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 608,
                                         'image_w': 608,
                                         'jitter_boxes': 0.3,
                                         'jitter_im': 0.6,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.75, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 1.0,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine_epoch': {'alpha': 0.2,
                                                                     'decay_steps': 294375,
                                                                     'initial_learning_rate': 0.01,
                                                                     'name': 'CosineEpoch',
                                                                     'steps_per_epoch': 1875},
                                                    'type': 'cosine_epoch'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 250000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0416 03:14:03.782970 140519489697600 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_mean_scaling/250k-letterbox-cosine/params.yaml
I0416 03:14:05.297830 140519489697600 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0416 03:14:05.944561 140519489697600 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0416 03:14:05.944810 140519489697600 transport.py:157] Attempting refresh to obtain initial access_token
I0416 03:14:06.001481 140519489697600 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0416 03:14:06.152243 140519489697600 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0416 03:14:06.152561 140519489697600 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-16 03:14:06.215493: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0416 03:14:06.216179 140519489697600 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0416 03:14:06.859795 140519489697600 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0416 03:14:06.860061 140519489697600 transport.py:157] Attempting refresh to obtain initial access_token
I0416 03:14:06.906021 140519489697600 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0416 03:14:07.554723 140519489697600 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0416 03:14:07.555034 140519489697600 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-16 03:14:07.604403: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-16 03:14:07.614463: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-04-16 03:14:07.614540: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:55065}
2021-04-16 03:14:43.227051: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-04-16 03:14:43.227135: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:55065}
2021-04-16 03:14:43.227674: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:55065
I0416 03:14:43.228624 140519489697600 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-3
I0416 03:14:43.229532 140519489697600 tpu_strategy_util.py:74] Initializing the TPU system: node-3
INFO:tensorflow:Clearing out eager caches
I0416 03:14:51.266254 140519489697600 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0416 03:14:51.268418 140519489697600 tpu_strategy_util.py:133] Finished initializing TPU system.
I0416 03:14:51.269697 140519489697600 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0416 03:14:51.917108 140519489697600 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0416 03:14:51.917344 140519489697600 transport.py:157] Attempting refresh to obtain initial access_token
I0416 03:14:52.022849 140519489697600 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0416 03:14:52.685031 140519489697600 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0416 03:14:52.685275 140519489697600 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0416 03:14:52.733858 140519489697600 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0416 03:14:52.734090 140519489697600 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0416 03:14:52.734483 140519489697600 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0416 03:14:52.734579 140519489697600 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0416 03:14:52.734692 140519489697600 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0416 03:14:52.734972 140519489697600 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0416 03:14:52.735114 140519489697600 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0416 03:14:52.735212 140519489697600 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0416 03:14:52.735296 140519489697600 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0416 03:14:52.735654 140519489697600 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0416 03:14:52.735801 140519489697600 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0416 03:14:52.735925 140519489697600 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0416 03:14:52.736056 140519489697600 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0416 03:14:52.736158 140519489697600 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0416 03:14:52.736251 140519489697600 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0416 03:14:52.736356 140519489697600 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0416 03:14:52.757891 140519489697600 train_utils.py:214] Running default trainer.
2021-04-16 03:14:52.773122: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [608, 608, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 608, 'image_h': 608, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 608, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.3, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.75, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.0, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 608, 'image_h': 608, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.3, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.75, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 1.0, 'crop_area': [0.75, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': True}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine_epoch', 'cosine_epoch': {'name': 'CosineEpoch', 'initial_learning_rate': 0.01, 'decay_steps': 294375, 'steps_per_epoch': 1875, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 250000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05} 0.00025
{'num_classes': 91, '_input_size': [608, 608, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 608, 608, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7fccda030c88>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 608, 608, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 608, 608, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 304, 304, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 304, 304, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 304, 304, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 152, 152, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 152, 152, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 152, 152, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 152, 152, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 76, 76, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 76, 76, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 76, 76, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 38, 38, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 38, 38, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 38, 38, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 19, 19, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 19, 19, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 19, 19, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 19, 19, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 19, 19, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 19, 19, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
conv1 512.0
conv2 1024.0
conv1 512.0
spp
conv1 512.0
conv2 1024.0
conv1 512.0
7
conv1 512.0
conv2 256.0
conv1 512.0
conv2 256.0
4








 ListWrapper([256, 512, 1024])
conv1 128
conv2 256
conv1 128
conv2 256
conv1 128
conv2 256
6
conv1 256
conv2 512
conv1 256
conv2 512
conv1 256
conv2 512
6
conv1 512
conv2 1024
conv1 512
conv2 1024
conv1 512
conv2 1024
6
detget {'3': 1.2, '4': 1.1, '5': 1.05}
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 76, 76, 256) 37319168  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 64,488,640
Trainable params: 64,422,336
Non-trainable params: 66,304
_________________________________________________________________I0416 03:15:38.938260 140519489697600 controller.py:362] restoring or initializing model...
I0416 03:15:49.134723 140519489697600 yolo.py:532] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0416 03:15:49.136720 140519489697600 controller.py:368] initialized model.
I0416 03:15:49.136970 140519489697600 train_lib.py:96] Starts to execute mode: train_and_eval
I0416 03:15:49.142409 140519489697600 controller.py:211] train | step:      0 | training until step 20000...
I0416 03:15:56.853257 140519489697600 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0416 03:16:40.326503 140519489697600 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 149, in main
    model_dir=model_dir)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_lib.py", line 104, in run_experiment
    eval_interval=params.trainer.validation_interval)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 303, in train_and_evaluate
    self.train(steps=num_steps, checkpoint_at_completion=False)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 215, in train
    self._train_n_steps(num_steps)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 410, in _train_n_steps
    train_output = self.trainer.train(num_steps_tensor)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/standard_runner.py", line 142, in train
    return self.train_loop_end()
  File "/home/cam2tensorflow/TensorFlowModels/official/core/base_trainer.py", line 277, in train_loop_end
    self.global_step.numpy())
  File "/home/cam2tensorflow/TensorFlowModels/official/core/base_trainer.py", line 79, in maybe_recover
    self.recover_counter)
RuntimeError: The loss value is NaN after training loop and it happens 1 times.

defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((8, 608, 608, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4), num_detections: (8,), upds: {3: (8, 200, 8), 4: (8, 200, 8), 5: (8, 200, 8)}, inds: {3: (8, 200, 3), 4: (8, 200, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 76, 76, 3, 1), 4: (8, 38, 38, 3, 1), 5: (8, 19, 19, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((1, 608, 608, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 76, 76, 3, 1), 4: (1, 38, 38, 3, 1), 5: (1, 19, 19, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   227    0     2  100   225     11   1243 --:--:-- --:--:-- --:--:--  1254
okRequest issued for: [node-3]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-16T04:48:18.637407482Z'
  endTime: '2021-04-16T04:48:56.459311856Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618548498617-5c00fb04fd5f4-b9fed483-1aaa558e
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618548498617-5c00fb04fd5f4-b9fed483-1aaa558e] to complete...
.................................................................................................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-3]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-16T05:20:24.660847827Z'
  endTime: '2021-04-16T05:20:57.973906563Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618550424646-5c010231cb2a1-cae0a969-4420315a
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618550424646-5c010231cb2a1-cae0a969-4420315a] to complete...
.................................................................................................................................................................................................done.
europe-west4-a
I0416 05:19:37.720396 139671141824320 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.001,
                               'label_smoothing': 0.0,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': 0.0,
                                                     '4': 0.0,
                                                     '5': 0.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'pre_nms_points': 5000,
                               'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.75,
                                    'aug_rand_translate': 0.075,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_boxes': 0.3,
                                    'jitter_im': 0.6,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'min_process_size': 512,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': 0.0,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.213,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 0.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.75,
                                         'aug_rand_translate': 0.075,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_boxes': 0.3,
                                         'jitter_im': 0.6,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'min_process_size': 512,
                                         'mosaic': {'crop_area': [0.75, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 1.0,
                                                    'output_size': [640, 640],
                                                    'random_crop': 0.5,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine_epoch': {'alpha': 0.2,
                                                                     'decay_steps': 249000,
                                                                     'initial_learning_rate': 0.00131,
                                                                     'name': 'CosineEpoch',
                                                                     'steps_per_epoch': 1875},
                                                    'type': 'cosine_epoch'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 10000,
             'summary_interval': 10000,
             'train_steps': 250000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0416 05:19:37.723361 139671141824320 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/config_mean_scaling/250k-letterbox-cosine/params.yaml
I0416 05:19:38.565795 139671141824320 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0416 05:19:38.716333 139671141824320 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0416 05:19:38.716638 139671141824320 transport.py:157] Attempting refresh to obtain initial access_token
I0416 05:19:38.785306 139671141824320 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0416 05:19:39.418574 139671141824320 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0416 05:19:39.418866 139671141824320 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-16 05:19:39.488897: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0416 05:19:39.489683 139671141824320 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0416 05:19:40.125133 139671141824320 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0416 05:19:40.125373 139671141824320 transport.py:157] Attempting refresh to obtain initial access_token
I0416 05:19:40.172924 139671141824320 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0416 05:19:40.803763 139671141824320 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0416 05:19:40.804357 139671141824320 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-16 05:19:40.850571: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-16 05:19:40.864866: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-04-16 05:19:40.864942: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:56577}
2021-04-16 05:20:20.961493: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.91.127.66:8470}
2021-04-16 05:20:20.961600: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:56577}
2021-04-16 05:20:20.962262: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:56577
I0416 05:20:20.963163 139671141824320 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-3
I0416 05:20:20.964263 139671141824320 tpu_strategy_util.py:74] Initializing the TPU system: node-3
INFO:tensorflow:Clearing out eager caches
I0416 05:20:28.069700 139671141824320 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0416 05:20:28.071966 139671141824320 tpu_strategy_util.py:133] Finished initializing TPU system.
I0416 05:20:28.073382 139671141824320 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0416 05:20:28.723284 139671141824320 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0416 05:20:28.723531 139671141824320 transport.py:157] Attempting refresh to obtain initial access_token
I0416 05:20:28.777899 139671141824320 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0416 05:20:29.033086 139671141824320 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3?alt=json
I0416 05:20:29.033333 139671141824320 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0416 05:20:29.087080 139671141824320 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0416 05:20:29.087321 139671141824320 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0416 05:20:29.087589 139671141824320 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0416 05:20:29.087641 139671141824320 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0416 05:20:29.087688 139671141824320 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0416 05:20:29.087814 139671141824320 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0416 05:20:29.087923 139671141824320 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0416 05:20:29.088053 139671141824320 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0416 05:20:29.088171 139671141824320 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0416 05:20:29.088281 139671141824320 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0416 05:20:29.088418 139671141824320 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0416 05:20:29.088522 139671141824320 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0416 05:20:29.088612 139671141824320 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0416 05:20:29.088708 139671141824320 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0416 05:20:29.088810 139671141824320 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0416 05:20:29.088923 139671141824320 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0416 05:20:29.114018 139671141824320 train_utils.py:214] Running default trainer.
2021-04-16 05:20:29.129751: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.3, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.75, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.0, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 512, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.3, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.75, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 1.0, 'crop_area': [0.75, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': 0.5, 'random_crop_mosaic': True}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine_epoch', 'cosine_epoch': {'name': 'CosineEpoch', 'initial_learning_rate': 0.00131, 'decay_steps': 249000, 'steps_per_epoch': 1875, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 10000, 'summary_interval': 10000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 250000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05} 0.00025
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': 5.0, '4': 5.0, '5': 5.0}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 1.2, '4': 1.1, '5': 1.05}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 0.0, '4': 0.0, '5': 0.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'pre_nms_points': 5000, 'label_smoothing': 0.0, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f075486d898>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
conv1 512.0
conv2 1024.0
conv1 512.0
spp
conv1 512.0
conv2 1024.0
conv1 512.0
7
conv1 512.0
conv2 256.0
conv1 512.0
conv2 256.0
4








 ListWrapper([256, 512, 1024])
conv1 128
conv2 256
conv1 128
conv2 256
conv1 128
conv2 256
6
conv1 256
conv2 512
conv1 256
conv2 512
conv1 256
conv2 512
6
conv1 512
conv2 1024
conv1 512
conv2 1024
conv1 512
conv2 1024
6
detget {'3': 1.2, '4': 1.1, '5': 1.05}
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 37319168  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 64,488,640
Trainable params: 64,422,336
Non-trainable params: 66,304
_________________________________________________________________I0416 05:21:15.989136 139671141824320 controller.py:362] restoring or initializing model...
I0416 05:21:23.720350 139671141824320 yolo.py:532] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0416 05:21:23.722274 139671141824320 controller.py:368] initialized model.
I0416 05:21:23.722510 139671141824320 train_lib.py:96] Starts to execute mode: train_and_eval
I0416 05:21:23.727403 139671141824320 controller.py:211] train | step:      0 | training until step 20000...
I0416 05:21:30.672025 139671141824320 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0416 05:22:15.140552 139671141824320 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0416 06:32:22.255279 139671141824320 controller.py:425] train | step:  10000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.560999,
           'avg_obj': 0.11428318,
           'box_loss': 0.33782384,
           'class_loss': 12.489882,
           'conf_loss': 36.35505,
           'precision50': 0.12459727,
           'recall50': 0.04032868},
     '4': {'avg_iou': 0.6125293,
           'avg_obj': 0.18028218,
           'box_loss': 0.31247678,
           'class_loss': 12.453361,
           'conf_loss': 19.572847,
           'precision50': 0.22037463,
           'recall50': 0.10604998},
     '5': {'avg_iou': 0.62427336,
           'avg_obj': 0.20740744,
           'box_loss': 0.18002614,
           'class_loss': 7.8489985,
           'conf_loss': 7.933167,
           'precision50': 0.2640245,
           'recall50': 0.15331253},
     'global': {'total_loss': 97.483665},
     'learning_rate': 0.0013062942,
     'training_loss': 97.483665}
I0416 06:33:21.577545 139671141824320 controller.py:455] saved checkpoint to gs://tensorflow2/config_mean_scaling/250k-letterbox-cosine/ckpt-10000.
I0416 07:36:46.907822 139671141824320 controller.py:425] train | step:  20000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6233869,
           'avg_obj': 0.17278166,
           'box_loss': 0.2896151,
           'class_loss': 4.264813,
           'conf_loss': 8.744072,
           'precision50': 0.19970667,
           'recall50': 0.079307795},
     '4': {'avg_iou': 0.68802047,
           'avg_obj': 0.2672194,
           'box_loss': 0.2512299,
           'class_loss': 4.0711274,
           'conf_loss': 8.324657,
           'precision50': 0.3071977,
           'recall50': 0.19025384},
     '5': {'avg_iou': 0.6950353,
           'avg_obj': 0.29788998,
           'box_loss': 0.14633109,
           'class_loss': 2.5266676,
           'conf_loss': 4.787398,
           'precision50': 0.3625835,
           'recall50': 0.25898108},
     'global': {'total_loss': 33.405895},
     'learning_rate': 0.0012952292,
     'training_loss': 33.405895}
I0416 07:37:00.251317 139671141824320 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0416 07:37:00.794714 139671141824320 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0416 07:37:16.489070 139671141824320 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0416 07:42:00.330100 139671141824320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0416 07:46:23.900178 139671141824320 controller.py:261]  eval | step:  20000 | eval time:  563.6 sec | output: 
    {'3': {'avg_iou': 0.48074025,
           'avg_obj': 0.16407363,
           'box_loss': 0.19998568,
           'class_loss': 2.4683714,
           'conf_loss': 6.857107,
           'precision50': 0.23676255,
           'recall50': 0.13564026},
     '4': {'avg_iou': 0.67805386,
           'avg_obj': 0.3474159,
           'box_loss': 0.16753195,
           'class_loss': 2.2063956,
           'conf_loss': 5.949568,
           'precision50': 0.36931938,
           'recall50': 0.33567157},
     '5': {'avg_iou': 0.732876,
           'avg_obj': 0.47243622,
           'box_loss': 0.093365915,
           'class_loss': 1.2716745,
           'conf_loss': 3.039322,
           'precision50': 0.44234946,
           'recall50': 0.4715459},
     'AP': 0.26181436,
     'AP50': 0.46348286,
     'AP75': 0.2690254,
     'APl': 0.35767266,
     'APm': 0.27661288,
     'APs': 0.10229694,
     'ARl': 0.5749377,
     'ARm': 0.49981877,
     'ARmax1': 0.24197933,
     'ARmax10': 0.41702068,
     'ARmax100': 0.4630297,
     'ARs': 0.2613574,
     'global': {'total_loss': 22.253315},
     'validation_loss': 22.253315}
I0416 07:46:47.504585 139671141824320 controller.py:211] train | step:  20000 | training until step 40000...
I0416 08:56:43.032020 139671141824320 controller.py:425] train | step:  30000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.6404963,
           'avg_obj': 0.19828287,
           'box_loss': 0.27743727,
           'class_loss': 3.742489,
           'conf_loss': 8.488645,
           'precision50': 0.22045597,
           'recall50': 0.0994174},
     '4': {'avg_iou': 0.7088131,
           'avg_obj': 0.30414852,
           'box_loss': 0.2349507,
           'class_loss': 3.495592,
           'conf_loss': 7.909168,
           'precision50': 0.32328272,
           'recall50': 0.22617453},
     '5': {'avg_iou': 0.7150405,
           'avg_obj': 0.33577445,
           'box_loss': 0.13675004,
           'class_loss': 2.1817014,
           'conf_loss': 4.528492,
           'precision50': 0.38158864,
           'recall50': 0.30105212},
     'global': {'total_loss': 30.995243},
     'learning_rate': 0.0012724648,
     'training_loss': 30.995243}
I0416 08:57:34.312006 139671141824320 controller.py:455] saved checkpoint to gs://tensorflow2/config_mean_scaling/250k-letterbox-cosine/ckpt-30000.
I0416 10:05:24.735893 139671141824320 controller.py:425] train | step:  40000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.65072024,
           'avg_obj': 0.21466714,
           'box_loss': 0.2700184,
           'class_loss': 3.4396336,
           'conf_loss': 8.318807,
           'precision50': 0.22990908,
           'recall50': 0.1115893},
     '4': {'avg_iou': 0.7209446,
           'avg_obj': 0.32684729,
           'box_loss': 0.22539973,
           'class_loss': 3.1587932,
           'conf_loss': 7.66009,
           'precision50': 0.33167017,
           'recall50': 0.24838288},
     '5': {'avg_iou': 0.72732586,
           'avg_obj': 0.35969952,
           'box_loss': 0.13100238,
           'class_loss': 1.9814982,
           'conf_loss': 4.370527,
           'precision50': 0.39171466,
           'recall50': 0.32754847},
     'global': {'total_loss': 29.55571},
     'learning_rate': 0.0012459038,
     'training_loss': 29.55571}

defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4), num_detections: (8,), upds: {3: (8, 200, 8), 4: (8, 200, 8), 5: (8, 200, 8)}, inds: {3: (8, 200, 3), 4: (8, 200, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 1.2, '4': 1.1, '5': 1.05}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
train | step:  10000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.560999,
           'avg_obj': 0.11428318,
           'box_loss': 0.33782384,
           'class_loss': 12.489882,
           'conf_loss': 36.35505,
           'precision50': 0.12459727,
           'recall50': 0.04032868},
     '4': {'avg_iou': 0.6125293,
           'avg_obj': 0.18028218,
           'box_loss': 0.31247678,
           'class_loss': 12.453361,
           'conf_loss': 19.572847,
           'precision50': 0.22037463,
           'recall50': 0.10604998},
     '5': {'avg_iou': 0.62427336,
           'avg_obj': 0.20740744,
           'box_loss': 0.18002614,
           'class_loss': 7.8489985,
           'conf_loss': 7.933167,
           'precision50': 0.2640245,
           'recall50': 0.15331253},
     'global': {'total_loss': 97.483665},
     'learning_rate': 0.0013062942,
     'training_loss': 97.483665}
saved checkpoint to gs://tensorflow2/config_mean_scaling/250k-letterbox-cosine/ckpt-10000.
train | step:  20000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6233869,
           'avg_obj': 0.17278166,
           'box_loss': 0.2896151,
           'class_loss': 4.264813,
           'conf_loss': 8.744072,
           'precision50': 0.19970667,
           'recall50': 0.079307795},
     '4': {'avg_iou': 0.68802047,
           'avg_obj': 0.2672194,
           'box_loss': 0.2512299,
           'class_loss': 4.0711274,
           'conf_loss': 8.324657,
           'precision50': 0.3071977,
           'recall50': 0.19025384},
     '5': {'avg_iou': 0.6950353,
           'avg_obj': 0.29788998,
           'box_loss': 0.14633109,
           'class_loss': 2.5266676,
           'conf_loss': 4.787398,
           'precision50': 0.3625835,
           'recall50': 0.25898108},
     'global': {'total_loss': 33.405895},
     'learning_rate': 0.0012952292,
     'training_loss': 33.405895}
 eval | step:  20000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=191.14s).
Accumulating evaluation results...
DONE (t=17.55s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.262
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.463
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.269
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.102
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.277
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.358
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.242
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.417
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.463
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.261
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.500
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.575
 eval | step:  20000 | eval time:  563.6 sec | output: 
    {'3': {'avg_iou': 0.48074025,
           'avg_obj': 0.16407363,
           'box_loss': 0.19998568,
           'class_loss': 2.4683714,
           'conf_loss': 6.857107,
           'precision50': 0.23676255,
           'recall50': 0.13564026},
     '4': {'avg_iou': 0.67805386,
           'avg_obj': 0.3474159,
           'box_loss': 0.16753195,
           'class_loss': 2.2063956,
           'conf_loss': 5.949568,
           'precision50': 0.36931938,
           'recall50': 0.33567157},
     '5': {'avg_iou': 0.732876,
           'avg_obj': 0.47243622,
           'box_loss': 0.093365915,
           'class_loss': 1.2716745,
           'conf_loss': 3.039322,
           'precision50': 0.44234946,
           'recall50': 0.4715459},
     'AP': 0.26181436,
     'AP50': 0.46348286,
     'AP75': 0.2690254,
     'APl': 0.35767266,
     'APm': 0.27661288,
     'APs': 0.10229694,
     'ARl': 0.5749377,
     'ARm': 0.49981877,
     'ARmax1': 0.24197933,
     'ARmax10': 0.41702068,
     'ARmax100': 0.4630297,
     'ARs': 0.2613574,
     'global': {'total_loss': 22.253315},
     'validation_loss': 22.253315}
train | step:  20000 | training until step 40000...
train | step:  30000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.6404963,
           'avg_obj': 0.19828287,
           'box_loss': 0.27743727,
           'class_loss': 3.742489,
           'conf_loss': 8.488645,
           'precision50': 0.22045597,
           'recall50': 0.0994174},
     '4': {'avg_iou': 0.7088131,
           'avg_obj': 0.30414852,
           'box_loss': 0.2349507,
           'class_loss': 3.495592,
           'conf_loss': 7.909168,
           'precision50': 0.32328272,
           'recall50': 0.22617453},
     '5': {'avg_iou': 0.7150405,
           'avg_obj': 0.33577445,
           'box_loss': 0.13675004,
           'class_loss': 2.1817014,
           'conf_loss': 4.528492,
           'precision50': 0.38158864,
           'recall50': 0.30105212},
     'global': {'total_loss': 30.995243},
     'learning_rate': 0.0012724648,
     'training_loss': 30.995243}
saved checkpoint to gs://tensorflow2/config_mean_scaling/250k-letterbox-cosine/ckpt-30000.
train | step:  40000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.65072024,
           'avg_obj': 0.21466714,
           'box_loss': 0.2700184,
           'class_loss': 3.4396336,
           'conf_loss': 8.318807,
           'precision50': 0.22990908,
           'recall50': 0.1115893},
     '4': {'avg_iou': 0.7209446,
           'avg_obj': 0.32684729,
           'box_loss': 0.22539973,
           'class_loss': 3.1587932,
           'conf_loss': 7.66009,
           'precision50': 0.33167017,
           'recall50': 0.24838288},
     '5': {'avg_iou': 0.72732586,
           'avg_obj': 0.35969952,
           'box_loss': 0.13100238,
           'class_loss': 1.9814982,
           'conf_loss': 4.370527,
           'precision50': 0.39171466,
           'recall50': 0.32754847},
     'global': {'total_loss': 29.55571},
     'learning_rate': 0.0012459038,
     'training_loss': 29.55571}I0416 10:05:39.929756 139671141824320 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0416 10:09:45.863296 139671141824320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0416 10:14:00.292826 139671141824320 controller.py:261]  eval | step:  40000 | eval time:  500.4 sec | output: 
    {'3': {'avg_iou': 0.4926897,
           'avg_obj': 0.18946421,
           'box_loss': 0.18964303,
           'class_loss': 2.0651174,
           'conf_loss': 6.5627923,
           'precision50': 0.25850466,
           'recall50': 0.1682647},
     '4': {'avg_iou': 0.6960386,
           'avg_obj': 0.39586234,
           'box_loss': 0.15465368,
           'class_loss': 1.7906344,
           'conf_loss': 5.552784,
           'precision50': 0.37995946,
           'recall50': 0.39289907},
     '5': {'avg_iou': 0.75276303,
           'avg_obj': 0.53058785,
           'box_loss': 0.085154764,
           'class_loss': 1.0423243,
           'conf_loss': 2.779914,
           'precision50': 0.44852015,
           'recall50': 0.53658694},
     'AP': 0.31406525,
     'AP50': 0.5283078,
     'AP75': 0.33086422,
     'APl': 0.43018925,
     'APm': 0.33076084,
     'APs': 0.12826163,
     'ARl': 0.6296851,
     'ARm': 0.5433664,
     'ARmax1': 0.27356738,
     'ARmax10': 0.45881653,
     'ARmax100': 0.5062887,
     'ARs': 0.30228978,
     'global': {'total_loss': 20.223034},
     'validation_loss': 20.223034}
I0416 10:14:16.963618 139671141824320 controller.py:211] train | step:  40000 | training until step 60000...
I0416 11:19:13.119771 139671141824320 controller.py:425] train | step:  50000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6576088,
           'avg_obj': 0.22780152,
           'box_loss': 0.26532814,
           'class_loss': 3.2257767,
           'conf_loss': 8.198862,
           'precision50': 0.23833203,
           'recall50': 0.12217953},
     '4': {'avg_iou': 0.729532,
           'avg_obj': 0.34415326,
           'box_loss': 0.21880327,
           'class_loss': 2.9280927,
           'conf_loss': 7.469652,
           'precision50': 0.3375627,
           'recall50': 0.26567268},
     '5': {'avg_iou': 0.73581564,
           'avg_obj': 0.37754166,
           'box_loss': 0.12697625,
           'class_loss': 1.8365903,
           'conf_loss': 4.2507334,
           'precision50': 0.39717332,
           'recall50': 0.34641433},
     'global': {'total_loss': 28.520788},
     'learning_rate': 0.0012128378,
     'training_loss': 28.520788}
I0416 11:20:02.475796 139671141824320 controller.py:455] saved checkpoint to gs://tensorflow2/config_mean_scaling/250k-letterbox-cosine/ckpt-50000.
I0416 12:23:58.697622 139671141824320 controller.py:425] train | step:  60000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.66314983,
           'avg_obj': 0.23805848,
           'box_loss': 0.26084203,
           'class_loss': 3.0559347,
           'conf_loss': 8.076708,
           'precision50': 0.24298567,
           'recall50': 0.13025388},
     '4': {'avg_iou': 0.7363385,
           'avg_obj': 0.35753015,
           'box_loss': 0.21275517,
           'class_loss': 2.740519,
           'conf_loss': 7.2974944,
           'precision50': 0.34135413,
           'recall50': 0.27839148},
     '5': {'avg_iou': 0.7428126,
           'avg_obj': 0.39241004,
           'box_loss': 0.123654455,
           'class_loss': 1.7226777,
           'conf_loss': 4.1509223,
           'precision50': 0.4018191,
           'recall50': 0.36241305},
     'global': {'total_loss': 27.641537},
     'learning_rate': 0.0011652366,
     'training_loss': 27.641537}
I0416 12:24:11.561179 139671141824320 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0416 12:28:18.139629 139671141824320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0416 12:32:23.510406 139671141824320 controller.py:261]  eval | step:  60000 | eval time:  491.9 sec | output: 
    {'3': {'avg_iou': 0.49761605,
           'avg_obj': 0.20384207,
           'box_loss': 0.18475798,
           'class_loss': 1.890737,
           'conf_loss': 6.4219866,
           'precision50': 0.2658271,
           'recall50': 0.18420641},
     '4': {'avg_iou': 0.70418054,
           'avg_obj': 0.42295682,
           'box_loss': 0.14856589,
           'class_loss': 1.6196954,
           'conf_loss': 5.3553357,
           'precision50': 0.37927568,
           'recall50': 0.41829488},
     '5': {'avg_iou': 0.76215804,
           'avg_obj': 0.56082326,
           'box_loss': 0.08130958,
           'class_loss': 0.9476649,
           'conf_loss': 2.6673665,
           'precision50': 0.4425399,
           'recall50': 0.5683706},
     'AP': 0.33928066,
     'AP50': 0.5562748,
     'AP75': 0.36183873,
     'APl': 0.4657764,
     'APm': 0.36018756,
     'APs': 0.14042848,
     'ARl': 0.65173364,
     'ARm': 0.5648384,
     'ARmax1': 0.2878532,
     'ARmax10': 0.47864872,
     'ARmax100': 0.5250565,
     'ARs': 0.31939468,
     'global': {'total_loss': 19.317413},
     'validation_loss': 19.317413}
I0416 12:32:40.859098 139671141824320 controller.py:211] train | step:  60000 | training until step 80000...
I0416 13:33:34.404738 139671141824320 controller.py:425] train | step:  70000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6673937,
           'avg_obj': 0.24681252,
           'box_loss': 0.25677282,
           'class_loss': 2.9078922,
           'conf_loss': 7.958331,
           'precision50': 0.2467566,
           'recall50': 0.13665207},
     '4': {'avg_iou': 0.7415293,
           'avg_obj': 0.36909857,
           'box_loss': 0.20817642,
           'class_loss': 2.5941403,
           'conf_loss': 7.1475873,
           'precision50': 0.34355682,
           'recall50': 0.2888869},
     '5': {'avg_iou': 0.74806964,
           'avg_obj': 0.4028623,
           'box_loss': 0.120964415,
           'class_loss': 1.6400346,
           'conf_loss': 4.0733,
           'precision50': 0.40569764,
           'recall50': 0.37424937},
     'global': {'total_loss': 26.907188},
     'learning_rate': 0.0011196256,
     'training_loss': 26.907188}
I0416 13:34:25.908147 139671141824320 controller.py:455] saved checkpoint to gs://tensorflow2/config_mean_scaling/250k-letterbox-cosine/ckpt-70000.
I0416 14:45:33.179404 139671141824320 controller.py:425] train | step:  80000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.67148244,
           'avg_obj': 0.25511962,
           'box_loss': 0.25421435,
           'class_loss': 2.7930171,
           'conf_loss': 7.885397,
           'precision50': 0.25080553,
           'recall50': 0.14331037},
     '4': {'avg_iou': 0.7461479,
           'avg_obj': 0.3796821,
           'box_loss': 0.20505503,
           'class_loss': 2.4730828,
           'conf_loss': 7.0480127,
           'precision50': 0.34820485,
           'recall50': 0.2999748},
     '5': {'avg_iou': 0.7529771,
           'avg_obj': 0.41459298,
           'box_loss': 0.1187765,
           'class_loss': 1.5644798,
           'conf_loss': 3.9995165,
           'precision50': 0.4090012,
           'recall50': 0.38654813},
     'global': {'total_loss': 26.341585},
     'learning_rate': 0.0010692958,
     'training_loss': 26.341585}

 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=177.47s).
Accumulating evaluation results...
DONE (t=17.56s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.314
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.528
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.331
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.128
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.331
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.430
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.274
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.459
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.506
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.302
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.543
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.630
 eval | step:  40000 | eval time:  500.4 sec | output: 
    {'3': {'avg_iou': 0.4926897,
           'avg_obj': 0.18946421,
           'box_loss': 0.18964303,
           'class_loss': 2.0651174,
           'conf_loss': 6.5627923,
           'precision50': 0.25850466,
           'recall50': 0.1682647},
     '4': {'avg_iou': 0.6960386,
           'avg_obj': 0.39586234,
           'box_loss': 0.15465368,
           'class_loss': 1.7906344,
           'conf_loss': 5.552784,
           'precision50': 0.37995946,
           'recall50': 0.39289907},
     '5': {'avg_iou': 0.75276303,
           'avg_obj': 0.53058785,
           'box_loss': 0.085154764,
           'class_loss': 1.0423243,
           'conf_loss': 2.779914,
           'precision50': 0.44852015,
           'recall50': 0.53658694},
     'AP': 0.31406525,
     'AP50': 0.5283078,
     'AP75': 0.33086422,
     'APl': 0.43018925,
     'APm': 0.33076084,
     'APs': 0.12826163,
     'ARl': 0.6296851,
     'ARm': 0.5433664,
     'ARmax1': 0.27356738,
     'ARmax10': 0.45881653,
     'ARmax100': 0.5062887,
     'ARs': 0.30228978,
     'global': {'total_loss': 20.223034},
     'validation_loss': 20.223034}
train | step:  40000 | training until step 60000...
train | step:  50000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6576088,
           'avg_obj': 0.22780152,
           'box_loss': 0.26532814,
           'class_loss': 3.2257767,
           'conf_loss': 8.198862,
           'precision50': 0.23833203,
           'recall50': 0.12217953},
     '4': {'avg_iou': 0.729532,
           'avg_obj': 0.34415326,
           'box_loss': 0.21880327,
           'class_loss': 2.9280927,
           'conf_loss': 7.469652,
           'precision50': 0.3375627,
           'recall50': 0.26567268},
     '5': {'avg_iou': 0.73581564,
           'avg_obj': 0.37754166,
           'box_loss': 0.12697625,
           'class_loss': 1.8365903,
           'conf_loss': 4.2507334,
           'precision50': 0.39717332,
           'recall50': 0.34641433},
     'global': {'total_loss': 28.520788},
     'learning_rate': 0.0012128378,
     'training_loss': 28.520788}
saved checkpoint to gs://tensorflow2/config_mean_scaling/250k-letterbox-cosine/ckpt-50000.
train | step:  60000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.66314983,
           'avg_obj': 0.23805848,
           'box_loss': 0.26084203,
           'class_loss': 3.0559347,
           'conf_loss': 8.076708,
           'precision50': 0.24298567,
           'recall50': 0.13025388},
     '4': {'avg_iou': 0.7363385,
           'avg_obj': 0.35753015,
           'box_loss': 0.21275517,
           'class_loss': 2.740519,
           'conf_loss': 7.2974944,
           'precision50': 0.34135413,
           'recall50': 0.27839148},
     '5': {'avg_iou': 0.7428126,
           'avg_obj': 0.39241004,
           'box_loss': 0.123654455,
           'class_loss': 1.7226777,
           'conf_loss': 4.1509223,
           'precision50': 0.4018191,
           'recall50': 0.36241305},
     'global': {'total_loss': 27.641537},
     'learning_rate': 0.0011652366,
     'training_loss': 27.641537}
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.09s).
Accumulating evaluation results...
DONE (t=14.28s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.339
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.556
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.362
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.140
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.360
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.466
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.288
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.479
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.525
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.319
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.565
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.652
 eval | step:  60000 | eval time:  491.9 sec | output: 
    {'3': {'avg_iou': 0.49761605,
           'avg_obj': 0.20384207,
           'box_loss': 0.18475798,
           'class_loss': 1.890737,
           'conf_loss': 6.4219866,
           'precision50': 0.2658271,
           'recall50': 0.18420641},
     '4': {'avg_iou': 0.70418054,
           'avg_obj': 0.42295682,
           'box_loss': 0.14856589,
           'class_loss': 1.6196954,
           'conf_loss': 5.3553357,
           'precision50': 0.37927568,
           'recall50': 0.41829488},
     '5': {'avg_iou': 0.76215804,
           'avg_obj': 0.56082326,
           'box_loss': 0.08130958,
           'class_loss': 0.9476649,
           'conf_loss': 2.6673665,
           'precision50': 0.4425399,
           'recall50': 0.5683706},
     'AP': 0.33928066,
     'AP50': 0.5562748,
     'AP75': 0.36183873,
     'APl': 0.4657764,
     'APm': 0.36018756,
     'APs': 0.14042848,
     'ARl': 0.65173364,
     'ARm': 0.5648384,
     'ARmax1': 0.2878532,
     'ARmax10': 0.47864872,
     'ARmax100': 0.5250565,
     'ARs': 0.31939468,
     'global': {'total_loss': 19.317413},
     'validation_loss': 19.317413}
train | step:  60000 | training until step 80000...
train | step:  70000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6673937,
           'avg_obj': 0.24681252,
           'box_loss': 0.25677282,
           'class_loss': 2.9078922,
           'conf_loss': 7.958331,
           'precision50': 0.2467566,
           'recall50': 0.13665207},
     '4': {'avg_iou': 0.7415293,
           'avg_obj': 0.36909857,
           'box_loss': 0.20817642,
           'class_loss': 2.5941403,
           'conf_loss': 7.1475873,
           'precision50': 0.34355682,
           'recall50': 0.2888869},
     '5': {'avg_iou': 0.74806964,
           'avg_obj': 0.4028623,
           'box_loss': 0.120964415,
           'class_loss': 1.6400346,
           'conf_loss': 4.0733,
           'precision50': 0.40569764,
           'recall50': 0.37424937},
     'global': {'total_loss': 26.907188},
     'learning_rate': 0.0011196256,
     'training_loss': 26.907188}
saved checkpoint to gs://tensorflow2/config_mean_scaling/250k-letterbox-cosine/ckpt-70000.
train | step:  80000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.67148244,
           'avg_obj': 0.25511962,
           'box_loss': 0.25421435,
           'class_loss': 2.7930171,
           'conf_loss': 7.885397,
           'precision50': 0.25080553,
           'recall50': 0.14331037},
     '4': {'avg_iou': 0.7461479,
           'avg_obj': 0.3796821,
           'box_loss': 0.20505503,
           'class_loss': 2.4730828,
           'conf_loss': 7.0480127,
           'precision50': 0.34820485,
           'recall50': 0.2999748},
     '5': {'avg_iou': 0.7529771,
           'avg_obj': 0.41459298,
           'box_loss': 0.1187765,
           'class_loss': 1.5644798,
           'conf_loss': 3.9995165,
           'precision50': 0.4090012,
           'recall50': 0.38654813},
     'global': {'total_loss': 26.341585},
     'learning_rate': 0.0010692958,
     'training_loss': 26.341585}I0416 14:45:45.833471 139671141824320 controller.py:252]  eval | step:  80000 | running 625 steps of evaluation...
I0416 14:49:54.646941 139671141824320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0416 14:53:55.397175 139671141824320 controller.py:261]  eval | step:  80000 | eval time:  489.6 sec | output: 
    {'3': {'avg_iou': 0.50091094,
           'avg_obj': 0.21345986,
           'box_loss': 0.1815021,
           'class_loss': 1.7993947,
           'conf_loss': 6.3394365,
           'precision50': 0.26597512,
           'recall50': 0.1938117},
     '4': {'avg_iou': 0.7095337,
           'avg_obj': 0.43944144,
           'box_loss': 0.1447336,
           'class_loss': 1.5523137,
           'conf_loss': 5.253907,
           'precision50': 0.37941897,
           'recall50': 0.4363002},
     '5': {'avg_iou': 0.7683713,
           'avg_obj': 0.58026135,
           'box_loss': 0.078890726,
           'class_loss': 0.891062,
           'conf_loss': 2.5871365,
           'precision50': 0.44125333,
           'recall50': 0.59017086},
     'AP': 0.3553827,
     'AP50': 0.57298446,
     'AP75': 0.38267484,
     'APl': 0.49067974,
     'APm': 0.37690282,
     'APs': 0.14997344,
     'ARl': 0.66683567,
     'ARm': 0.5775468,
     'ARmax1': 0.29773232,
     'ARmax10': 0.49148017,
     'ARmax100': 0.5387704,
     'ARs': 0.32273954,
     'global': {'total_loss': 18.82837},
     'validation_loss': 18.82837}
I0416 14:54:11.987047 139671141824320 controller.py:211] train | step:  80000 | training until step 100000...
I0416 16:01:21.996678 139671141824320 controller.py:425] train | step:  90000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6744524,
           'avg_obj': 0.2622158,
           'box_loss': 0.25142232,
           'class_loss': 2.6838977,
           'conf_loss': 7.7965837,
           'precision50': 0.25425884,
           'recall50': 0.14937396},
     '4': {'avg_iou': 0.7501698,
           'avg_obj': 0.38997743,
           'box_loss': 0.20121399,
           'class_loss': 2.3597775,
           'conf_loss': 6.9116416,
           'precision50': 0.34962022,
           'recall50': 0.30924687},
     '5': {'avg_iou': 0.7570945,
           'avg_obj': 0.42421085,
           'box_loss': 0.11651185,
           'class_loss': 1.4931633,
           'conf_loss': 3.9255886,
           'precision50': 0.4101584,
           'recall50': 0.3962604},
     'global': {'total_loss': 25.739769},
     'learning_rate': 0.0010036774,
     'training_loss': 25.739769}
I0416 16:02:12.835641 139671141824320 controller.py:455] saved checkpoint to gs://tensorflow2/config_mean_scaling/250k-letterbox-cosine/ckpt-90000.
I0416 17:08:12.009837 139671141824320 controller.py:425] train | step:  100000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.677926,
           'avg_obj': 0.2687292,
           'box_loss': 0.24909362,
           'class_loss': 2.5933619,
           'conf_loss': 7.729676,
           'precision50': 0.25661036,
           'recall50': 0.15428574},
     '4': {'avg_iou': 0.7536041,
           'avg_obj': 0.39815652,
           'box_loss': 0.19902283,
           'class_loss': 2.270257,
           'conf_loss': 6.838386,
           'precision50': 0.3529081,
           'recall50': 0.31773594},
     '5': {'avg_iou': 0.7606189,
           'avg_obj': 0.43262416,
           'box_loss': 0.1152338,
           'class_loss': 1.4384491,
           'conf_loss': 3.8799827,
           'precision50': 0.41490322,
           'recall50': 0.40603566},
     'global': {'total_loss': 25.313509},
     'learning_rate': 0.00094555086,
     'training_loss': 25.313509}
I0416 17:08:26.771934 139671141824320 controller.py:252]  eval | step:  100000 | running 625 steps of evaluation...
I0416 17:12:29.576050 139671141824320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0416 17:16:58.406369 139671141824320 controller.py:261]  eval | step:  100000 | eval time:  511.6 sec | output: 
    {'3': {'avg_iou': 0.5033951,
           'avg_obj': 0.22055654,
           'box_loss': 0.17933294,
           'class_loss': 1.740582,
           'conf_loss': 6.2748756,
           'precision50': 0.26848358,
           'recall50': 0.20197657},
     '4': {'avg_iou': 0.7133814,
           'avg_obj': 0.45197842,
           'box_loss': 0.14192541,
           'class_loss': 1.4881248,
           'conf_loss': 5.1873593,
           'precision50': 0.3727697,
           'recall50': 0.4503686},
     '5': {'avg_iou': 0.77180374,
           'avg_obj': 0.5922526,
           'box_loss': 0.07738233,
           'class_loss': 0.8629103,
           'conf_loss': 2.5570107,
           'precision50': 0.43643716,
           'recall50': 0.6019554},
     'AP': 0.36571872,
     'AP50': 0.58341557,
     'AP75': 0.39183894,
     'APl': 0.50312716,
     'APm': 0.3884948,
     'APs': 0.15760161,
     'ARl': 0.6731183,
     'ARm': 0.5870936,
     'ARmax1': 0.30276114,
     'ARmax10': 0.49854615,
     'ARmax100': 0.54560244,
     'ARs': 0.33440387,
     'global': {'total_loss': 18.5095},
     'validation_loss': 18.5095}
I0416 17:17:16.175140 139671141824320 controller.py:211] train | step:  100000 | training until step 120000...
I0416 18:17:27.282926 139671141824320 controller.py:425] train | step:  110000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6804148,
           'avg_obj': 0.27524114,
           'box_loss': 0.24737012,
           'class_loss': 2.5186813,
           'conf_loss': 7.668414,
           'precision50': 0.2593579,
           'recall50': 0.15943325},
     '4': {'avg_iou': 0.7566981,
           'avg_obj': 0.4059372,
           'box_loss': 0.19640353,
           'class_loss': 2.1945267,
           'conf_loss': 6.7420125,
           'precision50': 0.35460836,
           'recall50': 0.32528847},
     '5': {'avg_iou': 0.76392967,
           'avg_obj': 0.44065863,
           'box_loss': 0.11340491,
           'class_loss': 1.3887758,
           'conf_loss': 3.8177896,
           'precision50': 0.41561723,
           'recall50': 0.41415343},
     'global': {'total_loss': 24.887402},
     'learning_rate': 0.0008851676,
     'training_loss': 24.887402}
I0416 18:18:18.591598 139671141824320 controller.py:455] saved checkpoint to gs://tensorflow2/config_mean_scaling/250k-letterbox-cosine/ckpt-110000.
I0416 19:19:10.582033 139671141824320 controller.py:425] train | step:  120000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.68257993,
           'avg_obj': 0.2802924,
           'box_loss': 0.24591184,
           'class_loss': 2.4484308,
           'conf_loss': 7.616368,
           'precision50': 0.26114666,
           'recall50': 0.16338626},
     '4': {'avg_iou': 0.75942117,
           'avg_obj': 0.4140891,
           'box_loss': 0.19450541,
           'class_loss': 2.1185782,
           'conf_loss': 6.658902,
           'precision50': 0.35572144,
           'recall50': 0.33323494},
     '5': {'avg_iou': 0.7668855,
           'avg_obj': 0.44854024,
           'box_loss': 0.11213281,
           'class_loss': 1.3424275,
           'conf_loss': 3.7695239,
           'precision50': 0.4163998,
           'recall50': 0.4219453},
     'global': {'total_loss': 24.50681},
     'learning_rate': 0.0008109329,
     'training_loss': 24.50681}

 eval | step:  80000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=175.78s).
Accumulating evaluation results...
DONE (t=13.49s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.355
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.573
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.383
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.150
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.377
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.298
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.491
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.539
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.323
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.578
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.667
 eval | step:  80000 | eval time:  489.6 sec | output: 
    {'3': {'avg_iou': 0.50091094,
           'avg_obj': 0.21345986,
           'box_loss': 0.1815021,
           'class_loss': 1.7993947,
           'conf_loss': 6.3394365,
           'precision50': 0.26597512,
           'recall50': 0.1938117},
     '4': {'avg_iou': 0.7095337,
           'avg_obj': 0.43944144,
           'box_loss': 0.1447336,
           'class_loss': 1.5523137,
           'conf_loss': 5.253907,
           'precision50': 0.37941897,
           'recall50': 0.4363002},
     '5': {'avg_iou': 0.7683713,
           'avg_obj': 0.58026135,
           'box_loss': 0.078890726,
           'class_loss': 0.891062,
           'conf_loss': 2.5871365,
           'precision50': 0.44125333,
           'recall50': 0.59017086},
     'AP': 0.3553827,
     'AP50': 0.57298446,
     'AP75': 0.38267484,
     'APl': 0.49067974,
     'APm': 0.37690282,
     'APs': 0.14997344,
     'ARl': 0.66683567,
     'ARm': 0.5775468,
     'ARmax1': 0.29773232,
     'ARmax10': 0.49148017,
     'ARmax100': 0.5387704,
     'ARs': 0.32273954,
     'global': {'total_loss': 18.82837},
     'validation_loss': 18.82837}
train | step:  80000 | training until step 100000...
train | step:  90000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6744524,
           'avg_obj': 0.2622158,
           'box_loss': 0.25142232,
           'class_loss': 2.6838977,
           'conf_loss': 7.7965837,
           'precision50': 0.25425884,
           'recall50': 0.14937396},
     '4': {'avg_iou': 0.7501698,
           'avg_obj': 0.38997743,
           'box_loss': 0.20121399,
           'class_loss': 2.3597775,
           'conf_loss': 6.9116416,
           'precision50': 0.34962022,
           'recall50': 0.30924687},
     '5': {'avg_iou': 0.7570945,
           'avg_obj': 0.42421085,
           'box_loss': 0.11651185,
           'class_loss': 1.4931633,
           'conf_loss': 3.9255886,
           'precision50': 0.4101584,
           'recall50': 0.3962604},
     'global': {'total_loss': 25.739769},
     'learning_rate': 0.0010036774,
     'training_loss': 25.739769}
saved checkpoint to gs://tensorflow2/config_mean_scaling/250k-letterbox-cosine/ckpt-90000.
train | step:  100000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.677926,
           'avg_obj': 0.2687292,
           'box_loss': 0.24909362,
           'class_loss': 2.5933619,
           'conf_loss': 7.729676,
           'precision50': 0.25661036,
           'recall50': 0.15428574},
     '4': {'avg_iou': 0.7536041,
           'avg_obj': 0.39815652,
           'box_loss': 0.19902283,
           'class_loss': 2.270257,
           'conf_loss': 6.838386,
           'precision50': 0.3529081,
           'recall50': 0.31773594},
     '5': {'avg_iou': 0.7606189,
           'avg_obj': 0.43262416,
           'box_loss': 0.1152338,
           'class_loss': 1.4384491,
           'conf_loss': 3.8799827,
           'precision50': 0.41490322,
           'recall50': 0.40603566},
     'global': {'total_loss': 25.313509},
     'learning_rate': 0.00094555086,
     'training_loss': 25.313509}
 eval | step:  100000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=194.89s).
Accumulating evaluation results...
DONE (t=13.22s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.366
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.583
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.392
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.158
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.388
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.503
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.303
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.499
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.546
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.334
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.587
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.673
 eval | step:  100000 | eval time:  511.6 sec | output: 
    {'3': {'avg_iou': 0.5033951,
           'avg_obj': 0.22055654,
           'box_loss': 0.17933294,
           'class_loss': 1.740582,
           'conf_loss': 6.2748756,
           'precision50': 0.26848358,
           'recall50': 0.20197657},
     '4': {'avg_iou': 0.7133814,
           'avg_obj': 0.45197842,
           'box_loss': 0.14192541,
           'class_loss': 1.4881248,
           'conf_loss': 5.1873593,
           'precision50': 0.3727697,
           'recall50': 0.4503686},
     '5': {'avg_iou': 0.77180374,
           'avg_obj': 0.5922526,
           'box_loss': 0.07738233,
           'class_loss': 0.8629103,
           'conf_loss': 2.5570107,
           'precision50': 0.43643716,
           'recall50': 0.6019554},
     'AP': 0.36571872,
     'AP50': 0.58341557,
     'AP75': 0.39183894,
     'APl': 0.50312716,
     'APm': 0.3884948,
     'APs': 0.15760161,
     'ARl': 0.6731183,
     'ARm': 0.5870936,
     'ARmax1': 0.30276114,
     'ARmax10': 0.49854615,
     'ARmax100': 0.54560244,
     'ARs': 0.33440387,
     'global': {'total_loss': 18.5095},
     'validation_loss': 18.5095}
train | step:  100000 | training until step 120000...
train | step:  110000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6804148,
           'avg_obj': 0.27524114,
           'box_loss': 0.24737012,
           'class_loss': 2.5186813,
           'conf_loss': 7.668414,
           'precision50': 0.2593579,
           'recall50': 0.15943325},
     '4': {'avg_iou': 0.7566981,
           'avg_obj': 0.4059372,
           'box_loss': 0.19640353,
           'class_loss': 2.1945267,
           'conf_loss': 6.7420125,
           'precision50': 0.35460836,
           'recall50': 0.32528847},
     '5': {'avg_iou': 0.76392967,
           'avg_obj': 0.44065863,
           'box_loss': 0.11340491,
           'class_loss': 1.3887758,
           'conf_loss': 3.8177896,
           'precision50': 0.41561723,
           'recall50': 0.41415343},
     'global': {'total_loss': 24.887402},
     'learning_rate': 0.0008851676,
     'training_loss': 24.887402}
saved checkpoint to gs://tensorflow2/config_mean_scaling/250k-letterbox-cosine/ckpt-110000.
train | step:  120000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.68257993,
           'avg_obj': 0.2802924,
           'box_loss': 0.24591184,
           'class_loss': 2.4484308,
           'conf_loss': 7.616368,
           'precision50': 0.26114666,
           'recall50': 0.16338626},
     '4': {'avg_iou': 0.75942117,
           'avg_obj': 0.4140891,
           'box_loss': 0.19450541,
           'class_loss': 2.1185782,
           'conf_loss': 6.658902,
           'precision50': 0.35572144,
           'recall50': 0.33323494},
     '5': {'avg_iou': 0.7668855,
           'avg_obj': 0.44854024,
           'box_loss': 0.11213281,
           'class_loss': 1.3424275,
           'conf_loss': 3.7695239,
           'precision50': 0.4163998,
           'recall50': 0.4219453},
     'global': {'total_loss': 24.50681},
     'learning_rate': 0.0008109329,
     'training_loss': 24.50681}I0416 19:19:24.253320 139671141824320 controller.py:252]  eval | step:  120000 | running 625 steps of evaluation...
I0416 19:23:30.877753 139671141824320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0416 19:27:32.794837 139671141824320 controller.py:261]  eval | step:  120000 | eval time:  488.5 sec | output: 
    {'3': {'avg_iou': 0.5047985,
           'avg_obj': 0.22649266,
           'box_loss': 0.1779539,
           'class_loss': 1.7100924,
           'conf_loss': 6.234041,
           'precision50': 0.26922062,
           'recall50': 0.21038906},
     '4': {'avg_iou': 0.7156458,
           'avg_obj': 0.46126676,
           'box_loss': 0.13994412,
           'class_loss': 1.4654813,
           'conf_loss': 5.1549273,
           'precision50': 0.3739116,
           'recall50': 0.46235928},
     '5': {'avg_iou': 0.7747729,
           'avg_obj': 0.60262924,
           'box_loss': 0.07609026,
           'class_loss': 0.8438872,
           'conf_loss': 2.5355647,
           'precision50': 0.4294383,
           'recall50': 0.61108434},
     'AP': 0.3713504,
     'AP50': 0.5881482,
     'AP75': 0.39960945,
     'APl': 0.50976235,
     'APm': 0.39478973,
     'APs': 0.1607049,
     'ARl': 0.67594576,
     'ARm': 0.589043,
     'ARmax1': 0.30428582,
     'ARmax10': 0.5020308,
     'ARmax100': 0.5482749,
     'ARs': 0.3271797,
     'global': {'total_loss': 18.337978},
     'validation_loss': 18.337978}
I0416 19:27:49.117175 139671141824320 controller.py:211] train | step:  120000 | training until step 140000...
I0416 20:29:35.753826 139671141824320 controller.py:425] train | step:  130000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6847575,
           'avg_obj': 0.28614047,
           'box_loss': 0.24468313,
           'class_loss': 2.3801584,
           'conf_loss': 7.5706224,
           'precision50': 0.26345184,
           'recall50': 0.16766672},
     '4': {'avg_iou': 0.76197654,
           'avg_obj': 0.42073423,
           'box_loss': 0.1925278,
           'class_loss': 2.0505214,
           'conf_loss': 6.5856047,
           'precision50': 0.35595542,
           'recall50': 0.3386758},
     '5': {'avg_iou': 0.7693849,
           'avg_obj': 0.45507148,
           'box_loss': 0.11093641,
           'class_loss': 1.3014847,
           'conf_loss': 3.7249048,
           'precision50': 0.41741654,
           'recall50': 0.429039},
     'global': {'total_loss': 24.16144},
     'learning_rate': 0.0007486183,
     'training_loss': 24.16144}
I0416 20:30:27.803505 139671141824320 controller.py:455] saved checkpoint to gs://tensorflow2/config_mean_scaling/250k-letterbox-cosine/ckpt-130000.
I0416 21:32:11.660662 139671141824320 controller.py:425] train | step:  140000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6868329,
           'avg_obj': 0.2916778,
           'box_loss': 0.24267066,
           'class_loss': 2.3089657,
           'conf_loss': 7.4987993,
           'precision50': 0.26511866,
           'recall50': 0.17209242},
     '4': {'avg_iou': 0.7644291,
           'avg_obj': 0.42798188,
           'box_loss': 0.19027883,
           'class_loss': 1.9791951,
           'conf_loss': 6.4947667,
           'precision50': 0.35771894,
           'recall50': 0.34558418},
     '5': {'avg_iou': 0.77206653,
           'avg_obj': 0.4621772,
           'box_loss': 0.10962658,
           'class_loss': 1.2604909,
           'conf_loss': 3.675455,
           'precision50': 0.41763055,
           'recall50': 0.43556714},
     'global': {'total_loss': 23.760296},
     'learning_rate': 0.00068683235,
     'training_loss': 23.760296}
I0416 21:32:28.339208 139671141824320 controller.py:252]  eval | step:  140000 | running 625 steps of evaluation...
I0416 21:36:36.992950 139671141824320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0416 21:40:41.038489 139671141824320 controller.py:261]  eval | step:  140000 | eval time:  492.7 sec | output: 
    {'3': {'avg_iou': 0.505772,
           'avg_obj': 0.23042688,
           'box_loss': 0.17685561,
           'class_loss': 1.704198,
           'conf_loss': 6.2205453,
           'precision50': 0.26818952,
           'recall50': 0.21606928},
     '4': {'avg_iou': 0.7173827,
           'avg_obj': 0.46736807,
           'box_loss': 0.13887899,
           'class_loss': 1.4620553,
           'conf_loss': 5.152921,
           'precision50': 0.37321278,
           'recall50': 0.46825477},
     '5': {'avg_iou': 0.77651286,
           'avg_obj': 0.6110756,
           'box_loss': 0.075413205,
           'class_loss': 0.83902586,
           'conf_loss': 2.5218105,
           'precision50': 0.4266171,
           'recall50': 0.61927366},
     'AP': 0.37520736,
     'AP50': 0.59130186,
     'AP75': 0.402968,
     'APl': 0.5163063,
     'APm': 0.39939836,
     'APs': 0.16303496,
     'ARl': 0.6813004,
     'ARm': 0.5910019,
     'ARmax1': 0.3074066,
     'ARmax10': 0.5046484,
     'ARmax100': 0.5511364,
     'ARs': 0.3322022,
     'global': {'total_loss': 18.291702},
     'validation_loss': 18.291702}
I0416 21:40:58.567979 139671141824320 controller.py:211] train | step:  140000 | training until step 160000...
I0416 22:36:58.650100 139671141824320 controller.py:425] train | step:  150000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6887989,
           'avg_obj': 0.2970614,
           'box_loss': 0.24056292,
           'class_loss': 2.2441447,
           'conf_loss': 7.42281,
           'precision50': 0.26718214,
           'recall50': 0.17608109},
     '4': {'avg_iou': 0.76670086,
           'avg_obj': 0.4346126,
           'box_loss': 0.18804157,
           'class_loss': 1.9215394,
           'conf_loss': 6.403514,
           'precision50': 0.358319,
           'recall50': 0.35163593},
     '5': {'avg_iou': 0.77419263,
           'avg_obj': 0.46779904,
           'box_loss': 0.10835172,
           'class_loss': 1.224648,
           'conf_loss': 3.628446,
           'precision50': 0.41904175,
           'recall50': 0.44179037},
     'global': {'total_loss': 23.381989},
     'learning_rate': 0.0006146163,
     'training_loss': 23.381989}
I0416 22:37:57.266743 139671141824320 controller.py:455] saved checkpoint to gs://tensorflow2/config_mean_scaling/250k-letterbox-cosine/ckpt-150000.
I0416 23:40:15.894818 139671141824320 controller.py:425] train | step:  160000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.69028723,
           'avg_obj': 0.3018906,
           'box_loss': 0.23973867,
           'class_loss': 2.1845772,
           'conf_loss': 7.3786173,
           'precision50': 0.2692724,
           'recall50': 0.1804883},
     '4': {'avg_iou': 0.7687228,
           'avg_obj': 0.44150493,
           'box_loss': 0.18657449,
           'class_loss': 1.8645077,
           'conf_loss': 6.3319926,
           'precision50': 0.3595179,
           'recall50': 0.35829005},
     '5': {'avg_iou': 0.7766566,
           'avg_obj': 0.47554737,
           'box_loss': 0.107272364,
           'class_loss': 1.1873935,
           'conf_loss': 3.5798345,
           'precision50': 0.4201804,
           'recall50': 0.4497406},
     'global': {'total_loss': 23.060516},
     'learning_rate': 0.0005570411,
     'training_loss': 23.060516}

 eval | step:  120000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=177.15s).
Accumulating evaluation results...
DONE (t=12.77s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.371
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.588
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.400
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.161
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.395
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.510
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.304
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.502
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.548
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.327
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.589
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.676
 eval | step:  120000 | eval time:  488.5 sec | output: 
    {'3': {'avg_iou': 0.5047985,
           'avg_obj': 0.22649266,
           'box_loss': 0.1779539,
           'class_loss': 1.7100924,
           'conf_loss': 6.234041,
           'precision50': 0.26922062,
           'recall50': 0.21038906},
     '4': {'avg_iou': 0.7156458,
           'avg_obj': 0.46126676,
           'box_loss': 0.13994412,
           'class_loss': 1.4654813,
           'conf_loss': 5.1549273,
           'precision50': 0.3739116,
           'recall50': 0.46235928},
     '5': {'avg_iou': 0.7747729,
           'avg_obj': 0.60262924,
           'box_loss': 0.07609026,
           'class_loss': 0.8438872,
           'conf_loss': 2.5355647,
           'precision50': 0.4294383,
           'recall50': 0.61108434},
     'AP': 0.3713504,
     'AP50': 0.5881482,
     'AP75': 0.39960945,
     'APl': 0.50976235,
     'APm': 0.39478973,
     'APs': 0.1607049,
     'ARl': 0.67594576,
     'ARm': 0.589043,
     'ARmax1': 0.30428582,
     'ARmax10': 0.5020308,
     'ARmax100': 0.5482749,
     'ARs': 0.3271797,
     'global': {'total_loss': 18.337978},
     'validation_loss': 18.337978}
train | step:  120000 | training until step 140000...
train | step:  130000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6847575,
           'avg_obj': 0.28614047,
           'box_loss': 0.24468313,
           'class_loss': 2.3801584,
           'conf_loss': 7.5706224,
           'precision50': 0.26345184,
           'recall50': 0.16766672},
     '4': {'avg_iou': 0.76197654,
           'avg_obj': 0.42073423,
           'box_loss': 0.1925278,
           'class_loss': 2.0505214,
           'conf_loss': 6.5856047,
           'precision50': 0.35595542,
           'recall50': 0.3386758},
     '5': {'avg_iou': 0.7693849,
           'avg_obj': 0.45507148,
           'box_loss': 0.11093641,
           'class_loss': 1.3014847,
           'conf_loss': 3.7249048,
           'precision50': 0.41741654,
           'recall50': 0.429039},
     'global': {'total_loss': 24.16144},
     'learning_rate': 0.0007486183,
     'training_loss': 24.16144}
saved checkpoint to gs://tensorflow2/config_mean_scaling/250k-letterbox-cosine/ckpt-130000.
train | step:  140000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6868329,
           'avg_obj': 0.2916778,
           'box_loss': 0.24267066,
           'class_loss': 2.3089657,
           'conf_loss': 7.4987993,
           'precision50': 0.26511866,
           'recall50': 0.17209242},
     '4': {'avg_iou': 0.7644291,
           'avg_obj': 0.42798188,
           'box_loss': 0.19027883,
           'class_loss': 1.9791951,
           'conf_loss': 6.4947667,
           'precision50': 0.35771894,
           'recall50': 0.34558418},
     '5': {'avg_iou': 0.77206653,
           'avg_obj': 0.4621772,
           'box_loss': 0.10962658,
           'class_loss': 1.2604909,
           'conf_loss': 3.675455,
           'precision50': 0.41763055,
           'recall50': 0.43556714},
     'global': {'total_loss': 23.760296},
     'learning_rate': 0.00068683235,
     'training_loss': 23.760296}
 eval | step:  140000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=176.79s).
Accumulating evaluation results...
DONE (t=12.32s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.375
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.591
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.403
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.163
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.399
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.516
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.307
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.505
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.551
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.332
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.591
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.681
 eval | step:  140000 | eval time:  492.7 sec | output: 
    {'3': {'avg_iou': 0.505772,
           'avg_obj': 0.23042688,
           'box_loss': 0.17685561,
           'class_loss': 1.704198,
           'conf_loss': 6.2205453,
           'precision50': 0.26818952,
           'recall50': 0.21606928},
     '4': {'avg_iou': 0.7173827,
           'avg_obj': 0.46736807,
           'box_loss': 0.13887899,
           'class_loss': 1.4620553,
           'conf_loss': 5.152921,
           'precision50': 0.37321278,
           'recall50': 0.46825477},
     '5': {'avg_iou': 0.77651286,
           'avg_obj': 0.6110756,
           'box_loss': 0.075413205,
           'class_loss': 0.83902586,
           'conf_loss': 2.5218105,
           'precision50': 0.4266171,
           'recall50': 0.61927366},
     'AP': 0.37520736,
     'AP50': 0.59130186,
     'AP75': 0.402968,
     'APl': 0.5163063,
     'APm': 0.39939836,
     'APs': 0.16303496,
     'ARl': 0.6813004,
     'ARm': 0.5910019,
     'ARmax1': 0.3074066,
     'ARmax10': 0.5046484,
     'ARmax100': 0.5511364,
     'ARs': 0.3322022,
     'global': {'total_loss': 18.291702},
     'validation_loss': 18.291702}
train | step:  140000 | training until step 160000...
train | step:  150000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6887989,
           'avg_obj': 0.2970614,
           'box_loss': 0.24056292,
           'class_loss': 2.2441447,
           'conf_loss': 7.42281,
           'precision50': 0.26718214,
           'recall50': 0.17608109},
     '4': {'avg_iou': 0.76670086,
           'avg_obj': 0.4346126,
           'box_loss': 0.18804157,
           'class_loss': 1.9215394,
           'conf_loss': 6.403514,
           'precision50': 0.358319,
           'recall50': 0.35163593},
     '5': {'avg_iou': 0.77419263,
           'avg_obj': 0.46779904,
           'box_loss': 0.10835172,
           'class_loss': 1.224648,
           'conf_loss': 3.628446,
           'precision50': 0.41904175,
           'recall50': 0.44179037},
     'global': {'total_loss': 23.381989},
     'learning_rate': 0.0006146163,
     'training_loss': 23.381989}
saved checkpoint to gs://tensorflow2/config_mean_scaling/250k-letterbox-cosine/ckpt-150000.
train | step:  160000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.69028723,
           'avg_obj': 0.3018906,
           'box_loss': 0.23973867,
           'class_loss': 2.1845772,
           'conf_loss': 7.3786173,
           'precision50': 0.2692724,
           'recall50': 0.1804883},
     '4': {'avg_iou': 0.7687228,
           'avg_obj': 0.44150493,
           'box_loss': 0.18657449,
           'class_loss': 1.8645077,
           'conf_loss': 6.3319926,
           'precision50': 0.3595179,
           'recall50': 0.35829005},
     '5': {'avg_iou': 0.7766566,
           'avg_obj': 0.47554737,
           'box_loss': 0.107272364,
           'class_loss': 1.1873935,
           'conf_loss': 3.5798345,
           'precision50': 0.4201804,
           'recall50': 0.4497406},
     'global': {'total_loss': 23.060516},
     'learning_rate': 0.0005570411,
     'training_loss': 23.060516}I0416 23:40:28.927271 139671141824320 controller.py:252]  eval | step:  160000 | running 625 steps of evaluation...
I0416 23:44:39.785376 139671141824320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0416 23:48:43.241941 139671141824320 controller.py:261]  eval | step:  160000 | eval time:  494.3 sec | output: 
    {'3': {'avg_iou': 0.5069101,
           'avg_obj': 0.23374136,
           'box_loss': 0.17589273,
           'class_loss': 1.709066,
           'conf_loss': 6.212414,
           'precision50': 0.27127388,
           'recall50': 0.22093935},
     '4': {'avg_iou': 0.71869415,
           'avg_obj': 0.47435454,
           'box_loss': 0.1380943,
           'class_loss': 1.4591379,
           'conf_loss': 5.1451,
           'precision50': 0.37041876,
           'recall50': 0.47652295},
     '5': {'avg_iou': 0.7778543,
           'avg_obj': 0.6182571,
           'box_loss': 0.0748397,
           'class_loss': 0.8299657,
           'conf_loss': 2.5226588,
           'precision50': 0.42163223,
           'recall50': 0.6256048},
     'AP': 0.37925267,
     'AP50': 0.594884,
     'AP75': 0.41319114,
     'APl': 0.52296644,
     'APm': 0.40259668,
     'APs': 0.16549708,
     'ARl': 0.68486446,
     'ARm': 0.5951715,
     'ARmax1': 0.30995297,
     'ARmax10': 0.50932366,
     'ARmax100': 0.55469114,
     'ARs': 0.33840936,
     'global': {'total_loss': 18.267172},
     'validation_loss': 18.267172}
I0416 23:49:06.477068 139671141824320 controller.py:211] train | step:  160000 | training until step 180000...
I0417 00:48:54.962991 139671141824320 controller.py:425] train | step:  170000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6920728,
           'avg_obj': 0.30678657,
           'box_loss': 0.23819497,
           'class_loss': 2.137194,
           'conf_loss': 7.3240623,
           'precision50': 0.27080706,
           'recall50': 0.18422991},
     '4': {'avg_iou': 0.7708055,
           'avg_obj': 0.4480767,
           'box_loss': 0.18502589,
           'class_loss': 1.816992,
           'conf_loss': 6.2599893,
           'precision50': 0.36043698,
           'recall50': 0.3641061},
     '5': {'avg_iou': 0.778495,
           'avg_obj': 0.48122597,
           'box_loss': 0.10652637,
           'class_loss': 1.1566969,
           'conf_loss': 3.545412,
           'precision50': 0.42096093,
           'recall50': 0.45541358},
     'global': {'total_loss': 22.770107},
     'learning_rate': 0.00050270424,
     'training_loss': 22.770107}
I0417 00:49:46.126934 139671141824320 controller.py:455] saved checkpoint to gs://tensorflow2/config_mean_scaling/250k-letterbox-cosine/ckpt-170000.
I0417 01:54:01.128751 139671141824320 controller.py:425] train | step:  180000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6935056,
           'avg_obj': 0.3119001,
           'box_loss': 0.23800717,
           'class_loss': 2.0948715,
           'conf_loss': 7.298406,
           'precision50': 0.27225408,
           'recall50': 0.18750814},
     '4': {'avg_iou': 0.77232957,
           'avg_obj': 0.45363608,
           'box_loss': 0.18416029,
           'class_loss': 1.7728039,
           'conf_loss': 6.210709,
           'precision50': 0.36113587,
           'recall50': 0.36952105},
     '5': {'avg_iou': 0.78043586,
           'avg_obj': 0.48682177,
           'box_loss': 0.105560265,
           'class_loss': 1.1289254,
           'conf_loss': 3.505679,
           'precision50': 0.42141852,
           'recall50': 0.461083},
     'global': {'total_loss': 22.53911},
     'learning_rate': 0.0004428529,
     'training_loss': 22.53911}
I0417 01:54:15.530053 139671141824320 controller.py:252]  eval | step:  180000 | running 625 steps of evaluation...
I0417 01:58:24.305343 139671141824320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0417 02:02:30.543670 139671141824320 controller.py:261]  eval | step:  180000 | eval time:  495.0 sec | output: 
    {'3': {'avg_iou': 0.5074015,
           'avg_obj': 0.23600604,
           'box_loss': 0.17532691,
           'class_loss': 1.7131748,
           'conf_loss': 6.2076144,
           'precision50': 0.2657416,
           'recall50': 0.22318481},
     '4': {'avg_iou': 0.7193196,
           'avg_obj': 0.47756302,
           'box_loss': 0.13765875,
           'class_loss': 1.4714158,
           'conf_loss': 5.153896,
           'precision50': 0.36462852,
           'recall50': 0.4796698},
     '5': {'avg_iou': 0.7779845,
           'avg_obj': 0.6219546,
           'box_loss': 0.07461212,
           'class_loss': 0.8313672,
           'conf_loss': 2.5221798,
           'precision50': 0.41806284,
           'recall50': 0.6298507},
     'AP': 0.3791239,
     'AP50': 0.5930174,
     'AP75': 0.41354358,
     'APl': 0.526594,
     'APm': 0.40006757,
     'APs': 0.16778526,
     'ARl': 0.6871254,
     'ARm': 0.59032035,
     'ARmax1': 0.3103893,
     'ARmax10': 0.50950587,
     'ARmax100': 0.5542181,
     'ARs': 0.34123972,
     'global': {'total_loss': 18.287247},
     'validation_loss': 18.287247}
I0417 02:02:48.387759 139671141824320 controller.py:211] train | step:  180000 | training until step 200000...
I0417 02:57:17.625613 139671141824320 controller.py:425] train | step:  190000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.69501096,
           'avg_obj': 0.31606942,
           'box_loss': 0.23648286,
           'class_loss': 2.046886,
           'conf_loss': 7.240341,
           'precision50': 0.27343073,
           'recall50': 0.19064711},
     '4': {'avg_iou': 0.77382296,
           'avg_obj': 0.4593287,
           'box_loss': 0.1827146,
           'class_loss': 1.7290652,
           'conf_loss': 6.1352553,
           'precision50': 0.36147937,
           'recall50': 0.37442663},
     '5': {'avg_iou': 0.78190446,
           'avg_obj': 0.49155766,
           'box_loss': 0.104679845,
           'class_loss': 1.1016217,
           'conf_loss': 3.466825,
           'precision50': 0.4223335,
           'recall50': 0.46605152},
     'global': {'total_loss': 22.243895},
     'learning_rate': 0.00039826552,
     'training_loss': 22.243895}
I0417 02:58:09.330528 139671141824320 controller.py:455] saved checkpoint to gs://tensorflow2/config_mean_scaling/250k-letterbox-cosine/ckpt-190000.
I0417 04:01:23.232791 139671141824320 controller.py:425] train | step:  200000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.69601303,
           'avg_obj': 0.31981063,
           'box_loss': 0.23547299,
           'class_loss': 2.0131657,
           'conf_loss': 7.1919813,
           'precision50': 0.27539602,
           'recall50': 0.19458556},
     '4': {'avg_iou': 0.7753589,
           'avg_obj': 0.46441993,
           'box_loss': 0.18133198,
           'class_loss': 1.6907291,
           'conf_loss': 6.0717034,
           'precision50': 0.36252877,
           'recall50': 0.3795312},
     '5': {'avg_iou': 0.7834252,
           'avg_obj': 0.49639127,
           'box_loss': 0.1040131,
           'class_loss': 1.0790111,
           'conf_loss': 3.436709,
           'precision50': 0.42192924,
           'recall50': 0.47029945},
     'global': {'total_loss': 22.004139},
     'learning_rate': 0.00035916216,
     'training_loss': 22.004139}

 eval | step:  160000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=178.80s).
Accumulating evaluation results...
DONE (t=12.15s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.379
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.595
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.413
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.165
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.403
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.523
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.310
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.509
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.555
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.338
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.595
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.685
 eval | step:  160000 | eval time:  494.3 sec | output: 
    {'3': {'avg_iou': 0.5069101,
           'avg_obj': 0.23374136,
           'box_loss': 0.17589273,
           'class_loss': 1.709066,
           'conf_loss': 6.212414,
           'precision50': 0.27127388,
           'recall50': 0.22093935},
     '4': {'avg_iou': 0.71869415,
           'avg_obj': 0.47435454,
           'box_loss': 0.1380943,
           'class_loss': 1.4591379,
           'conf_loss': 5.1451,
           'precision50': 0.37041876,
           'recall50': 0.47652295},
     '5': {'avg_iou': 0.7778543,
           'avg_obj': 0.6182571,
           'box_loss': 0.0748397,
           'class_loss': 0.8299657,
           'conf_loss': 2.5226588,
           'precision50': 0.42163223,
           'recall50': 0.6256048},
     'AP': 0.37925267,
     'AP50': 0.594884,
     'AP75': 0.41319114,
     'APl': 0.52296644,
     'APm': 0.40259668,
     'APs': 0.16549708,
     'ARl': 0.68486446,
     'ARm': 0.5951715,
     'ARmax1': 0.30995297,
     'ARmax10': 0.50932366,
     'ARmax100': 0.55469114,
     'ARs': 0.33840936,
     'global': {'total_loss': 18.267172},
     'validation_loss': 18.267172}
train | step:  160000 | training until step 180000...
train | step:  170000 | steps/sec:    2.4 | output: 
    {'3': {'avg_iou': 0.6920728,
           'avg_obj': 0.30678657,
           'box_loss': 0.23819497,
           'class_loss': 2.137194,
           'conf_loss': 7.3240623,
           'precision50': 0.27080706,
           'recall50': 0.18422991},
     '4': {'avg_iou': 0.7708055,
           'avg_obj': 0.4480767,
           'box_loss': 0.18502589,
           'class_loss': 1.816992,
           'conf_loss': 6.2599893,
           'precision50': 0.36043698,
           'recall50': 0.3641061},
     '5': {'avg_iou': 0.778495,
           'avg_obj': 0.48122597,
           'box_loss': 0.10652637,
           'class_loss': 1.1566969,
           'conf_loss': 3.545412,
           'precision50': 0.42096093,
           'recall50': 0.45541358},
     'global': {'total_loss': 22.770107},
     'learning_rate': 0.00050270424,
     'training_loss': 22.770107}
saved checkpoint to gs://tensorflow2/config_mean_scaling/250k-letterbox-cosine/ckpt-170000.
train | step:  180000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6935056,
           'avg_obj': 0.3119001,
           'box_loss': 0.23800717,
           'class_loss': 2.0948715,
           'conf_loss': 7.298406,
           'precision50': 0.27225408,
           'recall50': 0.18750814},
     '4': {'avg_iou': 0.77232957,
           'avg_obj': 0.45363608,
           'box_loss': 0.18416029,
           'class_loss': 1.7728039,
           'conf_loss': 6.210709,
           'precision50': 0.36113587,
           'recall50': 0.36952105},
     '5': {'avg_iou': 0.78043586,
           'avg_obj': 0.48682177,
           'box_loss': 0.105560265,
           'class_loss': 1.1289254,
           'conf_loss': 3.505679,
           'precision50': 0.42141852,
           'recall50': 0.461083},
     'global': {'total_loss': 22.53911},
     'learning_rate': 0.0004428529,
     'training_loss': 22.53911}
 eval | step:  180000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=180.42s).
Accumulating evaluation results...
DONE (t=11.47s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.379
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.593
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.414
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.168
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.400
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.527
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.310
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.510
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.554
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.341
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.590
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.687
 eval | step:  180000 | eval time:  495.0 sec | output: 
    {'3': {'avg_iou': 0.5074015,
           'avg_obj': 0.23600604,
           'box_loss': 0.17532691,
           'class_loss': 1.7131748,
           'conf_loss': 6.2076144,
           'precision50': 0.2657416,
           'recall50': 0.22318481},
     '4': {'avg_iou': 0.7193196,
           'avg_obj': 0.47756302,
           'box_loss': 0.13765875,
           'class_loss': 1.4714158,
           'conf_loss': 5.153896,
           'precision50': 0.36462852,
           'recall50': 0.4796698},
     '5': {'avg_iou': 0.7779845,
           'avg_obj': 0.6219546,
           'box_loss': 0.07461212,
           'class_loss': 0.8313672,
           'conf_loss': 2.5221798,
           'precision50': 0.41806284,
           'recall50': 0.6298507},
     'AP': 0.3791239,
     'AP50': 0.5930174,
     'AP75': 0.41354358,
     'APl': 0.526594,
     'APm': 0.40006757,
     'APs': 0.16778526,
     'ARl': 0.6871254,
     'ARm': 0.59032035,
     'ARmax1': 0.3103893,
     'ARmax10': 0.50950587,
     'ARmax100': 0.5542181,
     'ARs': 0.34123972,
     'global': {'total_loss': 18.287247},
     'validation_loss': 18.287247}
train | step:  180000 | training until step 200000...
train | step:  190000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.69501096,
           'avg_obj': 0.31606942,
           'box_loss': 0.23648286,
           'class_loss': 2.046886,
           'conf_loss': 7.240341,
           'precision50': 0.27343073,
           'recall50': 0.19064711},
     '4': {'avg_iou': 0.77382296,
           'avg_obj': 0.4593287,
           'box_loss': 0.1827146,
           'class_loss': 1.7290652,
           'conf_loss': 6.1352553,
           'precision50': 0.36147937,
           'recall50': 0.37442663},
     '5': {'avg_iou': 0.78190446,
           'avg_obj': 0.49155766,
           'box_loss': 0.104679845,
           'class_loss': 1.1016217,
           'conf_loss': 3.466825,
           'precision50': 0.4223335,
           'recall50': 0.46605152},
     'global': {'total_loss': 22.243895},
     'learning_rate': 0.00039826552,
     'training_loss': 22.243895}
saved checkpoint to gs://tensorflow2/config_mean_scaling/250k-letterbox-cosine/ckpt-190000.
train | step:  200000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.69601303,
           'avg_obj': 0.31981063,
           'box_loss': 0.23547299,
           'class_loss': 2.0131657,
           'conf_loss': 7.1919813,
           'precision50': 0.27539602,
           'recall50': 0.19458556},
     '4': {'avg_iou': 0.7753589,
           'avg_obj': 0.46441993,
           'box_loss': 0.18133198,
           'class_loss': 1.6907291,
           'conf_loss': 6.0717034,
           'precision50': 0.36252877,
           'recall50': 0.3795312},
     '5': {'avg_iou': 0.7834252,
           'avg_obj': 0.49639127,
           'box_loss': 0.1040131,
           'class_loss': 1.0790111,
           'conf_loss': 3.436709,
           'precision50': 0.42192924,
           'recall50': 0.47029945},
     'global': {'total_loss': 22.004139},
     'learning_rate': 0.00035916216,
     'training_loss': 22.004139}I0417 04:01:37.110511 139671141824320 controller.py:252]  eval | step:  200000 | running 625 steps of evaluation...
I0417 04:05:43.891891 139671141824320 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0417 04:09:53.542064 139671141824320 controller.py:261]  eval | step:  200000 | eval time:  496.4 sec | output: 
    {'3': {'avg_iou': 0.50817776,
           'avg_obj': 0.23841575,
           'box_loss': 0.17495869,
           'class_loss': 1.7244647,
           'conf_loss': 6.2205667,
           'precision50': 0.26641595,
           'recall50': 0.22652723},
     '4': {'avg_iou': 0.71980333,
           'avg_obj': 0.48102725,
           'box_loss': 0.13725345,
           'class_loss': 1.4856517,
           'conf_loss': 5.175725,
           'precision50': 0.35908407,
           'recall50': 0.48275855},
     '5': {'avg_iou': 0.7783013,
           'avg_obj': 0.62740666,
           'box_loss': 0.07455117,
           'class_loss': 0.8332208,
           'conf_loss': 2.5346372,
           'precision50': 0.4124583,
           'recall50': 0.63325506},
     'AP': 0.3809079,
     'AP50': 0.59425074,
     'AP75': 0.41483787,
     'APl': 0.5275719,
     'APm': 0.4039942,
     'APs': 0.16866128,
     'ARl': 0.68305576,
     'ARm': 0.5914678,
     'ARmax1': 0.31117958,
     'ARmax10': 0.5084386,
     'ARmax100': 0.55253047,
     'ARs': 0.33190423,
     'global': {'total_loss': 18.361036},
     'validation_loss': 18.361036}
I0417 04:10:13.950839 139671141824320 controller.py:211] train | step:  200000 | training until step 220000...
I0417 05:07:11.930027 139671141824320 controller.py:425] train | step:  210000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.69713664,
           'avg_obj': 0.32329878,
           'box_loss': 0.23458901,
           'class_loss': 1.978933,
           'conf_loss': 7.148041,
           'precision50': 0.2753225,
           'recall50': 0.19683589},
     '4': {'avg_iou': 0.7766903,
           'avg_obj': 0.46964112,
           'box_loss': 0.18013336,
           'class_loss': 1.6568757,
           'conf_loss': 6.009036,
           'precision50': 0.36204317,
           'recall50': 0.3839528},
     '5': {'avg_iou': 0.7849687,
           'avg_obj': 0.5010121,
           'box_loss': 0.103227675,
           'class_loss': 1.0528783,
           'conf_loss': 3.4035234,
           'precision50': 0.42207614,
           'recall50': 0.47436407},
     'global': {'total_loss': 21.76722},
     'learning_rate': 0.0003202502,
     'training_loss': 21.76722}
I0417 05:08:02.592698 139671141824320 controller.py:455] saved checkpoint to gs://tensorflow2/config_mean_scaling/250k-letterbox-cosine/ckpt-210000.
/home/cam2tensorflow/.experiment_start.sh: line 22: 26577 Killed                  TPU_NAME=$1 python3 -m $2.train_vm --mode=train_and_eval --experiment=$3 --config_file=$2/configs/experiments/$4.yaml --model_dir=gs://tensorflow2/$4
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   227    0     2  100   225     11   1331 --:--:-- --:--:-- --:--:--  1343
okRequest issued for: [node-3]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-17T05:47:32.378797246Z'
  endTime: '2021-04-17T05:48:09.936372826Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618638452363-5c024a1f90ff0-e4c1f163-29675e5f
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.91.127.64/29
  createTime: '2021-03-13T03:33:12.910754151Z'
  health: HEALTHY
  ipAddress: 10.91.127.66
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-3
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.91.127.66
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618638452363-5c024a1f90ff0-e4c1f163-29675e5f] to complete...
..................................................................................................................................................................................................done.
