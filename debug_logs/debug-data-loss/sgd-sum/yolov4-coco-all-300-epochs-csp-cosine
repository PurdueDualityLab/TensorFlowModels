cat: .experiment_zone: No such file or directory
Request issued for: [node-5]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-03-31T05:20:33.461943768Z'
  endTime: '2021-03-31T05:21:12.309980933Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617168033447-5bece462cfd3d-fec2e28c-e010ccdc
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617168033447-5bece462cfd3d-fec2e28c-e010ccdc] to complete...
............................................................................................................................................................................................................................................................................done.
europe-west4-a
I0331 05:21:32.839967 140100596844352 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.2,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': True,
                                                     '4': True,
                                                     '5': True},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'aug_rand_angle': 5.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_transalate': 0.0,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_boxes': 0.1,
                                    'jitter_im': 0.3,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'max_process_size': 608,
                                    'min_process_size': 320,
                                    'mosaic': {'crop_area': [0.3, 0.35],
                                               'mosaic_frequency': 0.955,
                                               'output_size': [640, 640],
                                               'random_crop': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'aug_rand_angle': 15.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_transalate': 0.0,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_boxes': 0.3,
                                         'jitter_im': 0.3,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'max_process_size': 608,
                                         'min_process_size': 320,
                                         'mosaic': {'crop_area': [0.3, 0.35],
                                                    'mosaic_frequency': 0.9,
                                                    'output_size': [640, 640],
                                                    'random_crop': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 50000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.01,
                                                               'decay_steps': None,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 50000,
             'summary_interval': 50000,
             'train_steps': 562500,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 50000,
             'validation_steps': 625}}
I0331 05:21:32.840899 140100596844352 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/params.yaml
I0331 05:21:34.398644 140100596844352 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0331 05:21:34.558801 140100596844352 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0331 05:21:34.559187 140100596844352 transport.py:157] Attempting refresh to obtain initial access_token
I0331 05:21:34.621044 140100596844352 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0331 05:21:34.768286 140100596844352 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0331 05:21:34.768750 140100596844352 transport.py:157] Attempting refresh to obtain initial access_token
2021-03-31 05:21:34.829284: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0331 05:21:34.830087 140100596844352 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0331 05:21:35.444845 140100596844352 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0331 05:21:35.445158 140100596844352 transport.py:157] Attempting refresh to obtain initial access_token
I0331 05:21:35.493246 140100596844352 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0331 05:21:36.115621 140100596844352 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0331 05:21:36.115866 140100596844352 transport.py:157] Attempting refresh to obtain initial access_token
2021-03-31 05:21:36.158721: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-03-31 05:21:36.191064: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.56.217.90:8470}
2021-03-31 05:21:36.191140: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:32498}
2021-03-31 05:21:50.922354: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.56.217.90:8470}
2021-03-31 05:21:50.922436: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:32498}
2021-03-31 05:21:50.923518: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:32498
I0331 05:21:50.924494 140100596844352 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-5
I0331 05:21:50.925714 140100596844352 tpu_strategy_util.py:74] Initializing the TPU system: node-5
INFO:tensorflow:Clearing out eager caches
I0331 05:21:59.185986 140100596844352 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0331 05:21:59.188513 140100596844352 tpu_strategy_util.py:133] Finished initializing TPU system.
I0331 05:21:59.190249 140100596844352 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0331 05:21:59.813454 140100596844352 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0331 05:21:59.813708 140100596844352 transport.py:157] Attempting refresh to obtain initial access_token
I0331 05:21:59.878280 140100596844352 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0331 05:22:00.495517 140100596844352 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0331 05:22:00.495782 140100596844352 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0331 05:22:00.542718 140100596844352 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0331 05:22:00.542980 140100596844352 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0331 05:22:00.543272 140100596844352 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0331 05:22:00.543331 140100596844352 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0331 05:22:00.543383 140100596844352 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0331 05:22:00.543824 140100596844352 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0331 05:22:00.543903 140100596844352 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0331 05:22:00.543965 140100596844352 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0331 05:22:00.544175 140100596844352 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0331 05:22:00.544230 140100596844352 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0331 05:22:00.544281 140100596844352 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0331 05:22:00.544329 140100596844352 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0331 05:22:00.544377 140100596844352 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0331 05:22:00.544436 140100596844352 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0331 05:22:00.544561 140100596844352 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0331 05:22:00.544618 140100596844352 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0331 05:22:00.571583 140100596844352 train_utils.py:214] Running default trainer.
2021-03-31 05:22:00.588582: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': True, '4': True, '5': True}, 'use_nms': True, 'iou_thresh': 0.2, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 320, 'max_process_size': 608, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'jitter_boxes': 0.1, 'aug_rand_transalate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_zoom': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_angle': 5.0, 'use_tie_breaker': True, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.955, 'crop_area': [0.3, 0.35], 'random_crop': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 320, 'max_process_size': 608, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'jitter_boxes': 0.3, 'aug_rand_transalate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_zoom': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_angle': 15.0, 'use_tie_breaker': True, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.9, 'crop_area': [0.3, 0.35], 'random_crop': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': None, 'alpha': 0.01}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 50000, 'summary_interval': 50000, 'checkpoint_interval': 50000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 562500, 'validation_steps': 625, 'validation_interval': 50000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': True, '4': True, '5': True}, 'use_nms': True, 'iou_thresh': 0.2, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f6b51ffac50>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
route_split 512.0 512.0
conv2 512.0
conv1 512.0
spp
conv1 512.0
conv2 512.0
connect
conv1 512.0
8
(None, 16, 16, 512) (None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 2048)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 1024)
(None, 16, 16, 512)
route_split 256.0 256.0
conv2 256.0
conv1 256.0
conv2 256.0
connect
conv1 256.0
6
(None, 32, 32, 256) (None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 32, 32, 256)








 ListWrapper([128, 256, 512])
route_split 128 128
conv2 128
conv1 128
conv2 128
connect
conv1 128
conv2 256
7
(None, 64, 64, 128) (None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 256)
(None, 64, 64, 128)
(None, 64, 64, 256)
route_split 256 256
conv2 256
conv1 256
conv2 256
connect
conv1 256
conv2 512
7
(None, 32, 32, 256) (None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 32, 32, 256)
(None, 32, 32, 512)
route_split 512 512
conv2 512
conv1 512
conv2 512
connect
conv1 512
conv2 1024
7
(None, 16, 16, 512) (None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 1024)
(None, 16, 16, 512)
(None, 16, 16, 1024)
detget {'3': 2.0, '4': 2.0, '5': 2.0}
(None, 16, 16, 512) (None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 2048)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 1024)
(None, 16, 16, 512)
(None, 32, 32, 256) (None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 32, 32, 256)
(None, 64, 64, 128) (None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 256)
(None, 64, 64, 128)
(None, 64, 64, 256)
(None, 32, 32, 256) (None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 149, in main
    model_dir=model_dir)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_lib.py", line 68, in run_experiment
    params, model_dir))
  File "/usr/local/lib/python3.7/dist-packages/gin/config.py", line 1069, in gin_wrapper
    utils.augment_exception_message_and_reraise(e, err_str)
  File "/usr/local/lib/python3.7/dist-packages/gin/utils.py", line 41, in augment_exception_message_and_reraise
    raise proxy.with_traceback(exception.__traceback__) from None
  File "/usr/local/lib/python3.7/dist-packages/gin/config.py", line 1046, in gin_wrapper
    return fn(*new_args, **new_kwargs)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_utils.py", line 215, in create_trainer
    model = task.build_model()
  File "/home/cam2tensorflow/TensorFlowModels/yolo/tasks/yolo.py", line 69, in build_model
    masks, xy_scales, path_scales)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/modeling/Yolo.py", line 249, in build_yolo
    model.build(input_specs.shape)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/training.py", line 421, in build
    raise ValueError('You cannot build your model by calling `build` '
ValueError: You cannot build your model by calling `build` if your layers do not support float type inputs. Instead, in order to instantiate and build your model, `call` your model on real tensor data (of the correct dtype).
  In call to configurable 'create_trainer' (<function create_trainer at 0x7f6b64368048>)

(None, 32, 32, 512)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 16, 16, 512) (None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 1024)
(None, 16, 16, 512)
(None, 16, 16, 1024)
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   247    0     2  100   245     11   1408 --:--:-- --:--:-- --:--:--  1427
okRequest issued for: [node-5]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-03-31T05:22:24.188483584Z'
  endTime: '2021-03-31T05:22:59.703283416Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617168144176-5bece4cc693a3-613324d2-e25edb99
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617168144176-5bece4cc693a3-613324d2-e25edb99] to complete...
................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-5]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-03-31T05:25:29.957786733Z'
  endTime: '2021-03-31T05:26:06.023871992Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617168329946-5bece57d93634-6fac93db-1249191f
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617168329946-5bece57d93634-6fac93db-1249191f] to complete...
............................................................................................................................................................................................done.
europe-west4-a
I0331 05:26:10.741314 139789294565184 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.2,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': True,
                                                     '4': True,
                                                     '5': True},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'aug_rand_angle': 5.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_transalate': 0.0,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_boxes': 0.1,
                                    'jitter_im': 0.3,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'max_process_size': 608,
                                    'min_process_size': 320,
                                    'mosaic': {'crop_area': [0.3, 0.35],
                                               'mosaic_frequency': 0.955,
                                               'output_size': [640, 640],
                                               'random_crop': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'aug_rand_angle': 15.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_transalate': 0.0,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_boxes': 0.3,
                                         'jitter_im': 0.3,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'max_process_size': 608,
                                         'min_process_size': 320,
                                         'mosaic': {'crop_area': [0.3, 0.35],
                                                    'mosaic_frequency': 0.9,
                                                    'output_size': [640, 640],
                                                    'random_crop': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 50000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.01,
                                                               'decay_steps': None,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 50000,
             'summary_interval': 50000,
             'train_steps': 562500,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 50000,
             'validation_steps': 625}}
I0331 05:26:10.742583 139789294565184 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/params.yaml
I0331 05:26:11.584601 139789294565184 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0331 05:26:12.203750 139789294565184 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0331 05:26:12.204024 139789294565184 transport.py:157] Attempting refresh to obtain initial access_token
I0331 05:26:12.274798 139789294565184 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0331 05:26:12.894657 139789294565184 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0331 05:26:12.895136 139789294565184 transport.py:157] Attempting refresh to obtain initial access_token
2021-03-31 05:26:12.951844: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0331 05:26:12.952487 139789294565184 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0331 05:26:13.092322 139789294565184 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0331 05:26:13.092587 139789294565184 transport.py:157] Attempting refresh to obtain initial access_token
I0331 05:26:13.134273 139789294565184 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0331 05:26:13.755809 139789294565184 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0331 05:26:13.756108 139789294565184 transport.py:157] Attempting refresh to obtain initial access_token
2021-03-31 05:26:13.806790: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-03-31 05:26:13.827233: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.56.217.90:8470}
2021-03-31 05:26:13.827338: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:32764}
2021-03-31 05:26:48.042830: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.56.217.90:8470}
2021-03-31 05:26:48.042963: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:32764}
2021-03-31 05:26:48.043814: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:32764
I0331 05:26:48.044817 139789294565184 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-5
I0331 05:26:48.046867 139789294565184 tpu_strategy_util.py:74] Initializing the TPU system: node-5
INFO:tensorflow:Clearing out eager caches
I0331 05:26:55.929651 139789294565184 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0331 05:26:55.932047 139789294565184 tpu_strategy_util.py:133] Finished initializing TPU system.
I0331 05:26:55.933900 139789294565184 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0331 05:26:56.552052 139789294565184 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0331 05:26:56.552406 139789294565184 transport.py:157] Attempting refresh to obtain initial access_token
I0331 05:26:56.606624 139789294565184 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0331 05:26:57.223701 139789294565184 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0331 05:26:57.223997 139789294565184 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0331 05:26:57.287681 139789294565184 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0331 05:26:57.287933 139789294565184 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0331 05:26:57.288253 139789294565184 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0331 05:26:57.288307 139789294565184 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0331 05:26:57.288355 139789294565184 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0331 05:26:57.288477 139789294565184 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0331 05:26:57.288535 139789294565184 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0331 05:26:57.288588 139789294565184 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0331 05:26:57.288634 139789294565184 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0331 05:26:57.288681 139789294565184 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0331 05:26:57.288749 139789294565184 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0331 05:26:57.288799 139789294565184 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0331 05:26:57.288843 139789294565184 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0331 05:26:57.288887 139789294565184 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0331 05:26:57.288932 139789294565184 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0331 05:26:57.288978 139789294565184 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0331 05:26:57.311688 139789294565184 train_utils.py:214] Running default trainer.
2021-03-31 05:26:57.327047: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': True, '4': True, '5': True}, 'use_nms': True, 'iou_thresh': 0.2, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 320, 'max_process_size': 608, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'jitter_boxes': 0.1, 'aug_rand_transalate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_zoom': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_angle': 5.0, 'use_tie_breaker': True, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.955, 'crop_area': [0.3, 0.35], 'random_crop': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 320, 'max_process_size': 608, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'jitter_boxes': 0.3, 'aug_rand_transalate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_zoom': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_angle': 15.0, 'use_tie_breaker': True, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.9, 'crop_area': [0.3, 0.35], 'random_crop': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': None, 'alpha': 0.01}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 50000, 'summary_interval': 50000, 'checkpoint_interval': 50000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 562500, 'validation_steps': 625, 'validation_interval': 50000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': True, '4': True, '5': True}, 'use_nms': True, 'iou_thresh': 0.2, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f22d46bb240>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
route_split 512.0 512.0
conv2 512.0
conv1 512.0
spp
conv1 512.0
conv2 512.0
connect
conv1 512.0
8
(None, 16, 16, 512) (None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 2048)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 1024)
(None, 16, 16, 512)
route_split 256.0 256.0
conv2 256.0
conv1 256.0
conv2 256.0
connect
conv1 256.0
6
(None, 32, 32, 256) (None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 32, 32, 256)








 ListWrapper([128, 256, 512])
route_split 128 128
conv2 128
conv1 128
conv2 128
connect
conv1 128
conv2 256
7
(None, 64, 64, 128) (None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 256)
(None, 64, 64, 128)
(None, 64, 64, 256)
route_split 256 256
conv2 256
conv1 256
conv2 256
connect
conv1 256
conv2 512
7
(None, 32, 32, 256) (None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 32, 32, 256)
(None, 32, 32, 512)
route_split 512 512
conv2 512
conv1 512
conv2 512
connect
conv1 512
conv2 1024
7
(None, 16, 16, 512) (None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 1024)
(None, 16, 16, 512)
(None, 16, 16, 1024)
detget {'3': 2.0, '4': 2.0, '5': 2.0}
(None, 16, 16, 512) (None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 2048)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 1024)
(None, 16, 16, 512)
(None, 32, 32, 256) (None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 32, 32, 256)
(None, 64, 64, 128) (None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 256)
(None, 64, 64, 128)
(None, 64, 64, 256)
(None, 32, 32, 256) (None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 149, in main
    model_dir=model_dir)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_lib.py", line 68, in run_experiment
    params, model_dir))
  File "/usr/local/lib/python3.7/dist-packages/gin/config.py", line 1069, in gin_wrapper
    utils.augment_exception_message_and_reraise(e, err_str)
  File "/usr/local/lib/python3.7/dist-packages/gin/utils.py", line 41, in augment_exception_message_and_reraise
    raise proxy.with_traceback(exception.__traceback__) from None
  File "/usr/local/lib/python3.7/dist-packages/gin/config.py", line 1046, in gin_wrapper
    return fn(*new_args, **new_kwargs)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_utils.py", line 217, in create_trainer
    params.runtime)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/base_task.py", line 76, in create_optimizer
    optimizer = opt_factory.build_optimizer(opt_factory.build_learning_rate())
  File "/home/cam2tensorflow/TensorFlowModels/official/modeling/optimization/optimizer_factory.py", line 127, in build_learning_rate
    lr = WARMUP_CLS[self._warmup_type](lr, **self._warmup_config.as_dict())
  File "/home/cam2tensorflow/TensorFlowModels/official/modeling/optimization/lr_schedule.py", line 108, in __init__
    self._initial_learning_rate = after_warmup_lr_sched(warmup_steps)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/optimizer_v2/learning_rate_schedule.py", line 594, in __call__
    decay_steps = math_ops.cast(self.decay_steps, dtype)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/util/dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/math_ops.py", line 964, in cast
    x = ops.convert_to_tensor(x, name="x")
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/profiler/trace.py", line 163, in wrapped
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 1540, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/constant_op.py", line 339, in _constant_tensor_conversion_function
    return constant(v, dtype=dtype, name=name)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/constant_op.py", line 265, in constant
    allow_broadcast=True)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/constant_op.py", line 276, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/constant_op.py", line 301, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/constant_op.py", line 98, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
ValueError: Attempt to convert a value (None) with an unsupported type (<class 'NoneType'>) to a Tensor.
  In call to configurable 'create_trainer' (<function create_trainer at 0x7f22e926d048>)

(None, 32, 32, 512)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 16, 16, 512) (None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 1024)
(None, 16, 16, 512)
(None, 16, 16, 1024)
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   247    0     2  100   245     10   1276 --:--:-- --:--:-- --:--:--  1286
okRequest issued for: [node-5]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-03-31T05:27:22.156277371Z'
  endTime: '2021-03-31T05:28:09.443132122Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617168442142-5bece5e892df0-5cf885d9-0221b52c
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617168442142-5bece5e892df0-5cf885d9-0221b52c] to complete...
...............................................................................................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-5]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-03-31T05:28:25.069569363Z'
  endTime: '2021-03-31T05:28:57.789092124Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617168505052-5bece62491b6e-aa14b1f3-d522c102
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617168505052-5bece62491b6e-aa14b1f3-d522c102] to complete...
................................................................................................................................................................................................done.
europe-west4-a
I0331 05:29:06.258197 140139880466240 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.2,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': True,
                                                     '4': True,
                                                     '5': True},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'aug_rand_angle': 5.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_transalate': 0.0,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_boxes': 0.1,
                                    'jitter_im': 0.3,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'max_process_size': 608,
                                    'min_process_size': 320,
                                    'mosaic': {'crop_area': [0.3, 0.35],
                                               'mosaic_frequency': 0.955,
                                               'output_size': [640, 640],
                                               'random_crop': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'aug_rand_angle': 15.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_transalate': 0.0,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_boxes': 0.3,
                                         'jitter_im': 0.3,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'max_process_size': 608,
                                         'min_process_size': 320,
                                         'mosaic': {'crop_area': [0.3, 0.35],
                                                    'mosaic_frequency': 0.9,
                                                    'output_size': [640, 640],
                                                    'random_crop': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 50000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine': {'alpha': 0.01,
                                                               'decay_steps': 561500,
                                                               'initial_learning_rate': 0.01,
                                                               'name': 'Cosine'},
                                                    'type': 'cosine'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 50000,
             'summary_interval': 50000,
             'train_steps': 562500,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 50000,
             'validation_steps': 625}}
I0331 05:29:06.259349 140139880466240 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/params.yaml
I0331 05:29:07.034677 140139880466240 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0331 05:29:07.176522 140139880466240 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0331 05:29:07.176873 140139880466240 transport.py:157] Attempting refresh to obtain initial access_token
I0331 05:29:07.241562 140139880466240 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0331 05:29:07.389214 140139880466240 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0331 05:29:07.389489 140139880466240 transport.py:157] Attempting refresh to obtain initial access_token
2021-03-31 05:29:07.443493: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0331 05:29:07.444118 140139880466240 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0331 05:29:08.055852 140139880466240 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0331 05:29:08.056298 140139880466240 transport.py:157] Attempting refresh to obtain initial access_token
I0331 05:29:08.107708 140139880466240 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0331 05:29:08.248225 140139880466240 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0331 05:29:08.248494 140139880466240 transport.py:157] Attempting refresh to obtain initial access_token
2021-03-31 05:29:08.290595: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-03-31 05:29:08.301444: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.56.217.90:8470}
2021-03-31 05:29:08.301526: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:32952}
2021-03-31 05:29:38.846623: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.56.217.90:8470}
2021-03-31 05:29:38.846713: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:32952}
2021-03-31 05:29:38.847844: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:32952
I0331 05:29:38.849994 140139880466240 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-5
I0331 05:29:38.851785 140139880466240 tpu_strategy_util.py:74] Initializing the TPU system: node-5
INFO:tensorflow:Clearing out eager caches
I0331 05:29:46.984820 140139880466240 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0331 05:29:46.986995 140139880466240 tpu_strategy_util.py:133] Finished initializing TPU system.
I0331 05:29:46.988468 140139880466240 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0331 05:29:47.605961 140139880466240 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0331 05:29:47.606235 140139880466240 transport.py:157] Attempting refresh to obtain initial access_token
I0331 05:29:47.667025 140139880466240 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0331 05:29:48.282380 140139880466240 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0331 05:29:48.282665 140139880466240 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0331 05:29:48.344761 140139880466240 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0331 05:29:48.345064 140139880466240 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0331 05:29:48.345650 140139880466240 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0331 05:29:48.345789 140139880466240 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0331 05:29:48.345929 140139880466240 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0331 05:29:48.346213 140139880466240 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0331 05:29:48.346322 140139880466240 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0331 05:29:48.346421 140139880466240 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0331 05:29:48.346516 140139880466240 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0331 05:29:48.346606 140139880466240 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0331 05:29:48.346711 140139880466240 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0331 05:29:48.346823 140139880466240 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0331 05:29:48.346914 140139880466240 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0331 05:29:48.347005 140139880466240 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0331 05:29:48.347120 140139880466240 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0331 05:29:48.347212 140139880466240 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0331 05:29:48.370063 140139880466240 train_utils.py:214] Running default trainer.
2021-03-31 05:29:48.384786: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': True, '4': True, '5': True}, 'use_nms': True, 'iou_thresh': 0.2, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 320, 'max_process_size': 608, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'jitter_boxes': 0.1, 'aug_rand_transalate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_zoom': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_angle': 5.0, 'use_tie_breaker': True, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.955, 'crop_area': [0.3, 0.35], 'random_crop': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 320, 'max_process_size': 608, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'jitter_boxes': 0.3, 'aug_rand_transalate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_zoom': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_angle': 15.0, 'use_tie_breaker': True, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.9, 'crop_area': [0.3, 0.35], 'random_crop': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine', 'cosine': {'name': 'Cosine', 'initial_learning_rate': 0.01, 'decay_steps': 561500, 'alpha': 0.01}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 50000, 'summary_interval': 50000, 'checkpoint_interval': 50000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 562500, 'validation_steps': 625, 'validation_interval': 50000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': True, '4': True, '5': True}, 'use_nms': True, 'iou_thresh': 0.2, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f747477c898>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
route_split 512.0 512.0
conv2 512.0
conv1 512.0
spp
conv1 512.0
conv2 512.0
connect
conv1 512.0
8
(None, 16, 16, 512) (None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 2048)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 1024)
(None, 16, 16, 512)
route_split 256.0 256.0
conv2 256.0
conv1 256.0
conv2 256.0
connect
conv1 256.0
6
(None, 32, 32, 256) (None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 32, 32, 256)








 ListWrapper([128, 256, 512])
route_split 128 128
conv2 128
conv1 128
conv2 128
connect
conv1 128
conv2 256
7
(None, 64, 64, 128) (None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 256)
(None, 64, 64, 128)
(None, 64, 64, 256)
route_split 256 256
conv2 256
conv1 256
conv2 256
connect
conv1 256
conv2 512
7
(None, 32, 32, 256) (None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 32, 32, 256)
(None, 32, 32, 512)
route_split 512 512
conv2 512
conv1 512
conv2 512
connect
conv1 512
conv2 1024
7
(None, 16, 16, 512) (None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 1024)
(None, 16, 16, 512)
(None, 16, 16, 1024)
detget {'3': 2.0, '4': 2.0, '5': 2.0}
(None, 16, 16, 512) (None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 2048)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 1024)
(None, 16, 16, 512)
(None, 32, 32, 256) (None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 32, 32, 256)
(None, 64, 64, 128) (None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 256)
(None, 64, 64, 128)
(None, 64, 64, 256)
(None, 32, 32, 256) (None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)I0331 05:30:37.267783 140139880466240 controller.py:362] restoring or initializing model...
I0331 05:30:46.423109 140139880466240 yolo.py:484] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0331 05:30:46.424625 140139880466240 controller.py:368] initialized model.
I0331 05:30:46.424846 140139880466240 train_lib.py:96] Starts to execute mode: train_and_eval
I0331 05:30:46.429846 140139880466240 controller.py:211] train | step:      0 | training until step 50000...
I0331 05:30:53.730471 140139880466240 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0331 05:31:31.746575 140139880466240 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0331 12:24:49.819409 140139880466240 controller.py:425] train | step:  50000 | steps/sec:    2.0 | output: 
    {'avg_iou_3': 0.59834284,
     'avg_iou_4': 0.71050423,
     'avg_iou_5': 0.7494653,
     'avg_obj_3': 0.35262293,
     'avg_obj_4': 0.54995143,
     'avg_obj_5': 0.68442,
     'box_loss_3': 0.02116222,
     'box_loss_4': 0.01564486,
     'box_loss_5': 0.014116123,
     'class_loss_3': 0.011685455,
     'class_loss_4': 0.01000157,
     'class_loss_5': 0.009173355,
     'conf_loss_3': 0.08131224,
     'conf_loss_4': 0.06004497,
     'conf_loss_5': 0.032088444,
     'learning_rate': 0.009807565,
     'recall50_3': 0.29752544,
     'recall50_4': 0.5596843,
     'recall50_5': 0.7235914,
     'total_loss': 2.04183,
     'training_loss': 2.04183}
I0331 12:25:47.865056 140139880466240 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/ckpt-50000.
I0331 12:25:47.871234 140139880466240 controller.py:252]  eval | step:  50000 | running 625 steps of evaluation...
I0331 12:25:48.629803 140139880466240 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0331 12:26:07.605294 140139880466240 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0331 12:31:04.195427 140139880466240 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0331 12:35:08.393074 140139880466240 controller.py:261]  eval | step:  50000 | eval time:  560.5 sec | output: 
    {'AP': 0.32439798,
     'AP50': 0.5082181,
     'AP75': 0.34954512,
     'APl': 0.45590228,
     'APm': 0.33567825,
     'APs': 0.12452212,
     'ARl': 0.54932225,
     'ARm': 0.4366018,
     'ARmax1': 0.27032876,
     'ARmax10': 0.39999142,
     'ARmax100': 0.4143662,
     'ARs': 0.1883134,
     'avg_iou_3': 0.49158946,
     'avg_iou_4': 0.7098299,
     'avg_iou_5': 0.77970237,
     'avg_obj_3': 0.33067742,
     'avg_obj_4': 0.5987426,
     'avg_obj_5': 0.74102646,
     'box_loss_3': 0.01057982,
     'box_loss_4': 0.009921977,
     'box_loss_5': 0.009146466,
     'class_loss_3': 0.0038203967,
     'class_loss_4': 0.0038578403,
     'class_loss_5': 0.0038093291,
     'conf_loss_3': 0.025985101,
     'conf_loss_4': 0.027165433,
     'conf_loss_5': 0.021791682,
     'recall50_3': 0.3341976,
     'recall50_4': 0.6225304,
     'recall50_5': 0.7688151,
     'total_loss': 0.11607797,
     'validation_loss': 0.11607797}
I0331 12:35:39.404760 140139880466240 controller.py:211] train | step:  50000 | training until step 100000...
I0331 19:20:39.639343 140139880466240 controller.py:425] train | step:  100000 | steps/sec:    2.0 | output: 
    {'avg_iou_3': 0.6399351,
     'avg_iou_4': 0.7675468,
     'avg_iou_5': 0.81285053,
     'avg_obj_3': 0.4496334,
     'avg_obj_4': 0.6744138,
     'avg_obj_5': 0.8011425,
     'box_loss_3': 0.01892747,
     'box_loss_4': 0.012552312,
     'box_loss_5': 0.010548912,
     'class_loss_3': 0.0064105717,
     'class_loss_4': 0.004685277,
     'class_loss_5': 0.0042702905,
     'conf_loss_3': 0.06747559,
     'conf_loss_4': 0.051069953,
     'conf_loss_5': 0.026545351,
     'learning_rate': 0.009245227,
     'recall50_3': 0.41448945,
     'recall50_4': 0.7012556,
     'recall50_5': 0.8408616,
     'total_loss': 1.6198877,
     'training_loss': 1.6198877}

(None, 32, 32, 512)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 16, 16, 512) (None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 1024)
(None, 16, 16, 512)
(None, 16, 16, 1024)
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4), num_detections: (8,), upds: {3: (8, 400, 8), 4: (8, 400, 8), 5: (8, 400, 8)}, inds: {3: (8, 400, 3), 4: (8, 400, 3), 5: (8, 400, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 50000...
(8, 16, 16, 512) (8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 2048)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 1024)
(8, 16, 16, 512)
(8, 32, 32, 256) (8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 512)
(8, 32, 32, 256)
(8, 64, 64, 128) (8, 64, 64, 128)
(8, 64, 64, 128)
(8, 64, 64, 128)
(8, 64, 64, 128)
(8, 64, 64, 256)
(8, 64, 64, 128)
(8, 64, 64, 256)
(8, 32, 32, 256) (8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 512)
(8, 32, 32, 256)
(8, 32, 32, 512)
(8, 16, 16, 512) (8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 1024)
(8, 16, 16, 512)
(8, 16, 16, 1024)
(8, 16, 16, 512) (8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 2048)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 1024)
(8, 16, 16, 512)
(8, 32, 32, 256) (8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 512)
(8, 32, 32, 256)
(8, 64, 64, 128) (8, 64, 64, 128)
(8, 64, 64, 128)
(8, 64, 64, 128)
(8, 64, 64, 128)
(8, 64, 64, 256)
(8, 64, 64, 128)
(8, 64, 64, 256)
(8, 32, 32, 256) (8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 512)
(8, 32, 32, 256)
(8, 32, 32, 512)
(8, 16, 16, 512) (8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 1024)
(8, 16, 16, 512)
(8, 16, 16, 1024)
train | step:  50000 | steps/sec:    2.0 | output: 
    {'avg_iou_3': 0.59834284,
     'avg_iou_4': 0.71050423,
     'avg_iou_5': 0.7494653,
     'avg_obj_3': 0.35262293,
     'avg_obj_4': 0.54995143,
     'avg_obj_5': 0.68442,
     'box_loss_3': 0.02116222,
     'box_loss_4': 0.01564486,
     'box_loss_5': 0.014116123,
     'class_loss_3': 0.011685455,
     'class_loss_4': 0.01000157,
     'class_loss_5': 0.009173355,
     'conf_loss_3': 0.08131224,
     'conf_loss_4': 0.06004497,
     'conf_loss_5': 0.032088444,
     'learning_rate': 0.009807565,
     'recall50_3': 0.29752544,
     'recall50_4': 0.5596843,
     'recall50_5': 0.7235914,
     'total_loss': 2.04183,
     'training_loss': 2.04183}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/ckpt-50000.
 eval | step:  50000 | running 625 steps of evaluation...
(1, 16, 16, 512) (1, 16, 16, 512)
(1, 16, 16, 512)
(1, 16, 16, 512)
(1, 16, 16, 2048)
(1, 16, 16, 512)
(1, 16, 16, 512)
(1, 16, 16, 1024)
(1, 16, 16, 512)
(1, 32, 32, 256) (1, 32, 32, 256)
(1, 32, 32, 256)
(1, 32, 32, 256)
(1, 32, 32, 256)
(1, 32, 32, 512)
(1, 32, 32, 256)
(1, 64, 64, 128) (1, 64, 64, 128)
(1, 64, 64, 128)
(1, 64, 64, 128)
(1, 64, 64, 128)
(1, 64, 64, 256)
(1, 64, 64, 128)
(1, 64, 64, 256)
(1, 32, 32, 256) (1, 32, 32, 256)
(1, 32, 32, 256)
(1, 32, 32, 256)
(1, 32, 32, 256)
(1, 32, 32, 512)
(1, 32, 32, 256)
(1, 32, 32, 512)
(1, 16, 16, 512) (1, 16, 16, 512)
(1, 16, 16, 512)
(1, 16, 16, 512)
(1, 16, 16, 512)
(1, 16, 16, 1024)
(1, 16, 16, 512)
(1, 16, 16, 1024)
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=182.81s).
Accumulating evaluation results...
DONE (t=3.34s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.324
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.508
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.350
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.125
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.336
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.456
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.270
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.400
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.414
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.188
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.437
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.549
 eval | step:  50000 | eval time:  560.5 sec | output: 
    {'AP': 0.32439798,
     'AP50': 0.5082181,
     'AP75': 0.34954512,
     'APl': 0.45590228,
     'APm': 0.33567825,
     'APs': 0.12452212,
     'ARl': 0.54932225,
     'ARm': 0.4366018,
     'ARmax1': 0.27032876,
     'ARmax10': 0.39999142,
     'ARmax100': 0.4143662,
     'ARs': 0.1883134,
     'avg_iou_3': 0.49158946,
     'avg_iou_4': 0.7098299,
     'avg_iou_5': 0.77970237,
     'avg_obj_3': 0.33067742,
     'avg_obj_4': 0.5987426,
     'avg_obj_5': 0.74102646,
     'box_loss_3': 0.01057982,
     'box_loss_4': 0.009921977,
     'box_loss_5': 0.009146466,
     'class_loss_3': 0.0038203967,
     'class_loss_4': 0.0038578403,
     'class_loss_5': 0.0038093291,
     'conf_loss_3': 0.025985101,
     'conf_loss_4': 0.027165433,
     'conf_loss_5': 0.021791682,
     'recall50_3': 0.3341976,
     'recall50_4': 0.6225304,
     'recall50_5': 0.7688151,
     'total_loss': 0.11607797,
     'validation_loss': 0.11607797}
train | step:  50000 | training until step 100000...
train | step:  100000 | steps/sec:    2.0 | output: 
    {'avg_iou_3': 0.6399351,
     'avg_iou_4': 0.7675468,
     'avg_iou_5': 0.81285053,
     'avg_obj_3': 0.4496334,
     'avg_obj_4': 0.6744138,
     'avg_obj_5': 0.8011425,
     'box_loss_3': 0.01892747,
     'box_loss_4': 0.012552312,
     'box_loss_5': 0.010548912,
     'class_loss_3': 0.0064105717,
     'class_loss_4': 0.004685277,
     'class_loss_5': 0.0042702905,
     'conf_loss_3': 0.06747559,
     'conf_loss_4': 0.051069953,
     'conf_loss_5': 0.026545351,
     'learning_rate': 0.009245227,
     'recall50_3': 0.41448945,
     'recall50_4': 0.7012556,
     'recall50_5': 0.8408616,
     'total_loss': 1.6198877,
     'training_loss': 1.6198877}I0331 19:21:27.679275 140139880466240 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/ckpt-100000.
I0331 19:21:27.687523 140139880466240 controller.py:252]  eval | step:  100000 | running 625 steps of evaluation...
I0331 19:25:32.309680 140139880466240 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0331 19:29:12.016593 140139880466240 controller.py:261]  eval | step:  100000 | eval time:  464.3 sec | output: 
    {'AP': 0.33482504,
     'AP50': 0.5150952,
     'AP75': 0.3620521,
     'APl': 0.46631667,
     'APm': 0.34553283,
     'APs': 0.13538672,
     'ARl': 0.5594937,
     'ARm': 0.44629693,
     'ARmax1': 0.27794927,
     'ARmax10': 0.41022518,
     'ARmax100': 0.4230642,
     'ARs': 0.1998194,
     'avg_iou_3': 0.49463746,
     'avg_iou_4': 0.7120865,
     'avg_iou_5': 0.7835144,
     'avg_obj_3': 0.3391378,
     'avg_obj_4': 0.61211514,
     'avg_obj_5': 0.7529123,
     'box_loss_3': 0.010423152,
     'box_loss_4': 0.009812127,
     'box_loss_5': 0.008954768,
     'class_loss_3': 0.0036501114,
     'class_loss_4': 0.0037459687,
     'class_loss_5': 0.0036340135,
     'conf_loss_3': 0.026881952,
     'conf_loss_4': 0.028426077,
     'conf_loss_5': 0.022657862,
     'recall50_3': 0.34252974,
     'recall50_4': 0.6311621,
     'recall50_5': 0.77585125,
     'total_loss': 0.11818607,
     'validation_loss': 0.11818607}
I0331 19:29:37.150054 140139880466240 controller.py:211] train | step:  100000 | training until step 150000...
I0401 02:07:11.359216 140139880466240 controller.py:425] train | step:  150000 | steps/sec:    2.0 | output: 
    {'avg_iou_3': 0.6529118,
     'avg_iou_4': 0.7850715,
     'avg_iou_5': 0.83161706,
     'avg_obj_3': 0.49540862,
     'avg_obj_4': 0.7255527,
     'avg_obj_5': 0.84472126,
     'box_loss_3': 0.018234836,
     'box_loss_4': 0.011601285,
     'box_loss_5': 0.009488579,
     'class_loss_3': 0.005694367,
     'class_loss_4': 0.004005453,
     'class_loss_5': 0.0035982798,
     'conf_loss_3': 0.063505515,
     'conf_loss_4': 0.047278423,
     'conf_loss_5': 0.024297561,
     'learning_rate': 0.008356704,
     'recall50_3': 0.46809563,
     'recall50_4': 0.75270265,
     'recall50_5': 0.8782445,
     'total_loss': 1.5016274,
     'training_loss': 1.5016274}
I0401 02:08:04.133480 140139880466240 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/ckpt-150000.
I0401 02:08:04.141056 140139880466240 controller.py:252]  eval | step:  150000 | running 625 steps of evaluation...
I0401 02:12:11.872283 140139880466240 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0401 02:16:49.068205 140139880466240 controller.py:261]  eval | step:  150000 | eval time:  524.9 sec | output: 
    {'AP': 0.33599636,
     'AP50': 0.51245826,
     'AP75': 0.36505875,
     'APl': 0.4760127,
     'APm': 0.34304225,
     'APs': 0.14209332,
     'ARl': 0.5673174,
     'ARm': 0.44012803,
     'ARmax1': 0.28082594,
     'ARmax10': 0.41073528,
     'ARmax100': 0.4231281,
     'ARs': 0.20145267,
     'avg_iou_3': 0.49465707,
     'avg_iou_4': 0.71047014,
     'avg_iou_5': 0.78398633,
     'avg_obj_3': 0.33937111,
     'avg_obj_4': 0.61246496,
     'avg_obj_5': 0.7554352,
     'box_loss_3': 0.010421097,
     'box_loss_4': 0.009910664,
     'box_loss_5': 0.008941159,
     'class_loss_3': 0.003676204,
     'class_loss_4': 0.003819789,
     'class_loss_5': 0.0037732774,
     'conf_loss_3': 0.026987411,
     'conf_loss_4': 0.029063035,
     'conf_loss_5': 0.023393203,
     'recall50_3': 0.34495044,
     'recall50_4': 0.632731,
     'recall50_5': 0.77627414,
     'total_loss': 0.119985916,
     'validation_loss': 0.119985916}
I0401 02:17:19.295806 140139880466240 controller.py:211] train | step:  150000 | training until step 200000...
I0401 08:45:17.872426 140139880466240 controller.py:425] train | step:  200000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.6618489,
     'avg_iou_4': 0.796618,
     'avg_iou_5': 0.84351873,
     'avg_obj_3': 0.5293202,
     'avg_obj_4': 0.7587192,
     'avg_obj_5': 0.87030745,
     'box_loss_3': 0.017757414,
     'box_loss_4': 0.010975423,
     'box_loss_5': 0.008822997,
     'class_loss_3': 0.0052456856,
     'class_loss_4': 0.0035907417,
     'class_loss_5': 0.0031936255,
     'conf_loss_3': 0.06059889,
     'conf_loss_4': 0.044812616,
     'conf_loss_5': 0.022945784,
     'learning_rate': 0.0072110826,
     'recall50_3': 0.50652397,
     'recall50_4': 0.7847046,
     'recall50_5': 0.89908594,
     'total_loss': 1.4235507,
     'training_loss': 1.4235507}
I0401 08:46:11.633320 140139880466240 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/ckpt-200000.
I0401 08:46:11.639495 140139880466240 controller.py:252]  eval | step:  200000 | running 625 steps of evaluation...
I0401 08:50:20.344240 140139880466240 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0401 08:54:42.042428 140139880466240 controller.py:261]  eval | step:  200000 | eval time:  510.4 sec | output: 
    {'AP': 0.3331241,
     'AP50': 0.5090382,
     'AP75': 0.36103424,
     'APl': 0.4775322,
     'APm': 0.33978286,
     'APs': 0.13929597,
     'ARl': 0.5631409,
     'ARm': 0.43519634,
     'ARmax1': 0.27828515,
     'ARmax10': 0.4068701,
     'ARmax100': 0.41865352,
     'ARs': 0.1993558,
     'avg_iou_3': 0.49401617,
     'avg_iou_4': 0.70932585,
     'avg_iou_5': 0.78350735,
     'avg_obj_3': 0.33808905,
     'avg_obj_4': 0.6114028,
     'avg_obj_5': 0.75603837,
     'box_loss_3': 0.010457627,
     'box_loss_4': 0.009967896,
     'box_loss_5': 0.008974027,
     'class_loss_3': 0.003690651,
     'class_loss_4': 0.0038151958,
     'class_loss_5': 0.0037515706,
     'conf_loss_3': 0.027517669,
     'conf_loss_4': 0.02946929,
     'conf_loss_5': 0.023879282,
     'recall50_3': 0.3429212,
     'recall50_4': 0.62847835,
     'recall50_5': 0.77524745,
     'total_loss': 0.12152323,
     'validation_loss': 0.12152323}

saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/ckpt-100000.
 eval | step:  100000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=165.55s).
Accumulating evaluation results...
DONE (t=3.14s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.335
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.515
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.362
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.135
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.346
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.466
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.278
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.410
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.423
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.200
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.446
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.559
 eval | step:  100000 | eval time:  464.3 sec | output: 
    {'AP': 0.33482504,
     'AP50': 0.5150952,
     'AP75': 0.3620521,
     'APl': 0.46631667,
     'APm': 0.34553283,
     'APs': 0.13538672,
     'ARl': 0.5594937,
     'ARm': 0.44629693,
     'ARmax1': 0.27794927,
     'ARmax10': 0.41022518,
     'ARmax100': 0.4230642,
     'ARs': 0.1998194,
     'avg_iou_3': 0.49463746,
     'avg_iou_4': 0.7120865,
     'avg_iou_5': 0.7835144,
     'avg_obj_3': 0.3391378,
     'avg_obj_4': 0.61211514,
     'avg_obj_5': 0.7529123,
     'box_loss_3': 0.010423152,
     'box_loss_4': 0.009812127,
     'box_loss_5': 0.008954768,
     'class_loss_3': 0.0036501114,
     'class_loss_4': 0.0037459687,
     'class_loss_5': 0.0036340135,
     'conf_loss_3': 0.026881952,
     'conf_loss_4': 0.028426077,
     'conf_loss_5': 0.022657862,
     'recall50_3': 0.34252974,
     'recall50_4': 0.6311621,
     'recall50_5': 0.77585125,
     'total_loss': 0.11818607,
     'validation_loss': 0.11818607}
train | step:  100000 | training until step 150000...
train | step:  150000 | steps/sec:    2.0 | output: 
    {'avg_iou_3': 0.6529118,
     'avg_iou_4': 0.7850715,
     'avg_iou_5': 0.83161706,
     'avg_obj_3': 0.49540862,
     'avg_obj_4': 0.7255527,
     'avg_obj_5': 0.84472126,
     'box_loss_3': 0.018234836,
     'box_loss_4': 0.011601285,
     'box_loss_5': 0.009488579,
     'class_loss_3': 0.005694367,
     'class_loss_4': 0.004005453,
     'class_loss_5': 0.0035982798,
     'conf_loss_3': 0.063505515,
     'conf_loss_4': 0.047278423,
     'conf_loss_5': 0.024297561,
     'learning_rate': 0.008356704,
     'recall50_3': 0.46809563,
     'recall50_4': 0.75270265,
     'recall50_5': 0.8782445,
     'total_loss': 1.5016274,
     'training_loss': 1.5016274}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/ckpt-150000.
 eval | step:  150000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=215.26s).
Accumulating evaluation results...
DONE (t=3.17s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.336
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.512
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.365
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.142
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.343
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.476
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.281
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.411
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.423
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.201
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.440
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.567
 eval | step:  150000 | eval time:  524.9 sec | output: 
    {'AP': 0.33599636,
     'AP50': 0.51245826,
     'AP75': 0.36505875,
     'APl': 0.4760127,
     'APm': 0.34304225,
     'APs': 0.14209332,
     'ARl': 0.5673174,
     'ARm': 0.44012803,
     'ARmax1': 0.28082594,
     'ARmax10': 0.41073528,
     'ARmax100': 0.4231281,
     'ARs': 0.20145267,
     'avg_iou_3': 0.49465707,
     'avg_iou_4': 0.71047014,
     'avg_iou_5': 0.78398633,
     'avg_obj_3': 0.33937111,
     'avg_obj_4': 0.61246496,
     'avg_obj_5': 0.7554352,
     'box_loss_3': 0.010421097,
     'box_loss_4': 0.009910664,
     'box_loss_5': 0.008941159,
     'class_loss_3': 0.003676204,
     'class_loss_4': 0.003819789,
     'class_loss_5': 0.0037732774,
     'conf_loss_3': 0.026987411,
     'conf_loss_4': 0.029063035,
     'conf_loss_5': 0.023393203,
     'recall50_3': 0.34495044,
     'recall50_4': 0.632731,
     'recall50_5': 0.77627414,
     'total_loss': 0.119985916,
     'validation_loss': 0.119985916}
train | step:  150000 | training until step 200000...
train | step:  200000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.6618489,
     'avg_iou_4': 0.796618,
     'avg_iou_5': 0.84351873,
     'avg_obj_3': 0.5293202,
     'avg_obj_4': 0.7587192,
     'avg_obj_5': 0.87030745,
     'box_loss_3': 0.017757414,
     'box_loss_4': 0.010975423,
     'box_loss_5': 0.008822997,
     'class_loss_3': 0.0052456856,
     'class_loss_4': 0.0035907417,
     'class_loss_5': 0.0031936255,
     'conf_loss_3': 0.06059889,
     'conf_loss_4': 0.044812616,
     'conf_loss_5': 0.022945784,
     'learning_rate': 0.0072110826,
     'recall50_3': 0.50652397,
     'recall50_4': 0.7847046,
     'recall50_5': 0.89908594,
     'total_loss': 1.4235507,
     'training_loss': 1.4235507}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/ckpt-200000.
 eval | step:  200000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=201.86s).
Accumulating evaluation results...
DONE (t=4.25s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.333
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.509
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.361
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.139
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.340
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.478
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.278
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.407
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.419
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.199
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.435
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.563
 eval | step:  200000 | eval time:  510.4 sec | output: 
    {'AP': 0.3331241,
     'AP50': 0.5090382,
     'AP75': 0.36103424,
     'APl': 0.4775322,
     'APm': 0.33978286,
     'APs': 0.13929597,
     'ARl': 0.5631409,
     'ARm': 0.43519634,
     'ARmax1': 0.27828515,
     'ARmax10': 0.4068701,
     'ARmax100': 0.41865352,
     'ARs': 0.1993558,
     'avg_iou_3': 0.49401617,
     'avg_iou_4': 0.70932585,
     'avg_iou_5': 0.78350735,
     'avg_obj_3': 0.33808905,
     'avg_obj_4': 0.6114028,
     'avg_obj_5': 0.75603837,
     'box_loss_3': 0.010457627,
     'box_loss_4': 0.009967896,
     'box_loss_5': 0.008974027,
     'class_loss_3': 0.003690651,
     'class_loss_4': 0.0038151958,
     'class_loss_5': 0.0037515706,
     'conf_loss_3': 0.027517669,
     'conf_loss_4': 0.02946929,
     'conf_loss_5': 0.023879282,
     'recall50_3': 0.3429212,
     'recall50_4': 0.62847835,
     'recall50_5': 0.77524745,
     'total_loss': 0.12152323,
     'validation_loss': 0.12152323}I0401 08:55:05.145733 140139880466240 controller.py:211] train | step:  200000 | training until step 250000...
I0401 15:27:44.203203 140139880466240 controller.py:425] train | step:  250000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.66890305,
     'avg_iou_4': 0.8052891,
     'avg_iou_5': 0.8522214,
     'avg_obj_3': 0.5566557,
     'avg_obj_4': 0.7828058,
     'avg_obj_5': 0.887614,
     'box_loss_3': 0.017374113,
     'box_loss_4': 0.010511134,
     'box_loss_5': 0.008337317,
     'class_loss_3': 0.0049104006,
     'class_loss_4': 0.0032935145,
     'class_loss_5': 0.0029012882,
     'conf_loss_3': 0.058716718,
     'conf_loss_4': 0.043165777,
     'conf_loss_5': 0.022055576,
     'learning_rate': 0.0058974335,
     'recall50_3': 0.5369507,
     'recall50_4': 0.8072114,
     'recall50_5': 0.9126832,
     'total_loss': 1.3701266,
     'training_loss': 1.3701266}
I0401 15:28:33.715973 140139880466240 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/ckpt-250000.
I0401 15:28:33.722653 140139880466240 controller.py:252]  eval | step:  250000 | running 625 steps of evaluation...
I0401 15:32:42.391688 140139880466240 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0401 15:36:32.038314 140139880466240 controller.py:261]  eval | step:  250000 | eval time:  478.3 sec | output: 
    {'AP': 0.3336233,
     'AP50': 0.5081906,
     'AP75': 0.36023015,
     'APl': 0.47838074,
     'APm': 0.3362448,
     'APs': 0.13452822,
     'ARl': 0.5632475,
     'ARm': 0.4307125,
     'ARmax1': 0.27933064,
     'ARmax10': 0.40690973,
     'ARmax100': 0.41790506,
     'ARs': 0.19755594,
     'avg_iou_3': 0.49316508,
     'avg_iou_4': 0.70840883,
     'avg_iou_5': 0.7828703,
     'avg_obj_3': 0.337962,
     'avg_obj_4': 0.61171466,
     'avg_obj_5': 0.75870645,
     'box_loss_3': 0.0105049815,
     'box_loss_4': 0.010022831,
     'box_loss_5': 0.009019086,
     'class_loss_3': 0.003745536,
     'class_loss_4': 0.0038819504,
     'class_loss_5': 0.0038174733,
     'conf_loss_3': 0.02772648,
     'conf_loss_4': 0.029944586,
     'conf_loss_5': 0.024401592,
     'recall50_3': 0.34666878,
     'recall50_4': 0.6290803,
     'recall50_5': 0.777298,
     'total_loss': 0.12306449,
     'validation_loss': 0.12306449}
I0401 15:37:04.063273 140139880466240 controller.py:211] train | step:  250000 | training until step 300000...
I0401 22:03:27.246457 140139880466240 controller.py:425] train | step:  300000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.674769,
     'avg_iou_4': 0.8122561,
     'avg_iou_5': 0.8591062,
     'avg_obj_3': 0.5796155,
     'avg_obj_4': 0.801707,
     'avg_obj_5': 0.90053725,
     'box_loss_3': 0.0170559,
     'box_loss_4': 0.010133641,
     'box_loss_5': 0.007946775,
     'class_loss_3': 0.0046371557,
     'class_loss_4': 0.0030560845,
     'class_loss_5': 0.002671199,
     'conf_loss_3': 0.056811955,
     'conf_loss_4': 0.042600594,
     'conf_loss_5': 0.021424893,
     'learning_rate': 0.0045178966,
     'recall50_3': 0.5618639,
     'recall50_4': 0.8245611,
     'recall50_5': 0.92237437,
     'total_loss': 1.3307132,
     'training_loss': 1.3307132}
I0401 22:04:27.672343 140139880466240 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/ckpt-300000.
I0401 22:04:27.680260 140139880466240 controller.py:252]  eval | step:  300000 | running 625 steps of evaluation...
I0401 22:08:36.776243 140139880466240 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0401 22:12:20.822857 140139880466240 controller.py:261]  eval | step:  300000 | eval time:  473.1 sec | output: 
    {'AP': 0.3332787,
     'AP50': 0.505028,
     'AP75': 0.36139852,
     'APl': 0.48005104,
     'APm': 0.33859745,
     'APs': 0.13394214,
     'ARl': 0.56480986,
     'ARm': 0.43102518,
     'ARmax1': 0.28023863,
     'ARmax10': 0.40586883,
     'ARmax100': 0.41694146,
     'ARs': 0.1901961,
     'avg_iou_3': 0.49252236,
     'avg_iou_4': 0.7063911,
     'avg_iou_5': 0.7818505,
     'avg_obj_3': 0.33692762,
     'avg_obj_4': 0.61304235,
     'avg_obj_5': 0.7604267,
     'box_loss_3': 0.010544121,
     'box_loss_4': 0.010130906,
     'box_loss_5': 0.009080579,
     'class_loss_3': 0.0037481873,
     'class_loss_4': 0.0038932785,
     'class_loss_5': 0.0038027847,
     'conf_loss_3': 0.027905252,
     'conf_loss_4': 0.031363945,
     'conf_loss_5': 0.02485842,
     'recall50_3': 0.3453481,
     'recall50_4': 0.63067746,
     'recall50_5': 0.7764051,
     'total_loss': 0.12532748,
     'validation_loss': 0.12532748}
I0401 22:12:53.677573 140139880466240 controller.py:211] train | step:  300000 | training until step 350000...
I0402 04:43:08.978461 140139880466240 controller.py:425] train | step:  350000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.6798774,
     'avg_iou_4': 0.8180263,
     'avg_iou_5': 0.86469007,
     'avg_obj_3': 0.5994959,
     'avg_obj_4': 0.8169122,
     'avg_obj_5': 0.91062045,
     'box_loss_3': 0.016791558,
     'box_loss_4': 0.009820404,
     'box_loss_5': 0.0076331645,
     'class_loss_3': 0.0044177114,
     'class_loss_4': 0.0028680465,
     'class_loss_5': 0.0024940977,
     'conf_loss_3': 0.055661496,
     'conf_loss_4': 0.04241207,
     'conf_loss_5': 0.020886287,
     'learning_rate': 0.0031797306,
     'recall50_3': 0.5833103,
     'recall50_4': 0.83810437,
     'recall50_5': 0.9297933,
     'total_loss': 1.303877,
     'training_loss': 1.303877}
I0402 04:44:05.796686 140139880466240 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/ckpt-350000.
I0402 04:44:05.804716 140139880466240 controller.py:252]  eval | step:  350000 | running 625 steps of evaluation...
I0402 04:48:18.074559 140139880466240 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.

train | step:  200000 | training until step 250000...
train | step:  250000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.66890305,
     'avg_iou_4': 0.8052891,
     'avg_iou_5': 0.8522214,
     'avg_obj_3': 0.5566557,
     'avg_obj_4': 0.7828058,
     'avg_obj_5': 0.887614,
     'box_loss_3': 0.017374113,
     'box_loss_4': 0.010511134,
     'box_loss_5': 0.008337317,
     'class_loss_3': 0.0049104006,
     'class_loss_4': 0.0032935145,
     'class_loss_5': 0.0029012882,
     'conf_loss_3': 0.058716718,
     'conf_loss_4': 0.043165777,
     'conf_loss_5': 0.022055576,
     'learning_rate': 0.0058974335,
     'recall50_3': 0.5369507,
     'recall50_4': 0.8072114,
     'recall50_5': 0.9126832,
     'total_loss': 1.3701266,
     'training_loss': 1.3701266}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/ckpt-250000.
 eval | step:  250000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=172.13s).
Accumulating evaluation results...
DONE (t=3.14s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.334
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.508
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.360
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.135
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.336
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.478
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.279
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.407
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.418
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.198
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.431
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.563
 eval | step:  250000 | eval time:  478.3 sec | output: 
    {'AP': 0.3336233,
     'AP50': 0.5081906,
     'AP75': 0.36023015,
     'APl': 0.47838074,
     'APm': 0.3362448,
     'APs': 0.13452822,
     'ARl': 0.5632475,
     'ARm': 0.4307125,
     'ARmax1': 0.27933064,
     'ARmax10': 0.40690973,
     'ARmax100': 0.41790506,
     'ARs': 0.19755594,
     'avg_iou_3': 0.49316508,
     'avg_iou_4': 0.70840883,
     'avg_iou_5': 0.7828703,
     'avg_obj_3': 0.337962,
     'avg_obj_4': 0.61171466,
     'avg_obj_5': 0.75870645,
     'box_loss_3': 0.0105049815,
     'box_loss_4': 0.010022831,
     'box_loss_5': 0.009019086,
     'class_loss_3': 0.003745536,
     'class_loss_4': 0.0038819504,
     'class_loss_5': 0.0038174733,
     'conf_loss_3': 0.02772648,
     'conf_loss_4': 0.029944586,
     'conf_loss_5': 0.024401592,
     'recall50_3': 0.34666878,
     'recall50_4': 0.6290803,
     'recall50_5': 0.777298,
     'total_loss': 0.12306449,
     'validation_loss': 0.12306449}
train | step:  250000 | training until step 300000...
train | step:  300000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.674769,
     'avg_iou_4': 0.8122561,
     'avg_iou_5': 0.8591062,
     'avg_obj_3': 0.5796155,
     'avg_obj_4': 0.801707,
     'avg_obj_5': 0.90053725,
     'box_loss_3': 0.0170559,
     'box_loss_4': 0.010133641,
     'box_loss_5': 0.007946775,
     'class_loss_3': 0.0046371557,
     'class_loss_4': 0.0030560845,
     'class_loss_5': 0.002671199,
     'conf_loss_3': 0.056811955,
     'conf_loss_4': 0.042600594,
     'conf_loss_5': 0.021424893,
     'learning_rate': 0.0045178966,
     'recall50_3': 0.5618639,
     'recall50_4': 0.8245611,
     'recall50_5': 0.92237437,
     'total_loss': 1.3307132,
     'training_loss': 1.3307132}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/ckpt-300000.
 eval | step:  300000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=166.14s).
Accumulating evaluation results...
DONE (t=3.00s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.333
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.505
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.361
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.134
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.339
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.480
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.280
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.406
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.417
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.190
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.431
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.565
 eval | step:  300000 | eval time:  473.1 sec | output: 
    {'AP': 0.3332787,
     'AP50': 0.505028,
     'AP75': 0.36139852,
     'APl': 0.48005104,
     'APm': 0.33859745,
     'APs': 0.13394214,
     'ARl': 0.56480986,
     'ARm': 0.43102518,
     'ARmax1': 0.28023863,
     'ARmax10': 0.40586883,
     'ARmax100': 0.41694146,
     'ARs': 0.1901961,
     'avg_iou_3': 0.49252236,
     'avg_iou_4': 0.7063911,
     'avg_iou_5': 0.7818505,
     'avg_obj_3': 0.33692762,
     'avg_obj_4': 0.61304235,
     'avg_obj_5': 0.7604267,
     'box_loss_3': 0.010544121,
     'box_loss_4': 0.010130906,
     'box_loss_5': 0.009080579,
     'class_loss_3': 0.0037481873,
     'class_loss_4': 0.0038932785,
     'class_loss_5': 0.0038027847,
     'conf_loss_3': 0.027905252,
     'conf_loss_4': 0.031363945,
     'conf_loss_5': 0.02485842,
     'recall50_3': 0.3453481,
     'recall50_4': 0.63067746,
     'recall50_5': 0.7764051,
     'total_loss': 0.12532748,
     'validation_loss': 0.12532748}
train | step:  300000 | training until step 350000...
train | step:  350000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.6798774,
     'avg_iou_4': 0.8180263,
     'avg_iou_5': 0.86469007,
     'avg_obj_3': 0.5994959,
     'avg_obj_4': 0.8169122,
     'avg_obj_5': 0.91062045,
     'box_loss_3': 0.016791558,
     'box_loss_4': 0.009820404,
     'box_loss_5': 0.0076331645,
     'class_loss_3': 0.0044177114,
     'class_loss_4': 0.0028680465,
     'class_loss_5': 0.0024940977,
     'conf_loss_3': 0.055661496,
     'conf_loss_4': 0.04241207,
     'conf_loss_5': 0.020886287,
     'learning_rate': 0.0031797306,
     'recall50_3': 0.5833103,
     'recall50_4': 0.83810437,
     'recall50_5': 0.9297933,
     'total_loss': 1.303877,
     'training_loss': 1.303877}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/ckpt-350000.
 eval | step:  350000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=166.55s).
Accumulating evaluation results...
DONE (t=3.10s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.331
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.503
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.358
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.137
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.336
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.471
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.278
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.403
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.413
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.197
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.426
I0402 04:52:08.579266 140139880466240 controller.py:261]  eval | step:  350000 | eval time:  482.8 sec | output: 
    {'AP': 0.33063346,
     'AP50': 0.5027718,
     'AP75': 0.35757518,
     'APl': 0.4714718,
     'APm': 0.33564597,
     'APs': 0.13683122,
     'ARl': 0.5564615,
     'ARm': 0.42556906,
     'ARmax1': 0.27755648,
     'ARmax10': 0.40306592,
     'ARmax100': 0.41347167,
     'ARs': 0.19654755,
     'avg_iou_3': 0.49104345,
     'avg_iou_4': 0.7047422,
     'avg_iou_5': 0.7812325,
     'avg_obj_3': 0.3360358,
     'avg_obj_4': 0.612442,
     'avg_obj_5': 0.7611044,
     'box_loss_3': 0.010626203,
     'box_loss_4': 0.010228262,
     'box_loss_5': 0.009120878,
     'class_loss_3': 0.0038112758,
     'class_loss_4': 0.003952392,
     'class_loss_5': 0.0038649049,
     'conf_loss_3': 0.028496576,
     'conf_loss_4': 0.032130007,
     'conf_loss_5': 0.025316833,
     'recall50_3': 0.34285036,
     'recall50_4': 0.6290336,
     'recall50_5': 0.7786102,
     'total_loss': 0.12754723,
     'validation_loss': 0.12754723}
I0402 04:52:41.883876 140139880466240 controller.py:211] train | step:  350000 | training until step 400000...
I0402 11:20:50.796908 140139880466240 controller.py:425] train | step:  400000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.6843133,
     'avg_iou_4': 0.8228788,
     'avg_iou_5': 0.86920154,
     'avg_obj_3': 0.6163186,
     'avg_obj_4': 0.82937294,
     'avg_obj_5': 0.9188774,
     'box_loss_3': 0.016545182,
     'box_loss_4': 0.009555547,
     'box_loss_5': 0.007376847,
     'class_loss_3': 0.0042245192,
     'class_loss_4': 0.0027105997,
     'class_loss_5': 0.002345385,
     'conf_loss_3': 0.054601874,
     'conf_loss_4': 0.041680213,
     'conf_loss_5': 0.020468688,
     'learning_rate': 0.0019869802,
     'recall50_3': 0.6005629,
     'recall50_4': 0.84884125,
     'recall50_5': 0.9357576,
     'total_loss': 1.2760679,
     'training_loss': 1.2760679}
I0402 11:21:41.163670 140139880466240 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/ckpt-400000.
I0402 11:21:41.170449 140139880466240 controller.py:252]  eval | step:  400000 | running 625 steps of evaluation...
I0402 11:25:56.037167 140139880466240 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0402 11:29:46.827247 140139880466240 controller.py:261]  eval | step:  400000 | eval time:  485.7 sec | output: 
    {'AP': 0.32825926,
     'AP50': 0.49888453,
     'AP75': 0.35521734,
     'APl': 0.47411796,
     'APm': 0.33127907,
     'APs': 0.136436,
     'ARl': 0.5588105,
     'ARm': 0.42258653,
     'ARmax1': 0.27816567,
     'ARmax10': 0.40220022,
     'ARmax100': 0.41243494,
     'ARs': 0.19765848,
     'avg_iou_3': 0.48957995,
     'avg_iou_4': 0.70279485,
     'avg_iou_5': 0.7797625,
     'avg_obj_3': 0.3365093,
     'avg_obj_4': 0.6131913,
     'avg_obj_5': 0.761326,
     'box_loss_3': 0.010708313,
     'box_loss_4': 0.010335452,
     'box_loss_5': 0.009208306,
     'class_loss_3': 0.0038846114,
     'class_loss_4': 0.00408856,
     'class_loss_5': 0.0040028696,
     'conf_loss_3': 0.028996073,
     'conf_loss_4': 0.032690614,
     'conf_loss_5': 0.026011378,
     'recall50_3': 0.3434775,
     'recall50_4': 0.62997425,
     'recall50_5': 0.7761565,
     'total_loss': 0.12992622,
     'validation_loss': 0.12992622}
I0402 11:30:03.677982 140139880466240 controller.py:211] train | step:  400000 | training until step 450000...
I0402 17:57:53.522794 140139880466240 controller.py:425] train | step:  450000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.6879125,
     'avg_iou_4': 0.82667524,
     'avg_iou_5': 0.8727602,
     'avg_obj_3': 0.6297225,
     'avg_obj_4': 0.8389578,
     'avg_obj_5': 0.92497295,
     'box_loss_3': 0.01635466,
     'box_loss_4': 0.009351065,
     'box_loss_5': 0.007176868,
     'class_loss_3': 0.004075253,
     'class_loss_4': 0.002592037,
     'class_loss_5': 0.0022314244,
     'conf_loss_3': 0.053521615,
     'conf_loss_4': 0.041080073,
     'conf_loss_5': 0.020189477,
     'learning_rate': 0.0010323825,
     'recall50_3': 0.6150858,
     'recall50_4': 0.85715127,
     'recall50_5': 0.9399317,
     'total_loss': 1.2525877,
     'training_loss': 1.2525877}
I0402 17:58:41.501547 140139880466240 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/ckpt-450000.
I0402 17:58:41.514163 140139880466240 controller.py:252]  eval | step:  450000 | running 625 steps of evaluation...
I0402 18:02:57.233486 140139880466240 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0402 18:06:44.095574 140139880466240 controller.py:261]  eval | step:  450000 | eval time:  482.6 sec | output: 
    {'AP': 0.32522127,
     'AP50': 0.49658406,
     'AP75': 0.35103413,
     'APl': 0.46721795,
     'APm': 0.33013853,
     'APs': 0.1358772,
     'ARl': 0.55060554,
     'ARm': 0.42085925,
     'ARmax1': 0.27606934,
     'ARmax10': 0.39869887,
     'ARmax100': 0.40847304,
     'ARs': 0.18941522,
     'avg_iou_3': 0.4882979,
     'avg_iou_4': 0.70112395,
     'avg_iou_5': 0.7785423,
     'avg_obj_3': 0.33727086,
     'avg_obj_4': 0.6139147,
     'avg_obj_5': 0.7622318,
     'box_loss_3': 0.010775946,
     'box_loss_4': 0.010431517,
     'box_loss_5': 0.009281773,
     'class_loss_3': 0.003910111,
     'class_loss_4': 0.0041217194,
     'class_loss_5': 0.0040963893,
     'conf_loss_3': 0.02913056,
     'conf_loss_4': 0.033529878,
     'conf_loss_5': 0.026676498,
     'recall50_3': 0.34526917,
     'recall50_4': 0.6296452,
     'recall50_5': 0.7767511,
     'total_loss': 0.1319544,
     'validation_loss': 0.1319544}
I0402 18:07:07.860393 140139880466240 controller.py:211] train | step:  450000 | training until step 500000...
I0403 00:32:00.688065 140139880466240 controller.py:425] train | step:  500000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.690443,
     'avg_iou_4': 0.82937264,
     'avg_iou_5': 0.87536794,
     'avg_obj_3': 0.6390367,
     'avg_obj_4': 0.84545547,
     'avg_obj_5': 0.92915875,
     'box_loss_3': 0.016216625,
     'box_loss_4': 0.009203921,
     'box_loss_5': 0.007030523,
     'class_loss_3': 0.0039739767,
     'class_loss_4': 0.0025080312,
     'class_loss_5': 0.002153388,
     'conf_loss_3': 0.052712765,
     'conf_loss_4': 0.040578272,
     'conf_loss_5': 0.020028325,
     'learning_rate': 0.00039015914,
     'recall50_3': 0.6244076,
     'recall50_4': 0.8627147,
     'recall50_5': 0.9431282,
     'total_loss': 1.2352495,
     'training_loss': 1.2352495}
I0403 00:32:48.309697 140139880466240 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/ckpt-500000.
I0403 00:32:48.317114 140139880466240 controller.py:252]  eval | step:  500000 | running 625 steps of evaluation...
I0403 00:36:58.556024 140139880466240 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.556
 eval | step:  350000 | eval time:  482.8 sec | output: 
    {'AP': 0.33063346,
     'AP50': 0.5027718,
     'AP75': 0.35757518,
     'APl': 0.4714718,
     'APm': 0.33564597,
     'APs': 0.13683122,
     'ARl': 0.5564615,
     'ARm': 0.42556906,
     'ARmax1': 0.27755648,
     'ARmax10': 0.40306592,
     'ARmax100': 0.41347167,
     'ARs': 0.19654755,
     'avg_iou_3': 0.49104345,
     'avg_iou_4': 0.7047422,
     'avg_iou_5': 0.7812325,
     'avg_obj_3': 0.3360358,
     'avg_obj_4': 0.612442,
     'avg_obj_5': 0.7611044,
     'box_loss_3': 0.010626203,
     'box_loss_4': 0.010228262,
     'box_loss_5': 0.009120878,
     'class_loss_3': 0.0038112758,
     'class_loss_4': 0.003952392,
     'class_loss_5': 0.0038649049,
     'conf_loss_3': 0.028496576,
     'conf_loss_4': 0.032130007,
     'conf_loss_5': 0.025316833,
     'recall50_3': 0.34285036,
     'recall50_4': 0.6290336,
     'recall50_5': 0.7786102,
     'total_loss': 0.12754723,
     'validation_loss': 0.12754723}
train | step:  350000 | training until step 400000...
train | step:  400000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.6843133,
     'avg_iou_4': 0.8228788,
     'avg_iou_5': 0.86920154,
     'avg_obj_3': 0.6163186,
     'avg_obj_4': 0.82937294,
     'avg_obj_5': 0.9188774,
     'box_loss_3': 0.016545182,
     'box_loss_4': 0.009555547,
     'box_loss_5': 0.007376847,
     'class_loss_3': 0.0042245192,
     'class_loss_4': 0.0027105997,
     'class_loss_5': 0.002345385,
     'conf_loss_3': 0.054601874,
     'conf_loss_4': 0.041680213,
     'conf_loss_5': 0.020468688,
     'learning_rate': 0.0019869802,
     'recall50_3': 0.6005629,
     'recall50_4': 0.84884125,
     'recall50_5': 0.9357576,
     'total_loss': 1.2760679,
     'training_loss': 1.2760679}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/ckpt-400000.
 eval | step:  400000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=167.48s).
Accumulating evaluation results...
DONE (t=3.11s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.328
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.499
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.355
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.136
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.331
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.474
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.278
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.402
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.412
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.198
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.423
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.559
 eval | step:  400000 | eval time:  485.7 sec | output: 
    {'AP': 0.32825926,
     'AP50': 0.49888453,
     'AP75': 0.35521734,
     'APl': 0.47411796,
     'APm': 0.33127907,
     'APs': 0.136436,
     'ARl': 0.5588105,
     'ARm': 0.42258653,
     'ARmax1': 0.27816567,
     'ARmax10': 0.40220022,
     'ARmax100': 0.41243494,
     'ARs': 0.19765848,
     'avg_iou_3': 0.48957995,
     'avg_iou_4': 0.70279485,
     'avg_iou_5': 0.7797625,
     'avg_obj_3': 0.3365093,
     'avg_obj_4': 0.6131913,
     'avg_obj_5': 0.761326,
     'box_loss_3': 0.010708313,
     'box_loss_4': 0.010335452,
     'box_loss_5': 0.009208306,
     'class_loss_3': 0.0038846114,
     'class_loss_4': 0.00408856,
     'class_loss_5': 0.0040028696,
     'conf_loss_3': 0.028996073,
     'conf_loss_4': 0.032690614,
     'conf_loss_5': 0.026011378,
     'recall50_3': 0.3434775,
     'recall50_4': 0.62997425,
     'recall50_5': 0.7761565,
     'total_loss': 0.12992622,
     'validation_loss': 0.12992622}
train | step:  400000 | training until step 450000...
train | step:  450000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.6879125,
     'avg_iou_4': 0.82667524,
     'avg_iou_5': 0.8727602,
     'avg_obj_3': 0.6297225,
     'avg_obj_4': 0.8389578,
     'avg_obj_5': 0.92497295,
     'box_loss_3': 0.01635466,
     'box_loss_4': 0.009351065,
     'box_loss_5': 0.007176868,
     'class_loss_3': 0.004075253,
     'class_loss_4': 0.002592037,
     'class_loss_5': 0.0022314244,
     'conf_loss_3': 0.053521615,
     'conf_loss_4': 0.041080073,
     'conf_loss_5': 0.020189477,
     'learning_rate': 0.0010323825,
     'recall50_3': 0.6150858,
     'recall50_4': 0.85715127,
     'recall50_5': 0.9399317,
     'total_loss': 1.2525877,
     'training_loss': 1.2525877}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/ckpt-450000.
 eval | step:  450000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=164.58s).
Accumulating evaluation results...
DONE (t=3.12s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.325
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.497
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.351
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.136
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.330
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.467
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.276
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.399
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.408
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.189
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.421
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.551
 eval | step:  450000 | eval time:  482.6 sec | output: 
    {'AP': 0.32522127,
     'AP50': 0.49658406,
     'AP75': 0.35103413,
     'APl': 0.46721795,
     'APm': 0.33013853,
     'APs': 0.1358772,
     'ARl': 0.55060554,
     'ARm': 0.42085925,
     'ARmax1': 0.27606934,
     'ARmax10': 0.39869887,
     'ARmax100': 0.40847304,
     'ARs': 0.18941522,
     'avg_iou_3': 0.4882979,
     'avg_iou_4': 0.70112395,
     'avg_iou_5': 0.7785423,
     'avg_obj_3': 0.33727086,
     'avg_obj_4': 0.6139147,
     'avg_obj_5': 0.7622318,
     'box_loss_3': 0.010775946,
     'box_loss_4': 0.010431517,
     'box_loss_5': 0.009281773,
     'class_loss_3': 0.003910111,
     'class_loss_4': 0.0041217194,
     'class_loss_5': 0.0040963893,
     'conf_loss_3': 0.02913056,
     'conf_loss_4': 0.033529878,
     'conf_loss_5': 0.026676498,
     'recall50_3': 0.34526917,
     'recall50_4': 0.6296452,
     'recall50_5': 0.7767511,
     'total_loss': 0.1319544,
     'validation_loss': 0.1319544}
train | step:  450000 | training until step 500000...
train | step:  500000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.690443,
     'avg_iou_4': 0.82937264,
     'avg_iou_5': 0.87536794,
     'avg_obj_3': 0.6390367,
     'avg_obj_4': 0.84545547,
     'avg_obj_5': 0.92915875,
     'box_loss_3': 0.016216625,
     'box_loss_4': 0.009203921,
     'box_loss_5': 0.007030523,
     'class_loss_3': 0.0039739767,
     'class_loss_4': 0.0025080312,
     'class_loss_5': 0.002153388,
     'conf_loss_3': 0.052712765,
     'conf_loss_4': 0.040578272,
     'conf_loss_5': 0.020028325,
     'learning_rate': 0.00039015914,
     'recall50_3': 0.6244076,
     'recall50_4': 0.8627147,
     'recall50_5': 0.9431282,
     'total_loss': 1.2352495,
     'training_loss': 1.2352495}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/ckpt-500000.
 eval | step:  500000 | running 625 steps of evaluation...
creating index...I0403 00:40:43.284334 140139880466240 controller.py:261]  eval | step:  500000 | eval time:  475.0 sec | output: 
    {'AP': 0.32313886,
     'AP50': 0.49340996,
     'AP75': 0.35,
     'APl': 0.4687585,
     'APm': 0.32873353,
     'APs': 0.12981606,
     'ARl': 0.55431074,
     'ARm': 0.4169497,
     'ARmax1': 0.274739,
     'ARmax10': 0.39737502,
     'ARmax100': 0.4066282,
     'ARs': 0.18639842,
     'avg_iou_3': 0.4874433,
     'avg_iou_4': 0.7000292,
     'avg_iou_5': 0.7775595,
     'avg_obj_3': 0.3372171,
     'avg_obj_4': 0.6136528,
     'avg_obj_5': 0.7623221,
     'box_loss_3': 0.010827619,
     'box_loss_4': 0.010491846,
     'box_loss_5': 0.009338684,
     'class_loss_3': 0.0039751525,
     'class_loss_4': 0.0041817413,
     'class_loss_5': 0.004171765,
     'conf_loss_3': 0.029357629,
     'conf_loss_4': 0.03381732,
     'conf_loss_5': 0.027052432,
     'recall50_3': 0.34607115,
     'recall50_4': 0.6279463,
     'recall50_5': 0.77572966,
     'total_loss': 0.1332142,
     'validation_loss': 0.1332142}
I0403 00:40:59.178792 140139880466240 controller.py:211] train | step:  500000 | training until step 550000...
I0403 07:05:37.462947 140139880466240 controller.py:425] train | step:  550000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.69175214,
     'avg_iou_4': 0.83084744,
     'avg_iou_5': 0.8768266,
     'avg_obj_3': 0.6437706,
     'avg_obj_4': 0.84881896,
     'avg_obj_5': 0.93126357,
     'box_loss_3': 0.01614508,
     'box_loss_4': 0.009122285,
     'box_loss_5': 0.0069473437,
     'class_loss_3': 0.003920977,
     'class_loss_4': 0.0024663995,
     'class_loss_5': 0.002113099,
     'conf_loss_3': 0.05210334,
     'conf_loss_4': 0.040366165,
     'conf_loss_5': 0.019872932,
     'learning_rate': 0.00011024271,
     'recall50_3': 0.6291179,
     'recall50_4': 0.86567986,
     'recall50_5': 0.94453865,
     'total_loss': 1.2244694,
     'training_loss': 1.2244694}
I0403 07:06:26.679891 140139880466240 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/ckpt-550000.
I0403 07:06:26.686771 140139880466240 controller.py:252]  eval | step:  550000 | running 625 steps of evaluation...
I0403 07:10:34.696882 140139880466240 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0403 07:14:16.669625 140139880466240 controller.py:261]  eval | step:  550000 | eval time:  470.0 sec | output: 
    {'AP': 0.32367516,
     'AP50': 0.49363205,
     'AP75': 0.35126817,
     'APl': 0.47022328,
     'APm': 0.327918,
     'APs': 0.1281578,
     'ARl': 0.55544966,
     'ARm': 0.41754177,
     'ARmax1': 0.2752138,
     'ARmax10': 0.39776757,
     'ARmax100': 0.40706202,
     'ARs': 0.18563733,
     'avg_iou_3': 0.48719254,
     'avg_iou_4': 0.6996923,
     'avg_iou_5': 0.7775167,
     'avg_obj_3': 0.33674666,
     'avg_obj_4': 0.61416537,
     'avg_obj_5': 0.7620827,
     'box_loss_3': 0.010842039,
     'box_loss_4': 0.010509742,
     'box_loss_5': 0.009342462,
     'class_loss_3': 0.003980089,
     'class_loss_4': 0.0042034388,
     'class_loss_5': 0.004199223,
     'conf_loss_3': 0.02922595,
     'conf_loss_4': 0.033962276,
     'conf_loss_5': 0.027208779,
     'recall50_3': 0.3457514,
     'recall50_4': 0.6278522,
     'recall50_5': 0.77514064,
     'total_loss': 0.13347408,
     'validation_loss': 0.13347408}
I0403 07:14:36.296678 140139880466240 controller.py:211] train | step:  550000 | training until step 562500...
I0403 08:45:02.979052 140139880466240 controller.py:425] train | step:  562500 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.69201297,
     'avg_iou_4': 0.83127517,
     'avg_iou_5': 0.87727576,
     'avg_obj_3': 0.64507973,
     'avg_obj_4': 0.84970015,
     'avg_obj_5': 0.931846,
     'box_loss_3': 0.01612598,
     'box_loss_4': 0.009099565,
     'box_loss_5': 0.0069228327,
     'class_loss_3': 0.0039105606,
     'class_loss_4': 0.0024489758,
     'class_loss_5': 0.0020989117,
     'conf_loss_3': 0.051942304,
     'conf_loss_4': 0.04025908,
     'conf_loss_5': 0.019771269,
     'learning_rate': 1e-04,
     'recall50_3': 0.6308809,
     'recall50_4': 0.86641693,
     'recall50_5': 0.9447938,
     'total_loss': 1.2206334,
     'training_loss': 1.2206334}
I0403 08:45:19.212752 140139880466240 controller.py:252]  eval | step:  562500 | running 625 steps of evaluation...
I0403 08:49:27.861901 140139880466240 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0403 08:53:40.612822 140139880466240 controller.py:261]  eval | step:  562500 | eval time:  501.4 sec | output: 
    {'AP': 0.32381704,
     'AP50': 0.49331626,
     'AP75': 0.35218403,
     'APl': 0.47039953,
     'APm': 0.3278893,
     'APs': 0.13024151,
     'ARl': 0.55679846,
     'ARm': 0.41760725,
     'ARmax1': 0.27560666,
     'ARmax10': 0.39808893,
     'ARmax100': 0.40748182,
     'ARs': 0.18600999,
     'avg_iou_3': 0.48698896,
     'avg_iou_4': 0.6996094,
     'avg_iou_5': 0.77748173,
     'avg_obj_3': 0.33737212,
     'avg_obj_4': 0.61441875,
     'avg_obj_5': 0.76253825,
     'box_loss_3': 0.010854403,
     'box_loss_4': 0.0105153,
     'box_loss_5': 0.0093455445,
     'class_loss_3': 0.0039862986,
     'class_loss_4': 0.0042120386,
     'class_loss_5': 0.0042015556,
     'conf_loss_3': 0.029313397,
     'conf_loss_4': 0.034050055,
     'conf_loss_5': 0.027274646,
     'recall50_3': 0.34608147,
     'recall50_4': 0.62716585,
     'recall50_5': 0.775473,
     'total_loss': 0.13375324,
     'validation_loss': 0.13375324}
I0403 08:54:39.541672 140139880466240 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/ckpt-562500.

index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=164.78s).
Accumulating evaluation results...
DONE (t=3.06s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.323
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.493
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.350
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.130
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.329
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.469
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.275
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.397
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.407
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.186
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.417
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.554
 eval | step:  500000 | eval time:  475.0 sec | output: 
    {'AP': 0.32313886,
     'AP50': 0.49340996,
     'AP75': 0.35,
     'APl': 0.4687585,
     'APm': 0.32873353,
     'APs': 0.12981606,
     'ARl': 0.55431074,
     'ARm': 0.4169497,
     'ARmax1': 0.274739,
     'ARmax10': 0.39737502,
     'ARmax100': 0.4066282,
     'ARs': 0.18639842,
     'avg_iou_3': 0.4874433,
     'avg_iou_4': 0.7000292,
     'avg_iou_5': 0.7775595,
     'avg_obj_3': 0.3372171,
     'avg_obj_4': 0.6136528,
     'avg_obj_5': 0.7623221,
     'box_loss_3': 0.010827619,
     'box_loss_4': 0.010491846,
     'box_loss_5': 0.009338684,
     'class_loss_3': 0.0039751525,
     'class_loss_4': 0.0041817413,
     'class_loss_5': 0.004171765,
     'conf_loss_3': 0.029357629,
     'conf_loss_4': 0.03381732,
     'conf_loss_5': 0.027052432,
     'recall50_3': 0.34607115,
     'recall50_4': 0.6279463,
     'recall50_5': 0.77572966,
     'total_loss': 0.1332142,
     'validation_loss': 0.1332142}
train | step:  500000 | training until step 550000...
train | step:  550000 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.69175214,
     'avg_iou_4': 0.83084744,
     'avg_iou_5': 0.8768266,
     'avg_obj_3': 0.6437706,
     'avg_obj_4': 0.84881896,
     'avg_obj_5': 0.93126357,
     'box_loss_3': 0.01614508,
     'box_loss_4': 0.009122285,
     'box_loss_5': 0.0069473437,
     'class_loss_3': 0.003920977,
     'class_loss_4': 0.0024663995,
     'class_loss_5': 0.002113099,
     'conf_loss_3': 0.05210334,
     'conf_loss_4': 0.040366165,
     'conf_loss_5': 0.019872932,
     'learning_rate': 0.00011024271,
     'recall50_3': 0.6291179,
     'recall50_4': 0.86567986,
     'recall50_5': 0.94453865,
     'total_loss': 1.2244694,
     'training_loss': 1.2244694}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/ckpt-550000.
 eval | step:  550000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=165.33s).
Accumulating evaluation results...
DONE (t=3.02s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.324
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.494
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.351
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.128
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.328
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.470
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.275
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.398
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.407
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.186
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.418
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.555
 eval | step:  550000 | eval time:  470.0 sec | output: 
    {'AP': 0.32367516,
     'AP50': 0.49363205,
     'AP75': 0.35126817,
     'APl': 0.47022328,
     'APm': 0.327918,
     'APs': 0.1281578,
     'ARl': 0.55544966,
     'ARm': 0.41754177,
     'ARmax1': 0.2752138,
     'ARmax10': 0.39776757,
     'ARmax100': 0.40706202,
     'ARs': 0.18563733,
     'avg_iou_3': 0.48719254,
     'avg_iou_4': 0.6996923,
     'avg_iou_5': 0.7775167,
     'avg_obj_3': 0.33674666,
     'avg_obj_4': 0.61416537,
     'avg_obj_5': 0.7620827,
     'box_loss_3': 0.010842039,
     'box_loss_4': 0.010509742,
     'box_loss_5': 0.009342462,
     'class_loss_3': 0.003980089,
     'class_loss_4': 0.0042034388,
     'class_loss_5': 0.004199223,
     'conf_loss_3': 0.02922595,
     'conf_loss_4': 0.033962276,
     'conf_loss_5': 0.027208779,
     'recall50_3': 0.3457514,
     'recall50_4': 0.6278522,
     'recall50_5': 0.77514064,
     'total_loss': 0.13347408,
     'validation_loss': 0.13347408}
train | step:  550000 | training until step 562500...
train | step:  562500 | steps/sec:    2.1 | output: 
    {'avg_iou_3': 0.69201297,
     'avg_iou_4': 0.83127517,
     'avg_iou_5': 0.87727576,
     'avg_obj_3': 0.64507973,
     'avg_obj_4': 0.84970015,
     'avg_obj_5': 0.931846,
     'box_loss_3': 0.01612598,
     'box_loss_4': 0.009099565,
     'box_loss_5': 0.0069228327,
     'class_loss_3': 0.0039105606,
     'class_loss_4': 0.0024489758,
     'class_loss_5': 0.0020989117,
     'conf_loss_3': 0.051942304,
     'conf_loss_4': 0.04025908,
     'conf_loss_5': 0.019771269,
     'learning_rate': 1e-04,
     'recall50_3': 0.6308809,
     'recall50_4': 0.86641693,
     'recall50_5': 0.9447938,
     'total_loss': 1.2206334,
     'training_loss': 1.2206334}
 eval | step:  562500 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=192.50s).
Accumulating evaluation results...
DONE (t=3.37s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.324
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.493
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.352
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.130
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.328
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.470
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.276
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.398
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.407
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.186
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.418
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.557
 eval | step:  562500 | eval time:  501.4 sec | output: 
    {'AP': 0.32381704,
     'AP50': 0.49331626,
     'AP75': 0.35218403,
     'APl': 0.47039953,
     'APm': 0.3278893,
     'APs': 0.13024151,
     'ARl': 0.55679846,
     'ARm': 0.41760725,
     'ARmax1': 0.27560666,
     'ARmax10': 0.39808893,
     'ARmax100': 0.40748182,
     'ARs': 0.18600999,
     'avg_iou_3': 0.48698896,
     'avg_iou_4': 0.6996094,
     'avg_iou_5': 0.77748173,
     'avg_obj_3': 0.33737212,
     'avg_obj_4': 0.61441875,
     'avg_obj_5': 0.76253825,
     'box_loss_3': 0.010854403,
     'box_loss_4': 0.0105153,
     'box_loss_5': 0.0093455445,
     'class_loss_3': 0.0039862986,
     'class_loss_4': 0.0042120386,
     'class_loss_5': 0.0042015556,
     'conf_loss_3': 0.029313397,
     'conf_loss_4': 0.034050055,
     'conf_loss_5': 0.027274646,
     'recall50_3': 0.34608147,
     'recall50_4': 0.62716585,
     'recall50_5': 0.775473,
     'total_loss': 0.13375324,
     'validation_loss': 0.13375324}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-300-epochs-csp-cosine/ckpt-562500.I0403 08:54:39.569533 140139880466240 train_lib.py:123] Number of trainable params in model: 53.066944 Millions.

  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   247    0     2  100   245     11   1441 --:--:-- --:--:-- --:--:--  1452
okRequest issued for: [node-5]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-03T08:54:52.876928471Z'
  endTime: '2021-04-03T08:55:44.858020131Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617440092862-5bf0d9e2e38c0-f9478521-ce23b950
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617440092862-5bf0d9e2e38c0-f9478521-ce23b950] to complete...
.............................................................................................................................................................................................................................................................................done.
