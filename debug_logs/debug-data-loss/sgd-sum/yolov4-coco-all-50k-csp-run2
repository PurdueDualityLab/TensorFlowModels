cat: .experiment_zone: No such file or directory
ERROR: (gcloud.compute.tpus.start) INVALID_ARGUMENT: StartNode is not supported when state is STARTING
europe-west4-a
I0401 06:19:45.623305 140431405815616 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.2,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': True,
                                                     '4': True,
                                                     '5': True},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 0.75,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.75,
                                    'aug_rand_transalate': 0.0,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_boxes': 0.1,
                                    'jitter_im': 0.3,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'max_process_size': 608,
                                    'min_process_size': 320,
                                    'mosaic': {'crop_area': [0.5, 1.0],
                                               'crop_area_mosaic': [0.3, 0.3],
                                               'mosaic_frequency': 1.0,
                                               'output_size': [640, 640],
                                               'random_crop': False,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'aug_rand_angle': 2.0,
                                         'aug_rand_brightness': 0.75,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.75,
                                         'aug_rand_transalate': 0.0,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_boxes': 0.1,
                                         'jitter_im': 0.3,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'max_process_size': 608,
                                         'min_process_size': 320,
                                         'mosaic': {'crop_area': [0.5, 1.0],
                                                    'crop_area_mosaic': [0.3,
                                                                         0.3],
                                                    'mosaic_frequency': 0.75,
                                                    'output_size': [640, 640],
                                                    'random_crop': False,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 5000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': None,
                                  'learning_rate': {'stepwise': {'boundaries': [50000,
                                                                                56250],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00261,
                                                                            0.000261,
                                                                            2.61e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 62500,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 5000,
             'validation_steps': 625}}
I0401 06:19:45.624296 140431405815616 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/params.yaml
I0401 06:19:47.324162 140431405815616 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0401 06:19:47.939281 140431405815616 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0401 06:19:47.939573 140431405815616 transport.py:157] Attempting refresh to obtain initial access_token
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 140, in main
    tpu_address=params.runtime.tpu)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 139, in get_distribution_strategy
    cluster_resolver = tpu_initialize(tpu_address)
  File "/home/cam2tensorflow/TensorFlowModels/official/common/distribute_utils.py", line 88, in tpu_initialize
    tf.config.experimental_connect_to_cluster(cluster_resolver)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/remote.py", line 145, in connect_to_cluster
    if cluster_spec_or_resolver.master() in _LOCAL_MASTERS:
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 257, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu/tpu_cluster_resolver.py", line 331, in cluster_spec
    network_endpoints = self._cloud_tpu_client.network_endpoints()
  File "/usr/local/lib/python3.7/dist-packages/cloud_tpu_client/client.py", line 324, in network_endpoints
    (self._tpu, response.get('state')))
RuntimeError: TPU "node-6" is not yet ready; state: "STARTING"
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': True, '4': True, '5': True}, 'use_nms': True, 'iou_thresh': 0.2, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 320, 'max_process_size': 608, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'jitter_boxes': 0.1, 'aug_rand_transalate': 0.0, 'aug_rand_saturation': 0.75, 'aug_rand_brightness': 0.75, 'aug_rand_zoom': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 1.0, 'crop_area': [0.5, 1.0], 'crop_area_mosaic': [0.3, 0.3], 'random_crop': False, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 320, 'max_process_size': 608, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'jitter_boxes': 0.1, 'aug_rand_transalate': 0.0, 'aug_rand_saturation': 0.75, 'aug_rand_brightness': 0.75, 'aug_rand_zoom': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_angle': 2.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.75, 'crop_area': [0.5, 1.0], 'crop_area_mosaic': [0.3, 0.3], 'random_crop': False, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': None, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [50000, 56250], 'values': [0.00261, 0.000261, 2.61e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 5000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 62500, 'validation_steps': 625, 'validation_interval': 5000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   233    0     2  100   231     12   1417 --:--:-- --:--:-- --:--:--  1420100   233    0     2  100   231     12   1408 --:--:-- --:--:-- --:--:--  1412
okERROR: (gcloud.compute.tpus.stop) ABORTED: unable to queue the operation
- '@type': type.googleapis.com/google.rpc.ResourceInfo
  resourceName: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
cat: .experiment_zone: No such file or directory
Request issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-01T06:33:47.711908525Z'
  endTime: '2021-04-01T06:34:20.078924786Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617258827695-5bee369ef4574-0be2ecb4-dcdeb875
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617258827695-5bee369ef4574-0be2ecb4-dcdeb875] to complete...
..................................................................................................................................................................................................done.
europe-west4-a
I0401 06:34:29.526250 140537942914880 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.2,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': True,
                                                     '4': True,
                                                     '5': True},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 0.75,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.75,
                                    'aug_rand_transalate': 0.0,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_boxes': 0.1,
                                    'jitter_im': 0.3,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'max_process_size': 608,
                                    'min_process_size': 320,
                                    'mosaic': {'crop_area': [0.5, 1.0],
                                               'crop_area_mosaic': [0.3, 0.3],
                                               'mosaic_frequency': 1.0,
                                               'output_size': [640, 640],
                                               'random_crop': False,
                                               'random_crop_mosaic': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': False,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'aug_rand_angle': 2.0,
                                         'aug_rand_brightness': 0.75,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.75,
                                         'aug_rand_transalate': 0.0,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_boxes': 0.1,
                                         'jitter_im': 0.3,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'max_process_size': 608,
                                         'min_process_size': 320,
                                         'mosaic': {'crop_area': [0.5, 1.0],
                                                    'crop_area_mosaic': [0.3,
                                                                         0.3],
                                                    'mosaic_frequency': 0.75,
                                                    'output_size': [640, 640],
                                                    'random_crop': False,
                                                    'random_crop_mosaic': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': False,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 5000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': None,
                                  'learning_rate': {'stepwise': {'boundaries': [50000,
                                                                                56250],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00261,
                                                                            0.000261,
                                                                            2.61e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 62500,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 5000,
             'validation_steps': 625}}
I0401 06:34:29.527480 140537942914880 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/params.yaml
I0401 06:34:30.428626 140537942914880 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0401 06:34:31.044558 140537942914880 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0401 06:34:31.044892 140537942914880 transport.py:157] Attempting refresh to obtain initial access_token
I0401 06:34:31.106615 140537942914880 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0401 06:34:31.726526 140537942914880 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0401 06:34:31.726784 140537942914880 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-01 06:34:31.771347: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0401 06:34:31.771945 140537942914880 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0401 06:34:31.914891 140537942914880 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0401 06:34:31.915173 140537942914880 transport.py:157] Attempting refresh to obtain initial access_token
I0401 06:34:31.965771 140537942914880 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0401 06:34:32.580499 140537942914880 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0401 06:34:32.580774 140537942914880 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-01 06:34:32.623017: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-01 06:34:32.651710: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-01 06:34:32.651977: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:54972}
2021-04-01 06:35:05.436025: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-01 06:35:05.436106: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:54972}
2021-04-01 06:35:05.437166: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:54972
I0401 06:35:05.438753 140537942914880 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-6
I0401 06:35:05.439826 140537942914880 tpu_strategy_util.py:74] Initializing the TPU system: node-6
INFO:tensorflow:Clearing out eager caches
I0401 06:35:14.101818 140537942914880 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0401 06:35:14.104105 140537942914880 tpu_strategy_util.py:133] Finished initializing TPU system.
I0401 06:35:14.105339 140537942914880 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0401 06:35:14.725174 140537942914880 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0401 06:35:14.725454 140537942914880 transport.py:157] Attempting refresh to obtain initial access_token
I0401 06:35:14.783067 140537942914880 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0401 06:35:14.922298 140537942914880 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0401 06:35:14.922542 140537942914880 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0401 06:35:14.987498 140537942914880 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0401 06:35:14.987742 140537942914880 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0401 06:35:14.988081 140537942914880 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0401 06:35:14.988134 140537942914880 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0401 06:35:14.988181 140537942914880 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0401 06:35:14.988306 140537942914880 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0401 06:35:14.988356 140537942914880 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0401 06:35:14.988404 140537942914880 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0401 06:35:14.988447 140537942914880 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0401 06:35:14.988490 140537942914880 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0401 06:35:14.988533 140537942914880 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0401 06:35:14.988575 140537942914880 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0401 06:35:14.988616 140537942914880 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0401 06:35:14.988723 140537942914880 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0401 06:35:14.988767 140537942914880 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0401 06:35:14.988811 140537942914880 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0401 06:35:15.023308 140537942914880 train_utils.py:214] Running default trainer.
2021-04-01 06:35:15.031205: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': True, '4': True, '5': True}, 'use_nms': True, 'iou_thresh': 0.2, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 320, 'max_process_size': 608, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'jitter_boxes': 0.1, 'aug_rand_transalate': 0.0, 'aug_rand_saturation': 0.75, 'aug_rand_brightness': 0.75, 'aug_rand_zoom': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 1.0, 'crop_area': [0.5, 1.0], 'crop_area_mosaic': [0.3, 0.3], 'random_crop': False, 'random_crop_mosaic': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 320, 'max_process_size': 608, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'jitter_boxes': 0.1, 'aug_rand_transalate': 0.0, 'aug_rand_saturation': 0.75, 'aug_rand_brightness': 0.75, 'aug_rand_zoom': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_angle': 2.0, 'use_tie_breaker': True, 'use_scale_xy': False, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.75, 'crop_area': [0.5, 1.0], 'crop_area_mosaic': [0.3, 0.3], 'random_crop': False, 'random_crop_mosaic': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': None, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [50000, 56250], 'values': [0.00261, 0.000261, 2.61e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 5000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 62500, 'validation_steps': 625, 'validation_interval': 5000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': True, '4': True, '5': True}, 'use_nms': True, 'iou_thresh': 0.2, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7fd12451deb8>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
route_split 512.0 512.0
conv2 512.0
conv1 512.0
spp
conv1 512.0
conv2 512.0
connect
conv1 512.0
8
(None, 16, 16, 512) (None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 2048)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 1024)
(None, 16, 16, 512)
route_split 256.0 256.0
conv2 256.0
conv1 256.0
conv2 256.0
connect
conv1 256.0
6
(None, 32, 32, 256) (None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 32, 32, 256)








 ListWrapper([128, 256, 512])
route_split 128 128
conv2 128
conv1 128
conv2 128
connect
conv1 128
conv2 256
7
(None, 64, 64, 128) (None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 256)
(None, 64, 64, 128)
(None, 64, 64, 256)
route_split 256 256
conv2 256
conv1 256
conv2 256
connect
conv1 256
conv2 512
7
(None, 32, 32, 256) (None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 32, 32, 256)
(None, 32, 32, 512)
route_split 512 512
conv2 512
conv1 512
conv2 512
connect
conv1 512
conv2 1024
7
(None, 16, 16, 512) (None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 1024)
(None, 16, 16, 512)
(None, 16, 16, 1024)
detget {'3': 2.0, '4': 2.0, '5': 2.0}
(None, 16, 16, 512) (None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 2048)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 1024)
(None, 16, 16, 512)
(None, 32, 32, 256) (None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 32, 32, 256)
(None, 64, 64, 128) (None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 256)
(None, 64, 64, 128)
(None, 64, 64, 256)I0401 06:35:56.226639 140537942914880 controller.py:362] restoring or initializing model...
I0401 06:36:04.355991 140537942914880 yolo.py:459] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0401 06:36:04.357844 140537942914880 controller.py:368] initialized model.
I0401 06:36:04.358124 140537942914880 train_lib.py:96] Starts to execute mode: train_and_eval
I0401 06:36:04.363288 140537942914880 controller.py:211] train | step:      0 | training until step 5000...
I0401 06:36:11.815224 140537942914880 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0401 06:36:58.753027 140537942914880 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0401 07:25:56.109599 140537942914880 controller.py:425] train | step:   5000 | steps/sec:    1.7 | output: 
    {'avg_iou_3': 0.53779364,
     'avg_iou_4': 0.6112359,
     'avg_iou_5': 0.6165031,
     'avg_obj_3': 0.09142955,
     'avg_obj_4': 0.1580871,
     'avg_obj_5': 0.22882272,
     'box_loss_3': 0.1967164,
     'box_loss_4': 0.16523363,
     'box_loss_5': 0.16690922,
     'class_loss_3': 0.40621623,
     'class_loss_4': 0.36950883,
     'class_loss_5': 0.32731035,
     'conf_loss_3': 1.0628697,
     'conf_loss_4': 0.38173464,
     'conf_loss_5': 0.206872,
     'learning_rate': 0.00261,
     'recall50_3': 0.03825548,
     'recall50_4': 0.08480938,
     'recall50_5': 0.15752897,
     'total_loss': 3.2833622,
     'training_loss': 3.2833622}
I0401 07:26:38.530913 140537942914880 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-5000.
I0401 07:26:38.537264 140537942914880 controller.py:252]  eval | step:   5000 | running 625 steps of evaluation...
I0401 07:26:44.056666 140537942914880 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0401 07:31:23.207256 140537942914880 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0401 07:35:07.242721 140537942914880 controller.py:261]  eval | step:   5000 | eval time:  508.7 sec | output: 
    {'AP': 0.07880779,
     'AP50': 0.1681116,
     'AP75': 0.06219004,
     'APl': 0.10097529,
     'APm': 0.091541745,
     'APs': 0.02012975,
     'ARl': 0.1272797,
     'ARm': 0.14263768,
     'ARmax1': 0.07955784,
     'ARmax10': 0.11527132,
     'ARmax100': 0.11759424,
     'ARs': 0.035705518,
     'avg_iou_3': 0.45661303,
     'avg_iou_4': 0.6233231,
     'avg_iou_5': 0.66975635,
     'avg_obj_3': 0.10157514,
     'avg_obj_4': 0.18682842,
     'avg_obj_5': 0.2248848,
     'box_loss_3': 0.012341793,
     'box_loss_4': 0.014332486,
     'box_loss_5': 0.01486284,
     'class_loss_3': 0.007883677,
     'class_loss_4': 0.008669585,
     'class_loss_5': 0.008481849,
     'conf_loss_3': 0.009400375,
     'conf_loss_4': 0.0081629725,
     'conf_loss_5': 0.006741259,
     'recall50_3': 0.05271485,
     'recall50_4': 0.12642713,
     'recall50_5': 0.17381646,
     'total_loss': 0.09087686,
     'validation_loss': 0.09087686}
I0401 07:35:33.245901 140537942914880 controller.py:211] train | step:   5000 | training until step 10000...

(None, 32, 32, 256) (None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 16, 16, 512) (None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 1024)
(None, 16, 16, 512)
(None, 16, 16, 1024)
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4), num_detections: (8,), upds: {3: (8, 200, 8), 4: (8, 200, 8), 5: (8, 200, 8)}, inds: {3: (8, 200, 3), 4: (8, 200, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 5000...
(8, 16, 16, 512) (8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 2048)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 1024)
(8, 16, 16, 512)
(8, 32, 32, 256) (8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 512)
(8, 32, 32, 256)
(8, 64, 64, 128) (8, 64, 64, 128)
(8, 64, 64, 128)
(8, 64, 64, 128)
(8, 64, 64, 128)
(8, 64, 64, 256)
(8, 64, 64, 128)
(8, 64, 64, 256)
(8, 32, 32, 256) (8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 512)
(8, 32, 32, 256)
(8, 32, 32, 512)
(8, 16, 16, 512) (8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 1024)
(8, 16, 16, 512)
(8, 16, 16, 1024)
(8, 16, 16, 512) (8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 2048)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 1024)
(8, 16, 16, 512)
(8, 32, 32, 256) (8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 512)
(8, 32, 32, 256)
(8, 64, 64, 128) (8, 64, 64, 128)
(8, 64, 64, 128)
(8, 64, 64, 128)
(8, 64, 64, 128)
(8, 64, 64, 256)
(8, 64, 64, 128)
(8, 64, 64, 256)
(8, 32, 32, 256) (8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 512)
(8, 32, 32, 256)
(8, 32, 32, 512)
(8, 16, 16, 512) (8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 1024)
(8, 16, 16, 512)
(8, 16, 16, 1024)
train | step:   5000 | steps/sec:    1.7 | output: 
    {'avg_iou_3': 0.53779364,
     'avg_iou_4': 0.6112359,
     'avg_iou_5': 0.6165031,
     'avg_obj_3': 0.09142955,
     'avg_obj_4': 0.1580871,
     'avg_obj_5': 0.22882272,
     'box_loss_3': 0.1967164,
     'box_loss_4': 0.16523363,
     'box_loss_5': 0.16690922,
     'class_loss_3': 0.40621623,
     'class_loss_4': 0.36950883,
     'class_loss_5': 0.32731035,
     'conf_loss_3': 1.0628697,
     'conf_loss_4': 0.38173464,
     'conf_loss_5': 0.206872,
     'learning_rate': 0.00261,
     'recall50_3': 0.03825548,
     'recall50_4': 0.08480938,
     'recall50_5': 0.15752897,
     'total_loss': 3.2833622,
     'training_loss': 3.2833622}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-5000.
 eval | step:   5000 | running 625 steps of evaluation...
(1, 16, 16, 512) (1, 16, 16, 512)
(1, 16, 16, 512)
(1, 16, 16, 512)
(1, 16, 16, 2048)
(1, 16, 16, 512)
(1, 16, 16, 512)
(1, 16, 16, 1024)
(1, 16, 16, 512)
(1, 32, 32, 256) (1, 32, 32, 256)
(1, 32, 32, 256)
(1, 32, 32, 256)
(1, 32, 32, 256)
(1, 32, 32, 512)
(1, 32, 32, 256)
(1, 64, 64, 128) (1, 64, 64, 128)
(1, 64, 64, 128)
(1, 64, 64, 128)
(1, 64, 64, 128)
(1, 64, 64, 256)
(1, 64, 64, 128)
(1, 64, 64, 256)
(1, 32, 32, 256) (1, 32, 32, 256)
(1, 32, 32, 256)
(1, 32, 32, 256)
(1, 32, 32, 256)
(1, 32, 32, 512)
(1, 32, 32, 256)
(1, 32, 32, 512)
(1, 16, 16, 512) (1, 16, 16, 512)
(1, 16, 16, 512)
(1, 16, 16, 512)
(1, 16, 16, 512)
(1, 16, 16, 1024)
(1, 16, 16, 512)
(1, 16, 16, 1024)
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=168.06s).
Accumulating evaluation results...
DONE (t=2.30s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.079
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.168
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.062
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.020
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.092
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.101
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.080
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.115
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.118
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.036
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.143
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.127
 eval | step:   5000 | eval time:  508.7 sec | output: 
    {'AP': 0.07880779,
     'AP50': 0.1681116,
     'AP75': 0.06219004,
     'APl': 0.10097529,
     'APm': 0.091541745,
     'APs': 0.02012975,
     'ARl': 0.1272797,
     'ARm': 0.14263768,
     'ARmax1': 0.07955784,
     'ARmax10': 0.11527132,
     'ARmax100': 0.11759424,
     'ARs': 0.035705518,
     'avg_iou_3': 0.45661303,
     'avg_iou_4': 0.6233231,
     'avg_iou_5': 0.66975635,
     'avg_obj_3': 0.10157514,
     'avg_obj_4': 0.18682842,
     'avg_obj_5': 0.2248848,
     'box_loss_3': 0.012341793,
     'box_loss_4': 0.014332486,
     'box_loss_5': 0.01486284,
     'class_loss_3': 0.007883677,
     'class_loss_4': 0.008669585,
     'class_loss_5': 0.008481849,
     'conf_loss_3': 0.009400375,
     'conf_loss_4': 0.0081629725,
     'conf_loss_5': 0.006741259,
     'recall50_3': 0.05271485,
     'recall50_4': 0.12642713,
     'recall50_5': 0.17381646,
     'total_loss': 0.09087686,
     'validation_loss': 0.09087686}
train | step:   5000 | training until step 10000...I0401 08:22:35.094291 140537942914880 controller.py:425] train | step:  10000 | steps/sec:    1.5 | output: 
    {'avg_iou_3': 0.6127362,
     'avg_iou_4': 0.7124707,
     'avg_iou_5': 0.74760437,
     'avg_obj_3': 0.12129001,
     'avg_obj_4': 0.22907825,
     'avg_obj_5': 0.33557668,
     'box_loss_3': 0.16416806,
     'box_loss_4': 0.122111745,
     'box_loss_5': 0.11023896,
     'class_loss_3': 0.08997215,
     'class_loss_4': 0.06881663,
     'class_loss_5': 0.05985695,
     'conf_loss_3': 0.1819839,
     'conf_loss_4': 0.14997931,
     'conf_loss_5': 0.088356,
     'learning_rate': 0.00261,
     'recall50_3': 0.05307843,
     'recall50_4': 0.16671878,
     'recall50_5': 0.31238812,
     'total_loss': 1.0354818,
     'training_loss': 1.0354818}
I0401 08:23:20.930306 140537942914880 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-10000.
I0401 08:23:20.936332 140537942914880 controller.py:252]  eval | step:  10000 | running 625 steps of evaluation...
I0401 08:27:23.523615 140537942914880 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0401 08:31:09.259295 140537942914880 controller.py:261]  eval | step:  10000 | eval time:  468.3 sec | output: 
    {'AP': 0.14872299,
     'AP50': 0.2779428,
     'AP75': 0.14568366,
     'APl': 0.20026684,
     'APm': 0.17027742,
     'APs': 0.044418663,
     'ARl': 0.25676733,
     'ARm': 0.239364,
     'ARmax1': 0.14127955,
     'ARmax10': 0.20334111,
     'ARmax100': 0.2071669,
     'ARs': 0.06705777,
     'avg_iou_3': 0.46483058,
     'avg_iou_4': 0.66277856,
     'avg_iou_5': 0.7213105,
     'avg_obj_3': 0.10491395,
     'avg_obj_4': 0.22324213,
     'avg_obj_5': 0.30226058,
     'box_loss_3': 0.011881639,
     'box_loss_4': 0.012212949,
     'box_loss_5': 0.0121063655,
     'class_loss_3': 0.0062058535,
     'class_loss_4': 0.0065624113,
     'class_loss_5': 0.006464938,
     'conf_loss_3': 0.008337129,
     'conf_loss_4': 0.0076586874,
     'conf_loss_5': 0.006549835,
     'recall50_3': 0.063802004,
     'recall50_4': 0.1792133,
     'recall50_5': 0.28060836,
     'total_loss': 0.07797979,
     'validation_loss': 0.07797979}
I0401 08:31:34.371014 140537942914880 controller.py:211] train | step:  10000 | training until step 15000...
I0401 09:21:23.018646 140537942914880 controller.py:425] train | step:  15000 | steps/sec:    1.4 | output: 
    {'avg_iou_3': 0.6317629,
     'avg_iou_4': 0.7386084,
     'avg_iou_5': 0.77608144,
     'avg_obj_3': 0.14039265,
     'avg_obj_4': 0.26234633,
     'avg_obj_5': 0.37642547,
     'box_loss_3': 0.15606801,
     'box_loss_4': 0.11114498,
     'box_loss_5': 0.09793715,
     'class_loss_3': 0.07512176,
     'class_loss_4': 0.055869244,
     'class_loss_5': 0.048860922,
     'conf_loss_3': 0.17791462,
     'conf_loss_4': 0.14482701,
     'conf_loss_5': 0.08446312,
     'learning_rate': 0.00261,
     'recall50_3': 0.07153701,
     'recall50_4': 0.21297878,
     'recall50_5': 0.37466088,
     'total_loss': 0.9522073,
     'training_loss': 0.9522073}
I0401 09:22:03.699625 140537942914880 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-15000.
I0401 09:22:03.706127 140537942914880 controller.py:252]  eval | step:  15000 | running 625 steps of evaluation...
I0401 09:26:03.303718 140537942914880 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0401 09:29:57.540617 140537942914880 controller.py:261]  eval | step:  15000 | eval time:  473.8 sec | output: 
    {'AP': 0.17761593,
     'AP50': 0.3176494,
     'AP75': 0.18050255,
     'APl': 0.23904343,
     'APm': 0.20717406,
     'APs': 0.0584673,
     'ARl': 0.29436368,
     'ARm': 0.27992153,
     'ARmax1': 0.16225792,
     'ARmax10': 0.23355891,
     'ARmax100': 0.23864506,
     'ARs': 0.08664945,
     'avg_iou_3': 0.47356695,
     'avg_iou_4': 0.675693,
     'avg_iou_5': 0.72940516,
     'avg_obj_3': 0.11772456,
     'avg_obj_4': 0.24021935,
     'avg_obj_5': 0.29635885,
     'box_loss_3': 0.011417213,
     'box_loss_4': 0.011573519,
     'box_loss_5': 0.011645332,
     'class_loss_3': 0.00535468,
     'class_loss_4': 0.005675973,
     'class_loss_5': 0.0057798647,
     'conf_loss_3': 0.008309726,
     'conf_loss_4': 0.0074704885,
     'conf_loss_5': 0.0064041056,
     'recall50_3': 0.07331259,
     'recall50_4': 0.20678489,
     'recall50_5': 0.27519876,
     'total_loss': 0.07363089,
     'validation_loss': 0.07363089}
I0401 09:30:20.753905 140537942914880 controller.py:211] train | step:  15000 | training until step 20000...
I0401 10:20:37.636229 140537942914880 controller.py:425] train | step:  20000 | steps/sec:    1.4 | output: 
    {'avg_iou_3': 0.6433965,
     'avg_iou_4': 0.75393045,
     'avg_iou_5': 0.7919989,
     'avg_obj_3': 0.15388787,
     'avg_obj_4': 0.28522718,
     'avg_obj_5': 0.40374246,
     'box_loss_3': 0.15113647,
     'box_loss_4': 0.10464833,
     'box_loss_5': 0.09106319,
     'class_loss_3': 0.06751877,
     'class_loss_4': 0.048807856,
     'class_loss_5': 0.042789735,
     'conf_loss_3': 0.1750941,
     'conf_loss_4': 0.14112414,
     'conf_loss_5': 0.0816905,
     'learning_rate': 0.00261,
     'recall50_3': 0.08579929,
     'recall50_4': 0.24487129,
     'recall50_5': 0.41451827,
     'total_loss': 0.9038741,
     'training_loss': 0.9038741}
I0401 10:21:24.254449 140537942914880 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-20000.
I0401 10:21:24.259985 140537942914880 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0401 10:25:21.780881 140537942914880 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0401 10:29:03.646762 140537942914880 controller.py:261]  eval | step:  20000 | eval time:  459.4 sec | output: 
    {'AP': 0.1918594,
     'AP50': 0.34191883,
     'AP75': 0.19751951,
     'APl': 0.24671088,
     'APm': 0.22657482,
     'APs': 0.07131835,
     'ARl': 0.2975488,
     'ARm': 0.29879263,
     'ARmax1': 0.17217383,
     'ARmax10': 0.24758296,
     'ARmax100': 0.25232163,
     'ARs': 0.10125101,
     'avg_iou_3': 0.48649976,
     'avg_iou_4': 0.6859155,
     'avg_iou_5': 0.7327373,
     'avg_obj_3': 0.13638435,
     'avg_obj_4': 0.25126857,
     'avg_obj_5': 0.31378087,
     'box_loss_3': 0.010753223,
     'box_loss_4': 0.011042278,
     'box_loss_5': 0.011501741,
     'class_loss_3': 0.004951206,
     'class_loss_4': 0.0053341757,
     'class_loss_5': 0.00547726,
     'conf_loss_3': 0.008339549,
     'conf_loss_4': 0.0074449945,
     'conf_loss_5': 0.0063716685,
     'recall50_3': 0.09830124,
     'recall50_4': 0.22460495,
     'recall50_5': 0.30073363,
     'total_loss': 0.071216084,
     'validation_loss': 0.071216084}

train | step:  10000 | steps/sec:    1.5 | output: 
    {'avg_iou_3': 0.6127362,
     'avg_iou_4': 0.7124707,
     'avg_iou_5': 0.74760437,
     'avg_obj_3': 0.12129001,
     'avg_obj_4': 0.22907825,
     'avg_obj_5': 0.33557668,
     'box_loss_3': 0.16416806,
     'box_loss_4': 0.122111745,
     'box_loss_5': 0.11023896,
     'class_loss_3': 0.08997215,
     'class_loss_4': 0.06881663,
     'class_loss_5': 0.05985695,
     'conf_loss_3': 0.1819839,
     'conf_loss_4': 0.14997931,
     'conf_loss_5': 0.088356,
     'learning_rate': 0.00261,
     'recall50_3': 0.05307843,
     'recall50_4': 0.16671878,
     'recall50_5': 0.31238812,
     'total_loss': 1.0354818,
     'training_loss': 1.0354818}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-10000.
 eval | step:  10000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=167.48s).
Accumulating evaluation results...
DONE (t=2.42s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.149
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.278
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.146
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.044
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.170
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.200
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.141
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.203
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.207
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.067
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.239
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.257
 eval | step:  10000 | eval time:  468.3 sec | output: 
    {'AP': 0.14872299,
     'AP50': 0.2779428,
     'AP75': 0.14568366,
     'APl': 0.20026684,
     'APm': 0.17027742,
     'APs': 0.044418663,
     'ARl': 0.25676733,
     'ARm': 0.239364,
     'ARmax1': 0.14127955,
     'ARmax10': 0.20334111,
     'ARmax100': 0.2071669,
     'ARs': 0.06705777,
     'avg_iou_3': 0.46483058,
     'avg_iou_4': 0.66277856,
     'avg_iou_5': 0.7213105,
     'avg_obj_3': 0.10491395,
     'avg_obj_4': 0.22324213,
     'avg_obj_5': 0.30226058,
     'box_loss_3': 0.011881639,
     'box_loss_4': 0.012212949,
     'box_loss_5': 0.0121063655,
     'class_loss_3': 0.0062058535,
     'class_loss_4': 0.0065624113,
     'class_loss_5': 0.006464938,
     'conf_loss_3': 0.008337129,
     'conf_loss_4': 0.0076586874,
     'conf_loss_5': 0.006549835,
     'recall50_3': 0.063802004,
     'recall50_4': 0.1792133,
     'recall50_5': 0.28060836,
     'total_loss': 0.07797979,
     'validation_loss': 0.07797979}
train | step:  10000 | training until step 15000...
train | step:  15000 | steps/sec:    1.4 | output: 
    {'avg_iou_3': 0.6317629,
     'avg_iou_4': 0.7386084,
     'avg_iou_5': 0.77608144,
     'avg_obj_3': 0.14039265,
     'avg_obj_4': 0.26234633,
     'avg_obj_5': 0.37642547,
     'box_loss_3': 0.15606801,
     'box_loss_4': 0.11114498,
     'box_loss_5': 0.09793715,
     'class_loss_3': 0.07512176,
     'class_loss_4': 0.055869244,
     'class_loss_5': 0.048860922,
     'conf_loss_3': 0.17791462,
     'conf_loss_4': 0.14482701,
     'conf_loss_5': 0.08446312,
     'learning_rate': 0.00261,
     'recall50_3': 0.07153701,
     'recall50_4': 0.21297878,
     'recall50_5': 0.37466088,
     'total_loss': 0.9522073,
     'training_loss': 0.9522073}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-15000.
 eval | step:  15000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=175.73s).
Accumulating evaluation results...
DONE (t=2.47s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.178
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.318
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.181
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.058
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.207
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.239
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.162
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.234
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.239
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.087
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.280
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.294
 eval | step:  15000 | eval time:  473.8 sec | output: 
    {'AP': 0.17761593,
     'AP50': 0.3176494,
     'AP75': 0.18050255,
     'APl': 0.23904343,
     'APm': 0.20717406,
     'APs': 0.0584673,
     'ARl': 0.29436368,
     'ARm': 0.27992153,
     'ARmax1': 0.16225792,
     'ARmax10': 0.23355891,
     'ARmax100': 0.23864506,
     'ARs': 0.08664945,
     'avg_iou_3': 0.47356695,
     'avg_iou_4': 0.675693,
     'avg_iou_5': 0.72940516,
     'avg_obj_3': 0.11772456,
     'avg_obj_4': 0.24021935,
     'avg_obj_5': 0.29635885,
     'box_loss_3': 0.011417213,
     'box_loss_4': 0.011573519,
     'box_loss_5': 0.011645332,
     'class_loss_3': 0.00535468,
     'class_loss_4': 0.005675973,
     'class_loss_5': 0.0057798647,
     'conf_loss_3': 0.008309726,
     'conf_loss_4': 0.0074704885,
     'conf_loss_5': 0.0064041056,
     'recall50_3': 0.07331259,
     'recall50_4': 0.20678489,
     'recall50_5': 0.27519876,
     'total_loss': 0.07363089,
     'validation_loss': 0.07363089}
train | step:  15000 | training until step 20000...
train | step:  20000 | steps/sec:    1.4 | output: 
    {'avg_iou_3': 0.6433965,
     'avg_iou_4': 0.75393045,
     'avg_iou_5': 0.7919989,
     'avg_obj_3': 0.15388787,
     'avg_obj_4': 0.28522718,
     'avg_obj_5': 0.40374246,
     'box_loss_3': 0.15113647,
     'box_loss_4': 0.10464833,
     'box_loss_5': 0.09106319,
     'class_loss_3': 0.06751877,
     'class_loss_4': 0.048807856,
     'class_loss_5': 0.042789735,
     'conf_loss_3': 0.1750941,
     'conf_loss_4': 0.14112414,
     'conf_loss_5': 0.0816905,
     'learning_rate': 0.00261,
     'recall50_3': 0.08579929,
     'recall50_4': 0.24487129,
     'recall50_5': 0.41451827,
     'total_loss': 0.9038741,
     'training_loss': 0.9038741}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-20000.
 eval | step:  20000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=168.79s).
Accumulating evaluation results...
DONE (t=2.49s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.192
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.342
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.198
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.071
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.227
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.247
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.172
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.248
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.252
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.101
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.299
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.298
 eval | step:  20000 | eval time:  459.4 sec | output: 
    {'AP': 0.1918594,
     'AP50': 0.34191883,
     'AP75': 0.19751951,
     'APl': 0.24671088,
     'APm': 0.22657482,
     'APs': 0.07131835,
     'ARl': 0.2975488,
     'ARm': 0.29879263,
     'ARmax1': 0.17217383,
     'ARmax10': 0.24758296,
     'ARmax100': 0.25232163,
     'ARs': 0.10125101,
     'avg_iou_3': 0.48649976,
     'avg_iou_4': 0.6859155,
     'avg_iou_5': 0.7327373,
     'avg_obj_3': 0.13638435,
     'avg_obj_4': 0.25126857,
     'avg_obj_5': 0.31378087,
     'box_loss_3': 0.010753223,
     'box_loss_4': 0.011042278,
     'box_loss_5': 0.011501741,
     'class_loss_3': 0.004951206,
     'class_loss_4': 0.0053341757,
     'class_loss_5': 0.00547726,
     'conf_loss_3': 0.008339549,
     'conf_loss_4': 0.0074449945,
     'conf_loss_5': 0.0063716685,
     'recall50_3': 0.09830124,
     'recall50_4': 0.22460495,
     'recall50_5': 0.30073363,
     'total_loss': 0.071216084,
     'validation_loss': 0.071216084}I0401 10:29:34.812612 140537942914880 controller.py:211] train | step:  20000 | training until step 25000...
I0401 11:15:28.945018 140537942914880 controller.py:425] train | step:  25000 | steps/sec:    1.5 | output: 
    {'avg_iou_3': 0.6519162,
     'avg_iou_4': 0.76472247,
     'avg_iou_5': 0.8035061,
     'avg_obj_3': 0.16385627,
     'avg_obj_4': 0.30243483,
     'avg_obj_5': 0.42389122,
     'box_loss_3': 0.14746408,
     'box_loss_4': 0.10011299,
     'box_loss_5': 0.08610543,
     'class_loss_3': 0.062498346,
     'class_loss_4': 0.044282243,
     'class_loss_5': 0.038758982,
     'conf_loss_3': 0.17288779,
     'conf_loss_4': 0.13824038,
     'conf_loss_5': 0.07946639,
     'learning_rate': 0.00261,
     'recall50_3': 0.09681975,
     'recall50_4': 0.26889956,
     'recall50_5': 0.44318414,
     'total_loss': 0.86981535,
     'training_loss': 0.86981535}
I0401 11:16:15.126146 140537942914880 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-25000.
I0401 11:16:15.132009 140537942914880 controller.py:252]  eval | step:  25000 | running 625 steps of evaluation...
I0401 11:20:17.345688 140537942914880 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0401 11:24:02.458451 140537942914880 controller.py:261]  eval | step:  25000 | eval time:  467.3 sec | output: 
    {'AP': 0.20863475,
     'AP50': 0.36073387,
     'AP75': 0.22062193,
     'APl': 0.28240988,
     'APm': 0.23720935,
     'APs': 0.080322534,
     'ARl': 0.34138358,
     'ARm': 0.31360808,
     'ARmax1': 0.18678157,
     'ARmax10': 0.26952845,
     'ARmax100': 0.2744506,
     'ARs': 0.11559363,
     'avg_iou_3': 0.47931528,
     'avg_iou_4': 0.6943461,
     'avg_iou_5': 0.74418867,
     'avg_obj_3': 0.13438976,
     'avg_obj_4': 0.27582538,
     'avg_obj_5': 0.3460464,
     'box_loss_3': 0.011100045,
     'box_loss_4': 0.010605909,
     'box_loss_5': 0.010899044,
     'class_loss_3': 0.00467807,
     'class_loss_4': 0.0050582686,
     'class_loss_5': 0.0052766674,
     'conf_loss_3': 0.008060635,
     'conf_loss_4': 0.007313419,
     'conf_loss_5': 0.0062319627,
     'recall50_3': 0.098345004,
     'recall50_4': 0.25813487,
     'recall50_5': 0.33728665,
     'total_loss': 0.06922405,
     'validation_loss': 0.06922405}
I0401 11:24:33.489104 140537942914880 controller.py:211] train | step:  25000 | training until step 30000...
I0401 12:08:37.701281 140537942914880 controller.py:425] train | step:  30000 | steps/sec:    1.6 | output: 
    {'avg_iou_3': 0.6583188,
     'avg_iou_4': 0.77272433,
     'avg_iou_5': 0.8120503,
     'avg_obj_3': 0.17234266,
     'avg_obj_4': 0.3161034,
     'avg_obj_5': 0.4400983,
     'box_loss_3': 0.14469004,
     'box_loss_4': 0.096684426,
     'box_loss_5': 0.0823819,
     'class_loss_3': 0.058500428,
     'class_loss_4': 0.040831078,
     'class_loss_5': 0.035771538,
     'conf_loss_3': 0.17090969,
     'conf_loss_4': 0.13559829,
     'conf_loss_5': 0.077578776,
     'learning_rate': 0.00261,
     'recall50_3': 0.10646965,
     'recall50_4': 0.2879873,
     'recall50_5': 0.46556866,
     'total_loss': 0.8429461,
     'training_loss': 0.8429461}
I0401 12:09:24.068180 140537942914880 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-30000.
I0401 12:09:24.073771 140537942914880 controller.py:252]  eval | step:  30000 | running 625 steps of evaluation...
I0401 12:13:31.581616 140537942914880 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0401 12:17:27.790657 140537942914880 controller.py:261]  eval | step:  30000 | eval time:  483.7 sec | output: 
    {'AP': 0.22272727,
     'AP50': 0.38165423,
     'AP75': 0.23786695,
     'APl': 0.29161227,
     'APm': 0.26136133,
     'APs': 0.08779211,
     'ARl': 0.36196223,
     'ARm': 0.34326452,
     'ARmax1': 0.1966638,
     'ARmax10': 0.28782856,
     'ARmax100': 0.29314017,
     'ARs': 0.12240613,
     'avg_iou_3': 0.48970944,
     'avg_iou_4': 0.6917212,
     'avg_iou_5': 0.7499639,
     'avg_obj_3': 0.13828656,
     'avg_obj_4': 0.2738928,
     'avg_obj_5': 0.35063922,
     'box_loss_3': 0.010562502,
     'box_loss_4': 0.0107073635,
     'box_loss_5': 0.010565692,
     'class_loss_3': 0.004468436,
     'class_loss_4': 0.004734528,
     'class_loss_5': 0.004850181,
     'conf_loss_3': 0.008104286,
     'conf_loss_4': 0.007272772,
     'conf_loss_5': 0.006233318,
     'recall50_3': 0.101465724,
     'recall50_4': 0.25392675,
     'recall50_5': 0.34738573,
     'total_loss': 0.06749909,
     'validation_loss': 0.06749909}
I0401 12:17:58.218918 140537942914880 controller.py:211] train | step:  30000 | training until step 35000...
I0401 13:03:13.969892 140537942914880 controller.py:425] train | step:  35000 | steps/sec:    1.5 | output: 
    {'avg_iou_3': 0.6636088,
     'avg_iou_4': 0.77938294,
     'avg_iou_5': 0.818565,
     'avg_obj_3': 0.17940764,
     'avg_obj_4': 0.3278614,
     'avg_obj_5': 0.45370653,
     'box_loss_3': 0.14253932,
     'box_loss_4': 0.09389127,
     'box_loss_5': 0.07957062,
     'class_loss_3': 0.055549078,
     'class_loss_4': 0.0383112,
     'class_loss_5': 0.03343322,
     'conf_loss_3': 0.16933654,
     'conf_loss_4': 0.13361865,
     'conf_loss_5': 0.076017335,
     'learning_rate': 0.00261,
     'recall50_3': 0.11437119,
     'recall50_4': 0.30405474,
     'recall50_5': 0.4847213,
     'total_loss': 0.8222668,
     'training_loss': 0.8222668}
I0401 13:03:59.693740 140537942914880 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-35000.
I0401 13:03:59.700031 140537942914880 controller.py:252]  eval | step:  35000 | running 625 steps of evaluation...
I0401 13:08:00.287497 140537942914880 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.

train | step:  20000 | training until step 25000...
train | step:  25000 | steps/sec:    1.5 | output: 
    {'avg_iou_3': 0.6519162,
     'avg_iou_4': 0.76472247,
     'avg_iou_5': 0.8035061,
     'avg_obj_3': 0.16385627,
     'avg_obj_4': 0.30243483,
     'avg_obj_5': 0.42389122,
     'box_loss_3': 0.14746408,
     'box_loss_4': 0.10011299,
     'box_loss_5': 0.08610543,
     'class_loss_3': 0.062498346,
     'class_loss_4': 0.044282243,
     'class_loss_5': 0.038758982,
     'conf_loss_3': 0.17288779,
     'conf_loss_4': 0.13824038,
     'conf_loss_5': 0.07946639,
     'learning_rate': 0.00261,
     'recall50_3': 0.09681975,
     'recall50_4': 0.26889956,
     'recall50_5': 0.44318414,
     'total_loss': 0.86981535,
     'training_loss': 0.86981535}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-25000.
 eval | step:  25000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=166.62s).
Accumulating evaluation results...
DONE (t=2.53s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.209
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.361
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.221
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.080
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.237
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.282
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.187
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.270
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.274
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.116
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.314
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.341
 eval | step:  25000 | eval time:  467.3 sec | output: 
    {'AP': 0.20863475,
     'AP50': 0.36073387,
     'AP75': 0.22062193,
     'APl': 0.28240988,
     'APm': 0.23720935,
     'APs': 0.080322534,
     'ARl': 0.34138358,
     'ARm': 0.31360808,
     'ARmax1': 0.18678157,
     'ARmax10': 0.26952845,
     'ARmax100': 0.2744506,
     'ARs': 0.11559363,
     'avg_iou_3': 0.47931528,
     'avg_iou_4': 0.6943461,
     'avg_iou_5': 0.74418867,
     'avg_obj_3': 0.13438976,
     'avg_obj_4': 0.27582538,
     'avg_obj_5': 0.3460464,
     'box_loss_3': 0.011100045,
     'box_loss_4': 0.010605909,
     'box_loss_5': 0.010899044,
     'class_loss_3': 0.00467807,
     'class_loss_4': 0.0050582686,
     'class_loss_5': 0.0052766674,
     'conf_loss_3': 0.008060635,
     'conf_loss_4': 0.007313419,
     'conf_loss_5': 0.0062319627,
     'recall50_3': 0.098345004,
     'recall50_4': 0.25813487,
     'recall50_5': 0.33728665,
     'total_loss': 0.06922405,
     'validation_loss': 0.06922405}
train | step:  25000 | training until step 30000...
train | step:  30000 | steps/sec:    1.6 | output: 
    {'avg_iou_3': 0.6583188,
     'avg_iou_4': 0.77272433,
     'avg_iou_5': 0.8120503,
     'avg_obj_3': 0.17234266,
     'avg_obj_4': 0.3161034,
     'avg_obj_5': 0.4400983,
     'box_loss_3': 0.14469004,
     'box_loss_4': 0.096684426,
     'box_loss_5': 0.0823819,
     'class_loss_3': 0.058500428,
     'class_loss_4': 0.040831078,
     'class_loss_5': 0.035771538,
     'conf_loss_3': 0.17090969,
     'conf_loss_4': 0.13559829,
     'conf_loss_5': 0.077578776,
     'learning_rate': 0.00261,
     'recall50_3': 0.10646965,
     'recall50_4': 0.2879873,
     'recall50_5': 0.46556866,
     'total_loss': 0.8429461,
     'training_loss': 0.8429461}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-30000.
 eval | step:  30000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=172.11s).
Accumulating evaluation results...
DONE (t=2.58s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.223
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.382
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.238
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.088
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.261
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.292
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.197
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.288
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.293
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.122
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.343
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.362
 eval | step:  30000 | eval time:  483.7 sec | output: 
    {'AP': 0.22272727,
     'AP50': 0.38165423,
     'AP75': 0.23786695,
     'APl': 0.29161227,
     'APm': 0.26136133,
     'APs': 0.08779211,
     'ARl': 0.36196223,
     'ARm': 0.34326452,
     'ARmax1': 0.1966638,
     'ARmax10': 0.28782856,
     'ARmax100': 0.29314017,
     'ARs': 0.12240613,
     'avg_iou_3': 0.48970944,
     'avg_iou_4': 0.6917212,
     'avg_iou_5': 0.7499639,
     'avg_obj_3': 0.13828656,
     'avg_obj_4': 0.2738928,
     'avg_obj_5': 0.35063922,
     'box_loss_3': 0.010562502,
     'box_loss_4': 0.0107073635,
     'box_loss_5': 0.010565692,
     'class_loss_3': 0.004468436,
     'class_loss_4': 0.004734528,
     'class_loss_5': 0.004850181,
     'conf_loss_3': 0.008104286,
     'conf_loss_4': 0.007272772,
     'conf_loss_5': 0.006233318,
     'recall50_3': 0.101465724,
     'recall50_4': 0.25392675,
     'recall50_5': 0.34738573,
     'total_loss': 0.06749909,
     'validation_loss': 0.06749909}
train | step:  30000 | training until step 35000...
train | step:  35000 | steps/sec:    1.5 | output: 
    {'avg_iou_3': 0.6636088,
     'avg_iou_4': 0.77938294,
     'avg_iou_5': 0.818565,
     'avg_obj_3': 0.17940764,
     'avg_obj_4': 0.3278614,
     'avg_obj_5': 0.45370653,
     'box_loss_3': 0.14253932,
     'box_loss_4': 0.09389127,
     'box_loss_5': 0.07957062,
     'class_loss_3': 0.055549078,
     'class_loss_4': 0.0383112,
     'class_loss_5': 0.03343322,
     'conf_loss_3': 0.16933654,
     'conf_loss_4': 0.13361865,
     'conf_loss_5': 0.076017335,
     'learning_rate': 0.00261,
     'recall50_3': 0.11437119,
     'recall50_4': 0.30405474,
     'recall50_5': 0.4847213,
     'total_loss': 0.8222668,
     'training_loss': 0.8222668}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-35000.
 eval | step:  35000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=170.02s).
Accumulating evaluation results...
DONE (t=2.56s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.233
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.384
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.251
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.089
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.264
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.321
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.206
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.295
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.300
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.123
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.341
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.393I0401 13:11:47.506128 140537942914880 controller.py:261]  eval | step:  35000 | eval time:  467.8 sec | output: 
    {'AP': 0.23257542,
     'AP50': 0.38364586,
     'AP75': 0.25056598,
     'APl': 0.32113078,
     'APm': 0.264183,
     'APs': 0.08916786,
     'ARl': 0.39263344,
     'ARm': 0.34075338,
     'ARmax1': 0.20554,
     'ARmax10': 0.29486686,
     'ARmax100': 0.3004852,
     'ARs': 0.1228069,
     'avg_iou_3': 0.4870158,
     'avg_iou_4': 0.70459175,
     'avg_iou_5': 0.76440424,
     'avg_obj_3': 0.1342316,
     'avg_obj_4': 0.28447044,
     'avg_obj_5': 0.3608779,
     'box_loss_3': 0.010706828,
     'box_loss_4': 0.010059017,
     'box_loss_5': 0.009837329,
     'class_loss_3': 0.0044371528,
     'class_loss_4': 0.0048377486,
     'class_loss_5': 0.00506756,
     'conf_loss_3': 0.007966149,
     'conf_loss_4': 0.0072803344,
     'conf_loss_5': 0.0061894744,
     'recall50_3': 0.09996598,
     'recall50_4': 0.2674626,
     'recall50_5': 0.35920972,
     'total_loss': 0.066381626,
     'validation_loss': 0.066381626}
I0401 13:12:12.079321 140537942914880 controller.py:211] train | step:  35000 | training until step 40000...
I0401 14:03:43.776161 140537942914880 controller.py:425] train | step:  40000 | steps/sec:    1.4 | output: 
    {'avg_iou_3': 0.66807526,
     'avg_iou_4': 0.7845,
     'avg_iou_5': 0.82392883,
     'avg_obj_3': 0.18577355,
     'avg_obj_4': 0.33778328,
     'avg_obj_5': 0.46580622,
     'box_loss_3': 0.14076485,
     'box_loss_4': 0.09173447,
     'box_loss_5': 0.077256635,
     'class_loss_3': 0.05330894,
     'class_loss_4': 0.036262196,
     'class_loss_5': 0.031600688,
     'conf_loss_3': 0.16776481,
     'conf_loss_4': 0.13177007,
     'conf_loss_5': 0.074569315,
     'learning_rate': 0.00261,
     'recall50_3': 0.12157425,
     'recall50_4': 0.31710732,
     'recall50_5': 0.49994272,
     'total_loss': 0.8050307,
     'training_loss': 0.8050307}
I0401 14:04:31.422010 140537942914880 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-40000.
I0401 14:04:31.427846 140537942914880 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0401 14:08:36.317643 140537942914880 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0401 14:12:22.009644 140537942914880 controller.py:261]  eval | step:  40000 | eval time:  470.6 sec | output: 
    {'AP': 0.22467487,
     'AP50': 0.3757216,
     'AP75': 0.24081354,
     'APl': 0.31177643,
     'APm': 0.25375772,
     'APs': 0.08358555,
     'ARl': 0.3856211,
     'ARm': 0.33174184,
     'ARmax1': 0.20322898,
     'ARmax10': 0.28701136,
     'ARmax100': 0.2916518,
     'ARs': 0.112093724,
     'avg_iou_3': 0.48364496,
     'avg_iou_4': 0.6973715,
     'avg_iou_5': 0.7571831,
     'avg_obj_3': 0.13425483,
     'avg_obj_4': 0.27296373,
     'avg_obj_5': 0.35891005,
     'box_loss_3': 0.0108527085,
     'box_loss_4': 0.010399297,
     'box_loss_5': 0.010183031,
     'class_loss_3': 0.004615998,
     'class_loss_4': 0.0048432485,
     'class_loss_5': 0.0050805104,
     'conf_loss_3': 0.007990416,
     'conf_loss_4': 0.007283541,
     'conf_loss_5': 0.0062717823,
     'recall50_3': 0.09942423,
     'recall50_4': 0.25706974,
     'recall50_5': 0.36057094,
     'total_loss': 0.06752053,
     'validation_loss': 0.06752053}
I0401 14:12:53.195104 140537942914880 controller.py:211] train | step:  40000 | training until step 45000...
I0401 14:59:05.100539 140537942914880 controller.py:425] train | step:  45000 | steps/sec:    1.5 | output: 
    {'avg_iou_3': 0.6715922,
     'avg_iou_4': 0.7890182,
     'avg_iou_5': 0.8286506,
     'avg_obj_3': 0.19140626,
     'avg_obj_4': 0.34715474,
     'avg_obj_5': 0.476259,
     'box_loss_3': 0.13912836,
     'box_loss_4': 0.089812025,
     'box_loss_5': 0.07516481,
     'class_loss_3': 0.05122257,
     'class_loss_4': 0.03447108,
     'class_loss_5': 0.029986618,
     'conf_loss_3': 0.16621678,
     'conf_loss_4': 0.12984267,
     'conf_loss_5': 0.07323857,
     'learning_rate': 0.00261,
     'recall50_3': 0.12805514,
     'recall50_4': 0.32991245,
     'recall50_5': 0.5143637,
     'total_loss': 0.78908485,
     'training_loss': 0.78908485}
I0401 14:59:50.635144 140537942914880 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-45000.
I0401 14:59:50.641260 140537942914880 controller.py:252]  eval | step:  45000 | running 625 steps of evaluation...
I0401 15:03:55.581485 140537942914880 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0401 15:07:44.918995 140537942914880 controller.py:261]  eval | step:  45000 | eval time:  474.3 sec | output: 
    {'AP': 0.24322158,
     'AP50': 0.396106,
     'AP75': 0.26466602,
     'APl': 0.3224329,
     'APm': 0.27452126,
     'APs': 0.098707244,
     'ARl': 0.38972145,
     'ARm': 0.3596909,
     'ARmax1': 0.21484806,
     'ARmax10': 0.31007516,
     'ARmax100': 0.31579015,
     'ARs': 0.13554995,
     'avg_iou_3': 0.4901875,
     'avg_iou_4': 0.7117893,
     'avg_iou_5': 0.7667071,
     'avg_obj_3': 0.14273842,
     'avg_obj_4': 0.29360527,
     'avg_obj_5': 0.36500672,
     'box_loss_3': 0.010540576,
     'box_loss_4': 0.009688844,
     'box_loss_5': 0.009720956,
     'class_loss_3': 0.004352241,
     'class_loss_4': 0.004707143,
     'class_loss_5': 0.004938459,
     'conf_loss_3': 0.008056854,
     'conf_loss_4': 0.007351027,
     'conf_loss_5': 0.006243333,
     'recall50_3': 0.11022095,
     'recall50_4': 0.2848639,
     'recall50_5': 0.37080422,
     'total_loss': 0.06559946,
     'validation_loss': 0.06559946}
I0401 15:08:03.590916 140537942914880 controller.py:211] train | step:  45000 | training until step 50000...
I0401 15:49:13.956267 140537942914880 controller.py:425] train | step:  50000 | steps/sec:    1.7 | output: 
    {'avg_iou_3': 0.67501676,
     'avg_iou_4': 0.79300517,
     'avg_iou_5': 0.8328432,
     'avg_obj_3': 0.19628498,
     'avg_obj_4': 0.3552721,
     'avg_obj_5': 0.4866743,
     'box_loss_3': 0.13778704,
     'box_loss_4': 0.08814312,
     'box_loss_5': 0.07341425,
     'class_loss_3': 0.04943477,
     'class_loss_4': 0.032913797,
     'class_loss_5': 0.028657312,
     'conf_loss_3': 0.1651108,
     'conf_loss_4': 0.12828764,
     'conf_loss_5': 0.071955405,
     'learning_rate': 0.00261,
     'recall50_3': 0.13397495,
     'recall50_4': 0.34064403,
     'recall50_5': 0.5277614,
     'total_loss': 0.77570426,
     'training_loss': 0.77570426}
I0401 15:50:00.486455 140537942914880 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-50000.
I0401 15:50:00.495840 140537942914880 controller.py:252]  eval | step:  50000 | running 625 steps of evaluation...
I0401 15:53:59.795365 140537942914880 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.

 eval | step:  35000 | eval time:  467.8 sec | output: 
    {'AP': 0.23257542,
     'AP50': 0.38364586,
     'AP75': 0.25056598,
     'APl': 0.32113078,
     'APm': 0.264183,
     'APs': 0.08916786,
     'ARl': 0.39263344,
     'ARm': 0.34075338,
     'ARmax1': 0.20554,
     'ARmax10': 0.29486686,
     'ARmax100': 0.3004852,
     'ARs': 0.1228069,
     'avg_iou_3': 0.4870158,
     'avg_iou_4': 0.70459175,
     'avg_iou_5': 0.76440424,
     'avg_obj_3': 0.1342316,
     'avg_obj_4': 0.28447044,
     'avg_obj_5': 0.3608779,
     'box_loss_3': 0.010706828,
     'box_loss_4': 0.010059017,
     'box_loss_5': 0.009837329,
     'class_loss_3': 0.0044371528,
     'class_loss_4': 0.0048377486,
     'class_loss_5': 0.00506756,
     'conf_loss_3': 0.007966149,
     'conf_loss_4': 0.0072803344,
     'conf_loss_5': 0.0061894744,
     'recall50_3': 0.09996598,
     'recall50_4': 0.2674626,
     'recall50_5': 0.35920972,
     'total_loss': 0.066381626,
     'validation_loss': 0.066381626}
train | step:  35000 | training until step 40000...
train | step:  40000 | steps/sec:    1.4 | output: 
    {'avg_iou_3': 0.66807526,
     'avg_iou_4': 0.7845,
     'avg_iou_5': 0.82392883,
     'avg_obj_3': 0.18577355,
     'avg_obj_4': 0.33778328,
     'avg_obj_5': 0.46580622,
     'box_loss_3': 0.14076485,
     'box_loss_4': 0.09173447,
     'box_loss_5': 0.077256635,
     'class_loss_3': 0.05330894,
     'class_loss_4': 0.036262196,
     'class_loss_5': 0.031600688,
     'conf_loss_3': 0.16776481,
     'conf_loss_4': 0.13177007,
     'conf_loss_5': 0.074569315,
     'learning_rate': 0.00261,
     'recall50_3': 0.12157425,
     'recall50_4': 0.31710732,
     'recall50_5': 0.49994272,
     'total_loss': 0.8050307,
     'training_loss': 0.8050307}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-40000.
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=170.70s).
Accumulating evaluation results...
DONE (t=2.49s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.225
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.376
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.241
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.084
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.254
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.312
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.203
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.287
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.292
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.112
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.332
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.386
 eval | step:  40000 | eval time:  470.6 sec | output: 
    {'AP': 0.22467487,
     'AP50': 0.3757216,
     'AP75': 0.24081354,
     'APl': 0.31177643,
     'APm': 0.25375772,
     'APs': 0.08358555,
     'ARl': 0.3856211,
     'ARm': 0.33174184,
     'ARmax1': 0.20322898,
     'ARmax10': 0.28701136,
     'ARmax100': 0.2916518,
     'ARs': 0.112093724,
     'avg_iou_3': 0.48364496,
     'avg_iou_4': 0.6973715,
     'avg_iou_5': 0.7571831,
     'avg_obj_3': 0.13425483,
     'avg_obj_4': 0.27296373,
     'avg_obj_5': 0.35891005,
     'box_loss_3': 0.0108527085,
     'box_loss_4': 0.010399297,
     'box_loss_5': 0.010183031,
     'class_loss_3': 0.004615998,
     'class_loss_4': 0.0048432485,
     'class_loss_5': 0.0050805104,
     'conf_loss_3': 0.007990416,
     'conf_loss_4': 0.007283541,
     'conf_loss_5': 0.0062717823,
     'recall50_3': 0.09942423,
     'recall50_4': 0.25706974,
     'recall50_5': 0.36057094,
     'total_loss': 0.06752053,
     'validation_loss': 0.06752053}
train | step:  40000 | training until step 45000...
train | step:  45000 | steps/sec:    1.5 | output: 
    {'avg_iou_3': 0.6715922,
     'avg_iou_4': 0.7890182,
     'avg_iou_5': 0.8286506,
     'avg_obj_3': 0.19140626,
     'avg_obj_4': 0.34715474,
     'avg_obj_5': 0.476259,
     'box_loss_3': 0.13912836,
     'box_loss_4': 0.089812025,
     'box_loss_5': 0.07516481,
     'class_loss_3': 0.05122257,
     'class_loss_4': 0.03447108,
     'class_loss_5': 0.029986618,
     'conf_loss_3': 0.16621678,
     'conf_loss_4': 0.12984267,
     'conf_loss_5': 0.07323857,
     'learning_rate': 0.00261,
     'recall50_3': 0.12805514,
     'recall50_4': 0.32991245,
     'recall50_5': 0.5143637,
     'total_loss': 0.78908485,
     'training_loss': 0.78908485}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-45000.
 eval | step:  45000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=174.56s).
Accumulating evaluation results...
DONE (t=2.58s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.243
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.396
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.265
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.099
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.275
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.322
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.215
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.310
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.316
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.136
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.360
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.390
 eval | step:  45000 | eval time:  474.3 sec | output: 
    {'AP': 0.24322158,
     'AP50': 0.396106,
     'AP75': 0.26466602,
     'APl': 0.3224329,
     'APm': 0.27452126,
     'APs': 0.098707244,
     'ARl': 0.38972145,
     'ARm': 0.3596909,
     'ARmax1': 0.21484806,
     'ARmax10': 0.31007516,
     'ARmax100': 0.31579015,
     'ARs': 0.13554995,
     'avg_iou_3': 0.4901875,
     'avg_iou_4': 0.7117893,
     'avg_iou_5': 0.7667071,
     'avg_obj_3': 0.14273842,
     'avg_obj_4': 0.29360527,
     'avg_obj_5': 0.36500672,
     'box_loss_3': 0.010540576,
     'box_loss_4': 0.009688844,
     'box_loss_5': 0.009720956,
     'class_loss_3': 0.004352241,
     'class_loss_4': 0.004707143,
     'class_loss_5': 0.004938459,
     'conf_loss_3': 0.008056854,
     'conf_loss_4': 0.007351027,
     'conf_loss_5': 0.006243333,
     'recall50_3': 0.11022095,
     'recall50_4': 0.2848639,
     'recall50_5': 0.37080422,
     'total_loss': 0.06559946,
     'validation_loss': 0.06559946}
train | step:  45000 | training until step 50000...
train | step:  50000 | steps/sec:    1.7 | output: 
    {'avg_iou_3': 0.67501676,
     'avg_iou_4': 0.79300517,
     'avg_iou_5': 0.8328432,
     'avg_obj_3': 0.19628498,
     'avg_obj_4': 0.3552721,
     'avg_obj_5': 0.4866743,
     'box_loss_3': 0.13778704,
     'box_loss_4': 0.08814312,
     'box_loss_5': 0.07341425,
     'class_loss_3': 0.04943477,
     'class_loss_4': 0.032913797,
     'class_loss_5': 0.028657312,
     'conf_loss_3': 0.1651108,
     'conf_loss_4': 0.12828764,
     'conf_loss_5': 0.071955405,
     'learning_rate': 0.00261,
     'recall50_3': 0.13397495,
     'recall50_4': 0.34064403,
     'recall50_5': 0.5277614,
     'total_loss': 0.77570426,
     'training_loss': 0.77570426}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-50000.
 eval | step:  50000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=166.57s).
Accumulating evaluation results...I0401 15:57:43.290068 140537942914880 controller.py:261]  eval | step:  50000 | eval time:  462.8 sec | output: 
    {'AP': 0.24609749,
     'AP50': 0.39682654,
     'AP75': 0.26729485,
     'APl': 0.33132288,
     'APm': 0.2813273,
     'APs': 0.10020445,
     'ARl': 0.39929885,
     'ARm': 0.36426204,
     'ARmax1': 0.2163976,
     'ARmax10': 0.31309533,
     'ARmax100': 0.3186894,
     'ARs': 0.13999379,
     'avg_iou_3': 0.49659434,
     'avg_iou_4': 0.70936936,
     'avg_iou_5': 0.7695904,
     'avg_obj_3': 0.14688528,
     'avg_obj_4': 0.2961658,
     'avg_obj_5': 0.3697016,
     'box_loss_3': 0.0102022905,
     'box_loss_4': 0.009803953,
     'box_loss_5': 0.009560013,
     'class_loss_3': 0.004117323,
     'class_loss_4': 0.0044016577,
     'class_loss_5': 0.0046218038,
     'conf_loss_3': 0.007980084,
     'conf_loss_4': 0.0072488496,
     'conf_loss_5': 0.0061606993,
     'recall50_3': 0.11410703,
     'recall50_4': 0.28585452,
     'recall50_5': 0.3758755,
     'total_loss': 0.0640967,
     'validation_loss': 0.0640967}
I0401 15:58:13.736775 140537942914880 controller.py:211] train | step:  50000 | training until step 55000...
I0401 16:37:13.435660 140537942914880 controller.py:425] train | step:  55000 | steps/sec:    1.7 | output: 
    {'avg_iou_3': 0.6891451,
     'avg_iou_4': 0.81243837,
     'avg_iou_5': 0.8583432,
     'avg_obj_3': 0.21248192,
     'avg_obj_4': 0.38424864,
     'avg_obj_5': 0.52519953,
     'box_loss_3': 0.13162616,
     'box_loss_4': 0.07995289,
     'box_loss_5': 0.062521294,
     'class_loss_3': 0.044725955,
     'class_loss_4': 0.02840365,
     'class_loss_5': 0.023918213,
     'conf_loss_3': 0.16215457,
     'conf_loss_4': 0.12358223,
     'conf_loss_5': 0.06800567,
     'learning_rate': 0.000261,
     'recall50_3': 0.1540631,
     'recall50_4': 0.37846223,
     'recall50_5': 0.5725994,
     'total_loss': 0.72488934,
     'training_loss': 0.72488934}
I0401 16:37:59.118375 140537942914880 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-55000.
I0401 16:37:59.124777 140537942914880 controller.py:252]  eval | step:  55000 | running 625 steps of evaluation...
I0401 16:41:59.620110 140537942914880 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0401 16:45:46.533022 140537942914880 controller.py:261]  eval | step:  55000 | eval time:  467.4 sec | output: 
    {'AP': 0.27969494,
     'AP50': 0.43091443,
     'AP75': 0.3033933,
     'APl': 0.3807967,
     'APm': 0.30905777,
     'APs': 0.11522168,
     'ARl': 0.45925996,
     'ARm': 0.39700806,
     'ARmax1': 0.24094713,
     'ARmax10': 0.34990785,
     'ARmax100': 0.3569976,
     'ARs': 0.16048223,
     'avg_iou_3': 0.50456655,
     'avg_iou_4': 0.7247974,
     'avg_iou_5': 0.7871285,
     'avg_obj_3': 0.15942465,
     'avg_obj_4': 0.32130367,
     'avg_obj_5': 0.41266876,
     'box_loss_3': 0.00978149,
     'box_loss_4': 0.009003939,
     'box_loss_5': 0.008647229,
     'class_loss_3': 0.0039106123,
     'class_loss_4': 0.0041085775,
     'class_loss_5': 0.0043692915,
     'conf_loss_3': 0.007989991,
     'conf_loss_4': 0.0072061582,
     'conf_loss_5': 0.006053469,
     'recall50_3': 0.1293021,
     'recall50_4': 0.32186145,
     'recall50_5': 0.42880693,
     'total_loss': 0.06107078,
     'validation_loss': 0.06107078}
I0401 16:46:20.048193 140537942914880 controller.py:211] train | step:  55000 | training until step 60000...
I0401 17:22:52.134565 140537942914880 controller.py:425] train | step:  60000 | steps/sec:    1.8 | output: 
    {'avg_iou_3': 0.6917335,
     'avg_iou_4': 0.81546587,
     'avg_iou_5': 0.86194843,
     'avg_obj_3': 0.21747997,
     'avg_obj_4': 0.39287296,
     'avg_obj_5': 0.5356118,
     'box_loss_3': 0.13036928,
     'box_loss_4': 0.07860311,
     'box_loss_5': 0.06094942,
     'class_loss_3': 0.04328773,
     'class_loss_4': 0.0270167,
     'class_loss_5': 0.02262845,
     'conf_loss_3': 0.1609522,
     'conf_loss_4': 0.12196945,
     'conf_loss_5': 0.0667284,
     'learning_rate': 2.61e-05,
     'recall50_3': 0.15988448,
     'recall50_4': 0.38972083,
     'recall50_5': 0.58416635,
     'total_loss': 0.71250457,
     'training_loss': 0.71250457}
I0401 17:23:38.706770 140537942914880 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-60000.
I0401 17:23:38.712838 140537942914880 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0401 17:27:39.379031 140537942914880 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0401 17:31:26.541935 140537942914880 controller.py:261]  eval | step:  60000 | eval time:  467.8 sec | output: 
    {'AP': 0.28387475,
     'AP50': 0.43545428,
     'AP75': 0.3078371,
     'APl': 0.38788077,
     'APm': 0.30999073,
     'APs': 0.1161924,
     'ARl': 0.46587586,
     'ARm': 0.39739332,
     'ARmax1': 0.24523658,
     'ARmax10': 0.3539295,
     'ARmax100': 0.36053017,
     'ARs': 0.16262819,
     'avg_iou_3': 0.5053201,
     'avg_iou_4': 0.7253509,
     'avg_iou_5': 0.7886575,
     'avg_obj_3': 0.15903257,
     'avg_obj_4': 0.32139245,
     'avg_obj_5': 0.41755697,
     'box_loss_3': 0.009744137,
     'box_loss_4': 0.008974019,
     'box_loss_5': 0.008564824,
     'class_loss_3': 0.0038995193,
     'class_loss_4': 0.0041001416,
     'class_loss_5': 0.004348779,
     'conf_loss_3': 0.007971271,
     'conf_loss_4': 0.007196894,
     'conf_loss_5': 0.0060551763,
     'recall50_3': 0.12898217,
     'recall50_4': 0.32067242,
     'recall50_5': 0.4329085,
     'total_loss': 0.060854767,
     'validation_loss': 0.060854767}
I0401 17:31:53.207906 140537942914880 controller.py:211] train | step:  60000 | training until step 62500...
I0401 17:45:12.742748 140537942914880 controller.py:425] train | step:  62500 | steps/sec:    1.9 | output: 
    {'avg_iou_3': 0.6922886,
     'avg_iou_4': 0.8161723,
     'avg_iou_5': 0.86262864,
     'avg_obj_3': 0.21809885,
     'avg_obj_4': 0.39408544,
     'avg_obj_5': 0.537527,
     'box_loss_3': 0.13041566,
     'box_loss_4': 0.078366525,
     'box_loss_5': 0.06064497,
     'class_loss_3': 0.043058436,
     'class_loss_4': 0.026802244,
     'class_loss_5': 0.02241839,
     'conf_loss_3': 0.16085622,
     'conf_loss_4': 0.1217637,
     'conf_loss_5': 0.06645563,
     'learning_rate': 2.61e-05,
     'recall50_3': 0.16030172,
     'recall50_4': 0.39130667,
     'recall50_5': 0.5865696,
     'total_loss': 0.7107809,
     'training_loss': 0.7107809}

DONE (t=2.55s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.246
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.397
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.267
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.100
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.281
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.331
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.216
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.313
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.319
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.140
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.364
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.399
 eval | step:  50000 | eval time:  462.8 sec | output: 
    {'AP': 0.24609749,
     'AP50': 0.39682654,
     'AP75': 0.26729485,
     'APl': 0.33132288,
     'APm': 0.2813273,
     'APs': 0.10020445,
     'ARl': 0.39929885,
     'ARm': 0.36426204,
     'ARmax1': 0.2163976,
     'ARmax10': 0.31309533,
     'ARmax100': 0.3186894,
     'ARs': 0.13999379,
     'avg_iou_3': 0.49659434,
     'avg_iou_4': 0.70936936,
     'avg_iou_5': 0.7695904,
     'avg_obj_3': 0.14688528,
     'avg_obj_4': 0.2961658,
     'avg_obj_5': 0.3697016,
     'box_loss_3': 0.0102022905,
     'box_loss_4': 0.009803953,
     'box_loss_5': 0.009560013,
     'class_loss_3': 0.004117323,
     'class_loss_4': 0.0044016577,
     'class_loss_5': 0.0046218038,
     'conf_loss_3': 0.007980084,
     'conf_loss_4': 0.0072488496,
     'conf_loss_5': 0.0061606993,
     'recall50_3': 0.11410703,
     'recall50_4': 0.28585452,
     'recall50_5': 0.3758755,
     'total_loss': 0.0640967,
     'validation_loss': 0.0640967}
train | step:  50000 | training until step 55000...
train | step:  55000 | steps/sec:    1.7 | output: 
    {'avg_iou_3': 0.6891451,
     'avg_iou_4': 0.81243837,
     'avg_iou_5': 0.8583432,
     'avg_obj_3': 0.21248192,
     'avg_obj_4': 0.38424864,
     'avg_obj_5': 0.52519953,
     'box_loss_3': 0.13162616,
     'box_loss_4': 0.07995289,
     'box_loss_5': 0.062521294,
     'class_loss_3': 0.044725955,
     'class_loss_4': 0.02840365,
     'class_loss_5': 0.023918213,
     'conf_loss_3': 0.16215457,
     'conf_loss_4': 0.12358223,
     'conf_loss_5': 0.06800567,
     'learning_rate': 0.000261,
     'recall50_3': 0.1540631,
     'recall50_4': 0.37846223,
     'recall50_5': 0.5725994,
     'total_loss': 0.72488934,
     'training_loss': 0.72488934}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-55000.
 eval | step:  55000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=169.44s).
Accumulating evaluation results...
DONE (t=2.62s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.280
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.431
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.303
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.115
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.309
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.381
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.241
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.350
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.357
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.160
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.397
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.459
 eval | step:  55000 | eval time:  467.4 sec | output: 
    {'AP': 0.27969494,
     'AP50': 0.43091443,
     'AP75': 0.3033933,
     'APl': 0.3807967,
     'APm': 0.30905777,
     'APs': 0.11522168,
     'ARl': 0.45925996,
     'ARm': 0.39700806,
     'ARmax1': 0.24094713,
     'ARmax10': 0.34990785,
     'ARmax100': 0.3569976,
     'ARs': 0.16048223,
     'avg_iou_3': 0.50456655,
     'avg_iou_4': 0.7247974,
     'avg_iou_5': 0.7871285,
     'avg_obj_3': 0.15942465,
     'avg_obj_4': 0.32130367,
     'avg_obj_5': 0.41266876,
     'box_loss_3': 0.00978149,
     'box_loss_4': 0.009003939,
     'box_loss_5': 0.008647229,
     'class_loss_3': 0.0039106123,
     'class_loss_4': 0.0041085775,
     'class_loss_5': 0.0043692915,
     'conf_loss_3': 0.007989991,
     'conf_loss_4': 0.0072061582,
     'conf_loss_5': 0.006053469,
     'recall50_3': 0.1293021,
     'recall50_4': 0.32186145,
     'recall50_5': 0.42880693,
     'total_loss': 0.06107078,
     'validation_loss': 0.06107078}
train | step:  55000 | training until step 60000...
train | step:  60000 | steps/sec:    1.8 | output: 
    {'avg_iou_3': 0.6917335,
     'avg_iou_4': 0.81546587,
     'avg_iou_5': 0.86194843,
     'avg_obj_3': 0.21747997,
     'avg_obj_4': 0.39287296,
     'avg_obj_5': 0.5356118,
     'box_loss_3': 0.13036928,
     'box_loss_4': 0.07860311,
     'box_loss_5': 0.06094942,
     'class_loss_3': 0.04328773,
     'class_loss_4': 0.0270167,
     'class_loss_5': 0.02262845,
     'conf_loss_3': 0.1609522,
     'conf_loss_4': 0.12196945,
     'conf_loss_5': 0.0667284,
     'learning_rate': 2.61e-05,
     'recall50_3': 0.15988448,
     'recall50_4': 0.38972083,
     'recall50_5': 0.58416635,
     'total_loss': 0.71250457,
     'training_loss': 0.71250457}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-60000.
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=170.47s).
Accumulating evaluation results...
DONE (t=2.64s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.284
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.435
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.308
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.116
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.310
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.388
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.245
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.354
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.361
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.163
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.397
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.466
 eval | step:  60000 | eval time:  467.8 sec | output: 
    {'AP': 0.28387475,
     'AP50': 0.43545428,
     'AP75': 0.3078371,
     'APl': 0.38788077,
     'APm': 0.30999073,
     'APs': 0.1161924,
     'ARl': 0.46587586,
     'ARm': 0.39739332,
     'ARmax1': 0.24523658,
     'ARmax10': 0.3539295,
     'ARmax100': 0.36053017,
     'ARs': 0.16262819,
     'avg_iou_3': 0.5053201,
     'avg_iou_4': 0.7253509,
     'avg_iou_5': 0.7886575,
     'avg_obj_3': 0.15903257,
     'avg_obj_4': 0.32139245,
     'avg_obj_5': 0.41755697,
     'box_loss_3': 0.009744137,
     'box_loss_4': 0.008974019,
     'box_loss_5': 0.008564824,
     'class_loss_3': 0.0038995193,
     'class_loss_4': 0.0041001416,
     'class_loss_5': 0.004348779,
     'conf_loss_3': 0.007971271,
     'conf_loss_4': 0.007196894,
     'conf_loss_5': 0.0060551763,
     'recall50_3': 0.12898217,
     'recall50_4': 0.32067242,
     'recall50_5': 0.4329085,
     'total_loss': 0.060854767,
     'validation_loss': 0.060854767}
train | step:  60000 | training until step 62500...
train | step:  62500 | steps/sec:    1.9 | output: 
    {'avg_iou_3': 0.6922886,
     'avg_iou_4': 0.8161723,
     'avg_iou_5': 0.86262864,
     'avg_obj_3': 0.21809885,
     'avg_obj_4': 0.39408544,
     'avg_obj_5': 0.537527,
     'box_loss_3': 0.13041566,
     'box_loss_4': 0.078366525,
     'box_loss_5': 0.06064497,
     'class_loss_3': 0.043058436,
     'class_loss_4': 0.026802244,
     'class_loss_5': 0.02241839,
     'conf_loss_3': 0.16085622,
     'conf_loss_4': 0.1217637,
     'conf_loss_5': 0.06645563,
     'learning_rate': 2.61e-05,
     'recall50_3': 0.16030172,
     'recall50_4': 0.39130667,
     'recall50_5': 0.5865696,
     'total_loss': 0.7107809,
     'training_loss': 0.7107809}I0401 17:45:33.785913 140537942914880 controller.py:252]  eval | step:  62500 | running 625 steps of evaluation...
I0401 17:49:35.878130 140537942914880 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0401 17:53:21.306723 140537942914880 controller.py:261]  eval | step:  62500 | eval time:  467.5 sec | output: 
    {'AP': 0.28444123,
     'AP50': 0.4367206,
     'AP75': 0.30927312,
     'APl': 0.3891541,
     'APm': 0.3114645,
     'APs': 0.11653108,
     'ARl': 0.46674246,
     'ARm': 0.3988443,
     'ARmax1': 0.24611254,
     'ARmax10': 0.35475343,
     'ARmax100': 0.3614428,
     'ARs': 0.16257827,
     'avg_iou_3': 0.505362,
     'avg_iou_4': 0.7253505,
     'avg_iou_5': 0.7885805,
     'avg_obj_3': 0.15957983,
     'avg_obj_4': 0.3220695,
     'avg_obj_5': 0.41708666,
     'box_loss_3': 0.009741514,
     'box_loss_4': 0.008974327,
     'box_loss_5': 0.008569593,
     'class_loss_3': 0.003882391,
     'class_loss_4': 0.0040880204,
     'class_loss_5': 0.0043526846,
     'conf_loss_3': 0.007971238,
     'conf_loss_4': 0.0071919565,
     'conf_loss_5': 0.006056632,
     'recall50_3': 0.12973972,
     'recall50_4': 0.3212903,
     'recall50_5': 0.43213218,
     'total_loss': 0.0608284,
     'validation_loss': 0.0608284}
I0401 17:54:17.944563 140537942914880 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-62500.
I0401 17:54:17.961016 140537942914880 train_lib.py:123] Number of trainable params in model: 53.066944 Millions.

 eval | step:  62500 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=170.40s).
Accumulating evaluation results...
DONE (t=2.59s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.284
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.437
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.309
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.117
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.311
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.389
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.246
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.355
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.361
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.163
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.399
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.467
 eval | step:  62500 | eval time:  467.5 sec | output: 
    {'AP': 0.28444123,
     'AP50': 0.4367206,
     'AP75': 0.30927312,
     'APl': 0.3891541,
     'APm': 0.3114645,
     'APs': 0.11653108,
     'ARl': 0.46674246,
     'ARm': 0.3988443,
     'ARmax1': 0.24611254,
     'ARmax10': 0.35475343,
     'ARmax100': 0.3614428,
     'ARs': 0.16257827,
     'avg_iou_3': 0.505362,
     'avg_iou_4': 0.7253505,
     'avg_iou_5': 0.7885805,
     'avg_obj_3': 0.15957983,
     'avg_obj_4': 0.3220695,
     'avg_obj_5': 0.41708666,
     'box_loss_3': 0.009741514,
     'box_loss_4': 0.008974327,
     'box_loss_5': 0.008569593,
     'class_loss_3': 0.003882391,
     'class_loss_4': 0.0040880204,
     'class_loss_5': 0.0043526846,
     'conf_loss_3': 0.007971238,
     'conf_loss_4': 0.0071919565,
     'conf_loss_5': 0.006056632,
     'recall50_3': 0.12973972,
     'recall50_4': 0.3212903,
     'recall50_5': 0.43213218,
     'total_loss': 0.0608284,
     'validation_loss': 0.0608284}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-sum/yolov4-coco-all-50k-csp-run2/ckpt-62500.
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   233    0     2  100   231     12   1462 --:--:-- --:--:-- --:--:--  1474
okRequest issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-01T17:54:30.178202178Z'
  endTime: '2021-04-01T17:55:07.157999236Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617299670162-5beecec55dc2e-b4bd7bc6-c0d84390
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617299670162-5beecec55dc2e-b4bd7bc6-c0d84390] to complete...
...................................................................................................................................................................................................done.
