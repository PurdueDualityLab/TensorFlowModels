cat: .experiment_zone: No such file or directory
Request issued for: [node-5]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-03-30T18:38:30.131138918Z'
  endTime: '2021-03-30T18:39:10.979955048Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617129510116-5bec54e019dda-cc4492dc-8f1dd067
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617129510116-5bec54e019dda-cc4492dc-8f1dd067] to complete...
...........................................................................................................................................................................................................................................................................done.
europe-west4-a
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 115, in main
    params = train_utils.parse_configuration(FLAGS)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_utils.py", line 249, in parse_configuration
    params, config_file, is_strict=True)
  File "/home/cam2tensorflow/TensorFlowModels/official/modeling/hyperparams/params_dict.py", line 441, in override_params_dict
    params.override(yaml.load(f, Loader=yaml.FullLoader), is_strict)
  File "/usr/local/lib/python3.7/dist-packages/yaml/__init__.py", line 112, in load
    loader = Loader(stream)
  File "/usr/local/lib/python3.7/dist-packages/yaml/loader.py", line 24, in __init__
    Reader.__init__(self, stream)
  File "/usr/local/lib/python3.7/dist-packages/yaml/reader.py", line 85, in __init__
    self.determine_encoding()
  File "/usr/local/lib/python3.7/dist-packages/yaml/reader.py", line 124, in determine_encoding
    self.update_raw()
  File "/usr/local/lib/python3.7/dist-packages/yaml/reader.py", line 178, in update_raw
    data = self.stream.read(size)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/lib/io/file_io.py", line 117, in read
    self._preread_check()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/lib/io/file_io.py", line 80, in _preread_check
    compat.path_to_str(self.__name), 1024 * 512)
tensorflow.python.framework.errors_impl.NotFoundError: yolo/configs/experiments/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp.yaml; No such file or directory
yolo_custom
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   234    0     2  100   232     12   1414 --:--:-- --:--:-- --:--:--  1426
okRequest issued for: [node-5]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617129567706-5bec551705e68-baa548dd-82f7b6f9] to complete...
...............................................................................................aborted by ctrl-c.
ERROR: (gcloud.compute.tpus.stop) Aborting wait for operation https://tpu.googleapis.com/v1alpha1/projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617129567706-5bec551705e68-baa548dd-82f7b6f9.

cat: .experiment_zone: No such file or directory
Request issued for: [node-7]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-03-30T18:40:52.126126281Z'
  endTime: '2021-03-30T18:41:25.836982327Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617129652112-5bec556784b68-2334a7d1-25cc08d9
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  cidrBlock: 10.124.160.48/29
  createTime: '2021-03-18T03:10:27.166064884Z'
  health: HEALTHY
  ipAddress: 10.124.160.50
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.124.160.50
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617129652112-5bec556784b68-2334a7d1-25cc08d9] to complete...
.................................................................................................................................................................................................done.
europe-west4-a
I0330 18:41:33.489866 140028820076352 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.07,
                                                  '4': 0.07,
                                                  '5': 0.07},
                               'iou_thresh': 0.2,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': False,
                                             '4': False,
                                             '5': False},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'objectness_smooth': {'3': True,
                                                     '4': True,
                                                     '5': True},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'scale_xy': {'3': 2.0, '4': 1.75, '5': 1.5},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': False},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'aug_rand_angle': 5.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_transalate': 0.0,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_boxes': 0.1,
                                    'jitter_im': 0.3,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'max_process_size': 608,
                                    'min_process_size': 320,
                                    'mosaic': {'crop_area': [0.3, 0.35],
                                               'mosaic_frequency': 0.955,
                                               'output_size': [640, 640],
                                               'random_crop': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'aug_rand_angle': 15.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_transalate': 0.0,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_boxes': 0.3,
                                         'jitter_im': 0.3,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'max_process_size': 608,
                                         'min_process_size': 320,
                                         'mosaic': {'crop_area': [0.3, 0.35],
                                                    'mosaic_frequency': 0.9,
                                                    'output_size': [640, 640],
                                                    'random_crop': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 5000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'stepwise': {'boundaries': [50000,
                                                                                56250],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.00261,
                                                                            0.000261,
                                                                            2.61e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.949,
                                                        'name': 'SGD',
                                                        'nesterov': True},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 62500,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 5000,
             'validation_steps': 625}}
I0330 18:41:33.490784 140028820076352 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/params.yaml
I0330 18:41:35.806971 140028820076352 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0330 18:41:36.425332 140028820076352 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0330 18:41:36.425659 140028820076352 transport.py:157] Attempting refresh to obtain initial access_token
I0330 18:41:36.487405 140028820076352 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0330 18:41:37.105757 140028820076352 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0330 18:41:37.106309 140028820076352 transport.py:157] Attempting refresh to obtain initial access_token
2021-03-30 18:41:37.171155: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0330 18:41:37.172003 140028820076352 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0330 18:41:37.315569 140028820076352 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0330 18:41:37.315821 140028820076352 transport.py:157] Attempting refresh to obtain initial access_token
I0330 18:41:37.356901 140028820076352 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0330 18:41:37.497318 140028820076352 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0330 18:41:37.497642 140028820076352 transport.py:157] Attempting refresh to obtain initial access_token
2021-03-30 18:41:37.545206: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-03-30 18:41:37.565825: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.124.160.50:8470}
2021-03-30 18:41:37.565910: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:56107}
2021-03-30 18:42:15.981886: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.124.160.50:8470}
2021-03-30 18:42:15.982016: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:56107}
2021-03-30 18:42:15.983391: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:56107
I0330 18:42:15.985548 140028820076352 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-7
I0330 18:42:15.990571 140028820076352 tpu_strategy_util.py:74] Initializing the TPU system: node-7
INFO:tensorflow:Clearing out eager caches
I0330 18:42:24.787979 140028820076352 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0330 18:42:24.790139 140028820076352 tpu_strategy_util.py:133] Finished initializing TPU system.
I0330 18:42:24.791883 140028820076352 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0330 18:42:24.936270 140028820076352 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0330 18:42:24.936543 140028820076352 transport.py:157] Attempting refresh to obtain initial access_token
I0330 18:42:24.990038 140028820076352 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0330 18:42:25.606618 140028820076352 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7?alt=json
I0330 18:42:25.606888 140028820076352 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0330 18:42:25.663949 140028820076352 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0330 18:42:25.664265 140028820076352 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0330 18:42:25.664751 140028820076352 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0330 18:42:25.664853 140028820076352 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0330 18:42:25.664914 140028820076352 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0330 18:42:25.665216 140028820076352 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0330 18:42:25.665309 140028820076352 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0330 18:42:25.665407 140028820076352 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0330 18:42:25.665477 140028820076352 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0330 18:42:25.665535 140028820076352 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0330 18:42:25.665585 140028820076352 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0330 18:42:25.665631 140028820076352 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0330 18:42:25.665713 140028820076352 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0330 18:42:25.665766 140028820076352 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0330 18:42:25.665812 140028820076352 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0330 18:42:25.665858 140028820076352 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0330 18:42:25.695191 140028820076352 train_utils.py:214] Running default trainer.
2021-03-30 18:42:25.711698: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 2.0, '4': 1.75, '5': 1.5}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': True, '4': True, '5': True}, 'use_nms': True, 'iou_thresh': 0.2, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 320, 'max_process_size': 608, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'jitter_boxes': 0.1, 'aug_rand_transalate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_zoom': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_angle': 5.0, 'use_tie_breaker': True, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.955, 'crop_area': [0.3, 0.35], 'random_crop': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 320, 'max_process_size': 608, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'jitter_boxes': 0.3, 'aug_rand_transalate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_zoom': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_angle': 15.0, 'use_tie_breaker': True, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.9, 'crop_area': [0.3, 0.35], 'random_crop': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': True, 'momentum': 0.949}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [50000, 56250], 'values': [0.00261, 0.000261, 2.61e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 5000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 62500, 'validation_steps': 625, 'validation_interval': 5000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
{'3': 2.0, '4': 1.75, '5': 1.5} 0.00025
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.07, '4': 0.07, '5': 0.07}, 'cls_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'obj_normalizer': {'3': 1.0, '4': 1.0, '5': 1.0}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': False, '4': False, '5': False}, 'scale_xy': {'3': 2.0, '4': 1.75, '5': 1.5}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': True, '4': True, '5': True}, 'use_nms': True, 'iou_thresh': 0.2, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': False}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f5a98414b70>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
route_split 512.0 512.0
conv2 512.0
conv1 512.0
spp
conv1 512.0
conv2 512.0
connect
conv1 512.0
8
(None, 16, 16, 512) (None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 2048)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 1024)
(None, 16, 16, 512)
route_split 256.0 256.0
conv2 256.0
conv1 256.0
conv2 256.0
connect
conv1 256.0
6
(None, 32, 32, 256) (None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 32, 32, 256)








 ListWrapper([128, 256, 512])
route_split 128 128
conv2 128
conv1 128
conv2 128
connect
conv1 128
conv2 256
7
(None, 64, 64, 128) (None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 256)
(None, 64, 64, 128)
(None, 64, 64, 256)
route_split 256 256
conv2 256
conv1 256
conv2 256
connect
conv1 256
conv2 512
7
(None, 32, 32, 256) (None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 32, 32, 256)
(None, 32, 32, 512)
route_split 512 512
conv2 512
conv1 512
conv2 512
connect
conv1 512
conv2 1024
7
(None, 16, 16, 512) (None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 1024)
(None, 16, 16, 512)
(None, 16, 16, 1024)
detget {'3': 2.0, '4': 1.75, '5': 1.5}
(None, 16, 16, 512) (None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 2048)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 1024)
(None, 16, 16, 512)
(None, 32, 32, 256) (None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 32, 32, 256)
(None, 64, 64, 128) (None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 256)
(None, 64, 64, 128)
(None, 64, 64, 256)
(None, 32, 32, 256) (None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)I0330 18:43:17.128107 140028820076352 controller.py:362] restoring or initializing model...
I0330 18:43:25.259883 140028820076352 yolo.py:484] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0330 18:43:25.262365 140028820076352 controller.py:368] initialized model.
I0330 18:43:25.262670 140028820076352 train_lib.py:96] Starts to execute mode: train_and_eval
I0330 18:43:25.269592 140028820076352 controller.py:211] train | step:      0 | training until step 5000...
I0330 18:43:32.672822 140028820076352 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0330 18:44:30.195545 140028820076352 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0330 19:29:06.156561 140028820076352 controller.py:425] train | step:   5000 | steps/sec:    1.8 | output: 
    {'avg_iou_3': 0.4636157,
     'avg_iou_4': 0.55637354,
     'avg_iou_5': 0.61399347,
     'avg_obj_3': 0.18733841,
     'avg_obj_4': 0.29473752,
     'avg_obj_5': 0.39747328,
     'box_loss_3': 2.9618075,
     'box_loss_4': 1.9546355,
     'box_loss_5': 0.6243806,
     'class_loss_3': 322.42554,
     'class_loss_4': 257.64368,
     'class_loss_5': 98.89611,
     'conf_loss_3': 392.8695,
     'conf_loss_4': 221.61333,
     'conf_loss_5': 66.67923,
     'learning_rate': 0.00261,
     'recall50_3': 0.101865694,
     'recall50_4': 0.23255263,
     'recall50_5': 0.36941522,
     'total_loss': 1365.668,
     'training_loss': 1365.668}
I0330 19:30:09.194654 140028820076352 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-5000.
I0330 19:30:09.201243 140028820076352 controller.py:252]  eval | step:   5000 | running 625 steps of evaluation...
I0330 19:30:13.163808 140028820076352 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0330 19:30:31.754459 140028820076352 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0330 19:35:30.859305 140028820076352 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0330 19:39:38.825036 140028820076352 controller.py:261]  eval | step:   5000 | eval time:  569.6 sec | output: 
    {'AP': 0.122632794,
     'AP50': 0.2812669,
     'AP75': 0.08588856,
     'APl': 0.1830435,
     'APm': 0.12930672,
     'APs': 0.03232668,
     'ARl': 0.27632406,
     'ARm': 0.24186535,
     'ARmax1': 0.13381228,
     'ARmax10': 0.21176538,
     'ARmax100': 0.22333494,
     'ARs': 0.0823466,
     'avg_iou_3': 0.3968001,
     'avg_iou_4': 0.5905602,
     'avg_iou_5': 0.65822756,
     'avg_obj_3': 0.20733477,
     'avg_obj_4': 0.3876083,
     'avg_obj_5': 0.50342375,
     'box_loss_3': 0.92873865,
     'box_loss_4': 0.65696204,
     'box_loss_5': 0.27916953,
     'class_loss_3': 35.8472,
     'class_loss_4': 29.289263,
     'class_loss_5': 14.800284,
     'conf_loss_3': 99.69188,
     'conf_loss_4': 79.16117,
     'conf_loss_5': 33.599537,
     'recall50_3': 0.17719166,
     'recall50_4': 0.38064852,
     'recall50_5': 0.51245576,
     'total_loss': 294.2542,
     'validation_loss': 294.2542}
I0330 19:40:09.971208 140028820076352 controller.py:211] train | step:   5000 | training until step 10000...
I0330 20:18:23.371792 140028820076352 controller.py:425] train | step:  10000 | steps/sec:    1.7 | output: 
    {'avg_iou_3': 0.5324627,
     'avg_iou_4': 0.6465072,
     'avg_iou_5': 0.7042502,
     'avg_obj_3': 0.26167122,
     'avg_obj_4': 0.40667975,
     'avg_obj_5': 0.5256861,
     'box_loss_3': 2.5826964,
     'box_loss_4': 1.5586135,
     'box_loss_5': 0.4787789,
     'class_loss_3': 113.62149,
     'class_loss_4': 79.97153,
     'class_loss_5': 28.552618,
     'conf_loss_3': 232.92943,
     'conf_loss_4': 164.72325,
     'conf_loss_5': 50.24055,
     'learning_rate': 0.00261,
     'recall50_3': 0.18011627,
     'recall50_4': 0.37916437,
     'recall50_5': 0.5415693,
     'total_loss': 674.6581,
     'training_loss': 674.6581}

(None, 32, 32, 512)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 16, 16, 512) (None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 1024)
(None, 16, 16, 512)
(None, 16, 16, 1024)
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
{'3': 2.0, '4': 1.75, '5': 1.5}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4), num_detections: (8,), upds: {3: (8, 400, 8), 4: (8, 400, 8), 5: (8, 400, 8)}, inds: {3: (8, 400, 3), 4: (8, 400, 3), 5: (8, 400, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
{'3': 2.0, '4': 1.75, '5': 1.5}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 400, 8), 4: (1, 400, 8), 5: (1, 400, 8)}, inds: {3: (1, 400, 3), 4: (1, 400, 3), 5: (1, 400, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 5000...
(8, 16, 16, 512) (8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 2048)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 1024)
(8, 16, 16, 512)
(8, 32, 32, 256) (8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 512)
(8, 32, 32, 256)
(8, 64, 64, 128) (8, 64, 64, 128)
(8, 64, 64, 128)
(8, 64, 64, 128)
(8, 64, 64, 128)
(8, 64, 64, 256)
(8, 64, 64, 128)
(8, 64, 64, 256)
(8, 32, 32, 256) (8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 512)
(8, 32, 32, 256)
(8, 32, 32, 512)
(8, 16, 16, 512) (8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 1024)
(8, 16, 16, 512)
(8, 16, 16, 1024)
(8, 16, 16, 512) (8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 2048)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 1024)
(8, 16, 16, 512)
(8, 32, 32, 256) (8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 512)
(8, 32, 32, 256)
(8, 64, 64, 128) (8, 64, 64, 128)
(8, 64, 64, 128)
(8, 64, 64, 128)
(8, 64, 64, 128)
(8, 64, 64, 256)
(8, 64, 64, 128)
(8, 64, 64, 256)
(8, 32, 32, 256) (8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 512)
(8, 32, 32, 256)
(8, 32, 32, 512)
(8, 16, 16, 512) (8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 1024)
(8, 16, 16, 512)
(8, 16, 16, 1024)
train | step:   5000 | steps/sec:    1.8 | output: 
    {'avg_iou_3': 0.4636157,
     'avg_iou_4': 0.55637354,
     'avg_iou_5': 0.61399347,
     'avg_obj_3': 0.18733841,
     'avg_obj_4': 0.29473752,
     'avg_obj_5': 0.39747328,
     'box_loss_3': 2.9618075,
     'box_loss_4': 1.9546355,
     'box_loss_5': 0.6243806,
     'class_loss_3': 322.42554,
     'class_loss_4': 257.64368,
     'class_loss_5': 98.89611,
     'conf_loss_3': 392.8695,
     'conf_loss_4': 221.61333,
     'conf_loss_5': 66.67923,
     'learning_rate': 0.00261,
     'recall50_3': 0.101865694,
     'recall50_4': 0.23255263,
     'recall50_5': 0.36941522,
     'total_loss': 1365.668,
     'training_loss': 1365.668}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-5000.
 eval | step:   5000 | running 625 steps of evaluation...
(1, 16, 16, 512) (1, 16, 16, 512)
(1, 16, 16, 512)
(1, 16, 16, 512)
(1, 16, 16, 2048)
(1, 16, 16, 512)
(1, 16, 16, 512)
(1, 16, 16, 1024)
(1, 16, 16, 512)
(1, 32, 32, 256) (1, 32, 32, 256)
(1, 32, 32, 256)
(1, 32, 32, 256)
(1, 32, 32, 256)
(1, 32, 32, 512)
(1, 32, 32, 256)
(1, 64, 64, 128) (1, 64, 64, 128)
(1, 64, 64, 128)
(1, 64, 64, 128)
(1, 64, 64, 128)
(1, 64, 64, 256)
(1, 64, 64, 128)
(1, 64, 64, 256)
(1, 32, 32, 256) (1, 32, 32, 256)
(1, 32, 32, 256)
(1, 32, 32, 256)
(1, 32, 32, 256)
(1, 32, 32, 512)
(1, 32, 32, 256)
(1, 32, 32, 512)
(1, 16, 16, 512) (1, 16, 16, 512)
(1, 16, 16, 512)
(1, 16, 16, 512)
(1, 16, 16, 512)
(1, 16, 16, 1024)
(1, 16, 16, 512)
(1, 16, 16, 1024)
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=183.90s).
Accumulating evaluation results...
DONE (t=3.58s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.123
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.281
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.086
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.032
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.129
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.183
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.134
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.212
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.223
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.082
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.242
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.276
 eval | step:   5000 | eval time:  569.6 sec | output: 
    {'AP': 0.122632794,
     'AP50': 0.2812669,
     'AP75': 0.08588856,
     'APl': 0.1830435,
     'APm': 0.12930672,
     'APs': 0.03232668,
     'ARl': 0.27632406,
     'ARm': 0.24186535,
     'ARmax1': 0.13381228,
     'ARmax10': 0.21176538,
     'ARmax100': 0.22333494,
     'ARs': 0.0823466,
     'avg_iou_3': 0.3968001,
     'avg_iou_4': 0.5905602,
     'avg_iou_5': 0.65822756,
     'avg_obj_3': 0.20733477,
     'avg_obj_4': 0.3876083,
     'avg_obj_5': 0.50342375,
     'box_loss_3': 0.92873865,
     'box_loss_4': 0.65696204,
     'box_loss_5': 0.27916953,
     'class_loss_3': 35.8472,
     'class_loss_4': 29.289263,
     'class_loss_5': 14.800284,
     'conf_loss_3': 99.69188,
     'conf_loss_4': 79.16117,
     'conf_loss_5': 33.599537,
     'recall50_3': 0.17719166,
     'recall50_4': 0.38064852,
     'recall50_5': 0.51245576,
     'total_loss': 294.2542,
     'validation_loss': 294.2542}
train | step:   5000 | training until step 10000...
train | step:  10000 | steps/sec:    1.7 | output: 
    {'avg_iou_3': 0.5324627,
     'avg_iou_4': 0.6465072,
     'avg_iou_5': 0.7042502,
     'avg_obj_3': 0.26167122,
     'avg_obj_4': 0.40667975,
     'avg_obj_5': 0.5256861,
     'box_loss_3': 2.5826964,
     'box_loss_4': 1.5586135,
     'box_loss_5': 0.4787789,
     'class_loss_3': 113.62149,
     'class_loss_4': 79.97153,
     'class_loss_5': 28.552618,
     'conf_loss_3': 232.92943,
     'conf_loss_4': 164.72325,
     'conf_loss_5': 50.24055,
     'learning_rate': 0.00261,
     'recall50_3': 0.18011627,
     'recall50_4': 0.37916437,
     'recall50_5': 0.5415693,
     'total_loss': 674.6581,
     'training_loss': 674.6581}I0330 20:19:18.045459 140028820076352 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-10000.
I0330 20:19:18.050941 140028820076352 controller.py:252]  eval | step:  10000 | running 625 steps of evaluation...
I0330 20:23:24.788156 140028820076352 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0330 20:27:25.327394 140028820076352 controller.py:261]  eval | step:  10000 | eval time:  487.3 sec | output: 
    {'AP': 0.17384088,
     'AP50': 0.35981232,
     'AP75': 0.14531808,
     'APl': 0.2500108,
     'APm': 0.18271826,
     'APs': 0.05030677,
     'ARl': 0.34636492,
     'ARm': 0.28926522,
     'ARmax1': 0.16829652,
     'ARmax10': 0.2587666,
     'ARmax100': 0.27154824,
     'ARs': 0.10527069,
     'avg_iou_3': 0.41453803,
     'avg_iou_4': 0.6175814,
     'avg_iou_5': 0.6862145,
     'avg_obj_3': 0.22284035,
     'avg_obj_4': 0.42657524,
     'avg_obj_5': 0.55745566,
     'box_loss_3': 0.8835731,
     'box_loss_4': 0.605499,
     'box_loss_5': 0.25505242,
     'class_loss_3': 30.049166,
     'class_loss_4': 23.773191,
     'class_loss_5': 12.094784,
     'conf_loss_3': 94.143105,
     'conf_loss_4': 76.90772,
     'conf_loss_5': 32.78817,
     'recall50_3': 0.19711162,
     'recall50_4': 0.43173698,
     'recall50_5': 0.5786297,
     'total_loss': 271.50012,
     'validation_loss': 271.50012}
I0330 20:27:56.485582 140028820076352 controller.py:211] train | step:  10000 | training until step 15000...
I0330 21:06:55.290564 140028820076352 controller.py:425] train | step:  15000 | steps/sec:    1.7 | output: 
    {'avg_iou_3': 0.54780114,
     'avg_iou_4': 0.66753924,
     'avg_iou_5': 0.7231427,
     'avg_obj_3': 0.29181537,
     'avg_obj_4': 0.44977725,
     'avg_obj_5': 0.5701868,
     'box_loss_3': 2.5110593,
     'box_loss_4': 1.4711401,
     'box_loss_5': 0.44844586,
     'class_loss_3': 99.60164,
     'class_loss_4': 67.80746,
     'class_loss_5': 24.091196,
     'conf_loss_3': 227.55972,
     'conf_loss_4': 161.4298,
     'conf_loss_5': 49.38938,
     'learning_rate': 0.00261,
     'recall50_3': 0.21633051,
     'recall50_4': 0.43596175,
     'recall50_5': 0.59750324,
     'total_loss': 634.3092,
     'training_loss': 634.3092}
I0330 21:07:51.236856 140028820076352 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-15000.
I0330 21:07:51.242557 140028820076352 controller.py:252]  eval | step:  15000 | running 625 steps of evaluation...
I0330 21:12:00.499441 140028820076352 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0330 21:16:03.431317 140028820076352 controller.py:261]  eval | step:  15000 | eval time:  492.2 sec | output: 
    {'AP': 0.2040284,
     'AP50': 0.4012407,
     'AP75': 0.18345818,
     'APl': 0.28942028,
     'APm': 0.21195957,
     'APs': 0.068167046,
     'ARl': 0.3841765,
     'ARm': 0.31621432,
     'ARmax1': 0.18865241,
     'ARmax10': 0.28688115,
     'ARmax100': 0.2991814,
     'ARs': 0.12484427,
     'avg_iou_3': 0.42309868,
     'avg_iou_4': 0.63037753,
     'avg_iou_5': 0.70072,
     'avg_obj_3': 0.23338589,
     'avg_obj_4': 0.4475455,
     'avg_obj_5': 0.5859004,
     'box_loss_3': 0.8603086,
     'box_loss_4': 0.5809883,
     'box_loss_5': 0.24239379,
     'class_loss_3': 27.419348,
     'class_loss_4': 21.456812,
     'class_loss_5': 10.853355,
     'conf_loss_3': 92.1834,
     'conf_loss_4': 76.48035,
     'conf_loss_5': 32.43569,
     'recall50_3': 0.21226323,
     'recall50_4': 0.45768595,
     'recall50_5': 0.61284596,
     'total_loss': 262.51266,
     'validation_loss': 262.51266}
I0330 21:16:33.329659 140028820076352 controller.py:211] train | step:  15000 | training until step 20000...
I0330 22:06:38.165760 140028820076352 controller.py:425] train | step:  20000 | steps/sec:    1.4 | output: 
    {'avg_iou_3': 0.5571885,
     'avg_iou_4': 0.6794586,
     'avg_iou_5': 0.73460144,
     'avg_obj_3': 0.31126812,
     'avg_obj_4': 0.47624767,
     'avg_obj_5': 0.5969814,
     'box_loss_3': 2.4519002,
     'box_loss_4': 1.4144976,
     'box_loss_5': 0.4284385,
     'class_loss_3': 90.62455,
     'class_loss_4': 60.38965,
     'class_loss_5': 21.435396,
     'conf_loss_3': 223.01527,
     'conf_loss_4': 159.53133,
     'conf_loss_5': 48.545097,
     'learning_rate': 0.00261,
     'recall50_3': 0.23996411,
     'recall50_4': 0.46951357,
     'recall50_5': 0.62872005,
     'total_loss': 607.83594,
     'training_loss': 607.83594}
I0330 22:07:33.830121 140028820076352 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-20000.
I0330 22:07:33.836692 140028820076352 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0330 22:11:43.972892 140028820076352 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0330 22:15:41.821929 140028820076352 controller.py:261]  eval | step:  20000 | eval time:  488.0 sec | output: 
    {'AP': 0.22271588,
     'AP50': 0.42741942,
     'AP75': 0.20716238,
     'APl': 0.3156905,
     'APm': 0.23093891,
     'APs': 0.0746977,
     'ARl': 0.41352808,
     'ARm': 0.33319163,
     'ARmax1': 0.20080043,
     'ARmax10': 0.3041422,
     'ARmax100': 0.31678972,
     'ARs': 0.13779812,
     'avg_iou_3': 0.4288372,
     'avg_iou_4': 0.6387706,
     'avg_iou_5': 0.7093056,
     'avg_obj_3': 0.24114993,
     'avg_obj_4': 0.4633272,
     'avg_obj_5': 0.60223216,
     'box_loss_3': 0.84521824,
     'box_loss_4': 0.5643013,
     'box_loss_5': 0.23460488,
     'class_loss_3': 26.085138,
     'class_loss_4': 20.260792,
     'class_loss_5': 10.178989,
     'conf_loss_3': 91.58254,
     'conf_loss_4': 76.67691,
     'conf_loss_5': 32.244957,
     'recall50_3': 0.22348677,
     'recall50_4': 0.4781511,
     'recall50_5': 0.63222903,
     'total_loss': 258.67346,
     'validation_loss': 258.67346}

saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-10000.
 eval | step:  10000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=184.34s).
Accumulating evaluation results...
DONE (t=3.47s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.174
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.360
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.145
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.050
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.183
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.250
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.168
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.259
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.272
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.105
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.289
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.346
 eval | step:  10000 | eval time:  487.3 sec | output: 
    {'AP': 0.17384088,
     'AP50': 0.35981232,
     'AP75': 0.14531808,
     'APl': 0.2500108,
     'APm': 0.18271826,
     'APs': 0.05030677,
     'ARl': 0.34636492,
     'ARm': 0.28926522,
     'ARmax1': 0.16829652,
     'ARmax10': 0.2587666,
     'ARmax100': 0.27154824,
     'ARs': 0.10527069,
     'avg_iou_3': 0.41453803,
     'avg_iou_4': 0.6175814,
     'avg_iou_5': 0.6862145,
     'avg_obj_3': 0.22284035,
     'avg_obj_4': 0.42657524,
     'avg_obj_5': 0.55745566,
     'box_loss_3': 0.8835731,
     'box_loss_4': 0.605499,
     'box_loss_5': 0.25505242,
     'class_loss_3': 30.049166,
     'class_loss_4': 23.773191,
     'class_loss_5': 12.094784,
     'conf_loss_3': 94.143105,
     'conf_loss_4': 76.90772,
     'conf_loss_5': 32.78817,
     'recall50_3': 0.19711162,
     'recall50_4': 0.43173698,
     'recall50_5': 0.5786297,
     'total_loss': 271.50012,
     'validation_loss': 271.50012}
train | step:  10000 | training until step 15000...
train | step:  15000 | steps/sec:    1.7 | output: 
    {'avg_iou_3': 0.54780114,
     'avg_iou_4': 0.66753924,
     'avg_iou_5': 0.7231427,
     'avg_obj_3': 0.29181537,
     'avg_obj_4': 0.44977725,
     'avg_obj_5': 0.5701868,
     'box_loss_3': 2.5110593,
     'box_loss_4': 1.4711401,
     'box_loss_5': 0.44844586,
     'class_loss_3': 99.60164,
     'class_loss_4': 67.80746,
     'class_loss_5': 24.091196,
     'conf_loss_3': 227.55972,
     'conf_loss_4': 161.4298,
     'conf_loss_5': 49.38938,
     'learning_rate': 0.00261,
     'recall50_3': 0.21633051,
     'recall50_4': 0.43596175,
     'recall50_5': 0.59750324,
     'total_loss': 634.3092,
     'training_loss': 634.3092}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-15000.
 eval | step:  15000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=185.53s).
Accumulating evaluation results...
DONE (t=3.39s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.204
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.401
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.183
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.068
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.212
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.289
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.189
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.287
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.299
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.125
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.316
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.384
 eval | step:  15000 | eval time:  492.2 sec | output: 
    {'AP': 0.2040284,
     'AP50': 0.4012407,
     'AP75': 0.18345818,
     'APl': 0.28942028,
     'APm': 0.21195957,
     'APs': 0.068167046,
     'ARl': 0.3841765,
     'ARm': 0.31621432,
     'ARmax1': 0.18865241,
     'ARmax10': 0.28688115,
     'ARmax100': 0.2991814,
     'ARs': 0.12484427,
     'avg_iou_3': 0.42309868,
     'avg_iou_4': 0.63037753,
     'avg_iou_5': 0.70072,
     'avg_obj_3': 0.23338589,
     'avg_obj_4': 0.4475455,
     'avg_obj_5': 0.5859004,
     'box_loss_3': 0.8603086,
     'box_loss_4': 0.5809883,
     'box_loss_5': 0.24239379,
     'class_loss_3': 27.419348,
     'class_loss_4': 21.456812,
     'class_loss_5': 10.853355,
     'conf_loss_3': 92.1834,
     'conf_loss_4': 76.48035,
     'conf_loss_5': 32.43569,
     'recall50_3': 0.21226323,
     'recall50_4': 0.45768595,
     'recall50_5': 0.61284596,
     'total_loss': 262.51266,
     'validation_loss': 262.51266}
train | step:  15000 | training until step 20000...
train | step:  20000 | steps/sec:    1.4 | output: 
    {'avg_iou_3': 0.5571885,
     'avg_iou_4': 0.6794586,
     'avg_iou_5': 0.73460144,
     'avg_obj_3': 0.31126812,
     'avg_obj_4': 0.47624767,
     'avg_obj_5': 0.5969814,
     'box_loss_3': 2.4519002,
     'box_loss_4': 1.4144976,
     'box_loss_5': 0.4284385,
     'class_loss_3': 90.62455,
     'class_loss_4': 60.38965,
     'class_loss_5': 21.435396,
     'conf_loss_3': 223.01527,
     'conf_loss_4': 159.53133,
     'conf_loss_5': 48.545097,
     'learning_rate': 0.00261,
     'recall50_3': 0.23996411,
     'recall50_4': 0.46951357,
     'recall50_5': 0.62872005,
     'total_loss': 607.83594,
     'training_loss': 607.83594}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-20000.
 eval | step:  20000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=184.65s).
Accumulating evaluation results...
DONE (t=3.47s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.223
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.427
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.207
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.075
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.231
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.316
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.201
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.304
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.317
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.138
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.333
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.414
 eval | step:  20000 | eval time:  488.0 sec | output: 
    {'AP': 0.22271588,
     'AP50': 0.42741942,
     'AP75': 0.20716238,
     'APl': 0.3156905,
     'APm': 0.23093891,
     'APs': 0.0746977,
     'ARl': 0.41352808,
     'ARm': 0.33319163,
     'ARmax1': 0.20080043,
     'ARmax10': 0.3041422,
     'ARmax100': 0.31678972,
     'ARs': 0.13779812,
     'avg_iou_3': 0.4288372,
     'avg_iou_4': 0.6387706,
     'avg_iou_5': 0.7093056,
     'avg_obj_3': 0.24114993,
     'avg_obj_4': 0.4633272,
     'avg_obj_5': 0.60223216,
     'box_loss_3': 0.84521824,
     'box_loss_4': 0.5643013,
     'box_loss_5': 0.23460488,
     'class_loss_3': 26.085138,
     'class_loss_4': 20.260792,
     'class_loss_5': 10.178989,
     'conf_loss_3': 91.58254,
     'conf_loss_4': 76.67691,
     'conf_loss_5': 32.244957,
     'recall50_3': 0.22348677,
     'recall50_4': 0.4781511,
     'recall50_5': 0.63222903,
     'total_loss': 258.67346,
     'validation_loss': 258.67346}I0330 22:16:07.089952 140028820076352 controller.py:211] train | step:  20000 | training until step 25000...
I0330 23:04:42.279444 140028820076352 controller.py:425] train | step:  25000 | steps/sec:    1.4 | output: 
    {'avg_iou_3': 0.5634123,
     'avg_iou_4': 0.6877387,
     'avg_iou_5': 0.74197966,
     'avg_obj_3': 0.3254239,
     'avg_obj_4': 0.49519384,
     'avg_obj_5': 0.61526376,
     'box_loss_3': 2.4163558,
     'box_loss_4': 1.378442,
     'box_loss_5': 0.4162512,
     'class_loss_3': 84.54465,
     'class_loss_4': 55.448868,
     'class_loss_5': 19.672709,
     'conf_loss_3': 221.09958,
     'conf_loss_4': 158.58302,
     'conf_loss_5': 48.18865,
     'learning_rate': 0.00261,
     'recall50_3': 0.25766808,
     'recall50_4': 0.49368915,
     'recall50_5': 0.65026474,
     'total_loss': 591.7483,
     'training_loss': 591.7483}
I0330 23:05:36.167919 140028820076352 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-25000.
I0330 23:05:36.174605 140028820076352 controller.py:252]  eval | step:  25000 | running 625 steps of evaluation...
I0330 23:09:43.026904 140028820076352 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0330 23:14:01.308335 140028820076352 controller.py:261]  eval | step:  25000 | eval time:  505.1 sec | output: 
    {'AP': 0.23547432,
     'AP50': 0.44655576,
     'AP75': 0.22192982,
     'APl': 0.3316515,
     'APm': 0.2459757,
     'APs': 0.08454784,
     'ARl': 0.4254144,
     'ARm': 0.3506364,
     'ARmax1': 0.20915452,
     'ARmax10': 0.31547418,
     'ARmax100': 0.32931566,
     'ARs': 0.14346407,
     'avg_iou_3': 0.4328429,
     'avg_iou_4': 0.64476526,
     'avg_iou_5': 0.71514446,
     'avg_obj_3': 0.24679297,
     'avg_obj_4': 0.47707486,
     'avg_obj_5': 0.61635023,
     'box_loss_3': 0.83503914,
     'box_loss_4': 0.5531752,
     'box_loss_5': 0.22926714,
     'class_loss_3': 25.061838,
     'class_loss_4': 19.30413,
     'class_loss_5': 9.638123,
     'conf_loss_3': 91.60975,
     'conf_loss_4': 76.70335,
     'conf_loss_5': 32.106236,
     'recall50_3': 0.23096277,
     'recall50_4': 0.4959115,
     'recall50_5': 0.64924365,
     'total_loss': 256.04095,
     'validation_loss': 256.04095}
I0330 23:14:24.868135 140028820076352 controller.py:211] train | step:  25000 | training until step 30000...
I0330 23:52:47.869522 140028820076352 controller.py:425] train | step:  30000 | steps/sec:    1.7 | output: 
    {'avg_iou_3': 0.5687272,
     'avg_iou_4': 0.6941867,
     'avg_iou_5': 0.7482881,
     'avg_obj_3': 0.33738586,
     'avg_obj_4': 0.51089907,
     'avg_obj_5': 0.63022745,
     'box_loss_3': 2.3836749,
     'box_loss_4': 1.3465044,
     'box_loss_5': 0.40468964,
     'class_loss_3': 79.81152,
     'class_loss_4': 51.684654,
     'class_loss_5': 18.333254,
     'conf_loss_3': 217.75473,
     'conf_loss_4': 157.50612,
     'conf_loss_5': 47.53285,
     'learning_rate': 0.00261,
     'recall50_3': 0.27092487,
     'recall50_4': 0.5129423,
     'recall50_5': 0.6677691,
     'total_loss': 576.75916,
     'training_loss': 576.75916}
I0330 23:53:48.254822 140028820076352 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-30000.
I0330 23:53:48.260901 140028820076352 controller.py:252]  eval | step:  30000 | running 625 steps of evaluation...
I0330 23:57:56.963400 140028820076352 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0331 00:02:23.278639 140028820076352 controller.py:261]  eval | step:  30000 | eval time:  515.0 sec | output: 
    {'AP': 0.24478215,
     'AP50': 0.4572262,
     'AP75': 0.23667179,
     'APl': 0.34718823,
     'APm': 0.25528774,
     'APs': 0.089841515,
     'ARl': 0.4407175,
     'ARm': 0.3589516,
     'ARmax1': 0.21633035,
     'ARmax10': 0.32440454,
     'ARmax100': 0.33781117,
     'ARs': 0.1495518,
     'avg_iou_3': 0.43514174,
     'avg_iou_4': 0.6489218,
     'avg_iou_5': 0.719485,
     'avg_obj_3': 0.25122625,
     'avg_obj_4': 0.4842394,
     'avg_obj_5': 0.62679005,
     'box_loss_3': 0.8278829,
     'box_loss_4': 0.5449655,
     'box_loss_5': 0.22531801,
     'class_loss_3': 24.534971,
     'class_loss_4': 18.65955,
     'class_loss_5': 9.327286,
     'conf_loss_3': 91.13018,
     'conf_loss_4': 76.85781,
     'conf_loss_5': 31.956337,
     'recall50_3': 0.2371835,
     'recall50_4': 0.5033494,
     'recall50_5': 0.6606895,
     'total_loss': 254.06415,
     'validation_loss': 254.06415}
I0331 00:02:41.763192 140028820076352 controller.py:211] train | step:  30000 | training until step 35000...
I0331 00:43:33.456187 140028820076352 controller.py:425] train | step:  35000 | steps/sec:    1.6 | output: 
    {'avg_iou_3': 0.5728878,
     'avg_iou_4': 0.69943696,
     'avg_iou_5': 0.75333095,
     'avg_obj_3': 0.34728846,
     'avg_obj_4': 0.52397007,
     'avg_obj_5': 0.642743,
     'box_loss_3': 2.3676684,
     'box_loss_4': 1.3278855,
     'box_loss_5': 0.39750236,
     'class_loss_3': 76.42238,
     'class_loss_4': 48.95353,
     'class_loss_5': 17.308624,
     'conf_loss_3': 216.56058,
     'conf_loss_4': 156.34233,
     'conf_loss_5': 47.415615,
     'learning_rate': 0.00261,
     'recall50_3': 0.2844595,
     'recall50_4': 0.5293131,
     'recall50_5': 0.68205523,
     'total_loss': 567.0962,
     'training_loss': 567.0962}
I0331 00:44:27.284945 140028820076352 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-35000.
I0331 00:44:27.290946 140028820076352 controller.py:252]  eval | step:  35000 | running 625 steps of evaluation...
I0331 00:48:33.786525 140028820076352 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0331 00:53:22.330200 140028820076352 controller.py:261]  eval | step:  35000 | eval time:  535.0 sec | output: 
    {'AP': 0.25400966,
     'AP50': 0.46889237,
     'AP75': 0.24913318,
     'APl': 0.3662599,
     'APm': 0.26458758,
     'APs': 0.09325936,
     'ARl': 0.45613384,
     'ARm': 0.36579737,
     'ARmax1': 0.22295177,
     'ARmax10': 0.33245865,
     'ARmax100': 0.34597582,
     'ARs': 0.15063728,
     'avg_iou_3': 0.43785772,
     'avg_iou_4': 0.6519539,
     'avg_iou_5': 0.72402817,
     'avg_obj_3': 0.25638708,
     'avg_obj_4': 0.48995996,
     'avg_obj_5': 0.6337064,
     'box_loss_3': 0.8210448,
     'box_loss_4': 0.538719,
     'box_loss_5': 0.22138242,
     'class_loss_3': 24.092455,
     'class_loss_4': 18.160503,
     'class_loss_5': 9.042606,
     'conf_loss_3': 90.67937,
     'conf_loss_4': 76.48207,
     'conf_loss_5': 32.112217,
     'recall50_3': 0.24408977,
     'recall50_4': 0.51165503,
     'recall50_5': 0.6674352,
     'total_loss': 252.15033,
     'validation_loss': 252.15033}

train | step:  20000 | training until step 25000...
train | step:  25000 | steps/sec:    1.4 | output: 
    {'avg_iou_3': 0.5634123,
     'avg_iou_4': 0.6877387,
     'avg_iou_5': 0.74197966,
     'avg_obj_3': 0.3254239,
     'avg_obj_4': 0.49519384,
     'avg_obj_5': 0.61526376,
     'box_loss_3': 2.4163558,
     'box_loss_4': 1.378442,
     'box_loss_5': 0.4162512,
     'class_loss_3': 84.54465,
     'class_loss_4': 55.448868,
     'class_loss_5': 19.672709,
     'conf_loss_3': 221.09958,
     'conf_loss_4': 158.58302,
     'conf_loss_5': 48.18865,
     'learning_rate': 0.00261,
     'recall50_3': 0.25766808,
     'recall50_4': 0.49368915,
     'recall50_5': 0.65026474,
     'total_loss': 591.7483,
     'training_loss': 591.7483}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-25000.
 eval | step:  25000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=195.85s).
Accumulating evaluation results...
DONE (t=3.38s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.235
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.447
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.222
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.085
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.246
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.332
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.209
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.315
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.329
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.143
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.351
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.425
 eval | step:  25000 | eval time:  505.1 sec | output: 
    {'AP': 0.23547432,
     'AP50': 0.44655576,
     'AP75': 0.22192982,
     'APl': 0.3316515,
     'APm': 0.2459757,
     'APs': 0.08454784,
     'ARl': 0.4254144,
     'ARm': 0.3506364,
     'ARmax1': 0.20915452,
     'ARmax10': 0.31547418,
     'ARmax100': 0.32931566,
     'ARs': 0.14346407,
     'avg_iou_3': 0.4328429,
     'avg_iou_4': 0.64476526,
     'avg_iou_5': 0.71514446,
     'avg_obj_3': 0.24679297,
     'avg_obj_4': 0.47707486,
     'avg_obj_5': 0.61635023,
     'box_loss_3': 0.83503914,
     'box_loss_4': 0.5531752,
     'box_loss_5': 0.22926714,
     'class_loss_3': 25.061838,
     'class_loss_4': 19.30413,
     'class_loss_5': 9.638123,
     'conf_loss_3': 91.60975,
     'conf_loss_4': 76.70335,
     'conf_loss_5': 32.106236,
     'recall50_3': 0.23096277,
     'recall50_4': 0.4959115,
     'recall50_5': 0.64924365,
     'total_loss': 256.04095,
     'validation_loss': 256.04095}
train | step:  25000 | training until step 30000...
train | step:  30000 | steps/sec:    1.7 | output: 
    {'avg_iou_3': 0.5687272,
     'avg_iou_4': 0.6941867,
     'avg_iou_5': 0.7482881,
     'avg_obj_3': 0.33738586,
     'avg_obj_4': 0.51089907,
     'avg_obj_5': 0.63022745,
     'box_loss_3': 2.3836749,
     'box_loss_4': 1.3465044,
     'box_loss_5': 0.40468964,
     'class_loss_3': 79.81152,
     'class_loss_4': 51.684654,
     'class_loss_5': 18.333254,
     'conf_loss_3': 217.75473,
     'conf_loss_4': 157.50612,
     'conf_loss_5': 47.53285,
     'learning_rate': 0.00261,
     'recall50_3': 0.27092487,
     'recall50_4': 0.5129423,
     'recall50_5': 0.6677691,
     'total_loss': 576.75916,
     'training_loss': 576.75916}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-30000.
 eval | step:  30000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=202.71s).
Accumulating evaluation results...
DONE (t=3.36s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.245
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.457
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.237
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.090
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.255
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.347
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.216
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.324
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.338
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.150
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.359
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.441
 eval | step:  30000 | eval time:  515.0 sec | output: 
    {'AP': 0.24478215,
     'AP50': 0.4572262,
     'AP75': 0.23667179,
     'APl': 0.34718823,
     'APm': 0.25528774,
     'APs': 0.089841515,
     'ARl': 0.4407175,
     'ARm': 0.3589516,
     'ARmax1': 0.21633035,
     'ARmax10': 0.32440454,
     'ARmax100': 0.33781117,
     'ARs': 0.1495518,
     'avg_iou_3': 0.43514174,
     'avg_iou_4': 0.6489218,
     'avg_iou_5': 0.719485,
     'avg_obj_3': 0.25122625,
     'avg_obj_4': 0.4842394,
     'avg_obj_5': 0.62679005,
     'box_loss_3': 0.8278829,
     'box_loss_4': 0.5449655,
     'box_loss_5': 0.22531801,
     'class_loss_3': 24.534971,
     'class_loss_4': 18.65955,
     'class_loss_5': 9.327286,
     'conf_loss_3': 91.13018,
     'conf_loss_4': 76.85781,
     'conf_loss_5': 31.956337,
     'recall50_3': 0.2371835,
     'recall50_4': 0.5033494,
     'recall50_5': 0.6606895,
     'total_loss': 254.06415,
     'validation_loss': 254.06415}
train | step:  30000 | training until step 35000...
train | step:  35000 | steps/sec:    1.6 | output: 
    {'avg_iou_3': 0.5728878,
     'avg_iou_4': 0.69943696,
     'avg_iou_5': 0.75333095,
     'avg_obj_3': 0.34728846,
     'avg_obj_4': 0.52397007,
     'avg_obj_5': 0.642743,
     'box_loss_3': 2.3676684,
     'box_loss_4': 1.3278855,
     'box_loss_5': 0.39750236,
     'class_loss_3': 76.42238,
     'class_loss_4': 48.95353,
     'class_loss_5': 17.308624,
     'conf_loss_3': 216.56058,
     'conf_loss_4': 156.34233,
     'conf_loss_5': 47.415615,
     'learning_rate': 0.00261,
     'recall50_3': 0.2844595,
     'recall50_4': 0.5293131,
     'recall50_5': 0.68205523,
     'total_loss': 567.0962,
     'training_loss': 567.0962}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-35000.
 eval | step:  35000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=219.77s).
Accumulating evaluation results...
DONE (t=5.57s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.254
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.469
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.249
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.093
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.265
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.366
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.223
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.332
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.346
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.151
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.366
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.456
 eval | step:  35000 | eval time:  535.0 sec | output: 
    {'AP': 0.25400966,
     'AP50': 0.46889237,
     'AP75': 0.24913318,
     'APl': 0.3662599,
     'APm': 0.26458758,
     'APs': 0.09325936,
     'ARl': 0.45613384,
     'ARm': 0.36579737,
     'ARmax1': 0.22295177,
     'ARmax10': 0.33245865,
     'ARmax100': 0.34597582,
     'ARs': 0.15063728,
     'avg_iou_3': 0.43785772,
     'avg_iou_4': 0.6519539,
     'avg_iou_5': 0.72402817,
     'avg_obj_3': 0.25638708,
     'avg_obj_4': 0.48995996,
     'avg_obj_5': 0.6337064,
     'box_loss_3': 0.8210448,
     'box_loss_4': 0.538719,
     'box_loss_5': 0.22138242,
     'class_loss_3': 24.092455,
     'class_loss_4': 18.160503,
     'class_loss_5': 9.042606,
     'conf_loss_3': 90.67937,
     'conf_loss_4': 76.48207,
     'conf_loss_5': 32.112217,
     'recall50_3': 0.24408977,
     'recall50_4': 0.51165503,
     'recall50_5': 0.6674352,
     'total_loss': 252.15033,
     'validation_loss': 252.15033}I0331 00:53:45.970049 140028820076352 controller.py:211] train | step:  35000 | training until step 40000...
I0331 01:33:28.270324 140028820076352 controller.py:425] train | step:  40000 | steps/sec:    1.7 | output: 
    {'avg_iou_3': 0.57588494,
     'avg_iou_4': 0.7037824,
     'avg_iou_5': 0.75732344,
     'avg_obj_3': 0.3556997,
     'avg_obj_4': 0.53539693,
     'avg_obj_5': 0.653691,
     'box_loss_3': 2.3453708,
     'box_loss_4': 1.3044523,
     'box_loss_5': 0.3899549,
     'class_loss_3': 73.14958,
     'class_loss_4': 46.237225,
     'class_loss_5': 16.368387,
     'conf_loss_3': 214.72043,
     'conf_loss_4': 155.1372,
     'conf_loss_5': 46.88408,
     'learning_rate': 0.00261,
     'recall50_3': 0.29427236,
     'recall50_4': 0.5433477,
     'recall50_5': 0.6936014,
     'total_loss': 556.5369,
     'training_loss': 556.5369}
I0331 01:34:19.028234 140028820076352 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-40000.
I0331 01:34:19.034227 140028820076352 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0331 01:38:29.505467 140028820076352 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0331 01:42:44.512815 140028820076352 controller.py:261]  eval | step:  40000 | eval time:  505.5 sec | output: 
    {'AP': 0.259176,
     'AP50': 0.476016,
     'AP75': 0.25672245,
     'APl': 0.37477505,
     'APm': 0.27073434,
     'APs': 0.09462599,
     'ARl': 0.46499652,
     'ARm': 0.3743947,
     'ARmax1': 0.22643922,
     'ARmax10': 0.33802715,
     'ARmax100': 0.3522691,
     'ARs': 0.1580513,
     'avg_iou_3': 0.43960044,
     'avg_iou_4': 0.65413934,
     'avg_iou_5': 0.72665036,
     'avg_obj_3': 0.2599571,
     'avg_obj_4': 0.49658945,
     'avg_obj_5': 0.64033103,
     'box_loss_3': 0.8162497,
     'box_loss_4': 0.53404444,
     'box_loss_5': 0.21885441,
     'class_loss_3': 23.829496,
     'class_loss_4': 17.896223,
     'class_loss_5': 8.896596,
     'conf_loss_3': 90.780304,
     'conf_loss_4': 76.07473,
     'conf_loss_5': 32.056614,
     'recall50_3': 0.2491198,
     'recall50_4': 0.5185894,
     'recall50_5': 0.6733289,
     'total_loss': 251.10315,
     'validation_loss': 251.10315}
I0331 01:43:14.633900 140028820076352 controller.py:211] train | step:  40000 | training until step 45000...
I0331 02:27:17.516490 140028820076352 controller.py:425] train | step:  45000 | steps/sec:    1.5 | output: 
    {'avg_iou_3': 0.5786698,
     'avg_iou_4': 0.7078899,
     'avg_iou_5': 0.7608502,
     'avg_obj_3': 0.36403432,
     'avg_obj_4': 0.54551506,
     'avg_obj_5': 0.663225,
     'box_loss_3': 2.337644,
     'box_loss_4': 1.2904091,
     'box_loss_5': 0.3848469,
     'class_loss_3': 70.54167,
     'class_loss_4': 44.249954,
     'class_loss_5': 15.663675,
     'conf_loss_3': 213.61197,
     'conf_loss_4': 153.05707,
     'conf_loss_5': 46.734146,
     'learning_rate': 0.00261,
     'recall50_3': 0.30474615,
     'recall50_4': 0.5552529,
     'recall50_5': 0.7042831,
     'total_loss': 547.8721,
     'training_loss': 547.8721}
I0331 02:28:12.803346 140028820076352 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-45000.
I0331 02:28:12.809145 140028820076352 controller.py:252]  eval | step:  45000 | running 625 steps of evaluation...
I0331 02:32:20.117973 140028820076352 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0331 02:36:20.405728 140028820076352 controller.py:261]  eval | step:  45000 | eval time:  487.6 sec | output: 
    {'AP': 0.26576477,
     'AP50': 0.4831705,
     'AP75': 0.26449686,
     'APl': 0.38483396,
     'APm': 0.2782638,
     'APs': 0.10224493,
     'ARl': 0.47534952,
     'ARm': 0.3803341,
     'ARmax1': 0.23110333,
     'ARmax10': 0.34386444,
     'ARmax100': 0.35827675,
     'ARs': 0.1629948,
     'avg_iou_3': 0.44101045,
     'avg_iou_4': 0.65698886,
     'avg_iou_5': 0.72887945,
     'avg_obj_3': 0.26210743,
     'avg_obj_4': 0.50271726,
     'avg_obj_5': 0.6454607,
     'box_loss_3': 0.81247824,
     'box_loss_4': 0.52915,
     'box_loss_5': 0.21686177,
     'class_loss_3': 23.639359,
     'class_loss_4': 17.73112,
     'class_loss_5': 8.772203,
     'conf_loss_3': 90.69654,
     'conf_loss_4': 75.11931,
     'conf_loss_5': 32.026176,
     'recall50_3': 0.25246707,
     'recall50_4': 0.52584636,
     'recall50_5': 0.678947,
     'total_loss': 249.54332,
     'validation_loss': 249.54332}
I0331 02:36:45.971689 140028820076352 controller.py:211] train | step:  45000 | training until step 50000...
I0331 03:13:13.143687 140028820076352 controller.py:425] train | step:  50000 | steps/sec:    1.8 | output: 
    {'avg_iou_3': 0.5808158,
     'avg_iou_4': 0.71122897,
     'avg_iou_5': 0.76411605,
     'avg_obj_3': 0.3708143,
     'avg_obj_4': 0.55446166,
     'avg_obj_5': 0.6713476,
     'box_loss_3': 2.320954,
     'box_loss_4': 1.2718545,
     'box_loss_5': 0.37852955,
     'class_loss_3': 68.12742,
     'class_loss_4': 42.32904,
     'class_loss_5': 14.98202,
     'conf_loss_3': 211.6651,
     'conf_loss_4': 151.42139,
     'conf_loss_5': 46.503723,
     'learning_rate': 0.00261,
     'recall50_3': 0.31279674,
     'recall50_4': 0.56593674,
     'recall50_5': 0.712625,
     'total_loss': 538.9999,
     'training_loss': 538.9999}
I0331 03:14:04.573082 140028820076352 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-50000.
I0331 03:14:04.579648 140028820076352 controller.py:252]  eval | step:  50000 | running 625 steps of evaluation...
I0331 03:18:08.760579 140028820076352 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0331 03:22:17.666549 140028820076352 controller.py:261]  eval | step:  50000 | eval time:  493.1 sec | output: 
    {'AP': 0.2702517,
     'AP50': 0.48876598,
     'AP75': 0.26941866,
     'APl': 0.39108703,
     'APm': 0.28302723,
     'APs': 0.10500608,
     'ARl': 0.4805817,
     'ARm': 0.38368565,
     'ARmax1': 0.23421745,
     'ARmax10': 0.34831095,
     'ARmax100': 0.36281207,
     'ARs': 0.1686858,
     'avg_iou_3': 0.44246265,
     'avg_iou_4': 0.6588627,
     'avg_iou_5': 0.7301855,
     'avg_obj_3': 0.26496896,
     'avg_obj_4': 0.50545615,
     'avg_obj_5': 0.6501577,
     'box_loss_3': 0.80860335,
     'box_loss_4': 0.525364,
     'box_loss_5': 0.21534571,
     'class_loss_3': 23.419935,
     'class_loss_4': 17.653236,
     'class_loss_5': 8.661841,
     'conf_loss_3': 90.7457,
     'conf_loss_4': 74.72028,
     'conf_loss_5': 32.082558,
     'recall50_3': 0.25648168,
     'recall50_4': 0.52884305,
     'recall50_5': 0.68517625,
     'total_loss': 248.83302,
     'validation_loss': 248.83302}

train | step:  35000 | training until step 40000...
train | step:  40000 | steps/sec:    1.7 | output: 
    {'avg_iou_3': 0.57588494,
     'avg_iou_4': 0.7037824,
     'avg_iou_5': 0.75732344,
     'avg_obj_3': 0.3556997,
     'avg_obj_4': 0.53539693,
     'avg_obj_5': 0.653691,
     'box_loss_3': 2.3453708,
     'box_loss_4': 1.3044523,
     'box_loss_5': 0.3899549,
     'class_loss_3': 73.14958,
     'class_loss_4': 46.237225,
     'class_loss_5': 16.368387,
     'conf_loss_3': 214.72043,
     'conf_loss_4': 155.1372,
     'conf_loss_5': 46.88408,
     'learning_rate': 0.00261,
     'recall50_3': 0.29427236,
     'recall50_4': 0.5433477,
     'recall50_5': 0.6936014,
     'total_loss': 556.5369,
     'training_loss': 556.5369}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-40000.
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=187.29s).
Accumulating evaluation results...
DONE (t=3.38s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.259
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.476
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.257
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.095
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.271
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.375
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.226
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.338
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.352
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.158
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.374
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.465
 eval | step:  40000 | eval time:  505.5 sec | output: 
    {'AP': 0.259176,
     'AP50': 0.476016,
     'AP75': 0.25672245,
     'APl': 0.37477505,
     'APm': 0.27073434,
     'APs': 0.09462599,
     'ARl': 0.46499652,
     'ARm': 0.3743947,
     'ARmax1': 0.22643922,
     'ARmax10': 0.33802715,
     'ARmax100': 0.3522691,
     'ARs': 0.1580513,
     'avg_iou_3': 0.43960044,
     'avg_iou_4': 0.65413934,
     'avg_iou_5': 0.72665036,
     'avg_obj_3': 0.2599571,
     'avg_obj_4': 0.49658945,
     'avg_obj_5': 0.64033103,
     'box_loss_3': 0.8162497,
     'box_loss_4': 0.53404444,
     'box_loss_5': 0.21885441,
     'class_loss_3': 23.829496,
     'class_loss_4': 17.896223,
     'class_loss_5': 8.896596,
     'conf_loss_3': 90.780304,
     'conf_loss_4': 76.07473,
     'conf_loss_5': 32.056614,
     'recall50_3': 0.2491198,
     'recall50_4': 0.5185894,
     'recall50_5': 0.6733289,
     'total_loss': 251.10315,
     'validation_loss': 251.10315}
train | step:  40000 | training until step 45000...
train | step:  45000 | steps/sec:    1.5 | output: 
    {'avg_iou_3': 0.5786698,
     'avg_iou_4': 0.7078899,
     'avg_iou_5': 0.7608502,
     'avg_obj_3': 0.36403432,
     'avg_obj_4': 0.54551506,
     'avg_obj_5': 0.663225,
     'box_loss_3': 2.337644,
     'box_loss_4': 1.2904091,
     'box_loss_5': 0.3848469,
     'class_loss_3': 70.54167,
     'class_loss_4': 44.249954,
     'class_loss_5': 15.663675,
     'conf_loss_3': 213.61197,
     'conf_loss_4': 153.05707,
     'conf_loss_5': 46.734146,
     'learning_rate': 0.00261,
     'recall50_3': 0.30474615,
     'recall50_4': 0.5552529,
     'recall50_5': 0.7042831,
     'total_loss': 547.8721,
     'training_loss': 547.8721}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-45000.
 eval | step:  45000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=179.42s).
Accumulating evaluation results...
DONE (t=3.26s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.266
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.483
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.264
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.102
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.278
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.385
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.231
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.344
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.358
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.163
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.380
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.475
 eval | step:  45000 | eval time:  487.6 sec | output: 
    {'AP': 0.26576477,
     'AP50': 0.4831705,
     'AP75': 0.26449686,
     'APl': 0.38483396,
     'APm': 0.2782638,
     'APs': 0.10224493,
     'ARl': 0.47534952,
     'ARm': 0.3803341,
     'ARmax1': 0.23110333,
     'ARmax10': 0.34386444,
     'ARmax100': 0.35827675,
     'ARs': 0.1629948,
     'avg_iou_3': 0.44101045,
     'avg_iou_4': 0.65698886,
     'avg_iou_5': 0.72887945,
     'avg_obj_3': 0.26210743,
     'avg_obj_4': 0.50271726,
     'avg_obj_5': 0.6454607,
     'box_loss_3': 0.81247824,
     'box_loss_4': 0.52915,
     'box_loss_5': 0.21686177,
     'class_loss_3': 23.639359,
     'class_loss_4': 17.73112,
     'class_loss_5': 8.772203,
     'conf_loss_3': 90.69654,
     'conf_loss_4': 75.11931,
     'conf_loss_5': 32.026176,
     'recall50_3': 0.25246707,
     'recall50_4': 0.52584636,
     'recall50_5': 0.678947,
     'total_loss': 249.54332,
     'validation_loss': 249.54332}
train | step:  45000 | training until step 50000...
train | step:  50000 | steps/sec:    1.8 | output: 
    {'avg_iou_3': 0.5808158,
     'avg_iou_4': 0.71122897,
     'avg_iou_5': 0.76411605,
     'avg_obj_3': 0.3708143,
     'avg_obj_4': 0.55446166,
     'avg_obj_5': 0.6713476,
     'box_loss_3': 2.320954,
     'box_loss_4': 1.2718545,
     'box_loss_5': 0.37852955,
     'class_loss_3': 68.12742,
     'class_loss_4': 42.32904,
     'class_loss_5': 14.98202,
     'conf_loss_3': 211.6651,
     'conf_loss_4': 151.42139,
     'conf_loss_5': 46.503723,
     'learning_rate': 0.00261,
     'recall50_3': 0.31279674,
     'recall50_4': 0.56593674,
     'recall50_5': 0.712625,
     'total_loss': 538.9999,
     'training_loss': 538.9999}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-50000.
 eval | step:  50000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=192.32s).
Accumulating evaluation results...
DONE (t=3.36s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.270
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.489
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.269
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.105
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.283
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.391
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.234
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.348
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.363
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.169
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.384
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.481
 eval | step:  50000 | eval time:  493.1 sec | output: 
    {'AP': 0.2702517,
     'AP50': 0.48876598,
     'AP75': 0.26941866,
     'APl': 0.39108703,
     'APm': 0.28302723,
     'APs': 0.10500608,
     'ARl': 0.4805817,
     'ARm': 0.38368565,
     'ARmax1': 0.23421745,
     'ARmax10': 0.34831095,
     'ARmax100': 0.36281207,
     'ARs': 0.1686858,
     'avg_iou_3': 0.44246265,
     'avg_iou_4': 0.6588627,
     'avg_iou_5': 0.7301855,
     'avg_obj_3': 0.26496896,
     'avg_obj_4': 0.50545615,
     'avg_obj_5': 0.6501577,
     'box_loss_3': 0.80860335,
     'box_loss_4': 0.525364,
     'box_loss_5': 0.21534571,
     'class_loss_3': 23.419935,
     'class_loss_4': 17.653236,
     'class_loss_5': 8.661841,
     'conf_loss_3': 90.7457,
     'conf_loss_4': 74.72028,
     'conf_loss_5': 32.082558,
     'recall50_3': 0.25648168,
     'recall50_4': 0.52884305,
     'recall50_5': 0.68517625,
     'total_loss': 248.83302,
     'validation_loss': 248.83302}I0331 03:22:43.373796 140028820076352 controller.py:211] train | step:  50000 | training until step 55000...
I0331 03:58:38.093605 140028820076352 controller.py:425] train | step:  55000 | steps/sec:    1.8 | output: 
    {'avg_iou_3': 0.5895012,
     'avg_iou_4': 0.7213263,
     'avg_iou_5': 0.77465385,
     'avg_obj_3': 0.39797738,
     'avg_obj_4': 0.5875068,
     'avg_obj_5': 0.70371324,
     'box_loss_3': 2.2734756,
     'box_loss_4': 1.2277535,
     'box_loss_5': 0.3614441,
     'class_loss_3': 59.372307,
     'class_loss_4': 35.57714,
     'class_loss_5': 12.433189,
     'conf_loss_3': 206.25334,
     'conf_loss_4': 147.86722,
     'conf_loss_5': 45.58472,
     'learning_rate': 0.000261,
     'recall50_3': 0.3464629,
     'recall50_4': 0.6052247,
     'recall50_5': 0.7482395,
     'total_loss': 510.9502,
     'training_loss': 510.9502}
I0331 03:59:34.144525 140028820076352 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-55000.
I0331 03:59:34.150890 140028820076352 controller.py:252]  eval | step:  55000 | running 625 steps of evaluation...
I0331 04:03:42.800391 140028820076352 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0331 04:07:43.809910 140028820076352 controller.py:261]  eval | step:  55000 | eval time:  489.7 sec | output: 
    {'AP': 0.26915094,
     'AP50': 0.48762226,
     'AP75': 0.2685332,
     'APl': 0.38446182,
     'APm': 0.28250593,
     'APs': 0.102724195,
     'ARl': 0.47363463,
     'ARm': 0.3830613,
     'ARmax1': 0.23253705,
     'ARmax10': 0.34639776,
     'ARmax100': 0.36098474,
     'ARs': 0.16586815,
     'avg_iou_3': 0.4420108,
     'avg_iou_4': 0.6583364,
     'avg_iou_5': 0.7302558,
     'avg_obj_3': 0.2672485,
     'avg_obj_4': 0.5048088,
     'avg_obj_5': 0.6504029,
     'box_loss_3': 0.809294,
     'box_loss_4': 0.5258297,
     'box_loss_5': 0.21529555,
     'class_loss_3': 23.648825,
     'class_loss_4': 17.894493,
     'class_loss_5': 8.687772,
     'conf_loss_3': 91.5366,
     'conf_loss_4': 75.61458,
     'conf_loss_5': 32.53474,
     'recall50_3': 0.2598993,
     'recall50_4': 0.52733123,
     'recall50_5': 0.6850868,
     'total_loss': 251.46745,
     'validation_loss': 251.46745}
I0331 04:08:06.895932 140028820076352 controller.py:211] train | step:  55000 | training until step 60000...
I0331 04:40:52.883777 140028820076352 controller.py:425] train | step:  60000 | steps/sec:    2.0 | output: 
    {'avg_iou_3': 0.5913813,
     'avg_iou_4': 0.72416866,
     'avg_iou_5': 0.7773013,
     'avg_obj_3': 0.40559092,
     'avg_obj_4': 0.5974093,
     'avg_obj_5': 0.71266586,
     'box_loss_3': 2.259982,
     'box_loss_4': 1.2120233,
     'box_loss_5': 0.35647336,
     'class_loss_3': 56.947945,
     'class_loss_4': 33.77318,
     'class_loss_5': 11.746044,
     'conf_loss_3': 204.77614,
     'conf_loss_4': 145.24841,
     'conf_loss_5': 45.220768,
     'learning_rate': 2.61e-05,
     'recall50_3': 0.3553504,
     'recall50_4': 0.61699474,
     'recall50_5': 0.7575547,
     'total_loss': 501.5413,
     'training_loss': 501.5413}
I0331 04:41:44.973802 140028820076352 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-60000.
I0331 04:41:44.980453 140028820076352 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0331 04:46:09.656143 140028820076352 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0331 04:50:23.931356 140028820076352 controller.py:261]  eval | step:  60000 | eval time:  519.0 sec | output: 
    {'AP': 0.26890674,
     'AP50': 0.48697618,
     'AP75': 0.2686099,
     'APl': 0.38680685,
     'APm': 0.28180408,
     'APs': 0.10215404,
     'ARl': 0.47827977,
     'ARm': 0.38308552,
     'ARmax1': 0.23382105,
     'ARmax10': 0.3479647,
     'ARmax100': 0.36206463,
     'ARs': 0.16531289,
     'avg_iou_3': 0.44167915,
     'avg_iou_4': 0.65782315,
     'avg_iou_5': 0.72938114,
     'avg_obj_3': 0.2690633,
     'avg_obj_4': 0.50534385,
     'avg_obj_5': 0.6488878,
     'box_loss_3': 0.81023186,
     'box_loss_4': 0.52671826,
     'box_loss_5': 0.21594487,
     'class_loss_3': 23.947563,
     'class_loss_4': 18.09368,
     'class_loss_5': 8.779364,
     'conf_loss_3': 92.297066,
     'conf_loss_4': 75.34341,
     'conf_loss_5': 32.743607,
     'recall50_3': 0.26288915,
     'recall50_4': 0.52646345,
     'recall50_5': 0.6838641,
     'total_loss': 252.7576,
     'validation_loss': 252.7576}
I0331 04:50:46.435850 140028820076352 controller.py:211] train | step:  60000 | training until step 62500...
I0331 05:02:36.694694 140028820076352 controller.py:425] train | step:  62500 | steps/sec:    1.9 | output: 
    {'avg_iou_3': 0.5918505,
     'avg_iou_4': 0.724833,
     'avg_iou_5': 0.77779245,
     'avg_obj_3': 0.4073945,
     'avg_obj_4': 0.5995352,
     'avg_obj_5': 0.71488976,
     'box_loss_3': 2.2646003,
     'box_loss_4': 1.2131624,
     'box_loss_5': 0.35643065,
     'class_loss_3': 56.752323,
     'class_loss_4': 33.494698,
     'class_loss_5': 11.610483,
     'conf_loss_3': 205.07504,
     'conf_loss_4': 144.95999,
     'conf_loss_5': 45.17759,
     'learning_rate': 2.61e-05,
     'recall50_3': 0.35783884,
     'recall50_4': 0.61885726,
     'recall50_5': 0.75970227,
     'total_loss': 500.9042,
     'training_loss': 500.9042}
I0331 05:02:57.988686 140028820076352 controller.py:252]  eval | step:  62500 | running 625 steps of evaluation...
I0331 05:07:16.630571 140028820076352 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0331 05:11:13.406542 140028820076352 controller.py:261]  eval | step:  62500 | eval time:  495.4 sec | output: 
    {'AP': 0.2690605,
     'AP50': 0.48678866,
     'AP75': 0.2695372,
     'APl': 0.3897197,
     'APm': 0.28158125,
     'APs': 0.102888994,
     'ARl': 0.47848272,
     'ARm': 0.38202593,
     'ARmax1': 0.2337161,
     'ARmax10': 0.34757438,
     'ARmax100': 0.36164996,
     'ARs': 0.1648358,
     'avg_iou_3': 0.4414858,
     'avg_iou_4': 0.6576247,
     'avg_iou_5': 0.7288407,
     'avg_obj_3': 0.26852933,
     'avg_obj_4': 0.50500906,
     'avg_obj_5': 0.6490646,
     'box_loss_3': 0.8105546,
     'box_loss_4': 0.52711004,
     'box_loss_5': 0.21634004,
     'class_loss_3': 24.016676,
     'class_loss_4': 18.169926,
     'class_loss_5': 8.820478,
     'conf_loss_3': 92.43858,
     'conf_loss_4': 75.27003,
     'conf_loss_5': 32.836308,
     'recall50_3': 0.26233146,
     'recall50_4': 0.5256925,
     'recall50_5': 0.68365633,
     'total_loss': 253.10596,
     'validation_loss': 253.10596}

train | step:  50000 | training until step 55000...
train | step:  55000 | steps/sec:    1.8 | output: 
    {'avg_iou_3': 0.5895012,
     'avg_iou_4': 0.7213263,
     'avg_iou_5': 0.77465385,
     'avg_obj_3': 0.39797738,
     'avg_obj_4': 0.5875068,
     'avg_obj_5': 0.70371324,
     'box_loss_3': 2.2734756,
     'box_loss_4': 1.2277535,
     'box_loss_5': 0.3614441,
     'class_loss_3': 59.372307,
     'class_loss_4': 35.57714,
     'class_loss_5': 12.433189,
     'conf_loss_3': 206.25334,
     'conf_loss_4': 147.86722,
     'conf_loss_5': 45.58472,
     'learning_rate': 0.000261,
     'recall50_3': 0.3464629,
     'recall50_4': 0.6052247,
     'recall50_5': 0.7482395,
     'total_loss': 510.9502,
     'training_loss': 510.9502}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-55000.
 eval | step:  55000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=181.30s).
Accumulating evaluation results...
DONE (t=3.25s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.269
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.488
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.269
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.103
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.283
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.384
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.233
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.346
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.361
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.166
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.383
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.474
 eval | step:  55000 | eval time:  489.7 sec | output: 
    {'AP': 0.26915094,
     'AP50': 0.48762226,
     'AP75': 0.2685332,
     'APl': 0.38446182,
     'APm': 0.28250593,
     'APs': 0.102724195,
     'ARl': 0.47363463,
     'ARm': 0.3830613,
     'ARmax1': 0.23253705,
     'ARmax10': 0.34639776,
     'ARmax100': 0.36098474,
     'ARs': 0.16586815,
     'avg_iou_3': 0.4420108,
     'avg_iou_4': 0.6583364,
     'avg_iou_5': 0.7302558,
     'avg_obj_3': 0.2672485,
     'avg_obj_4': 0.5048088,
     'avg_obj_5': 0.6504029,
     'box_loss_3': 0.809294,
     'box_loss_4': 0.5258297,
     'box_loss_5': 0.21529555,
     'class_loss_3': 23.648825,
     'class_loss_4': 17.894493,
     'class_loss_5': 8.687772,
     'conf_loss_3': 91.5366,
     'conf_loss_4': 75.61458,
     'conf_loss_5': 32.53474,
     'recall50_3': 0.2598993,
     'recall50_4': 0.52733123,
     'recall50_5': 0.6850868,
     'total_loss': 251.46745,
     'validation_loss': 251.46745}
train | step:  55000 | training until step 60000...
train | step:  60000 | steps/sec:    2.0 | output: 
    {'avg_iou_3': 0.5913813,
     'avg_iou_4': 0.72416866,
     'avg_iou_5': 0.7773013,
     'avg_obj_3': 0.40559092,
     'avg_obj_4': 0.5974093,
     'avg_obj_5': 0.71266586,
     'box_loss_3': 2.259982,
     'box_loss_4': 1.2120233,
     'box_loss_5': 0.35647336,
     'class_loss_3': 56.947945,
     'class_loss_4': 33.77318,
     'class_loss_5': 11.746044,
     'conf_loss_3': 204.77614,
     'conf_loss_4': 145.24841,
     'conf_loss_5': 45.220768,
     'learning_rate': 2.61e-05,
     'recall50_3': 0.3553504,
     'recall50_4': 0.61699474,
     'recall50_5': 0.7575547,
     'total_loss': 501.5413,
     'training_loss': 501.5413}
saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-60000.
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=188.07s).
Accumulating evaluation results...
DONE (t=3.49s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.269
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.487
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.269
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.102
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.282
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.387
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.234
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.348
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.362
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.165
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.383
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.478
 eval | step:  60000 | eval time:  519.0 sec | output: 
    {'AP': 0.26890674,
     'AP50': 0.48697618,
     'AP75': 0.2686099,
     'APl': 0.38680685,
     'APm': 0.28180408,
     'APs': 0.10215404,
     'ARl': 0.47827977,
     'ARm': 0.38308552,
     'ARmax1': 0.23382105,
     'ARmax10': 0.3479647,
     'ARmax100': 0.36206463,
     'ARs': 0.16531289,
     'avg_iou_3': 0.44167915,
     'avg_iou_4': 0.65782315,
     'avg_iou_5': 0.72938114,
     'avg_obj_3': 0.2690633,
     'avg_obj_4': 0.50534385,
     'avg_obj_5': 0.6488878,
     'box_loss_3': 0.81023186,
     'box_loss_4': 0.52671826,
     'box_loss_5': 0.21594487,
     'class_loss_3': 23.947563,
     'class_loss_4': 18.09368,
     'class_loss_5': 8.779364,
     'conf_loss_3': 92.297066,
     'conf_loss_4': 75.34341,
     'conf_loss_5': 32.743607,
     'recall50_3': 0.26288915,
     'recall50_4': 0.52646345,
     'recall50_5': 0.6838641,
     'total_loss': 252.7576,
     'validation_loss': 252.7576}
train | step:  60000 | training until step 62500...
train | step:  62500 | steps/sec:    1.9 | output: 
    {'avg_iou_3': 0.5918505,
     'avg_iou_4': 0.724833,
     'avg_iou_5': 0.77779245,
     'avg_obj_3': 0.4073945,
     'avg_obj_4': 0.5995352,
     'avg_obj_5': 0.71488976,
     'box_loss_3': 2.2646003,
     'box_loss_4': 1.2131624,
     'box_loss_5': 0.35643065,
     'class_loss_3': 56.752323,
     'class_loss_4': 33.494698,
     'class_loss_5': 11.610483,
     'conf_loss_3': 205.07504,
     'conf_loss_4': 144.95999,
     'conf_loss_5': 45.17759,
     'learning_rate': 2.61e-05,
     'recall50_3': 0.35783884,
     'recall50_4': 0.61885726,
     'recall50_5': 0.75970227,
     'total_loss': 500.9042,
     'training_loss': 500.9042}
 eval | step:  62500 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=181.70s).
Accumulating evaluation results...
DONE (t=3.36s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.269
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.487
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.270
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.103
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.282
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.390
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.234
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.348
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.362
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.165
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.382
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.478
 eval | step:  62500 | eval time:  495.4 sec | output: 
    {'AP': 0.2690605,
     'AP50': 0.48678866,
     'AP75': 0.2695372,
     'APl': 0.3897197,
     'APm': 0.28158125,
     'APs': 0.102888994,
     'ARl': 0.47848272,
     'ARm': 0.38202593,
     'ARmax1': 0.2337161,
     'ARmax10': 0.34757438,
     'ARmax100': 0.36164996,
     'ARs': 0.1648358,
     'avg_iou_3': 0.4414858,
     'avg_iou_4': 0.6576247,
     'avg_iou_5': 0.7288407,
     'avg_obj_3': 0.26852933,
     'avg_obj_4': 0.50500906,
     'avg_obj_5': 0.6490646,
     'box_loss_3': 0.8105546,
     'box_loss_4': 0.52711004,
     'box_loss_5': 0.21634004,
     'class_loss_3': 24.016676,
     'class_loss_4': 18.169926,
     'class_loss_5': 8.820478,
     'conf_loss_3': 92.43858,
     'conf_loss_4': 75.27003,
     'conf_loss_5': 32.836308,
     'recall50_3': 0.26233146,
     'recall50_4': 0.5256925,
     'recall50_5': 0.68365633,
     'total_loss': 253.10596,
     'validation_loss': 253.10596}I0331 05:12:12.313275 140028820076352 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-62500.
I0331 05:12:12.331350 140028820076352 train_lib.py:123] Number of trainable params in model: 53.066944 Millions.

saved checkpoint to gs://tensorflow2/debug-data-loss/sgd-mean/yolov4-coco-all-50k-csp/ckpt-62500.
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   234    0     2  100   232     11   1364 --:--:-- --:--:-- --:--:--  1376
okRequest issued for: [node-7]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-03-31T05:12:27.889851344Z'
  endTime: '2021-03-31T05:13:18.221802398Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617167547878-5bece293bcc60-2b6c8272-462d29fc
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  cidrBlock: 10.124.160.48/29
  createTime: '2021-03-18T03:10:27.166064884Z'
  health: HEALTHY
  ipAddress: 10.124.160.50
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-7
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.124.160.50
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617167547878-5bece293bcc60-2b6c8272-462d29fc] to complete...
........................................................................................................................................................................................................................................................................................done.
