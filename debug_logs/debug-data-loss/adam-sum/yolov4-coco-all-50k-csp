cat: .experiment_zone: No such file or directory
Request issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-03-30T17:24:28.771628459Z'
  endTime: '2021-03-30T17:25:06.734427046Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617125068760-5bec44547e5a8-deed43d8-b5f55e31
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617125068760-5bec44547e5a8-deed43d8-b5f55e31] to complete...
..........................................................................................................................................................................................................................................................................done.
europe-west4-a
I0330 17:25:25.794812 140260967741248 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [512, 512, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'leaky',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.2,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': True,
                                                     '4': True,
                                                     '5': True},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'aug_rand_angle': 5.0,
                                    'aug_rand_brightness': 1.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 1.5,
                                    'aug_rand_transalate': 0.0,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 512,
                                    'image_w': 512,
                                    'jitter_boxes': 0.1,
                                    'jitter_im': 0.3,
                                    'letter_box': True,
                                    'max_num_instances': 200,
                                    'max_process_size': 608,
                                    'min_process_size': 320,
                                    'mosaic': {'crop_area': [0.3, 0.35],
                                               'mosaic_frequency': 0.955,
                                               'output_size': [640, 640],
                                               'random_crop': False},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'aug_rand_angle': 15.0,
                                         'aug_rand_brightness': 1.5,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 1.5,
                                         'aug_rand_transalate': 0.0,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 512,
                                         'image_w': 512,
                                         'jitter_boxes': 0.3,
                                         'jitter_im': 0.3,
                                         'letter_box': True,
                                         'max_num_instances': 200,
                                         'max_process_size': 608,
                                         'min_process_size': 320,
                                         'mosaic': {'crop_area': [0.3, 0.35],
                                                    'mosaic_frequency': 0.9,
                                                    'output_size': [640, 640],
                                                    'random_crop': False},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.0005},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': '',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'higher',
             'checkpoint_interval': 5000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': None,
                                  'learning_rate': {'stepwise': {'boundaries': [50000,
                                                                                56250],
                                                                 'name': 'PiecewiseConstantDecay',
                                                                 'values': [0.001,
                                                                            0.0001,
                                                                            1e-05]},
                                                    'type': 'stepwise'},
                                  'optimizer': {'adam': {'amsgrad': False,
                                                         'beta_1': 0.949,
                                                         'beta_2': 0.999,
                                                         'clipnorm': None,
                                                         'clipvalue': None,
                                                         'epsilon': 1e-07,
                                                         'global_clipnorm': None,
                                                         'name': 'adam'},
                                                'type': 'adam'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 1000},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 62500,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 5000,
             'validation_steps': 625}}
I0330 17:25:25.795763 140260967741248 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/params.yaml
I0330 17:25:28.808632 140260967741248 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0330 17:25:29.428465 140260967741248 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0330 17:25:29.428770 140260967741248 transport.py:157] Attempting refresh to obtain initial access_token
I0330 17:25:29.487226 140260967741248 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0330 17:25:30.105818 140260967741248 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0330 17:25:30.106322 140260967741248 transport.py:157] Attempting refresh to obtain initial access_token
2021-03-30 17:25:30.153547: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0330 17:25:30.154208 140260967741248 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0330 17:25:30.296288 140260967741248 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0330 17:25:30.296543 140260967741248 transport.py:157] Attempting refresh to obtain initial access_token
I0330 17:25:30.353652 140260967741248 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0330 17:25:30.972018 140260967741248 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0330 17:25:30.972293 140260967741248 transport.py:157] Attempting refresh to obtain initial access_token
2021-03-30 17:25:31.036153: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-03-30 17:25:31.064762: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-03-30 17:25:31.064838: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:54609}
2021-03-30 17:25:54.276594: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.62.133.178:8470}
2021-03-30 17:25:54.276682: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:54609}
2021-03-30 17:25:54.277664: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:54609
I0330 17:25:54.280270 140260967741248 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-1
I0330 17:25:54.281916 140260967741248 tpu_strategy_util.py:74] Initializing the TPU system: node-1
INFO:tensorflow:Clearing out eager caches
I0330 17:26:02.414540 140260967741248 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0330 17:26:02.416923 140260967741248 tpu_strategy_util.py:133] Finished initializing TPU system.
I0330 17:26:02.418535 140260967741248 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0330 17:26:03.036769 140260967741248 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0330 17:26:03.037048 140260967741248 transport.py:157] Attempting refresh to obtain initial access_token
I0330 17:26:03.176816 140260967741248 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0330 17:26:03.790571 140260967741248 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1?alt=json
I0330 17:26:03.790826 140260967741248 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0330 17:26:03.830339 140260967741248 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0330 17:26:03.830590 140260967741248 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0330 17:26:03.830941 140260967741248 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0330 17:26:03.831003 140260967741248 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0330 17:26:03.831052 140260967741248 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0330 17:26:03.831215 140260967741248 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0330 17:26:03.831273 140260967741248 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0330 17:26:03.831320 140260967741248 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0330 17:26:03.831365 140260967741248 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0330 17:26:03.831410 140260967741248 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0330 17:26:03.831466 140260967741248 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0330 17:26:03.831513 140260967741248 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0330 17:26:03.831559 140260967741248 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0330 17:26:03.831639 140260967741248 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0330 17:26:03.831690 140260967741248 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0330 17:26:03.831737 140260967741248 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0330 17:26:03.857909 140260967741248 train_utils.py:214] Running default trainer.
2021-03-30 17:26:03.872584: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': True, '4': True, '5': True}, 'use_nms': True, 'iou_thresh': 0.2, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 320, 'max_process_size': 608, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'jitter_boxes': 0.1, 'aug_rand_transalate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_zoom': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_angle': 5.0, 'use_tie_breaker': True, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.955, 'crop_area': [0.3, 0.35], 'random_crop': False}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 512, 'image_h': 512, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 320, 'max_process_size': 608, 'letter_box': True, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.3, 'jitter_boxes': 0.3, 'aug_rand_transalate': 0.0, 'aug_rand_saturation': 1.5, 'aug_rand_brightness': 1.5, 'aug_rand_zoom': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_angle': 15.0, 'use_tie_breaker': True, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.9, 'crop_area': [0.3, 0.35], 'random_crop': False}}}, 'weight_decay': 0.0005, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'adam', 'adam': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'adam', 'beta_1': 0.949, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}}, 'ema': None, 'learning_rate': {'type': 'stepwise', 'stepwise': {'name': 'PiecewiseConstantDecay', 'boundaries': [50000, 56250], 'values': [0.001, 0.0001, 1e-05]}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 1000}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 5000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 62500, 'validation_steps': 625, 'validation_interval': 5000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': '', 'best_checkpoint_metric_comp': 'higher', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
{'3': 2.0, '4': 2.0, '5': 2.0} 0.00025
{'num_classes': 91, '_input_size': [512, 512, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': True, '4': True, '5': True}, 'use_nms': True, 'iou_thresh': 0.2, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'leaky', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 512, 512, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f90a455c128>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 512, 512, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 256, 256, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 256, 256, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 256, 256, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 128, 128, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 128, 128, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 128, 128, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 64, 64, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 64, 64, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 64, 64, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 32, 32, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 32, 32, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 32, 32, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 16, 16, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 16, 16, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 16, 16, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
route_split 512.0 512.0
conv2 512.0
conv1 512.0
spp
conv1 512.0
conv2 512.0
connect
conv1 512.0
8
(None, 16, 16, 512) (None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 2048)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 1024)
(None, 16, 16, 512)
route_split 256.0 256.0
conv2 256.0
conv1 256.0
conv2 256.0
connect
conv1 256.0
6
(None, 32, 32, 256) (None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 32, 32, 256)








 ListWrapper([128, 256, 512])
route_split 128 128
conv2 128
conv1 128
conv2 128
connect
conv1 128
conv2 256
7
(None, 64, 64, 128) (None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 256)
(None, 64, 64, 128)
(None, 64, 64, 256)
route_split 256 256
conv2 256
conv1 256
conv2 256
connect
conv1 256
conv2 512
7
(None, 32, 32, 256) (None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 32, 32, 256)
(None, 32, 32, 512)
route_split 512 512
conv2 512
conv1 512
conv2 512
connect
conv1 512
conv2 1024
7
(None, 16, 16, 512) (None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 1024)
(None, 16, 16, 512)
(None, 16, 16, 1024)
detget {'3': 2.0, '4': 2.0, '5': 2.0}
(None, 16, 16, 512) (None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 2048)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 1024)
(None, 16, 16, 512)
(None, 32, 32, 256) (None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 32, 32, 256)
(None, 64, 64, 128) (None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 128)
(None, 64, 64, 256)
(None, 64, 64, 128)
(None, 64, 64, 256)
(None, 32, 32, 256) (None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)
(None, 32, 32, 256)I0330 17:26:49.799536 140260967741248 controller.py:362] restoring or initializing model...
I0330 17:26:58.506569 140260967741248 yolo.py:484] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0330 17:26:58.508529 140260967741248 controller.py:368] initialized model.
I0330 17:26:58.509159 140260967741248 train_lib.py:96] Starts to execute mode: train_and_eval
I0330 17:26:58.514474 140260967741248 controller.py:211] train | step:      0 | training until step 5000...
I0330 17:27:06.162961 140260967741248 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0330 17:28:06.572630 140260967741248 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0330 18:13:10.498246 140260967741248 controller.py:425] train | step:   5000 | steps/sec:    1.8 | output: 
    {'avg_iou_3': 0.49861416,
     'avg_iou_4': 0.5986041,
     'avg_iou_5': 0.64359504,
     'avg_obj_3': 0.22366127,
     'avg_obj_4': 0.35130545,
     'avg_obj_5': 0.4907082,
     'box_loss_3': 0.02663731,
     'box_loss_4': 0.02191125,
     'box_loss_5': 0.020382915,
     'class_loss_3': 0.057527468,
     'class_loss_4': 0.049679708,
     'class_loss_5': 0.04326656,
     'conf_loss_3': 0.334174,
     'conf_loss_4': 0.109683506,
     'conf_loss_5': 0.055747364,
     'learning_rate': 0.001,
     'recall50_3': 0.13239649,
     'recall50_4': 0.29547116,
     'recall50_5': 0.48575917,
     'total_loss': 5.7520704,
     'training_loss': 5.7520704}
I0330 18:14:05.292711 140260967741248 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-5000.
I0330 18:14:05.299675 140260967741248 controller.py:252]  eval | step:   5000 | running 625 steps of evaluation...
I0330 18:14:10.728232 140260967741248 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0330 18:19:12.231622 140260967741248 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0330 18:23:08.256823 140260967741248 controller.py:261]  eval | step:   5000 | eval time:  543.0 sec | output: 
    {'AP': 0.117051,
     'AP50': 0.22625344,
     'AP75': 0.1100026,
     'APl': 0.16767941,
     'APm': 0.12732542,
     'APs': 0.026337434,
     'ARl': 0.25499183,
     'ARm': 0.20991322,
     'ARmax1': 0.12865628,
     'ARmax10': 0.18675952,
     'ARmax100': 0.1920813,
     'ARs': 0.04819724,
     'avg_iou_3': 0.42672646,
     'avg_iou_4': 0.6218432,
     'avg_iou_5': 0.67575264,
     'avg_obj_3': 0.17844746,
     'avg_obj_4': 0.3882757,
     'avg_obj_5': 0.5449001,
     'box_loss_3': 0.014626847,
     'box_loss_4': 0.015111402,
     'box_loss_5': 0.01525573,
     'class_loss_3': 0.0093920985,
     'class_loss_4': 0.010495169,
     'class_loss_5': 0.010292017,
     'conf_loss_3': 0.03556691,
     'conf_loss_4': 0.033134963,
     'conf_loss_5': 0.028495852,
     'recall50_3': 0.14690891,
     'recall50_4': 0.38295493,
     'recall50_5': 0.5607185,
     'total_loss': 0.1723711,
     'validation_loss': 0.1723711}
I0330 18:23:39.679870 140260967741248 controller.py:211] train | step:   5000 | training until step 10000...
I0330 19:03:57.366820 140260967741248 controller.py:425] train | step:  10000 | steps/sec:    1.6 | output: 
    {'avg_iou_3': 0.5761016,
     'avg_iou_4': 0.6912459,
     'avg_iou_5': 0.7417139,
     'avg_obj_3': 0.26951283,
     'avg_obj_4': 0.45017552,
     'avg_obj_5': 0.5973455,
     'box_loss_3': 0.022373687,
     'box_loss_4': 0.016772108,
     'box_loss_5': 0.014720434,
     'class_loss_3': 0.011901688,
     'class_loss_4': 0.009970262,
     'class_loss_5': 0.009081639,
     'conf_loss_3': 0.07920772,
     'conf_loss_4': 0.06261331,
     'conf_loss_5': 0.035353694,
     'learning_rate': 0.001,
     'recall50_3': 0.19741327,
     'recall50_4': 0.44032794,
     'recall50_5': 0.63277024,
     'total_loss': 2.0959594,
     'training_loss': 2.0959594}

(None, 32, 32, 512)
(None, 32, 32, 256)
(None, 32, 32, 512)
(None, 16, 16, 512) (None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 512)
(None, 16, 16, 1024)
(None, 16, 16, 512)
(None, 16, 16, 1024)
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 64, 64, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 512, 512, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4), num_detections: (8,), upds: {3: (8, 400, 8), 4: (8, 400, 8), 5: (8, 400, 8)}, inds: {3: (8, 400, 3), 4: (8, 400, 3), 5: (8, 400, 3)}, true_conf: {3: (8, 64, 64, 3, 1), 4: (8, 32, 32, 3, 1), 5: (8, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 512, 512, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 400, 8), 4: (1, 400, 8), 5: (1, 400, 8)}, inds: {3: (1, 400, 3), 4: (1, 400, 3), 5: (1, 400, 3)}, true_conf: {3: (1, 64, 64, 3, 1), 4: (1, 32, 32, 3, 1), 5: (1, 16, 16, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 5000...
(8, 16, 16, 512) (8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 2048)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 1024)
(8, 16, 16, 512)
(8, 32, 32, 256) (8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 512)
(8, 32, 32, 256)
(8, 64, 64, 128) (8, 64, 64, 128)
(8, 64, 64, 128)
(8, 64, 64, 128)
(8, 64, 64, 128)
(8, 64, 64, 256)
(8, 64, 64, 128)
(8, 64, 64, 256)
(8, 32, 32, 256) (8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 512)
(8, 32, 32, 256)
(8, 32, 32, 512)
(8, 16, 16, 512) (8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 1024)
(8, 16, 16, 512)
(8, 16, 16, 1024)
(8, 16, 16, 512) (8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 2048)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 1024)
(8, 16, 16, 512)
(8, 32, 32, 256) (8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 512)
(8, 32, 32, 256)
(8, 64, 64, 128) (8, 64, 64, 128)
(8, 64, 64, 128)
(8, 64, 64, 128)
(8, 64, 64, 128)
(8, 64, 64, 256)
(8, 64, 64, 128)
(8, 64, 64, 256)
(8, 32, 32, 256) (8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 256)
(8, 32, 32, 512)
(8, 32, 32, 256)
(8, 32, 32, 512)
(8, 16, 16, 512) (8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 512)
(8, 16, 16, 1024)
(8, 16, 16, 512)
(8, 16, 16, 1024)
train | step:   5000 | steps/sec:    1.8 | output: 
    {'avg_iou_3': 0.49861416,
     'avg_iou_4': 0.5986041,
     'avg_iou_5': 0.64359504,
     'avg_obj_3': 0.22366127,
     'avg_obj_4': 0.35130545,
     'avg_obj_5': 0.4907082,
     'box_loss_3': 0.02663731,
     'box_loss_4': 0.02191125,
     'box_loss_5': 0.020382915,
     'class_loss_3': 0.057527468,
     'class_loss_4': 0.049679708,
     'class_loss_5': 0.04326656,
     'conf_loss_3': 0.334174,
     'conf_loss_4': 0.109683506,
     'conf_loss_5': 0.055747364,
     'learning_rate': 0.001,
     'recall50_3': 0.13239649,
     'recall50_4': 0.29547116,
     'recall50_5': 0.48575917,
     'total_loss': 5.7520704,
     'training_loss': 5.7520704}
saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-5000.
 eval | step:   5000 | running 625 steps of evaluation...
(1, 16, 16, 512) (1, 16, 16, 512)
(1, 16, 16, 512)
(1, 16, 16, 512)
(1, 16, 16, 2048)
(1, 16, 16, 512)
(1, 16, 16, 512)
(1, 16, 16, 1024)
(1, 16, 16, 512)
(1, 32, 32, 256) (1, 32, 32, 256)
(1, 32, 32, 256)
(1, 32, 32, 256)
(1, 32, 32, 256)
(1, 32, 32, 512)
(1, 32, 32, 256)
(1, 64, 64, 128) (1, 64, 64, 128)
(1, 64, 64, 128)
(1, 64, 64, 128)
(1, 64, 64, 128)
(1, 64, 64, 256)
(1, 64, 64, 128)
(1, 64, 64, 256)
(1, 32, 32, 256) (1, 32, 32, 256)
(1, 32, 32, 256)
(1, 32, 32, 256)
(1, 32, 32, 256)
(1, 32, 32, 512)
(1, 32, 32, 256)
(1, 32, 32, 512)
(1, 16, 16, 512) (1, 16, 16, 512)
(1, 16, 16, 512)
(1, 16, 16, 512)
(1, 16, 16, 512)
(1, 16, 16, 1024)
(1, 16, 16, 512)
(1, 16, 16, 1024)
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=171.47s).
Accumulating evaluation results...
DONE (t=3.76s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.117
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.226
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.110
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.026
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.127
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.168
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.129
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.187
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.192
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.048
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.210
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.255
 eval | step:   5000 | eval time:  543.0 sec | output: 
    {'AP': 0.117051,
     'AP50': 0.22625344,
     'AP75': 0.1100026,
     'APl': 0.16767941,
     'APm': 0.12732542,
     'APs': 0.026337434,
     'ARl': 0.25499183,
     'ARm': 0.20991322,
     'ARmax1': 0.12865628,
     'ARmax10': 0.18675952,
     'ARmax100': 0.1920813,
     'ARs': 0.04819724,
     'avg_iou_3': 0.42672646,
     'avg_iou_4': 0.6218432,
     'avg_iou_5': 0.67575264,
     'avg_obj_3': 0.17844746,
     'avg_obj_4': 0.3882757,
     'avg_obj_5': 0.5449001,
     'box_loss_3': 0.014626847,
     'box_loss_4': 0.015111402,
     'box_loss_5': 0.01525573,
     'class_loss_3': 0.0093920985,
     'class_loss_4': 0.010495169,
     'class_loss_5': 0.010292017,
     'conf_loss_3': 0.03556691,
     'conf_loss_4': 0.033134963,
     'conf_loss_5': 0.028495852,
     'recall50_3': 0.14690891,
     'recall50_4': 0.38295493,
     'recall50_5': 0.5607185,
     'total_loss': 0.1723711,
     'validation_loss': 0.1723711}
train | step:   5000 | training until step 10000...
train | step:  10000 | steps/sec:    1.6 | output: 
    {'avg_iou_3': 0.5761016,
     'avg_iou_4': 0.6912459,
     'avg_iou_5': 0.7417139,
     'avg_obj_3': 0.26951283,
     'avg_obj_4': 0.45017552,
     'avg_obj_5': 0.5973455,
     'box_loss_3': 0.022373687,
     'box_loss_4': 0.016772108,
     'box_loss_5': 0.014720434,
     'class_loss_3': 0.011901688,
     'class_loss_4': 0.009970262,
     'class_loss_5': 0.009081639,
     'conf_loss_3': 0.07920772,
     'conf_loss_4': 0.06261331,
     'conf_loss_5': 0.035353694,
     'learning_rate': 0.001,
     'recall50_3': 0.19741327,
     'recall50_4': 0.44032794,
     'recall50_5': 0.63277024,
     'total_loss': 2.0959594,
     'training_loss': 2.0959594}I0330 19:04:52.055618 140260967741248 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-10000.
I0330 19:04:52.062248 140260967741248 controller.py:252]  eval | step:  10000 | running 625 steps of evaluation...
I0330 19:09:03.606850 140260967741248 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0330 19:13:00.905834 140260967741248 controller.py:261]  eval | step:  10000 | eval time:  488.8 sec | output: 
    {'AP': 0.19316886,
     'AP50': 0.33755475,
     'AP75': 0.20228021,
     'APl': 0.2742947,
     'APm': 0.21080486,
     'APs': 0.05839538,
     'ARl': 0.36254764,
     'ARm': 0.30726305,
     'ARmax1': 0.18075037,
     'ARmax10': 0.27014443,
     'ARmax100': 0.28065154,
     'ARs': 0.09889475,
     'avg_iou_3': 0.44559032,
     'avg_iou_4': 0.6539262,
     'avg_iou_5': 0.71975774,
     'avg_obj_3': 0.22389531,
     'avg_obj_4': 0.44736964,
     'avg_obj_5': 0.57814574,
     'box_loss_3': 0.013605014,
     'box_loss_4': 0.013347172,
     'box_loss_5': 0.01284091,
     'class_loss_3': 0.0066074217,
     'class_loss_4': 0.0073520294,
     'class_loss_5': 0.0074795587,
     'conf_loss_3': 0.033586044,
     'conf_loss_4': 0.030914025,
     'conf_loss_5': 0.02414815,
     'recall50_3': 0.20061415,
     'recall50_4': 0.45687562,
     'recall50_5': 0.6103302,
     'total_loss': 0.14988032,
     'validation_loss': 0.14988032}
I0330 19:13:26.718716 140260967741248 controller.py:211] train | step:  10000 | training until step 15000...
I0330 19:55:47.536188 140260967741248 controller.py:425] train | step:  15000 | steps/sec:    1.6 | output: 
    {'avg_iou_3': 0.5951583,
     'avg_iou_4': 0.7148309,
     'avg_iou_5': 0.7655714,
     'avg_obj_3': 0.30743995,
     'avg_obj_4': 0.4992044,
     'avg_obj_5': 0.6440198,
     'box_loss_3': 0.021368675,
     'box_loss_4': 0.015479786,
     'box_loss_5': 0.013339026,
     'class_loss_3': 0.010064846,
     'class_loss_4': 0.008313078,
     'class_loss_5': 0.007610126,
     'conf_loss_3': 0.07726162,
     'conf_loss_4': 0.060755424,
     'conf_loss_5': 0.033765554,
     'learning_rate': 0.001,
     'recall50_3': 0.24406536,
     'recall50_4': 0.50195205,
     'recall50_5': 0.6849652,
     'total_loss': 1.9836699,
     'training_loss': 1.9836699}
I0330 19:56:34.143846 140260967741248 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-15000.
I0330 19:56:34.150519 140260967741248 controller.py:252]  eval | step:  15000 | running 625 steps of evaluation...
I0330 20:00:46.974866 140260967741248 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0330 20:04:36.809197 140260967741248 controller.py:261]  eval | step:  15000 | eval time:  482.7 sec | output: 
    {'AP': 0.22539167,
     'AP50': 0.38631898,
     'AP75': 0.23778433,
     'APl': 0.31381038,
     'APm': 0.23846026,
     'APs': 0.07627338,
     'ARl': 0.40332204,
     'ARm': 0.3295532,
     'ARmax1': 0.20396009,
     'ARmax10': 0.29979905,
     'ARmax100': 0.31018388,
     'ARs': 0.120523155,
     'avg_iou_3': 0.45585462,
     'avg_iou_4': 0.665638,
     'avg_iou_5': 0.7278087,
     'avg_obj_3': 0.24241099,
     'avg_obj_4': 0.45758036,
     'avg_obj_5': 0.61283785,
     'box_loss_3': 0.013021436,
     'box_loss_4': 0.012685909,
     'box_loss_5': 0.012346819,
     'class_loss_3': 0.005876051,
     'class_loss_4': 0.006233926,
     'class_loss_5': 0.006249321,
     'conf_loss_3': 0.03312853,
     'conf_loss_4': 0.030623963,
     'conf_loss_5': 0.024046628,
     'recall50_3': 0.2289269,
     'recall50_4': 0.47118405,
     'recall50_5': 0.6431443,
     'total_loss': 0.14421247,
     'validation_loss': 0.14421247}
I0330 20:05:02.946939 140260967741248 controller.py:211] train | step:  15000 | training until step 20000...
I0330 20:44:38.818657 140260967741248 controller.py:425] train | step:  20000 | steps/sec:    1.7 | output: 
    {'avg_iou_3': 0.6079119,
     'avg_iou_4': 0.73033637,
     'avg_iou_5': 0.781743,
     'avg_obj_3': 0.3366022,
     'avg_obj_4': 0.53702337,
     'avg_obj_5': 0.67930794,
     'box_loss_3': 0.020632673,
     'box_loss_4': 0.0145952655,
     'box_loss_5': 0.012399186,
     'class_loss_3': 0.0089705335,
     'class_loss_4': 0.0072247437,
     'class_loss_5': 0.0065908255,
     'conf_loss_3': 0.07516349,
     'conf_loss_4': 0.058738496,
     'conf_loss_5': 0.032262012,
     'learning_rate': 0.001,
     'recall50_3': 0.2792637,
     'recall50_4': 0.546721,
     'recall50_5': 0.72129035,
     'total_loss': 1.8926157,
     'training_loss': 1.8926157}
I0330 20:45:25.964889 140260967741248 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-20000.
I0330 20:45:25.971974 140260967741248 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
I0330 20:49:33.633802 140260967741248 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0330 20:53:22.098686 140260967741248 controller.py:261]  eval | step:  20000 | eval time:  476.1 sec | output: 
    {'AP': 0.25674185,
     'AP50': 0.4217037,
     'AP75': 0.2744706,
     'APl': 0.36711735,
     'APm': 0.26435953,
     'APs': 0.08360111,
     'ARl': 0.45245412,
     'ARm': 0.36161834,
     'ARmax1': 0.22504939,
     'ARmax10': 0.329485,
     'ARmax100': 0.34098184,
     'ARs': 0.1265694,
     'avg_iou_3': 0.46327716,
     'avg_iou_4': 0.6748735,
     'avg_iou_5': 0.745741,
     'avg_obj_3': 0.2560827,
     'avg_obj_4': 0.49723613,
     'avg_obj_5': 0.65826494,
     'box_loss_3': 0.012596653,
     'box_loss_4': 0.012164613,
     'box_loss_5': 0.01136647,
     'class_loss_3': 0.0053678625,
     'class_loss_4': 0.0056417105,
     'class_loss_5': 0.0055147065,
     'conf_loss_3': 0.032481123,
     'conf_loss_4': 0.029881326,
     'conf_loss_5': 0.02319787,
     'recall50_3': 0.24389526,
     'recall50_4': 0.51732737,
     'recall50_5': 0.6922517,
     'total_loss': 0.13821232,
     'validation_loss': 0.13821232}

saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-10000.
 eval | step:  10000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=175.98s).
Accumulating evaluation results...
DONE (t=3.40s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.193
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.338
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.202
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.058
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.211
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.274
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.181
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.270
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.281
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.099
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.307
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.363
 eval | step:  10000 | eval time:  488.8 sec | output: 
    {'AP': 0.19316886,
     'AP50': 0.33755475,
     'AP75': 0.20228021,
     'APl': 0.2742947,
     'APm': 0.21080486,
     'APs': 0.05839538,
     'ARl': 0.36254764,
     'ARm': 0.30726305,
     'ARmax1': 0.18075037,
     'ARmax10': 0.27014443,
     'ARmax100': 0.28065154,
     'ARs': 0.09889475,
     'avg_iou_3': 0.44559032,
     'avg_iou_4': 0.6539262,
     'avg_iou_5': 0.71975774,
     'avg_obj_3': 0.22389531,
     'avg_obj_4': 0.44736964,
     'avg_obj_5': 0.57814574,
     'box_loss_3': 0.013605014,
     'box_loss_4': 0.013347172,
     'box_loss_5': 0.01284091,
     'class_loss_3': 0.0066074217,
     'class_loss_4': 0.0073520294,
     'class_loss_5': 0.0074795587,
     'conf_loss_3': 0.033586044,
     'conf_loss_4': 0.030914025,
     'conf_loss_5': 0.02414815,
     'recall50_3': 0.20061415,
     'recall50_4': 0.45687562,
     'recall50_5': 0.6103302,
     'total_loss': 0.14988032,
     'validation_loss': 0.14988032}
train | step:  10000 | training until step 15000...
train | step:  15000 | steps/sec:    1.6 | output: 
    {'avg_iou_3': 0.5951583,
     'avg_iou_4': 0.7148309,
     'avg_iou_5': 0.7655714,
     'avg_obj_3': 0.30743995,
     'avg_obj_4': 0.4992044,
     'avg_obj_5': 0.6440198,
     'box_loss_3': 0.021368675,
     'box_loss_4': 0.015479786,
     'box_loss_5': 0.013339026,
     'class_loss_3': 0.010064846,
     'class_loss_4': 0.008313078,
     'class_loss_5': 0.007610126,
     'conf_loss_3': 0.07726162,
     'conf_loss_4': 0.060755424,
     'conf_loss_5': 0.033765554,
     'learning_rate': 0.001,
     'recall50_3': 0.24406536,
     'recall50_4': 0.50195205,
     'recall50_5': 0.6849652,
     'total_loss': 1.9836699,
     'training_loss': 1.9836699}
saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-15000.
 eval | step:  15000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=175.02s).
Accumulating evaluation results...
DONE (t=3.22s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.225
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.386
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.238
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.076
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.238
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.314
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.204
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.300
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.310
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.121
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.330
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.403
 eval | step:  15000 | eval time:  482.7 sec | output: 
    {'AP': 0.22539167,
     'AP50': 0.38631898,
     'AP75': 0.23778433,
     'APl': 0.31381038,
     'APm': 0.23846026,
     'APs': 0.07627338,
     'ARl': 0.40332204,
     'ARm': 0.3295532,
     'ARmax1': 0.20396009,
     'ARmax10': 0.29979905,
     'ARmax100': 0.31018388,
     'ARs': 0.120523155,
     'avg_iou_3': 0.45585462,
     'avg_iou_4': 0.665638,
     'avg_iou_5': 0.7278087,
     'avg_obj_3': 0.24241099,
     'avg_obj_4': 0.45758036,
     'avg_obj_5': 0.61283785,
     'box_loss_3': 0.013021436,
     'box_loss_4': 0.012685909,
     'box_loss_5': 0.012346819,
     'class_loss_3': 0.005876051,
     'class_loss_4': 0.006233926,
     'class_loss_5': 0.006249321,
     'conf_loss_3': 0.03312853,
     'conf_loss_4': 0.030623963,
     'conf_loss_5': 0.024046628,
     'recall50_3': 0.2289269,
     'recall50_4': 0.47118405,
     'recall50_5': 0.6431443,
     'total_loss': 0.14421247,
     'validation_loss': 0.14421247}
train | step:  15000 | training until step 20000...
train | step:  20000 | steps/sec:    1.7 | output: 
    {'avg_iou_3': 0.6079119,
     'avg_iou_4': 0.73033637,
     'avg_iou_5': 0.781743,
     'avg_obj_3': 0.3366022,
     'avg_obj_4': 0.53702337,
     'avg_obj_5': 0.67930794,
     'box_loss_3': 0.020632673,
     'box_loss_4': 0.0145952655,
     'box_loss_5': 0.012399186,
     'class_loss_3': 0.0089705335,
     'class_loss_4': 0.0072247437,
     'class_loss_5': 0.0065908255,
     'conf_loss_3': 0.07516349,
     'conf_loss_4': 0.058738496,
     'conf_loss_5': 0.032262012,
     'learning_rate': 0.001,
     'recall50_3': 0.2792637,
     'recall50_4': 0.546721,
     'recall50_5': 0.72129035,
     'total_loss': 1.8926157,
     'training_loss': 1.8926157}
saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-20000.
 eval | step:  20000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=175.41s).
Accumulating evaluation results...
DONE (t=3.27s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.257
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.422
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.274
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.084
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.264
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.367
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.225
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.329
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.341
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.127
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.362
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.452
 eval | step:  20000 | eval time:  476.1 sec | output: 
    {'AP': 0.25674185,
     'AP50': 0.4217037,
     'AP75': 0.2744706,
     'APl': 0.36711735,
     'APm': 0.26435953,
     'APs': 0.08360111,
     'ARl': 0.45245412,
     'ARm': 0.36161834,
     'ARmax1': 0.22504939,
     'ARmax10': 0.329485,
     'ARmax100': 0.34098184,
     'ARs': 0.1265694,
     'avg_iou_3': 0.46327716,
     'avg_iou_4': 0.6748735,
     'avg_iou_5': 0.745741,
     'avg_obj_3': 0.2560827,
     'avg_obj_4': 0.49723613,
     'avg_obj_5': 0.65826494,
     'box_loss_3': 0.012596653,
     'box_loss_4': 0.012164613,
     'box_loss_5': 0.01136647,
     'class_loss_3': 0.0053678625,
     'class_loss_4': 0.0056417105,
     'class_loss_5': 0.0055147065,
     'conf_loss_3': 0.032481123,
     'conf_loss_4': 0.029881326,
     'conf_loss_5': 0.02319787,
     'recall50_3': 0.24389526,
     'recall50_4': 0.51732737,
     'recall50_5': 0.6922517,
     'total_loss': 0.13821232,
     'validation_loss': 0.13821232}I0330 20:53:54.457415 140260967741248 controller.py:211] train | step:  20000 | training until step 25000...
I0330 21:32:15.322311 140260967741248 controller.py:425] train | step:  25000 | steps/sec:    1.8 | output: 
    {'avg_iou_3': 0.61594373,
     'avg_iou_4': 0.7407663,
     'avg_iou_5': 0.79210764,
     'avg_obj_3': 0.35760456,
     'avg_obj_4': 0.56432444,
     'avg_obj_5': 0.7043569,
     'box_loss_3': 0.020234087,
     'box_loss_4': 0.014047975,
     'box_loss_5': 0.011809414,
     'class_loss_3': 0.008302659,
     'class_loss_4': 0.006546644,
     'class_loss_5': 0.0059335255,
     'conf_loss_3': 0.07456094,
     'conf_loss_4': 0.057399455,
     'conf_loss_5': 0.031155158,
     'learning_rate': 0.001,
     'recall50_3': 0.30433702,
     'recall50_4': 0.57903844,
     'recall50_5': 0.7474515,
     'total_loss': 1.839923,
     'training_loss': 1.839923}
I0330 21:33:03.355712 140260967741248 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-25000.
I0330 21:33:03.361991 140260967741248 controller.py:252]  eval | step:  25000 | running 625 steps of evaluation...
I0330 21:37:05.639009 140260967741248 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0330 21:40:56.202298 140260967741248 controller.py:261]  eval | step:  25000 | eval time:  472.8 sec | output: 
    {'AP': 0.26533997,
     'AP50': 0.4284086,
     'AP75': 0.2835051,
     'APl': 0.37556058,
     'APm': 0.27927527,
     'APs': 0.092015,
     'ARl': 0.4667614,
     'ARm': 0.36816296,
     'ARmax1': 0.22891167,
     'ARmax10': 0.33483094,
     'ARmax100': 0.34428754,
     'ARs': 0.13596556,
     'avg_iou_3': 0.46554014,
     'avg_iou_4': 0.6791233,
     'avg_iou_5': 0.75305533,
     'avg_obj_3': 0.25359574,
     'avg_obj_4': 0.48856476,
     'avg_obj_5': 0.6479307,
     'box_loss_3': 0.0124700945,
     'box_loss_4': 0.011921052,
     'box_loss_5': 0.010969728,
     'class_loss_3': 0.0050111525,
     'class_loss_4': 0.0054707946,
     'class_loss_5': 0.005547195,
     'conf_loss_3': 0.03313837,
     'conf_loss_4': 0.029933538,
     'conf_loss_5': 0.022619063,
     'recall50_3': 0.24196428,
     'recall50_4': 0.5043831,
     'recall50_5': 0.68167275,
     'total_loss': 0.13708085,
     'validation_loss': 0.13708085}
I0330 21:41:19.746762 140260967741248 controller.py:211] train | step:  25000 | training until step 30000...
I0330 22:20:44.969194 140260967741248 controller.py:425] train | step:  30000 | steps/sec:    1.7 | output: 
    {'avg_iou_3': 0.6216315,
     'avg_iou_4': 0.7480448,
     'avg_iou_5': 0.7998113,
     'avg_obj_3': 0.37381944,
     'avg_obj_4': 0.5846816,
     'avg_obj_5': 0.72331727,
     'box_loss_3': 0.019914944,
     'box_loss_4': 0.013641436,
     'box_loss_5': 0.011361667,
     'class_loss_3': 0.007863581,
     'class_loss_4': 0.0060881353,
     'class_loss_5': 0.005486312,
     'conf_loss_3': 0.074853,
     'conf_loss_4': 0.056166656,
     'conf_loss_5': 0.03026817,
     'learning_rate': 0.001,
     'recall50_3': 0.32388318,
     'recall50_4': 0.6027102,
     'recall50_5': 0.76652366,
     'total_loss': 1.8051519,
     'training_loss': 1.8051519}
I0330 22:21:40.081067 140260967741248 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-30000.
I0330 22:21:40.087769 140260967741248 controller.py:252]  eval | step:  30000 | running 625 steps of evaluation...
I0330 22:25:43.256891 140260967741248 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0330 22:29:29.375783 140260967741248 controller.py:261]  eval | step:  30000 | eval time:  469.3 sec | output: 
    {'AP': 0.27523863,
     'AP50': 0.44779396,
     'AP75': 0.2931089,
     'APl': 0.3971365,
     'APm': 0.288058,
     'APs': 0.09870121,
     'ARl': 0.48696783,
     'ARm': 0.38435143,
     'ARmax1': 0.24055333,
     'ARmax10': 0.3505568,
     'ARmax100': 0.36213934,
     'ARs': 0.14805783,
     'avg_iou_3': 0.46718726,
     'avg_iou_4': 0.6839327,
     'avg_iou_5': 0.7529232,
     'avg_obj_3': 0.2671275,
     'avg_obj_4': 0.5211795,
     'avg_obj_5': 0.6687349,
     'box_loss_3': 0.012370641,
     'box_loss_4': 0.011651376,
     'box_loss_5': 0.010945706,
     'class_loss_3': 0.004779819,
     'class_loss_4': 0.0050724624,
     'class_loss_5': 0.0050691813,
     'conf_loss_3': 0.032867644,
     'conf_loss_4': 0.029665906,
     'conf_loss_5': 0.022507062,
     'recall50_3': 0.2611798,
     'recall50_4': 0.5433456,
     'recall50_5': 0.70159924,
     'total_loss': 0.13492985,
     'validation_loss': 0.13492985}
I0330 22:29:52.199424 140260967741248 controller.py:211] train | step:  30000 | training until step 35000...
I0330 23:08:21.011821 140260967741248 controller.py:425] train | step:  35000 | steps/sec:    1.8 | output: 
    {'avg_iou_3': 0.62643176,
     'avg_iou_4': 0.7539921,
     'avg_iou_5': 0.80562425,
     'avg_obj_3': 0.38721797,
     'avg_obj_4': 0.601581,
     'avg_obj_5': 0.7386721,
     'box_loss_3': 0.019670837,
     'box_loss_4': 0.0133126415,
     'box_loss_5': 0.011024886,
     'class_loss_3': 0.007520359,
     'class_loss_4': 0.005739304,
     'class_loss_5': 0.0051593403,
     'conf_loss_3': 0.07363145,
     'conf_loss_4': 0.055458184,
     'conf_loss_5': 0.029472945,
     'learning_rate': 0.001,
     'recall50_3': 0.33994767,
     'recall50_4': 0.6221519,
     'recall50_5': 0.7812898,
     'total_loss': 1.7679209,
     'training_loss': 1.7679209}
I0330 23:09:11.018958 140260967741248 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-35000.
I0330 23:09:11.024030 140260967741248 controller.py:252]  eval | step:  35000 | running 625 steps of evaluation...
I0330 23:13:13.993744 140260967741248 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.

train | step:  20000 | training until step 25000...
train | step:  25000 | steps/sec:    1.8 | output: 
    {'avg_iou_3': 0.61594373,
     'avg_iou_4': 0.7407663,
     'avg_iou_5': 0.79210764,
     'avg_obj_3': 0.35760456,
     'avg_obj_4': 0.56432444,
     'avg_obj_5': 0.7043569,
     'box_loss_3': 0.020234087,
     'box_loss_4': 0.014047975,
     'box_loss_5': 0.011809414,
     'class_loss_3': 0.008302659,
     'class_loss_4': 0.006546644,
     'class_loss_5': 0.0059335255,
     'conf_loss_3': 0.07456094,
     'conf_loss_4': 0.057399455,
     'conf_loss_5': 0.031155158,
     'learning_rate': 0.001,
     'recall50_3': 0.30433702,
     'recall50_4': 0.57903844,
     'recall50_5': 0.7474515,
     'total_loss': 1.839923,
     'training_loss': 1.839923}
saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-25000.
 eval | step:  25000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=171.57s).
Accumulating evaluation results...
DONE (t=3.17s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.265
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.428
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.284
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.092
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.279
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.376
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.229
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.335
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.344
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.136
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.368
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.467
 eval | step:  25000 | eval time:  472.8 sec | output: 
    {'AP': 0.26533997,
     'AP50': 0.4284086,
     'AP75': 0.2835051,
     'APl': 0.37556058,
     'APm': 0.27927527,
     'APs': 0.092015,
     'ARl': 0.4667614,
     'ARm': 0.36816296,
     'ARmax1': 0.22891167,
     'ARmax10': 0.33483094,
     'ARmax100': 0.34428754,
     'ARs': 0.13596556,
     'avg_iou_3': 0.46554014,
     'avg_iou_4': 0.6791233,
     'avg_iou_5': 0.75305533,
     'avg_obj_3': 0.25359574,
     'avg_obj_4': 0.48856476,
     'avg_obj_5': 0.6479307,
     'box_loss_3': 0.0124700945,
     'box_loss_4': 0.011921052,
     'box_loss_5': 0.010969728,
     'class_loss_3': 0.0050111525,
     'class_loss_4': 0.0054707946,
     'class_loss_5': 0.005547195,
     'conf_loss_3': 0.03313837,
     'conf_loss_4': 0.029933538,
     'conf_loss_5': 0.022619063,
     'recall50_3': 0.24196428,
     'recall50_4': 0.5043831,
     'recall50_5': 0.68167275,
     'total_loss': 0.13708085,
     'validation_loss': 0.13708085}
train | step:  25000 | training until step 30000...
train | step:  30000 | steps/sec:    1.7 | output: 
    {'avg_iou_3': 0.6216315,
     'avg_iou_4': 0.7480448,
     'avg_iou_5': 0.7998113,
     'avg_obj_3': 0.37381944,
     'avg_obj_4': 0.5846816,
     'avg_obj_5': 0.72331727,
     'box_loss_3': 0.019914944,
     'box_loss_4': 0.013641436,
     'box_loss_5': 0.011361667,
     'class_loss_3': 0.007863581,
     'class_loss_4': 0.0060881353,
     'class_loss_5': 0.005486312,
     'conf_loss_3': 0.074853,
     'conf_loss_4': 0.056166656,
     'conf_loss_5': 0.03026817,
     'learning_rate': 0.001,
     'recall50_3': 0.32388318,
     'recall50_4': 0.6027102,
     'recall50_5': 0.76652366,
     'total_loss': 1.8051519,
     'training_loss': 1.8051519}
saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-30000.
 eval | step:  30000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=169.69s).
Accumulating evaluation results...
DONE (t=3.30s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.275
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.448
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.293
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.099
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.288
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.397
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.241
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.351
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.362
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.148
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.384
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.487
 eval | step:  30000 | eval time:  469.3 sec | output: 
    {'AP': 0.27523863,
     'AP50': 0.44779396,
     'AP75': 0.2931089,
     'APl': 0.3971365,
     'APm': 0.288058,
     'APs': 0.09870121,
     'ARl': 0.48696783,
     'ARm': 0.38435143,
     'ARmax1': 0.24055333,
     'ARmax10': 0.3505568,
     'ARmax100': 0.36213934,
     'ARs': 0.14805783,
     'avg_iou_3': 0.46718726,
     'avg_iou_4': 0.6839327,
     'avg_iou_5': 0.7529232,
     'avg_obj_3': 0.2671275,
     'avg_obj_4': 0.5211795,
     'avg_obj_5': 0.6687349,
     'box_loss_3': 0.012370641,
     'box_loss_4': 0.011651376,
     'box_loss_5': 0.010945706,
     'class_loss_3': 0.004779819,
     'class_loss_4': 0.0050724624,
     'class_loss_5': 0.0050691813,
     'conf_loss_3': 0.032867644,
     'conf_loss_4': 0.029665906,
     'conf_loss_5': 0.022507062,
     'recall50_3': 0.2611798,
     'recall50_4': 0.5433456,
     'recall50_5': 0.70159924,
     'total_loss': 0.13492985,
     'validation_loss': 0.13492985}
train | step:  30000 | training until step 35000...
train | step:  35000 | steps/sec:    1.8 | output: 
    {'avg_iou_3': 0.62643176,
     'avg_iou_4': 0.7539921,
     'avg_iou_5': 0.80562425,
     'avg_obj_3': 0.38721797,
     'avg_obj_4': 0.601581,
     'avg_obj_5': 0.7386721,
     'box_loss_3': 0.019670837,
     'box_loss_4': 0.0133126415,
     'box_loss_5': 0.011024886,
     'class_loss_3': 0.007520359,
     'class_loss_4': 0.005739304,
     'class_loss_5': 0.0051593403,
     'conf_loss_3': 0.07363145,
     'conf_loss_4': 0.055458184,
     'conf_loss_5': 0.029472945,
     'learning_rate': 0.001,
     'recall50_3': 0.33994767,
     'recall50_4': 0.6221519,
     'recall50_5': 0.7812898,
     'total_loss': 1.7679209,
     'training_loss': 1.7679209}
saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-35000.
 eval | step:  35000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=172.05s).
Accumulating evaluation results...
DONE (t=3.18s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.290
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.462
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.314
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.114
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.306
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.403
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.248
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.362
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.374
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.163
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.396
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.496I0330 23:17:05.639143 140260967741248 controller.py:261]  eval | step:  35000 | eval time:  474.6 sec | output: 
    {'AP': 0.29041255,
     'AP50': 0.46175572,
     'AP75': 0.31379512,
     'APl': 0.40315276,
     'APm': 0.30576766,
     'APs': 0.113965735,
     'ARl': 0.49580833,
     'ARm': 0.3959468,
     'ARmax1': 0.24815479,
     'ARmax10': 0.36248922,
     'ARmax100': 0.37390488,
     'ARs': 0.16313682,
     'avg_iou_3': 0.47171578,
     'avg_iou_4': 0.6857727,
     'avg_iou_5': 0.7579152,
     'avg_obj_3': 0.2642264,
     'avg_obj_4': 0.50965935,
     'avg_obj_5': 0.660785,
     'box_loss_3': 0.012124943,
     'box_loss_4': 0.011547786,
     'box_loss_5': 0.010683539,
     'class_loss_3': 0.004625037,
     'class_loss_4': 0.0048141764,
     'class_loss_5': 0.004922376,
     'conf_loss_3': 0.03225595,
     'conf_loss_4': 0.028935319,
     'conf_loss_5': 0.022451414,
     'recall50_3': 0.25592855,
     'recall50_4': 0.5292211,
     'recall50_5': 0.6973333,
     'total_loss': 0.13236055,
     'validation_loss': 0.13236055}
I0330 23:17:29.854607 140260967741248 controller.py:211] train | step:  35000 | training until step 40000...
I0330 23:55:55.299774 140260967741248 controller.py:425] train | step:  40000 | steps/sec:    1.8 | output: 
    {'avg_iou_3': 0.63034827,
     'avg_iou_4': 0.7588982,
     'avg_iou_5': 0.8106731,
     'avg_obj_3': 0.39904648,
     'avg_obj_4': 0.6165427,
     'avg_obj_5': 0.75199133,
     'box_loss_3': 0.019440956,
     'box_loss_4': 0.013035648,
     'box_loss_5': 0.010730106,
     'class_loss_3': 0.0072442656,
     'class_loss_4': 0.005464193,
     'class_loss_5': 0.004898356,
     'conf_loss_3': 0.07241273,
     'conf_loss_4': 0.054429505,
     'conf_loss_5': 0.028758697,
     'learning_rate': 0.001,
     'recall50_3': 0.35378462,
     'recall50_4': 0.6378521,
     'recall50_5': 0.79411775,
     'total_loss': 1.7313125,
     'training_loss': 1.7313125}
I0330 23:56:58.265769 140260967741248 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-40000.
I0330 23:56:58.271852 140260967741248 controller.py:252]  eval | step:  40000 | running 625 steps of evaluation...
I0331 00:01:12.505485 140260967741248 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0331 00:05:00.115664 140260967741248 controller.py:261]  eval | step:  40000 | eval time:  481.8 sec | output: 
    {'AP': 0.29081467,
     'AP50': 0.46545523,
     'AP75': 0.31469136,
     'APl': 0.4184468,
     'APm': 0.3039072,
     'APs': 0.10675237,
     'ARl': 0.51072943,
     'ARm': 0.3966188,
     'ARmax1': 0.24612875,
     'ARmax10': 0.36158592,
     'ARmax100': 0.37350616,
     'ARs': 0.15272698,
     'avg_iou_3': 0.47139508,
     'avg_iou_4': 0.688514,
     'avg_iou_5': 0.7585043,
     'avg_obj_3': 0.2660083,
     'avg_obj_4': 0.51998615,
     'avg_obj_5': 0.6657817,
     'box_loss_3': 0.012115135,
     'box_loss_4': 0.011395268,
     'box_loss_5': 0.010623709,
     'class_loss_3': 0.0044890186,
     'class_loss_4': 0.004623098,
     'class_loss_5': 0.0046983063,
     'conf_loss_3': 0.032399885,
     'conf_loss_4': 0.02970761,
     'conf_loss_5': 0.022043698,
     'recall50_3': 0.25675678,
     'recall50_4': 0.5401062,
     'recall50_5': 0.7011005,
     'total_loss': 0.13209578,
     'validation_loss': 0.13209578}
I0331 00:05:25.964791 140260967741248 controller.py:211] train | step:  40000 | training until step 45000...
I0331 00:49:02.771182 140260967741248 controller.py:425] train | step:  45000 | steps/sec:    1.6 | output: 
    {'avg_iou_3': 0.6335591,
     'avg_iou_4': 0.76299447,
     'avg_iou_5': 0.81468606,
     'avg_obj_3': 0.40916577,
     'avg_obj_4': 0.6292442,
     'avg_obj_5': 0.7632043,
     'box_loss_3': 0.019270755,
     'box_loss_4': 0.012809674,
     'box_loss_5': 0.010495658,
     'class_loss_3': 0.007020974,
     'class_loss_4': 0.0052456106,
     'class_loss_5': 0.0046872194,
     'conf_loss_3': 0.07139993,
     'conf_loss_4': 0.053604625,
     'conf_loss_5': 0.028106747,
     'learning_rate': 0.001,
     'recall50_3': 0.36601728,
     'recall50_4': 0.65208757,
     'recall50_5': 0.8042077,
     'total_loss': 1.7011316,
     'training_loss': 1.7011316}
I0331 00:49:51.898410 140260967741248 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-45000.
I0331 00:49:51.907047 140260967741248 controller.py:252]  eval | step:  45000 | running 625 steps of evaluation...
I0331 00:54:02.076188 140260967741248 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0331 00:57:55.133621 140260967741248 controller.py:261]  eval | step:  45000 | eval time:  483.2 sec | output: 
    {'AP': 0.30444238,
     'AP50': 0.47936347,
     'AP75': 0.32676554,
     'APl': 0.42643324,
     'APm': 0.326092,
     'APs': 0.11729815,
     'ARl': 0.5226023,
     'ARm': 0.41996366,
     'ARmax1': 0.25778356,
     'ARmax10': 0.3798124,
     'ARmax100': 0.39188373,
     'ARs': 0.16865125,
     'avg_iou_3': 0.47420257,
     'avg_iou_4': 0.69286704,
     'avg_iou_5': 0.760042,
     'avg_obj_3': 0.27525267,
     'avg_obj_4': 0.53614026,
     'avg_obj_5': 0.6838919,
     'box_loss_3': 0.011980643,
     'box_loss_4': 0.011171419,
     'box_loss_5': 0.010554859,
     'class_loss_3': 0.004361386,
     'class_loss_4': 0.004677775,
     'class_loss_5': 0.0047436166,
     'conf_loss_3': 0.03276408,
     'conf_loss_4': 0.030005755,
     'conf_loss_5': 0.023097485,
     'recall50_3': 0.269095,
     'recall50_4': 0.55788577,
     'recall50_5': 0.7231311,
     'total_loss': 0.13335706,
     'validation_loss': 0.13335706}
I0331 00:58:21.749327 140260967741248 controller.py:211] train | step:  45000 | training until step 50000...
I0331 01:36:40.874902 140260967741248 controller.py:425] train | step:  50000 | steps/sec:    1.7 | output: 
    {'avg_iou_3': 0.6357898,
     'avg_iou_4': 0.7661126,
     'avg_iou_5': 0.81777275,
     'avg_obj_3': 0.41680902,
     'avg_obj_4': 0.63896936,
     'avg_obj_5': 0.77267253,
     'box_loss_3': 0.019145904,
     'box_loss_4': 0.012643336,
     'box_loss_5': 0.010329807,
     'class_loss_3': 0.006866143,
     'class_loss_4': 0.0050889696,
     'class_loss_5': 0.0045289174,
     'conf_loss_3': 0.070780225,
     'conf_loss_4': 0.05288312,
     'conf_loss_5': 0.027547412,
     'learning_rate': 0.001,
     'recall50_3': 0.37526274,
     'recall50_4': 0.6629027,
     'recall50_5': 0.8130171,
     'total_loss': 1.6785084,
     'training_loss': 1.6785084}
I0331 01:37:36.616192 140260967741248 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-50000.
I0331 01:37:36.623483 140260967741248 controller.py:252]  eval | step:  50000 | running 625 steps of evaluation...
I0331 01:41:47.448684 140260967741248 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.

 eval | step:  35000 | eval time:  474.6 sec | output: 
    {'AP': 0.29041255,
     'AP50': 0.46175572,
     'AP75': 0.31379512,
     'APl': 0.40315276,
     'APm': 0.30576766,
     'APs': 0.113965735,
     'ARl': 0.49580833,
     'ARm': 0.3959468,
     'ARmax1': 0.24815479,
     'ARmax10': 0.36248922,
     'ARmax100': 0.37390488,
     'ARs': 0.16313682,
     'avg_iou_3': 0.47171578,
     'avg_iou_4': 0.6857727,
     'avg_iou_5': 0.7579152,
     'avg_obj_3': 0.2642264,
     'avg_obj_4': 0.50965935,
     'avg_obj_5': 0.660785,
     'box_loss_3': 0.012124943,
     'box_loss_4': 0.011547786,
     'box_loss_5': 0.010683539,
     'class_loss_3': 0.004625037,
     'class_loss_4': 0.0048141764,
     'class_loss_5': 0.004922376,
     'conf_loss_3': 0.03225595,
     'conf_loss_4': 0.028935319,
     'conf_loss_5': 0.022451414,
     'recall50_3': 0.25592855,
     'recall50_4': 0.5292211,
     'recall50_5': 0.6973333,
     'total_loss': 0.13236055,
     'validation_loss': 0.13236055}
train | step:  35000 | training until step 40000...
train | step:  40000 | steps/sec:    1.8 | output: 
    {'avg_iou_3': 0.63034827,
     'avg_iou_4': 0.7588982,
     'avg_iou_5': 0.8106731,
     'avg_obj_3': 0.39904648,
     'avg_obj_4': 0.6165427,
     'avg_obj_5': 0.75199133,
     'box_loss_3': 0.019440956,
     'box_loss_4': 0.013035648,
     'box_loss_5': 0.010730106,
     'class_loss_3': 0.0072442656,
     'class_loss_4': 0.005464193,
     'class_loss_5': 0.004898356,
     'conf_loss_3': 0.07241273,
     'conf_loss_4': 0.054429505,
     'conf_loss_5': 0.028758697,
     'learning_rate': 0.001,
     'recall50_3': 0.35378462,
     'recall50_4': 0.6378521,
     'recall50_5': 0.79411775,
     'total_loss': 1.7313125,
     'training_loss': 1.7313125}
saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-40000.
 eval | step:  40000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=171.13s).
Accumulating evaluation results...
DONE (t=3.14s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.291
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.465
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.315
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.107
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.304
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.418
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.246
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.362
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.374
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.153
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.397
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.511
 eval | step:  40000 | eval time:  481.8 sec | output: 
    {'AP': 0.29081467,
     'AP50': 0.46545523,
     'AP75': 0.31469136,
     'APl': 0.4184468,
     'APm': 0.3039072,
     'APs': 0.10675237,
     'ARl': 0.51072943,
     'ARm': 0.3966188,
     'ARmax1': 0.24612875,
     'ARmax10': 0.36158592,
     'ARmax100': 0.37350616,
     'ARs': 0.15272698,
     'avg_iou_3': 0.47139508,
     'avg_iou_4': 0.688514,
     'avg_iou_5': 0.7585043,
     'avg_obj_3': 0.2660083,
     'avg_obj_4': 0.51998615,
     'avg_obj_5': 0.6657817,
     'box_loss_3': 0.012115135,
     'box_loss_4': 0.011395268,
     'box_loss_5': 0.010623709,
     'class_loss_3': 0.0044890186,
     'class_loss_4': 0.004623098,
     'class_loss_5': 0.0046983063,
     'conf_loss_3': 0.032399885,
     'conf_loss_4': 0.02970761,
     'conf_loss_5': 0.022043698,
     'recall50_3': 0.25675678,
     'recall50_4': 0.5401062,
     'recall50_5': 0.7011005,
     'total_loss': 0.13209578,
     'validation_loss': 0.13209578}
train | step:  40000 | training until step 45000...
train | step:  45000 | steps/sec:    1.6 | output: 
    {'avg_iou_3': 0.6335591,
     'avg_iou_4': 0.76299447,
     'avg_iou_5': 0.81468606,
     'avg_obj_3': 0.40916577,
     'avg_obj_4': 0.6292442,
     'avg_obj_5': 0.7632043,
     'box_loss_3': 0.019270755,
     'box_loss_4': 0.012809674,
     'box_loss_5': 0.010495658,
     'class_loss_3': 0.007020974,
     'class_loss_4': 0.0052456106,
     'class_loss_5': 0.0046872194,
     'conf_loss_3': 0.07139993,
     'conf_loss_4': 0.053604625,
     'conf_loss_5': 0.028106747,
     'learning_rate': 0.001,
     'recall50_3': 0.36601728,
     'recall50_4': 0.65208757,
     'recall50_5': 0.8042077,
     'total_loss': 1.7011316,
     'training_loss': 1.7011316}
saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-45000.
 eval | step:  45000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=175.63s).
Accumulating evaluation results...
DONE (t=3.31s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.304
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.479
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.327
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.117
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.326
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.426
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.258
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.380
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.392
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.169
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.420
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.523
 eval | step:  45000 | eval time:  483.2 sec | output: 
    {'AP': 0.30444238,
     'AP50': 0.47936347,
     'AP75': 0.32676554,
     'APl': 0.42643324,
     'APm': 0.326092,
     'APs': 0.11729815,
     'ARl': 0.5226023,
     'ARm': 0.41996366,
     'ARmax1': 0.25778356,
     'ARmax10': 0.3798124,
     'ARmax100': 0.39188373,
     'ARs': 0.16865125,
     'avg_iou_3': 0.47420257,
     'avg_iou_4': 0.69286704,
     'avg_iou_5': 0.760042,
     'avg_obj_3': 0.27525267,
     'avg_obj_4': 0.53614026,
     'avg_obj_5': 0.6838919,
     'box_loss_3': 0.011980643,
     'box_loss_4': 0.011171419,
     'box_loss_5': 0.010554859,
     'class_loss_3': 0.004361386,
     'class_loss_4': 0.004677775,
     'class_loss_5': 0.0047436166,
     'conf_loss_3': 0.03276408,
     'conf_loss_4': 0.030005755,
     'conf_loss_5': 0.023097485,
     'recall50_3': 0.269095,
     'recall50_4': 0.55788577,
     'recall50_5': 0.7231311,
     'total_loss': 0.13335706,
     'validation_loss': 0.13335706}
train | step:  45000 | training until step 50000...
train | step:  50000 | steps/sec:    1.7 | output: 
    {'avg_iou_3': 0.6357898,
     'avg_iou_4': 0.7661126,
     'avg_iou_5': 0.81777275,
     'avg_obj_3': 0.41680902,
     'avg_obj_4': 0.63896936,
     'avg_obj_5': 0.77267253,
     'box_loss_3': 0.019145904,
     'box_loss_4': 0.012643336,
     'box_loss_5': 0.010329807,
     'class_loss_3': 0.006866143,
     'class_loss_4': 0.0050889696,
     'class_loss_5': 0.0045289174,
     'conf_loss_3': 0.070780225,
     'conf_loss_4': 0.05288312,
     'conf_loss_5': 0.027547412,
     'learning_rate': 0.001,
     'recall50_3': 0.37526274,
     'recall50_4': 0.6629027,
     'recall50_5': 0.8130171,
     'total_loss': 1.6785084,
     'training_loss': 1.6785084}
saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-50000.
 eval | step:  50000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=174.13s).
Accumulating evaluation results...I0331 01:45:37.051455 140260967741248 controller.py:261]  eval | step:  50000 | eval time:  480.4 sec | output: 
    {'AP': 0.3061052,
     'AP50': 0.47745687,
     'AP75': 0.32929194,
     'APl': 0.4387611,
     'APm': 0.31749362,
     'APs': 0.122202374,
     'ARl': 0.53163904,
     'ARm': 0.4099293,
     'ARmax1': 0.26017508,
     'ARmax10': 0.3816518,
     'ARmax100': 0.39356914,
     'ARs': 0.17744449,
     'avg_iou_3': 0.4747187,
     'avg_iou_4': 0.6953437,
     'avg_iou_5': 0.76838756,
     'avg_obj_3': 0.27698565,
     'avg_obj_4': 0.5410552,
     'avg_obj_5': 0.69513285,
     'box_loss_3': 0.011973296,
     'box_loss_4': 0.0110359555,
     'box_loss_5': 0.010120898,
     'class_loss_3': 0.0042991987,
     'class_loss_4': 0.0046356632,
     'class_loss_5': 0.004712383,
     'conf_loss_3': 0.032288738,
     'conf_loss_4': 0.029750528,
     'conf_loss_5': 0.022637391,
     'recall50_3': 0.27130795,
     'recall50_4': 0.56490254,
     'recall50_5': 0.7303929,
     'total_loss': 0.13145404,
     'validation_loss': 0.13145404}
I0331 01:46:08.104021 140260967741248 controller.py:211] train | step:  50000 | training until step 55000...
I0331 02:24:02.887885 140260967741248 controller.py:425] train | step:  55000 | steps/sec:    1.8 | output: 
    {'avg_iou_3': 0.6466938,
     'avg_iou_4': 0.7797732,
     'avg_iou_5': 0.8322298,
     'avg_obj_3': 0.4489135,
     'avg_obj_4': 0.67778283,
     'avg_obj_5': 0.80692106,
     'box_loss_3': 0.018574124,
     'box_loss_4': 0.011890368,
     'box_loss_5': 0.009493168,
     'class_loss_3': 0.006200651,
     'class_loss_4': 0.0044213478,
     'class_loss_5': 0.0039144647,
     'conf_loss_3': 0.068251856,
     'conf_loss_4': 0.05071673,
     'conf_loss_5': 0.025993295,
     'learning_rate': 1e-04,
     'recall50_3': 0.41346475,
     'recall50_4': 0.70401865,
     'recall50_5': 0.84346414,
     'total_loss': 1.5956476,
     'training_loss': 1.5956476}
I0331 02:24:59.031188 140260967741248 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-55000.
I0331 02:24:59.036878 140260967741248 controller.py:252]  eval | step:  55000 | running 625 steps of evaluation...
I0331 02:29:08.677889 140260967741248 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0331 02:33:11.653011 140260967741248 controller.py:261]  eval | step:  55000 | eval time:  492.6 sec | output: 
    {'AP': 0.33366522,
     'AP50': 0.51331395,
     'AP75': 0.35678044,
     'APl': 0.47167686,
     'APm': 0.3493519,
     'APs': 0.13595252,
     'ARl': 0.56135815,
     'ARm': 0.44480062,
     'ARmax1': 0.27753013,
     'ARmax10': 0.4084686,
     'ARmax100': 0.4218008,
     'ARs': 0.20045571,
     'avg_iou_3': 0.4827363,
     'avg_iou_4': 0.7028398,
     'avg_iou_5': 0.77672994,
     'avg_obj_3': 0.30400595,
     'avg_obj_4': 0.5677154,
     'avg_obj_5': 0.71869504,
     'box_loss_3': 0.01151794,
     'box_loss_4': 0.01061854,
     'box_loss_5': 0.009645499,
     'class_loss_3': 0.0038504207,
     'class_loss_4': 0.003997368,
     'class_loss_5': 0.004013496,
     'conf_loss_3': 0.03228882,
     'conf_loss_4': 0.030037314,
     'conf_loss_5': 0.022674883,
     'recall50_3': 0.303721,
     'recall50_4': 0.592985,
     'recall50_5': 0.7512185,
     'total_loss': 0.12864429,
     'validation_loss': 0.12864429}
I0331 02:33:36.705401 140260967741248 controller.py:211] train | step:  55000 | training until step 60000...
I0331 03:09:12.132311 140260967741248 controller.py:425] train | step:  60000 | steps/sec:    1.8 | output: 
    {'avg_iou_3': 0.6493197,
     'avg_iou_4': 0.7831838,
     'avg_iou_5': 0.8357573,
     'avg_obj_3': 0.4586408,
     'avg_obj_4': 0.68930095,
     'avg_obj_5': 0.81723547,
     'box_loss_3': 0.018420085,
     'box_loss_4': 0.0116974,
     'box_loss_5': 0.009291536,
     'class_loss_3': 0.0060185245,
     'class_loss_4': 0.004249166,
     'class_loss_5': 0.0037425857,
     'conf_loss_3': 0.06751543,
     'conf_loss_4': 0.05001325,
     'conf_loss_5': 0.025420243,
     'learning_rate': 1e-05,
     'recall50_3': 0.4249559,
     'recall50_4': 0.71640116,
     'recall50_5': 0.85248125,
     'total_loss': 1.5709456,
     'training_loss': 1.5709456}
I0331 03:10:06.282043 140260967741248 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-60000.
I0331 03:10:06.287711 140260967741248 controller.py:252]  eval | step:  60000 | running 625 steps of evaluation...
I0331 03:14:10.434021 140260967741248 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0331 03:18:12.167179 140260967741248 controller.py:261]  eval | step:  60000 | eval time:  485.9 sec | output: 
    {'AP': 0.33485976,
     'AP50': 0.513561,
     'AP75': 0.35783362,
     'APl': 0.47530615,
     'APm': 0.35112008,
     'APs': 0.13553073,
     'ARl': 0.5647732,
     'ARm': 0.44686857,
     'ARmax1': 0.27893022,
     'ARmax10': 0.40919316,
     'ARmax100': 0.42223397,
     'ARs': 0.19772011,
     'avg_iou_3': 0.48310617,
     'avg_iou_4': 0.70441127,
     'avg_iou_5': 0.7771965,
     'avg_obj_3': 0.30414796,
     'avg_obj_4': 0.568723,
     'avg_obj_5': 0.7195633,
     'box_loss_3': 0.011492563,
     'box_loss_4': 0.010536423,
     'box_loss_5': 0.009621225,
     'class_loss_3': 0.0038366946,
     'class_loss_4': 0.003981364,
     'class_loss_5': 0.003979015,
     'conf_loss_3': 0.032276854,
     'conf_loss_4': 0.030324416,
     'conf_loss_5': 0.022834057,
     'recall50_3': 0.30446208,
     'recall50_4': 0.59412795,
     'recall50_5': 0.75068694,
     'total_loss': 0.12888259,
     'validation_loss': 0.12888259}
I0331 03:18:35.242441 140260967741248 controller.py:211] train | step:  60000 | training until step 62500...
I0331 03:30:20.810842 140260967741248 controller.py:425] train | step:  62500 | steps/sec:    2.0 | output: 
    {'avg_iou_3': 0.64978373,
     'avg_iou_4': 0.78342795,
     'avg_iou_5': 0.8364621,
     'avg_obj_3': 0.45986572,
     'avg_obj_4': 0.6905138,
     'avg_obj_5': 0.81897056,
     'box_loss_3': 0.018424092,
     'box_loss_4': 0.011689891,
     'box_loss_5': 0.009237851,
     'class_loss_3': 0.00597906,
     'class_loss_4': 0.0042248415,
     'class_loss_5': 0.0037055614,
     'conf_loss_3': 0.06740603,
     'conf_loss_4': 0.049955573,
     'conf_loss_5': 0.025360337,
     'learning_rate': 1e-05,
     'recall50_3': 0.42722568,
     'recall50_4': 0.7186937,
     'recall50_5': 0.85406995,
     'total_loss': 1.5678658,
     'training_loss': 1.5678658}

DONE (t=3.26s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.306
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.477
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.329
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.122
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.317
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.439
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.260
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.382
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.394
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.177
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.410
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.532
 eval | step:  50000 | eval time:  480.4 sec | output: 
    {'AP': 0.3061052,
     'AP50': 0.47745687,
     'AP75': 0.32929194,
     'APl': 0.4387611,
     'APm': 0.31749362,
     'APs': 0.122202374,
     'ARl': 0.53163904,
     'ARm': 0.4099293,
     'ARmax1': 0.26017508,
     'ARmax10': 0.3816518,
     'ARmax100': 0.39356914,
     'ARs': 0.17744449,
     'avg_iou_3': 0.4747187,
     'avg_iou_4': 0.6953437,
     'avg_iou_5': 0.76838756,
     'avg_obj_3': 0.27698565,
     'avg_obj_4': 0.5410552,
     'avg_obj_5': 0.69513285,
     'box_loss_3': 0.011973296,
     'box_loss_4': 0.0110359555,
     'box_loss_5': 0.010120898,
     'class_loss_3': 0.0042991987,
     'class_loss_4': 0.0046356632,
     'class_loss_5': 0.004712383,
     'conf_loss_3': 0.032288738,
     'conf_loss_4': 0.029750528,
     'conf_loss_5': 0.022637391,
     'recall50_3': 0.27130795,
     'recall50_4': 0.56490254,
     'recall50_5': 0.7303929,
     'total_loss': 0.13145404,
     'validation_loss': 0.13145404}
train | step:  50000 | training until step 55000...
train | step:  55000 | steps/sec:    1.8 | output: 
    {'avg_iou_3': 0.6466938,
     'avg_iou_4': 0.7797732,
     'avg_iou_5': 0.8322298,
     'avg_obj_3': 0.4489135,
     'avg_obj_4': 0.67778283,
     'avg_obj_5': 0.80692106,
     'box_loss_3': 0.018574124,
     'box_loss_4': 0.011890368,
     'box_loss_5': 0.009493168,
     'class_loss_3': 0.006200651,
     'class_loss_4': 0.0044213478,
     'class_loss_5': 0.0039144647,
     'conf_loss_3': 0.068251856,
     'conf_loss_4': 0.05071673,
     'conf_loss_5': 0.025993295,
     'learning_rate': 1e-04,
     'recall50_3': 0.41346475,
     'recall50_4': 0.70401865,
     'recall50_5': 0.84346414,
     'total_loss': 1.5956476,
     'training_loss': 1.5956476}
saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-55000.
 eval | step:  55000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=180.35s).
Accumulating evaluation results...
DONE (t=3.27s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.334
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.513
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.357
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.136
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.349
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.472
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.278
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.408
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.422
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.200
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.445
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.561
 eval | step:  55000 | eval time:  492.6 sec | output: 
    {'AP': 0.33366522,
     'AP50': 0.51331395,
     'AP75': 0.35678044,
     'APl': 0.47167686,
     'APm': 0.3493519,
     'APs': 0.13595252,
     'ARl': 0.56135815,
     'ARm': 0.44480062,
     'ARmax1': 0.27753013,
     'ARmax10': 0.4084686,
     'ARmax100': 0.4218008,
     'ARs': 0.20045571,
     'avg_iou_3': 0.4827363,
     'avg_iou_4': 0.7028398,
     'avg_iou_5': 0.77672994,
     'avg_obj_3': 0.30400595,
     'avg_obj_4': 0.5677154,
     'avg_obj_5': 0.71869504,
     'box_loss_3': 0.01151794,
     'box_loss_4': 0.01061854,
     'box_loss_5': 0.009645499,
     'class_loss_3': 0.0038504207,
     'class_loss_4': 0.003997368,
     'class_loss_5': 0.004013496,
     'conf_loss_3': 0.03228882,
     'conf_loss_4': 0.030037314,
     'conf_loss_5': 0.022674883,
     'recall50_3': 0.303721,
     'recall50_4': 0.592985,
     'recall50_5': 0.7512185,
     'total_loss': 0.12864429,
     'validation_loss': 0.12864429}
train | step:  55000 | training until step 60000...
train | step:  60000 | steps/sec:    1.8 | output: 
    {'avg_iou_3': 0.6493197,
     'avg_iou_4': 0.7831838,
     'avg_iou_5': 0.8357573,
     'avg_obj_3': 0.4586408,
     'avg_obj_4': 0.68930095,
     'avg_obj_5': 0.81723547,
     'box_loss_3': 0.018420085,
     'box_loss_4': 0.0116974,
     'box_loss_5': 0.009291536,
     'class_loss_3': 0.0060185245,
     'class_loss_4': 0.004249166,
     'class_loss_5': 0.0037425857,
     'conf_loss_3': 0.06751543,
     'conf_loss_4': 0.05001325,
     'conf_loss_5': 0.025420243,
     'learning_rate': 1e-05,
     'recall50_3': 0.4249559,
     'recall50_4': 0.71640116,
     'recall50_5': 0.85248125,
     'total_loss': 1.5709456,
     'training_loss': 1.5709456}
saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-60000.
 eval | step:  60000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=180.28s).
Accumulating evaluation results...
DONE (t=3.30s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.335
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.514
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.358
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.136
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.351
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.475
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.279
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.409
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.422
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.198
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.447
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.565
 eval | step:  60000 | eval time:  485.9 sec | output: 
    {'AP': 0.33485976,
     'AP50': 0.513561,
     'AP75': 0.35783362,
     'APl': 0.47530615,
     'APm': 0.35112008,
     'APs': 0.13553073,
     'ARl': 0.5647732,
     'ARm': 0.44686857,
     'ARmax1': 0.27893022,
     'ARmax10': 0.40919316,
     'ARmax100': 0.42223397,
     'ARs': 0.19772011,
     'avg_iou_3': 0.48310617,
     'avg_iou_4': 0.70441127,
     'avg_iou_5': 0.7771965,
     'avg_obj_3': 0.30414796,
     'avg_obj_4': 0.568723,
     'avg_obj_5': 0.7195633,
     'box_loss_3': 0.011492563,
     'box_loss_4': 0.010536423,
     'box_loss_5': 0.009621225,
     'class_loss_3': 0.0038366946,
     'class_loss_4': 0.003981364,
     'class_loss_5': 0.003979015,
     'conf_loss_3': 0.032276854,
     'conf_loss_4': 0.030324416,
     'conf_loss_5': 0.022834057,
     'recall50_3': 0.30446208,
     'recall50_4': 0.59412795,
     'recall50_5': 0.75068694,
     'total_loss': 0.12888259,
     'validation_loss': 0.12888259}
train | step:  60000 | training until step 62500...
train | step:  62500 | steps/sec:    2.0 | output: 
    {'avg_iou_3': 0.64978373,
     'avg_iou_4': 0.78342795,
     'avg_iou_5': 0.8364621,
     'avg_obj_3': 0.45986572,
     'avg_obj_4': 0.6905138,
     'avg_obj_5': 0.81897056,
     'box_loss_3': 0.018424092,
     'box_loss_4': 0.011689891,
     'box_loss_5': 0.009237851,
     'class_loss_3': 0.00597906,
     'class_loss_4': 0.0042248415,
     'class_loss_5': 0.0037055614,
     'conf_loss_3': 0.06740603,
     'conf_loss_4': 0.049955573,
     'conf_loss_5': 0.025360337,
     'learning_rate': 1e-05,
     'recall50_3': 0.42722568,
     'recall50_4': 0.7186937,
     'recall50_5': 0.85406995,
     'total_loss': 1.5678658,
     'training_loss': 1.5678658}I0331 03:30:34.935813 140260967741248 controller.py:252]  eval | step:  62500 | running 625 steps of evaluation...
I0331 03:34:42.688618 140260967741248 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0331 03:38:30.459122 140260967741248 controller.py:261]  eval | step:  62500 | eval time:  475.5 sec | output: 
    {'AP': 0.3347872,
     'AP50': 0.51461923,
     'AP75': 0.3582886,
     'APl': 0.47298214,
     'APm': 0.35295597,
     'APs': 0.13577396,
     'ARl': 0.5615605,
     'ARm': 0.4478989,
     'ARmax1': 0.2783054,
     'ARmax10': 0.4089125,
     'ARmax100': 0.4218541,
     'ARs': 0.19789335,
     'avg_iou_3': 0.48307535,
     'avg_iou_4': 0.704059,
     'avg_iou_5': 0.7765441,
     'avg_obj_3': 0.30580768,
     'avg_obj_4': 0.569795,
     'avg_obj_5': 0.72025776,
     'box_loss_3': 0.01149274,
     'box_loss_4': 0.010554391,
     'box_loss_5': 0.00965349,
     'class_loss_3': 0.0038315651,
     'class_loss_4': 0.0039752554,
     'class_loss_5': 0.0039806725,
     'conf_loss_3': 0.032328386,
     'conf_loss_4': 0.030357298,
     'conf_loss_5': 0.022836858,
     'recall50_3': 0.30660892,
     'recall50_4': 0.59530896,
     'recall50_5': 0.7507456,
     'total_loss': 0.12901056,
     'validation_loss': 0.12901056}
I0331 03:39:32.497571 140260967741248 controller.py:455] saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-62500.
I0331 03:39:32.514850 140260967741248 train_lib.py:123] Number of trainable params in model: 53.066944 Millions.

 eval | step:  62500 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=169.73s).
Accumulating evaluation results...
DONE (t=3.21s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.335
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.515
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.358
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.136
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.353
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.473
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.278
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.409
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.422
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.198
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.448
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.562
 eval | step:  62500 | eval time:  475.5 sec | output: 
    {'AP': 0.3347872,
     'AP50': 0.51461923,
     'AP75': 0.3582886,
     'APl': 0.47298214,
     'APm': 0.35295597,
     'APs': 0.13577396,
     'ARl': 0.5615605,
     'ARm': 0.4478989,
     'ARmax1': 0.2783054,
     'ARmax10': 0.4089125,
     'ARmax100': 0.4218541,
     'ARs': 0.19789335,
     'avg_iou_3': 0.48307535,
     'avg_iou_4': 0.704059,
     'avg_iou_5': 0.7765441,
     'avg_obj_3': 0.30580768,
     'avg_obj_4': 0.569795,
     'avg_obj_5': 0.72025776,
     'box_loss_3': 0.01149274,
     'box_loss_4': 0.010554391,
     'box_loss_5': 0.00965349,
     'class_loss_3': 0.0038315651,
     'class_loss_4': 0.0039752554,
     'class_loss_5': 0.0039806725,
     'conf_loss_3': 0.032328386,
     'conf_loss_4': 0.030357298,
     'conf_loss_5': 0.022836858,
     'recall50_3': 0.30660892,
     'recall50_4': 0.59530896,
     'recall50_5': 0.7507456,
     'total_loss': 0.12901056,
     'validation_loss': 0.12901056}
saved checkpoint to gs://tensorflow2/debug-data-loss/adam-sum/yolov4-coco-all-50k-csp/ckpt-62500.
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   234    0     2  100   232     11   1325 --:--:-- --:--:-- --:--:--  1337
okRequest issued for: [node-1]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-03-31T03:39:47.422445302Z'
  endTime: '2021-03-31T03:40:37.763517517Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617161987408-5beccddcdc3cb-bc57e62b-5463caed
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  cidrBlock: 10.62.133.176/29
  createTime: '2021-03-13T00:06:59.130259463Z'
  health: HEALTHY
  ipAddress: 10.62.133.178
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-1
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.62.133.178
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-25T18:43:56.273897550Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-25T18:43:48Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617161987408-5beccddcdc3cb-bc57e62b-5463caed] to complete...
..........................................................................................................................................................................................................................................................................done.
