cat: .experiment_zone: No such file or directory
Request issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-09T16:21:55.138318396Z'
  endTime: '2021-04-09T16:22:27.699529717Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617985315126-5bf8c8ff5bed0-1f084ae9-be9e6154
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617985315126-5bf8c8ff5bed0-1f084ae9-be9e6154] to complete...
............................................................................................................................................................................................done.
europe-west4-a
I0409 16:22:00.575740 139714212276032 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.075,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.2,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 0.6,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.075,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.2,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.0,
                                                    'output_size': [640, 640],
                                                    'random_crop': True,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.001},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': 'str = "AP50"',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'str = "higher"',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine_epoch': {'alpha': 0.2,
                                                                     'decay_steps': None,
                                                                     'initial_learning_rate': 0.01,
                                                                     'name': 'CosineEpoch',
                                                                     'steps_per_epoch': 294375},
                                                    'type': 'cosine_epoch'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.937,
                                                        'name': 'SGD',
                                                        'nesterov': False},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5625},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 20000,
             'summary_interval': 20000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0409 16:22:00.576812 139714212276032 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/data-pipeline/all-300k/params.yaml
I0409 16:22:02.169496 139714212276032 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 16:22:02.788409 139714212276032 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 16:22:02.788760 139714212276032 transport.py:157] Attempting refresh to obtain initial access_token
I0409 16:22:02.877089 139714212276032 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 16:22:03.493305 139714212276032 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 16:22:03.493562 139714212276032 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-09 16:22:03.534680: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0409 16:22:03.535340 139714212276032 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 16:22:03.677583 139714212276032 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 16:22:03.677867 139714212276032 transport.py:157] Attempting refresh to obtain initial access_token
I0409 16:22:03.745768 139714212276032 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 16:22:03.889040 139714212276032 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 16:22:03.889315 139714212276032 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-09 16:22:03.947021: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-09 16:22:03.976225: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-09 16:22:03.976303: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:57155}
2021-04-09 16:22:37.513331: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-09 16:22:37.513421: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:57155}
2021-04-09 16:22:37.514352: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:57155
I0409 16:22:37.515079 139714212276032 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-6
I0409 16:22:37.515886 139714212276032 tpu_strategy_util.py:74] Initializing the TPU system: node-6
INFO:tensorflow:Clearing out eager caches
I0409 16:22:45.293799 139714212276032 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0409 16:22:45.296294 139714212276032 tpu_strategy_util.py:133] Finished initializing TPU system.
I0409 16:22:45.297728 139714212276032 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 16:22:45.443074 139714212276032 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 16:22:45.443338 139714212276032 transport.py:157] Attempting refresh to obtain initial access_token
I0409 16:22:45.496893 139714212276032 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 16:22:46.109704 139714212276032 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 16:22:46.109963 139714212276032 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0409 16:22:46.159697 139714212276032 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0409 16:22:46.159959 139714212276032 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0409 16:22:46.160238 139714212276032 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0409 16:22:46.160293 139714212276032 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0409 16:22:46.160342 139714212276032 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0409 16:22:46.160542 139714212276032 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0409 16:22:46.160595 139714212276032 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0409 16:22:46.160643 139714212276032 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0409 16:22:46.160687 139714212276032 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0409 16:22:46.160733 139714212276032 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0409 16:22:46.160778 139714212276032 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0409 16:22:46.160822 139714212276032 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0409 16:22:46.160866 139714212276032 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0409 16:22:46.160942 139714212276032 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0409 16:22:46.160989 139714212276032 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0409 16:22:46.161034 139714212276032 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0409 16:22:46.185785 139714212276032 train_utils.py:214] Running default trainer.
2021-04-09 16:22:46.202258: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.6, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.0, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'weight_decay': 0.001, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': False, 'momentum': 0.937}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine_epoch', 'cosine_epoch': {'name': 'CosineEpoch', 'initial_learning_rate': 0.01, 'decay_steps': None, 'steps_per_epoch': 294375, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5625}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 20000, 'summary_interval': 20000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': 'str = "AP50"', 'best_checkpoint_metric_comp': 'str = "higher"', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
{'3': 2.0, '4': 2.0, '5': 2.0} 0.0005
{'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f11582259b0>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
route_split 512.0 512.0
conv2 512.0
conv1 512.0
spp
conv1 512.0
conv2 512.0
connect
conv1 512.0
8
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
route_split 256.0 256.0
conv2 256.0
conv1 256.0
conv2 256.0
connect
conv1 256.0
6
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)








 ListWrapper([128, 256, 512])
route_split 128 128
conv2 128
conv1 128
conv2 128
connect
conv1 128
conv2 256
7
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
route_split 256 256
conv2 256
conv1 256
conv2 256
connect
conv1 256
conv2 512
7
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
route_split 512 512
conv2 512
conv1 512
conv2 512
connect
conv1 512
conv2 1024
7
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
detget {'3': 2.0, '4': 2.0, '5': 2.0}
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 149, in main
    model_dir=model_dir)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_lib.py", line 68, in run_experiment
    params, model_dir))
  File "/usr/local/lib/python3.7/dist-packages/gin/config.py", line 1069, in gin_wrapper
    utils.augment_exception_message_and_reraise(e, err_str)
  File "/usr/local/lib/python3.7/dist-packages/gin/utils.py", line 41, in augment_exception_message_and_reraise
    raise proxy.with_traceback(exception.__traceback__) from None
  File "/usr/local/lib/python3.7/dist-packages/gin/config.py", line 1046, in gin_wrapper
    return fn(*new_args, **new_kwargs)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_utils.py", line 217, in create_trainer
    params.runtime)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/base_task.py", line 76, in create_optimizer
    optimizer = opt_factory.build_optimizer(opt_factory.build_learning_rate())
  File "/home/cam2tensorflow/TensorFlowModels/official/modeling/optimization/optimizer_factory.py", line 125, in build_learning_rate
    lr = LR_CLS[self._lr_type](**self._lr_config.as_dict())
  File "/home/cam2tensorflow/TensorFlowModels/official/modeling/optimization/lr_schedule.py", line 275, in __init__
    self.decay_steps = decay_steps//steps_per_epoch
TypeError: unsupported operand type(s) for //: 'NoneType' and 'int'
  In call to configurable 'create_trainer' (<function create_trainer at 0x7f116de566a8>)

(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 80, 80, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   208    0     2  100   206     10   1119 --:--:-- --:--:-- --:--:--  1130
okRequest issued for: [node-6]
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617985426377-5bf8c96974957-480aac00-d72b743d] to complete...
.......................................................................................................................................................aborted by ctrl-c.
ERROR: (gcloud.compute.tpus.stop) Aborting wait for operation https://tpu.googleapis.com/v1alpha1/projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617985426377-5bf8c96974957-480aac00-d72b743d.

cat: .experiment_zone: No such file or directory
Request issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-09T16:24:56.129465374Z'
  endTime: '2021-04-09T16:25:29.426820418Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617985496116-5bf8c9abf6e24-73e31ce1-872f1cfc
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617985496116-5bf8c9abf6e24-73e31ce1-872f1cfc] to complete...
....................................................................................................................................................................................................done.
europe-west4-a
I0409 16:25:02.420338 140314757842752 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.075,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.2,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 0.6,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.075,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.2,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.0,
                                                    'output_size': [640, 640],
                                                    'random_crop': True,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.001},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': 'str = "AP50"',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'str = "higher"',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine_epoch': {'alpha': 0.2,
                                                                     'decay_steps': 1875,
                                                                     'initial_learning_rate': 0.01,
                                                                     'name': 'CosineEpoch',
                                                                     'steps_per_epoch': 294375},
                                                    'type': 'cosine_epoch'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.937,
                                                        'name': 'SGD',
                                                        'nesterov': False},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5625},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 20000,
             'summary_interval': 20000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0409 16:25:02.421529 140314757842752 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/data-pipeline/all-300k/params.yaml
I0409 16:25:03.332339 140314757842752 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 16:25:03.953446 140314757842752 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 16:25:03.953741 140314757842752 transport.py:157] Attempting refresh to obtain initial access_token
I0409 16:25:04.010339 140314757842752 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 16:25:04.629976 140314757842752 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 16:25:04.630252 140314757842752 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-09 16:25:04.670760: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0409 16:25:04.671363 140314757842752 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 16:25:04.814940 140314757842752 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 16:25:04.815222 140314757842752 transport.py:157] Attempting refresh to obtain initial access_token
I0409 16:25:04.858843 140314757842752 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 16:25:05.474392 140314757842752 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 16:25:05.474646 140314757842752 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-09 16:25:05.517203: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-09 16:25:05.530389: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-09 16:25:05.530464: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:57415}
2021-04-09 16:25:41.307698: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-09 16:25:41.307788: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:57415}
2021-04-09 16:25:41.308434: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:57415
I0409 16:25:41.309184 140314757842752 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-6
I0409 16:25:41.309775 140314757842752 tpu_strategy_util.py:74] Initializing the TPU system: node-6
INFO:tensorflow:Clearing out eager caches
I0409 16:25:49.178358 140314757842752 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0409 16:25:49.180740 140314757842752 tpu_strategy_util.py:133] Finished initializing TPU system.
I0409 16:25:49.182308 140314757842752 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 16:25:49.802818 140314757842752 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 16:25:49.803070 140314757842752 transport.py:157] Attempting refresh to obtain initial access_token
I0409 16:25:49.865017 140314757842752 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 16:25:50.004712 140314757842752 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 16:25:50.004960 140314757842752 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0409 16:25:50.046266 140314757842752 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0409 16:25:50.046551 140314757842752 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0409 16:25:50.046931 140314757842752 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0409 16:25:50.047061 140314757842752 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0409 16:25:50.047168 140314757842752 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0409 16:25:50.047434 140314757842752 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0409 16:25:50.047546 140314757842752 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0409 16:25:50.047672 140314757842752 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0409 16:25:50.047767 140314757842752 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0409 16:25:50.047873 140314757842752 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0409 16:25:50.047975 140314757842752 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0409 16:25:50.048080 140314757842752 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0409 16:25:50.048170 140314757842752 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0409 16:25:50.048258 140314757842752 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0409 16:25:50.048553 140314757842752 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0409 16:25:50.048815 140314757842752 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0409 16:25:50.073182 140314757842752 train_utils.py:214] Running default trainer.
2021-04-09 16:25:50.089509: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.6, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.0, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'weight_decay': 0.001, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': False, 'momentum': 0.937}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine_epoch', 'cosine_epoch': {'name': 'CosineEpoch', 'initial_learning_rate': 0.01, 'decay_steps': 1875, 'steps_per_epoch': 294375, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5625}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 20000, 'summary_interval': 20000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': 'str = "AP50"', 'best_checkpoint_metric_comp': 'str = "higher"', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
{'3': 2.0, '4': 2.0, '5': 2.0} 0.0005
{'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f9d2c779860>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
route_split 512.0 512.0
conv2 512.0
conv1 512.0
spp
conv1 512.0
conv2 512.0
connect
conv1 512.0
8
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
route_split 256.0 256.0
conv2 256.0
conv1 256.0
conv2 256.0
connect
conv1 256.0
6
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)








 ListWrapper([128, 256, 512])
route_split 128 128
conv2 128
conv1 128
conv2 128
connect
conv1 128
conv2 256
7
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
route_split 256 256
conv2 256
conv1 256
conv2 256
connect
conv1 256
conv2 512
7
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
route_split 512 512
conv2 512
conv1 512
conv2 512
connect
conv1 512
conv2 1024
7
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
detget {'3': 2.0, '4': 2.0, '5': 2.0}
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)I0409 16:26:40.537687 140314757842752 controller.py:362] restoring or initializing model...
I0409 16:26:58.006060 140314757842752 yolo.py:464] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0409 16:26:58.008063 140314757842752 controller.py:368] initialized model.
I0409 16:26:58.008239 140314757842752 train_lib.py:96] Starts to execute mode: train_and_eval
I0409 16:26:58.013641 140314757842752 controller.py:211] train | step:      0 | training until step 20000...
I0409 16:27:06.443645 140314757842752 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0409 16:27:43.837060 140314757842752 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
cat: .experiment_zone: No such file or directory
Request issued for: [node-5]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-09T16:39:41.005138445Z'
  endTime: '2021-04-09T16:40:17.308985628Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617986380990-5bf8ccf7d8989-2a76928f-0146dc6d
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617986380990-5bf8ccf7d8989-2a76928f-0146dc6d] to complete...
...............................................................................................................................................................................................done.
europe-west4-a
I0409 16:39:46.362402 140431209658176 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.075,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.2,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 0.6,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.075,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.2,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.0,
                                                    'output_size': [640, 640],
                                                    'random_crop': True,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.001},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': 'str = "AP50"',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'str = "higher"',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine_epoch': {'alpha': 0.2,
                                                                     'decay_steps': 1875,
                                                                     'initial_learning_rate': 0.01,
                                                                     'name': 'CosineEpoch',
                                                                     'steps_per_epoch': 294375},
                                                    'type': 'cosine_epoch'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.937,
                                                        'name': 'SGD',
                                                        'nesterov': False},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5625},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 20000,
             'summary_interval': 20000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0409 16:39:46.363719 140431209658176 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/data-pipeline/all-300k/params.yaml
I0409 16:39:47.294697 140431209658176 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 16:39:47.916135 140431209658176 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0409 16:39:47.918697 140431209658176 transport.py:157] Attempting refresh to obtain initial access_token
I0409 16:39:47.975714 140431209658176 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 16:39:48.117132 140431209658176 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0409 16:39:48.117603 140431209658176 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-09 16:39:48.172767: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0409 16:39:48.173522 140431209658176 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 16:39:48.787378 140431209658176 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0409 16:39:48.787712 140431209658176 transport.py:157] Attempting refresh to obtain initial access_token
I0409 16:39:48.831878 140431209658176 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 16:39:49.450729 140431209658176 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0409 16:39:49.450971 140431209658176 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-09 16:39:49.493605: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-09 16:39:49.509316: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.56.217.90:8470}
2021-04-09 16:39:49.509405: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:58050}
2021-04-09 16:40:26.662994: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.56.217.90:8470}
2021-04-09 16:40:26.663123: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:58050}
2021-04-09 16:40:26.664034: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:58050
I0409 16:40:26.665371 140431209658176 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-5
I0409 16:40:26.666701 140431209658176 tpu_strategy_util.py:74] Initializing the TPU system: node-5
INFO:tensorflow:Clearing out eager caches
I0409 16:40:34.662562 140431209658176 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0409 16:40:34.664784 140431209658176 tpu_strategy_util.py:133] Finished initializing TPU system.
I0409 16:40:34.666329 140431209658176 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 16:40:34.811311 140431209658176 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0409 16:40:34.811617 140431209658176 transport.py:157] Attempting refresh to obtain initial access_token
I0409 16:40:34.882534 140431209658176 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 16:40:35.501989 140431209658176 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5?alt=json
I0409 16:40:35.502518 140431209658176 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0409 16:40:35.568939 140431209658176 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0409 16:40:35.569168 140431209658176 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0409 16:40:35.569414 140431209658176 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0409 16:40:35.569471 140431209658176 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0409 16:40:35.569528 140431209658176 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0409 16:40:35.569687 140431209658176 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0409 16:40:35.569761 140431209658176 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0409 16:40:35.569809 140431209658176 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0409 16:40:35.569862 140431209658176 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0409 16:40:35.569909 140431209658176 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0409 16:40:35.569954 140431209658176 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0409 16:40:35.570019 140431209658176 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0409 16:40:35.570066 140431209658176 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0409 16:40:35.570148 140431209658176 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0409 16:40:35.570195 140431209658176 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0409 16:40:35.570248 140431209658176 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0409 16:40:35.595496 140431209658176 train_utils.py:214] Running default trainer.
2021-04-09 16:40:35.611543: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.6, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.0, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'weight_decay': 0.001, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': False, 'momentum': 0.937}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine_epoch', 'cosine_epoch': {'name': 'CosineEpoch', 'initial_learning_rate': 0.01, 'decay_steps': 1875, 'steps_per_epoch': 294375, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5625}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 20000, 'summary_interval': 20000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': 'str = "AP50"', 'best_checkpoint_metric_comp': 'str = "higher"', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
{'3': 2.0, '4': 2.0, '5': 2.0} 0.0005
{'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7fb8407bd0f0>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
route_split 512.0 512.0
conv2 512.0
conv1 512.0
spp
conv1 512.0
conv2 512.0
connect
conv1 512.0
8
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
route_split 256.0 256.0
conv2 256.0
conv1 256.0
conv2 256.0
connect
conv1 256.0
6
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)








 ListWrapper([128, 256, 512])
route_split 128 128
conv2 128
conv1 128
conv2 128
connect
conv1 128
conv2 256
7
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
route_split 256 256
conv2 256
conv1 256
conv2 256
connect
conv1 256
conv2 512
7
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
route_split 512 512
conv2 512
conv1 512
conv2 512
connect
conv1 512
conv2 1024
7
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
detget {'3': 2.0, '4': 2.0, '5': 2.0}
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)I0409 16:41:24.558821 140431209658176 controller.py:362] restoring or initializing model...
I0409 16:41:33.188781 140431209658176 yolo.py:464] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0409 16:41:33.190826 140431209658176 controller.py:368] initialized model.
I0409 16:41:33.191112 140431209658176 train_lib.py:96] Starts to execute mode: train_and_eval
I0409 16:41:33.196440 140431209658176 controller.py:211] train | step:      0 | training until step 20000...
2021-04-09 16:43:01.441530: W tensorflow/core/distributed_runtime/eager/remote_tensor_handle_data.cc:76] Unable to destroy remote tensor handles. If you are running a tf.function, it usually indicates some op in the graph gets an error: 8 root error(s) found.
  (0) Invalid argument: {{function_node __inference_loop_fn_163054}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_while_body_119829_589695250183166426[] on XLA_TPU_JIT: StringFormat (No registered 'StringFormat' OpKernel for XLA_TPU_JIT devices compatible with node {{node while/body/_1/StringFormat}}){{node while/body/_1/StringFormat}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.config.set_soft_device_placement(True)`. This has a potential performance penalty.
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_7477162612290334080/_8]]
	 [[tpu_compile_succeeded_assert/_7477162612290334080/_8/_260]]
  (1) Invalid argument: {{function_node __inference_loop_fn_163054}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_while_body_119829_589695250183166426[] on XLA_TPU_JIT: StringFormat (No registered 'StringFormat' OpKernel for XLA_TPU_JIT devices compatible with node {{node while/body/_1/StringFormat}}){{node while/body/_1/StringFormat}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.config.set_soft_device_placement(True)`. This has a potential performance penalty.
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_7477162612290334080/_8]]
	 [[TPUVariableReshard/last_iteration/_16212751065579711796/_10/_100]]
  (2) Not found: {{function_node __inference_loop_fn_163054}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_15474833298357239071/_13}}]]
  (3) Invalid argument: {{function_node __inference_loop_fn_163054}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_while_body_119829_589695250183166426[] on XLA_TPU_JIT: StringFormat (No registered 'StringFormat' OpKernel for XLA_TPU_JIT devices compatible with node {{node while/body/_1/StringFormat}}){{node while/body/_1/StringFormat}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.config.set_soft_device_placement(True)`. This has a potential performance penalty.
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_7477162612290334080/_8]]
	 [[Func/while/body/_1/input/_3858/_241]]
  (4) Invalid argument: {{function_node __inference_loop_fn_163054}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_while_body_119829_589695250183166426[] on XLA_TPU_JIT: StringFormat (No registered 'StringFormat' OpKernel for XLA_TPU_JIT devices compatible with node {{node while/body/_1/StringFormat}}){{node while/body/_1/StringFormat}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.config.set_soft_device_placement(True)`. This has a potential performance penalty.
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_7477162612290334080/_8]]
	 [[Func/while/body/_1/input/_4800/_271]]
  (5) Invalid argument: {{function_node __in ... [truncated]
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 149, in main
    model_dir=model_dir)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_lib.py", line 104, in run_experiment
    eval_interval=params.trainer.validation_interval)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 303, in train_and_evaluate
    self.train(steps=num_steps, checkpoint_at_completion=False)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 215, in train
    self._train_n_steps(num_steps)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 410, in _train_n_steps
    train_output = self.trainer.train(num_steps_tensor)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/standard_runner.py", line 142, in train
    return self.train_loop_end()
  File "/home/cam2tensorflow/TensorFlowModels/official/core/base_trainer.py", line 276, in train_loop_end
    self._recovery.maybe_recover(self.train_loss.result().numpy(),
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 1071, in numpy
    maybe_arr = self._numpy()  # pylint: disable=protected-access
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 1039, in _numpy
    six.raise_from(core._status_to_exception(e.code, e.message), None)  # pylint: disable=protected-access
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: 8 root error(s) found.
  (0) Invalid argument: {{function_node __inference_loop_fn_163054}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_while_body_119829_589695250183166426[] on XLA_TPU_JIT: StringFormat (No registered 'StringFormat' OpKernel for XLA_TPU_JIT devices compatible with node {{node while/body/_1/StringFormat}}){{node while/body/_1/StringFormat}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.config.set_soft_device_placement(True)`. This has a potential performance penalty.
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_7477162612290334080/_8]]
	 [[tpu_compile_succeeded_assert/_7477162612290334080/_8/_260]]
  (1) Invalid argument: {{function_node __inference_loop_fn_163054}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_while_body_119829_589695250183166426[] on XLA_TPU_JIT: StringFormat (No registered 'StringFormat' OpKernel for XLA_TPU_JIT devices compatible with node {{node while/body/_1/StringFormat}}){{node while/body/_1/StringFormat}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.config.set_soft_device_placement(True)`. This has a potential performance penalty.
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_7477162612290334080/_8]]
	 [[TPUVariableReshard/last_iteration/_16212751065579711796/_10/_100]]
  (2) Not found: {{function_node __inference_loop_fn_163054}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_15474833298357239071/_13}}]]
  (3) Invalid argument: {{function_node __inference_loop_fn_163054}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_while_body_119829_589695250183166426[] on XLA_TPU_JIT: StringFormat (No registered 'StringFormat' OpKernel for XLA_TPU_JIT devices compatible with node {{node while/body/_1/StringFormat}}){{node while/body/_1/StringFormat}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.config.set_soft_device_placement(True)`. This has a potential performance penalty.
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_7477162612290334080/_8]]
	 [[Func/while/body/_1/input/_3858/_241]]
  (4) Invalid argument: {{function_node __inference_loop_fn_163054}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_while_body_119829_589695250183166426[] on XLA_TPU_JIT: StringFormat (No registered 'StringFormat' OpKernel for XLA_TPU_JIT devices compatible with node {{node while/body/_1/StringFormat}}){{node while/body/_1/StringFormat}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.config.set_soft_device_placement(True)`. This has a potential performance penalty.
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_7477162612290334080/_8]]
	 [[Func/while/body/_1/input/_4800/_271]]
  (5) Invalid argument: {{function_node __in ... [truncated]
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/tpu_strategy.py", line 738, in async_wait
    context.async_wait()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/context.py", line 2330, in async_wait
    context().sync_executors()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/context.py", line 645, in sync_executors
    pywrap_tfe.TFE_ContextSyncExecutors(self._context_handle)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 8 root error(s) found.
  (0) Invalid argument: {{function_node __inference_loop_fn_163054}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_while_body_119829_589695250183166426[] on XLA_TPU_JIT: StringFormat (No registered 'StringFormat' OpKernel for XLA_TPU_JIT devices compatible with node {{node while/body/_1/StringFormat}}){{node while/body/_1/StringFormat}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.config.set_soft_device_placement(True)`. This has a potential performance penalty.
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_7477162612290334080/_8]]
	 [[tpu_compile_succeeded_assert/_7477162612290334080/_8/_260]]
  (1) Invalid argument: {{function_node __inference_loop_fn_163054}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_while_body_119829_589695250183166426[] on XLA_TPU_JIT: StringFormat (No registered 'StringFormat' OpKernel for XLA_TPU_JIT devices compatible with node {{node while/body/_1/StringFormat}}){{node while/body/_1/StringFormat}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.config.set_soft_device_placement(True)`. This has a potential performance penalty.
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_7477162612290334080/_8]]
	 [[TPUVariableReshard/last_iteration/_16212751065579711796/_10/_100]]
  (2) Not found: {{function_node __inference_loop_fn_163054}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_15474833298357239071/_13}}]]
  (3) Invalid argument: {{function_node __inference_loop_fn_163054}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_while_body_119829_589695250183166426[] on XLA_TPU_JIT: StringFormat (No registered 'StringFormat' OpKernel for XLA_TPU_JIT devices compatible with node {{node while/body/_1/StringFormat}}){{node while/body/_1/StringFormat}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.config.set_soft_device_placement(True)`. This has a potential performance penalty.
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_7477162612290334080/_8]]
	 [[Func/while/body/_1/input/_3858/_241]]
  (4) Invalid argument: {{function_node __inference_loop_fn_163054}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_while_body_119829_589695250183166426[] on XLA_TPU_JIT: StringFormat (No registered 'StringFormat' OpKernel for XLA_TPU_JIT devices compatible with node {{node while/body/_1/StringFormat}}){{node while/body/_1/StringFormat}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.config.set_soft_device_placement(True)`. This has a potential performance penalty.
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_7477162612290334080/_8]]
	 [[Func/while/body/_1/input/_4800/_271]]
  (5) Invalid argument: {{function_node __in ... [truncated]

(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 80, 80, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 640, 640, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 400, 8), 5: (8, 200, 8)}, inds: {3: (8, 600, 3), 4: (8, 400, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 80, 80, 3, 1), 4: (8, 40, 40, 3, 1), 5: (8, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 640, 640, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 80, 80, 3, 1), 4: (1, 40, 40, 3, 1), 5: (1, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
2021-04-09 16:43:06.344935: W ./tensorflow/core/distributed_runtime/eager/destroy_tensor_handle_node.h:57] Ignoring an error encountered when deleting remote tensors handles: Invalid argument: Unable to find the relevant tensor remote_handle: Op ID: 41781, Output num: 0
Additional GRPC error information from remote target /job:worker/replica:0/task:0:
:{"created":"@1617986586.344794788","description":"Error received from peer ipv4:10.56.217.90:8470","file":"external/com_github_grpc_grpc/src/core/lib/surface/call.cc","file_line":1056,"grpc_message":"Unable to find the relevant tensor remote_handle: Op ID: 41781, Output num: 0","grpc_status":3}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   208    0     2  100   206     12   1287 --:--:-- --:--:-- --:--:--  1300
okRequest issued for: [node-5]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-09T16:43:46.001759933Z'
  endTime: '2021-04-09T16:44:20.922571733Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617986625989-5bf8cde17ec1c-58b9b918-fb4029d1
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.56.217.88/29
  createTime: '2021-03-18T03:04:40.452633368Z'
  health: HEALTHY
  ipAddress: 10.56.217.90
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-5
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.56.217.90
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  symptoms:
  - createTime: '2021-03-28T21:27:17.987042987Z'
    details: The TPU HBM has run OOM at timestamp 2021-03-28T21:27:13Z
    symptomType: HBM_OUT_OF_MEMORY
    workerId: '0'
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617986625989-5bf8cde17ec1c-58b9b918-fb4029d1] to complete...
..................................................................................................................................................................................................done.
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 149, in main
    model_dir=model_dir)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_lib.py", line 104, in run_experiment
    eval_interval=params.trainer.validation_interval)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 303, in train_and_evaluate
    self.train(steps=num_steps, checkpoint_at_completion=False)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 215, in train
    self._train_n_steps(num_steps)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 410, in _train_n_steps
    train_output = self.trainer.train(num_steps_tensor)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/standard_runner.py", line 142, in train
    return self.train_loop_end()
  File "/home/cam2tensorflow/TensorFlowModels/official/core/base_trainer.py", line 277, in train_loop_end
    self.global_step.numpy())
  File "/home/cam2tensorflow/TensorFlowModels/official/core/base_trainer.py", line 79, in maybe_recover
    self.recover_counter)
RuntimeError: The loss value is NaN after training loop and it happens 1 times.

(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 80, 80, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 640, 640, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 400, 8), 5: (8, 200, 8)}, inds: {3: (8, 600, 3), 4: (8, 400, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 80, 80, 3, 1), 4: (8, 40, 40, 3, 1), 5: (8, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 640, 640, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 80, 80, 3, 1), 4: (1, 40, 40, 3, 1), 5: (1, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   208    0     2  100   206     12   1256 --:--:-- --:--:-- --:--:--  1268
okRequest issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-09T18:43:54.295327003Z'
  endTime: '2021-04-09T18:44:50.593051995Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617993834278-5bf8e8bbdaf0d-d9ac440e-7a31c515
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617993834278-5bf8e8bbdaf0d-d9ac440e-7a31c515] to complete...
.........................................................................................................................................................................................................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-09T19:32:14.246104842Z'
  endTime: '2021-04-09T19:32:54.131331024Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617996734232-5bf8f389778ee-f37d3141-efe2e3e8
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1617996734232-5bf8f389778ee-f37d3141-efe2e3e8] to complete...
................................................................................................................................................................................................................................................................................done.
europe-west4-a
I0409 19:32:34.459940 139759971206976 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.075,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.2,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 0.0,
                                         'aug_rand_brightness': 0.6,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.075,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.2,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.0,
                                                    'output_size': [640, 640],
                                                    'random_crop': True,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.001},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': 'str = "AP50"',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'str = "higher"',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine_epoch': {'alpha': 0.2,
                                                                     'decay_steps': 1875,
                                                                     'initial_learning_rate': 0.01,
                                                                     'name': 'CosineEpoch',
                                                                     'steps_per_epoch': 294375},
                                                    'type': 'cosine_epoch'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.937,
                                                        'name': 'SGD',
                                                        'nesterov': False},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5625},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 20000,
             'summary_interval': 20000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0409 19:32:34.461007 139759971206976 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/data-pipeline/all-300k/params.yaml
I0409 19:32:35.358703 139759971206976 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 19:32:35.504522 139759971206976 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 19:32:35.504824 139759971206976 transport.py:157] Attempting refresh to obtain initial access_token
I0409 19:32:35.557687 139759971206976 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 19:32:36.169589 139759971206976 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 19:32:36.170103 139759971206976 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-09 19:32:36.213890: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0409 19:32:36.214644 139759971206976 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 19:32:36.828545 139759971206976 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 19:32:36.828895 139759971206976 transport.py:157] Attempting refresh to obtain initial access_token
I0409 19:32:36.880299 139759971206976 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 19:32:37.023371 139759971206976 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 19:32:37.023644 139759971206976 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-09 19:32:37.061945: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-09 19:32:37.072836: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-09 19:32:37.072917: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:60187}
2021-04-09 19:32:59.591775: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-09 19:32:59.591879: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:60187}
2021-04-09 19:32:59.592469: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:60187
I0409 19:32:59.593377 139759971206976 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-6
I0409 19:32:59.594721 139759971206976 tpu_strategy_util.py:74] Initializing the TPU system: node-6
INFO:tensorflow:Clearing out eager caches
I0409 19:33:08.227497 139759971206976 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0409 19:33:08.229567 139759971206976 tpu_strategy_util.py:133] Finished initializing TPU system.
I0409 19:33:08.231315 139759971206976 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 19:33:08.369042 139759971206976 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 19:33:08.369326 139759971206976 transport.py:157] Attempting refresh to obtain initial access_token
I0409 19:33:08.412312 139759971206976 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 19:33:09.025827 139759971206976 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 19:33:09.026099 139759971206976 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0409 19:33:09.087443 139759971206976 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0409 19:33:09.087689 139759971206976 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0409 19:33:09.088105 139759971206976 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0409 19:33:09.088174 139759971206976 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0409 19:33:09.088254 139759971206976 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0409 19:33:09.088500 139759971206976 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0409 19:33:09.088590 139759971206976 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0409 19:33:09.088694 139759971206976 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0409 19:33:09.088785 139759971206976 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0409 19:33:09.088873 139759971206976 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0409 19:33:09.088975 139759971206976 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0409 19:33:09.089062 139759971206976 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0409 19:33:09.089146 139759971206976 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0409 19:33:09.089232 139759971206976 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0409 19:33:09.089317 139759971206976 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0409 19:33:09.089401 139759971206976 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0409 19:33:09.114365 139759971206976 train_utils.py:214] Running default trainer.
2021-04-09 19:33:09.130295: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.6, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.0, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'weight_decay': 0.001, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': False, 'momentum': 0.937}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine_epoch', 'cosine_epoch': {'name': 'CosineEpoch', 'initial_learning_rate': 0.01, 'decay_steps': 1875, 'steps_per_epoch': 294375, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5625}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 20000, 'summary_interval': 20000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': 'str = "AP50"', 'best_checkpoint_metric_comp': 'str = "higher"', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.0005
{'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f1c031f7ba8>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
route_split 512.0 512.0
conv2 512.0
conv1 512.0
spp
conv1 512.0
conv2 512.0
connect
conv1 512.0
8
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
route_split 256.0 256.0
conv2 256.0
conv1 256.0
conv2 256.0
connect
conv1 256.0
6
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)








 ListWrapper([128, 256, 512])
route_split 128 128
conv2 128
conv1 128
conv2 128
connect
conv1 128
conv2 256
7
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
route_split 256 256
conv2 256
conv1 256
conv2 256
connect
conv1 256
conv2 512
7
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
route_split 512 512
conv2 512
conv1 512
conv2 512
connect
conv1 512
conv2 1024
7
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
detget {'3': 2.0, '4': 2.0, '5': 2.0}
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)I0409 19:33:57.552949 139759971206976 controller.py:362] restoring or initializing model...
I0409 19:34:07.119375 139759971206976 yolo.py:483] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0409 19:34:07.122307 139759971206976 controller.py:368] initialized model.
I0409 19:34:07.122766 139759971206976 train_lib.py:96] Starts to execute mode: train_and_eval
I0409 19:34:07.128466 139759971206976 controller.py:211] train | step:      0 | training until step 20000...
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 149, in main
    model_dir=model_dir)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_lib.py", line 104, in run_experiment
    eval_interval=params.trainer.validation_interval)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 303, in train_and_evaluate
    self.train(steps=num_steps, checkpoint_at_completion=False)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 215, in train
    self._train_n_steps(num_steps)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 410, in _train_n_steps
    train_output = self.trainer.train(num_steps_tensor)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/standard_runner.py", line 142, in train
    return self.train_loop_end()
  File "/home/cam2tensorflow/TensorFlowModels/official/core/base_trainer.py", line 277, in train_loop_end
    self.global_step.numpy())
  File "/home/cam2tensorflow/TensorFlowModels/official/core/base_trainer.py", line 79, in maybe_recover
    self.recover_counter)
RuntimeError: The loss value is NaN after training loop and it happens 1 times.

(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 80, 80, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 640, 640, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 400, 8), 5: (8, 200, 8)}, inds: {3: (8, 600, 3), 4: (8, 400, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 80, 80, 3, 1), 4: (8, 40, 40, 3, 1), 5: (8, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 640, 640, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 80, 80, 3, 1), 4: (1, 40, 40, 3, 1), 5: (1, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   208    0     2  100   206     12   1248 --:--:-- --:--:-- --:--:--  1260
okRequest issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-09T21:53:18.321025789Z'
  endTime: '2021-04-09T21:54:12.806485080Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618005198306-5bf913116fd57-113c8740-5c464454
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618005198306-5bf913116fd57-113c8740-5c464454] to complete...
..........................................................................................................................................................................................................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-09T21:57:56.236297416Z'
  endTime: '2021-04-09T21:58:32.338131749Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618005476221-5bf9141a7a228-3f28533a-dae031ee
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618005476221-5bf9141a7a228-3f28533a-dae031ee] to complete...
.................................................................................................................................................................................................done.
europe-west4-a
I0409 21:58:00.054049 140103803144000 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.075,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.2,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 0.6,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.05,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.2,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.667,
                                                    'output_size': [640, 640],
                                                    'random_crop': True,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.001},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': 'str = "AP50"',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'str = "higher"',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine_epoch': {'alpha': 0.2,
                                                                     'decay_steps': 294375,
                                                                     'initial_learning_rate': 0.01,
                                                                     'name': 'CosineEpoch',
                                                                     'steps_per_epoch': 1875},
                                                    'type': 'cosine_epoch'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.937,
                                                        'name': 'SGD',
                                                        'nesterov': False},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5625},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 20000,
             'summary_interval': 20000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0409 21:58:00.055250 140103803144000 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/data-pipeline/all-300k/params.yaml
I0409 21:58:01.010473 140103803144000 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 21:58:01.156445 140103803144000 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 21:58:01.156710 140103803144000 transport.py:157] Attempting refresh to obtain initial access_token
I0409 21:58:01.207579 140103803144000 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 21:58:01.354189 140103803144000 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 21:58:01.354493 140103803144000 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-09 21:58:01.395901: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0409 21:58:01.396534 140103803144000 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 21:58:02.018837 140103803144000 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 21:58:02.019210 140103803144000 transport.py:157] Attempting refresh to obtain initial access_token
I0409 21:58:02.078294 140103803144000 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 21:58:02.692106 140103803144000 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 21:58:02.692398 140103803144000 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-09 21:58:02.746108: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-09 21:58:02.756659: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-09 21:58:02.756808: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:61982}
2021-04-09 21:58:44.644183: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-09 21:58:44.644375: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:61982}
2021-04-09 21:58:44.645018: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:61982
I0409 21:58:44.645667 140103803144000 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-6
I0409 21:58:44.646254 140103803144000 tpu_strategy_util.py:74] Initializing the TPU system: node-6
INFO:tensorflow:Clearing out eager caches
I0409 21:58:52.893512 140103803144000 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0409 21:58:52.895549 140103803144000 tpu_strategy_util.py:133] Finished initializing TPU system.
I0409 21:58:52.897062 140103803144000 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 21:58:53.515688 140103803144000 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 21:58:53.515984 140103803144000 transport.py:157] Attempting refresh to obtain initial access_token
I0409 21:58:53.584524 140103803144000 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 21:58:53.726604 140103803144000 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 21:58:53.726893 140103803144000 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0409 21:58:53.778117 140103803144000 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0409 21:58:53.778419 140103803144000 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0409 21:58:53.778850 140103803144000 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0409 21:58:53.778972 140103803144000 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0409 21:58:53.779070 140103803144000 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0409 21:58:53.779349 140103803144000 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0409 21:58:53.779459 140103803144000 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0409 21:58:53.779554 140103803144000 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0409 21:58:53.779645 140103803144000 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0409 21:58:53.779731 140103803144000 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0409 21:58:53.779818 140103803144000 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0409 21:58:53.779937 140103803144000 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0409 21:58:53.780033 140103803144000 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0409 21:58:53.780128 140103803144000 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0409 21:58:53.780237 140103803144000 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0409 21:58:53.780332 140103803144000 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0409 21:58:53.805662 140103803144000 train_utils.py:214] Running default trainer.
2021-04-09 21:58:53.821739: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.05, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.6, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.667, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'weight_decay': 0.001, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': False, 'momentum': 0.937}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine_epoch', 'cosine_epoch': {'name': 'CosineEpoch', 'initial_learning_rate': 0.01, 'decay_steps': 294375, 'steps_per_epoch': 1875, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5625}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 20000, 'summary_interval': 20000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': 'str = "AP50"', 'best_checkpoint_metric_comp': 'str = "higher"', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.0005
{'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f6c11269a58>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
route_split 512.0 512.0
conv2 512.0
conv1 512.0
spp
conv1 512.0
conv2 512.0
connect
conv1 512.0
8
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
route_split 256.0 256.0
conv2 256.0
conv1 256.0
conv2 256.0
connect
conv1 256.0
6
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)








 ListWrapper([128, 256, 512])
route_split 128 128
conv2 128
conv1 128
conv2 128
connect
conv1 128
conv2 256
7
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
route_split 256 256
conv2 256
conv1 256
conv2 256
connect
conv1 256
conv2 512
7
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
route_split 512 512
conv2 512
conv1 512
conv2 512
connect
conv1 512
conv2 1024
7
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
detget {'3': 2.0, '4': 2.0, '5': 2.0}
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)I0409 21:59:51.835292 140103803144000 controller.py:362] restoring or initializing model...
I0409 22:00:04.348547 140103803144000 yolo.py:483] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0409 22:00:04.350770 140103803144000 controller.py:368] initialized model.
I0409 22:00:04.351028 140103803144000 train_lib.py:96] Starts to execute mode: train_and_eval
I0409 22:00:04.356082 140103803144000 controller.py:211] train | step:      0 | training until step 20000...
2021-04-09 22:01:36.091949: W tensorflow/core/distributed_runtime/eager/remote_tensor_handle_data.cc:76] Unable to destroy remote tensor handles. If you are running a tf.function, it usually indicates some op in the graph gets an error: 9 root error(s) found.
  (0) Not found: {{function_node __inference_loop_fn_163066}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_7961535135278185579/_34}}]]
  (1) Not found: {{function_node __inference_loop_fn_163066}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_10622781335309843385/_19}}]]
  (2) Not found: {{function_node __inference_loop_fn_163066}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_6975786205838135334/_31}}]]
  (3) Not found: {{function_node __inference_loop_fn_163066}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_7411254073827214366/_28}}]]
  (4) Invalid argument: {{function_node __inference_loop_fn_163066}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_while_body_119835_3788022202857387918[] on XLA_TPU_JIT: StringFormat (No registered 'StringFormat' OpKernel for XLA_TPU_JIT devices compatible with node {{node while/body/_1/StringFormat}}){{node while/body/_1/StringFormat}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.config.set_soft_device_placement(True)`. This has a potential performance penalty.
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_2202422591895165929/_8]]
	 [[Func/while/body/_1/input/_3853/_223]]
  (5) Not found: {{function_node __inference_loop_fn_163066}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_4449349328238238105/_16}}]]
  (6) Not found: {{function_node __inference_loop_fn_163066}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_5634133712116816481/_13}}]]
  (7) Invalid argument: {{function_node __inference_loop_fn_163066}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_while_body_119835_3788022202857387918[] on XLA_TPU_JIT: StringFormat (No registered 'StringFormat' OpKernel for XLA_TPU_JIT devices compatible with node {{node while/body/_1/StringFormat}}){{node while/body/_1/StringFormat}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.config.set_soft_device_placement(True)`. This has a potential performance penalty.
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_2202422591895165929/_8]]
  (8) Not found: {{function_node __inference_loop_fn_163066}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_4746628214766250257/_25}}]]
0 successful operations.
0 derived errors ignored.
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 149, in main
    model_dir=model_dir)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_lib.py", line 104, in run_experiment
    eval_interval=params.trainer.validation_interval)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 303, in train_and_evaluate
    self.train(steps=num_steps, checkpoint_at_completion=False)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 215, in train
    self._train_n_steps(num_steps)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 410, in _train_n_steps
    train_output = self.trainer.train(num_steps_tensor)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/standard_runner.py", line 142, in train
    return self.train_loop_end()
  File "/home/cam2tensorflow/TensorFlowModels/official/core/base_trainer.py", line 276, in train_loop_end
    self._recovery.maybe_recover(self.train_loss.result().numpy(),
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 1071, in numpy
    maybe_arr = self._numpy()  # pylint: disable=protected-access
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 1039, in _numpy
    six.raise_from(core._status_to_exception(e.code, e.message), None)  # pylint: disable=protected-access
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.NotFoundError: 9 root error(s) found.
  (0) Not found: {{function_node __inference_loop_fn_163066}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_7961535135278185579/_34}}]]
  (1) Not found: {{function_node __inference_loop_fn_163066}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_10622781335309843385/_19}}]]
  (2) Not found: {{function_node __inference_loop_fn_163066}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_6975786205838135334/_31}}]]
  (3) Not found: {{function_node __inference_loop_fn_163066}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_7411254073827214366/_28}}]]
  (4) Invalid argument: {{function_node __inference_loop_fn_163066}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_while_body_119835_3788022202857387918[] on XLA_TPU_JIT: StringFormat (No registered 'StringFormat' OpKernel for XLA_TPU_JIT devices compatible with node {{node while/body/_1/StringFormat}}){{node while/body/_1/StringFormat}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.config.set_soft_device_placement(True)`. This has a potential performance penalty.
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_2202422591895165929/_8]]
	 [[Func/while/body/_1/input/_3853/_223]]
  (5) Not found: {{function_node __inference_loop_fn_163066}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_4449349328238238105/_16}}]]
  (6) Not found: {{function_node __inference_loop_fn_163066}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_5634133712116816481/_13}}]]
  (7) Invalid argument: {{function_node __inference_loop_fn_163066}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_while_body_119835_3788022202857387918[] on XLA_TPU_JIT: StringFormat (No registered 'StringFormat' OpKernel for XLA_TPU_JIT devices compatible with node {{node while/body/_1/StringFormat}}){{node while/body/_1/StringFormat}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.config.set_soft_device_placement(True)`. This has a potential performance penalty.
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_2202422591895165929/_8]]
  (8) Not found: {{function_node __inference_loop_fn_163066}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_4746628214766250257/_25}}]]
0 successful operations.
0 derived errors ignored.
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/tpu_strategy.py", line 738, in async_wait
    context.async_wait()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/context.py", line 2330, in async_wait
    context().sync_executors()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/context.py", line 645, in sync_executors
    pywrap_tfe.TFE_ContextSyncExecutors(self._context_handle)
tensorflow.python.framework.errors_impl.NotFoundError: 9 root error(s) found.
  (0) Not found: {{function_node __inference_loop_fn_163066}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_7961535135278185579/_34}}]]
  (1) Not found: {{function_node __inference_loop_fn_163066}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_10622781335309843385/_19}}]]
  (2) Not found: {{function_node __inference_loop_fn_163066}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_6975786205838135334/_31}}]]
  (3) Not found: {{function_node __inference_loop_fn_163066}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_7411254073827214366/_28}}]]
  (4) Invalid argument: {{function_node __inference_loop_fn_163066}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_while_body_119835_3788022202857387918[] on XLA_TPU_JIT: StringFormat (No registered 'StringFormat' OpKernel for XLA_TPU_JIT devices compatible with node {{node while/body/_1/StringFormat}}){{node while/body/_1/StringFormat}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.config.set_soft_device_placement(True)`. This has a potential performance penalty.
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_2202422591895165929/_8]]
	 [[Func/while/body/_1/input/_3853/_223]]
  (5) Not found: {{function_node __inference_loop_fn_163066}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_4449349328238238105/_16}}]]
  (6) Not found: {{function_node __inference_loop_fn_163066}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_5634133712116816481/_13}}]]
  (7) Invalid argument: {{function_node __inference_loop_fn_163066}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_while_body_119835_3788022202857387918[] on XLA_TPU_JIT: StringFormat (No registered 'StringFormat' OpKernel for XLA_TPU_JIT devices compatible with node {{node while/body/_1/StringFormat}}){{node while/body/_1/StringFormat}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.config.set_soft_device_placement(True)`. This has a potential performance penalty.
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_2202422591895165929/_8]]
  (8) Not found: {{function_node __inference_loop_fn_163066}} No proto found for key <<NO PROGRAM AS COMPILATION FAILED>>
	 [[{{node TPUVariableReshard/reshard/_4746628214766250257/_25}}]]
0 successful operations.
0 derived errors ignored.

(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 80, 80, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 640, 640, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 400, 8), 5: (8, 200, 8)}, inds: {3: (8, 600, 3), 4: (8, 400, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 80, 80, 3, 1), 4: (8, 40, 40, 3, 1), 5: (8, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 640, 640, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 80, 80, 3, 1), 4: (1, 40, 40, 3, 1), 5: (1, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
2021-04-09 22:01:40.984925: W ./tensorflow/core/distributed_runtime/eager/destroy_tensor_handle_node.h:57] Ignoring an error encountered when deleting remote tensors handles: Invalid argument: Unable to find the relevant tensor remote_handle: Op ID: 41782, Output num: 0
Additional GRPC error information from remote target /job:worker/replica:0/task:0:
:{"created":"@1618005700.984719242","description":"Error received from peer ipv4:10.77.141.42:8470","file":"external/com_github_grpc_grpc/src/core/lib/surface/call.cc","file_line":1056,"grpc_message":"Unable to find the relevant tensor remote_handle: Op ID: 41782, Output num: 0","grpc_status":3}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   208    0     2  100   206     11   1218 --:--:-- --:--:-- --:--:--  1230
okRequest issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-09T22:02:22.712127467Z'
  endTime: '2021-04-09T22:02:59.963536485Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618005742698-5bf915189bee3-5a4584e1-54280e45
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618005742698-5bf915189bee3-5a4584e1-54280e45] to complete...
................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-09T22:03:49.240983854Z'
  endTime: '2021-04-09T22:04:24.364329677Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618005829229-5bf9156b21b3d-6ada2152-cdf91f86
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618005829229-5bf9156b21b3d-6ada2152-cdf91f86] to complete...
................................................................................................................................................................................................done.
europe-west4-a
I0409 22:03:53.039248 139745890150208 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.075,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.2,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 0.6,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.05,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.2,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.667,
                                                    'output_size': [640, 640],
                                                    'random_crop': True,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.001},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': 'str = "AP50"',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'str = "higher"',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine_epoch': {'alpha': 0.2,
                                                                     'decay_steps': 294375,
                                                                     'initial_learning_rate': 0.01,
                                                                     'name': 'CosineEpoch',
                                                                     'steps_per_epoch': 1875},
                                                    'type': 'cosine_epoch'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.937,
                                                        'name': 'SGD',
                                                        'nesterov': False},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5625},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 20000,
             'summary_interval': 2000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0409 22:03:53.040430 139745890150208 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/data-pipeline/all-300k/params.yaml
I0409 22:03:53.862177 139745890150208 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 22:03:54.484536 139745890150208 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 22:03:54.485038 139745890150208 transport.py:157] Attempting refresh to obtain initial access_token
I0409 22:03:54.542995 139745890150208 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 22:03:54.685364 139745890150208 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 22:03:54.685684 139745890150208 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-09 22:03:54.743656: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0409 22:03:54.744492 139745890150208 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 22:03:55.358178 139745890150208 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 22:03:55.358427 139745890150208 transport.py:157] Attempting refresh to obtain initial access_token
I0409 22:03:55.420356 139745890150208 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 22:03:56.035538 139745890150208 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 22:03:56.035927 139745890150208 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-09 22:03:56.084895: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-09 22:03:56.097122: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-09 22:03:56.097208: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:62202}
2021-04-09 22:04:30.341525: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-09 22:04:30.341617: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:62202}
2021-04-09 22:04:30.342245: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:62202
I0409 22:04:30.343178 139745890150208 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-6
I0409 22:04:30.343749 139745890150208 tpu_strategy_util.py:74] Initializing the TPU system: node-6
INFO:tensorflow:Clearing out eager caches
I0409 22:04:38.849337 139745890150208 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0409 22:04:38.851648 139745890150208 tpu_strategy_util.py:133] Finished initializing TPU system.
I0409 22:04:38.853167 139745890150208 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 22:04:39.002341 139745890150208 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 22:04:39.002779 139745890150208 transport.py:157] Attempting refresh to obtain initial access_token
I0409 22:04:39.055798 139745890150208 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 22:04:39.198996 139745890150208 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 22:04:39.199262 139745890150208 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0409 22:04:39.252482 139745890150208 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0409 22:04:39.253008 139745890150208 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0409 22:04:39.253329 139745890150208 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0409 22:04:39.253430 139745890150208 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0409 22:04:39.253490 139745890150208 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0409 22:04:39.253664 139745890150208 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0409 22:04:39.253725 139745890150208 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0409 22:04:39.253771 139745890150208 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0409 22:04:39.253818 139745890150208 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0409 22:04:39.253862 139745890150208 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0409 22:04:39.253944 139745890150208 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0409 22:04:39.253990 139745890150208 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0409 22:04:39.254035 139745890150208 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0409 22:04:39.254105 139745890150208 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0409 22:04:39.254151 139745890150208 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0409 22:04:39.254197 139745890150208 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0409 22:04:39.285504 139745890150208 train_utils.py:214] Running default trainer.
2021-04-09 22:04:39.296855: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.05, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.6, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.667, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'weight_decay': 0.001, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': False, 'momentum': 0.937}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine_epoch', 'cosine_epoch': {'name': 'CosineEpoch', 'initial_learning_rate': 0.01, 'decay_steps': 294375, 'steps_per_epoch': 1875, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5625}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 20000, 'summary_interval': 2000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': 'str = "AP50"', 'best_checkpoint_metric_comp': 'str = "higher"', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.0005
{'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f18bbe5b748>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
route_split 512.0 512.0
conv2 512.0
conv1 512.0
spp
conv1 512.0
conv2 512.0
connect
conv1 512.0
8
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
route_split 256.0 256.0
conv2 256.0
conv1 256.0
conv2 256.0
connect
conv1 256.0
6
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)








 ListWrapper([128, 256, 512])
route_split 128 128
conv2 128
conv1 128
conv2 128
connect
conv1 128
conv2 256
7
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
route_split 256 256
conv2 256
conv1 256
conv2 256
connect
conv1 256
conv2 512
7
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
route_split 512 512
conv2 512
conv1 512
conv2 512
connect
conv1 512
conv2 1024
7
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
detget {'3': 2.0, '4': 2.0, '5': 2.0}
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 149, in main
    model_dir=model_dir)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_lib.py", line 94, in run_experiment
    (save_summary and model_dir != None) else None)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 155, in __init__
    f"`summary interval` ({summary_interval}) must be a multiple "
ValueError: `summary interval` (2000) must be a multiple of `steps_per_loop` (20000).

(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 80, 80, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 640, 640, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 400, 8), 5: (8, 200, 8)}, inds: {3: (8, 600, 3), 4: (8, 400, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 80, 80, 3, 1), 4: (8, 40, 40, 3, 1), 5: (8, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 640, 640, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 80, 80, 3, 1), 4: (1, 40, 40, 3, 1), 5: (1, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   208    0     2  100   206     11   1163 --:--:-- --:--:-- --:--:--  1175
okRequest issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-09T22:06:13.560863647Z'
  endTime: '2021-04-09T22:07:00.716423Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618005973549-5bf915f4c424b-ca71f44a-28cda84e
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618005973549-5bf915f4c424b-ca71f44a-28cda84e] to complete...
....................................................................................................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-09T22:10:34.422961813Z'
  endTime: '2021-04-09T22:11:07.421422111Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618006234408-5bf916ed8a4a1-509f047e-9f416831
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618006234408-5bf916ed8a4a1-509f047e-9f416831] to complete...
...............................................................................................................................................................................................done.
europe-west4-a
I0409 22:10:37.766031 140317938087744 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.075,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.2,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 0.6,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.05,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.2,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.667,
                                                    'output_size': [640, 640],
                                                    'random_crop': True,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.001},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': 'str = "AP50"',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'str = "higher"',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine_epoch': {'alpha': 0.2,
                                                                     'decay_steps': 294375,
                                                                     'initial_learning_rate': 0.01,
                                                                     'name': 'CosineEpoch',
                                                                     'steps_per_epoch': 1875},
                                                    'type': 'cosine_epoch'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.937,
                                                        'name': 'SGD',
                                                        'nesterov': False},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5625},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 1000,
             'summary_interval': 1000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0409 22:10:37.766896 140317938087744 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/data-pipeline/all-300k/params.yaml
I0409 22:10:38.550564 140317938087744 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 22:10:39.166467 140317938087744 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 22:10:39.166877 140317938087744 transport.py:157] Attempting refresh to obtain initial access_token
I0409 22:10:39.221389 140317938087744 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 22:10:39.371073 140317938087744 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 22:10:39.371319 140317938087744 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-09 22:10:39.418737: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0409 22:10:39.419492 140317938087744 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 22:10:40.031611 140317938087744 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 22:10:40.031893 140317938087744 transport.py:157] Attempting refresh to obtain initial access_token
I0409 22:10:40.076128 140317938087744 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 22:10:40.693181 140317938087744 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 22:10:40.693425 140317938087744 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-09 22:10:40.743603: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-09 22:10:40.754197: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-09 22:10:40.754271: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:62430}
2021-04-09 22:11:19.497906: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-09 22:11:19.498162: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:62430}
2021-04-09 22:11:19.498705: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:62430
I0409 22:11:19.500852 140317938087744 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-6
I0409 22:11:19.502055 140317938087744 tpu_strategy_util.py:74] Initializing the TPU system: node-6
INFO:tensorflow:Clearing out eager caches
I0409 22:11:28.066189 140317938087744 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0409 22:11:28.068528 140317938087744 tpu_strategy_util.py:133] Finished initializing TPU system.
I0409 22:11:28.070066 140317938087744 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 22:11:28.688110 140317938087744 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 22:11:28.688380 140317938087744 transport.py:157] Attempting refresh to obtain initial access_token
I0409 22:11:28.788190 140317938087744 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 22:11:29.401161 140317938087744 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 22:11:29.401401 140317938087744 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0409 22:11:29.455086 140317938087744 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0409 22:11:29.455349 140317938087744 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0409 22:11:29.455622 140317938087744 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0409 22:11:29.455674 140317938087744 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0409 22:11:29.455722 140317938087744 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0409 22:11:29.455870 140317938087744 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0409 22:11:29.455969 140317938087744 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0409 22:11:29.456030 140317938087744 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0409 22:11:29.456076 140317938087744 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0409 22:11:29.456120 140317938087744 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0409 22:11:29.456164 140317938087744 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0409 22:11:29.456206 140317938087744 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0409 22:11:29.456264 140317938087744 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0409 22:11:29.456308 140317938087744 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0409 22:11:29.456351 140317938087744 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0409 22:11:29.456394 140317938087744 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0409 22:11:29.482301 140317938087744 train_utils.py:214] Running default trainer.
2021-04-09 22:11:29.498144: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.05, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.6, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.667, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'weight_decay': 0.001, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': False, 'momentum': 0.937}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine_epoch', 'cosine_epoch': {'name': 'CosineEpoch', 'initial_learning_rate': 0.01, 'decay_steps': 294375, 'steps_per_epoch': 1875, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5625}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 1000, 'summary_interval': 1000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': 'str = "AP50"', 'best_checkpoint_metric_comp': 'str = "higher"', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.0005
{'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7f9dec986ac8>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
route_split 512.0 512.0
conv2 512.0
conv1 512.0
spp
conv1 512.0
conv2 512.0
connect
conv1 512.0
8
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
route_split 256.0 256.0
conv2 256.0
conv1 256.0
conv2 256.0
connect
conv1 256.0
6
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)








 ListWrapper([128, 256, 512])
route_split 128 128
conv2 128
conv1 128
conv2 128
connect
conv1 128
conv2 256
7
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
route_split 256 256
conv2 256
conv1 256
conv2 256
connect
conv1 256
conv2 512
7
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
route_split 512 512
conv2 512
conv1 512
conv2 512
connect
conv1 512
conv2 1024
7
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
detget {'3': 2.0, '4': 2.0, '5': 2.0}
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)I0409 22:12:18.604232 140317938087744 controller.py:362] restoring or initializing model...
I0409 22:12:27.019408 140317938087744 yolo.py:483] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0409 22:12:27.020825 140317938087744 controller.py:368] initialized model.
I0409 22:12:27.021000 140317938087744 train_lib.py:96] Starts to execute mode: train_and_eval
I0409 22:12:27.025899 140317938087744 controller.py:211] train | step:      0 | training until step 20000...
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 149, in main
    model_dir=model_dir)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_lib.py", line 104, in run_experiment
    eval_interval=params.trainer.validation_interval)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 303, in train_and_evaluate
    self.train(steps=num_steps, checkpoint_at_completion=False)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 215, in train
    self._train_n_steps(num_steps)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 410, in _train_n_steps
    train_output = self.trainer.train(num_steps_tensor)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/standard_runner.py", line 142, in train
    return self.train_loop_end()
  File "/home/cam2tensorflow/TensorFlowModels/official/core/base_trainer.py", line 280, in train_loop_end
    logs[metric.name] = metric.result()
AttributeError: 'ListWrapper' object has no attribute 'result'

(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 80, 80, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 640, 640, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 400, 8), 5: (8, 200, 8)}, inds: {3: (8, 600, 3), 4: (8, 400, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 80, 80, 3, 1), 4: (8, 40, 40, 3, 1), 5: (8, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 640, 640, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 80, 80, 3, 1), 4: (1, 40, 40, 3, 1), 5: (1, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   208    0     2  100   206     10   1107 --:--:-- --:--:-- --:--:--  1118
okRequest issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-09T22:25:36.538546955Z'
  endTime: '2021-04-09T22:26:11.938834354Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618007136523-5bf91a49dd631-149d7a60-2e81b2e8
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618007136523-5bf91a49dd631-149d7a60-2e81b2e8] to complete...
..................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-09T23:10:04.685732702Z'
  endTime: '2021-04-09T23:10:37.291760585Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618009804673-5bf9243a691ae-f69e65ca-5390b143
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618009804673-5bf9243a691ae-f69e65ca-5390b143] to complete...
.................................................................................................................................................................................................done.
europe-west4-a
I0409 23:10:08.487809 140367351805760 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.075,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.2,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 0.6,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.05,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.2,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.667,
                                                    'output_size': [640, 640],
                                                    'random_crop': True,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.001},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': 'str = "AP50"',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'str = "higher"',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine_epoch': {'alpha': 0.2,
                                                                     'decay_steps': 294375,
                                                                     'initial_learning_rate': 0.01,
                                                                     'name': 'CosineEpoch',
                                                                     'steps_per_epoch': 1875},
                                                    'type': 'cosine_epoch'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.937,
                                                        'name': 'SGD',
                                                        'nesterov': False},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5625},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0409 23:10:08.488677 140367351805760 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/data-pipeline/all-300k/params.yaml
I0409 23:10:09.485080 140367351805760 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 23:10:10.103498 140367351805760 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 23:10:10.103820 140367351805760 transport.py:157] Attempting refresh to obtain initial access_token
I0409 23:10:10.166899 140367351805760 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 23:10:10.782896 140367351805760 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 23:10:10.783285 140367351805760 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-09 23:10:10.835987: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0409 23:10:10.836944 140367351805760 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 23:10:11.456162 140367351805760 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 23:10:11.456487 140367351805760 transport.py:157] Attempting refresh to obtain initial access_token
I0409 23:10:11.511134 140367351805760 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 23:10:11.655582 140367351805760 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 23:10:11.655912 140367351805760 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-09 23:10:11.700449: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-09 23:10:11.724997: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-09 23:10:11.725077: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:30849}
2021-04-09 23:10:47.700800: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-09 23:10:47.700889: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:30849}
2021-04-09 23:10:47.701926: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:30849
I0409 23:10:47.702730 140367351805760 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-6
I0409 23:10:47.703882 140367351805760 tpu_strategy_util.py:74] Initializing the TPU system: node-6
INFO:tensorflow:Clearing out eager caches
I0409 23:10:56.071669 140367351805760 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0409 23:10:56.073845 140367351805760 tpu_strategy_util.py:133] Finished initializing TPU system.
I0409 23:10:56.075240 140367351805760 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 23:10:56.692187 140367351805760 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 23:10:56.692483 140367351805760 transport.py:157] Attempting refresh to obtain initial access_token
I0409 23:10:56.752301 140367351805760 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0409 23:10:56.891801 140367351805760 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0409 23:10:56.892117 140367351805760 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0409 23:10:56.939608 140367351805760 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0409 23:10:56.940114 140367351805760 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0409 23:10:56.940518 140367351805760 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0409 23:10:56.940620 140367351805760 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0409 23:10:56.940689 140367351805760 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0409 23:10:56.940876 140367351805760 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0409 23:10:56.940928 140367351805760 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0409 23:10:56.940974 140367351805760 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0409 23:10:56.941018 140367351805760 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0409 23:10:56.941062 140367351805760 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0409 23:10:56.941107 140367351805760 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0409 23:10:56.941149 140367351805760 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0409 23:10:56.941193 140367351805760 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0409 23:10:56.941234 140367351805760 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0409 23:10:56.941275 140367351805760 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0409 23:10:56.941318 140367351805760 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0409 23:10:56.967026 140367351805760 train_utils.py:214] Running default trainer.
2021-04-09 23:10:56.983437: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.05, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.6, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.667, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'weight_decay': 0.001, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': False, 'momentum': 0.937}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine_epoch', 'cosine_epoch': {'name': 'CosineEpoch', 'initial_learning_rate': 0.01, 'decay_steps': 294375, 'steps_per_epoch': 1875, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5625}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': 'str = "AP50"', 'best_checkpoint_metric_comp': 'str = "higher"', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.0005
{'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7fa96dd66a90>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
route_split 512.0 512.0
conv2 512.0
conv1 512.0
spp
conv1 512.0
conv2 512.0
connect
conv1 512.0
8
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
route_split 256.0 256.0
conv2 256.0
conv1 256.0
conv2 256.0
connect
conv1 256.0
6
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)








 ListWrapper([128, 256, 512])
route_split 128 128
conv2 128
conv1 128
conv2 128
connect
conv1 128
conv2 256
7
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
route_split 256 256
conv2 256
conv1 256
conv2 256
connect
conv1 256
conv2 512
7
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
route_split 512 512
conv2 512
conv1 512
conv2 512
connect
conv1 512
conv2 1024
7
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
detget {'3': 2.0, '4': 2.0, '5': 2.0}
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)I0409 23:11:47.121854 140367351805760 controller.py:362] restoring or initializing model...
I0409 23:11:55.409862 140367351805760 yolo.py:550] Finished loading pretrained checkpoint from gs://tensorflow2/darknet/cspdarknet53-golden/ckpt-15000
I0409 23:11:55.412042 140367351805760 controller.py:368] initialized model.
I0409 23:11:55.412269 140367351805760 train_lib.py:96] Starts to execute mode: train_and_eval
I0409 23:11:55.417540 140367351805760 controller.py:211] train | step:      0 | training until step 20000...
I0409 23:48:40.644727 140367351805760 controller.py:425] train | step:   5000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.42362085,
           'avg_obj': 0.08197781,
           'box_loss': 0.021869903,
           'class_loss': 0.09976372,
           'conf_loss': 0.32743132,
           'precision50': 0.016064746,
           'recall50': 0.02936858},
     '4': {'avg_iou': 0.468787,
           'avg_obj': 0.11647123,
           'box_loss': 0.023962481,
           'class_loss': 0.11160391,
           'conf_loss': 0.102886476,
           'precision50': 0.090561986,
           'recall50': 0.038624063},
     '5': {'avg_iou': 0.49130282,
           'avg_obj': 0.18218143,
           'box_loss': 0.024872143,
           'class_loss': 0.11001899,
           'conf_loss': 0.0646579,
           'precision50': 0.2183571,
           'recall50': 0.09607996},
     'global': {'total_loss': 7.0965514},
     'learning_rate': 0.006238453,
     'training_loss': 7.0965514}
I0409 23:49:33.996052 140367351805760 controller.py:455] saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-5000.
I0410 00:21:17.711514 140367351805760 controller.py:425] train | step:  10000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.5542558,
           'avg_obj': 0.08217053,
           'box_loss': 0.01648735,
           'class_loss': 0.01212795,
           'conf_loss': 0.014980209,
           'precision50': 0.13866419,
           'recall50': 0.016163833},
     '4': {'avg_iou': 0.620692,
           'avg_obj': 0.15255061,
           'box_loss': 0.016702615,
           'class_loss': 0.012889244,
           'conf_loss': 0.018955026,
           'precision50': 0.38969037,
           'recall50': 0.06600329},
     '5': {'avg_iou': 0.6621737,
           'avg_obj': 0.23890041,
           'box_loss': 0.016242873,
           'class_loss': 0.012181924,
           'conf_loss': 0.019073278,
           'precision50': 0.5805036,
           'recall50': 0.15986763},
     'global': {'total_loss': 1.1171224},
     'learning_rate': 0.009979997,
     'training_loss': 1.1171224}
I0410 00:53:39.465262 140367351805760 controller.py:425] train | step:  15000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.5902558,
           'avg_obj': 0.114977024,
           'box_loss': 0.015140523,
           'class_loss': 0.009265479,
           'conf_loss': 0.014386952,
           'precision50': 0.22152652,
           'recall50': 0.035069738},
     '4': {'avg_iou': 0.66999066,
           'avg_obj': 0.20510654,
           'box_loss': 0.01441091,
           'class_loss': 0.009477445,
           'conf_loss': 0.018140586,
           'precision50': 0.50450575,
           'recall50': 0.12316045},
     '5': {'avg_iou': 0.7205877,
           'avg_obj': 0.30886877,
           'box_loss': 0.01327097,
           'class_loss': 0.008985645,
           'conf_loss': 0.018150145,
           'precision50': 0.67870104,
           'recall50': 0.26760706},
     'global': {'total_loss': 0.9698287},
     'learning_rate': 0.009948857,
     'training_loss': 0.9698287}

(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 80, 80, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 640, 640, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 400, 8), 5: (8, 200, 8)}, inds: {3: (8, 600, 3), 4: (8, 400, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 80, 80, 3, 1), 4: (8, 40, 40, 3, 1), 5: (8, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 640, 640, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 80, 80, 3, 1), 4: (1, 40, 40, 3, 1), 5: (1, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
initialized model.
train | step:      0 | training until step 20000...
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
train | step:   5000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.42362085,
           'avg_obj': 0.08197781,
           'box_loss': 0.021869903,
           'class_loss': 0.09976372,
           'conf_loss': 0.32743132,
           'precision50': 0.016064746,
           'recall50': 0.02936858},
     '4': {'avg_iou': 0.468787,
           'avg_obj': 0.11647123,
           'box_loss': 0.023962481,
           'class_loss': 0.11160391,
           'conf_loss': 0.102886476,
           'precision50': 0.090561986,
           'recall50': 0.038624063},
     '5': {'avg_iou': 0.49130282,
           'avg_obj': 0.18218143,
           'box_loss': 0.024872143,
           'class_loss': 0.11001899,
           'conf_loss': 0.0646579,
           'precision50': 0.2183571,
           'recall50': 0.09607996},
     'global': {'total_loss': 7.0965514},
     'learning_rate': 0.006238453,
     'training_loss': 7.0965514}
saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-5000.
train | step:  10000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.5542558,
           'avg_obj': 0.08217053,
           'box_loss': 0.01648735,
           'class_loss': 0.01212795,
           'conf_loss': 0.014980209,
           'precision50': 0.13866419,
           'recall50': 0.016163833},
     '4': {'avg_iou': 0.620692,
           'avg_obj': 0.15255061,
           'box_loss': 0.016702615,
           'class_loss': 0.012889244,
           'conf_loss': 0.018955026,
           'precision50': 0.38969037,
           'recall50': 0.06600329},
     '5': {'avg_iou': 0.6621737,
           'avg_obj': 0.23890041,
           'box_loss': 0.016242873,
           'class_loss': 0.012181924,
           'conf_loss': 0.019073278,
           'precision50': 0.5805036,
           'recall50': 0.15986763},
     'global': {'total_loss': 1.1171224},
     'learning_rate': 0.009979997,
     'training_loss': 1.1171224}
train | step:  15000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.5902558,
           'avg_obj': 0.114977024,
           'box_loss': 0.015140523,
           'class_loss': 0.009265479,
           'conf_loss': 0.014386952,
           'precision50': 0.22152652,
           'recall50': 0.035069738},
     '4': {'avg_iou': 0.66999066,
           'avg_obj': 0.20510654,
           'box_loss': 0.01441091,
           'class_loss': 0.009477445,
           'conf_loss': 0.018140586,
           'precision50': 0.50450575,
           'recall50': 0.12316045},
     '5': {'avg_iou': 0.7205877,
           'avg_obj': 0.30886877,
           'box_loss': 0.01327097,
           'class_loss': 0.008985645,
           'conf_loss': 0.018150145,
           'precision50': 0.67870104,
           'recall50': 0.26760706},
     'global': {'total_loss': 0.9698287},
     'learning_rate': 0.009948857,
     'training_loss': 0.9698287}I0410 01:26:41.416303 140367351805760 controller.py:425] train | step:  20000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6073332,
           'avg_obj': 0.13125639,
           'box_loss': 0.01450292,
           'class_loss': 0.008323467,
           'conf_loss': 0.014210952,
           'precision50': 0.2563333,
           'recall50': 0.04695412},
     '4': {'avg_iou': 0.6892229,
           'avg_obj': 0.22866802,
           'box_loss': 0.013527522,
           'class_loss': 0.008393188,
           'conf_loss': 0.01784157,
           'precision50': 0.5395719,
           'recall50': 0.15318993},
     '5': {'avg_iou': 0.742159,
           'avg_obj': 0.3386497,
           'box_loss': 0.012182519,
           'class_loss': 0.007949585,
           'conf_loss': 0.017731687,
           'precision50': 0.7036688,
           'recall50': 0.315},
     'global': {'total_loss': 0.9173085},
     'learning_rate': 0.009920185,
     'training_loss': 0.9173085}
I0410 01:26:55.575935 140367351805760 controller.py:252]  eval | step:  20000 | running 625 steps of evaluation...
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 157, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "/home/cam2tensorflow/TensorFlowModels/yolo/train_vm.py", line 149, in main
    model_dir=model_dir)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/train_lib.py", line 104, in run_experiment
    eval_interval=params.trainer.validation_interval)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 304, in train_and_evaluate
    self.evaluate(steps=eval_steps)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/controller.py", line 257, in evaluate
    eval_output = self.evaluator.evaluate(steps_tensor)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/standard_runner.py", line 313, in evaluate
    eval_iter, num_steps, state=outputs, reduce_fn=self.eval_reduce)
  File "/home/cam2tensorflow/TensorFlowModels/orbit/utils/loop_fns.py", line 76, in loop_fn
    state = reduce_fn(state, outputs)
  File "/home/cam2tensorflow/TensorFlowModels/official/core/base_trainer.py", line 356, in eval_reduce
    return self.task.aggregate_logs(state, step_outputs)
  File "/home/cam2tensorflow/TensorFlowModels/yolo/tasks/yolo.py", line 387, in aggregate_logs
    step_outputs[self.coco_metric.name][1])
  File "/home/cam2tensorflow/TensorFlowModels/official/vision/beta/evaluation/coco_evaluator.py", line 313, in update_state
    predictions)
  File "/home/cam2tensorflow/TensorFlowModels/official/vision/beta/evaluation/coco_evaluator.py", line 252, in _convert_to_numpy
    labels = tf.nest.map_structure(lambda x: x.numpy(), groundtruths)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/util/nest.py", line 659, in map_structure
    structure[0], [func(*x) for x in entries],
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/util/nest.py", line 659, in <listcomp>
    structure[0], [func(*x) for x in entries],
  File "/home/cam2tensorflow/TensorFlowModels/official/vision/beta/evaluation/coco_evaluator.py", line 252, in <lambda>
    labels = tf.nest.map_structure(lambda x: x.numpy(), groundtruths)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 1071, in numpy
    maybe_arr = self._numpy()  # pylint: disable=protected-access
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 1039, in _numpy
    six.raise_from(core._status_to_exception(e.code, e.message), None)  # pylint: disable=protected-access
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: 4 root error(s) found.
  (0) Invalid argument: {{function_node __inference_eval_step_196671}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_eval_step_2073148039406785243[] on XLA_TPU_JIT: CombinedNonMaxSuppression (No registered 'CombinedNonMaxSuppression' OpKernel for XLA_TPU_JIT devices compatible with node {{node yolo/yolo_layer/combined_non_max_suppression/CombinedNonMaxSuppression}}){{node yolo/yolo_layer/combined_non_max_suppression/CombinedNonMaxSuppression}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.config.set_soft_device_placement(True)`. This has a potential performance penalty.
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_13866052162548589127/_3]]
	 [[tpu_compile_succeeded_assert/_13866052162548589127/_3/_107]]
  (1) Invalid argument: {{function_node __inference_eval_step_196671}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_eval_step_2073148039406785243[] on XLA_TPU_JIT: CombinedNonMaxSuppression (No registered 'CombinedNonMaxSuppression' OpKernel for XLA_TPU_JIT devices compatible with node {{node yolo/yolo_layer/combined_non_max_suppression/CombinedNonMaxSuppression}}){{node yolo/yolo_layer/combined_non_max_suppression/CombinedNonMaxSuppression}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.config.set_soft_device_placement(True)`. This has a potential performance penalty.
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_13866052162548589127/_3]]
	 [[cluster_eval_step/control_after/_1/_191]]
  (2) Invalid argument: {{function_node __inference_eval_step_196671}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_eval_step_2073148039406785243[] on XLA_TPU_JIT: CombinedNonMaxSuppression (No registered 'CombinedNonMaxSuppression' OpKernel for XLA_TPU_JIT devices compatible with node {{node yolo/yolo_layer/combined_non_max_suppression/CombinedNonMaxSuppression}}){{node yolo/yolo_layer/combined_non_max_suppression/CombinedNonMaxSuppression}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.config.set_soft_device_placement(True)`. This has a potential performance penalty.
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_13866052162548589127/_3]]
	 [[tpu_compile_succeeded_assert/_13866052162548589127/_3/_143]]
  (3) Invalid argument: {{function_node __inference_eval_step_196671}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_eval_step_2073148039406785243[] on XLA_TPU_JIT: CombinedNonMaxSuppression (No registered 'CombinedNonMaxSuppression' OpKernel for XLA_TPU_JIT devices compatible with node {{node yolo/yolo_layer/combined_non_max_suppression/CombinedNonMaxSuppression}}){{node yolo/yolo_layer/combined_non_max_suppression/CombinedNonMaxSuppression}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.conf ... [truncated]
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/distribute/tpu_strategy.py", line 738, in async_wait
    context.async_wait()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/context.py", line 2330, in async_wait
    context().sync_executors()
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/context.py", line 645, in sync_executors
    pywrap_tfe.TFE_ContextSyncExecutors(self._context_handle)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 4 root error(s) found.
  (0) Invalid argument: {{function_node __inference_eval_step_196671}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_eval_step_2073148039406785243[] on XLA_TPU_JIT: CombinedNonMaxSuppression (No registered 'CombinedNonMaxSuppression' OpKernel for XLA_TPU_JIT devices compatible with node {{node yolo/yolo_layer/combined_non_max_suppression/CombinedNonMaxSuppression}}){{node yolo/yolo_layer/combined_non_max_suppression/CombinedNonMaxSuppression}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.config.set_soft_device_placement(True)`. This has a potential performance penalty.
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_13866052162548589127/_3]]
	 [[tpu_compile_succeeded_assert/_13866052162548589127/_3/_107]]
  (1) Invalid argument: {{function_node __inference_eval_step_196671}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_eval_step_2073148039406785243[] on XLA_TPU_JIT: CombinedNonMaxSuppression (No registered 'CombinedNonMaxSuppression' OpKernel for XLA_TPU_JIT devices compatible with node {{node yolo/yolo_layer/combined_non_max_suppression/CombinedNonMaxSuppression}}){{node yolo/yolo_layer/combined_non_max_suppression/CombinedNonMaxSuppression}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.config.set_soft_device_placement(True)`. This has a potential performance penalty.
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_13866052162548589127/_3]]
	 [[cluster_eval_step/control_after/_1/_191]]
  (2) Invalid argument: {{function_node __inference_eval_step_196671}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_eval_step_2073148039406785243[] on XLA_TPU_JIT: CombinedNonMaxSuppression (No registered 'CombinedNonMaxSuppression' OpKernel for XLA_TPU_JIT devices compatible with node {{node yolo/yolo_layer/combined_non_max_suppression/CombinedNonMaxSuppression}}){{node yolo/yolo_layer/combined_non_max_suppression/CombinedNonMaxSuppression}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.config.set_soft_device_placement(True)`. This has a potential performance penalty.
	TPU compilation failed
	 [[tpu_compile_succeeded_assert/_13866052162548589127/_3]]
	 [[tpu_compile_succeeded_assert/_13866052162548589127/_3/_143]]
  (3) Invalid argument: {{function_node __inference_eval_step_196671}} Compilation failure: Detected unsupported operations when trying to compile graph cluster_eval_step_2073148039406785243[] on XLA_TPU_JIT: CombinedNonMaxSuppression (No registered 'CombinedNonMaxSuppression' OpKernel for XLA_TPU_JIT devices compatible with node {{node yolo/yolo_layer/combined_non_max_suppression/CombinedNonMaxSuppression}}){{node yolo/yolo_layer/combined_non_max_suppression/CombinedNonMaxSuppression}}One approach is to outside compile the unsupported ops to run on CPUs by enabling soft placement `tf.conf ... [truncated]

train | step:  20000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6073332,
           'avg_obj': 0.13125639,
           'box_loss': 0.01450292,
           'class_loss': 0.008323467,
           'conf_loss': 0.014210952,
           'precision50': 0.2563333,
           'recall50': 0.04695412},
     '4': {'avg_iou': 0.6892229,
           'avg_obj': 0.22866802,
           'box_loss': 0.013527522,
           'class_loss': 0.008393188,
           'conf_loss': 0.01784157,
           'precision50': 0.5395719,
           'recall50': 0.15318993},
     '5': {'avg_iou': 0.742159,
           'avg_obj': 0.3386497,
           'box_loss': 0.012182519,
           'class_loss': 0.007949585,
           'conf_loss': 0.017731687,
           'precision50': 0.7036688,
           'recall50': 0.315},
     'global': {'total_loss': 0.9173085},
     'learning_rate': 0.009920185,
     'training_loss': 0.9173085}
 eval | step:  20000 | running 625 steps of evaluation...
(1, 20, 20, 512) (1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 2048)
(1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 1024)
(1, 20, 20, 512)
(1, 40, 40, 256) (1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 512)
(1, 40, 40, 256)
(1, 80, 80, 128) (1, 80, 80, 128)
(1, 80, 80, 128)
(1, 80, 80, 128)
(1, 80, 80, 128)
(1, 80, 80, 256)
(1, 80, 80, 128)
(1, 80, 80, 256)
(1, 40, 40, 256) (1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 512)
(1, 40, 40, 256)
(1, 40, 40, 512)
(1, 20, 20, 512) (1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 1024)
(1, 20, 20, 512)
(1, 20, 20, 1024)
2021-04-10 01:27:36.423488: W ./tensorflow/core/distributed_runtime/eager/destroy_tensor_handle_node.h:57] Ignoring an error encountered when deleting remote tensors handles: Invalid argument: Unable to find the relevant tensor remote_handle: Op ID: 60253, Output num: 382
Additional GRPC error information from remote target /job:worker/replica:0/task:0:
:{"created":"@1618018056.417539153","description":"Error received from peer ipv4:10.77.141.42:8470","file":"external/com_github_grpc_grpc/src/core/lib/surface/call.cc","file_line":1056,"grpc_message":"Unable to find the relevant tensor remote_handle: Op ID: 60253, Output num: 382","grpc_status":3}
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   208    0     2  100   206     11   1204 --:--:-- --:--:-- --:--:--  1216
okRequest issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-10T01:28:19.900747955Z'
  endTime: '2021-04-10T01:29:00.159225726Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618018099888-5bf94321581c0-3ae825b5-2b53cb02
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618018099888-5bf94321581c0-3ae825b5-2b53cb02] to complete...
...............................................................................................................................................................................................................................................................................done.
cat: .experiment_zone: No such file or directory
Request issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-10T01:29:49.552121457Z'
  endTime: '2021-04-10T01:30:27.463882010Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618018189540-5bf94376d7e84-b8662f70-e087f59e
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: READY
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618018189540-5bf94376d7e84-b8662f70-e087f59e] to complete...
...............................................................................................................................................................................................................................................................................done.
europe-west4-a
I0410 01:30:07.597273 140640048215872 train_utils.py:286] Final experiment parameters: {'runtime': {'all_reduce_alg': None,
             'batchnorm_spatial_persistent': False,
             'dataset_num_private_threads': None,
             'default_shard_dim': -1,
             'distribution_strategy': 'tpu',
             'enable_xla': False,
             'gpu_thread_mode': None,
             'loss_scale': None,
             'mixed_precision_dtype': 'bfloat16',
             'num_cores_per_replica': 1,
             'num_gpus': 2,
             'num_packs': 1,
             'per_gpu_thread_count': 0,
             'run_eagerly': False,
             'task_index': -1,
             'tpu': None,
             'worker_hosts': None},
 'task': {'annotation_file': None,
          'darknet_load_decoder': False,
          'gradient_clip_norm': 0.0,
          'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden',
          'init_checkpoint_modules': 'backbone',
          'load_darknet_weights': False,
          'model': {'_boxes': ['[12.0, 16.0]',
                               '[19.0, 36.0]',
                               '[40.0, 28.0]',
                               '[36.0, 75.0]',
                               '[76.0, 55.0]',
                               '[72.0, 146.0]',
                               '[142.0, 110.0]',
                               '[192.0, 243.0]',
                               '[459.0, 401.0]'],
                    '_input_size': [640, 640, 3],
                    'base': {'type': None},
                    'boxes_per_scale': 3,
                    'decoder_activation': 'mish',
                    'filter': {'anchor_generation_scale': 512,
                               'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5},
                               'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7},
                               'iou_normalizer': {'3': 0.05,
                                                  '4': 0.05,
                                                  '5': 0.05},
                               'iou_thresh': 0.001,
                               'loss_type': {'3': 'ciou',
                                             '4': 'ciou',
                                             '5': 'ciou'},
                               'max_boxes': 200,
                               'max_delta': {'3': inf, '4': inf, '5': inf},
                               'max_level': 5,
                               'min_level': 3,
                               'new_cords': {'3': True, '4': True, '5': True},
                               'nms_thresh': 0.6,
                               'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4},
                               'objectness_smooth': {'3': 1.0,
                                                     '4': 1.0,
                                                     '5': 1.0},
                               'path_scales': {'3': 8, '4': 16, '5': 32},
                               'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0},
                               'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0},
                               'use_nms': True,
                               'use_reduction_sum': True},
                    'max_level': 5,
                    'min_level': 3,
                    'norm_activation': {'activation': 'mish',
                                        'norm_epsilon': 0.001,
                                        'norm_momentum': 0.99,
                                        'use_sync_bn': True},
                    'num_classes': 91,
                    'subdivisions': 1,
                    'use_sam': False},
          'per_category_metrics': False,
          'train_data': {'block_length': 1,
                         'cache': False,
                         'cycle_length': None,
                         'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                     'type': 'simple_decoder'},
                         'deterministic': None,
                         'drop_remainder': True,
                         'dtype': 'float16',
                         'enable_tf_data_service': False,
                         'global_batch_size': 64,
                         'input_path': 'gs://tensorflow2/coco_records/train/2017*',
                         'is_training': True,
                         'parser': {'anchor_thresh': 0.213,
                                    'aug_rand_angle': 0.0,
                                    'aug_rand_brightness': 0.5,
                                    'aug_rand_hue': 0.1,
                                    'aug_rand_saturation': 0.7,
                                    'aug_rand_translate': 0.075,
                                    'aug_rand_zoom': 0.5,
                                    'fixed_size': True,
                                    'image_h': 640,
                                    'image_w': 640,
                                    'jitter_boxes': 0.2,
                                    'jitter_im': 0.6,
                                    'letter_box': False,
                                    'max_num_instances': 200,
                                    'min_process_size': 640,
                                    'mosaic': {'crop_area': [0.25, 1.0],
                                               'crop_area_mosaic': [0.25, 0.95],
                                               'mosaic_frequency': 0.85,
                                               'output_size': [640, 640],
                                               'random_crop': True,
                                               'random_crop_mosaic': True},
                                    'pct_rand': 0.0,
                                    'random_flip': True,
                                    'use_scale_xy': True,
                                    'use_tie_breaker': True},
                         'sharding': True,
                         'shuffle_buffer_size': 10000,
                         'tf_data_service_address': None,
                         'tf_data_service_job_name': None,
                         'tfds_as_supervised': False,
                         'tfds_data_dir': '',
                         'tfds_download': True,
                         'tfds_name': None,
                         'tfds_skip_decoding_feature': '',
                         'tfds_split': None},
          'validation_data': {'block_length': 1,
                              'cache': False,
                              'cycle_length': None,
                              'decoder': {'simple_decoder': {'regenerate_source_id': False},
                                          'type': 'simple_decoder'},
                              'deterministic': None,
                              'drop_remainder': True,
                              'dtype': 'float16',
                              'enable_tf_data_service': False,
                              'global_batch_size': 8,
                              'input_path': 'gs://tensorflow2/coco_records/val/2017*',
                              'is_training': False,
                              'parser': {'anchor_thresh': 0.2,
                                         'aug_rand_angle': 7.0,
                                         'aug_rand_brightness': 0.6,
                                         'aug_rand_hue': 0.1,
                                         'aug_rand_saturation': 0.7,
                                         'aug_rand_translate': 0.05,
                                         'aug_rand_zoom': 0.5,
                                         'fixed_size': True,
                                         'image_h': 640,
                                         'image_w': 640,
                                         'jitter_boxes': 0.2,
                                         'jitter_im': 0.6,
                                         'letter_box': False,
                                         'max_num_instances': 200,
                                         'min_process_size': 640,
                                         'mosaic': {'crop_area': [0.25, 1.0],
                                                    'crop_area_mosaic': [0.25,
                                                                         0.95],
                                                    'mosaic_frequency': 0.667,
                                                    'output_size': [640, 640],
                                                    'random_crop': True,
                                                    'random_crop_mosaic': True},
                                         'pct_rand': 0.0,
                                         'random_flip': True,
                                         'use_scale_xy': True,
                                         'use_tie_breaker': True},
                              'sharding': True,
                              'shuffle_buffer_size': 10000,
                              'tf_data_service_address': None,
                              'tf_data_service_job_name': None,
                              'tfds_as_supervised': False,
                              'tfds_data_dir': '',
                              'tfds_download': True,
                              'tfds_name': None,
                              'tfds_skip_decoding_feature': '',
                              'tfds_split': None},
          'weight_decay': 0.001},
 'trainer': {'allow_tpu_summary': False,
             'best_checkpoint_eval_metric': 'str = "AP50"',
             'best_checkpoint_export_subdir': '',
             'best_checkpoint_metric_comp': 'str = "higher"',
             'checkpoint_interval': 20000,
             'continuous_eval_timeout': 3600,
             'eval_tf_function': True,
             'eval_tf_while_loop': False,
             'loss_upper_bound': 1000000.0,
             'max_to_keep': 5,
             'optimizer_config': {'ema': {'average_decay': 0.9998},
                                  'learning_rate': {'cosine_epoch': {'alpha': 0.2,
                                                                     'decay_steps': 294375,
                                                                     'initial_learning_rate': 0.01,
                                                                     'name': 'CosineEpoch',
                                                                     'steps_per_epoch': 1875},
                                                    'type': 'cosine_epoch'},
                                  'optimizer': {'sgd': {'clipnorm': None,
                                                        'clipvalue': None,
                                                        'decay': 0.0,
                                                        'global_clipnorm': None,
                                                        'momentum': 0.937,
                                                        'name': 'SGD',
                                                        'nesterov': False},
                                                'type': 'sgd'},
                                  'warmup': {'polynomial': {'name': 'polynomial',
                                                            'power': 4,
                                                            'warmup_steps': 5625},
                                             'type': 'polynomial'}},
             'recovery_begin_steps': 0,
             'recovery_max_trials': 0,
             'steps_per_loop': 5000,
             'summary_interval': 5000,
             'train_steps': 300000,
             'train_tf_function': True,
             'train_tf_while_loop': True,
             'validation_interval': 20000,
             'validation_steps': 625}}
I0410 01:30:07.598641 140640048215872 train_utils.py:295] Saving experiment configuration to gs://tensorflow2/data-pipeline/all-300k/params.yaml
I0410 01:30:08.405990 140640048215872 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0410 01:30:09.023251 140640048215872 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0410 01:30:09.026260 140640048215872 transport.py:157] Attempting refresh to obtain initial access_token
I0410 01:30:09.074430 140640048215872 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0410 01:30:09.711438 140640048215872 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0410 01:30:09.711703 140640048215872 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-10 01:30:09.755101: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
I0410 01:30:09.755818 140640048215872 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0410 01:30:10.376421 140640048215872 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0410 01:30:10.376683 140640048215872 transport.py:157] Attempting refresh to obtain initial access_token
I0410 01:30:10.440121 140640048215872 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0410 01:30:11.054651 140640048215872 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0410 01:30:11.054921 140640048215872 transport.py:157] Attempting refresh to obtain initial access_token
2021-04-10 01:30:11.101998: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-10 01:30:11.121925: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-10 01:30:11.122005: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:32576}
2021-04-10 01:30:34.469297: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.77.141.42:8470}
2021-04-10 01:30:34.469444: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:32576}
2021-04-10 01:30:34.469973: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:411] Started server with target: grpc://localhost:32576
I0410 01:30:34.470942 140640048215872 remote.py:218] Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0
INFO:tensorflow:Initializing the TPU system: node-6
I0410 01:30:34.471762 140640048215872 tpu_strategy_util.py:74] Initializing the TPU system: node-6
INFO:tensorflow:Clearing out eager caches
I0410 01:30:42.824129 140640048215872 tpu_strategy_util.py:109] Clearing out eager caches
INFO:tensorflow:Finished initializing TPU system.
I0410 01:30:42.826325 140640048215872 tpu_strategy_util.py:133] Finished initializing TPU system.
I0410 01:30:42.827799 140640048215872 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0410 01:30:43.444784 140640048215872 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0410 01:30:43.445037 140640048215872 transport.py:157] Attempting refresh to obtain initial access_token
I0410 01:30:43.489062 140640048215872 discovery.py:280] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1/rest
I0410 01:30:44.104063 140640048215872 discovery.py:911] URL being requested: GET https://tpu.googleapis.com/v1/projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6?alt=json
I0410 01:30:44.104446 140640048215872 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:Found TPU system:
I0410 01:30:44.147372 140640048215872 tpu_system_metadata.py:159] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0410 01:30:44.147614 140640048215872 tpu_system_metadata.py:160] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0410 01:30:44.147942 140640048215872 tpu_system_metadata.py:161] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0410 01:30:44.148012 140640048215872 tpu_system_metadata.py:163] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0410 01:30:44.148067 140640048215872 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
I0410 01:30:44.148218 140640048215872 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
I0410 01:30:44.148270 140640048215872 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
I0410 01:30:44.148319 140640048215872 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
I0410 01:30:44.148371 140640048215872 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
I0410 01:30:44.148422 140640048215872 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
I0410 01:30:44.148468 140640048215872 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
I0410 01:30:44.148519 140640048215872 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
I0410 01:30:44.148571 140640048215872 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
I0410 01:30:44.148620 140640048215872 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
I0410 01:30:44.148662 140640048215872 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0410 01:30:44.148715 140640048215872 tpu_system_metadata.py:165] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)
I0410 01:30:44.181984 140640048215872 train_utils.py:214] Running default trainer.
2021-04-10 01:30:44.193268: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
yolo_custom
{'task': {'init_checkpoint': 'gs://tensorflow2/darknet/cspdarknet53-golden', 'model': {'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}, 'train_data': {'input_path': 'gs://tensorflow2/coco_records/train/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 64, 'is_training': True, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.075, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.5, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 0.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.213, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.85, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'validation_data': {'input_path': 'gs://tensorflow2/coco_records/val/2017*', 'tfds_name': None, 'tfds_split': None, 'global_batch_size': 8, 'is_training': False, 'drop_remainder': True, 'shuffle_buffer_size': 10000, 'cache': False, 'cycle_length': None, 'block_length': 1, 'deterministic': None, 'sharding': True, 'enable_tf_data_service': False, 'tf_data_service_address': None, 'tf_data_service_job_name': None, 'tfds_data_dir': '', 'tfds_download': True, 'tfds_as_supervised': False, 'tfds_skip_decoding_feature': '', 'dtype': 'float16', 'decoder': {'type': 'simple_decoder', 'simple_decoder': {'regenerate_source_id': False}}, 'parser': {'image_w': 640, 'image_h': 640, 'fixed_size': True, 'max_num_instances': 200, 'min_process_size': 640, 'letter_box': False, 'random_flip': True, 'pct_rand': 0.0, 'jitter_im': 0.6, 'jitter_boxes': 0.2, 'aug_rand_translate': 0.05, 'aug_rand_saturation': 0.7, 'aug_rand_brightness': 0.6, 'aug_rand_hue': 0.1, 'aug_rand_zoom': 0.5, 'aug_rand_angle': 7.0, 'use_tie_breaker': True, 'use_scale_xy': True, 'anchor_thresh': 0.2, 'mosaic': {'output_size': [640, 640], 'mosaic_frequency': 0.667, 'crop_area': [0.25, 1.0], 'crop_area_mosaic': [0.25, 0.95], 'random_crop': True, 'random_crop_mosaic': True}}}, 'weight_decay': 0.001, 'annotation_file': None, 'gradient_clip_norm': 0.0, 'per_category_metrics': False, 'load_darknet_weights': False, 'darknet_load_decoder': False, 'init_checkpoint_modules': 'backbone'}, 'trainer': {'optimizer_config': {'optimizer': {'type': 'sgd', 'sgd': {'clipnorm': None, 'clipvalue': None, 'global_clipnorm': None, 'name': 'SGD', 'decay': 0.0, 'nesterov': False, 'momentum': 0.937}}, 'ema': {'average_decay': 0.9998}, 'learning_rate': {'type': 'cosine_epoch', 'cosine_epoch': {'name': 'CosineEpoch', 'initial_learning_rate': 0.01, 'decay_steps': 294375, 'steps_per_epoch': 1875, 'alpha': 0.2}}, 'warmup': {'type': 'polynomial', 'polynomial': {'name': 'polynomial', 'power': 4, 'warmup_steps': 5625}}}, 'train_tf_while_loop': True, 'train_tf_function': True, 'eval_tf_function': True, 'eval_tf_while_loop': False, 'allow_tpu_summary': False, 'steps_per_loop': 5000, 'summary_interval': 5000, 'checkpoint_interval': 20000, 'max_to_keep': 5, 'continuous_eval_timeout': 3600, 'train_steps': 300000, 'validation_steps': 625, 'validation_interval': 20000, 'best_checkpoint_export_subdir': '', 'best_checkpoint_eval_metric': 'str = "AP50"', 'best_checkpoint_metric_comp': 'str = "higher"', 'loss_upper_bound': 1000000.0, 'recovery_begin_steps': 0, 'recovery_max_trials': 0}, 'runtime': {'distribution_strategy': 'tpu', 'enable_xla': False, 'gpu_thread_mode': None, 'dataset_num_private_threads': None, 'per_gpu_thread_count': 0, 'tpu': None, 'num_gpus': 2, 'worker_hosts': None, 'task_index': -1, 'all_reduce_alg': None, 'num_packs': 1, 'mixed_precision_dtype': 'bfloat16', 'loss_scale': None, 'run_eagerly': False, 'batchnorm_spatial_persistent': False, 'num_cores_per_replica': 1, 'default_shard_dim': -1}}
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0} 0.0005
{'num_classes': 91, '_input_size': [640, 640, 3], 'min_level': 3, 'max_level': 5, 'boxes_per_scale': 3, 'base': {'type': None}, 'subdivisions': 1, 'use_sam': False, 'filter': {'min_level': 3, 'max_level': 5, 'ignore_thresh': {'3': 0.7, '4': 0.7, '5': 0.7}, 'truth_thresh': {'3': 1.0, '4': 1.0, '5': 1.0}, 'loss_type': {'3': 'ciou', '4': 'ciou', '5': 'ciou'}, 'iou_normalizer': {'3': 0.05, '4': 0.05, '5': 0.05}, 'cls_normalizer': {'3': 0.5, '4': 0.5, '5': 0.5}, 'obj_normalizer': {'3': 4.0, '4': 1.0, '5': 0.4}, 'max_delta': {'3': inf, '4': inf, '5': inf}, 'new_cords': {'3': True, '4': True, '5': True}, 'scale_xy': {'3': 2.0, '4': 2.0, '5': 2.0}, 'path_scales': {'3': 8, '4': 16, '5': 32}, 'objectness_smooth': {'3': 1.0, '4': 1.0, '5': 1.0}, 'use_nms': True, 'iou_thresh': 0.001, 'nms_thresh': 0.6, 'max_boxes': 200, 'anchor_generation_scale': 512, 'use_reduction_sum': True}, 'norm_activation': {'activation': 'mish', 'use_sync_bn': True, 'norm_momentum': 0.99, 'norm_epsilon': 0.001}, 'decoder_activation': 'mish', '_boxes': ['[12.0, 16.0]', '[19.0, 36.0]', '[40.0, 28.0]', '[36.0, 75.0]', '[76.0, 55.0]', '[72.0, 146.0]', '[142.0, 110.0]', '[192.0, 243.0]', '[459.0, 401.0]']}
InputSpec(shape=(None, 640, 640, 3), ndim=4)
<tensorflow.python.keras.regularizers.L2 object at 0x7fe8ebd06f60>
Model: "cspdarknet53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 640, 640, 3) 0                                            
__________________________________________________________________________________________________
ConvBN_0_0 (ConvBN)             (None, 640, 640, 32) 992         input_1[0][0]                    
__________________________________________________________________________________________________
DarkRes_1_csp_down (CSPRoute)   ((None, 320, 320, 64 27392       ConvBN_0_0[0][0]                 
__________________________________________________________________________________________________
DarkRes_1_0 (DarkResidual)      (None, 320, 320, 64) 20864       DarkRes_1_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_1_csp_connect (CSPConne (None, 320, 320, 64) 12800       DarkRes_1_0[0][0]                
                                                                 DarkRes_1_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_2_csp_down (CSPRoute)   ((None, 160, 160, 64 91136       DarkRes_1_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_2_0 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_2_1 (DarkResidual)      (None, 160, 160, 64) 41472       DarkRes_2_0[0][0]                
__________________________________________________________________________________________________
DarkRes_2_csp_connect (CSPConne (None, 160, 160, 128 21248       DarkRes_2_1[0][0]                
                                                                 DarkRes_2_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_3_csp_down (CSPRoute)   ((None, 80, 80, 128) 362496      DarkRes_2_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_3_0 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_3_1 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_0[0][0]                
__________________________________________________________________________________________________
DarkRes_3_2 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_1[0][0]                
__________________________________________________________________________________________________
DarkRes_3_3 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_2[0][0]                
__________________________________________________________________________________________________
DarkRes_3_4 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_3[0][0]                
__________________________________________________________________________________________________
DarkRes_3_5 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_4[0][0]                
__________________________________________________________________________________________________
DarkRes_3_6 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_5[0][0]                
__________________________________________________________________________________________________
DarkRes_3_7 (DarkResidual)      (None, 80, 80, 128)  164864      DarkRes_3_6[0][0]                
__________________________________________________________________________________________________
DarkRes_3_csp_connect (CSPConne (None, 80, 80, 256)  83456       DarkRes_3_7[0][0]                
                                                                 DarkRes_3_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_4_csp_down (CSPRoute)   ((None, 40, 40, 256) 1445888     DarkRes_3_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_4_0 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_4_1 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_0[0][0]                
__________________________________________________________________________________________________
DarkRes_4_2 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_1[0][0]                
__________________________________________________________________________________________________
DarkRes_4_3 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_2[0][0]                
__________________________________________________________________________________________________
DarkRes_4_4 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_3[0][0]                
__________________________________________________________________________________________________
DarkRes_4_5 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_4[0][0]                
__________________________________________________________________________________________________
DarkRes_4_6 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_5[0][0]                
__________________________________________________________________________________________________
DarkRes_4_7 (DarkResidual)      (None, 40, 40, 256)  657408      DarkRes_4_6[0][0]                
__________________________________________________________________________________________________
DarkRes_4_csp_connect (CSPConne (None, 40, 40, 512)  330752      DarkRes_4_7[0][0]                
                                                                 DarkRes_4_csp_down[0][1]         
__________________________________________________________________________________________________
DarkRes_5_csp_down (CSPRoute)   ((None, 20, 20, 512) 5775360     DarkRes_4_csp_connect[0][0]      
__________________________________________________________________________________________________
DarkRes_5_0 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_csp_down[0][0]         
__________________________________________________________________________________________________
DarkRes_5_1 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_0[0][0]                
__________________________________________________________________________________________________
DarkRes_5_2 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_1[0][0]                
__________________________________________________________________________________________________
DarkRes_5_3 (DarkResidual)      (None, 20, 20, 512)  2625536     DarkRes_5_2[0][0]                
__________________________________________________________________________________________________
DarkRes_5_csp_connect (CSPConne (None, 20, 20, 1024) 1316864     DarkRes_5_3[0][0]                
                                                                 DarkRes_5_csp_down[0][1]         
==================================================================================================
Total params: 26,652,512
Trainable params: 26,617,184
Non-trainable params: 35,328
__________________________________________________________________________________________________
route_split 512.0 512.0
conv2 512.0
conv1 512.0
spp
conv1 512.0
conv2 512.0
connect
conv1 512.0
8
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
route_split 256.0 256.0
conv2 256.0
conv1 256.0
conv2 256.0
connect
conv1 256.0
6
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)








 ListWrapper([128, 256, 512])
route_split 128 128
conv2 128
conv1 128
conv2 128
connect
conv1 128
conv2 256
7
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
route_split 256 256
conv2 256
conv1 256
conv2 256
connect
conv1 256
conv2 512
7
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
route_split 512 512
conv2 512
conv1 512
conv2 512
connect
conv1 512
conv2 1024
7
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
detget {'3': 2.0, '4': 2.0, '5': 2.0}
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)I0410 01:31:34.566967 140640048215872 controller.py:362] restoring or initializing model...
I0410 01:31:49.739782 140640048215872 controller.py:366] restored model from gs://tensorflow2/data-pipeline/all-300k/ckpt-5000.
I0410 01:31:49.740116 140640048215872 controller.py:192] restored from checkpoint: gs://tensorflow2/data-pipeline/all-300k/ckpt-5000
I0410 01:31:49.740240 140640048215872 train_lib.py:96] Starts to execute mode: train_and_eval
I0410 01:31:49.744557 140640048215872 controller.py:211] train | step:   5000 | training until step 25000...
I0410 01:31:56.597861 140640048215872 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0410 01:32:36.064284 140640048215872 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0410 02:09:50.252890 140640048215872 controller.py:425] train | step:  10000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.55479914,
           'avg_obj': 0.08281206,
           'box_loss': 0.016523963,
           'class_loss': 0.01210983,
           'conf_loss': 0.015029614,
           'precision50': 0.14148891,
           'recall50': 0.016725887},
     '4': {'avg_iou': 0.622104,
           'avg_obj': 0.15343525,
           'box_loss': 0.01663721,
           'class_loss': 0.012856923,
           'conf_loss': 0.019026266,
           'precision50': 0.39354548,
           'recall50': 0.06715658},
     '5': {'avg_iou': 0.6629282,
           'avg_obj': 0.23985852,
           'box_loss': 0.016194008,
           'class_loss': 0.0121630505,
           'conf_loss': 0.01909867,
           'precision50': 0.5833431,
           'recall50': 0.16137414},
     'global': {'total_loss': 1.1171167},
     'learning_rate': 0.009979997,
     'training_loss': 1.1171167}
I0410 02:42:54.744890 140640048215872 controller.py:425] train | step:  15000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.59026015,
           'avg_obj': 0.11458723,
           'box_loss': 0.015152907,
           'class_loss': 0.009282572,
           'conf_loss': 0.01440459,
           'precision50': 0.21957454,
           'recall50': 0.035155524},
     '4': {'avg_iou': 0.6688442,
           'avg_obj': 0.20393558,
           'box_loss': 0.014463451,
           'class_loss': 0.0095066875,
           'conf_loss': 0.018173536,
           'precision50': 0.50396365,
           'recall50': 0.12243319},
     '5': {'avg_iou': 0.7201059,
           'avg_obj': 0.30792433,
           'box_loss': 0.013295172,
           'class_loss': 0.009016297,
           'conf_loss': 0.018168498,
           'precision50': 0.6789679,
           'recall50': 0.26696914},
     'global': {'total_loss': 0.97171164},
     'learning_rate': 0.009948857,
     'training_loss': 0.97171164}
I0410 03:16:14.163349 140640048215872 controller.py:425] train | step:  20000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.60815233,
           'avg_obj': 0.13267085,
           'box_loss': 0.014507452,
           'class_loss': 0.008271676,
           'conf_loss': 0.014187216,
           'precision50': 0.25846955,
           'recall50': 0.0477149},
     '4': {'avg_iou': 0.69124025,
           'avg_obj': 0.23115784,
           'box_loss': 0.01346781,
           'class_loss': 0.008314537,
           'conf_loss': 0.01777119,
           'precision50': 0.543116,
           'recall50': 0.1560921},
     '5': {'avg_iou': 0.7426575,
           'avg_obj': 0.3409072,
           'box_loss': 0.012172649,
           'class_loss': 0.007837617,
           'conf_loss': 0.017636593,
           'precision50': 0.70743877,
           'recall50': 0.31876034},
     'global': {'total_loss': 0.9133336},
     'learning_rate': 0.009920185,
     'training_loss': 0.9133336}

(None, 20, 20, 2048)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 80, 80, 128) (None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 80, 80, 128)
(None, 80, 80, 256)
(None, 40, 40, 256) (None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 40, 40, 256)
(None, 40, 40, 512)
(None, 20, 20, 512) (None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 512)
(None, 20, 20, 1024)
(None, 20, 20, 512)
(None, 20, 20, 1024)
Model: "yolo"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
cspdarknet53 (Darknet)       OrderedDict([('3', (None, 26652512  
_________________________________________________________________
YoloDecoder (YoloDecoder)    {'3': (None, 80, 80, 256) 25897472  
_________________________________________________________________
yolo_head (YoloHead)         multiple                  516960    
_________________________________________________________________
yolo_layer (YoloLayer)       multiple                  0         
=================================================================
Total params: 53,066,944
Trainable params: 53,001,664
Non-trainable params: 65,280
_________________________________________________________________
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((8, 640, 640, 3), {source_id: (8,), bbox: (8, 200, 4), classes: (8, 200), area: (8, 200), is_crowd: (8, 200), best_anchors: (8, 200, 9), best_iou_match: (8, 200, 9), width: (8,), height: (8,), info: (8, 4, 2), num_detections: (8,), upds: {3: (8, 600, 8), 4: (8, 400, 8), 5: (8, 200, 8)}, inds: {3: (8, 600, 3), 4: (8, 400, 3), 5: (8, 200, 3)}, true_conf: {3: (8, 80, 80, 3, 1), 4: (8, 40, 40, 3, 1), 5: (8, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.float32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
defaultdict(<class 'list'>, {'3': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '4': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], '5': ['box_loss', 'class_loss', 'conf_loss', 'recall50', 'precision50', 'avg_iou', 'avg_obj'], 'global': ['total_loss']})
{'3': 2.0, '4': 2.0, '5': 2.0}
<PrefetchDataset shapes: ((1, 640, 640, 3), {source_id: (1,), bbox: (1, 200, 4), classes: (1, 200), area: (1, 200), is_crowd: (1, 200), best_anchors: (1, 200, 9), best_iou_match: (1, 200, 9), width: (1,), height: (1,), info: (1, 4), num_detections: (1,), upds: {3: (1, 200, 8), 4: (1, 200, 8), 5: (1, 200, 8)}, inds: {3: (1, 200, 3), 4: (1, 200, 3), 5: (1, 200, 3)}, true_conf: {3: (1, 80, 80, 3, 1), 4: (1, 40, 40, 3, 1), 5: (1, 20, 20, 3, 1)}}), types: (tf.float16, {source_id: tf.int64, bbox: tf.float16, classes: tf.float16, area: tf.float16, is_crowd: tf.int32, best_anchors: tf.float16, best_iou_match: tf.float32, width: tf.int32, height: tf.int32, info: tf.int32, num_detections: tf.int32, upds: {3: tf.float16, 4: tf.float16, 5: tf.float16}, inds: {3: tf.int32, 4: tf.int32, 5: tf.int32}, true_conf: {3: tf.float16, 4: tf.float16, 5: tf.float16}})>
restoring or initializing model...
restored model from gs://tensorflow2/data-pipeline/all-300k/ckpt-5000.
restored from checkpoint: gs://tensorflow2/data-pipeline/all-300k/ckpt-5000
train | step:   5000 | training until step 25000...
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 2048)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 80, 80, 128) (8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 80, 80, 128)
(8, 80, 80, 256)
(8, 40, 40, 256) (8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 40, 40, 256)
(8, 40, 40, 512)
(8, 20, 20, 512) (8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 512)
(8, 20, 20, 1024)
(8, 20, 20, 512)
(8, 20, 20, 1024)
train | step:  10000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.55479914,
           'avg_obj': 0.08281206,
           'box_loss': 0.016523963,
           'class_loss': 0.01210983,
           'conf_loss': 0.015029614,
           'precision50': 0.14148891,
           'recall50': 0.016725887},
     '4': {'avg_iou': 0.622104,
           'avg_obj': 0.15343525,
           'box_loss': 0.01663721,
           'class_loss': 0.012856923,
           'conf_loss': 0.019026266,
           'precision50': 0.39354548,
           'recall50': 0.06715658},
     '5': {'avg_iou': 0.6629282,
           'avg_obj': 0.23985852,
           'box_loss': 0.016194008,
           'class_loss': 0.0121630505,
           'conf_loss': 0.01909867,
           'precision50': 0.5833431,
           'recall50': 0.16137414},
     'global': {'total_loss': 1.1171167},
     'learning_rate': 0.009979997,
     'training_loss': 1.1171167}
train | step:  15000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.59026015,
           'avg_obj': 0.11458723,
           'box_loss': 0.015152907,
           'class_loss': 0.009282572,
           'conf_loss': 0.01440459,
           'precision50': 0.21957454,
           'recall50': 0.035155524},
     '4': {'avg_iou': 0.6688442,
           'avg_obj': 0.20393558,
           'box_loss': 0.014463451,
           'class_loss': 0.0095066875,
           'conf_loss': 0.018173536,
           'precision50': 0.50396365,
           'recall50': 0.12243319},
     '5': {'avg_iou': 0.7201059,
           'avg_obj': 0.30792433,
           'box_loss': 0.013295172,
           'class_loss': 0.009016297,
           'conf_loss': 0.018168498,
           'precision50': 0.6789679,
           'recall50': 0.26696914},
     'global': {'total_loss': 0.97171164},
     'learning_rate': 0.009948857,
     'training_loss': 0.97171164}
train | step:  20000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.60815233,
           'avg_obj': 0.13267085,
           'box_loss': 0.014507452,
           'class_loss': 0.008271676,
           'conf_loss': 0.014187216,
           'precision50': 0.25846955,
           'recall50': 0.0477149},
     '4': {'avg_iou': 0.69124025,
           'avg_obj': 0.23115784,
           'box_loss': 0.01346781,
           'class_loss': 0.008314537,
           'conf_loss': 0.01777119,
           'precision50': 0.543116,
           'recall50': 0.1560921},
     '5': {'avg_iou': 0.7426575,
           'avg_obj': 0.3409072,
           'box_loss': 0.012172649,
           'class_loss': 0.007837617,
           'conf_loss': 0.017636593,
           'precision50': 0.70743877,
           'recall50': 0.31876034},
     'global': {'total_loss': 0.9133336},
     'learning_rate': 0.009920185,
     'training_loss': 0.9133336}I0410 03:47:43.906680 140640048215872 controller.py:425] train | step:  25000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6194852,
           'avg_obj': 0.14409788,
           'box_loss': 0.014054853,
           'class_loss': 0.0076375525,
           'conf_loss': 0.013922191,
           'precision50': 0.27790755,
           'recall50': 0.056353375},
     '4': {'avg_iou': 0.70342815,
           'avg_obj': 0.24774238,
           'box_loss': 0.012900603,
           'class_loss': 0.0075738975,
           'conf_loss': 0.01744463,
           'precision50': 0.55976176,
           'recall50': 0.17582878},
     '5': {'avg_iou': 0.756794,
           'avg_obj': 0.36175117,
           'box_loss': 0.011461429,
           'class_loss': 0.0071320543,
           'conf_loss': 0.017262435,
           'precision50': 0.7205971,
           'recall50': 0.3497595},
     'global': {'total_loss': 0.8751181},
     'learning_rate': 0.009865424,
     'training_loss': 0.8751181}
I0410 03:48:35.798545 140640048215872 controller.py:455] saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-25000.
I0410 03:48:35.804538 140640048215872 controller.py:252]  eval | step:  25000 | running 625 steps of evaluation...
I0410 03:48:36.383990 140640048215872 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0410 03:48:53.495793 140640048215872 tpu.py:1238] Automatic outside compilation is enabled. Ops without XLA kernels will be automatically placed on CPU.
I0410 03:53:53.968485 140640048215872 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0410 03:58:06.387376 140640048215872 controller.py:261]  eval | step:  25000 | eval time:  570.6 sec | output: 
    {'3': {'avg_iou': 0.430972,
           'avg_obj': 0.13409096,
           'box_loss': 0.0082645435,
           'class_loss': 0.0036188446,
           'conf_loss': 0.005884443,
           'precision50': 0.14141461,
           'recall50': 0.10479474},
     '4': {'avg_iou': 0.6482112,
           'avg_obj': 0.29552838,
           'box_loss': 0.009027005,
           'class_loss': 0.00410753,
           'conf_loss': 0.0076351473,
           'precision50': 0.2545668,
           'recall50': 0.29191592},
     '5': {'avg_iou': 0.795076,
           'avg_obj': 0.4538107,
           'box_loss': 0.008643946,
           'class_loss': 0.0041184966,
           'conf_loss': 0.008593165,
           'precision50': 0.3282566,
           'recall50': 0.49686387},
     'AP': 0.32374159,
     'AP50': 0.51616913,
     'AP75': 0.34590283,
     'APl': 0.43484667,
     'APm': 0.2711565,
     'APs': 0.10372353,
     'ARl': 0.6394306,
     'ARm': 0.4845547,
     'ARmax1': 0.2853902,
     'ARmax10': 0.47198248,
     'ARmax100': 0.51632386,
     'ARs': 0.22450519,
     'global': {'total_loss': 0.05989312},
     'validation_loss': 0.05989312}
I0410 03:58:29.692459 140640048215872 controller.py:211] train | step:  25000 | training until step 45000...
I0410 04:31:49.577542 140640048215872 controller.py:425] train | step:  30000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6264706,
           'avg_obj': 0.1525434,
           'box_loss': 0.013814202,
           'class_loss': 0.0072183767,
           'conf_loss': 0.013798506,
           'precision50': 0.29354596,
           'recall50': 0.06283291},
     '4': {'avg_iou': 0.7130876,
           'avg_obj': 0.26082733,
           'box_loss': 0.012447736,
           'class_loss': 0.007085211,
           'conf_loss': 0.017229164,
           'precision50': 0.57399255,
           'recall50': 0.19266222},
     '5': {'avg_iou': 0.7667095,
           'avg_obj': 0.3773718,
           'box_loss': 0.010963332,
           'class_loss': 0.0066691195,
           'conf_loss': 0.016991748,
           'precision50': 0.72983927,
           'recall50': 0.37253442},
     'global': {'total_loss': 0.8497406},
     'learning_rate': 0.009796737,
     'training_loss': 0.8497406}
I0410 05:04:17.778247 140640048215872 controller.py:425] train | step:  35000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.63339245,
           'avg_obj': 0.1597442,
           'box_loss': 0.013553572,
           'class_loss': 0.0068636346,
           'conf_loss': 0.013692775,
           'precision50': 0.3058679,
           'recall50': 0.06838732},
     '4': {'avg_iou': 0.72185105,
           'avg_obj': 0.2720297,
           'box_loss': 0.012052506,
           'class_loss': 0.006688246,
           'conf_loss': 0.01705508,
           'precision50': 0.58541906,
           'recall50': 0.20709087},
     '5': {'avg_iou': 0.77444446,
           'avg_obj': 0.39041832,
           'box_loss': 0.01056427,
           'class_loss': 0.0062939953,
           'conf_loss': 0.01672715,
           'precision50': 0.7378032,
           'recall50': 0.39143574},
     'global': {'total_loss': 0.82793},
     'learning_rate': 0.00974333,
     'training_loss': 0.82793}
I0410 05:37:21.189192 140640048215872 controller.py:425] train | step:  40000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6388357,
           'avg_obj': 0.16646495,
           'box_loss': 0.013364752,
           'class_loss': 0.00661602,
           'conf_loss': 0.013587734,
           'precision50': 0.3177251,
           'recall50': 0.07440745},
     '4': {'avg_iou': 0.7259164,
           'avg_obj': 0.2805551,
           'box_loss': 0.011877222,
           'class_loss': 0.0064035943,
           'conf_loss': 0.016848814,
           'precision50': 0.59239656,
           'recall50': 0.21787326},
     '5': {'avg_iou': 0.7804437,
           'avg_obj': 0.40070298,
           'box_loss': 0.010272769,
           'class_loss': 0.0060054394,
           'conf_loss': 0.0165222,
           'precision50': 0.7441162,
           'recall50': 0.4066287},
     'global': {'total_loss': 0.81198895},
     'learning_rate': 0.009652007,
     'training_loss': 0.81198895}
I0410 06:10:04.441764 140640048215872 controller.py:425] train | step:  45000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6430247,
           'avg_obj': 0.17173332,
           'box_loss': 0.01317514,
           'class_loss': 0.006369727,
           'conf_loss': 0.013468138,
           'precision50': 0.32520443,
           'recall50': 0.07824365},
     '4': {'avg_iou': 0.732379,
           'avg_obj': 0.28911063,
           'box_loss': 0.011573726,
           'class_loss': 0.006142261,
           'conf_loss': 0.01667764,
           'precision50': 0.5977018,
           'recall50': 0.22804871},
     '5': {'avg_iou': 0.7854338,
           'avg_obj': 0.40984616,
           'box_loss': 0.01002204,
           'class_loss': 0.005763661,
           'conf_loss': 0.016317952,
           'precision50': 0.7478926,
           'recall50': 0.4189184},
     'global': {'total_loss': 0.7960827},
     'learning_rate': 0.00954753,
     'training_loss': 0.7960827}
I0410 06:10:55.960052 140640048215872 controller.py:455] saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-45000.
I0410 06:10:55.965769 140640048215872 controller.py:252]  eval | step:  45000 | running 625 steps of evaluation...
I0410 06:15:20.246959 140640048215872 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.

train | step:  25000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6194852,
           'avg_obj': 0.14409788,
           'box_loss': 0.014054853,
           'class_loss': 0.0076375525,
           'conf_loss': 0.013922191,
           'precision50': 0.27790755,
           'recall50': 0.056353375},
     '4': {'avg_iou': 0.70342815,
           'avg_obj': 0.24774238,
           'box_loss': 0.012900603,
           'class_loss': 0.0075738975,
           'conf_loss': 0.01744463,
           'precision50': 0.55976176,
           'recall50': 0.17582878},
     '5': {'avg_iou': 0.756794,
           'avg_obj': 0.36175117,
           'box_loss': 0.011461429,
           'class_loss': 0.0071320543,
           'conf_loss': 0.017262435,
           'precision50': 0.7205971,
           'recall50': 0.3497595},
     'global': {'total_loss': 0.8751181},
     'learning_rate': 0.009865424,
     'training_loss': 0.8751181}
saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-25000.
 eval | step:  25000 | running 625 steps of evaluation...
(1, 20, 20, 512) (1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 2048)
(1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 1024)
(1, 20, 20, 512)
(1, 40, 40, 256) (1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 512)
(1, 40, 40, 256)
(1, 80, 80, 128) (1, 80, 80, 128)
(1, 80, 80, 128)
(1, 80, 80, 128)
(1, 80, 80, 128)
(1, 80, 80, 256)
(1, 80, 80, 128)
(1, 80, 80, 256)
(1, 40, 40, 256) (1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 256)
(1, 40, 40, 512)
(1, 40, 40, 256)
(1, 40, 40, 512)
(1, 20, 20, 512) (1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 512)
(1, 20, 20, 1024)
(1, 20, 20, 512)
(1, 20, 20, 1024)
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=180.62s).
Accumulating evaluation results...
DONE (t=19.29s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.324
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.516
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.346
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.104
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.271
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.435
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.285
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.472
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.516
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.225
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.639
 eval | step:  25000 | eval time:  570.6 sec | output: 
    {'3': {'avg_iou': 0.430972,
           'avg_obj': 0.13409096,
           'box_loss': 0.0082645435,
           'class_loss': 0.0036188446,
           'conf_loss': 0.005884443,
           'precision50': 0.14141461,
           'recall50': 0.10479474},
     '4': {'avg_iou': 0.6482112,
           'avg_obj': 0.29552838,
           'box_loss': 0.009027005,
           'class_loss': 0.00410753,
           'conf_loss': 0.0076351473,
           'precision50': 0.2545668,
           'recall50': 0.29191592},
     '5': {'avg_iou': 0.795076,
           'avg_obj': 0.4538107,
           'box_loss': 0.008643946,
           'class_loss': 0.0041184966,
           'conf_loss': 0.008593165,
           'precision50': 0.3282566,
           'recall50': 0.49686387},
     'AP': 0.32374159,
     'AP50': 0.51616913,
     'AP75': 0.34590283,
     'APl': 0.43484667,
     'APm': 0.2711565,
     'APs': 0.10372353,
     'ARl': 0.6394306,
     'ARm': 0.4845547,
     'ARmax1': 0.2853902,
     'ARmax10': 0.47198248,
     'ARmax100': 0.51632386,
     'ARs': 0.22450519,
     'global': {'total_loss': 0.05989312},
     'validation_loss': 0.05989312}
train | step:  25000 | training until step 45000...
train | step:  30000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.6264706,
           'avg_obj': 0.1525434,
           'box_loss': 0.013814202,
           'class_loss': 0.0072183767,
           'conf_loss': 0.013798506,
           'precision50': 0.29354596,
           'recall50': 0.06283291},
     '4': {'avg_iou': 0.7130876,
           'avg_obj': 0.26082733,
           'box_loss': 0.012447736,
           'class_loss': 0.007085211,
           'conf_loss': 0.017229164,
           'precision50': 0.57399255,
           'recall50': 0.19266222},
     '5': {'avg_iou': 0.7667095,
           'avg_obj': 0.3773718,
           'box_loss': 0.010963332,
           'class_loss': 0.0066691195,
           'conf_loss': 0.016991748,
           'precision50': 0.72983927,
           'recall50': 0.37253442},
     'global': {'total_loss': 0.8497406},
     'learning_rate': 0.009796737,
     'training_loss': 0.8497406}
train | step:  35000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.63339245,
           'avg_obj': 0.1597442,
           'box_loss': 0.013553572,
           'class_loss': 0.0068636346,
           'conf_loss': 0.013692775,
           'precision50': 0.3058679,
           'recall50': 0.06838732},
     '4': {'avg_iou': 0.72185105,
           'avg_obj': 0.2720297,
           'box_loss': 0.012052506,
           'class_loss': 0.006688246,
           'conf_loss': 0.01705508,
           'precision50': 0.58541906,
           'recall50': 0.20709087},
     '5': {'avg_iou': 0.77444446,
           'avg_obj': 0.39041832,
           'box_loss': 0.01056427,
           'class_loss': 0.0062939953,
           'conf_loss': 0.01672715,
           'precision50': 0.7378032,
           'recall50': 0.39143574},
     'global': {'total_loss': 0.82793},
     'learning_rate': 0.00974333,
     'training_loss': 0.82793}
train | step:  40000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6388357,
           'avg_obj': 0.16646495,
           'box_loss': 0.013364752,
           'class_loss': 0.00661602,
           'conf_loss': 0.013587734,
           'precision50': 0.3177251,
           'recall50': 0.07440745},
     '4': {'avg_iou': 0.7259164,
           'avg_obj': 0.2805551,
           'box_loss': 0.011877222,
           'class_loss': 0.0064035943,
           'conf_loss': 0.016848814,
           'precision50': 0.59239656,
           'recall50': 0.21787326},
     '5': {'avg_iou': 0.7804437,
           'avg_obj': 0.40070298,
           'box_loss': 0.010272769,
           'class_loss': 0.0060054394,
           'conf_loss': 0.0165222,
           'precision50': 0.7441162,
           'recall50': 0.4066287},
     'global': {'total_loss': 0.81198895},
     'learning_rate': 0.009652007,
     'training_loss': 0.81198895}
train | step:  45000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6430247,
           'avg_obj': 0.17173332,
           'box_loss': 0.01317514,
           'class_loss': 0.006369727,
           'conf_loss': 0.013468138,
           'precision50': 0.32520443,
           'recall50': 0.07824365},
     '4': {'avg_iou': 0.732379,
           'avg_obj': 0.28911063,
           'box_loss': 0.011573726,
           'class_loss': 0.006142261,
           'conf_loss': 0.01667764,
           'precision50': 0.5977018,
           'recall50': 0.22804871},
     '5': {'avg_iou': 0.7854338,
           'avg_obj': 0.40984616,
           'box_loss': 0.01002204,
           'class_loss': 0.005763661,
           'conf_loss': 0.016317952,
           'precision50': 0.7478926,
           'recall50': 0.4189184},
     'global': {'total_loss': 0.7960827},
     'learning_rate': 0.00954753,
     'training_loss': 0.7960827}
saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-45000.
 eval | step:  45000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=181.53s).
Accumulating evaluation results...
DONE (t=17.48s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.368I0410 06:19:31.204608 140640048215872 controller.py:261]  eval | step:  45000 | eval time:  515.2 sec | output: 
    {'3': {'avg_iou': 0.43828636,
           'avg_obj': 0.15184832,
           'box_loss': 0.007900322,
           'class_loss': 0.0029863718,
           'conf_loss': 0.0059080874,
           'precision50': 0.14891297,
           'recall50': 0.12881008},
     '4': {'avg_iou': 0.65973574,
           'avg_obj': 0.32731068,
           'box_loss': 0.008449825,
           'class_loss': 0.0033864158,
           'conf_loss': 0.00774516,
           'precision50': 0.25318405,
           'recall50': 0.33697984},
     '5': {'avg_iou': 0.8095981,
           'avg_obj': 0.49933136,
           'box_loss': 0.007914875,
           'class_loss': 0.0033998059,
           'conf_loss': 0.008808037,
           'precision50': 0.32348332,
           'recall50': 0.5539161},
     'AP': 0.36751616,
     'AP50': 0.56575716,
     'AP75': 0.3955116,
     'APl': 0.4881919,
     'APm': 0.31415445,
     'APs': 0.12626934,
     'ARl': 0.6731081,
     'ARm': 0.52666295,
     'ARmax1': 0.3068152,
     'ARmax10': 0.5062247,
     'ARmax100': 0.5536694,
     'ARs': 0.26129976,
     'global': {'total_loss': 0.05649888},
     'validation_loss': 0.05649888}
I0410 06:19:49.450474 140640048215872 controller.py:211] train | step:  45000 | training until step 65000...
I0410 06:51:25.801626 140640048215872 controller.py:425] train | step:  50000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.64678144,
           'avg_obj': 0.17694098,
           'box_loss': 0.01303645,
           'class_loss': 0.006187462,
           'conf_loss': 0.013377887,
           'precision50': 0.33229792,
           'recall50': 0.08225397},
     '4': {'avg_iou': 0.7365964,
           'avg_obj': 0.29558027,
           'box_loss': 0.011385715,
           'class_loss': 0.0059498884,
           'conf_loss': 0.016581943,
           'precision50': 0.6041446,
           'recall50': 0.23630756},
     '5': {'avg_iou': 0.7904082,
           'avg_obj': 0.41781816,
           'box_loss': 0.009771992,
           'class_loss': 0.005574784,
           'conf_loss': 0.0161934,
           'precision50': 0.7527089,
           'recall50': 0.43041426},
     'global': {'total_loss': 0.7844764},
     'learning_rate': 0.009470752,
     'training_loss': 0.7844764}
I0410 07:24:10.387343 140640048215872 controller.py:425] train | step:  55000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.65045077,
           'avg_obj': 0.18064053,
           'box_loss': 0.012931692,
           'class_loss': 0.0060547506,
           'conf_loss': 0.013374207,
           'precision50': 0.337978,
           'recall50': 0.08522645},
     '4': {'avg_iou': 0.740208,
           'avg_obj': 0.30148664,
           'box_loss': 0.011224483,
           'class_loss': 0.0057668197,
           'conf_loss': 0.016494108,
           'precision50': 0.6069418,
           'recall50': 0.2429226},
     '5': {'avg_iou': 0.7939724,
           'avg_obj': 0.42453775,
           'box_loss': 0.009604383,
           'class_loss': 0.0054076007,
           'conf_loss': 0.016042866,
           'precision50': 0.7563768,
           'recall50': 0.4395227},
     'global': {'total_loss': 0.7752085},
     'learning_rate': 0.0093452055,
     'training_loss': 0.7752085}
I0410 07:56:26.658513 140640048215872 controller.py:425] train | step:  60000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.65263283,
           'avg_obj': 0.18522954,
           'box_loss': 0.012809184,
           'class_loss': 0.0058722147,
           'conf_loss': 0.013225032,
           'precision50': 0.3443012,
           'recall50': 0.089582376},
     '4': {'avg_iou': 0.74408484,
           'avg_obj': 0.30761454,
           'box_loss': 0.011032384,
           'class_loss': 0.0055890554,
           'conf_loss': 0.016318081,
           'precision50': 0.6123985,
           'recall50': 0.25106403},
     '5': {'avg_iou': 0.79752547,
           'avg_obj': 0.43080336,
           'box_loss': 0.009421372,
           'class_loss': 0.0052597164,
           'conf_loss': 0.015871711,
           'precision50': 0.7588004,
           'recall50': 0.4479016},
     'global': {'total_loss': 0.7631905},
     'learning_rate': 0.009207607,
     'training_loss': 0.7631905}
I0410 08:28:14.741107 140640048215872 controller.py:425] train | step:  65000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6561324,
           'avg_obj': 0.18846588,
           'box_loss': 0.012709333,
           'class_loss': 0.0057840054,
           'conf_loss': 0.013169679,
           'precision50': 0.34855255,
           'recall50': 0.092172176},
     '4': {'avg_iou': 0.7463448,
           'avg_obj': 0.3123833,
           'box_loss': 0.010951365,
           'class_loss': 0.0054756324,
           'conf_loss': 0.016197233,
           'precision50': 0.6153042,
           'recall50': 0.256826},
     '5': {'avg_iou': 0.8010776,
           'avg_obj': 0.4374528,
           'box_loss': 0.009256865,
           'class_loss': 0.0051180185,
           'conf_loss': 0.015734218,
           'precision50': 0.7616251,
           'recall50': 0.45689833},
     'global': {'total_loss': 0.755169},
     'learning_rate': 0.009109423,
     'training_loss': 0.755169}
I0410 08:29:06.184717 140640048215872 controller.py:455] saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-65000.
I0410 08:29:06.190502 140640048215872 controller.py:252]  eval | step:  65000 | running 625 steps of evaluation...
I0410 08:33:25.613684 140640048215872 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0410 08:37:31.557271 140640048215872 controller.py:261]  eval | step:  65000 | eval time:  505.4 sec | output: 
    {'3': {'avg_iou': 0.44168824,
           'avg_obj': 0.16025431,
           'box_loss': 0.0077293776,
           'class_loss': 0.0027220256,
           'conf_loss': 0.0059075137,
           'precision50': 0.15058099,
           'recall50': 0.14080088},
     '4': {'avg_iou': 0.66508704,
           'avg_obj': 0.34391642,
           'box_loss': 0.008181237,
           'class_loss': 0.0031044555,
           'conf_loss': 0.007803135,
           'precision50': 0.25192842,
           'recall50': 0.36025193},
     '5': {'avg_iou': 0.8158555,
           'avg_obj': 0.5238603,
           'box_loss': 0.0076011606,
           'class_loss': 0.0030889194,
           'conf_loss': 0.008964165,
           'precision50': 0.31897724,
           'recall50': 0.5845706},
     'AP': 0.38600895,
     'AP50': 0.5853567,
     'AP75': 0.41390014,
     'APl': 0.5120406,
     'APm': 0.33407903,
     'APs': 0.13394417,
     'ARl': 0.6860174,
     'ARm': 0.5449389,
     'ARmax1': 0.3164654,
     'ARmax10': 0.52078384,
     'ARmax100': 0.5682326,
     'ARs': 0.28423914,
     'global': {'total_loss': 0.055101965},
     'validation_loss': 0.055101965}

 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.566
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.396
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.126
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.314
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.488
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.307
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.506
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.554
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.261
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.527
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.673
 eval | step:  45000 | eval time:  515.2 sec | output: 
    {'3': {'avg_iou': 0.43828636,
           'avg_obj': 0.15184832,
           'box_loss': 0.007900322,
           'class_loss': 0.0029863718,
           'conf_loss': 0.0059080874,
           'precision50': 0.14891297,
           'recall50': 0.12881008},
     '4': {'avg_iou': 0.65973574,
           'avg_obj': 0.32731068,
           'box_loss': 0.008449825,
           'class_loss': 0.0033864158,
           'conf_loss': 0.00774516,
           'precision50': 0.25318405,
           'recall50': 0.33697984},
     '5': {'avg_iou': 0.8095981,
           'avg_obj': 0.49933136,
           'box_loss': 0.007914875,
           'class_loss': 0.0033998059,
           'conf_loss': 0.008808037,
           'precision50': 0.32348332,
           'recall50': 0.5539161},
     'AP': 0.36751616,
     'AP50': 0.56575716,
     'AP75': 0.3955116,
     'APl': 0.4881919,
     'APm': 0.31415445,
     'APs': 0.12626934,
     'ARl': 0.6731081,
     'ARm': 0.52666295,
     'ARmax1': 0.3068152,
     'ARmax10': 0.5062247,
     'ARmax100': 0.5536694,
     'ARs': 0.26129976,
     'global': {'total_loss': 0.05649888},
     'validation_loss': 0.05649888}
train | step:  45000 | training until step 65000...
train | step:  50000 | steps/sec:    2.0 | output: 
    {'3': {'avg_iou': 0.64678144,
           'avg_obj': 0.17694098,
           'box_loss': 0.01303645,
           'class_loss': 0.006187462,
           'conf_loss': 0.013377887,
           'precision50': 0.33229792,
           'recall50': 0.08225397},
     '4': {'avg_iou': 0.7365964,
           'avg_obj': 0.29558027,
           'box_loss': 0.011385715,
           'class_loss': 0.0059498884,
           'conf_loss': 0.016581943,
           'precision50': 0.6041446,
           'recall50': 0.23630756},
     '5': {'avg_iou': 0.7904082,
           'avg_obj': 0.41781816,
           'box_loss': 0.009771992,
           'class_loss': 0.005574784,
           'conf_loss': 0.0161934,
           'precision50': 0.7527089,
           'recall50': 0.43041426},
     'global': {'total_loss': 0.7844764},
     'learning_rate': 0.009470752,
     'training_loss': 0.7844764}
train | step:  55000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.65045077,
           'avg_obj': 0.18064053,
           'box_loss': 0.012931692,
           'class_loss': 0.0060547506,
           'conf_loss': 0.013374207,
           'precision50': 0.337978,
           'recall50': 0.08522645},
     '4': {'avg_iou': 0.740208,
           'avg_obj': 0.30148664,
           'box_loss': 0.011224483,
           'class_loss': 0.0057668197,
           'conf_loss': 0.016494108,
           'precision50': 0.6069418,
           'recall50': 0.2429226},
     '5': {'avg_iou': 0.7939724,
           'avg_obj': 0.42453775,
           'box_loss': 0.009604383,
           'class_loss': 0.0054076007,
           'conf_loss': 0.016042866,
           'precision50': 0.7563768,
           'recall50': 0.4395227},
     'global': {'total_loss': 0.7752085},
     'learning_rate': 0.0093452055,
     'training_loss': 0.7752085}
train | step:  60000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.65263283,
           'avg_obj': 0.18522954,
           'box_loss': 0.012809184,
           'class_loss': 0.0058722147,
           'conf_loss': 0.013225032,
           'precision50': 0.3443012,
           'recall50': 0.089582376},
     '4': {'avg_iou': 0.74408484,
           'avg_obj': 0.30761454,
           'box_loss': 0.011032384,
           'class_loss': 0.0055890554,
           'conf_loss': 0.016318081,
           'precision50': 0.6123985,
           'recall50': 0.25106403},
     '5': {'avg_iou': 0.79752547,
           'avg_obj': 0.43080336,
           'box_loss': 0.009421372,
           'class_loss': 0.0052597164,
           'conf_loss': 0.015871711,
           'precision50': 0.7588004,
           'recall50': 0.4479016},
     'global': {'total_loss': 0.7631905},
     'learning_rate': 0.009207607,
     'training_loss': 0.7631905}
train | step:  65000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6561324,
           'avg_obj': 0.18846588,
           'box_loss': 0.012709333,
           'class_loss': 0.0057840054,
           'conf_loss': 0.013169679,
           'precision50': 0.34855255,
           'recall50': 0.092172176},
     '4': {'avg_iou': 0.7463448,
           'avg_obj': 0.3123833,
           'box_loss': 0.010951365,
           'class_loss': 0.0054756324,
           'conf_loss': 0.016197233,
           'precision50': 0.6153042,
           'recall50': 0.256826},
     '5': {'avg_iou': 0.8010776,
           'avg_obj': 0.4374528,
           'box_loss': 0.009256865,
           'class_loss': 0.0051180185,
           'conf_loss': 0.015734218,
           'precision50': 0.7616251,
           'recall50': 0.45689833},
     'global': {'total_loss': 0.755169},
     'learning_rate': 0.009109423,
     'training_loss': 0.755169}
saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-65000.
 eval | step:  65000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=180.55s).
Accumulating evaluation results...
DONE (t=17.29s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.386
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.585
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.414
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.134
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.334
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.512
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.316
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.521
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.568
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.284
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.545
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.686
 eval | step:  65000 | eval time:  505.4 sec | output: 
    {'3': {'avg_iou': 0.44168824,
           'avg_obj': 0.16025431,
           'box_loss': 0.0077293776,
           'class_loss': 0.0027220256,
           'conf_loss': 0.0059075137,
           'precision50': 0.15058099,
           'recall50': 0.14080088},
     '4': {'avg_iou': 0.66508704,
           'avg_obj': 0.34391642,
           'box_loss': 0.008181237,
           'class_loss': 0.0031044555,
           'conf_loss': 0.007803135,
           'precision50': 0.25192842,
           'recall50': 0.36025193},
     '5': {'avg_iou': 0.8158555,
           'avg_obj': 0.5238603,
           'box_loss': 0.0076011606,
           'class_loss': 0.0030889194,
           'conf_loss': 0.008964165,
           'precision50': 0.31897724,
           'recall50': 0.5845706},
     'AP': 0.38600895,
     'AP50': 0.5853567,
     'AP75': 0.41390014,
     'APl': 0.5120406,
     'APm': 0.33407903,
     'APs': 0.13394417,
     'ARl': 0.6860174,
     'ARm': 0.5449389,
     'ARmax1': 0.3164654,
     'ARmax10': 0.52078384,
     'ARmax100': 0.5682326,
     'ARs': 0.28423914,
     'global': {'total_loss': 0.055101965},
     'validation_loss': 0.055101965}I0410 08:37:48.263819 140640048215872 controller.py:211] train | step:  65000 | training until step 85000...
I0410 09:11:05.528631 140640048215872 controller.py:425] train | step:  70000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.65769935,
           'avg_obj': 0.1924124,
           'box_loss': 0.012639176,
           'class_loss': 0.0056465436,
           'conf_loss': 0.013160419,
           'precision50': 0.35660064,
           'recall50': 0.09590414},
     '4': {'avg_iou': 0.74997747,
           'avg_obj': 0.3181665,
           'box_loss': 0.010768478,
           'class_loss': 0.005328159,
           'conf_loss': 0.016132772,
           'precision50': 0.6201899,
           'recall50': 0.26423293},
     '5': {'avg_iou': 0.80337703,
           'avg_obj': 0.44286704,
           'box_loss': 0.009138451,
           'class_loss': 0.004988391,
           'conf_loss': 0.015648432,
           'precision50': 0.7642099,
           'recall50': 0.46410367},
     'global': {'total_loss': 0.74760705},
     'learning_rate': 0.008952862,
     'training_loss': 0.74760705}
I0410 09:42:54.042034 140640048215872 controller.py:425] train | step:  75000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.65986156,
           'avg_obj': 0.19525515,
           'box_loss': 0.01253181,
           'class_loss': 0.0055503505,
           'conf_loss': 0.013055084,
           'precision50': 0.35969296,
           'recall50': 0.09857907},
     '4': {'avg_iou': 0.7528153,
           'avg_obj': 0.32242957,
           'box_loss': 0.010659156,
           'class_loss': 0.0052200635,
           'conf_loss': 0.016033988,
           'precision50': 0.6227972,
           'recall50': 0.2694474},
     '5': {'avg_iou': 0.80626994,
           'avg_obj': 0.44777822,
           'box_loss': 0.008996117,
           'class_loss': 0.0048796916,
           'conf_loss': 0.015540634,
           'precision50': 0.7669733,
           'recall50': 0.4709546},
     'global': {'total_loss': 0.7397346},
     'learning_rate': 0.008785662,
     'training_loss': 0.7397346}
I0410 10:14:45.690966 140640048215872 controller.py:425] train | step:  80000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6631509,
           'avg_obj': 0.19911374,
           'box_loss': 0.012419796,
           'class_loss': 0.0054584793,
           'conf_loss': 0.013014514,
           'precision50': 0.36353725,
           'recall50': 0.10093019},
     '4': {'avg_iou': 0.75468314,
           'avg_obj': 0.3267891,
           'box_loss': 0.0105620595,
           'class_loss': 0.00511067,
           'conf_loss': 0.015954884,
           'precision50': 0.626024,
           'recall50': 0.2750456},
     '5': {'avg_iou': 0.8086506,
           'avg_obj': 0.45236528,
           'box_loss': 0.00887238,
           'class_loss': 0.0047844397,
           'conf_loss': 0.01543782,
           'precision50': 0.76868355,
           'recall50': 0.47719952},
     'global': {'total_loss': 0.7329197},
     'learning_rate': 0.008668582,
     'training_loss': 0.7329197}
I0410 10:47:34.465636 140640048215872 controller.py:425] train | step:  85000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.66477615,
           'avg_obj': 0.20228203,
           'box_loss': 0.012392648,
           'class_loss': 0.0053536417,
           'conf_loss': 0.012961531,
           'precision50': 0.36798128,
           'recall50': 0.10370162},
     '4': {'avg_iou': 0.7576384,
           'avg_obj': 0.33145082,
           'box_loss': 0.010428031,
           'class_loss': 0.0049980776,
           'conf_loss': 0.015858907,
           'precision50': 0.6290646,
           'recall50': 0.28025565},
     '5': {'avg_iou': 0.8112982,
           'avg_obj': 0.45774928,
           'box_loss': 0.008752943,
           'class_loss': 0.0046903323,
           'conf_loss': 0.015335387,
           'precision50': 0.77174586,
           'recall50': 0.48421997},
     'global': {'total_loss': 0.72617316},
     'learning_rate': 0.008485009,
     'training_loss': 0.72617316}
I0410 10:48:24.131512 140640048215872 controller.py:455] saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-85000.
I0410 10:48:24.137820 140640048215872 controller.py:252]  eval | step:  85000 | running 625 steps of evaluation...
I0410 10:52:49.160300 140640048215872 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0410 10:57:04.350219 140640048215872 controller.py:261]  eval | step:  85000 | eval time:  520.2 sec | output: 
    {'3': {'avg_iou': 0.4439918,
           'avg_obj': 0.16601284,
           'box_loss': 0.0076142633,
           'class_loss': 0.0026325996,
           'conf_loss': 0.0059111724,
           'precision50': 0.15095183,
           'recall50': 0.14989947},
     '4': {'avg_iou': 0.6683658,
           'avg_obj': 0.35571215,
           'box_loss': 0.008017614,
           'class_loss': 0.00296152,
           'conf_loss': 0.00785735,
           'precision50': 0.25154367,
           'recall50': 0.3771084},
     '5': {'avg_iou': 0.81967187,
           'avg_obj': 0.53815997,
           'box_loss': 0.0074117896,
           'class_loss': 0.0029444627,
           'conf_loss': 0.009073653,
           'precision50': 0.31634837,
           'recall50': 0.59867156},
     'AP': 0.39774722,
     'AP50': 0.5964975,
     'AP75': 0.42915767,
     'APl': 0.5267676,
     'APm': 0.3462161,
     'APs': 0.14222464,
     'ARl': 0.6971292,
     'ARm': 0.5551339,
     'ARmax1': 0.32457745,
     'ARmax10': 0.52855927,
     'ARmax100': 0.5764878,
     'ARs': 0.29256105,
     'global': {'total_loss': 0.054424427},
     'validation_loss': 0.054424427}
I0410 10:57:25.142125 140640048215872 controller.py:211] train | step:  85000 | training until step 105000...
I0410 11:27:39.862221 140640048215872 controller.py:425] train | step:  90000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.66615546,
           'avg_obj': 0.20414655,
           'box_loss': 0.012320919,
           'class_loss': 0.005265246,
           'conf_loss': 0.012900052,
           'precision50': 0.37115362,
           'recall50': 0.10587475},
     '4': {'avg_iou': 0.75897264,
           'avg_obj': 0.33481053,
           'box_loss': 0.010373044,
           'class_loss': 0.0049134204,
           'conf_loss': 0.01575784,
           'precision50': 0.6304579,
           'recall50': 0.28450593},
     '5': {'avg_iou': 0.8134227,
           'avg_obj': 0.46190557,
           'box_loss': 0.008641299,
           'class_loss': 0.004597348,
           'conf_loss': 0.015230709,
           'precision50': 0.7722593,
           'recall50': 0.4886857},
     'global': {'total_loss': 0.7199982},
     'learning_rate': 0.008292484,
     'training_loss': 0.7199982}
I0410 12:00:38.548188 140640048215872 controller.py:425] train | step:  95000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6679392,
           'avg_obj': 0.20744167,
           'box_loss': 0.012213569,
           'class_loss': 0.005175875,
           'conf_loss': 0.012812021,
           'precision50': 0.373296,
           'recall50': 0.10835629},
     '4': {'avg_iou': 0.7614645,
           'avg_obj': 0.3392681,
           'box_loss': 0.010232195,
           'class_loss': 0.004817613,
           'conf_loss': 0.015632788,
           'precision50': 0.63347495,
           'recall50': 0.29019663},
     '5': {'avg_iou': 0.81571275,
           'avg_obj': 0.4660906,
           'box_loss': 0.00852433,
           'class_loss': 0.004508263,
           'conf_loss': 0.015096486,
           'precision50': 0.77525806,
           'recall50': 0.49489078},
     'global': {'total_loss': 0.71210533},
     'learning_rate': 0.0081595015,
     'training_loss': 0.71210533}
I0410 12:33:09.764880 140640048215872 controller.py:425] train | step:  100000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6696197,
           'avg_obj': 0.2102024,
           'box_loss': 0.012162478,
           'class_loss': 0.0051115714,
           'conf_loss': 0.012768972,
           'precision50': 0.37807086,
           'recall50': 0.111081325},
     '4': {'avg_iou': 0.7634342,
           'avg_obj': 0.34305266,
           'box_loss': 0.010161119,
           'class_loss': 0.0047391825,
           'conf_loss': 0.015560748,
           'precision50': 0.63506186,
           'recall50': 0.2943867},
     '5': {'avg_iou': 0.81769425,
           'avg_obj': 0.47020075,
           'box_loss': 0.008427491,
           'class_loss': 0.0044254777,
           'conf_loss': 0.015002389,
           'precision50': 0.7763974,
           'recall50': 0.4999062},
     'global': {'total_loss': 0.706876},
     'learning_rate': 0.007953611,
     'training_loss': 0.706876}

train | step:  65000 | training until step 85000...
train | step:  70000 | steps/sec:    1.9 | output: 
    {'3': {'avg_iou': 0.65769935,
           'avg_obj': 0.1924124,
           'box_loss': 0.012639176,
           'class_loss': 0.0056465436,
           'conf_loss': 0.013160419,
           'precision50': 0.35660064,
           'recall50': 0.09590414},
     '4': {'avg_iou': 0.74997747,
           'avg_obj': 0.3181665,
           'box_loss': 0.010768478,
           'class_loss': 0.005328159,
           'conf_loss': 0.016132772,
           'precision50': 0.6201899,
           'recall50': 0.26423293},
     '5': {'avg_iou': 0.80337703,
           'avg_obj': 0.44286704,
           'box_loss': 0.009138451,
           'class_loss': 0.004988391,
           'conf_loss': 0.015648432,
           'precision50': 0.7642099,
           'recall50': 0.46410367},
     'global': {'total_loss': 0.74760705},
     'learning_rate': 0.008952862,
     'training_loss': 0.74760705}
train | step:  75000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.65986156,
           'avg_obj': 0.19525515,
           'box_loss': 0.01253181,
           'class_loss': 0.0055503505,
           'conf_loss': 0.013055084,
           'precision50': 0.35969296,
           'recall50': 0.09857907},
     '4': {'avg_iou': 0.7528153,
           'avg_obj': 0.32242957,
           'box_loss': 0.010659156,
           'class_loss': 0.0052200635,
           'conf_loss': 0.016033988,
           'precision50': 0.6227972,
           'recall50': 0.2694474},
     '5': {'avg_iou': 0.80626994,
           'avg_obj': 0.44777822,
           'box_loss': 0.008996117,
           'class_loss': 0.0048796916,
           'conf_loss': 0.015540634,
           'precision50': 0.7669733,
           'recall50': 0.4709546},
     'global': {'total_loss': 0.7397346},
     'learning_rate': 0.008785662,
     'training_loss': 0.7397346}
train | step:  80000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6631509,
           'avg_obj': 0.19911374,
           'box_loss': 0.012419796,
           'class_loss': 0.0054584793,
           'conf_loss': 0.013014514,
           'precision50': 0.36353725,
           'recall50': 0.10093019},
     '4': {'avg_iou': 0.75468314,
           'avg_obj': 0.3267891,
           'box_loss': 0.0105620595,
           'class_loss': 0.00511067,
           'conf_loss': 0.015954884,
           'precision50': 0.626024,
           'recall50': 0.2750456},
     '5': {'avg_iou': 0.8086506,
           'avg_obj': 0.45236528,
           'box_loss': 0.00887238,
           'class_loss': 0.0047844397,
           'conf_loss': 0.01543782,
           'precision50': 0.76868355,
           'recall50': 0.47719952},
     'global': {'total_loss': 0.7329197},
     'learning_rate': 0.008668582,
     'training_loss': 0.7329197}
train | step:  85000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.66477615,
           'avg_obj': 0.20228203,
           'box_loss': 0.012392648,
           'class_loss': 0.0053536417,
           'conf_loss': 0.012961531,
           'precision50': 0.36798128,
           'recall50': 0.10370162},
     '4': {'avg_iou': 0.7576384,
           'avg_obj': 0.33145082,
           'box_loss': 0.010428031,
           'class_loss': 0.0049980776,
           'conf_loss': 0.015858907,
           'precision50': 0.6290646,
           'recall50': 0.28025565},
     '5': {'avg_iou': 0.8112982,
           'avg_obj': 0.45774928,
           'box_loss': 0.008752943,
           'class_loss': 0.0046903323,
           'conf_loss': 0.015335387,
           'precision50': 0.77174586,
           'recall50': 0.48421997},
     'global': {'total_loss': 0.72617316},
     'learning_rate': 0.008485009,
     'training_loss': 0.72617316}
saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-85000.
 eval | step:  85000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=185.05s).
Accumulating evaluation results...
DONE (t=15.41s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.398
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.596
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.429
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.142
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.346
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.527
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.325
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.529
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.576
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.293
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.555
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.697
 eval | step:  85000 | eval time:  520.2 sec | output: 
    {'3': {'avg_iou': 0.4439918,
           'avg_obj': 0.16601284,
           'box_loss': 0.0076142633,
           'class_loss': 0.0026325996,
           'conf_loss': 0.0059111724,
           'precision50': 0.15095183,
           'recall50': 0.14989947},
     '4': {'avg_iou': 0.6683658,
           'avg_obj': 0.35571215,
           'box_loss': 0.008017614,
           'class_loss': 0.00296152,
           'conf_loss': 0.00785735,
           'precision50': 0.25154367,
           'recall50': 0.3771084},
     '5': {'avg_iou': 0.81967187,
           'avg_obj': 0.53815997,
           'box_loss': 0.0074117896,
           'class_loss': 0.0029444627,
           'conf_loss': 0.009073653,
           'precision50': 0.31634837,
           'recall50': 0.59867156},
     'AP': 0.39774722,
     'AP50': 0.5964975,
     'AP75': 0.42915767,
     'APl': 0.5267676,
     'APm': 0.3462161,
     'APs': 0.14222464,
     'ARl': 0.6971292,
     'ARm': 0.5551339,
     'ARmax1': 0.32457745,
     'ARmax10': 0.52855927,
     'ARmax100': 0.5764878,
     'ARs': 0.29256105,
     'global': {'total_loss': 0.054424427},
     'validation_loss': 0.054424427}
train | step:  85000 | training until step 105000...
train | step:  90000 | steps/sec:    2.1 | output: 
    {'3': {'avg_iou': 0.66615546,
           'avg_obj': 0.20414655,
           'box_loss': 0.012320919,
           'class_loss': 0.005265246,
           'conf_loss': 0.012900052,
           'precision50': 0.37115362,
           'recall50': 0.10587475},
     '4': {'avg_iou': 0.75897264,
           'avg_obj': 0.33481053,
           'box_loss': 0.010373044,
           'class_loss': 0.0049134204,
           'conf_loss': 0.01575784,
           'precision50': 0.6304579,
           'recall50': 0.28450593},
     '5': {'avg_iou': 0.8134227,
           'avg_obj': 0.46190557,
           'box_loss': 0.008641299,
           'class_loss': 0.004597348,
           'conf_loss': 0.015230709,
           'precision50': 0.7722593,
           'recall50': 0.4886857},
     'global': {'total_loss': 0.7199982},
     'learning_rate': 0.008292484,
     'training_loss': 0.7199982}
train | step:  95000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6679392,
           'avg_obj': 0.20744167,
           'box_loss': 0.012213569,
           'class_loss': 0.005175875,
           'conf_loss': 0.012812021,
           'precision50': 0.373296,
           'recall50': 0.10835629},
     '4': {'avg_iou': 0.7614645,
           'avg_obj': 0.3392681,
           'box_loss': 0.010232195,
           'class_loss': 0.004817613,
           'conf_loss': 0.015632788,
           'precision50': 0.63347495,
           'recall50': 0.29019663},
     '5': {'avg_iou': 0.81571275,
           'avg_obj': 0.4660906,
           'box_loss': 0.00852433,
           'class_loss': 0.004508263,
           'conf_loss': 0.015096486,
           'precision50': 0.77525806,
           'recall50': 0.49489078},
     'global': {'total_loss': 0.71210533},
     'learning_rate': 0.0081595015,
     'training_loss': 0.71210533}
train | step:  100000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6696197,
           'avg_obj': 0.2102024,
           'box_loss': 0.012162478,
           'class_loss': 0.0051115714,
           'conf_loss': 0.012768972,
           'precision50': 0.37807086,
           'recall50': 0.111081325},
     '4': {'avg_iou': 0.7634342,
           'avg_obj': 0.34305266,
           'box_loss': 0.010161119,
           'class_loss': 0.0047391825,
           'conf_loss': 0.015560748,
           'precision50': 0.63506186,
           'recall50': 0.2943867},
     '5': {'avg_iou': 0.81769425,
           'avg_obj': 0.47020075,
           'box_loss': 0.008427491,
           'class_loss': 0.0044254777,
           'conf_loss': 0.015002389,
           'precision50': 0.7763974,
           'recall50': 0.4999062},
     'global': {'total_loss': 0.706876},
     'learning_rate': 0.007953611,
     'training_loss': 0.706876}I0410 13:05:42.250195 140640048215872 controller.py:425] train | step:  105000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.67152375,
           'avg_obj': 0.21270354,
           'box_loss': 0.012110847,
           'class_loss': 0.0050641424,
           'conf_loss': 0.012764524,
           'precision50': 0.38120547,
           'recall50': 0.11322566},
     '4': {'avg_iou': 0.7657658,
           'avg_obj': 0.34673935,
           'box_loss': 0.010065552,
           'class_loss': 0.0046820254,
           'conf_loss': 0.015552324,
           'precision50': 0.6373195,
           'recall50': 0.2985151},
     '5': {'avg_iou': 0.819113,
           'avg_obj': 0.47390082,
           'box_loss': 0.008359826,
           'class_loss': 0.0043554916,
           'conf_loss': 0.014982675,
           'precision50': 0.7778776,
           'recall50': 0.5044132},
     'global': {'total_loss': 0.7034992},
     'learning_rate': 0.007740684,
     'training_loss': 0.7034992}
I0410 13:06:31.221618 140640048215872 controller.py:455] saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-105000.
I0410 13:06:31.229082 140640048215872 controller.py:252]  eval | step:  105000 | running 625 steps of evaluation...
I0410 13:10:59.787433 140640048215872 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0410 13:15:02.684402 140640048215872 controller.py:261]  eval | step:  105000 | eval time:  511.5 sec | output: 
    {'3': {'avg_iou': 0.44551602,
           'avg_obj': 0.17087302,
           'box_loss': 0.0075379442,
           'class_loss': 0.0025960503,
           'conf_loss': 0.005938327,
           'precision50': 0.15122664,
           'recall50': 0.15588875},
     '4': {'avg_iou': 0.6700519,
           'avg_obj': 0.36441424,
           'box_loss': 0.007933196,
           'class_loss': 0.0028905566,
           'conf_loss': 0.007926506,
           'precision50': 0.24819209,
           'recall50': 0.38741985},
     '5': {'avg_iou': 0.82181877,
           'avg_obj': 0.55184907,
           'box_loss': 0.007304895,
           'class_loss': 0.0028295955,
           'conf_loss': 0.009207601,
           'precision50': 0.31286907,
           'recall50': 0.6143969},
     'AP': 0.40519822,
     'AP50': 0.604102,
     'AP75': 0.43699136,
     'APl': 0.53562456,
     'APm': 0.35291436,
     'APs': 0.14474913,
     'ARl': 0.7053817,
     'ARm': 0.55989844,
     'ARmax1': 0.3289388,
     'ARmax10': 0.5370049,
     'ARmax100': 0.5838364,
     'ARs': 0.29844442,
     'global': {'total_loss': 0.054164678},
     'validation_loss': 0.054164678}
I0410 13:15:23.948030 140640048215872 controller.py:211] train | step:  105000 | training until step 125000...
I0410 13:43:53.231877 140640048215872 controller.py:425] train | step:  110000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6728739,
           'avg_obj': 0.2148366,
           'box_loss': 0.012041843,
           'class_loss': 0.004971641,
           'conf_loss': 0.012712582,
           'precision50': 0.38375047,
           'recall50': 0.115378},
     '4': {'avg_iou': 0.7668717,
           'avg_obj': 0.34983352,
           'box_loss': 0.010004536,
           'class_loss': 0.004602647,
           'conf_loss': 0.015409972,
           'precision50': 0.63955754,
           'recall50': 0.30252042},
     '5': {'avg_iou': 0.8209753,
           'avg_obj': 0.4775337,
           'box_loss': 0.008274733,
           'class_loss': 0.0042914962,
           'conf_loss': 0.014850873,
           'precision50': 0.7798304,
           'recall50': 0.5090702},
     'global': {'total_loss': 0.697282},
     'learning_rate': 0.0075951996,
     'training_loss': 0.697282}
I0410 14:16:33.663889 140640048215872 controller.py:425] train | step:  115000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.67376816,
           'avg_obj': 0.21715896,
           'box_loss': 0.012005601,
           'class_loss': 0.00491894,
           'conf_loss': 0.012617454,
           'precision50': 0.38645968,
           'recall50': 0.11728529},
     '4': {'avg_iou': 0.7686054,
           'avg_obj': 0.3532102,
           'box_loss': 0.009923359,
           'class_loss': 0.0045400783,
           'conf_loss': 0.015339885,
           'precision50': 0.6427147,
           'recall50': 0.30671108},
     '5': {'avg_iou': 0.823133,
           'avg_obj': 0.4816418,
           'box_loss': 0.008168302,
           'class_loss': 0.004231623,
           'conf_loss': 0.014772992,
           'precision50': 0.7815054,
           'recall50': 0.5145181},
     'global': {'total_loss': 0.6921459},
     'learning_rate': 0.007372258,
     'training_loss': 0.6921459}
I0410 14:49:35.108701 140640048215872 controller.py:425] train | step:  120000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.67598784,
           'avg_obj': 0.2201437,
           'box_loss': 0.011922684,
           'class_loss': 0.004843682,
           'conf_loss': 0.012588966,
           'precision50': 0.3892183,
           'recall50': 0.11943903},
     '4': {'avg_iou': 0.7701629,
           'avg_obj': 0.35642815,
           'box_loss': 0.009854897,
           'class_loss': 0.004474098,
           'conf_loss': 0.015289706,
           'precision50': 0.64356023,
           'recall50': 0.31035134},
     '5': {'avg_iou': 0.82444453,
           'avg_obj': 0.484889,
           'box_loss': 0.008103651,
           'class_loss': 0.004177359,
           'conf_loss': 0.014702955,
           'precision50': 0.7824223,
           'recall50': 0.518204},
     'global': {'total_loss': 0.68766475},
     'learning_rate': 0.0071443724,
     'training_loss': 0.68766475}
I0410 15:23:05.177611 140640048215872 controller.py:425] train | step:  125000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6771727,
           'avg_obj': 0.22264454,
           'box_loss': 0.011900374,
           'class_loss': 0.004805726,
           'conf_loss': 0.012582031,
           'precision50': 0.39352557,
           'recall50': 0.12221336},
     '4': {'avg_iou': 0.7717514,
           'avg_obj': 0.35935292,
           'box_loss': 0.009800116,
           'class_loss': 0.0044038417,
           'conf_loss': 0.01523895,
           'precision50': 0.6464795,
           'recall50': 0.31423357},
     '5': {'avg_iou': 0.8259317,
           'avg_obj': 0.48756817,
           'box_loss': 0.0080302665,
           'class_loss': 0.004106305,
           'conf_loss': 0.014649592,
           'precision50': 0.7831902,
           'recall50': 0.5214495},
     'global': {'total_loss': 0.68413836},
     'learning_rate': 0.0069901072,
     'training_loss': 0.68413836}
I0410 15:23:52.160576 140640048215872 controller.py:455] saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-125000.
I0410 15:23:52.167916 140640048215872 controller.py:252]  eval | step:  125000 | running 625 steps of evaluation...
I0410 15:28:22.312957 140640048215872 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.

train | step:  105000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.67152375,
           'avg_obj': 0.21270354,
           'box_loss': 0.012110847,
           'class_loss': 0.0050641424,
           'conf_loss': 0.012764524,
           'precision50': 0.38120547,
           'recall50': 0.11322566},
     '4': {'avg_iou': 0.7657658,
           'avg_obj': 0.34673935,
           'box_loss': 0.010065552,
           'class_loss': 0.0046820254,
           'conf_loss': 0.015552324,
           'precision50': 0.6373195,
           'recall50': 0.2985151},
     '5': {'avg_iou': 0.819113,
           'avg_obj': 0.47390082,
           'box_loss': 0.008359826,
           'class_loss': 0.0043554916,
           'conf_loss': 0.014982675,
           'precision50': 0.7778776,
           'recall50': 0.5044132},
     'global': {'total_loss': 0.7034992},
     'learning_rate': 0.007740684,
     'training_loss': 0.7034992}
saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-105000.
 eval | step:  105000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=180.59s).
Accumulating evaluation results...
DONE (t=14.67s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.405
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.604
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.437
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.145
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.353
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.536
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.329
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.537
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.584
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.298
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.560
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.705
 eval | step:  105000 | eval time:  511.5 sec | output: 
    {'3': {'avg_iou': 0.44551602,
           'avg_obj': 0.17087302,
           'box_loss': 0.0075379442,
           'class_loss': 0.0025960503,
           'conf_loss': 0.005938327,
           'precision50': 0.15122664,
           'recall50': 0.15588875},
     '4': {'avg_iou': 0.6700519,
           'avg_obj': 0.36441424,
           'box_loss': 0.007933196,
           'class_loss': 0.0028905566,
           'conf_loss': 0.007926506,
           'precision50': 0.24819209,
           'recall50': 0.38741985},
     '5': {'avg_iou': 0.82181877,
           'avg_obj': 0.55184907,
           'box_loss': 0.007304895,
           'class_loss': 0.0028295955,
           'conf_loss': 0.009207601,
           'precision50': 0.31286907,
           'recall50': 0.6143969},
     'AP': 0.40519822,
     'AP50': 0.604102,
     'AP75': 0.43699136,
     'APl': 0.53562456,
     'APm': 0.35291436,
     'APs': 0.14474913,
     'ARl': 0.7053817,
     'ARm': 0.55989844,
     'ARmax1': 0.3289388,
     'ARmax10': 0.5370049,
     'ARmax100': 0.5838364,
     'ARs': 0.29844442,
     'global': {'total_loss': 0.054164678},
     'validation_loss': 0.054164678}
train | step:  105000 | training until step 125000...
train | step:  110000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6728739,
           'avg_obj': 0.2148366,
           'box_loss': 0.012041843,
           'class_loss': 0.004971641,
           'conf_loss': 0.012712582,
           'precision50': 0.38375047,
           'recall50': 0.115378},
     '4': {'avg_iou': 0.7668717,
           'avg_obj': 0.34983352,
           'box_loss': 0.010004536,
           'class_loss': 0.004602647,
           'conf_loss': 0.015409972,
           'precision50': 0.63955754,
           'recall50': 0.30252042},
     '5': {'avg_iou': 0.8209753,
           'avg_obj': 0.4775337,
           'box_loss': 0.008274733,
           'class_loss': 0.0042914962,
           'conf_loss': 0.014850873,
           'precision50': 0.7798304,
           'recall50': 0.5090702},
     'global': {'total_loss': 0.697282},
     'learning_rate': 0.0075951996,
     'training_loss': 0.697282}
train | step:  115000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.67376816,
           'avg_obj': 0.21715896,
           'box_loss': 0.012005601,
           'class_loss': 0.00491894,
           'conf_loss': 0.012617454,
           'precision50': 0.38645968,
           'recall50': 0.11728529},
     '4': {'avg_iou': 0.7686054,
           'avg_obj': 0.3532102,
           'box_loss': 0.009923359,
           'class_loss': 0.0045400783,
           'conf_loss': 0.015339885,
           'precision50': 0.6427147,
           'recall50': 0.30671108},
     '5': {'avg_iou': 0.823133,
           'avg_obj': 0.4816418,
           'box_loss': 0.008168302,
           'class_loss': 0.004231623,
           'conf_loss': 0.014772992,
           'precision50': 0.7815054,
           'recall50': 0.5145181},
     'global': {'total_loss': 0.6921459},
     'learning_rate': 0.007372258,
     'training_loss': 0.6921459}
train | step:  120000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.67598784,
           'avg_obj': 0.2201437,
           'box_loss': 0.011922684,
           'class_loss': 0.004843682,
           'conf_loss': 0.012588966,
           'precision50': 0.3892183,
           'recall50': 0.11943903},
     '4': {'avg_iou': 0.7701629,
           'avg_obj': 0.35642815,
           'box_loss': 0.009854897,
           'class_loss': 0.004474098,
           'conf_loss': 0.015289706,
           'precision50': 0.64356023,
           'recall50': 0.31035134},
     '5': {'avg_iou': 0.82444453,
           'avg_obj': 0.484889,
           'box_loss': 0.008103651,
           'class_loss': 0.004177359,
           'conf_loss': 0.014702955,
           'precision50': 0.7824223,
           'recall50': 0.518204},
     'global': {'total_loss': 0.68766475},
     'learning_rate': 0.0071443724,
     'training_loss': 0.68766475}
train | step:  125000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6771727,
           'avg_obj': 0.22264454,
           'box_loss': 0.011900374,
           'class_loss': 0.004805726,
           'conf_loss': 0.012582031,
           'precision50': 0.39352557,
           'recall50': 0.12221336},
     '4': {'avg_iou': 0.7717514,
           'avg_obj': 0.35935292,
           'box_loss': 0.009800116,
           'class_loss': 0.0044038417,
           'conf_loss': 0.01523895,
           'precision50': 0.6464795,
           'recall50': 0.31423357},
     '5': {'avg_iou': 0.8259317,
           'avg_obj': 0.48756817,
           'box_loss': 0.0080302665,
           'class_loss': 0.004106305,
           'conf_loss': 0.014649592,
           'precision50': 0.7831902,
           'recall50': 0.5214495},
     'global': {'total_loss': 0.68413836},
     'learning_rate': 0.0069901072,
     'training_loss': 0.68413836}
saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-125000.
 eval | step:  125000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=183.61s).
Accumulating evaluation results...
DONE (t=14.51s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.409
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.608
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.441
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.143
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.357
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.540
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.331
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.538
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.586
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.298I0410 15:32:39.346206 140640048215872 controller.py:261]  eval | step:  125000 | eval time:  527.2 sec | output: 
    {'3': {'avg_iou': 0.44636762,
           'avg_obj': 0.17432006,
           'box_loss': 0.007494605,
           'class_loss': 0.00251152,
           'conf_loss': 0.0059622317,
           'precision50': 0.15360431,
           'recall50': 0.16325954},
     '4': {'avg_iou': 0.67170286,
           'avg_obj': 0.36979145,
           'box_loss': 0.007849869,
           'class_loss': 0.0028148782,
           'conf_loss': 0.007985522,
           'precision50': 0.2459793,
           'recall50': 0.39548713},
     '5': {'avg_iou': 0.82280225,
           'avg_obj': 0.55772287,
           'box_loss': 0.0072565675,
           'class_loss': 0.0027649764,
           'conf_loss': 0.00928082,
           'precision50': 0.3096019,
           'recall50': 0.6171724},
     'AP': 0.40909705,
     'AP50': 0.6076559,
     'AP75': 0.44094697,
     'APl': 0.54041356,
     'APm': 0.35705364,
     'APs': 0.14330725,
     'ARl': 0.70505106,
     'ARm': 0.5643879,
     'ARmax1': 0.33068475,
     'ARmax10': 0.5384308,
     'ARmax100': 0.58564776,
     'ARs': 0.2984849,
     'global': {'total_loss': 0.053920977},
     'validation_loss': 0.053920977}
I0410 15:32:56.084422 140640048215872 controller.py:211] train | step:  125000 | training until step 145000...
I0410 16:00:31.095798 140640048215872 controller.py:425] train | step:  130000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6787754,
           'avg_obj': 0.22494362,
           'box_loss': 0.0118104825,
           'class_loss': 0.00474036,
           'conf_loss': 0.012524979,
           'precision50': 0.39404926,
           'recall50': 0.12384132},
     '4': {'avg_iou': 0.7733072,
           'avg_obj': 0.3628198,
           'box_loss': 0.009712531,
           'class_loss': 0.004337358,
           'conf_loss': 0.015151813,
           'precision50': 0.6474894,
           'recall50': 0.31806844},
     '5': {'avg_iou': 0.82725596,
           'avg_obj': 0.49098882,
           'box_loss': 0.007967369,
           'class_loss': 0.0040498497,
           'conf_loss': 0.01454982,
           'precision50': 0.78471273,
           'recall50': 0.5253732},
     'global': {'total_loss': 0.6787563},
     'learning_rate': 0.006755814,
     'training_loss': 0.6787563}
I0410 16:33:54.061772 140640048215872 controller.py:425] train | step:  135000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.679613,
           'avg_obj': 0.22677766,
           'box_loss': 0.011822346,
           'class_loss': 0.0046927235,
           'conf_loss': 0.012505591,
           'precision50': 0.3979617,
           'recall50': 0.12585945},
     '4': {'avg_iou': 0.7745769,
           'avg_obj': 0.36612436,
           'box_loss': 0.009666296,
           'class_loss': 0.0042937137,
           'conf_loss': 0.015111325,
           'precision50': 0.64979124,
           'recall50': 0.32193696},
     '5': {'avg_iou': 0.8287496,
           'avg_obj': 0.49487662,
           'box_loss': 0.007884848,
           'class_loss': 0.003989941,
           'conf_loss': 0.0144752,
           'precision50': 0.7873518,
           'recall50': 0.5308717},
     'global': {'total_loss': 0.6755359},
     'learning_rate': 0.006518798,
     'training_loss': 0.6755359}
I0410 17:05:44.035225 140640048215872 controller.py:425] train | step:  140000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.68114585,
           'avg_obj': 0.22909157,
           'box_loss': 0.011735138,
           'class_loss': 0.0046392814,
           'conf_loss': 0.012409761,
           'precision50': 0.40023795,
           'recall50': 0.1284178},
     '4': {'avg_iou': 0.77626693,
           'avg_obj': 0.3690914,
           'box_loss': 0.009583776,
           'class_loss': 0.0042206156,
           'conf_loss': 0.015022885,
           'precision50': 0.6514065,
           'recall50': 0.32584226},
     '5': {'avg_iou': 0.8303039,
           'avg_obj': 0.49809095,
           'box_loss': 0.0078091864,
           'class_loss': 0.003937481,
           'conf_loss': 0.014375539,
           'precision50': 0.7882007,
           'recall50': 0.53456557},
     'global': {'total_loss': 0.6698703},
     'learning_rate': 0.0063596955,
     'training_loss': 0.6698703}
I0410 17:37:49.779560 140640048215872 controller.py:425] train | step:  145000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.68262005,
           'avg_obj': 0.2315605,
           'box_loss': 0.011673769,
           'class_loss': 0.004587282,
           'conf_loss': 0.012401566,
           'precision50': 0.40243277,
           'recall50': 0.13031085},
     '4': {'avg_iou': 0.77800506,
           'avg_obj': 0.37251616,
           'box_loss': 0.009512061,
           'class_loss': 0.004183395,
           'conf_loss': 0.014965604,
           'precision50': 0.6541698,
           'recall50': 0.32983172},
     '5': {'avg_iou': 0.8317909,
           'avg_obj': 0.5012727,
           'box_loss': 0.0077467253,
           'class_loss': 0.0038782745,
           'conf_loss': 0.014316284,
           'precision50': 0.78991294,
           'recall50': 0.5382971},
     'global': {'total_loss': 0.66611975},
     'learning_rate': 0.006120043,
     'training_loss': 0.66611975}
I0410 17:38:36.876481 140640048215872 controller.py:455] saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-145000.
I0410 17:38:36.884168 140640048215872 controller.py:252]  eval | step:  145000 | running 625 steps of evaluation...
I0410 17:43:08.684649 140640048215872 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0410 17:47:11.603323 140640048215872 controller.py:261]  eval | step:  145000 | eval time:  514.7 sec | output: 
    {'3': {'avg_iou': 0.44683364,
           'avg_obj': 0.17743315,
           'box_loss': 0.0074725626,
           'class_loss': 0.0025024752,
           'conf_loss': 0.005999746,
           'precision50': 0.1529197,
           'recall50': 0.16826229},
     '4': {'avg_iou': 0.67189884,
           'avg_obj': 0.3759057,
           'box_loss': 0.0078404285,
           'class_loss': 0.0028154876,
           'conf_loss': 0.0080733085,
           'precision50': 0.24399717,
           'recall50': 0.4022633},
     '5': {'avg_iou': 0.82371336,
           'avg_obj': 0.56534564,
           'box_loss': 0.0072112097,
           'class_loss': 0.0027495874,
           'conf_loss': 0.009386719,
           'precision50': 0.30929768,
           'recall50': 0.62510574},
     'AP': 0.41119885,
     'AP50': 0.6073361,
     'AP75': 0.44399264,
     'APl': 0.5421837,
     'APm': 0.36346453,
     'APs': 0.14837742,
     'ARl': 0.7067803,
     'ARm': 0.5637881,
     'ARmax1': 0.3336381,
     'ARmax10': 0.5411953,
     'ARmax100': 0.5884343,
     'ARs': 0.30121666,
     'global': {'total_loss': 0.0540515},
     'validation_loss': 0.0540515}
I0410 17:47:27.945421 140640048215872 controller.py:211] train | step:  145000 | training until step 165000...
I0410 18:14:04.423238 140640048215872 controller.py:425] train | step:  150000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.68338585,
           'avg_obj': 0.23355696,
           'box_loss': 0.011670144,
           'class_loss': 0.0045454144,
           'conf_loss': 0.012370443,
           'precision50': 0.40567645,
           'recall50': 0.1320164},
     '4': {'avg_iou': 0.7787916,
           'avg_obj': 0.37472546,
           'box_loss': 0.009477427,
           'class_loss': 0.0041311225,
           'conf_loss': 0.014898809,
           'precision50': 0.6539575,
           'recall50': 0.33227968},
     '5': {'avg_iou': 0.8334721,
           'avg_obj': 0.50427943,
           'box_loss': 0.007654717,
           'class_loss': 0.003831913,
           'conf_loss': 0.014230743,
           'precision50': 0.7899765,
           'recall50': 0.5417601},
     'global': {'total_loss': 0.6624853},
     'learning_rate': 0.0058799568,
     'training_loss': 0.6624853}

 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.564
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.705
 eval | step:  125000 | eval time:  527.2 sec | output: 
    {'3': {'avg_iou': 0.44636762,
           'avg_obj': 0.17432006,
           'box_loss': 0.007494605,
           'class_loss': 0.00251152,
           'conf_loss': 0.0059622317,
           'precision50': 0.15360431,
           'recall50': 0.16325954},
     '4': {'avg_iou': 0.67170286,
           'avg_obj': 0.36979145,
           'box_loss': 0.007849869,
           'class_loss': 0.0028148782,
           'conf_loss': 0.007985522,
           'precision50': 0.2459793,
           'recall50': 0.39548713},
     '5': {'avg_iou': 0.82280225,
           'avg_obj': 0.55772287,
           'box_loss': 0.0072565675,
           'class_loss': 0.0027649764,
           'conf_loss': 0.00928082,
           'precision50': 0.3096019,
           'recall50': 0.6171724},
     'AP': 0.40909705,
     'AP50': 0.6076559,
     'AP75': 0.44094697,
     'APl': 0.54041356,
     'APm': 0.35705364,
     'APs': 0.14330725,
     'ARl': 0.70505106,
     'ARm': 0.5643879,
     'ARmax1': 0.33068475,
     'ARmax10': 0.5384308,
     'ARmax100': 0.58564776,
     'ARs': 0.2984849,
     'global': {'total_loss': 0.053920977},
     'validation_loss': 0.053920977}
train | step:  125000 | training until step 145000...
train | step:  130000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6787754,
           'avg_obj': 0.22494362,
           'box_loss': 0.0118104825,
           'class_loss': 0.00474036,
           'conf_loss': 0.012524979,
           'precision50': 0.39404926,
           'recall50': 0.12384132},
     '4': {'avg_iou': 0.7733072,
           'avg_obj': 0.3628198,
           'box_loss': 0.009712531,
           'class_loss': 0.004337358,
           'conf_loss': 0.015151813,
           'precision50': 0.6474894,
           'recall50': 0.31806844},
     '5': {'avg_iou': 0.82725596,
           'avg_obj': 0.49098882,
           'box_loss': 0.007967369,
           'class_loss': 0.0040498497,
           'conf_loss': 0.01454982,
           'precision50': 0.78471273,
           'recall50': 0.5253732},
     'global': {'total_loss': 0.6787563},
     'learning_rate': 0.006755814,
     'training_loss': 0.6787563}
train | step:  135000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.679613,
           'avg_obj': 0.22677766,
           'box_loss': 0.011822346,
           'class_loss': 0.0046927235,
           'conf_loss': 0.012505591,
           'precision50': 0.3979617,
           'recall50': 0.12585945},
     '4': {'avg_iou': 0.7745769,
           'avg_obj': 0.36612436,
           'box_loss': 0.009666296,
           'class_loss': 0.0042937137,
           'conf_loss': 0.015111325,
           'precision50': 0.64979124,
           'recall50': 0.32193696},
     '5': {'avg_iou': 0.8287496,
           'avg_obj': 0.49487662,
           'box_loss': 0.007884848,
           'class_loss': 0.003989941,
           'conf_loss': 0.0144752,
           'precision50': 0.7873518,
           'recall50': 0.5308717},
     'global': {'total_loss': 0.6755359},
     'learning_rate': 0.006518798,
     'training_loss': 0.6755359}
train | step:  140000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.68114585,
           'avg_obj': 0.22909157,
           'box_loss': 0.011735138,
           'class_loss': 0.0046392814,
           'conf_loss': 0.012409761,
           'precision50': 0.40023795,
           'recall50': 0.1284178},
     '4': {'avg_iou': 0.77626693,
           'avg_obj': 0.3690914,
           'box_loss': 0.009583776,
           'class_loss': 0.0042206156,
           'conf_loss': 0.015022885,
           'precision50': 0.6514065,
           'recall50': 0.32584226},
     '5': {'avg_iou': 0.8303039,
           'avg_obj': 0.49809095,
           'box_loss': 0.0078091864,
           'class_loss': 0.003937481,
           'conf_loss': 0.014375539,
           'precision50': 0.7882007,
           'recall50': 0.53456557},
     'global': {'total_loss': 0.6698703},
     'learning_rate': 0.0063596955,
     'training_loss': 0.6698703}
train | step:  145000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.68262005,
           'avg_obj': 0.2315605,
           'box_loss': 0.011673769,
           'class_loss': 0.004587282,
           'conf_loss': 0.012401566,
           'precision50': 0.40243277,
           'recall50': 0.13031085},
     '4': {'avg_iou': 0.77800506,
           'avg_obj': 0.37251616,
           'box_loss': 0.009512061,
           'class_loss': 0.004183395,
           'conf_loss': 0.014965604,
           'precision50': 0.6541698,
           'recall50': 0.32983172},
     '5': {'avg_iou': 0.8317909,
           'avg_obj': 0.5012727,
           'box_loss': 0.0077467253,
           'class_loss': 0.0038782745,
           'conf_loss': 0.014316284,
           'precision50': 0.78991294,
           'recall50': 0.5382971},
     'global': {'total_loss': 0.66611975},
     'learning_rate': 0.006120043,
     'training_loss': 0.66611975}
saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-145000.
 eval | step:  145000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=178.47s).
Accumulating evaluation results...
DONE (t=13.45s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.411
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.607
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.444
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.148
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.363
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.542
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.334
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.541
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.588
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.301
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.564
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.707
 eval | step:  145000 | eval time:  514.7 sec | output: 
    {'3': {'avg_iou': 0.44683364,
           'avg_obj': 0.17743315,
           'box_loss': 0.0074725626,
           'class_loss': 0.0025024752,
           'conf_loss': 0.005999746,
           'precision50': 0.1529197,
           'recall50': 0.16826229},
     '4': {'avg_iou': 0.67189884,
           'avg_obj': 0.3759057,
           'box_loss': 0.0078404285,
           'class_loss': 0.0028154876,
           'conf_loss': 0.0080733085,
           'precision50': 0.24399717,
           'recall50': 0.4022633},
     '5': {'avg_iou': 0.82371336,
           'avg_obj': 0.56534564,
           'box_loss': 0.0072112097,
           'class_loss': 0.0027495874,
           'conf_loss': 0.009386719,
           'precision50': 0.30929768,
           'recall50': 0.62510574},
     'AP': 0.41119885,
     'AP50': 0.6073361,
     'AP75': 0.44399264,
     'APl': 0.5421837,
     'APm': 0.36346453,
     'APs': 0.14837742,
     'ARl': 0.7067803,
     'ARm': 0.5637881,
     'ARmax1': 0.3336381,
     'ARmax10': 0.5411953,
     'ARmax100': 0.5884343,
     'ARs': 0.30121666,
     'global': {'total_loss': 0.0540515},
     'validation_loss': 0.0540515}
train | step:  145000 | training until step 165000...
train | step:  150000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.68338585,
           'avg_obj': 0.23355696,
           'box_loss': 0.011670144,
           'class_loss': 0.0045454144,
           'conf_loss': 0.012370443,
           'precision50': 0.40567645,
           'recall50': 0.1320164},
     '4': {'avg_iou': 0.7787916,
           'avg_obj': 0.37472546,
           'box_loss': 0.009477427,
           'class_loss': 0.0041311225,
           'conf_loss': 0.014898809,
           'precision50': 0.6539575,
           'recall50': 0.33227968},
     '5': {'avg_iou': 0.8334721,
           'avg_obj': 0.50427943,
           'box_loss': 0.007654717,
           'class_loss': 0.003831913,
           'conf_loss': 0.014230743,
           'precision50': 0.7899765,
           'recall50': 0.5417601},
     'global': {'total_loss': 0.6624853},
     'learning_rate': 0.0058799568,
     'training_loss': 0.6624853}I0410 18:47:27.276966 140640048215872 controller.py:425] train | step:  155000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6844746,
           'avg_obj': 0.23510647,
           'box_loss': 0.011584457,
           'class_loss': 0.004493476,
           'conf_loss': 0.01228983,
           'precision50': 0.4060949,
           'recall50': 0.13321964},
     '4': {'avg_iou': 0.7803523,
           'avg_obj': 0.3773404,
           'box_loss': 0.009381165,
           'class_loss': 0.004064868,
           'conf_loss': 0.014815558,
           'precision50': 0.65475696,
           'recall50': 0.33467105},
     '5': {'avg_iou': 0.8345793,
           'avg_obj': 0.5066537,
           'box_loss': 0.0076024225,
           'class_loss': 0.0037891536,
           'conf_loss': 0.014174643,
           'precision50': 0.7915809,
           'recall50': 0.5444965},
     'global': {'total_loss': 0.6575636},
     'learning_rate': 0.0057200873,
     'training_loss': 0.6575636}
I0410 19:19:29.688606 140640048215872 controller.py:425] train | step:  160000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6854699,
           'avg_obj': 0.23778418,
           'box_loss': 0.011546752,
           'class_loss': 0.0044511314,
           'conf_loss': 0.012296419,
           'precision50': 0.4098953,
           'recall50': 0.13592501},
     '4': {'avg_iou': 0.78107333,
           'avg_obj': 0.38067383,
           'box_loss': 0.009354121,
           'class_loss': 0.0040251818,
           'conf_loss': 0.014779326,
           'precision50': 0.65618384,
           'recall50': 0.338454},
     '5': {'avg_iou': 0.83585745,
           'avg_obj': 0.51095563,
           'box_loss': 0.0075376085,
           'class_loss': 0.0037284752,
           'conf_loss': 0.014081455,
           'precision50': 0.7935665,
           'recall50': 0.54975736},
     'global': {'total_loss': 0.65440357},
     'learning_rate': 0.0054812017,
     'training_loss': 0.65440357}
I0410 19:52:15.004595 140640048215872 controller.py:425] train | step:  165000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6865128,
           'avg_obj': 0.23959394,
           'box_loss': 0.011506004,
           'class_loss': 0.0043970407,
           'conf_loss': 0.012260519,
           'precision50': 0.41226542,
           'recall50': 0.13769042},
     '4': {'avg_iou': 0.7827203,
           'avg_obj': 0.38323423,
           'box_loss': 0.009296356,
           'class_loss': 0.0039772447,
           'conf_loss': 0.014727425,
           'precision50': 0.6601531,
           'recall50': 0.3429234},
     '5': {'avg_iou': 0.8369134,
           'avg_obj': 0.51261777,
           'box_loss': 0.007486986,
           'class_loss': 0.0036926495,
           'conf_loss': 0.014043481,
           'precision50': 0.7941011,
           'recall50': 0.5517944},
     'global': {'total_loss': 0.65110177},
     'learning_rate': 0.0052441857,
     'training_loss': 0.65110177}
I0410 19:53:19.041809 140640048215872 controller.py:455] saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-165000.
I0410 19:53:19.047881 140640048215872 controller.py:252]  eval | step:  165000 | running 625 steps of evaluation...
I0410 19:57:48.280142 140640048215872 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0410 20:01:47.976122 140640048215872 controller.py:261]  eval | step:  165000 | eval time:  508.9 sec | output: 
    {'3': {'avg_iou': 0.44688398,
           'avg_obj': 0.17953646,
           'box_loss': 0.0074702348,
           'class_loss': 0.002507188,
           'conf_loss': 0.006004221,
           'precision50': 0.15413609,
           'recall50': 0.17240442},
     '4': {'avg_iou': 0.67235947,
           'avg_obj': 0.37871012,
           'box_loss': 0.007818,
           'class_loss': 0.002857818,
           'conf_loss': 0.008124855,
           'precision50': 0.24237512,
           'recall50': 0.40649962},
     '5': {'avg_iou': 0.82394725,
           'avg_obj': 0.57028943,
           'box_loss': 0.0072016153,
           'class_loss': 0.0027647067,
           'conf_loss': 0.009508862,
           'precision50': 0.3067631,
           'recall50': 0.62957436},
     'AP': 0.41185775,
     'AP50': 0.6085325,
     'AP75': 0.4432122,
     'APl': 0.5433632,
     'APm': 0.3626703,
     'APs': 0.14996657,
     'ARl': 0.7090444,
     'ARm': 0.56307214,
     'ARmax1': 0.334376,
     'ARmax10': 0.5419634,
     'ARmax100': 0.5887007,
     'ARs': 0.30657613,
     'global': {'total_loss': 0.054257493},
     'validation_loss': 0.054257493}
I0410 20:02:10.121205 140640048215872 controller.py:211] train | step:  165000 | training until step 185000...
I0410 20:28:34.436804 140640048215872 controller.py:425] train | step:  170000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6873366,
           'avg_obj': 0.24120618,
           'box_loss': 0.011516897,
           'class_loss': 0.0043808874,
           'conf_loss': 0.0122598065,
           'precision50': 0.41563413,
           'recall50': 0.13961154},
     '4': {'avg_iou': 0.78370345,
           'avg_obj': 0.38628706,
           'box_loss': 0.00925661,
           'class_loss': 0.003950023,
           'conf_loss': 0.014676739,
           'precision50': 0.66188127,
           'recall50': 0.34633556},
     '5': {'avg_iou': 0.8383185,
           'avg_obj': 0.51666164,
           'box_loss': 0.007420137,
           'class_loss': 0.003642868,
           'conf_loss': 0.013948642,
           'precision50': 0.79600143,
           'recall50': 0.55691975},
     'global': {'total_loss': 0.6484218},
     'learning_rate': 0.0050876355,
     'training_loss': 0.6484218}
I0410 20:58:22.171973 140640048215872 controller.py:425] train | step:  175000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.68831027,
           'avg_obj': 0.24375427,
           'box_loss': 0.011453237,
           'class_loss': 0.004339126,
           'conf_loss': 0.012178118,
           'precision50': 0.41596988,
           'recall50': 0.14118038},
     '4': {'avg_iou': 0.78472525,
           'avg_obj': 0.38808307,
           'box_loss': 0.0092009045,
           'class_loss': 0.003912858,
           'conf_loss': 0.014590932,
           'precision50': 0.6608022,
           'recall50': 0.3480774},
     '5': {'avg_iou': 0.8392819,
           'avg_obj': 0.51829326,
           'box_loss': 0.0073625855,
           'class_loss': 0.003600225,
           'conf_loss': 0.013881614,
           'precision50': 0.7961756,
           'recall50': 0.5588983},
     'global': {'total_loss': 0.6441566},
     'learning_rate': 0.004855627,
     'training_loss': 0.6441566}
I0410 21:30:40.137151 140640048215872 controller.py:425] train | step:  180000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6893734,
           'avg_obj': 0.24509278,
           'box_loss': 0.01143987,
           'class_loss': 0.0043027103,
           'conf_loss': 0.0121368235,
           'precision50': 0.42019594,
           'recall50': 0.14358453},
     '4': {'avg_iou': 0.7863098,
           'avg_obj': 0.3915263,
           'box_loss': 0.009131986,
           'class_loss': 0.0038638832,
           'conf_loss': 0.0145480335,
           'precision50': 0.6638847,
           'recall50': 0.35250425},
     '5': {'avg_iou': 0.84036046,
           'avg_obj': 0.5216197,
           'box_loss': 0.0073198006,
           'class_loss': 0.003571187,
           'conf_loss': 0.013832427,
           'precision50': 0.7975417,
           'recall50': 0.56242365},
     'global': {'total_loss': 0.6411739},
     'learning_rate': 0.0046277414,
     'training_loss': 0.6411739}
I0410 22:04:30.888502 140640048215872 controller.py:425] train | step:  185000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6900947,
           'avg_obj': 0.2470183,
           'box_loss': 0.011382999,
           'class_loss': 0.0042680698,
           'conf_loss': 0.012074781,
           'precision50': 0.41891763,
           'recall50': 0.14446498},
     '4': {'avg_iou': 0.7870301,
           'avg_obj': 0.39378905,
           'box_loss': 0.009086252,
           'class_loss': 0.00382541,
           'conf_loss': 0.014425233,
           'precision50': 0.66449076,
           'recall50': 0.35456258},
     '5': {'avg_iou': 0.8415292,
           'avg_obj': 0.52407485,
           'box_loss': 0.007262899,
           'class_loss': 0.0035278497,
           'conf_loss': 0.013732992,
           'precision50': 0.7989064,
           'recall50': 0.5656462},
     'global': {'total_loss': 0.6366927},
     'learning_rate': 0.0044785147,
     'training_loss': 0.6366927}

train | step:  155000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6844746,
           'avg_obj': 0.23510647,
           'box_loss': 0.011584457,
           'class_loss': 0.004493476,
           'conf_loss': 0.01228983,
           'precision50': 0.4060949,
           'recall50': 0.13321964},
     '4': {'avg_iou': 0.7803523,
           'avg_obj': 0.3773404,
           'box_loss': 0.009381165,
           'class_loss': 0.004064868,
           'conf_loss': 0.014815558,
           'precision50': 0.65475696,
           'recall50': 0.33467105},
     '5': {'avg_iou': 0.8345793,
           'avg_obj': 0.5066537,
           'box_loss': 0.0076024225,
           'class_loss': 0.0037891536,
           'conf_loss': 0.014174643,
           'precision50': 0.7915809,
           'recall50': 0.5444965},
     'global': {'total_loss': 0.6575636},
     'learning_rate': 0.0057200873,
     'training_loss': 0.6575636}
train | step:  160000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6854699,
           'avg_obj': 0.23778418,
           'box_loss': 0.011546752,
           'class_loss': 0.0044511314,
           'conf_loss': 0.012296419,
           'precision50': 0.4098953,
           'recall50': 0.13592501},
     '4': {'avg_iou': 0.78107333,
           'avg_obj': 0.38067383,
           'box_loss': 0.009354121,
           'class_loss': 0.0040251818,
           'conf_loss': 0.014779326,
           'precision50': 0.65618384,
           'recall50': 0.338454},
     '5': {'avg_iou': 0.83585745,
           'avg_obj': 0.51095563,
           'box_loss': 0.0075376085,
           'class_loss': 0.0037284752,
           'conf_loss': 0.014081455,
           'precision50': 0.7935665,
           'recall50': 0.54975736},
     'global': {'total_loss': 0.65440357},
     'learning_rate': 0.0054812017,
     'training_loss': 0.65440357}
train | step:  165000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6865128,
           'avg_obj': 0.23959394,
           'box_loss': 0.011506004,
           'class_loss': 0.0043970407,
           'conf_loss': 0.012260519,
           'precision50': 0.41226542,
           'recall50': 0.13769042},
     '4': {'avg_iou': 0.7827203,
           'avg_obj': 0.38323423,
           'box_loss': 0.009296356,
           'class_loss': 0.0039772447,
           'conf_loss': 0.014727425,
           'precision50': 0.6601531,
           'recall50': 0.3429234},
     '5': {'avg_iou': 0.8369134,
           'avg_obj': 0.51261777,
           'box_loss': 0.007486986,
           'class_loss': 0.0036926495,
           'conf_loss': 0.014043481,
           'precision50': 0.7941011,
           'recall50': 0.5517944},
     'global': {'total_loss': 0.65110177},
     'learning_rate': 0.0052441857,
     'training_loss': 0.65110177}
saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-165000.
 eval | step:  165000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=177.84s).
Accumulating evaluation results...
DONE (t=13.08s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.412
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.609
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.443
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.150
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.363
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.543
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.334
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.542
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.589
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.307
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.563
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.709
 eval | step:  165000 | eval time:  508.9 sec | output: 
    {'3': {'avg_iou': 0.44688398,
           'avg_obj': 0.17953646,
           'box_loss': 0.0074702348,
           'class_loss': 0.002507188,
           'conf_loss': 0.006004221,
           'precision50': 0.15413609,
           'recall50': 0.17240442},
     '4': {'avg_iou': 0.67235947,
           'avg_obj': 0.37871012,
           'box_loss': 0.007818,
           'class_loss': 0.002857818,
           'conf_loss': 0.008124855,
           'precision50': 0.24237512,
           'recall50': 0.40649962},
     '5': {'avg_iou': 0.82394725,
           'avg_obj': 0.57028943,
           'box_loss': 0.0072016153,
           'class_loss': 0.0027647067,
           'conf_loss': 0.009508862,
           'precision50': 0.3067631,
           'recall50': 0.62957436},
     'AP': 0.41185775,
     'AP50': 0.6085325,
     'AP75': 0.4432122,
     'APl': 0.5433632,
     'APm': 0.3626703,
     'APs': 0.14996657,
     'ARl': 0.7090444,
     'ARm': 0.56307214,
     'ARmax1': 0.334376,
     'ARmax10': 0.5419634,
     'ARmax100': 0.5887007,
     'ARs': 0.30657613,
     'global': {'total_loss': 0.054257493},
     'validation_loss': 0.054257493}
train | step:  165000 | training until step 185000...
train | step:  170000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6873366,
           'avg_obj': 0.24120618,
           'box_loss': 0.011516897,
           'class_loss': 0.0043808874,
           'conf_loss': 0.0122598065,
           'precision50': 0.41563413,
           'recall50': 0.13961154},
     '4': {'avg_iou': 0.78370345,
           'avg_obj': 0.38628706,
           'box_loss': 0.00925661,
           'class_loss': 0.003950023,
           'conf_loss': 0.014676739,
           'precision50': 0.66188127,
           'recall50': 0.34633556},
     '5': {'avg_iou': 0.8383185,
           'avg_obj': 0.51666164,
           'box_loss': 0.007420137,
           'class_loss': 0.003642868,
           'conf_loss': 0.013948642,
           'precision50': 0.79600143,
           'recall50': 0.55691975},
     'global': {'total_loss': 0.6484218},
     'learning_rate': 0.0050876355,
     'training_loss': 0.6484218}
train | step:  175000 | steps/sec:    2.8 | output: 
    {'3': {'avg_iou': 0.68831027,
           'avg_obj': 0.24375427,
           'box_loss': 0.011453237,
           'class_loss': 0.004339126,
           'conf_loss': 0.012178118,
           'precision50': 0.41596988,
           'recall50': 0.14118038},
     '4': {'avg_iou': 0.78472525,
           'avg_obj': 0.38808307,
           'box_loss': 0.0092009045,
           'class_loss': 0.003912858,
           'conf_loss': 0.014590932,
           'precision50': 0.6608022,
           'recall50': 0.3480774},
     '5': {'avg_iou': 0.8392819,
           'avg_obj': 0.51829326,
           'box_loss': 0.0073625855,
           'class_loss': 0.003600225,
           'conf_loss': 0.013881614,
           'precision50': 0.7961756,
           'recall50': 0.5588983},
     'global': {'total_loss': 0.6441566},
     'learning_rate': 0.004855627,
     'training_loss': 0.6441566}
train | step:  180000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6893734,
           'avg_obj': 0.24509278,
           'box_loss': 0.01143987,
           'class_loss': 0.0043027103,
           'conf_loss': 0.0121368235,
           'precision50': 0.42019594,
           'recall50': 0.14358453},
     '4': {'avg_iou': 0.7863098,
           'avg_obj': 0.3915263,
           'box_loss': 0.009131986,
           'class_loss': 0.0038638832,
           'conf_loss': 0.0145480335,
           'precision50': 0.6638847,
           'recall50': 0.35250425},
     '5': {'avg_iou': 0.84036046,
           'avg_obj': 0.5216197,
           'box_loss': 0.0073198006,
           'class_loss': 0.003571187,
           'conf_loss': 0.013832427,
           'precision50': 0.7975417,
           'recall50': 0.56242365},
     'global': {'total_loss': 0.6411739},
     'learning_rate': 0.0046277414,
     'training_loss': 0.6411739}
train | step:  185000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6900947,
           'avg_obj': 0.2470183,
           'box_loss': 0.011382999,
           'class_loss': 0.0042680698,
           'conf_loss': 0.012074781,
           'precision50': 0.41891763,
           'recall50': 0.14446498},
     '4': {'avg_iou': 0.7870301,
           'avg_obj': 0.39378905,
           'box_loss': 0.009086252,
           'class_loss': 0.00382541,
           'conf_loss': 0.014425233,
           'precision50': 0.66449076,
           'recall50': 0.35456258},
     '5': {'avg_iou': 0.8415292,
           'avg_obj': 0.52407485,
           'box_loss': 0.007262899,
           'class_loss': 0.0035278497,
           'conf_loss': 0.013732992,
           'precision50': 0.7989064,
           'recall50': 0.5656462},
     'global': {'total_loss': 0.6366927},
     'learning_rate': 0.0044785147,
     'training_loss': 0.6366927}I0410 22:05:21.886113 140640048215872 controller.py:455] saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-185000.
I0410 22:05:21.892095 140640048215872 controller.py:252]  eval | step:  185000 | running 625 steps of evaluation...
I0410 22:09:54.443266 140640048215872 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0410 22:13:57.956191 140640048215872 controller.py:261]  eval | step:  185000 | eval time:  516.1 sec | output: 
    {'3': {'avg_iou': 0.4473395,
           'avg_obj': 0.18071494,
           'box_loss': 0.0074476777,
           'class_loss': 0.0025245287,
           'conf_loss': 0.0060416767,
           'precision50': 0.15291893,
           'recall50': 0.17309527},
     '4': {'avg_iou': 0.67163485,
           'avg_obj': 0.3815662,
           'box_loss': 0.007854982,
           'class_loss': 0.0028981427,
           'conf_loss': 0.008191665,
           'precision50': 0.24246743,
           'recall50': 0.413375},
     '5': {'avg_iou': 0.82369834,
           'avg_obj': 0.5743753,
           'box_loss': 0.007214167,
           'class_loss': 0.002810031,
           'conf_loss': 0.009595795,
           'precision50': 0.30438885,
           'recall50': 0.63367224},
     'AP': 0.4104474,
     'AP50': 0.60707885,
     'AP75': 0.4380923,
     'APl': 0.541865,
     'APm': 0.36365074,
     'APs': 0.1473993,
     'ARl': 0.7051972,
     'ARm': 0.56240577,
     'ARmax1': 0.33433422,
     'ARmax10': 0.53944343,
     'ARmax100': 0.5856365,
     'ARs': 0.30273017,
     'global': {'total_loss': 0.05457867},
     'validation_loss': 0.05457867}
I0410 22:14:15.696882 140640048215872 controller.py:211] train | step:  185000 | training until step 205000...
I0410 22:40:39.982664 140640048215872 controller.py:425] train | step:  190000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.69151646,
           'avg_obj': 0.24933216,
           'box_loss': 0.01135054,
           'class_loss': 0.004249277,
           'conf_loss': 0.012081705,
           'precision50': 0.4223688,
           'recall50': 0.14698005},
     '4': {'avg_iou': 0.78826886,
           'avg_obj': 0.39682105,
           'box_loss': 0.009038836,
           'class_loss': 0.0037879348,
           'conf_loss': 0.0144177135,
           'precision50': 0.66734546,
           'recall50': 0.35872772},
     '5': {'avg_iou': 0.8426616,
           'avg_obj': 0.5271703,
           'box_loss': 0.00719708,
           'class_loss': 0.0034696911,
           'conf_loss': 0.013676387,
           'precision50': 0.80031264,
           'recall50': 0.56953424},
     'global': {'total_loss': 0.634153},
     'learning_rate': 0.004259316,
     'training_loss': 0.634153}
I0410 23:12:01.509069 140640048215872 controller.py:425] train | step:  195000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6921006,
           'avg_obj': 0.25069124,
           'box_loss': 0.011331547,
           'class_loss': 0.004224991,
           'conf_loss': 0.012021189,
           'precision50': 0.4237473,
           'recall50': 0.14822307},
     '4': {'avg_iou': 0.7889869,
           'avg_obj': 0.39824805,
           'box_loss': 0.009013954,
           'class_loss': 0.0037607562,
           'conf_loss': 0.01437154,
           'precision50': 0.66700256,
           'recall50': 0.35955667},
     '5': {'avg_iou': 0.84389275,
           'avg_obj': 0.5291252,
           'box_loss': 0.007149208,
           'class_loss': 0.0034677177,
           'conf_loss': 0.013632254,
           'precision50': 0.8007788,
           'recall50': 0.57156414},
     'global': {'total_loss': 0.631786},
     'learning_rate': 0.0040463875,
     'training_loss': 0.631786}
I0410 23:45:47.544369 140640048215872 controller.py:425] train | step:  200000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6927286,
           'avg_obj': 0.2522719,
           'box_loss': 0.011277568,
           'class_loss': 0.0041680704,
           'conf_loss': 0.0119957775,
           'precision50': 0.4252813,
           'recall50': 0.14956182},
     '4': {'avg_iou': 0.79027504,
           'avg_obj': 0.40075985,
           'box_loss': 0.008960903,
           'class_loss': 0.0037263783,
           'conf_loss': 0.014320641,
           'precision50': 0.6673585,
           'recall50': 0.36218616},
     '5': {'avg_iou': 0.8448864,
           'avg_obj': 0.5318116,
           'box_loss': 0.007098507,
           'class_loss': 0.0034206002,
           'conf_loss': 0.013578176,
           'precision50': 0.8012756,
           'recall50': 0.5740514},
     'global': {'total_loss': 0.6283731},
     'learning_rate': 0.0039082994,
     'training_loss': 0.6283731}
I0411 00:17:32.831886 140640048215872 controller.py:425] train | step:  205000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6938902,
           'avg_obj': 0.25365156,
           'box_loss': 0.011267052,
           'class_loss': 0.00415097,
           'conf_loss': 0.012013802,
           'precision50': 0.42820355,
           'recall50': 0.15140031},
     '4': {'avg_iou': 0.7911671,
           'avg_obj': 0.40293178,
           'box_loss': 0.008915298,
           'class_loss': 0.003706683,
           'conf_loss': 0.01430359,
           'precision50': 0.67031145,
           'recall50': 0.36567178},
     '5': {'avg_iou': 0.8455839,
           'avg_obj': 0.53431356,
           'box_loss': 0.007065483,
           'class_loss': 0.0034000892,
           'conf_loss': 0.013511241,
           'precision50': 0.8026007,
           'recall50': 0.5774851},
     'global': {'total_loss': 0.6266746},
     'learning_rate': 0.0037075155,
     'training_loss': 0.6266746}
I0411 00:18:27.368896 140640048215872 controller.py:455] saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-205000.
I0411 00:18:27.375307 140640048215872 controller.py:252]  eval | step:  205000 | running 625 steps of evaluation...
I0411 00:22:58.325942 140640048215872 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0411 00:27:13.126595 140640048215872 controller.py:261]  eval | step:  205000 | eval time:  525.8 sec | output: 
    {'3': {'avg_iou': 0.4471603,
           'avg_obj': 0.18184213,
           'box_loss': 0.007457137,
           'class_loss': 0.002546169,
           'conf_loss': 0.006063932,
           'precision50': 0.15151876,
           'recall50': 0.17550541},
     '4': {'avg_iou': 0.67162913,
           'avg_obj': 0.3825638,
           'box_loss': 0.007855676,
           'class_loss': 0.0029464236,
           'conf_loss': 0.008237997,
           'precision50': 0.23831697,
           'recall50': 0.41114214},
     '5': {'avg_iou': 0.82288045,
           'avg_obj': 0.57787454,
           'box_loss': 0.007255472,
           'class_loss': 0.0028268013,
           'conf_loss': 0.0096870195,
           'precision50': 0.3019319,
           'recall50': 0.63445115},
     'AP': 0.41099736,
     'AP50': 0.6066046,
     'AP75': 0.44253534,
     'APl': 0.54187524,
     'APm': 0.3630019,
     'APs': 0.1443284,
     'ARl': 0.7018594,
     'ARm': 0.5583321,
     'ARmax1': 0.33233836,
     'ARmax10': 0.53884846,
     'ARmax100': 0.5837968,
     'ARs': 0.2996209,
     'global': {'total_loss': 0.054876648},
     'validation_loss': 0.054876648}

saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-185000.
 eval | step:  185000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=178.70s).
Accumulating evaluation results...
DONE (t=12.77s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.410
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.607
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.438
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.147
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.364
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.542
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.334
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.539
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.586
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.303
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.562
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.705
 eval | step:  185000 | eval time:  516.1 sec | output: 
    {'3': {'avg_iou': 0.4473395,
           'avg_obj': 0.18071494,
           'box_loss': 0.0074476777,
           'class_loss': 0.0025245287,
           'conf_loss': 0.0060416767,
           'precision50': 0.15291893,
           'recall50': 0.17309527},
     '4': {'avg_iou': 0.67163485,
           'avg_obj': 0.3815662,
           'box_loss': 0.007854982,
           'class_loss': 0.0028981427,
           'conf_loss': 0.008191665,
           'precision50': 0.24246743,
           'recall50': 0.413375},
     '5': {'avg_iou': 0.82369834,
           'avg_obj': 0.5743753,
           'box_loss': 0.007214167,
           'class_loss': 0.002810031,
           'conf_loss': 0.009595795,
           'precision50': 0.30438885,
           'recall50': 0.63367224},
     'AP': 0.4104474,
     'AP50': 0.60707885,
     'AP75': 0.4380923,
     'APl': 0.541865,
     'APm': 0.36365074,
     'APs': 0.1473993,
     'ARl': 0.7051972,
     'ARm': 0.56240577,
     'ARmax1': 0.33433422,
     'ARmax10': 0.53944343,
     'ARmax100': 0.5856365,
     'ARs': 0.30273017,
     'global': {'total_loss': 0.05457867},
     'validation_loss': 0.05457867}
train | step:  185000 | training until step 205000...
train | step:  190000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.69151646,
           'avg_obj': 0.24933216,
           'box_loss': 0.01135054,
           'class_loss': 0.004249277,
           'conf_loss': 0.012081705,
           'precision50': 0.4223688,
           'recall50': 0.14698005},
     '4': {'avg_iou': 0.78826886,
           'avg_obj': 0.39682105,
           'box_loss': 0.009038836,
           'class_loss': 0.0037879348,
           'conf_loss': 0.0144177135,
           'precision50': 0.66734546,
           'recall50': 0.35872772},
     '5': {'avg_iou': 0.8426616,
           'avg_obj': 0.5271703,
           'box_loss': 0.00719708,
           'class_loss': 0.0034696911,
           'conf_loss': 0.013676387,
           'precision50': 0.80031264,
           'recall50': 0.56953424},
     'global': {'total_loss': 0.634153},
     'learning_rate': 0.004259316,
     'training_loss': 0.634153}
train | step:  195000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.6921006,
           'avg_obj': 0.25069124,
           'box_loss': 0.011331547,
           'class_loss': 0.004224991,
           'conf_loss': 0.012021189,
           'precision50': 0.4237473,
           'recall50': 0.14822307},
     '4': {'avg_iou': 0.7889869,
           'avg_obj': 0.39824805,
           'box_loss': 0.009013954,
           'class_loss': 0.0037607562,
           'conf_loss': 0.01437154,
           'precision50': 0.66700256,
           'recall50': 0.35955667},
     '5': {'avg_iou': 0.84389275,
           'avg_obj': 0.5291252,
           'box_loss': 0.007149208,
           'class_loss': 0.0034677177,
           'conf_loss': 0.013632254,
           'precision50': 0.8007788,
           'recall50': 0.57156414},
     'global': {'total_loss': 0.631786},
     'learning_rate': 0.0040463875,
     'training_loss': 0.631786}
train | step:  200000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.6927286,
           'avg_obj': 0.2522719,
           'box_loss': 0.011277568,
           'class_loss': 0.0041680704,
           'conf_loss': 0.0119957775,
           'precision50': 0.4252813,
           'recall50': 0.14956182},
     '4': {'avg_iou': 0.79027504,
           'avg_obj': 0.40075985,
           'box_loss': 0.008960903,
           'class_loss': 0.0037263783,
           'conf_loss': 0.014320641,
           'precision50': 0.6673585,
           'recall50': 0.36218616},
     '5': {'avg_iou': 0.8448864,
           'avg_obj': 0.5318116,
           'box_loss': 0.007098507,
           'class_loss': 0.0034206002,
           'conf_loss': 0.013578176,
           'precision50': 0.8012756,
           'recall50': 0.5740514},
     'global': {'total_loss': 0.6283731},
     'learning_rate': 0.0039082994,
     'training_loss': 0.6283731}
train | step:  205000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6938902,
           'avg_obj': 0.25365156,
           'box_loss': 0.011267052,
           'class_loss': 0.00415097,
           'conf_loss': 0.012013802,
           'precision50': 0.42820355,
           'recall50': 0.15140031},
     '4': {'avg_iou': 0.7911671,
           'avg_obj': 0.40293178,
           'box_loss': 0.008915298,
           'class_loss': 0.003706683,
           'conf_loss': 0.01430359,
           'precision50': 0.67031145,
           'recall50': 0.36567178},
     '5': {'avg_iou': 0.8455839,
           'avg_obj': 0.53431356,
           'box_loss': 0.007065483,
           'class_loss': 0.0034000892,
           'conf_loss': 0.013511241,
           'precision50': 0.8026007,
           'recall50': 0.5774851},
     'global': {'total_loss': 0.6266746},
     'learning_rate': 0.0037075155,
     'training_loss': 0.6266746}
saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-205000.
 eval | step:  205000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=189.81s).
Accumulating evaluation results...
DONE (t=13.19s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.411
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.607
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.443
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.144
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.363
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.542
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.332
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.539
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.584
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.300
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.558
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.702
 eval | step:  205000 | eval time:  525.8 sec | output: 
    {'3': {'avg_iou': 0.4471603,
           'avg_obj': 0.18184213,
           'box_loss': 0.007457137,
           'class_loss': 0.002546169,
           'conf_loss': 0.006063932,
           'precision50': 0.15151876,
           'recall50': 0.17550541},
     '4': {'avg_iou': 0.67162913,
           'avg_obj': 0.3825638,
           'box_loss': 0.007855676,
           'class_loss': 0.0029464236,
           'conf_loss': 0.008237997,
           'precision50': 0.23831697,
           'recall50': 0.41114214},
     '5': {'avg_iou': 0.82288045,
           'avg_obj': 0.57787454,
           'box_loss': 0.007255472,
           'class_loss': 0.0028268013,
           'conf_loss': 0.0096870195,
           'precision50': 0.3019319,
           'recall50': 0.63445115},
     'AP': 0.41099736,
     'AP50': 0.6066046,
     'AP75': 0.44253534,
     'APl': 0.54187524,
     'APm': 0.3630019,
     'APs': 0.1443284,
     'ARl': 0.7018594,
     'ARm': 0.5583321,
     'ARmax1': 0.33233836,
     'ARmax10': 0.53884846,
     'ARmax100': 0.5837968,
     'ARs': 0.2996209,
     'global': {'total_loss': 0.054876648},
     'validation_loss': 0.054876648}I0411 00:27:37.622866 140640048215872 controller.py:211] train | step:  205000 | training until step 225000...
I0411 00:54:01.910012 140640048215872 controller.py:425] train | step:  210000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.69440067,
           'avg_obj': 0.25584406,
           'box_loss': 0.011220658,
           'class_loss': 0.00409256,
           'conf_loss': 0.011919115,
           'precision50': 0.42832875,
           'recall50': 0.15312202},
     '4': {'avg_iou': 0.79219246,
           'avg_obj': 0.40562147,
           'box_loss': 0.008875558,
           'class_loss': 0.0036595843,
           'conf_loss': 0.014203638,
           'precision50': 0.6700316,
           'recall50': 0.36828476},
     '5': {'avg_iou': 0.84667313,
           'avg_obj': 0.5368021,
           'box_loss': 0.0070135766,
           'class_loss': 0.0033603203,
           'conf_loss': 0.013439484,
           'precision50': 0.80341136,
           'recall50': 0.57975405},
     'global': {'total_loss': 0.6222761},
     'learning_rate': 0.0035149902,
     'training_loss': 0.6222761}
I0411 01:24:30.157782 140640048215872 controller.py:425] train | step:  215000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.695058,
           'avg_obj': 0.2572244,
           'box_loss': 0.011204209,
           'class_loss': 0.0040822704,
           'conf_loss': 0.0119348,
           'precision50': 0.4315255,
           'recall50': 0.15473808},
     '4': {'avg_iou': 0.79284,
           'avg_obj': 0.4074348,
           'box_loss': 0.008846242,
           'class_loss': 0.0036443092,
           'conf_loss': 0.014206508,
           'precision50': 0.6727027,
           'recall50': 0.3709876},
     '5': {'avg_iou': 0.8476758,
           'avg_obj': 0.53942734,
           'box_loss': 0.006964154,
           'class_loss': 0.0033320258,
           'conf_loss': 0.013397662,
           'precision50': 0.80434585,
           'recall50': 0.58313274},
     'global': {'total_loss': 0.6208997},
     'learning_rate': 0.0033915725,
     'training_loss': 0.6208997}
I0411 01:56:47.653007 140640048215872 controller.py:425] train | step:  220000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.695953,
           'avg_obj': 0.25903472,
           'box_loss': 0.011154561,
           'class_loss': 0.0040595667,
           'conf_loss': 0.011861491,
           'precision50': 0.432471,
           'recall50': 0.15638937},
     '4': {'avg_iou': 0.79362464,
           'avg_obj': 0.40955403,
           'box_loss': 0.00878211,
           'class_loss': 0.0035961461,
           'conf_loss': 0.0140861645,
           'precision50': 0.6731408,
           'recall50': 0.3735921},
     '5': {'avg_iou': 0.8484919,
           'avg_obj': 0.5412939,
           'box_loss': 0.0069245202,
           'class_loss': 0.0032852916,
           'conf_loss': 0.013307603,
           'precision50': 0.8052221,
           'recall50': 0.58555156},
     'global': {'total_loss': 0.6164603},
     'learning_rate': 0.0032143372,
     'training_loss': 0.6164603}
I0411 02:29:05.400592 140640048215872 controller.py:425] train | step:  225000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6964587,
           'avg_obj': 0.25985298,
           'box_loss': 0.011142042,
           'class_loss': 0.004017652,
           'conf_loss': 0.011838893,
           'precision50': 0.43260762,
           'recall50': 0.15665966},
     '4': {'avg_iou': 0.7944757,
           'avg_obj': 0.41103837,
           'box_loss': 0.008765467,
           'class_loss': 0.0035668532,
           'conf_loss': 0.014081845,
           'precision50': 0.67387617,
           'recall50': 0.37457493},
     '5': {'avg_iou': 0.849246,
           'avg_obj': 0.5431595,
           'box_loss': 0.006891285,
           'class_loss': 0.0032617745,
           'conf_loss': 0.01329507,
           'precision50': 0.8069347,
           'recall50': 0.5877956},
     'global': {'total_loss': 0.614887},
     'learning_rate': 0.0030471378,
     'training_loss': 0.614887}
I0411 02:29:56.333449 140640048215872 controller.py:455] saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-225000.
I0411 02:29:56.339998 140640048215872 controller.py:252]  eval | step:  225000 | running 625 steps of evaluation...
I0411 02:34:22.762975 140640048215872 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0411 02:38:55.165055 140640048215872 controller.py:261]  eval | step:  225000 | eval time:  538.8 sec | output: 
    {'3': {'avg_iou': 0.44666007,
           'avg_obj': 0.18265134,
           'box_loss': 0.007482881,
           'class_loss': 0.0025684603,
           'conf_loss': 0.006091922,
           'precision50': 0.15105295,
           'recall50': 0.17854995},
     '4': {'avg_iou': 0.67083997,
           'avg_obj': 0.38522723,
           'box_loss': 0.007895672,
           'class_loss': 0.0029779936,
           'conf_loss': 0.008299936,
           'precision50': 0.2390985,
           'recall50': 0.41728675},
     '5': {'avg_iou': 0.8232007,
           'avg_obj': 0.58171,
           'box_loss': 0.0072413706,
           'class_loss': 0.0028736054,
           'conf_loss': 0.009797488,
           'precision50': 0.30213884,
           'recall50': 0.6394903},
     'AP': 0.40950206,
     'AP50': 0.6042719,
     'AP75': 0.43901294,
     'APl': 0.5409328,
     'APm': 0.36104268,
     'APs': 0.14518714,
     'ARl': 0.7019332,
     'ARm': 0.55294865,
     'ARmax1': 0.3348319,
     'ARmax10': 0.5362201,
     'ARmax100': 0.5813588,
     'ARs': 0.3056882,
     'global': {'total_loss': 0.05522932},
     'validation_loss': 0.05522932}
I0411 02:39:26.463474 140640048215872 controller.py:211] train | step:  225000 | training until step 245000...
I0411 03:05:50.783367 140640048215872 controller.py:425] train | step:  230000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6974554,
           'avg_obj': 0.2619592,
           'box_loss': 0.011101273,
           'class_loss': 0.0040065744,
           'conf_loss': 0.011813925,
           'precision50': 0.4340414,
           'recall50': 0.15849715},
     '4': {'avg_iou': 0.79551446,
           'avg_obj': 0.41394886,
           'box_loss': 0.008713855,
           'class_loss': 0.0035518405,
           'conf_loss': 0.014017041,
           'precision50': 0.6752776,
           'recall50': 0.37789455},
     '5': {'avg_iou': 0.8504158,
           'avg_obj': 0.5460725,
           'box_loss': 0.0068327826,
           'class_loss': 0.0032434063,
           'conf_loss': 0.01320979,
           'precision50': 0.80716354,
           'recall50': 0.5902039},
     'global': {'total_loss': 0.611924},
     'learning_rate': 0.002941546,
     'training_loss': 0.611924}
I0411 03:38:29.195598 140640048215872 controller.py:425] train | step:  235000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6977024,
           'avg_obj': 0.26329783,
           'box_loss': 0.011090743,
           'class_loss': 0.003991112,
           'conf_loss': 0.011826965,
           'precision50': 0.43767256,
           'recall50': 0.1605538},
     '4': {'avg_iou': 0.79609895,
           'avg_obj': 0.41537023,
           'box_loss': 0.00868637,
           'class_loss': 0.0035205998,
           'conf_loss': 0.014035775,
           'precision50': 0.6767746,
           'recall50': 0.38020182},
     '5': {'avg_iou': 0.8508926,
           'avg_obj': 0.54768974,
           'box_loss': 0.006804666,
           'class_loss': 0.0032171635,
           'conf_loss': 0.013194985,
           'precision50': 0.8081374,
           'recall50': 0.59269303},
     'global': {'total_loss': 0.6109464},
     'learning_rate': 0.0027923924,
     'training_loss': 0.6109464}
I0411 04:10:35.698387 140640048215872 controller.py:425] train | step:  240000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6982413,
           'avg_obj': 0.2641954,
           'box_loss': 0.011086065,
           'class_loss': 0.0039698374,
           'conf_loss': 0.011832285,
           'precision50': 0.43994457,
           'recall50': 0.16220006},
     '4': {'avg_iou': 0.7967663,
           'avg_obj': 0.41735113,
           'box_loss': 0.008667692,
           'class_loss': 0.0035124035,
           'conf_loss': 0.0139911175,
           'precision50': 0.6788117,
           'recall50': 0.3828688},
     '5': {'avg_iou': 0.8515955,
           'avg_obj': 0.5496228,
           'box_loss': 0.0067781634,
           'class_loss': 0.0031996153,
           'conf_loss': 0.0131451795,
           'precision50': 0.8087041,
           'recall50': 0.59469175},
     'global': {'total_loss': 0.6094598},
     'learning_rate': 0.0026547941,
     'training_loss': 0.6094598}

train | step:  205000 | training until step 225000...
train | step:  210000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.69440067,
           'avg_obj': 0.25584406,
           'box_loss': 0.011220658,
           'class_loss': 0.00409256,
           'conf_loss': 0.011919115,
           'precision50': 0.42832875,
           'recall50': 0.15312202},
     '4': {'avg_iou': 0.79219246,
           'avg_obj': 0.40562147,
           'box_loss': 0.008875558,
           'class_loss': 0.0036595843,
           'conf_loss': 0.014203638,
           'precision50': 0.6700316,
           'recall50': 0.36828476},
     '5': {'avg_iou': 0.84667313,
           'avg_obj': 0.5368021,
           'box_loss': 0.0070135766,
           'class_loss': 0.0033603203,
           'conf_loss': 0.013439484,
           'precision50': 0.80341136,
           'recall50': 0.57975405},
     'global': {'total_loss': 0.6222761},
     'learning_rate': 0.0035149902,
     'training_loss': 0.6222761}
train | step:  215000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.695058,
           'avg_obj': 0.2572244,
           'box_loss': 0.011204209,
           'class_loss': 0.0040822704,
           'conf_loss': 0.0119348,
           'precision50': 0.4315255,
           'recall50': 0.15473808},
     '4': {'avg_iou': 0.79284,
           'avg_obj': 0.4074348,
           'box_loss': 0.008846242,
           'class_loss': 0.0036443092,
           'conf_loss': 0.014206508,
           'precision50': 0.6727027,
           'recall50': 0.3709876},
     '5': {'avg_iou': 0.8476758,
           'avg_obj': 0.53942734,
           'box_loss': 0.006964154,
           'class_loss': 0.0033320258,
           'conf_loss': 0.013397662,
           'precision50': 0.80434585,
           'recall50': 0.58313274},
     'global': {'total_loss': 0.6208997},
     'learning_rate': 0.0033915725,
     'training_loss': 0.6208997}
train | step:  220000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.695953,
           'avg_obj': 0.25903472,
           'box_loss': 0.011154561,
           'class_loss': 0.0040595667,
           'conf_loss': 0.011861491,
           'precision50': 0.432471,
           'recall50': 0.15638937},
     '4': {'avg_iou': 0.79362464,
           'avg_obj': 0.40955403,
           'box_loss': 0.00878211,
           'class_loss': 0.0035961461,
           'conf_loss': 0.0140861645,
           'precision50': 0.6731408,
           'recall50': 0.3735921},
     '5': {'avg_iou': 0.8484919,
           'avg_obj': 0.5412939,
           'box_loss': 0.0069245202,
           'class_loss': 0.0032852916,
           'conf_loss': 0.013307603,
           'precision50': 0.8052221,
           'recall50': 0.58555156},
     'global': {'total_loss': 0.6164603},
     'learning_rate': 0.0032143372,
     'training_loss': 0.6164603}
train | step:  225000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6964587,
           'avg_obj': 0.25985298,
           'box_loss': 0.011142042,
           'class_loss': 0.004017652,
           'conf_loss': 0.011838893,
           'precision50': 0.43260762,
           'recall50': 0.15665966},
     '4': {'avg_iou': 0.7944757,
           'avg_obj': 0.41103837,
           'box_loss': 0.008765467,
           'class_loss': 0.0035668532,
           'conf_loss': 0.014081845,
           'precision50': 0.67387617,
           'recall50': 0.37457493},
     '5': {'avg_iou': 0.849246,
           'avg_obj': 0.5431595,
           'box_loss': 0.006891285,
           'class_loss': 0.0032617745,
           'conf_loss': 0.01329507,
           'precision50': 0.8069347,
           'recall50': 0.5877956},
     'global': {'total_loss': 0.614887},
     'learning_rate': 0.0030471378,
     'training_loss': 0.614887}
saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-225000.
 eval | step:  225000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=202.27s).
Accumulating evaluation results...
DONE (t=12.31s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.410
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.604
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.439
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.145
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.361
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.541
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.335
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.536
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.581
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.306
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.553
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.702
 eval | step:  225000 | eval time:  538.8 sec | output: 
    {'3': {'avg_iou': 0.44666007,
           'avg_obj': 0.18265134,
           'box_loss': 0.007482881,
           'class_loss': 0.0025684603,
           'conf_loss': 0.006091922,
           'precision50': 0.15105295,
           'recall50': 0.17854995},
     '4': {'avg_iou': 0.67083997,
           'avg_obj': 0.38522723,
           'box_loss': 0.007895672,
           'class_loss': 0.0029779936,
           'conf_loss': 0.008299936,
           'precision50': 0.2390985,
           'recall50': 0.41728675},
     '5': {'avg_iou': 0.8232007,
           'avg_obj': 0.58171,
           'box_loss': 0.0072413706,
           'class_loss': 0.0028736054,
           'conf_loss': 0.009797488,
           'precision50': 0.30213884,
           'recall50': 0.6394903},
     'AP': 0.40950206,
     'AP50': 0.6042719,
     'AP75': 0.43901294,
     'APl': 0.5409328,
     'APm': 0.36104268,
     'APs': 0.14518714,
     'ARl': 0.7019332,
     'ARm': 0.55294865,
     'ARmax1': 0.3348319,
     'ARmax10': 0.5362201,
     'ARmax100': 0.5813588,
     'ARs': 0.3056882,
     'global': {'total_loss': 0.05522932},
     'validation_loss': 0.05522932}
train | step:  225000 | training until step 245000...
train | step:  230000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.6974554,
           'avg_obj': 0.2619592,
           'box_loss': 0.011101273,
           'class_loss': 0.0040065744,
           'conf_loss': 0.011813925,
           'precision50': 0.4340414,
           'recall50': 0.15849715},
     '4': {'avg_iou': 0.79551446,
           'avg_obj': 0.41394886,
           'box_loss': 0.008713855,
           'class_loss': 0.0035518405,
           'conf_loss': 0.014017041,
           'precision50': 0.6752776,
           'recall50': 0.37789455},
     '5': {'avg_iou': 0.8504158,
           'avg_obj': 0.5460725,
           'box_loss': 0.0068327826,
           'class_loss': 0.0032434063,
           'conf_loss': 0.01320979,
           'precision50': 0.80716354,
           'recall50': 0.5902039},
     'global': {'total_loss': 0.611924},
     'learning_rate': 0.002941546,
     'training_loss': 0.611924}
train | step:  235000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6977024,
           'avg_obj': 0.26329783,
           'box_loss': 0.011090743,
           'class_loss': 0.003991112,
           'conf_loss': 0.011826965,
           'precision50': 0.43767256,
           'recall50': 0.1605538},
     '4': {'avg_iou': 0.79609895,
           'avg_obj': 0.41537023,
           'box_loss': 0.00868637,
           'class_loss': 0.0035205998,
           'conf_loss': 0.014035775,
           'precision50': 0.6767746,
           'recall50': 0.38020182},
     '5': {'avg_iou': 0.8508926,
           'avg_obj': 0.54768974,
           'box_loss': 0.006804666,
           'class_loss': 0.0032171635,
           'conf_loss': 0.013194985,
           'precision50': 0.8081374,
           'recall50': 0.59269303},
     'global': {'total_loss': 0.6109464},
     'learning_rate': 0.0027923924,
     'training_loss': 0.6109464}
train | step:  240000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.6982413,
           'avg_obj': 0.2641954,
           'box_loss': 0.011086065,
           'class_loss': 0.0039698374,
           'conf_loss': 0.011832285,
           'precision50': 0.43994457,
           'recall50': 0.16220006},
     '4': {'avg_iou': 0.7967663,
           'avg_obj': 0.41735113,
           'box_loss': 0.008667692,
           'class_loss': 0.0035124035,
           'conf_loss': 0.0139911175,
           'precision50': 0.6788117,
           'recall50': 0.3828688},
     '5': {'avg_iou': 0.8515955,
           'avg_obj': 0.5496228,
           'box_loss': 0.0067781634,
           'class_loss': 0.0031996153,
           'conf_loss': 0.0131451795,
           'precision50': 0.8087041,
           'recall50': 0.59469175},
     'global': {'total_loss': 0.6094598},
     'learning_rate': 0.0026547941,
     'training_loss': 0.6094598}I0411 04:42:53.266297 140640048215872 controller.py:425] train | step:  245000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.69898766,
           'avg_obj': 0.26547313,
           'box_loss': 0.011064132,
           'class_loss': 0.003959821,
           'conf_loss': 0.011801257,
           'precision50': 0.43980122,
           'recall50': 0.16290781},
     '4': {'avg_iou': 0.79722595,
           'avg_obj': 0.41862637,
           'box_loss': 0.008630789,
           'class_loss': 0.0034831832,
           'conf_loss': 0.013959722,
           'precision50': 0.6793722,
           'recall50': 0.38412377},
     '5': {'avg_iou': 0.85207385,
           'avg_obj': 0.55121404,
           'box_loss': 0.006745869,
           'class_loss': 0.0031807201,
           'conf_loss': 0.013097177,
           'precision50': 0.8093028,
           'recall50': 0.5964003},
     'global': {'total_loss': 0.60738176},
     'learning_rate': 0.0025697285,
     'training_loss': 0.60738176}
I0411 04:43:42.049744 140640048215872 controller.py:455] saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-245000.
I0411 04:43:42.056312 140640048215872 controller.py:252]  eval | step:  245000 | running 625 steps of evaluation...
I0411 04:48:06.095235 140640048215872 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0411 04:52:03.296185 140640048215872 controller.py:261]  eval | step:  245000 | eval time:  501.2 sec | output: 
    {'3': {'avg_iou': 0.44629648,
           'avg_obj': 0.18314104,
           'box_loss': 0.007502329,
           'class_loss': 0.0026080578,
           'conf_loss': 0.00610333,
           'precision50': 0.15098523,
           'recall50': 0.1787481},
     '4': {'avg_iou': 0.6704405,
           'avg_obj': 0.38610598,
           'box_loss': 0.007916351,
           'class_loss': 0.003024244,
           'conf_loss': 0.008364464,
           'precision50': 0.23567973,
           'recall50': 0.4164115},
     '5': {'avg_iou': 0.8223652,
           'avg_obj': 0.5827334,
           'box_loss': 0.0072837113,
           'class_loss': 0.0028851982,
           'conf_loss': 0.009872095,
           'precision50': 0.29901388,
           'recall50': 0.6398089},
     'AP': 0.40915933,
     'AP50': 0.60251886,
     'AP75': 0.4376084,
     'APl': 0.5399365,
     'APm': 0.36167082,
     'APs': 0.15062517,
     'ARl': 0.69934595,
     'ARm': 0.55198616,
     'ARmax1': 0.33176637,
     'ARmax10': 0.5355834,
     'ARmax100': 0.58004016,
     'ARs': 0.3033901,
     'global': {'total_loss': 0.05555979},
     'validation_loss': 0.05555979}
I0411 04:52:21.068176 140640048215872 controller.py:211] train | step:  245000 | training until step 265000...
I0411 05:20:25.936557 140640048215872 controller.py:425] train | step:  250000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6993558,
           'avg_obj': 0.2667935,
           'box_loss': 0.011050879,
           'class_loss': 0.003945975,
           'conf_loss': 0.011739488,
           'precision50': 0.4396695,
           'recall50': 0.163615},
     '4': {'avg_iou': 0.79799306,
           'avg_obj': 0.42030165,
           'box_loss': 0.008601059,
           'class_loss': 0.0034519893,
           'conf_loss': 0.013897197,
           'precision50': 0.6790188,
           'recall50': 0.3860261},
     '5': {'avg_iou': 0.8527512,
           'avg_obj': 0.5528359,
           'box_loss': 0.006717548,
           'class_loss': 0.0031577882,
           'conf_loss': 0.01303162,
           'precision50': 0.81023663,
           'recall50': 0.5982102},
     'global': {'total_loss': 0.6047488},
     'learning_rate': 0.00245247,
     'training_loss': 0.6047488}
I0411 05:54:25.050498 140640048215872 controller.py:425] train | step:  255000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.70027,
           'avg_obj': 0.26807442,
           'box_loss': 0.01099668,
           'class_loss': 0.0039063054,
           'conf_loss': 0.011722069,
           'precision50': 0.44185394,
           'recall50': 0.16529822},
     '4': {'avg_iou': 0.79863214,
           'avg_obj': 0.42180836,
           'box_loss': 0.008583117,
           'class_loss': 0.0034468377,
           'conf_loss': 0.013875711,
           'precision50': 0.6805634,
           'recall50': 0.38784674},
     '5': {'avg_iou': 0.85346895,
           'avg_obj': 0.5546961,
           'box_loss': 0.0066809594,
           'class_loss': 0.0031275623,
           'conf_loss': 0.013016118,
           'precision50': 0.81081194,
           'recall50': 0.6007139},
     'global': {'total_loss': 0.6028433},
     'learning_rate': 0.0023479913,
     'training_loss': 0.6028433}
I0411 06:26:51.808351 140640048215872 controller.py:425] train | step:  260000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.70079696,
           'avg_obj': 0.269705,
           'box_loss': 0.010969664,
           'class_loss': 0.0038836498,
           'conf_loss': 0.011655821,
           'precision50': 0.44243565,
           'recall50': 0.16669476},
     '4': {'avg_iou': 0.79940915,
           'avg_obj': 0.42425054,
           'box_loss': 0.0085387025,
           'class_loss': 0.0034160381,
           'conf_loss': 0.013783446,
           'precision50': 0.6809421,
           'recall50': 0.39014125},
     '5': {'avg_iou': 0.854146,
           'avg_obj': 0.5563896,
           'box_loss': 0.006642895,
           'class_loss': 0.003109367,
           'conf_loss': 0.012928432,
           'precision50': 0.8110342,
           'recall50': 0.6023578},
     'global': {'total_loss': 0.5994234},
     'learning_rate': 0.0022856274,
     'training_loss': 0.5994234}
I0411 06:58:55.091992 140640048215872 controller.py:425] train | step:  265000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.70115256,
           'avg_obj': 0.27018818,
           'box_loss': 0.01099986,
           'class_loss': 0.0038800898,
           'conf_loss': 0.011690738,
           'precision50': 0.44509745,
           'recall50': 0.1676601},
     '4': {'avg_iou': 0.7996412,
           'avg_obj': 0.42416304,
           'box_loss': 0.008535385,
           'class_loss': 0.0034077629,
           'conf_loss': 0.013835046,
           'precision50': 0.6815211,
           'recall50': 0.39075497},
     '5': {'avg_iou': 0.85462266,
           'avg_obj': 0.5576274,
           'box_loss': 0.0066309283,
           'class_loss': 0.0031010155,
           'conf_loss': 0.012938168,
           'precision50': 0.8122413,
           'recall50': 0.6036346},
     'global': {'total_loss': 0.60015255},
     'learning_rate': 0.0022032626,
     'training_loss': 0.60015255}
I0411 06:59:49.759520 140640048215872 controller.py:455] saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-265000.
I0411 06:59:49.765798 140640048215872 controller.py:252]  eval | step:  265000 | running 625 steps of evaluation...
I0411 07:04:31.537632 140640048215872 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.

train | step:  245000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.69898766,
           'avg_obj': 0.26547313,
           'box_loss': 0.011064132,
           'class_loss': 0.003959821,
           'conf_loss': 0.011801257,
           'precision50': 0.43980122,
           'recall50': 0.16290781},
     '4': {'avg_iou': 0.79722595,
           'avg_obj': 0.41862637,
           'box_loss': 0.008630789,
           'class_loss': 0.0034831832,
           'conf_loss': 0.013959722,
           'precision50': 0.6793722,
           'recall50': 0.38412377},
     '5': {'avg_iou': 0.85207385,
           'avg_obj': 0.55121404,
           'box_loss': 0.006745869,
           'class_loss': 0.0031807201,
           'conf_loss': 0.013097177,
           'precision50': 0.8093028,
           'recall50': 0.5964003},
     'global': {'total_loss': 0.60738176},
     'learning_rate': 0.0025697285,
     'training_loss': 0.60738176}
saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-245000.
 eval | step:  245000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=177.36s).
Accumulating evaluation results...
DONE (t=11.47s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.409
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.603
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.438
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.151
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.362
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.540
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.332
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.536
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.580
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.303
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.552
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.699
 eval | step:  245000 | eval time:  501.2 sec | output: 
    {'3': {'avg_iou': 0.44629648,
           'avg_obj': 0.18314104,
           'box_loss': 0.007502329,
           'class_loss': 0.0026080578,
           'conf_loss': 0.00610333,
           'precision50': 0.15098523,
           'recall50': 0.1787481},
     '4': {'avg_iou': 0.6704405,
           'avg_obj': 0.38610598,
           'box_loss': 0.007916351,
           'class_loss': 0.003024244,
           'conf_loss': 0.008364464,
           'precision50': 0.23567973,
           'recall50': 0.4164115},
     '5': {'avg_iou': 0.8223652,
           'avg_obj': 0.5827334,
           'box_loss': 0.0072837113,
           'class_loss': 0.0028851982,
           'conf_loss': 0.009872095,
           'precision50': 0.29901388,
           'recall50': 0.6398089},
     'AP': 0.40915933,
     'AP50': 0.60251886,
     'AP75': 0.4376084,
     'APl': 0.5399365,
     'APm': 0.36167082,
     'APs': 0.15062517,
     'ARl': 0.69934595,
     'ARm': 0.55198616,
     'ARmax1': 0.33176637,
     'ARmax10': 0.5355834,
     'ARmax100': 0.58004016,
     'ARs': 0.3033901,
     'global': {'total_loss': 0.05555979},
     'validation_loss': 0.05555979}
train | step:  245000 | training until step 265000...
train | step:  250000 | steps/sec:    2.2 | output: 
    {'3': {'avg_iou': 0.6993558,
           'avg_obj': 0.2667935,
           'box_loss': 0.011050879,
           'class_loss': 0.003945975,
           'conf_loss': 0.011739488,
           'precision50': 0.4396695,
           'recall50': 0.163615},
     '4': {'avg_iou': 0.79799306,
           'avg_obj': 0.42030165,
           'box_loss': 0.008601059,
           'class_loss': 0.0034519893,
           'conf_loss': 0.013897197,
           'precision50': 0.6790188,
           'recall50': 0.3860261},
     '5': {'avg_iou': 0.8527512,
           'avg_obj': 0.5528359,
           'box_loss': 0.006717548,
           'class_loss': 0.0031577882,
           'conf_loss': 0.01303162,
           'precision50': 0.81023663,
           'recall50': 0.5982102},
     'global': {'total_loss': 0.6047488},
     'learning_rate': 0.00245247,
     'training_loss': 0.6047488}
train | step:  255000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.70027,
           'avg_obj': 0.26807442,
           'box_loss': 0.01099668,
           'class_loss': 0.0039063054,
           'conf_loss': 0.011722069,
           'precision50': 0.44185394,
           'recall50': 0.16529822},
     '4': {'avg_iou': 0.79863214,
           'avg_obj': 0.42180836,
           'box_loss': 0.008583117,
           'class_loss': 0.0034468377,
           'conf_loss': 0.013875711,
           'precision50': 0.6805634,
           'recall50': 0.38784674},
     '5': {'avg_iou': 0.85346895,
           'avg_obj': 0.5546961,
           'box_loss': 0.0066809594,
           'class_loss': 0.0031275623,
           'conf_loss': 0.013016118,
           'precision50': 0.81081194,
           'recall50': 0.6007139},
     'global': {'total_loss': 0.6028433},
     'learning_rate': 0.0023479913,
     'training_loss': 0.6028433}
train | step:  260000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.70079696,
           'avg_obj': 0.269705,
           'box_loss': 0.010969664,
           'class_loss': 0.0038836498,
           'conf_loss': 0.011655821,
           'precision50': 0.44243565,
           'recall50': 0.16669476},
     '4': {'avg_iou': 0.79940915,
           'avg_obj': 0.42425054,
           'box_loss': 0.0085387025,
           'class_loss': 0.0034160381,
           'conf_loss': 0.013783446,
           'precision50': 0.6809421,
           'recall50': 0.39014125},
     '5': {'avg_iou': 0.854146,
           'avg_obj': 0.5563896,
           'box_loss': 0.006642895,
           'class_loss': 0.003109367,
           'conf_loss': 0.012928432,
           'precision50': 0.8110342,
           'recall50': 0.6023578},
     'global': {'total_loss': 0.5994234},
     'learning_rate': 0.0022856274,
     'training_loss': 0.5994234}
train | step:  265000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.70115256,
           'avg_obj': 0.27018818,
           'box_loss': 0.01099986,
           'class_loss': 0.0038800898,
           'conf_loss': 0.011690738,
           'precision50': 0.44509745,
           'recall50': 0.1676601},
     '4': {'avg_iou': 0.7996412,
           'avg_obj': 0.42416304,
           'box_loss': 0.008535385,
           'class_loss': 0.0034077629,
           'conf_loss': 0.013835046,
           'precision50': 0.6815211,
           'recall50': 0.39075497},
     '5': {'avg_iou': 0.85462266,
           'avg_obj': 0.5576274,
           'box_loss': 0.0066309283,
           'class_loss': 0.0031010155,
           'conf_loss': 0.012938168,
           'precision50': 0.8122413,
           'recall50': 0.6036346},
     'global': {'total_loss': 0.60015255},
     'learning_rate': 0.0022032626,
     'training_loss': 0.60015255}
saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-265000.
 eval | step:  265000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=183.71s).
Accumulating evaluation results...
DONE (t=11.49s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.408
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.602
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.437
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.146
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.360
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.539
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.333
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.534
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.577
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.302I0411 07:08:43.235643 140640048215872 controller.py:261]  eval | step:  265000 | eval time:  533.5 sec | output: 
    {'3': {'avg_iou': 0.44658175,
           'avg_obj': 0.18448512,
           'box_loss': 0.0074882545,
           'class_loss': 0.00264445,
           'conf_loss': 0.0061603533,
           'precision50': 0.15013771,
           'recall50': 0.18035568},
     '4': {'avg_iou': 0.6695161,
           'avg_obj': 0.38825867,
           'box_loss': 0.007963504,
           'class_loss': 0.0030397088,
           'conf_loss': 0.008435091,
           'precision50': 0.23627058,
           'recall50': 0.42130992},
     '5': {'avg_iou': 0.8216163,
           'avg_obj': 0.5842859,
           'box_loss': 0.007322835,
           'class_loss': 0.0028749136,
           'conf_loss': 0.009959405,
           'precision50': 0.29588172,
           'recall50': 0.6389296},
     'AP': 0.4082108,
     'AP50': 0.60150003,
     'AP75': 0.43696764,
     'APl': 0.53915155,
     'APm': 0.36038908,
     'APs': 0.14645538,
     'ARl': 0.6945584,
     'ARm': 0.5506896,
     'ARmax1': 0.33299935,
     'ARmax10': 0.5336878,
     'ARmax100': 0.57724094,
     'ARs': 0.3015774,
     'global': {'total_loss': 0.05588855},
     'validation_loss': 0.05588855}
I0411 07:09:02.662013 140640048215872 controller.py:211] train | step:  265000 | training until step 285000...
I0411 07:35:27.067911 140640048215872 controller.py:425] train | step:  270000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.70162433,
           'avg_obj': 0.27183327,
           'box_loss': 0.0109786885,
           'class_loss': 0.0038647174,
           'conf_loss': 0.011686163,
           'precision50': 0.445775,
           'recall50': 0.16859615},
     '4': {'avg_iou': 0.80024564,
           'avg_obj': 0.42651656,
           'box_loss': 0.008514074,
           'class_loss': 0.0033893825,
           'conf_loss': 0.013789569,
           'precision50': 0.6847495,
           'recall50': 0.39412716},
     '5': {'avg_iou': 0.85514337,
           'avg_obj': 0.55961823,
           'box_loss': 0.006605091,
           'class_loss': 0.003066342,
           'conf_loss': 0.0128872255,
           'precision50': 0.8126753,
           'recall50': 0.6056209},
     'global': {'total_loss': 0.5982503},
     'learning_rate': 0.0021345757,
     'training_loss': 0.5982503}
I0411 08:06:51.589063 140640048215872 controller.py:425] train | step:  275000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.7020892,
           'avg_obj': 0.27297884,
           'box_loss': 0.0109294215,
           'class_loss': 0.003838879,
           'conf_loss': 0.01164404,
           'precision50': 0.44677404,
           'recall50': 0.16951965},
     '4': {'avg_iou': 0.80086225,
           'avg_obj': 0.42773753,
           'box_loss': 0.0084664505,
           'class_loss': 0.0033675244,
           'conf_loss': 0.013743766,
           'precision50': 0.6828202,
           'recall50': 0.39405918},
     '5': {'avg_iou': 0.8556066,
           'avg_obj': 0.5606589,
           'box_loss': 0.006576065,
           'class_loss': 0.0030603162,
           'conf_loss': 0.012839453,
           'precision50': 0.8125987,
           'recall50': 0.60687166},
     'global': {'total_loss': 0.595728},
     'learning_rate': 0.0020965075,
     'training_loss': 0.595728}
I0411 08:40:06.803363 140640048215872 controller.py:425] train | step:  280000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.70200753,
           'avg_obj': 0.2731243,
           'box_loss': 0.01093479,
           'class_loss': 0.0038365142,
           'conf_loss': 0.011679496,
           'precision50': 0.4476206,
           'recall50': 0.17059687},
     '4': {'avg_iou': 0.8010211,
           'avg_obj': 0.42890504,
           'box_loss': 0.008473318,
           'class_loss': 0.0033691933,
           'conf_loss': 0.013753181,
           'precision50': 0.6845221,
           'recall50': 0.39610833},
     '5': {'avg_iou': 0.8560658,
           'avg_obj': 0.5617174,
           'box_loss': 0.0065602837,
           'class_loss': 0.0030475978,
           'conf_loss': 0.012863833,
           'precision50': 0.81346184,
           'recall50': 0.6079211},
     'global': {'total_loss': 0.59614635},
     'learning_rate': 0.0020511425,
     'training_loss': 0.59614635}
I0411 09:11:50.547195 140640048215872 controller.py:425] train | step:  285000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.7022649,
           'avg_obj': 0.27368078,
           'box_loss': 0.010941217,
           'class_loss': 0.0038259083,
           'conf_loss': 0.011617435,
           'precision50': 0.44748202,
           'recall50': 0.17091997},
     '4': {'avg_iou': 0.80112666,
           'avg_obj': 0.42931035,
           'box_loss': 0.00846462,
           'class_loss': 0.0033607457,
           'conf_loss': 0.013691642,
           'precision50': 0.684411,
           'recall50': 0.39657044},
     '5': {'avg_iou': 0.8563,
           'avg_obj': 0.5629878,
           'box_loss': 0.006551284,
           'class_loss': 0.003039939,
           'conf_loss': 0.012782042,
           'precision50': 0.8142329,
           'recall50': 0.6095901},
     'global': {'total_loss': 0.59419817},
     'learning_rate': 0.0020200035,
     'training_loss': 0.59419817}
I0411 09:12:38.443367 140640048215872 controller.py:455] saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-285000.
I0411 09:12:38.450701 140640048215872 controller.py:252]  eval | step:  285000 | running 625 steps of evaluation...
I0411 09:17:11.890607 140640048215872 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0411 09:21:18.734114 140640048215872 controller.py:261]  eval | step:  285000 | eval time:  520.3 sec | output: 
    {'3': {'avg_iou': 0.4463013,
           'avg_obj': 0.18438749,
           'box_loss': 0.007502194,
           'class_loss': 0.0026728848,
           'conf_loss': 0.0061802985,
           'precision50': 0.14817066,
           'recall50': 0.18089743},
     '4': {'avg_iou': 0.6687795,
           'avg_obj': 0.38763312,
           'box_loss': 0.008000969,
           'class_loss': 0.0030913523,
           'conf_loss': 0.00846287,
           'precision50': 0.23361726,
           'recall50': 0.41859585},
     '5': {'avg_iou': 0.8210434,
           'avg_obj': 0.58442116,
           'box_loss': 0.007350728,
           'class_loss': 0.002914691,
           'conf_loss': 0.00999959,
           'precision50': 0.2959774,
           'recall50': 0.6376921},
     'AP': 0.40604055,
     'AP50': 0.59875655,
     'AP75': 0.4337835,
     'APl': 0.53616947,
     'APm': 0.35765585,
     'APs': 0.1460835,
     'ARl': 0.6894541,
     'ARm': 0.5451648,
     'ARmax1': 0.33042312,
     'ARmax10': 0.5301114,
     'ARmax100': 0.57329726,
     'ARs': 0.30055866,
     'global': {'total_loss': 0.05617558},
     'validation_loss': 0.05617558}
I0411 09:21:40.079974 140640048215872 controller.py:211] train | step:  285000 | training until step 300000...
I0411 09:48:04.609514 140640048215872 controller.py:425] train | step:  290000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.70286685,
           'avg_obj': 0.2744831,
           'box_loss': 0.010898798,
           'class_loss': 0.0038316487,
           'conf_loss': 0.011563012,
           'precision50': 0.44751298,
           'recall50': 0.17125773},
     '4': {'avg_iou': 0.80171025,
           'avg_obj': 0.42992783,
           'box_loss': 0.008441277,
           'class_loss': 0.0033382222,
           'conf_loss': 0.013671547,
           'precision50': 0.68445945,
           'recall50': 0.39688307},
     '5': {'avg_iou': 0.8564212,
           'avg_obj': 0.5631474,
           'box_loss': 0.006541774,
           'class_loss': 0.0030353977,
           'conf_loss': 0.012775784,
           'precision50': 0.814155,
           'recall50': 0.61007905},
     'global': {'total_loss': 0.5927802},
     'learning_rate': 0.002007205,
     'training_loss': 0.5927802}

 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.551
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.695
 eval | step:  265000 | eval time:  533.5 sec | output: 
    {'3': {'avg_iou': 0.44658175,
           'avg_obj': 0.18448512,
           'box_loss': 0.0074882545,
           'class_loss': 0.00264445,
           'conf_loss': 0.0061603533,
           'precision50': 0.15013771,
           'recall50': 0.18035568},
     '4': {'avg_iou': 0.6695161,
           'avg_obj': 0.38825867,
           'box_loss': 0.007963504,
           'class_loss': 0.0030397088,
           'conf_loss': 0.008435091,
           'precision50': 0.23627058,
           'recall50': 0.42130992},
     '5': {'avg_iou': 0.8216163,
           'avg_obj': 0.5842859,
           'box_loss': 0.007322835,
           'class_loss': 0.0028749136,
           'conf_loss': 0.009959405,
           'precision50': 0.29588172,
           'recall50': 0.6389296},
     'AP': 0.4082108,
     'AP50': 0.60150003,
     'AP75': 0.43696764,
     'APl': 0.53915155,
     'APm': 0.36038908,
     'APs': 0.14645538,
     'ARl': 0.6945584,
     'ARm': 0.5506896,
     'ARmax1': 0.33299935,
     'ARmax10': 0.5336878,
     'ARmax100': 0.57724094,
     'ARs': 0.3015774,
     'global': {'total_loss': 0.05588855},
     'validation_loss': 0.05588855}
train | step:  265000 | training until step 285000...
train | step:  270000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.70162433,
           'avg_obj': 0.27183327,
           'box_loss': 0.0109786885,
           'class_loss': 0.0038647174,
           'conf_loss': 0.011686163,
           'precision50': 0.445775,
           'recall50': 0.16859615},
     '4': {'avg_iou': 0.80024564,
           'avg_obj': 0.42651656,
           'box_loss': 0.008514074,
           'class_loss': 0.0033893825,
           'conf_loss': 0.013789569,
           'precision50': 0.6847495,
           'recall50': 0.39412716},
     '5': {'avg_iou': 0.85514337,
           'avg_obj': 0.55961823,
           'box_loss': 0.006605091,
           'class_loss': 0.003066342,
           'conf_loss': 0.0128872255,
           'precision50': 0.8126753,
           'recall50': 0.6056209},
     'global': {'total_loss': 0.5982503},
     'learning_rate': 0.0021345757,
     'training_loss': 0.5982503}
train | step:  275000 | steps/sec:    2.7 | output: 
    {'3': {'avg_iou': 0.7020892,
           'avg_obj': 0.27297884,
           'box_loss': 0.0109294215,
           'class_loss': 0.003838879,
           'conf_loss': 0.01164404,
           'precision50': 0.44677404,
           'recall50': 0.16951965},
     '4': {'avg_iou': 0.80086225,
           'avg_obj': 0.42773753,
           'box_loss': 0.0084664505,
           'class_loss': 0.0033675244,
           'conf_loss': 0.013743766,
           'precision50': 0.6828202,
           'recall50': 0.39405918},
     '5': {'avg_iou': 0.8556066,
           'avg_obj': 0.5606589,
           'box_loss': 0.006576065,
           'class_loss': 0.0030603162,
           'conf_loss': 0.012839453,
           'precision50': 0.8125987,
           'recall50': 0.60687166},
     'global': {'total_loss': 0.595728},
     'learning_rate': 0.0020965075,
     'training_loss': 0.595728}
train | step:  280000 | steps/sec:    2.5 | output: 
    {'3': {'avg_iou': 0.70200753,
           'avg_obj': 0.2731243,
           'box_loss': 0.01093479,
           'class_loss': 0.0038365142,
           'conf_loss': 0.011679496,
           'precision50': 0.4476206,
           'recall50': 0.17059687},
     '4': {'avg_iou': 0.8010211,
           'avg_obj': 0.42890504,
           'box_loss': 0.008473318,
           'class_loss': 0.0033691933,
           'conf_loss': 0.013753181,
           'precision50': 0.6845221,
           'recall50': 0.39610833},
     '5': {'avg_iou': 0.8560658,
           'avg_obj': 0.5617174,
           'box_loss': 0.0065602837,
           'class_loss': 0.0030475978,
           'conf_loss': 0.012863833,
           'precision50': 0.81346184,
           'recall50': 0.6079211},
     'global': {'total_loss': 0.59614635},
     'learning_rate': 0.0020511425,
     'training_loss': 0.59614635}
train | step:  285000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.7022649,
           'avg_obj': 0.27368078,
           'box_loss': 0.010941217,
           'class_loss': 0.0038259083,
           'conf_loss': 0.011617435,
           'precision50': 0.44748202,
           'recall50': 0.17091997},
     '4': {'avg_iou': 0.80112666,
           'avg_obj': 0.42931035,
           'box_loss': 0.00846462,
           'class_loss': 0.0033607457,
           'conf_loss': 0.013691642,
           'precision50': 0.684411,
           'recall50': 0.39657044},
     '5': {'avg_iou': 0.8563,
           'avg_obj': 0.5629878,
           'box_loss': 0.006551284,
           'class_loss': 0.003039939,
           'conf_loss': 0.012782042,
           'precision50': 0.8142329,
           'recall50': 0.6095901},
     'global': {'total_loss': 0.59419817},
     'learning_rate': 0.0020200035,
     'training_loss': 0.59419817}
saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-285000.
 eval | step:  285000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=180.33s).
Accumulating evaluation results...
DONE (t=11.33s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.406
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.599
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.434
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.146
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.358
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.536
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.330
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.530
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.573
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.301
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.545
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.689
 eval | step:  285000 | eval time:  520.3 sec | output: 
    {'3': {'avg_iou': 0.4463013,
           'avg_obj': 0.18438749,
           'box_loss': 0.007502194,
           'class_loss': 0.0026728848,
           'conf_loss': 0.0061802985,
           'precision50': 0.14817066,
           'recall50': 0.18089743},
     '4': {'avg_iou': 0.6687795,
           'avg_obj': 0.38763312,
           'box_loss': 0.008000969,
           'class_loss': 0.0030913523,
           'conf_loss': 0.00846287,
           'precision50': 0.23361726,
           'recall50': 0.41859585},
     '5': {'avg_iou': 0.8210434,
           'avg_obj': 0.58442116,
           'box_loss': 0.007350728,
           'class_loss': 0.002914691,
           'conf_loss': 0.00999959,
           'precision50': 0.2959774,
           'recall50': 0.6376921},
     'AP': 0.40604055,
     'AP50': 0.59875655,
     'AP75': 0.4337835,
     'APl': 0.53616947,
     'APm': 0.35765585,
     'APs': 0.1460835,
     'ARl': 0.6894541,
     'ARm': 0.5451648,
     'ARmax1': 0.33042312,
     'ARmax10': 0.5301114,
     'ARmax100': 0.57329726,
     'ARs': 0.30055866,
     'global': {'total_loss': 0.05617558},
     'validation_loss': 0.05617558}
train | step:  285000 | training until step 300000...
train | step:  290000 | steps/sec:    2.3 | output: 
    {'3': {'avg_iou': 0.70286685,
           'avg_obj': 0.2744831,
           'box_loss': 0.010898798,
           'class_loss': 0.0038316487,
           'conf_loss': 0.011563012,
           'precision50': 0.44751298,
           'recall50': 0.17125773},
     '4': {'avg_iou': 0.80171025,
           'avg_obj': 0.42992783,
           'box_loss': 0.008441277,
           'class_loss': 0.0033382222,
           'conf_loss': 0.013671547,
           'precision50': 0.68445945,
           'recall50': 0.39688307},
     '5': {'avg_iou': 0.8564212,
           'avg_obj': 0.5631474,
           'box_loss': 0.006541774,
           'class_loss': 0.0030353977,
           'conf_loss': 0.012775784,
           'precision50': 0.814155,
           'recall50': 0.61007905},
     'global': {'total_loss': 0.5927802},
     'learning_rate': 0.002007205,
     'training_loss': 0.5927802}I0411 10:16:12.061332 140640048215872 controller.py:425] train | step:  295000 | steps/sec:    3.0 | output: 
    {'3': {'avg_iou': 0.70338935,
           'avg_obj': 0.27565703,
           'box_loss': 0.010865631,
           'class_loss': 0.0037908738,
           'conf_loss': 0.011563808,
           'precision50': 0.44847524,
           'recall50': 0.17251395},
     '4': {'avg_iou': 0.8018123,
           'avg_obj': 0.4313651,
           'box_loss': 0.008411554,
           'class_loss': 0.003320602,
           'conf_loss': 0.013623497,
           'precision50': 0.6847951,
           'recall50': 0.39849064},
     '5': {'avg_iou': 0.8567879,
           'avg_obj': 0.5643778,
           'box_loss': 0.006517405,
           'class_loss': 0.0030191645,
           'conf_loss': 0.012728074,
           'precision50': 0.81442726,
           'recall50': 0.61148006},
     'global': {'total_loss': 0.5907251},
     'learning_rate': 0.002,
     'training_loss': 0.5907251}
I0411 10:48:02.435280 140640048215872 controller.py:425] train | step:  300000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.7035354,
           'avg_obj': 0.2762759,
           'box_loss': 0.010881518,
           'class_loss': 0.003785618,
           'conf_loss': 0.011555661,
           'precision50': 0.44906607,
           'recall50': 0.17260063},
     '4': {'avg_iou': 0.8023702,
           'avg_obj': 0.43223125,
           'box_loss': 0.008406632,
           'class_loss': 0.0033184967,
           'conf_loss': 0.013614526,
           'precision50': 0.6845699,
           'recall50': 0.39869067},
     '5': {'avg_iou': 0.8571371,
           'avg_obj': 0.56563896,
           'box_loss': 0.006508452,
           'class_loss': 0.0030138278,
           'conf_loss': 0.0127147855,
           'precision50': 0.81513035,
           'recall50': 0.6121039},
     'global': {'total_loss': 0.5903955},
     'learning_rate': 0.002,
     'training_loss': 0.5903955}
I0411 10:48:15.128171 140640048215872 controller.py:252]  eval | step:  300000 | running 625 steps of evaluation...
I0411 10:52:48.619280 140640048215872 coco_evaluator.py:128] There is no annotation_file in COCOEvaluator.
I0411 10:56:58.495568 140640048215872 controller.py:261]  eval | step:  300000 | eval time:  523.4 sec | output: 
    {'3': {'avg_iou': 0.44609424,
           'avg_obj': 0.18445659,
           'box_loss': 0.007513836,
           'class_loss': 0.0027012355,
           'conf_loss': 0.0061886446,
           'precision50': 0.14743511,
           'recall50': 0.1814093},
     '4': {'avg_iou': 0.6686436,
           'avg_obj': 0.38838017,
           'box_loss': 0.008008111,
           'class_loss': 0.003121516,
           'conf_loss': 0.008488009,
           'precision50': 0.23164873,
           'recall50': 0.41820607},
     '5': {'avg_iou': 0.8205655,
           'avg_obj': 0.5863441,
           'box_loss': 0.0073755197,
           'class_loss': 0.0029344896,
           'conf_loss': 0.010050655,
           'precision50': 0.29806516,
           'recall50': 0.64155906},
     'AP': 0.40612394,
     'AP50': 0.59801495,
     'AP75': 0.43358517,
     'APl': 0.5370394,
     'APm': 0.3589515,
     'APs': 0.1439588,
     'ARl': 0.69128734,
     'ARm': 0.54511774,
     'ARmax1': 0.32936084,
     'ARmax10': 0.5307424,
     'ARmax100': 0.57446843,
     'ARs': 0.30288225,
     'global': {'total_loss': 0.056382038},
     'validation_loss': 0.056382038}
I0411 10:57:52.429037 140640048215872 controller.py:455] saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-300000.
I0411 10:57:52.446244 140640048215872 train_lib.py:123] Number of trainable params in model: 53.066944 Millions.

train | step:  295000 | steps/sec:    3.0 | output: 
    {'3': {'avg_iou': 0.70338935,
           'avg_obj': 0.27565703,
           'box_loss': 0.010865631,
           'class_loss': 0.0037908738,
           'conf_loss': 0.011563808,
           'precision50': 0.44847524,
           'recall50': 0.17251395},
     '4': {'avg_iou': 0.8018123,
           'avg_obj': 0.4313651,
           'box_loss': 0.008411554,
           'class_loss': 0.003320602,
           'conf_loss': 0.013623497,
           'precision50': 0.6847951,
           'recall50': 0.39849064},
     '5': {'avg_iou': 0.8567879,
           'avg_obj': 0.5643778,
           'box_loss': 0.006517405,
           'class_loss': 0.0030191645,
           'conf_loss': 0.012728074,
           'precision50': 0.81442726,
           'recall50': 0.61148006},
     'global': {'total_loss': 0.5907251},
     'learning_rate': 0.002,
     'training_loss': 0.5907251}
train | step:  300000 | steps/sec:    2.6 | output: 
    {'3': {'avg_iou': 0.7035354,
           'avg_obj': 0.2762759,
           'box_loss': 0.010881518,
           'class_loss': 0.003785618,
           'conf_loss': 0.011555661,
           'precision50': 0.44906607,
           'recall50': 0.17260063},
     '4': {'avg_iou': 0.8023702,
           'avg_obj': 0.43223125,
           'box_loss': 0.008406632,
           'class_loss': 0.0033184967,
           'conf_loss': 0.013614526,
           'precision50': 0.6845699,
           'recall50': 0.39869067},
     '5': {'avg_iou': 0.8571371,
           'avg_obj': 0.56563896,
           'box_loss': 0.006508452,
           'class_loss': 0.0030138278,
           'conf_loss': 0.0127147855,
           'precision50': 0.81513035,
           'recall50': 0.6121039},
     'global': {'total_loss': 0.5903955},
     'learning_rate': 0.002,
     'training_loss': 0.5903955}
 eval | step:  300000 | running 625 steps of evaluation...
creating index...
index created!
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=180.17s).
Accumulating evaluation results...
DONE (t=11.16s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.406
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.598
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.434
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.144
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.359
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.537
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.329
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.531
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.574
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.303
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.545
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.691
 eval | step:  300000 | eval time:  523.4 sec | output: 
    {'3': {'avg_iou': 0.44609424,
           'avg_obj': 0.18445659,
           'box_loss': 0.007513836,
           'class_loss': 0.0027012355,
           'conf_loss': 0.0061886446,
           'precision50': 0.14743511,
           'recall50': 0.1814093},
     '4': {'avg_iou': 0.6686436,
           'avg_obj': 0.38838017,
           'box_loss': 0.008008111,
           'class_loss': 0.003121516,
           'conf_loss': 0.008488009,
           'precision50': 0.23164873,
           'recall50': 0.41820607},
     '5': {'avg_iou': 0.8205655,
           'avg_obj': 0.5863441,
           'box_loss': 0.0073755197,
           'class_loss': 0.0029344896,
           'conf_loss': 0.010050655,
           'precision50': 0.29806516,
           'recall50': 0.64155906},
     'AP': 0.40612394,
     'AP50': 0.59801495,
     'AP75': 0.43358517,
     'APl': 0.5370394,
     'APm': 0.3589515,
     'APs': 0.1439588,
     'ARl': 0.69128734,
     'ARm': 0.54511774,
     'ARmax1': 0.32936084,
     'ARmax10': 0.5307424,
     'ARmax100': 0.57446843,
     'ARs': 0.30288225,
     'global': {'total_loss': 0.056382038},
     'validation_loss': 0.056382038}
saved checkpoint to gs://tensorflow2/data-pipeline/all-300k/ckpt-300000.
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   208    0     2  100   206     11   1197 --:--:-- --:--:-- --:--:--  1209
okRequest issued for: [node-6]
done: true
metadata:
  '@type': type.googleapis.com/google.cloud.common.OperationMetadata
  apiVersion: v1
  cancelRequested: false
  createTime: '2021-04-11T10:58:54.887622228Z'
  endTime: '2021-04-11T10:59:49.928629400Z'
  target: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  verb: update
name: projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618138734873-5bfb0487d4d88-478de6a9-ff068a63
response:
  '@type': type.googleapis.com/google.cloud.tpu.v1.Node
  acceleratorType: v3-8
  apiVersion: V1
  cidrBlock: 10.77.141.40/29
  createTime: '2021-03-18T03:09:20.282595874Z'
  health: HEALTHY
  ipAddress: 10.77.141.42
  name: projects/red-atlas-305317/locations/europe-west4-a/nodes/node-6
  network: global/networks/default
  networkEndpoints:
  - ipAddress: 10.77.141.42
    port: 8470
  port: '8470'
  schedulingConfig: {}
  serviceAccount: service-276208758346@cloud-tpu.iam.gserviceaccount.com
  state: STOPPED
  tensorflowVersion: 2.4.1
Waiting for operation [projects/red-atlas-305317/locations/europe-west4-a/operations/operation-1618138734873-5bfb0487d4d88-478de6a9-ff068a63] to complete...
...............................................................................................................................................................................................................................................................................................................................................................................................done.
